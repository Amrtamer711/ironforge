var jP=Object.defineProperty;var hb=t=>{throw TypeError(t)};var CP=(t,e,n)=>e in t?jP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $e=(t,e,n)=>CP(t,typeof e!="symbol"?e+"":e,n),ym=(t,e,n)=>e.has(t)||hb("Cannot "+n);var M=(t,e,n)=>(ym(t,e,"read from private field"),n?n.call(t):e.get(t)),Ce=(t,e,n)=>e.has(t)?hb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),xe=(t,e,n,s)=>(ym(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n),Fe=(t,e,n)=>(ym(t,e,"access private method"),n);var Zd=(t,e,n,s)=>({set _(r){xe(t,e,r,n)},get _(){return M(t,e,s)}});function NP(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function s1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r1={exports:{}},Np={},i1={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bd=Symbol.for("react.element"),EP=Symbol.for("react.portal"),TP=Symbol.for("react.fragment"),PP=Symbol.for("react.strict_mode"),RP=Symbol.for("react.profiler"),AP=Symbol.for("react.provider"),OP=Symbol.for("react.context"),MP=Symbol.for("react.forward_ref"),IP=Symbol.for("react.suspense"),DP=Symbol.for("react.memo"),LP=Symbol.for("react.lazy"),fb=Symbol.iterator;function $P(t){return t===null||typeof t!="object"?null:(t=fb&&t[fb]||t["@@iterator"],typeof t=="function"?t:null)}var o1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},a1=Object.assign,l1={};function oc(t,e,n){this.props=t,this.context=e,this.refs=l1,this.updater=n||o1}oc.prototype.isReactComponent={};oc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};oc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function c1(){}c1.prototype=oc.prototype;function qy(t,e,n){this.props=t,this.context=e,this.refs=l1,this.updater=n||o1}var Ky=qy.prototype=new c1;Ky.constructor=qy;a1(Ky,oc.prototype);Ky.isPureReactComponent=!0;var pb=Array.isArray,u1=Object.prototype.hasOwnProperty,Gy={current:null},d1={key:!0,ref:!0,__self:!0,__source:!0};function h1(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)u1.call(e,s)&&!d1.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:bd,type:t,key:i,ref:o,props:r,_owner:Gy.current}}function FP(t,e){return{$$typeof:bd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Yy(t){return typeof t=="object"&&t!==null&&t.$$typeof===bd}function zP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var mb=/\/+/g;function vm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?zP(""+t.key):e.toString(36)}function nf(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case bd:case EP:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+vm(o,0):s,pb(r)?(n="",t!=null&&(n=t.replace(mb,"$&/")+"/"),nf(r,e,n,"",function(u){return u})):r!=null&&(Yy(r)&&(r=FP(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(mb,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",pb(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+vm(i,a);o+=nf(i,e,n,l,r)}else if(l=$P(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+vm(i,a++),o+=nf(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function eh(t,e,n){if(t==null)return t;var s=[],r=0;return nf(t,s,"","",function(i){return e.call(n,i,r++)}),s}function BP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Un={current:null},sf={transition:null},UP={ReactCurrentDispatcher:Un,ReactCurrentBatchConfig:sf,ReactCurrentOwner:Gy};function f1(){throw Error("act(...) is not supported in production builds of React.")}Je.Children={map:eh,forEach:function(t,e,n){eh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return eh(t,function(){e++}),e},toArray:function(t){return eh(t,function(e){return e})||[]},only:function(t){if(!Yy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Je.Component=oc;Je.Fragment=TP;Je.Profiler=RP;Je.PureComponent=qy;Je.StrictMode=PP;Je.Suspense=IP;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UP;Je.act=f1;Je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=a1({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Gy.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)u1.call(e,l)&&!d1.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:bd,type:t.type,key:r,ref:i,props:s,_owner:o}};Je.createContext=function(t){return t={$$typeof:OP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:AP,_context:t},t.Consumer=t};Je.createElement=h1;Je.createFactory=function(t){var e=h1.bind(null,t);return e.type=t,e};Je.createRef=function(){return{current:null}};Je.forwardRef=function(t){return{$$typeof:MP,render:t}};Je.isValidElement=Yy;Je.lazy=function(t){return{$$typeof:LP,_payload:{_status:-1,_result:t},_init:BP}};Je.memo=function(t,e){return{$$typeof:DP,type:t,compare:e===void 0?null:e}};Je.startTransition=function(t){var e=sf.transition;sf.transition={};try{t()}finally{sf.transition=e}};Je.unstable_act=f1;Je.useCallback=function(t,e){return Un.current.useCallback(t,e)};Je.useContext=function(t){return Un.current.useContext(t)};Je.useDebugValue=function(){};Je.useDeferredValue=function(t){return Un.current.useDeferredValue(t)};Je.useEffect=function(t,e){return Un.current.useEffect(t,e)};Je.useId=function(){return Un.current.useId()};Je.useImperativeHandle=function(t,e,n){return Un.current.useImperativeHandle(t,e,n)};Je.useInsertionEffect=function(t,e){return Un.current.useInsertionEffect(t,e)};Je.useLayoutEffect=function(t,e){return Un.current.useLayoutEffect(t,e)};Je.useMemo=function(t,e){return Un.current.useMemo(t,e)};Je.useReducer=function(t,e,n){return Un.current.useReducer(t,e,n)};Je.useRef=function(t){return Un.current.useRef(t)};Je.useState=function(t){return Un.current.useState(t)};Je.useSyncExternalStore=function(t,e,n){return Un.current.useSyncExternalStore(t,e,n)};Je.useTransition=function(){return Un.current.useTransition()};Je.version="18.3.1";i1.exports=Je;var v=i1.exports;const ve=s1(v),Ep=NP({__proto__:null,default:ve},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HP=v,WP=Symbol.for("react.element"),VP=Symbol.for("react.fragment"),qP=Object.prototype.hasOwnProperty,KP=HP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GP={key:!0,ref:!0,__self:!0,__source:!0};function p1(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)qP.call(e,s)&&!GP.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:WP,type:t,key:i,ref:o,props:r,_owner:KP.current}}Np.Fragment=VP;Np.jsx=p1;Np.jsxs=p1;r1.exports=Np;var c=r1.exports,Ug={},m1={exports:{}},Ts={},g1={exports:{}},x1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(E,R){var V=E.length;E.push(R);e:for(;0<V;){var K=V-1>>>1,Q=E[K];if(0<r(Q,R))E[K]=R,E[V]=Q,V=K;else break e}}function n(E){return E.length===0?null:E[0]}function s(E){if(E.length===0)return null;var R=E[0],V=E.pop();if(V!==R){E[0]=V;e:for(var K=0,Q=E.length,re=Q>>>1;K<re;){var ee=2*(K+1)-1,z=E[ee],A=ee+1,Y=E[A];if(0>r(z,V))A<Q&&0>r(Y,z)?(E[K]=Y,E[A]=V,K=A):(E[K]=z,E[ee]=V,K=ee);else if(A<Q&&0>r(Y,V))E[K]=Y,E[A]=V,K=A;else break e}}return R}function r(E,R){var V=E.sortIndex-R.sortIndex;return V!==0?V:E.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,h=null,f=3,p=!1,w=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(E){for(var R=n(u);R!==null;){if(R.callback===null)s(u);else if(R.startTime<=E)s(u),R.sortIndex=R.expirationTime,e(l,R);else break;R=n(u)}}function k(E){if(y=!1,b(E),!w)if(n(l)!==null)w=!0,F(_);else{var R=n(u);R!==null&&q(k,R.startTime-E)}}function _(E,R){w=!1,y&&(y=!1,g(j),j=-1),p=!0;var V=f;try{for(b(R),h=n(l);h!==null&&(!(h.expirationTime>R)||E&&!L());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var Q=K(h.expirationTime<=R);R=t.unstable_now(),typeof Q=="function"?h.callback=Q:h===n(l)&&s(l),b(R)}else s(l);h=n(l)}if(h!==null)var re=!0;else{var ee=n(u);ee!==null&&q(k,ee.startTime-R),re=!1}return re}finally{h=null,f=V,p=!1}}var C=!1,S=null,j=-1,N=5,P=-1;function L(){return!(t.unstable_now()-P<N)}function I(){if(S!==null){var E=t.unstable_now();P=E;var R=!0;try{R=S(!0,E)}finally{R?O():(C=!1,S=null)}}else C=!1}var O;if(typeof m=="function")O=function(){m(I)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,D=$.port2;$.port1.onmessage=I,O=function(){D.postMessage(null)}}else O=function(){x(I,0)};function F(E){S=E,C||(C=!0,O())}function q(E,R){j=x(function(){E(t.unstable_now())},R)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(E){E.callback=null},t.unstable_continueExecution=function(){w||p||(w=!0,F(_))},t.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<E?Math.floor(1e3/E):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(E){switch(f){case 1:case 2:case 3:var R=3;break;default:R=f}var V=f;f=R;try{return E()}finally{f=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(E,R){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var V=f;f=E;try{return R()}finally{f=V}},t.unstable_scheduleCallback=function(E,R,V){var K=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?K+V:K):V=K,E){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=V+Q,E={id:d++,callback:R,priorityLevel:E,startTime:V,expirationTime:Q,sortIndex:-1},V>K?(E.sortIndex=V,e(u,E),n(l)===null&&E===n(u)&&(y?(g(j),j=-1):y=!0,q(k,V-K))):(E.sortIndex=Q,e(l,E),w||p||(w=!0,F(_))),E},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(E){var R=f;return function(){var V=f;f=R;try{return E.apply(this,arguments)}finally{f=V}}}})(x1);g1.exports=x1;var YP=g1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QP=v,Es=YP;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y1=new Set,bu={};function Ca(t,e){Xl(t,e),Xl(t+"Capture",e)}function Xl(t,e){for(bu[t]=e,t=0;t<e.length;t++)y1.add(e[t])}var ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hg=Object.prototype.hasOwnProperty,XP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gb={},xb={};function JP(t){return Hg.call(xb,t)?!0:Hg.call(gb,t)?!1:XP.test(t)?xb[t]=!0:(gb[t]=!0,!1)}function ZP(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function eR(t,e,n,s){if(e===null||typeof e>"u"||ZP(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hn(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var wn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){wn[t]=new Hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];wn[e]=new Hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){wn[t]=new Hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){wn[t]=new Hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){wn[t]=new Hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){wn[t]=new Hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){wn[t]=new Hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){wn[t]=new Hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){wn[t]=new Hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Qy=/[\-:]([a-z])/g;function Xy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Qy,Xy);wn[e]=new Hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Qy,Xy);wn[e]=new Hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Qy,Xy);wn[e]=new Hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){wn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!1,!1)});wn.xlinkHref=new Hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){wn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jy(t,e,n,s){var r=wn.hasOwnProperty(e)?wn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(eR(e,n,r,s)&&(n=null),s||r===null?JP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var xi=QP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,th=Symbol.for("react.element"),il=Symbol.for("react.portal"),ol=Symbol.for("react.fragment"),Zy=Symbol.for("react.strict_mode"),Wg=Symbol.for("react.profiler"),v1=Symbol.for("react.provider"),b1=Symbol.for("react.context"),ev=Symbol.for("react.forward_ref"),Vg=Symbol.for("react.suspense"),qg=Symbol.for("react.suspense_list"),tv=Symbol.for("react.memo"),Ni=Symbol.for("react.lazy"),w1=Symbol.for("react.offscreen"),yb=Symbol.iterator;function Ec(t){return t===null||typeof t!="object"?null:(t=yb&&t[yb]||t["@@iterator"],typeof t=="function"?t:null)}var Ut=Object.assign,bm;function qc(t){if(bm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);bm=e&&e[1]||""}return`
`+bm+t}var wm=!1;function km(t,e){if(!t||wm)return"";wm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{wm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?qc(t):""}function tR(t){switch(t.tag){case 5:return qc(t.type);case 16:return qc("Lazy");case 13:return qc("Suspense");case 19:return qc("SuspenseList");case 0:case 2:case 15:return t=km(t.type,!1),t;case 11:return t=km(t.type.render,!1),t;case 1:return t=km(t.type,!0),t;default:return""}}function Kg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ol:return"Fragment";case il:return"Portal";case Wg:return"Profiler";case Zy:return"StrictMode";case Vg:return"Suspense";case qg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case b1:return(t.displayName||"Context")+".Consumer";case v1:return(t._context.displayName||"Context")+".Provider";case ev:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tv:return e=t.displayName||null,e!==null?e:Kg(t.type)||"Memo";case Ni:e=t._payload,t=t._init;try{return Kg(t(e))}catch{}}return null}function nR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kg(e);case 8:return e===Zy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function co(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function k1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sR(t){var e=k1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nh(t){t._valueTracker||(t._valueTracker=sR(t))}function _1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=k1(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Pf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gg(t,e){var n=e.checked;return Ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function vb(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=co(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function S1(t,e){e=e.checked,e!=null&&Jy(t,"checked",e,!1)}function Yg(t,e){S1(t,e);var n=co(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Qg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Qg(t,e.type,co(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Qg(t,e,n){(e!=="number"||Pf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Kc=Array.isArray;function bl(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+co(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Xg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return Ut({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(fe(92));if(Kc(n)){if(1<n.length)throw Error(fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:co(n)}}function j1(t,e){var n=co(e.value),s=co(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function kb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function C1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?C1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sh,N1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sh=sh||document.createElement("div"),sh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function wu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ru={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rR=["Webkit","ms","Moz","O"];Object.keys(ru).forEach(function(t){rR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ru[e]=ru[t]})});function E1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ru.hasOwnProperty(t)&&ru[t]?(""+e).trim():e+"px"}function T1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=E1(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var iR=Ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zg(t,e){if(e){if(iR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function ex(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tx=null;function nv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var nx=null,wl=null,kl=null;function _b(t){if(t=_d(t)){if(typeof nx!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=Op(e),nx(t.stateNode,t.type,e))}}function P1(t){wl?kl?kl.push(t):kl=[t]:wl=t}function R1(){if(wl){var t=wl,e=kl;if(kl=wl=null,_b(t),e)for(t=0;t<e.length;t++)_b(e[t])}}function A1(t,e){return t(e)}function O1(){}var _m=!1;function M1(t,e,n){if(_m)return t(e,n);_m=!0;try{return A1(t,e,n)}finally{_m=!1,(wl!==null||kl!==null)&&(O1(),R1())}}function ku(t,e){var n=t.stateNode;if(n===null)return null;var s=Op(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(fe(231,e,typeof n));return n}var sx=!1;if(ci)try{var Tc={};Object.defineProperty(Tc,"passive",{get:function(){sx=!0}}),window.addEventListener("test",Tc,Tc),window.removeEventListener("test",Tc,Tc)}catch{sx=!1}function oR(t,e,n,s,r,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var iu=!1,Rf=null,Af=!1,rx=null,aR={onError:function(t){iu=!0,Rf=t}};function lR(t,e,n,s,r,i,o,a,l){iu=!1,Rf=null,oR.apply(aR,arguments)}function cR(t,e,n,s,r,i,o,a,l){if(lR.apply(this,arguments),iu){if(iu){var u=Rf;iu=!1,Rf=null}else throw Error(fe(198));Af||(Af=!0,rx=u)}}function Na(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function I1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Sb(t){if(Na(t)!==t)throw Error(fe(188))}function uR(t){var e=t.alternate;if(!e){if(e=Na(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return Sb(r),t;if(i===s)return Sb(r),e;i=i.sibling}throw Error(fe(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(fe(189))}}if(n.alternate!==s)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?t:e}function D1(t){return t=uR(t),t!==null?L1(t):null}function L1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=L1(t);if(e!==null)return e;t=t.sibling}return null}var $1=Es.unstable_scheduleCallback,jb=Es.unstable_cancelCallback,dR=Es.unstable_shouldYield,hR=Es.unstable_requestPaint,Jt=Es.unstable_now,fR=Es.unstable_getCurrentPriorityLevel,sv=Es.unstable_ImmediatePriority,F1=Es.unstable_UserBlockingPriority,Of=Es.unstable_NormalPriority,pR=Es.unstable_LowPriority,z1=Es.unstable_IdlePriority,Tp=null,Dr=null;function mR(t){if(Dr&&typeof Dr.onCommitFiberRoot=="function")try{Dr.onCommitFiberRoot(Tp,t,void 0,(t.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:yR,gR=Math.log,xR=Math.LN2;function yR(t){return t>>>=0,t===0?32:31-(gR(t)/xR|0)|0}var rh=64,ih=4194304;function Gc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Mf(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Gc(a):(i&=o,i!==0&&(s=Gc(i)))}else o=n&~r,o!==0?s=Gc(o):i!==0&&(s=Gc(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-lr(e),r=1<<n,s|=t[n],e&=~r;return s}function vR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bR(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-lr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=vR(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function ix(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function B1(){var t=rh;return rh<<=1,!(rh&4194240)&&(rh=64),t}function Sm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lr(e),t[e]=n}function wR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-lr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function rv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-lr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var xt=0;function U1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var H1,iv,W1,V1,q1,ox=!1,oh=[],Xi=null,Ji=null,Zi=null,_u=new Map,Su=new Map,Pi=[],kR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cb(t,e){switch(t){case"focusin":case"focusout":Xi=null;break;case"dragenter":case"dragleave":Ji=null;break;case"mouseover":case"mouseout":Zi=null;break;case"pointerover":case"pointerout":_u.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Su.delete(e.pointerId)}}function Pc(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=_d(e),e!==null&&iv(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function _R(t,e,n,s,r){switch(e){case"focusin":return Xi=Pc(Xi,t,e,n,s,r),!0;case"dragenter":return Ji=Pc(Ji,t,e,n,s,r),!0;case"mouseover":return Zi=Pc(Zi,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return _u.set(i,Pc(_u.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Su.set(i,Pc(Su.get(i)||null,t,e,n,s,r)),!0}return!1}function K1(t){var e=qo(t.target);if(e!==null){var n=Na(e);if(n!==null){if(e=n.tag,e===13){if(e=I1(n),e!==null){t.blockedOn=e,q1(t.priority,function(){W1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function rf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ax(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);tx=s,n.target.dispatchEvent(s),tx=null}else return e=_d(n),e!==null&&iv(e),t.blockedOn=n,!1;e.shift()}return!0}function Nb(t,e,n){rf(t)&&n.delete(e)}function SR(){ox=!1,Xi!==null&&rf(Xi)&&(Xi=null),Ji!==null&&rf(Ji)&&(Ji=null),Zi!==null&&rf(Zi)&&(Zi=null),_u.forEach(Nb),Su.forEach(Nb)}function Rc(t,e){t.blockedOn===e&&(t.blockedOn=null,ox||(ox=!0,Es.unstable_scheduleCallback(Es.unstable_NormalPriority,SR)))}function ju(t){function e(r){return Rc(r,t)}if(0<oh.length){Rc(oh[0],t);for(var n=1;n<oh.length;n++){var s=oh[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Xi!==null&&Rc(Xi,t),Ji!==null&&Rc(Ji,t),Zi!==null&&Rc(Zi,t),_u.forEach(e),Su.forEach(e),n=0;n<Pi.length;n++)s=Pi[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Pi.length&&(n=Pi[0],n.blockedOn===null);)K1(n),n.blockedOn===null&&Pi.shift()}var _l=xi.ReactCurrentBatchConfig,If=!0;function jR(t,e,n,s){var r=xt,i=_l.transition;_l.transition=null;try{xt=1,ov(t,e,n,s)}finally{xt=r,_l.transition=i}}function CR(t,e,n,s){var r=xt,i=_l.transition;_l.transition=null;try{xt=4,ov(t,e,n,s)}finally{xt=r,_l.transition=i}}function ov(t,e,n,s){if(If){var r=ax(t,e,n,s);if(r===null)Mm(t,e,s,Df,n),Cb(t,s);else if(_R(r,t,e,n,s))s.stopPropagation();else if(Cb(t,s),e&4&&-1<kR.indexOf(t)){for(;r!==null;){var i=_d(r);if(i!==null&&H1(i),i=ax(t,e,n,s),i===null&&Mm(t,e,s,Df,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Mm(t,e,s,null,n)}}var Df=null;function ax(t,e,n,s){if(Df=null,t=nv(s),t=qo(t),t!==null)if(e=Na(t),e===null)t=null;else if(n=e.tag,n===13){if(t=I1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Df=t,null}function G1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fR()){case sv:return 1;case F1:return 4;case Of:case pR:return 16;case z1:return 536870912;default:return 16}default:return 16}}var Wi=null,av=null,of=null;function Y1(){if(of)return of;var t,e=av,n=e.length,s,r="value"in Wi?Wi.value:Wi.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return of=r.slice(t,1<s?1-s:void 0)}function af(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ah(){return!0}function Eb(){return!1}function Ps(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ah:Eb,this.isPropagationStopped=Eb,this}return Ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ah)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ah)},persist:function(){},isPersistent:ah}),e}var ac={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lv=Ps(ac),kd=Ut({},ac,{view:0,detail:0}),NR=Ps(kd),jm,Cm,Ac,Pp=Ut({},kd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ac&&(Ac&&t.type==="mousemove"?(jm=t.screenX-Ac.screenX,Cm=t.screenY-Ac.screenY):Cm=jm=0,Ac=t),jm)},movementY:function(t){return"movementY"in t?t.movementY:Cm}}),Tb=Ps(Pp),ER=Ut({},Pp,{dataTransfer:0}),TR=Ps(ER),PR=Ut({},kd,{relatedTarget:0}),Nm=Ps(PR),RR=Ut({},ac,{animationName:0,elapsedTime:0,pseudoElement:0}),AR=Ps(RR),OR=Ut({},ac,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),MR=Ps(OR),IR=Ut({},ac,{data:0}),Pb=Ps(IR),DR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$R={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=$R[t])?!!e[t]:!1}function cv(){return FR}var zR=Ut({},kd,{key:function(t){if(t.key){var e=DR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=af(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?LR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cv,charCode:function(t){return t.type==="keypress"?af(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?af(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),BR=Ps(zR),UR=Ut({},Pp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rb=Ps(UR),HR=Ut({},kd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cv}),WR=Ps(HR),VR=Ut({},ac,{propertyName:0,elapsedTime:0,pseudoElement:0}),qR=Ps(VR),KR=Ut({},Pp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GR=Ps(KR),YR=[9,13,27,32],uv=ci&&"CompositionEvent"in window,ou=null;ci&&"documentMode"in document&&(ou=document.documentMode);var QR=ci&&"TextEvent"in window&&!ou,Q1=ci&&(!uv||ou&&8<ou&&11>=ou),Ab=" ",Ob=!1;function X1(t,e){switch(t){case"keyup":return YR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function J1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var al=!1;function XR(t,e){switch(t){case"compositionend":return J1(e);case"keypress":return e.which!==32?null:(Ob=!0,Ab);case"textInput":return t=e.data,t===Ab&&Ob?null:t;default:return null}}function JR(t,e){if(al)return t==="compositionend"||!uv&&X1(t,e)?(t=Y1(),of=av=Wi=null,al=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Q1&&e.locale!=="ko"?null:e.data;default:return null}}var ZR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ZR[t.type]:e==="textarea"}function Z1(t,e,n,s){P1(s),e=Lf(e,"onChange"),0<e.length&&(n=new lv("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var au=null,Cu=null;function eA(t){uj(t,0)}function Rp(t){var e=ul(t);if(_1(e))return t}function tA(t,e){if(t==="change")return e}var ej=!1;if(ci){var Em;if(ci){var Tm="oninput"in document;if(!Tm){var Ib=document.createElement("div");Ib.setAttribute("oninput","return;"),Tm=typeof Ib.oninput=="function"}Em=Tm}else Em=!1;ej=Em&&(!document.documentMode||9<document.documentMode)}function Db(){au&&(au.detachEvent("onpropertychange",tj),Cu=au=null)}function tj(t){if(t.propertyName==="value"&&Rp(Cu)){var e=[];Z1(e,Cu,t,nv(t)),M1(eA,e)}}function nA(t,e,n){t==="focusin"?(Db(),au=e,Cu=n,au.attachEvent("onpropertychange",tj)):t==="focusout"&&Db()}function sA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Rp(Cu)}function rA(t,e){if(t==="click")return Rp(e)}function iA(t,e){if(t==="input"||t==="change")return Rp(e)}function oA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dr=typeof Object.is=="function"?Object.is:oA;function Nu(t,e){if(dr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Hg.call(e,r)||!dr(t[r],e[r]))return!1}return!0}function Lb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $b(t,e){var n=Lb(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Lb(n)}}function nj(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nj(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sj(){for(var t=window,e=Pf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Pf(t.document)}return e}function dv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function aA(t){var e=sj(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nj(n.ownerDocument.documentElement,n)){if(s!==null&&dv(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=$b(n,i);var o=$b(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lA=ci&&"documentMode"in document&&11>=document.documentMode,ll=null,lx=null,lu=null,cx=!1;function Fb(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cx||ll==null||ll!==Pf(s)||(s=ll,"selectionStart"in s&&dv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),lu&&Nu(lu,s)||(lu=s,s=Lf(lx,"onSelect"),0<s.length&&(e=new lv("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=ll)))}function lh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var cl={animationend:lh("Animation","AnimationEnd"),animationiteration:lh("Animation","AnimationIteration"),animationstart:lh("Animation","AnimationStart"),transitionend:lh("Transition","TransitionEnd")},Pm={},rj={};ci&&(rj=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function Ap(t){if(Pm[t])return Pm[t];if(!cl[t])return t;var e=cl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rj)return Pm[t]=e[n];return t}var ij=Ap("animationend"),oj=Ap("animationiteration"),aj=Ap("animationstart"),lj=Ap("transitionend"),cj=new Map,zb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yo(t,e){cj.set(t,e),Ca(e,[t])}for(var Rm=0;Rm<zb.length;Rm++){var Am=zb[Rm],cA=Am.toLowerCase(),uA=Am[0].toUpperCase()+Am.slice(1);yo(cA,"on"+uA)}yo(ij,"onAnimationEnd");yo(oj,"onAnimationIteration");yo(aj,"onAnimationStart");yo("dblclick","onDoubleClick");yo("focusin","onFocus");yo("focusout","onBlur");yo(lj,"onTransitionEnd");Xl("onMouseEnter",["mouseout","mouseover"]);Xl("onMouseLeave",["mouseout","mouseover"]);Xl("onPointerEnter",["pointerout","pointerover"]);Xl("onPointerLeave",["pointerout","pointerover"]);Ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ca("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yc));function Bb(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,cR(s,e,void 0,t),t.currentTarget=null}function uj(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;Bb(r,a,u),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;Bb(r,a,u),i=l}}}if(Af)throw t=rx,Af=!1,rx=null,t}function Nt(t,e){var n=e[px];n===void 0&&(n=e[px]=new Set);var s=t+"__bubble";n.has(s)||(dj(e,t,2,!1),n.add(s))}function Om(t,e,n){var s=0;e&&(s|=4),dj(n,t,s,e)}var ch="_reactListening"+Math.random().toString(36).slice(2);function Eu(t){if(!t[ch]){t[ch]=!0,y1.forEach(function(n){n!=="selectionchange"&&(dA.has(n)||Om(n,!1,t),Om(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ch]||(e[ch]=!0,Om("selectionchange",!1,e))}}function dj(t,e,n,s){switch(G1(e)){case 1:var r=jR;break;case 4:r=CR;break;default:r=ov}n=r.bind(null,e,n,t),r=void 0,!sx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Mm(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=qo(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}M1(function(){var u=i,d=nv(n),h=[];e:{var f=cj.get(t);if(f!==void 0){var p=lv,w=t;switch(t){case"keypress":if(af(n)===0)break e;case"keydown":case"keyup":p=BR;break;case"focusin":w="focus",p=Nm;break;case"focusout":w="blur",p=Nm;break;case"beforeblur":case"afterblur":p=Nm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Tb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=TR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=WR;break;case ij:case oj:case aj:p=AR;break;case lj:p=qR;break;case"scroll":p=NR;break;case"wheel":p=GR;break;case"copy":case"cut":case"paste":p=MR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Rb}var y=(e&4)!==0,x=!y&&t==="scroll",g=y?f!==null?f+"Capture":null:f;y=[];for(var m=u,b;m!==null;){b=m;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,g!==null&&(k=ku(m,g),k!=null&&y.push(Tu(m,k,b)))),x)break;m=m.return}0<y.length&&(f=new p(f,w,null,n,d),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==tx&&(w=n.relatedTarget||n.fromElement)&&(qo(w)||w[ui]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(w=n.relatedTarget||n.toElement,p=u,w=w?qo(w):null,w!==null&&(x=Na(w),w!==x||w.tag!==5&&w.tag!==6)&&(w=null)):(p=null,w=u),p!==w)){if(y=Tb,k="onMouseLeave",g="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(y=Rb,k="onPointerLeave",g="onPointerEnter",m="pointer"),x=p==null?f:ul(p),b=w==null?f:ul(w),f=new y(k,m+"leave",p,n,d),f.target=x,f.relatedTarget=b,k=null,qo(d)===u&&(y=new y(g,m+"enter",w,n,d),y.target=b,y.relatedTarget=x,k=y),x=k,p&&w)t:{for(y=p,g=w,m=0,b=y;b;b=Ua(b))m++;for(b=0,k=g;k;k=Ua(k))b++;for(;0<m-b;)y=Ua(y),m--;for(;0<b-m;)g=Ua(g),b--;for(;m--;){if(y===g||g!==null&&y===g.alternate)break t;y=Ua(y),g=Ua(g)}y=null}else y=null;p!==null&&Ub(h,f,p,y,!1),w!==null&&x!==null&&Ub(h,x,w,y,!0)}}e:{if(f=u?ul(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var _=tA;else if(Mb(f))if(ej)_=iA;else{_=sA;var C=nA}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=rA);if(_&&(_=_(t,u))){Z1(h,_,n,d);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Qg(f,"number",f.value)}switch(C=u?ul(u):window,t){case"focusin":(Mb(C)||C.contentEditable==="true")&&(ll=C,lx=u,lu=null);break;case"focusout":lu=lx=ll=null;break;case"mousedown":cx=!0;break;case"contextmenu":case"mouseup":case"dragend":cx=!1,Fb(h,n,d);break;case"selectionchange":if(lA)break;case"keydown":case"keyup":Fb(h,n,d)}var S;if(uv)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else al?X1(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(Q1&&n.locale!=="ko"&&(al||j!=="onCompositionStart"?j==="onCompositionEnd"&&al&&(S=Y1()):(Wi=d,av="value"in Wi?Wi.value:Wi.textContent,al=!0)),C=Lf(u,j),0<C.length&&(j=new Pb(j,t,null,n,d),h.push({event:j,listeners:C}),S?j.data=S:(S=J1(n),S!==null&&(j.data=S)))),(S=QR?XR(t,n):JR(t,n))&&(u=Lf(u,"onBeforeInput"),0<u.length&&(d=new Pb("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=S))}uj(h,e)})}function Tu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Lf(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=ku(t,n),i!=null&&s.unshift(Tu(t,i,r)),i=ku(t,e),i!=null&&s.push(Tu(t,i,r))),t=t.return}return s}function Ua(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ub(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&u!==null&&(a=u,r?(l=ku(n,i),l!=null&&o.unshift(Tu(n,l,a))):r||(l=ku(n,i),l!=null&&o.push(Tu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var hA=/\r\n?/g,fA=/\u0000|\uFFFD/g;function Hb(t){return(typeof t=="string"?t:""+t).replace(hA,`
`).replace(fA,"")}function uh(t,e,n){if(e=Hb(e),Hb(t)!==e&&n)throw Error(fe(425))}function $f(){}var ux=null,dx=null;function hx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fx=typeof setTimeout=="function"?setTimeout:void 0,pA=typeof clearTimeout=="function"?clearTimeout:void 0,Wb=typeof Promise=="function"?Promise:void 0,mA=typeof queueMicrotask=="function"?queueMicrotask:typeof Wb<"u"?function(t){return Wb.resolve(null).then(t).catch(gA)}:fx;function gA(t){setTimeout(function(){throw t})}function Im(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),ju(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);ju(e)}function eo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Vb(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var lc=Math.random().toString(36).slice(2),Ar="__reactFiber$"+lc,Pu="__reactProps$"+lc,ui="__reactContainer$"+lc,px="__reactEvents$"+lc,xA="__reactListeners$"+lc,yA="__reactHandles$"+lc;function qo(t){var e=t[Ar];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ui]||n[Ar]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Vb(t);t!==null;){if(n=t[Ar])return n;t=Vb(t)}return e}t=n,n=t.parentNode}return null}function _d(t){return t=t[Ar]||t[ui],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ul(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function Op(t){return t[Pu]||null}var mx=[],dl=-1;function vo(t){return{current:t}}function Rt(t){0>dl||(t.current=mx[dl],mx[dl]=null,dl--)}function _t(t,e){dl++,mx[dl]=t.current,t.current=e}var uo={},On=vo(uo),is=vo(!1),pa=uo;function Jl(t,e){var n=t.type.contextTypes;if(!n)return uo;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function os(t){return t=t.childContextTypes,t!=null}function Ff(){Rt(is),Rt(On)}function qb(t,e,n){if(On.current!==uo)throw Error(fe(168));_t(On,e),_t(is,n)}function hj(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(fe(108,nR(t)||"Unknown",r));return Ut({},n,s)}function zf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||uo,pa=On.current,_t(On,t),_t(is,is.current),!0}function Kb(t,e,n){var s=t.stateNode;if(!s)throw Error(fe(169));n?(t=hj(t,e,pa),s.__reactInternalMemoizedMergedChildContext=t,Rt(is),Rt(On),_t(On,t)):Rt(is),_t(is,n)}var Qr=null,Mp=!1,Dm=!1;function fj(t){Qr===null?Qr=[t]:Qr.push(t)}function vA(t){Mp=!0,fj(t)}function bo(){if(!Dm&&Qr!==null){Dm=!0;var t=0,e=xt;try{var n=Qr;for(xt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Qr=null,Mp=!1}catch(r){throw Qr!==null&&(Qr=Qr.slice(t+1)),$1(sv,bo),r}finally{xt=e,Dm=!1}}return null}var hl=[],fl=0,Bf=null,Uf=0,Ds=[],Ls=0,ma=null,ni=1,si="";function Fo(t,e){hl[fl++]=Uf,hl[fl++]=Bf,Bf=t,Uf=e}function pj(t,e,n){Ds[Ls++]=ni,Ds[Ls++]=si,Ds[Ls++]=ma,ma=t;var s=ni;t=si;var r=32-lr(s)-1;s&=~(1<<r),n+=1;var i=32-lr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,ni=1<<32-lr(e)+r|n<<r|s,si=i+t}else ni=1<<i|n<<r|s,si=t}function hv(t){t.return!==null&&(Fo(t,1),pj(t,1,0))}function fv(t){for(;t===Bf;)Bf=hl[--fl],hl[fl]=null,Uf=hl[--fl],hl[fl]=null;for(;t===ma;)ma=Ds[--Ls],Ds[Ls]=null,si=Ds[--Ls],Ds[Ls]=null,ni=Ds[--Ls],Ds[Ls]=null}var Ss=null,_s=null,Dt=!1,ar=null;function mj(t,e){var n=$s(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Gb(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ss=t,_s=eo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ss=t,_s=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ma!==null?{id:ni,overflow:si}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=$s(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ss=t,_s=null,!0):!1;default:return!1}}function gx(t){return(t.mode&1)!==0&&(t.flags&128)===0}function xx(t){if(Dt){var e=_s;if(e){var n=e;if(!Gb(t,e)){if(gx(t))throw Error(fe(418));e=eo(n.nextSibling);var s=Ss;e&&Gb(t,e)?mj(s,n):(t.flags=t.flags&-4097|2,Dt=!1,Ss=t)}}else{if(gx(t))throw Error(fe(418));t.flags=t.flags&-4097|2,Dt=!1,Ss=t}}}function Yb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ss=t}function dh(t){if(t!==Ss)return!1;if(!Dt)return Yb(t),Dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hx(t.type,t.memoizedProps)),e&&(e=_s)){if(gx(t))throw gj(),Error(fe(418));for(;e;)mj(t,e),e=eo(e.nextSibling)}if(Yb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){_s=eo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}_s=null}}else _s=Ss?eo(t.stateNode.nextSibling):null;return!0}function gj(){for(var t=_s;t;)t=eo(t.nextSibling)}function Zl(){_s=Ss=null,Dt=!1}function pv(t){ar===null?ar=[t]:ar.push(t)}var bA=xi.ReactCurrentBatchConfig;function Oc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var s=n.stateNode}if(!s)throw Error(fe(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,t))}return t}function hh(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qb(t){var e=t._init;return e(t._payload)}function xj(t){function e(g,m){if(t){var b=g.deletions;b===null?(g.deletions=[m],g.flags|=16):b.push(m)}}function n(g,m){if(!t)return null;for(;m!==null;)e(g,m),m=m.sibling;return null}function s(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function r(g,m){return g=ro(g,m),g.index=0,g.sibling=null,g}function i(g,m,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<m?(g.flags|=2,m):b):(g.flags|=2,m)):(g.flags|=1048576,m)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,m,b,k){return m===null||m.tag!==6?(m=Hm(b,g.mode,k),m.return=g,m):(m=r(m,b),m.return=g,m)}function l(g,m,b,k){var _=b.type;return _===ol?d(g,m,b.props.children,k,b.key):m!==null&&(m.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ni&&Qb(_)===m.type)?(k=r(m,b.props),k.ref=Oc(g,m,b),k.return=g,k):(k=pf(b.type,b.key,b.props,null,g.mode,k),k.ref=Oc(g,m,b),k.return=g,k)}function u(g,m,b,k){return m===null||m.tag!==4||m.stateNode.containerInfo!==b.containerInfo||m.stateNode.implementation!==b.implementation?(m=Wm(b,g.mode,k),m.return=g,m):(m=r(m,b.children||[]),m.return=g,m)}function d(g,m,b,k,_){return m===null||m.tag!==7?(m=ca(b,g.mode,k,_),m.return=g,m):(m=r(m,b),m.return=g,m)}function h(g,m,b){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Hm(""+m,g.mode,b),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case th:return b=pf(m.type,m.key,m.props,null,g.mode,b),b.ref=Oc(g,null,m),b.return=g,b;case il:return m=Wm(m,g.mode,b),m.return=g,m;case Ni:var k=m._init;return h(g,k(m._payload),b)}if(Kc(m)||Ec(m))return m=ca(m,g.mode,b,null),m.return=g,m;hh(g,m)}return null}function f(g,m,b,k){var _=m!==null?m.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:a(g,m,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case th:return b.key===_?l(g,m,b,k):null;case il:return b.key===_?u(g,m,b,k):null;case Ni:return _=b._init,f(g,m,_(b._payload),k)}if(Kc(b)||Ec(b))return _!==null?null:d(g,m,b,k,null);hh(g,b)}return null}function p(g,m,b,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(b)||null,a(m,g,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case th:return g=g.get(k.key===null?b:k.key)||null,l(m,g,k,_);case il:return g=g.get(k.key===null?b:k.key)||null,u(m,g,k,_);case Ni:var C=k._init;return p(g,m,b,C(k._payload),_)}if(Kc(k)||Ec(k))return g=g.get(b)||null,d(m,g,k,_,null);hh(m,k)}return null}function w(g,m,b,k){for(var _=null,C=null,S=m,j=m=0,N=null;S!==null&&j<b.length;j++){S.index>j?(N=S,S=null):N=S.sibling;var P=f(g,S,b[j],k);if(P===null){S===null&&(S=N);break}t&&S&&P.alternate===null&&e(g,S),m=i(P,m,j),C===null?_=P:C.sibling=P,C=P,S=N}if(j===b.length)return n(g,S),Dt&&Fo(g,j),_;if(S===null){for(;j<b.length;j++)S=h(g,b[j],k),S!==null&&(m=i(S,m,j),C===null?_=S:C.sibling=S,C=S);return Dt&&Fo(g,j),_}for(S=s(g,S);j<b.length;j++)N=p(S,g,j,b[j],k),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?j:N.key),m=i(N,m,j),C===null?_=N:C.sibling=N,C=N);return t&&S.forEach(function(L){return e(g,L)}),Dt&&Fo(g,j),_}function y(g,m,b,k){var _=Ec(b);if(typeof _!="function")throw Error(fe(150));if(b=_.call(b),b==null)throw Error(fe(151));for(var C=_=null,S=m,j=m=0,N=null,P=b.next();S!==null&&!P.done;j++,P=b.next()){S.index>j?(N=S,S=null):N=S.sibling;var L=f(g,S,P.value,k);if(L===null){S===null&&(S=N);break}t&&S&&L.alternate===null&&e(g,S),m=i(L,m,j),C===null?_=L:C.sibling=L,C=L,S=N}if(P.done)return n(g,S),Dt&&Fo(g,j),_;if(S===null){for(;!P.done;j++,P=b.next())P=h(g,P.value,k),P!==null&&(m=i(P,m,j),C===null?_=P:C.sibling=P,C=P);return Dt&&Fo(g,j),_}for(S=s(g,S);!P.done;j++,P=b.next())P=p(S,g,j,P.value,k),P!==null&&(t&&P.alternate!==null&&S.delete(P.key===null?j:P.key),m=i(P,m,j),C===null?_=P:C.sibling=P,C=P);return t&&S.forEach(function(I){return e(g,I)}),Dt&&Fo(g,j),_}function x(g,m,b,k){if(typeof b=="object"&&b!==null&&b.type===ol&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case th:e:{for(var _=b.key,C=m;C!==null;){if(C.key===_){if(_=b.type,_===ol){if(C.tag===7){n(g,C.sibling),m=r(C,b.props.children),m.return=g,g=m;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ni&&Qb(_)===C.type){n(g,C.sibling),m=r(C,b.props),m.ref=Oc(g,C,b),m.return=g,g=m;break e}n(g,C);break}else e(g,C);C=C.sibling}b.type===ol?(m=ca(b.props.children,g.mode,k,b.key),m.return=g,g=m):(k=pf(b.type,b.key,b.props,null,g.mode,k),k.ref=Oc(g,m,b),k.return=g,g=k)}return o(g);case il:e:{for(C=b.key;m!==null;){if(m.key===C)if(m.tag===4&&m.stateNode.containerInfo===b.containerInfo&&m.stateNode.implementation===b.implementation){n(g,m.sibling),m=r(m,b.children||[]),m.return=g,g=m;break e}else{n(g,m);break}else e(g,m);m=m.sibling}m=Wm(b,g.mode,k),m.return=g,g=m}return o(g);case Ni:return C=b._init,x(g,m,C(b._payload),k)}if(Kc(b))return w(g,m,b,k);if(Ec(b))return y(g,m,b,k);hh(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,m!==null&&m.tag===6?(n(g,m.sibling),m=r(m,b),m.return=g,g=m):(n(g,m),m=Hm(b,g.mode,k),m.return=g,g=m),o(g)):n(g,m)}return x}var ec=xj(!0),yj=xj(!1),Hf=vo(null),Wf=null,pl=null,mv=null;function gv(){mv=pl=Wf=null}function xv(t){var e=Hf.current;Rt(Hf),t._currentValue=e}function yx(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Sl(t,e){Wf=t,mv=pl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ts=!0),t.firstContext=null)}function Hs(t){var e=t._currentValue;if(mv!==t)if(t={context:t,memoizedValue:e,next:null},pl===null){if(Wf===null)throw Error(fe(308));pl=t,Wf.dependencies={lanes:0,firstContext:t}}else pl=pl.next=t;return e}var Ko=null;function yv(t){Ko===null?Ko=[t]:Ko.push(t)}function vj(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,yv(e)):(n.next=r.next,r.next=n),e.interleaved=n,di(t,s)}function di(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ei=!1;function vv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bj(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function oi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function to(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,st&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,di(t,n)}return r=s.interleaved,r===null?(e.next=e,yv(s)):(e.next=r.next,r.next=e),s.interleaved=e,di(t,n)}function lf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,rv(t,n)}}function Xb(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Vf(t,e,n,s){var r=t.updateQueue;Ei=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,d=u=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=t,y=a;switch(f=e,p=n,y.tag){case 1:if(w=y.payload,typeof w=="function"){h=w.call(p,h,f);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=y.payload,f=typeof w=="function"?w.call(p,h,f):w,f==null)break e;h=Ut({},h,f);break e;case 2:Ei=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,l=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(d===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);xa|=o,t.lanes=o,t.memoizedState=h}}function Jb(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(fe(191,r));r.call(s)}}}var Sd={},Lr=vo(Sd),Ru=vo(Sd),Au=vo(Sd);function Go(t){if(t===Sd)throw Error(fe(174));return t}function bv(t,e){switch(_t(Au,e),_t(Ru,t),_t(Lr,Sd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Jg(e,t)}Rt(Lr),_t(Lr,e)}function tc(){Rt(Lr),Rt(Ru),Rt(Au)}function wj(t){Go(Au.current);var e=Go(Lr.current),n=Jg(e,t.type);e!==n&&(_t(Ru,t),_t(Lr,n))}function wv(t){Ru.current===t&&(Rt(Lr),Rt(Ru))}var Ft=vo(0);function qf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Lm=[];function kv(){for(var t=0;t<Lm.length;t++)Lm[t]._workInProgressVersionPrimary=null;Lm.length=0}var cf=xi.ReactCurrentDispatcher,$m=xi.ReactCurrentBatchConfig,ga=0,Bt=null,an=null,fn=null,Kf=!1,cu=!1,Ou=0,wA=0;function Cn(){throw Error(fe(321))}function _v(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dr(t[n],e[n]))return!1;return!0}function Sv(t,e,n,s,r,i){if(ga=i,Bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cf.current=t===null||t.memoizedState===null?jA:CA,t=n(s,r),cu){i=0;do{if(cu=!1,Ou=0,25<=i)throw Error(fe(301));i+=1,fn=an=null,e.updateQueue=null,cf.current=NA,t=n(s,r)}while(cu)}if(cf.current=Gf,e=an!==null&&an.next!==null,ga=0,fn=an=Bt=null,Kf=!1,e)throw Error(fe(300));return t}function jv(){var t=Ou!==0;return Ou=0,t}function Sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?Bt.memoizedState=fn=t:fn=fn.next=t,fn}function Ws(){if(an===null){var t=Bt.alternate;t=t!==null?t.memoizedState:null}else t=an.next;var e=fn===null?Bt.memoizedState:fn.next;if(e!==null)fn=e,an=t;else{if(t===null)throw Error(fe(310));an=t,t={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},fn===null?Bt.memoizedState=fn=t:fn=fn.next=t}return fn}function Mu(t,e){return typeof e=="function"?e(t):e}function Fm(t){var e=Ws(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var s=an,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,u=i;do{var d=u.lane;if((ga&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,Bt.lanes|=d,xa|=d}u=u.next}while(u!==null&&u!==i);l===null?o=s:l.next=a,dr(s,e.memoizedState)||(ts=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Bt.lanes|=i,xa|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zm(t){var e=Ws(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);dr(i,e.memoizedState)||(ts=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function kj(){}function _j(t,e){var n=Bt,s=Ws(),r=e(),i=!dr(s.memoizedState,r);if(i&&(s.memoizedState=r,ts=!0),s=s.queue,Cv(Cj.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||fn!==null&&fn.memoizedState.tag&1){if(n.flags|=2048,Iu(9,jj.bind(null,n,s,r,e),void 0,null),mn===null)throw Error(fe(349));ga&30||Sj(n,e,r)}return r}function Sj(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function jj(t,e,n,s){e.value=n,e.getSnapshot=s,Nj(e)&&Ej(t)}function Cj(t,e,n){return n(function(){Nj(e)&&Ej(t)})}function Nj(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dr(t,n)}catch{return!0}}function Ej(t){var e=di(t,1);e!==null&&cr(e,t,1,-1)}function Zb(t){var e=Sr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mu,lastRenderedState:t},e.queue=t,t=t.dispatch=SA.bind(null,Bt,t),[e.memoizedState,t]}function Iu(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function Tj(){return Ws().memoizedState}function uf(t,e,n,s){var r=Sr();Bt.flags|=t,r.memoizedState=Iu(1|e,n,void 0,s===void 0?null:s)}function Ip(t,e,n,s){var r=Ws();s=s===void 0?null:s;var i=void 0;if(an!==null){var o=an.memoizedState;if(i=o.destroy,s!==null&&_v(s,o.deps)){r.memoizedState=Iu(e,n,i,s);return}}Bt.flags|=t,r.memoizedState=Iu(1|e,n,i,s)}function ew(t,e){return uf(8390656,8,t,e)}function Cv(t,e){return Ip(2048,8,t,e)}function Pj(t,e){return Ip(4,2,t,e)}function Rj(t,e){return Ip(4,4,t,e)}function Aj(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Oj(t,e,n){return n=n!=null?n.concat([t]):null,Ip(4,4,Aj.bind(null,e,t),n)}function Nv(){}function Mj(t,e){var n=Ws();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&_v(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function Ij(t,e){var n=Ws();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&_v(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function Dj(t,e,n){return ga&21?(dr(n,e)||(n=B1(),Bt.lanes|=n,xa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ts=!0),t.memoizedState=n)}function kA(t,e){var n=xt;xt=n!==0&&4>n?n:4,t(!0);var s=$m.transition;$m.transition={};try{t(!1),e()}finally{xt=n,$m.transition=s}}function Lj(){return Ws().memoizedState}function _A(t,e,n){var s=so(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},$j(t))Fj(e,n);else if(n=vj(t,e,n,s),n!==null){var r=Bn();cr(n,t,s,r),zj(n,e,s)}}function SA(t,e,n){var s=so(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if($j(t))Fj(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,dr(a,o)){var l=e.interleaved;l===null?(r.next=r,yv(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=vj(t,e,r,s),n!==null&&(r=Bn(),cr(n,t,s,r),zj(n,e,s))}}function $j(t){var e=t.alternate;return t===Bt||e!==null&&e===Bt}function Fj(t,e){cu=Kf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zj(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,rv(t,n)}}var Gf={readContext:Hs,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useInsertionEffect:Cn,useLayoutEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useMutableSource:Cn,useSyncExternalStore:Cn,useId:Cn,unstable_isNewReconciler:!1},jA={readContext:Hs,useCallback:function(t,e){return Sr().memoizedState=[t,e===void 0?null:e],t},useContext:Hs,useEffect:ew,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,uf(4194308,4,Aj.bind(null,e,t),n)},useLayoutEffect:function(t,e){return uf(4194308,4,t,e)},useInsertionEffect:function(t,e){return uf(4,2,t,e)},useMemo:function(t,e){var n=Sr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Sr();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=_A.bind(null,Bt,t),[s.memoizedState,t]},useRef:function(t){var e=Sr();return t={current:t},e.memoizedState=t},useState:Zb,useDebugValue:Nv,useDeferredValue:function(t){return Sr().memoizedState=t},useTransition:function(){var t=Zb(!1),e=t[0];return t=kA.bind(null,t[1]),Sr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Bt,r=Sr();if(Dt){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=e(),mn===null)throw Error(fe(349));ga&30||Sj(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,ew(Cj.bind(null,s,i,t),[t]),s.flags|=2048,Iu(9,jj.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Sr(),e=mn.identifierPrefix;if(Dt){var n=si,s=ni;n=(s&~(1<<32-lr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ou++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CA={readContext:Hs,useCallback:Mj,useContext:Hs,useEffect:Cv,useImperativeHandle:Oj,useInsertionEffect:Pj,useLayoutEffect:Rj,useMemo:Ij,useReducer:Fm,useRef:Tj,useState:function(){return Fm(Mu)},useDebugValue:Nv,useDeferredValue:function(t){var e=Ws();return Dj(e,an.memoizedState,t)},useTransition:function(){var t=Fm(Mu)[0],e=Ws().memoizedState;return[t,e]},useMutableSource:kj,useSyncExternalStore:_j,useId:Lj,unstable_isNewReconciler:!1},NA={readContext:Hs,useCallback:Mj,useContext:Hs,useEffect:Cv,useImperativeHandle:Oj,useInsertionEffect:Pj,useLayoutEffect:Rj,useMemo:Ij,useReducer:zm,useRef:Tj,useState:function(){return zm(Mu)},useDebugValue:Nv,useDeferredValue:function(t){var e=Ws();return an===null?e.memoizedState=t:Dj(e,an.memoizedState,t)},useTransition:function(){var t=zm(Mu)[0],e=Ws().memoizedState;return[t,e]},useMutableSource:kj,useSyncExternalStore:_j,useId:Lj,unstable_isNewReconciler:!1};function tr(t,e){if(t&&t.defaultProps){e=Ut({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function vx(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Ut({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dp={isMounted:function(t){return(t=t._reactInternals)?Na(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Bn(),r=so(t),i=oi(s,r);i.payload=e,n!=null&&(i.callback=n),e=to(t,i,r),e!==null&&(cr(e,t,r,s),lf(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Bn(),r=so(t),i=oi(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=to(t,i,r),e!==null&&(cr(e,t,r,s),lf(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bn(),s=so(t),r=oi(n,s);r.tag=2,e!=null&&(r.callback=e),e=to(t,r,s),e!==null&&(cr(e,t,s,n),lf(e,t,s))}};function tw(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Nu(n,s)||!Nu(r,i):!0}function Bj(t,e,n){var s=!1,r=uo,i=e.contextType;return typeof i=="object"&&i!==null?i=Hs(i):(r=os(e)?pa:On.current,s=e.contextTypes,i=(s=s!=null)?Jl(t,r):uo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dp,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function nw(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Dp.enqueueReplaceState(e,e.state,null)}function bx(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},vv(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Hs(i):(i=os(e)?pa:On.current,r.context=Jl(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(vx(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Dp.enqueueReplaceState(r,r.state,null),Vf(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function nc(t,e){try{var n="",s=e;do n+=tR(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function Bm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function wx(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var EA=typeof WeakMap=="function"?WeakMap:Map;function Uj(t,e,n){n=oi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Qf||(Qf=!0,Rx=s),wx(t,e)},n}function Hj(t,e,n){n=oi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){wx(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){wx(t,e),typeof s!="function"&&(no===null?no=new Set([this]):no.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function sw(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new EA;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=UA.bind(null,t,e,n),e.then(t,t))}function rw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function iw(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=oi(-1,1),e.tag=2,to(n,e,1))),n.lanes|=1),t)}var TA=xi.ReactCurrentOwner,ts=!1;function zn(t,e,n,s){e.child=t===null?yj(e,null,n,s):ec(e,t.child,n,s)}function ow(t,e,n,s,r){n=n.render;var i=e.ref;return Sl(e,r),s=Sv(t,e,n,s,i,r),n=jv(),t!==null&&!ts?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,hi(t,e,r)):(Dt&&n&&hv(e),e.flags|=1,zn(t,e,s,r),e.child)}function aw(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Iv(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Wj(t,e,i,s,r)):(t=pf(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Nu,n(o,s)&&t.ref===e.ref)return hi(t,e,r)}return e.flags|=1,t=ro(i,s),t.ref=e.ref,t.return=e,e.child=t}function Wj(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Nu(i,s)&&t.ref===e.ref)if(ts=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(ts=!0);else return e.lanes=t.lanes,hi(t,e,r)}return kx(t,e,n,s,r)}function Vj(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(gl,ys),ys|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(gl,ys),ys|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,_t(gl,ys),ys|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,_t(gl,ys),ys|=s;return zn(t,e,r,n),e.child}function qj(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function kx(t,e,n,s,r){var i=os(n)?pa:On.current;return i=Jl(e,i),Sl(e,r),n=Sv(t,e,n,s,i,r),s=jv(),t!==null&&!ts?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,hi(t,e,r)):(Dt&&s&&hv(e),e.flags|=1,zn(t,e,n,r),e.child)}function lw(t,e,n,s,r){if(os(n)){var i=!0;zf(e)}else i=!1;if(Sl(e,r),e.stateNode===null)df(t,e),Bj(e,n,s),bx(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Hs(u):(u=os(n)?pa:On.current,u=Jl(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==u)&&nw(e,o,s,u),Ei=!1;var f=e.memoizedState;o.state=f,Vf(e,s,o,r),l=e.memoizedState,a!==s||f!==l||is.current||Ei?(typeof d=="function"&&(vx(e,n,d,s),l=e.memoizedState),(a=Ei||tw(e,n,a,s,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,bj(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:tr(e.type,a),o.props=u,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Hs(l):(l=os(n)?pa:On.current,l=Jl(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&nw(e,o,s,l),Ei=!1,f=e.memoizedState,o.state=f,Vf(e,s,o,r);var w=e.memoizedState;a!==h||f!==w||is.current||Ei?(typeof p=="function"&&(vx(e,n,p,s),w=e.memoizedState),(u=Ei||tw(e,n,u,s,f,w,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,w,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,w,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=w),o.props=s,o.state=w,o.context=l,s=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return _x(t,e,n,s,i,r)}function _x(t,e,n,s,r,i){qj(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&Kb(e,n,!1),hi(t,e,i);s=e.stateNode,TA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=ec(e,t.child,null,i),e.child=ec(e,null,a,i)):zn(t,e,a,i),e.memoizedState=s.state,r&&Kb(e,n,!0),e.child}function Kj(t){var e=t.stateNode;e.pendingContext?qb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&qb(t,e.context,!1),bv(t,e.containerInfo)}function cw(t,e,n,s,r){return Zl(),pv(r),e.flags|=256,zn(t,e,n,s),e.child}var Sx={dehydrated:null,treeContext:null,retryLane:0};function jx(t){return{baseLanes:t,cachePool:null,transitions:null}}function Gj(t,e,n){var s=e.pendingProps,r=Ft.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),_t(Ft,r&1),t===null)return xx(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Fp(o,s,0,null),t=ca(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=jx(n),e.memoizedState=Sx,t):Ev(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return PA(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=ro(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=ro(a,i):(i=ca(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?jx(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Sx,s}return i=t.child,t=i.sibling,s=ro(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Ev(t,e){return e=Fp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fh(t,e,n,s){return s!==null&&pv(s),ec(e,t.child,null,n),t=Ev(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PA(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Bm(Error(fe(422))),fh(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Fp({mode:"visible",children:s.children},r,0,null),i=ca(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&ec(e,t.child,null,o),e.child.memoizedState=jx(o),e.memoizedState=Sx,i);if(!(e.mode&1))return fh(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(fe(419)),s=Bm(i,s,void 0),fh(t,e,o,s)}if(a=(o&t.childLanes)!==0,ts||a){if(s=mn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,di(t,r),cr(s,t,r,-1))}return Mv(),s=Bm(Error(fe(421))),fh(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=HA.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,_s=eo(r.nextSibling),Ss=e,Dt=!0,ar=null,t!==null&&(Ds[Ls++]=ni,Ds[Ls++]=si,Ds[Ls++]=ma,ni=t.id,si=t.overflow,ma=e),e=Ev(e,s.children),e.flags|=4096,e)}function uw(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),yx(t.return,e,n)}function Um(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function Yj(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(zn(t,e,s.children,n),s=Ft.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&uw(t,n,e);else if(t.tag===19)uw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(_t(Ft,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&qf(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Um(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&qf(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Um(e,!0,n,null,i);break;case"together":Um(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function df(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,n=ro(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ro(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function RA(t,e,n){switch(e.tag){case 3:Kj(e),Zl();break;case 5:wj(e);break;case 1:os(e.type)&&zf(e);break;case 4:bv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;_t(Hf,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(_t(Ft,Ft.current&1),e.flags|=128,null):n&e.child.childLanes?Gj(t,e,n):(_t(Ft,Ft.current&1),t=hi(t,e,n),t!==null?t.sibling:null);_t(Ft,Ft.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return Yj(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),_t(Ft,Ft.current),s)break;return null;case 22:case 23:return e.lanes=0,Vj(t,e,n)}return hi(t,e,n)}var Qj,Cx,Xj,Jj;Qj=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cx=function(){};Xj=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Go(Lr.current);var i=null;switch(n){case"input":r=Gg(t,r),s=Gg(t,s),i=[];break;case"select":r=Ut({},r,{value:void 0}),s=Ut({},s,{value:void 0}),i=[];break;case"textarea":r=Xg(t,r),s=Xg(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=$f)}Zg(n,s);var o;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var l=s[u];if(a=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Nt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};Jj=function(t,e,n,s){n!==s&&(e.flags|=4)};function Mc(t,e){if(!Dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Nn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function AA(t,e,n){var s=e.pendingProps;switch(fv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(e),null;case 1:return os(e.type)&&Ff(),Nn(e),null;case 3:return s=e.stateNode,tc(),Rt(is),Rt(On),kv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(dh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ar!==null&&(Mx(ar),ar=null))),Cx(t,e),Nn(e),null;case 5:wv(e);var r=Go(Au.current);if(n=e.type,t!==null&&e.stateNode!=null)Xj(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(fe(166));return Nn(e),null}if(t=Go(Lr.current),dh(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Ar]=e,s[Pu]=i,t=(e.mode&1)!==0,n){case"dialog":Nt("cancel",s),Nt("close",s);break;case"iframe":case"object":case"embed":Nt("load",s);break;case"video":case"audio":for(r=0;r<Yc.length;r++)Nt(Yc[r],s);break;case"source":Nt("error",s);break;case"img":case"image":case"link":Nt("error",s),Nt("load",s);break;case"details":Nt("toggle",s);break;case"input":vb(s,i),Nt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Nt("invalid",s);break;case"textarea":wb(s,i),Nt("invalid",s)}Zg(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&uh(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&uh(s.textContent,a,t),r=["children",""+a]):bu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Nt("scroll",s)}switch(n){case"input":nh(s),bb(s,i,!0);break;case"textarea":nh(s),kb(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=$f)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=C1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[Ar]=e,t[Pu]=s,Qj(t,e,!1,!1),e.stateNode=t;e:{switch(o=ex(n,s),n){case"dialog":Nt("cancel",t),Nt("close",t),r=s;break;case"iframe":case"object":case"embed":Nt("load",t),r=s;break;case"video":case"audio":for(r=0;r<Yc.length;r++)Nt(Yc[r],t);r=s;break;case"source":Nt("error",t),r=s;break;case"img":case"image":case"link":Nt("error",t),Nt("load",t),r=s;break;case"details":Nt("toggle",t),r=s;break;case"input":vb(t,s),r=Gg(t,s),Nt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Ut({},s,{value:void 0}),Nt("invalid",t);break;case"textarea":wb(t,s),r=Xg(t,s),Nt("invalid",t);break;default:r=s}Zg(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?T1(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&N1(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&wu(t,l):typeof l=="number"&&wu(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(bu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Nt("scroll",t):l!=null&&Jy(t,i,l,o))}switch(n){case"input":nh(t),bb(t,s,!1);break;case"textarea":nh(t),kb(t);break;case"option":s.value!=null&&t.setAttribute("value",""+co(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?bl(t,!!s.multiple,i,!1):s.defaultValue!=null&&bl(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=$f)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nn(e),null;case 6:if(t&&e.stateNode!=null)Jj(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(fe(166));if(n=Go(Au.current),Go(Lr.current),dh(e)){if(s=e.stateNode,n=e.memoizedProps,s[Ar]=e,(i=s.nodeValue!==n)&&(t=Ss,t!==null))switch(t.tag){case 3:uh(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&uh(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Ar]=e,e.stateNode=s}return Nn(e),null;case 13:if(Rt(Ft),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Dt&&_s!==null&&e.mode&1&&!(e.flags&128))gj(),Zl(),e.flags|=98560,i=!1;else if(i=dh(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(fe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(fe(317));i[Ar]=e}else Zl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nn(e),i=!1}else ar!==null&&(Mx(ar),ar=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Ft.current&1?cn===0&&(cn=3):Mv())),e.updateQueue!==null&&(e.flags|=4),Nn(e),null);case 4:return tc(),Cx(t,e),t===null&&Eu(e.stateNode.containerInfo),Nn(e),null;case 10:return xv(e.type._context),Nn(e),null;case 17:return os(e.type)&&Ff(),Nn(e),null;case 19:if(Rt(Ft),i=e.memoizedState,i===null)return Nn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)Mc(i,!1);else{if(cn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=qf(t),o!==null){for(e.flags|=128,Mc(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t(Ft,Ft.current&1|2),e.child}t=t.sibling}i.tail!==null&&Jt()>sc&&(e.flags|=128,s=!0,Mc(i,!1),e.lanes=4194304)}else{if(!s)if(t=qf(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Mc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Dt)return Nn(e),null}else 2*Jt()-i.renderingStartTime>sc&&n!==1073741824&&(e.flags|=128,s=!0,Mc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Jt(),e.sibling=null,n=Ft.current,_t(Ft,s?n&1|2:n&1),e):(Nn(e),null);case 22:case 23:return Ov(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?ys&1073741824&&(Nn(e),e.subtreeFlags&6&&(e.flags|=8192)):Nn(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function OA(t,e){switch(fv(e),e.tag){case 1:return os(e.type)&&Ff(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return tc(),Rt(is),Rt(On),kv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return wv(e),null;case 13:if(Rt(Ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));Zl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(Ft),null;case 4:return tc(),null;case 10:return xv(e.type._context),null;case 22:case 23:return Ov(),null;case 24:return null;default:return null}}var ph=!1,Tn=!1,MA=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function ml(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Vt(t,e,s)}else n.current=null}function Nx(t,e,n){try{n()}catch(s){Vt(t,e,s)}}var dw=!1;function IA(t,e){if(ux=If,t=sj(),dv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++u===r&&(a=o),f===i&&++d===s&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(dx={focusedElem:t,selectionRange:n},If=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var y=w.memoizedProps,x=w.memoizedState,g=e.stateNode,m=g.getSnapshotBeforeUpdate(e.elementType===e.type?y:tr(e.type,y),x);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(k){Vt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return w=dw,dw=!1,w}function uu(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&Nx(e,n,i)}r=r.next}while(r!==s)}}function Lp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Ex(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Zj(t){var e=t.alternate;e!==null&&(t.alternate=null,Zj(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ar],delete e[Pu],delete e[px],delete e[xA],delete e[yA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function eC(t){return t.tag===5||t.tag===3||t.tag===4}function hw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||eC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Tx(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$f));else if(s!==4&&(t=t.child,t!==null))for(Tx(t,e,n),t=t.sibling;t!==null;)Tx(t,e,n),t=t.sibling}function Px(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Px(t,e,n),t=t.sibling;t!==null;)Px(t,e,n),t=t.sibling}var yn=null,ir=!1;function ki(t,e,n){for(n=n.child;n!==null;)tC(t,e,n),n=n.sibling}function tC(t,e,n){if(Dr&&typeof Dr.onCommitFiberUnmount=="function")try{Dr.onCommitFiberUnmount(Tp,n)}catch{}switch(n.tag){case 5:Tn||ml(n,e);case 6:var s=yn,r=ir;yn=null,ki(t,e,n),yn=s,ir=r,yn!==null&&(ir?(t=yn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):yn.removeChild(n.stateNode));break;case 18:yn!==null&&(ir?(t=yn,n=n.stateNode,t.nodeType===8?Im(t.parentNode,n):t.nodeType===1&&Im(t,n),ju(t)):Im(yn,n.stateNode));break;case 4:s=yn,r=ir,yn=n.stateNode.containerInfo,ir=!0,ki(t,e,n),yn=s,ir=r;break;case 0:case 11:case 14:case 15:if(!Tn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Nx(n,e,o),r=r.next}while(r!==s)}ki(t,e,n);break;case 1:if(!Tn&&(ml(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Vt(n,e,a)}ki(t,e,n);break;case 21:ki(t,e,n);break;case 22:n.mode&1?(Tn=(s=Tn)||n.memoizedState!==null,ki(t,e,n),Tn=s):ki(t,e,n);break;default:ki(t,e,n)}}function fw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new MA),e.forEach(function(s){var r=WA.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Zs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:yn=a.stateNode,ir=!1;break e;case 3:yn=a.stateNode.containerInfo,ir=!0;break e;case 4:yn=a.stateNode.containerInfo,ir=!0;break e}a=a.return}if(yn===null)throw Error(fe(160));tC(i,o,r),yn=null,ir=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Vt(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)nC(e,t),e=e.sibling}function nC(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zs(e,t),vr(t),s&4){try{uu(3,t,t.return),Lp(3,t)}catch(y){Vt(t,t.return,y)}try{uu(5,t,t.return)}catch(y){Vt(t,t.return,y)}}break;case 1:Zs(e,t),vr(t),s&512&&n!==null&&ml(n,n.return);break;case 5:if(Zs(e,t),vr(t),s&512&&n!==null&&ml(n,n.return),t.flags&32){var r=t.stateNode;try{wu(r,"")}catch(y){Vt(t,t.return,y)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&S1(r,i),ex(a,o);var u=ex(a,i);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?T1(r,h):d==="dangerouslySetInnerHTML"?N1(r,h):d==="children"?wu(r,h):Jy(r,d,h,u)}switch(a){case"input":Yg(r,i);break;case"textarea":j1(r,i);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?bl(r,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?bl(r,!!i.multiple,i.defaultValue,!0):bl(r,!!i.multiple,i.multiple?[]:"",!1))}r[Pu]=i}catch(y){Vt(t,t.return,y)}}break;case 6:if(Zs(e,t),vr(t),s&4){if(t.stateNode===null)throw Error(fe(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(y){Vt(t,t.return,y)}}break;case 3:if(Zs(e,t),vr(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{ju(e.containerInfo)}catch(y){Vt(t,t.return,y)}break;case 4:Zs(e,t),vr(t);break;case 13:Zs(e,t),vr(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Rv=Jt())),s&4&&fw(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Tn=(u=Tn)||d,Zs(e,t),Tn=u):Zs(e,t),vr(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Ne=t,d=t.child;d!==null;){for(h=Ne=d;Ne!==null;){switch(f=Ne,p=f.child,f.tag){case 0:case 11:case 14:case 15:uu(4,f,f.return);break;case 1:ml(f,f.return);var w=f.stateNode;if(typeof w.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(y){Vt(s,n,y)}}break;case 5:ml(f,f.return);break;case 22:if(f.memoizedState!==null){mw(h);continue}}p!==null?(p.return=f,Ne=p):mw(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=E1("display",o))}catch(y){Vt(t,t.return,y)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(y){Vt(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Zs(e,t),vr(t),s&4&&fw(t);break;case 21:break;default:Zs(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(eC(n)){var s=n;break e}n=n.return}throw Error(fe(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(wu(r,""),s.flags&=-33);var i=hw(t);Px(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=hw(t);Tx(t,a,o);break;default:throw Error(fe(161))}}catch(l){Vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DA(t,e,n){Ne=t,sC(t)}function sC(t,e,n){for(var s=(t.mode&1)!==0;Ne!==null;){var r=Ne,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||ph;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Tn;a=ph;var u=Tn;if(ph=o,(Tn=l)&&!u)for(Ne=r;Ne!==null;)o=Ne,l=o.child,o.tag===22&&o.memoizedState!==null?gw(r):l!==null?(l.return=o,Ne=l):gw(r);for(;i!==null;)Ne=i,sC(i),i=i.sibling;Ne=r,ph=a,Tn=u}pw(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,Ne=i):pw(t)}}function pw(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Tn||Lp(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Tn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:tr(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Jb(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Jb(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&ju(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}Tn||e.flags&512&&Ex(e)}catch(f){Vt(e,e.return,f)}}if(e===t){Ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ne=n;break}Ne=e.return}}function mw(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ne=n;break}Ne=e.return}}function gw(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lp(4,e)}catch(l){Vt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Vt(e,r,l)}}var i=e.return;try{Ex(e)}catch(l){Vt(e,i,l)}break;case 5:var o=e.return;try{Ex(e)}catch(l){Vt(e,o,l)}}}catch(l){Vt(e,e.return,l)}if(e===t){Ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ne=a;break}Ne=e.return}}var LA=Math.ceil,Yf=xi.ReactCurrentDispatcher,Tv=xi.ReactCurrentOwner,Bs=xi.ReactCurrentBatchConfig,st=0,mn=null,tn=null,bn=0,ys=0,gl=vo(0),cn=0,Du=null,xa=0,$p=0,Pv=0,du=null,Zn=null,Rv=0,sc=1/0,Gr=null,Qf=!1,Rx=null,no=null,mh=!1,Vi=null,Xf=0,hu=0,Ax=null,hf=-1,ff=0;function Bn(){return st&6?Jt():hf!==-1?hf:hf=Jt()}function so(t){return t.mode&1?st&2&&bn!==0?bn&-bn:bA.transition!==null?(ff===0&&(ff=B1()),ff):(t=xt,t!==0||(t=window.event,t=t===void 0?16:G1(t.type)),t):1}function cr(t,e,n,s){if(50<hu)throw hu=0,Ax=null,Error(fe(185));wd(t,n,s),(!(st&2)||t!==mn)&&(t===mn&&(!(st&2)&&($p|=n),cn===4&&Ri(t,bn)),as(t,s),n===1&&st===0&&!(e.mode&1)&&(sc=Jt()+500,Mp&&bo()))}function as(t,e){var n=t.callbackNode;bR(t,e);var s=Mf(t,t===mn?bn:0);if(s===0)n!==null&&jb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&jb(n),e===1)t.tag===0?vA(xw.bind(null,t)):fj(xw.bind(null,t)),mA(function(){!(st&6)&&bo()}),n=null;else{switch(U1(s)){case 1:n=sv;break;case 4:n=F1;break;case 16:n=Of;break;case 536870912:n=z1;break;default:n=Of}n=dC(n,rC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function rC(t,e){if(hf=-1,ff=0,st&6)throw Error(fe(327));var n=t.callbackNode;if(jl()&&t.callbackNode!==n)return null;var s=Mf(t,t===mn?bn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Jf(t,s);else{e=s;var r=st;st|=2;var i=oC();(mn!==t||bn!==e)&&(Gr=null,sc=Jt()+500,la(t,e));do try{zA();break}catch(a){iC(t,a)}while(!0);gv(),Yf.current=i,st=r,tn!==null?e=0:(mn=null,bn=0,e=cn)}if(e!==0){if(e===2&&(r=ix(t),r!==0&&(s=r,e=Ox(t,r))),e===1)throw n=Du,la(t,0),Ri(t,s),as(t,Jt()),n;if(e===6)Ri(t,s);else{if(r=t.current.alternate,!(s&30)&&!$A(r)&&(e=Jf(t,s),e===2&&(i=ix(t),i!==0&&(s=i,e=Ox(t,i))),e===1))throw n=Du,la(t,0),Ri(t,s),as(t,Jt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(fe(345));case 2:zo(t,Zn,Gr);break;case 3:if(Ri(t,s),(s&130023424)===s&&(e=Rv+500-Jt(),10<e)){if(Mf(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Bn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=fx(zo.bind(null,t,Zn,Gr),e);break}zo(t,Zn,Gr);break;case 4:if(Ri(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-lr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Jt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*LA(s/1960))-s,10<s){t.timeoutHandle=fx(zo.bind(null,t,Zn,Gr),s);break}zo(t,Zn,Gr);break;case 5:zo(t,Zn,Gr);break;default:throw Error(fe(329))}}}return as(t,Jt()),t.callbackNode===n?rC.bind(null,t):null}function Ox(t,e){var n=du;return t.current.memoizedState.isDehydrated&&(la(t,e).flags|=256),t=Jf(t,e),t!==2&&(e=Zn,Zn=n,e!==null&&Mx(e)),t}function Mx(t){Zn===null?Zn=t:Zn.push.apply(Zn,t)}function $A(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!dr(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ri(t,e){for(e&=~Pv,e&=~$p,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-lr(e),s=1<<n;t[n]=-1,e&=~s}}function xw(t){if(st&6)throw Error(fe(327));jl();var e=Mf(t,0);if(!(e&1))return as(t,Jt()),null;var n=Jf(t,e);if(t.tag!==0&&n===2){var s=ix(t);s!==0&&(e=s,n=Ox(t,s))}if(n===1)throw n=Du,la(t,0),Ri(t,e),as(t,Jt()),n;if(n===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zo(t,Zn,Gr),as(t,Jt()),null}function Av(t,e){var n=st;st|=1;try{return t(e)}finally{st=n,st===0&&(sc=Jt()+500,Mp&&bo())}}function ya(t){Vi!==null&&Vi.tag===0&&!(st&6)&&jl();var e=st;st|=1;var n=Bs.transition,s=xt;try{if(Bs.transition=null,xt=1,t)return t()}finally{xt=s,Bs.transition=n,st=e,!(st&6)&&bo()}}function Ov(){ys=gl.current,Rt(gl)}function la(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,pA(n)),tn!==null)for(n=tn.return;n!==null;){var s=n;switch(fv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ff();break;case 3:tc(),Rt(is),Rt(On),kv();break;case 5:wv(s);break;case 4:tc();break;case 13:Rt(Ft);break;case 19:Rt(Ft);break;case 10:xv(s.type._context);break;case 22:case 23:Ov()}n=n.return}if(mn=t,tn=t=ro(t.current,null),bn=ys=e,cn=0,Du=null,Pv=$p=xa=0,Zn=du=null,Ko!==null){for(e=0;e<Ko.length;e++)if(n=Ko[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Ko=null}return t}function iC(t,e){do{var n=tn;try{if(gv(),cf.current=Gf,Kf){for(var s=Bt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Kf=!1}if(ga=0,fn=an=Bt=null,cu=!1,Ou=0,Tv.current=null,n===null||n.return===null){cn=1,Du=e,tn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=bn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=rw(o);if(p!==null){p.flags&=-257,iw(p,o,a,i,e),p.mode&1&&sw(i,u,e),e=p,l=u;var w=e.updateQueue;if(w===null){var y=new Set;y.add(l),e.updateQueue=y}else w.add(l);break e}else{if(!(e&1)){sw(i,u,e),Mv();break e}l=Error(fe(426))}}else if(Dt&&a.mode&1){var x=rw(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),iw(x,o,a,i,e),pv(nc(l,a));break e}}i=l=nc(l,a),cn!==4&&(cn=2),du===null?du=[i]:du.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=Uj(i,l,e);Xb(i,g);break e;case 1:a=l;var m=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(no===null||!no.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=Hj(i,a,e);Xb(i,k);break e}}i=i.return}while(i!==null)}lC(n)}catch(_){e=_,tn===n&&n!==null&&(tn=n=n.return);continue}break}while(!0)}function oC(){var t=Yf.current;return Yf.current=Gf,t===null?Gf:t}function Mv(){(cn===0||cn===3||cn===2)&&(cn=4),mn===null||!(xa&268435455)&&!($p&268435455)||Ri(mn,bn)}function Jf(t,e){var n=st;st|=2;var s=oC();(mn!==t||bn!==e)&&(Gr=null,la(t,e));do try{FA();break}catch(r){iC(t,r)}while(!0);if(gv(),st=n,Yf.current=s,tn!==null)throw Error(fe(261));return mn=null,bn=0,cn}function FA(){for(;tn!==null;)aC(tn)}function zA(){for(;tn!==null&&!dR();)aC(tn)}function aC(t){var e=uC(t.alternate,t,ys);t.memoizedProps=t.pendingProps,e===null?lC(t):tn=e,Tv.current=null}function lC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=OA(n,e),n!==null){n.flags&=32767,tn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{cn=6,tn=null;return}}else if(n=AA(n,e,ys),n!==null){tn=n;return}if(e=e.sibling,e!==null){tn=e;return}tn=e=t}while(e!==null);cn===0&&(cn=5)}function zo(t,e,n){var s=xt,r=Bs.transition;try{Bs.transition=null,xt=1,BA(t,e,n,s)}finally{Bs.transition=r,xt=s}return null}function BA(t,e,n,s){do jl();while(Vi!==null);if(st&6)throw Error(fe(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(wR(t,i),t===mn&&(tn=mn=null,bn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mh||(mh=!0,dC(Of,function(){return jl(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Bs.transition,Bs.transition=null;var o=xt;xt=1;var a=st;st|=4,Tv.current=null,IA(t,n),nC(n,t),aA(dx),If=!!ux,dx=ux=null,t.current=n,DA(n),hR(),st=a,xt=o,Bs.transition=i}else t.current=n;if(mh&&(mh=!1,Vi=t,Xf=r),i=t.pendingLanes,i===0&&(no=null),mR(n.stateNode),as(t,Jt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Qf)throw Qf=!1,t=Rx,Rx=null,t;return Xf&1&&t.tag!==0&&jl(),i=t.pendingLanes,i&1?t===Ax?hu++:(hu=0,Ax=t):hu=0,bo(),null}function jl(){if(Vi!==null){var t=U1(Xf),e=Bs.transition,n=xt;try{if(Bs.transition=null,xt=16>t?16:t,Vi===null)var s=!1;else{if(t=Vi,Vi=null,Xf=0,st&6)throw Error(fe(331));var r=st;for(st|=4,Ne=t.current;Ne!==null;){var i=Ne,o=i.child;if(Ne.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ne=u;Ne!==null;){var d=Ne;switch(d.tag){case 0:case 11:case 15:uu(8,d,i)}var h=d.child;if(h!==null)h.return=d,Ne=h;else for(;Ne!==null;){d=Ne;var f=d.sibling,p=d.return;if(Zj(d),d===u){Ne=null;break}if(f!==null){f.return=p,Ne=f;break}Ne=p}}}var w=i.alternate;if(w!==null){var y=w.child;if(y!==null){w.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}Ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ne=o;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:uu(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Ne=g;break e}Ne=i.return}}var m=t.current;for(Ne=m;Ne!==null;){o=Ne;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Ne=b;else e:for(o=m;Ne!==null;){if(a=Ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Lp(9,a)}}catch(_){Vt(a,a.return,_)}if(a===o){Ne=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,Ne=k;break e}Ne=a.return}}if(st=r,bo(),Dr&&typeof Dr.onPostCommitFiberRoot=="function")try{Dr.onPostCommitFiberRoot(Tp,t)}catch{}s=!0}return s}finally{xt=n,Bs.transition=e}}return!1}function yw(t,e,n){e=nc(n,e),e=Uj(t,e,1),t=to(t,e,1),e=Bn(),t!==null&&(wd(t,1,e),as(t,e))}function Vt(t,e,n){if(t.tag===3)yw(t,t,n);else for(;e!==null;){if(e.tag===3){yw(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(no===null||!no.has(s))){t=nc(n,t),t=Hj(e,t,1),e=to(e,t,1),t=Bn(),e!==null&&(wd(e,1,t),as(e,t));break}}e=e.return}}function UA(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Bn(),t.pingedLanes|=t.suspendedLanes&n,mn===t&&(bn&n)===n&&(cn===4||cn===3&&(bn&130023424)===bn&&500>Jt()-Rv?la(t,0):Pv|=n),as(t,e)}function cC(t,e){e===0&&(t.mode&1?(e=ih,ih<<=1,!(ih&130023424)&&(ih=4194304)):e=1);var n=Bn();t=di(t,e),t!==null&&(wd(t,e,n),as(t,n))}function HA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cC(t,n)}function WA(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(fe(314))}s!==null&&s.delete(e),cC(t,n)}var uC;uC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||is.current)ts=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ts=!1,RA(t,e,n);ts=!!(t.flags&131072)}else ts=!1,Dt&&e.flags&1048576&&pj(e,Uf,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;df(t,e),t=e.pendingProps;var r=Jl(e,On.current);Sl(e,n),r=Sv(null,e,s,t,r,n);var i=jv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,os(s)?(i=!0,zf(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,vv(e),r.updater=Dp,e.stateNode=r,r._reactInternals=e,bx(e,s,t,n),e=_x(null,e,s,!0,i,n)):(e.tag=0,Dt&&i&&hv(e),zn(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(df(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=qA(s),t=tr(s,t),r){case 0:e=kx(null,e,s,t,n);break e;case 1:e=lw(null,e,s,t,n);break e;case 11:e=ow(null,e,s,t,n);break e;case 14:e=aw(null,e,s,tr(s.type,t),n);break e}throw Error(fe(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:tr(s,r),kx(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:tr(s,r),lw(t,e,s,r,n);case 3:e:{if(Kj(e),t===null)throw Error(fe(387));s=e.pendingProps,i=e.memoizedState,r=i.element,bj(t,e),Vf(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=nc(Error(fe(423)),e),e=cw(t,e,s,n,r);break e}else if(s!==r){r=nc(Error(fe(424)),e),e=cw(t,e,s,n,r);break e}else for(_s=eo(e.stateNode.containerInfo.firstChild),Ss=e,Dt=!0,ar=null,n=yj(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Zl(),s===r){e=hi(t,e,n);break e}zn(t,e,s,n)}e=e.child}return e;case 5:return wj(e),t===null&&xx(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,hx(s,r)?o=null:i!==null&&hx(s,i)&&(e.flags|=32),qj(t,e),zn(t,e,o,n),e.child;case 6:return t===null&&xx(e),null;case 13:return Gj(t,e,n);case 4:return bv(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=ec(e,null,s,n):zn(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:tr(s,r),ow(t,e,s,r,n);case 7:return zn(t,e,e.pendingProps,n),e.child;case 8:return zn(t,e,e.pendingProps.children,n),e.child;case 12:return zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,_t(Hf,s._currentValue),s._currentValue=o,i!==null)if(dr(i.value,o)){if(i.children===r.children&&!is.current){e=hi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=oi(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),yx(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(fe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),yx(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}zn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Sl(e,n),r=Hs(r),s=s(r),e.flags|=1,zn(t,e,s,n),e.child;case 14:return s=e.type,r=tr(s,e.pendingProps),r=tr(s.type,r),aw(t,e,s,r,n);case 15:return Wj(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:tr(s,r),df(t,e),e.tag=1,os(s)?(t=!0,zf(e)):t=!1,Sl(e,n),Bj(e,s,r),bx(e,s,r,n),_x(null,e,s,!0,t,n);case 19:return Yj(t,e,n);case 22:return Vj(t,e,n)}throw Error(fe(156,e.tag))};function dC(t,e){return $1(t,e)}function VA(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(t,e,n,s){return new VA(t,e,n,s)}function Iv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qA(t){if(typeof t=="function")return Iv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ev)return 11;if(t===tv)return 14}return 2}function ro(t,e){var n=t.alternate;return n===null?(n=$s(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function pf(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")Iv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ol:return ca(n.children,r,i,e);case Zy:o=8,r|=8;break;case Wg:return t=$s(12,n,e,r|2),t.elementType=Wg,t.lanes=i,t;case Vg:return t=$s(13,n,e,r),t.elementType=Vg,t.lanes=i,t;case qg:return t=$s(19,n,e,r),t.elementType=qg,t.lanes=i,t;case w1:return Fp(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case v1:o=10;break e;case b1:o=9;break e;case ev:o=11;break e;case tv:o=14;break e;case Ni:o=16,s=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=$s(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function ca(t,e,n,s){return t=$s(7,t,s,e),t.lanes=n,t}function Fp(t,e,n,s){return t=$s(22,t,s,e),t.elementType=w1,t.lanes=n,t.stateNode={isHidden:!1},t}function Hm(t,e,n){return t=$s(6,t,null,e),t.lanes=n,t}function Wm(t,e,n){return e=$s(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function KA(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sm(0),this.expirationTimes=Sm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sm(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Dv(t,e,n,s,r,i,o,a,l){return t=new KA(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=$s(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vv(i),t}function GA(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:il,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function hC(t){if(!t)return uo;t=t._reactInternals;e:{if(Na(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(os(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var n=t.type;if(os(n))return hj(t,n,e)}return e}function fC(t,e,n,s,r,i,o,a,l){return t=Dv(n,s,!0,t,r,i,o,a,l),t.context=hC(null),n=t.current,s=Bn(),r=so(n),i=oi(s,r),i.callback=e??null,to(n,i,r),t.current.lanes=r,wd(t,r,s),as(t,s),t}function zp(t,e,n,s){var r=e.current,i=Bn(),o=so(r);return n=hC(n),e.context===null?e.context=n:e.pendingContext=n,e=oi(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=to(r,e,o),t!==null&&(cr(t,r,o,i),lf(t,r,o)),o}function Zf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function vw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Lv(t,e){vw(t,e),(t=t.alternate)&&vw(t,e)}function YA(){return null}var pC=typeof reportError=="function"?reportError:function(t){console.error(t)};function $v(t){this._internalRoot=t}Bp.prototype.render=$v.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));zp(t,e,null,null)};Bp.prototype.unmount=$v.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ya(function(){zp(null,t,null,null)}),e[ui]=null}};function Bp(t){this._internalRoot=t}Bp.prototype.unstable_scheduleHydration=function(t){if(t){var e=V1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Pi.length&&e!==0&&e<Pi[n].priority;n++);Pi.splice(n,0,t),n===0&&K1(t)}};function Fv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Up(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bw(){}function QA(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=Zf(o);i.call(u)}}var o=fC(e,s,t,0,null,!1,!1,"",bw);return t._reactRootContainer=o,t[ui]=o.current,Eu(t.nodeType===8?t.parentNode:t),ya(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var u=Zf(l);a.call(u)}}var l=Dv(t,0,!1,null,null,!1,!1,"",bw);return t._reactRootContainer=l,t[ui]=l.current,Eu(t.nodeType===8?t.parentNode:t),ya(function(){zp(e,l,n,s)}),l}function Hp(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=Zf(o);a.call(l)}}zp(e,o,t,r)}else o=QA(n,e,t,r,s);return Zf(o)}H1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Gc(e.pendingLanes);n!==0&&(rv(e,n|1),as(e,Jt()),!(st&6)&&(sc=Jt()+500,bo()))}break;case 13:ya(function(){var s=di(t,1);if(s!==null){var r=Bn();cr(s,t,1,r)}}),Lv(t,1)}};iv=function(t){if(t.tag===13){var e=di(t,134217728);if(e!==null){var n=Bn();cr(e,t,134217728,n)}Lv(t,134217728)}};W1=function(t){if(t.tag===13){var e=so(t),n=di(t,e);if(n!==null){var s=Bn();cr(n,t,e,s)}Lv(t,e)}};V1=function(){return xt};q1=function(t,e){var n=xt;try{return xt=t,e()}finally{xt=n}};nx=function(t,e,n){switch(e){case"input":if(Yg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Op(s);if(!r)throw Error(fe(90));_1(s),Yg(s,r)}}}break;case"textarea":j1(t,n);break;case"select":e=n.value,e!=null&&bl(t,!!n.multiple,e,!1)}};A1=Av;O1=ya;var XA={usingClientEntryPoint:!1,Events:[_d,ul,Op,P1,R1,Av]},Ic={findFiberByHostInstance:qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JA={bundleType:Ic.bundleType,version:Ic.version,rendererPackageName:Ic.rendererPackageName,rendererConfig:Ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=D1(t),t===null?null:t.stateNode},findFiberByHostInstance:Ic.findFiberByHostInstance||YA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gh.isDisabled&&gh.supportsFiber)try{Tp=gh.inject(JA),Dr=gh}catch{}}Ts.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XA;Ts.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fv(e))throw Error(fe(200));return GA(t,e,null,n)};Ts.createRoot=function(t,e){if(!Fv(t))throw Error(fe(299));var n=!1,s="",r=pC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Dv(t,1,!1,null,null,n,!1,s,r),t[ui]=e.current,Eu(t.nodeType===8?t.parentNode:t),new $v(e)};Ts.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=D1(e),t=t===null?null:t.stateNode,t};Ts.flushSync=function(t){return ya(t)};Ts.hydrate=function(t,e,n){if(!Up(e))throw Error(fe(200));return Hp(null,t,e,!0,n)};Ts.hydrateRoot=function(t,e,n){if(!Fv(t))throw Error(fe(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=pC;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=fC(e,null,t,1,n??null,r,!1,i,o),t[ui]=e.current,Eu(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Bp(e)};Ts.render=function(t,e,n){if(!Up(e))throw Error(fe(200));return Hp(null,t,e,!1,n)};Ts.unmountComponentAtNode=function(t){if(!Up(t))throw Error(fe(40));return t._reactRootContainer?(ya(function(){Hp(null,null,t,!1,function(){t._reactRootContainer=null,t[ui]=null})}),!0):!1};Ts.unstable_batchedUpdates=Av;Ts.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Up(n))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return Hp(t,e,n,!1,s)};Ts.version="18.3.1-next-f1338f8080-20240426";function mC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mC)}catch(t){console.error(t)}}mC(),m1.exports=Ts;var jd=m1.exports;const gC=s1(jd);var ww=jd;Ug.createRoot=ww.createRoot,Ug.hydrateRoot=ww.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lu(){return Lu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Lu.apply(this,arguments)}var qi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(qi||(qi={}));const kw="popstate";function ZA(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return Ix("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:xC(r)}return tO(e,n,null,t)}function rn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function eO(){return Math.random().toString(36).substr(2,8)}function _w(t,e){return{usr:t.state,key:t.key,idx:e}}function Ix(t,e,n,s){return n===void 0&&(n=null),Lu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?cc(e):e,{state:n,key:e&&e.key||s||eO()})}function xC(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function cc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function tO(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=qi.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Lu({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=qi.Pop;let x=d(),g=x==null?null:x-u;u=x,l&&l({action:a,location:y.location,delta:g})}function f(x,g){a=qi.Push;let m=Ix(y.location,x,g);u=d()+1;let b=_w(m,u),k=y.createHref(m);try{o.pushState(b,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;r.location.assign(k)}i&&l&&l({action:a,location:y.location,delta:1})}function p(x,g){a=qi.Replace;let m=Ix(y.location,x,g);u=d();let b=_w(m,u),k=y.createHref(m);o.replaceState(b,"",k),i&&l&&l({action:a,location:y.location,delta:0})}function w(x){let g=r.location.origin!=="null"?r.location.origin:r.location.href,m=typeof x=="string"?x:xC(x);return m=m.replace(/ $/,"%20"),rn(g,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,g)}let y={get action(){return a},get location(){return t(r,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(kw,h),l=x,()=>{r.removeEventListener(kw,h),l=null}},createHref(x){return e(r,x)},createURL:w,encodeLocation(x){let g=w(x);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:p,go(x){return o.go(x)}};return y}var Sw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Sw||(Sw={}));function nO(t,e,n){return n===void 0&&(n="/"),sO(t,e,n)}function sO(t,e,n,s){let r=typeof e=="string"?cc(e):e,i=bC(r.pathname||"/",n);if(i==null)return null;let o=yC(t);rO(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=gO(i);a=fO(o[l],u)}return a}function yC(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(rn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=ua([s,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(rn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),yC(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:dO(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of vC(i.path))r(i,o,l)}),e}function vC(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=vC(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function rO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:hO(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const iO=/^:[\w-]+$/,oO=3,aO=2,lO=1,cO=10,uO=-2,jw=t=>t==="*";function dO(t,e){let n=t.split("/"),s=n.length;return n.some(jw)&&(s+=uO),e&&(s+=aO),n.filter(r=>!jw(r)).reduce((r,i)=>r+(iO.test(i)?oO:i===""?lO:cO),s)}function hO(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function fO(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],u=a===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=pO({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),f=l.route;if(!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:ua([i,h.pathname]),pathnameBase:wO(ua([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=ua([i,h.pathnameBase]))}return o}function pO(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=mO(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let y=a[h]||"";o=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const w=a[h];return p&&!w?u[f]=void 0:u[f]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function mO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),zv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function gO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function bC(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const xO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yO=t=>xO.test(t);function vO(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?cc(t):t,i;if(n)if(yO(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),zv(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=Cw(n.substring(1),"/"):i=Cw(n,e)}else i=e;return{pathname:i,search:kO(s),hash:_O(r)}}function Cw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Vm(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function bO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wC(t,e){let n=bO(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function kC(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=cc(t):(r=Lu({},t),rn(!r.pathname||!r.pathname.includes("?"),Vm("?","pathname","search",r)),rn(!r.pathname||!r.pathname.includes("#"),Vm("#","pathname","hash",r)),rn(!r.search||!r.search.includes("#"),Vm("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;r.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=vO(r,a),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const ua=t=>t.join("/").replace(/\/\/+/g,"/"),wO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),kO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,_O=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function SO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _C=["post","put","patch","delete"];new Set(_C);const jO=["get",..._C];new Set(jO);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $u(){return $u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},$u.apply(this,arguments)}const Bv=v.createContext(null),CO=v.createContext(null),Cd=v.createContext(null),Wp=v.createContext(null),wo=v.createContext({outlet:null,matches:[],isDataRoute:!1}),SC=v.createContext(null);function Nd(){return v.useContext(Wp)!=null}function uc(){return Nd()||rn(!1),v.useContext(Wp).location}function jC(t){v.useContext(Cd).static||v.useLayoutEffect(t)}function Ed(){let{isDataRoute:t}=v.useContext(wo);return t?BO():NO()}function NO(){Nd()||rn(!1);let t=v.useContext(Bv),{basename:e,future:n,navigator:s}=v.useContext(Cd),{matches:r}=v.useContext(wo),{pathname:i}=uc(),o=JSON.stringify(wC(r,n.v7_relativeSplatPath)),a=v.useRef(!1);return jC(()=>{a.current=!0}),v.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){s.go(u);return}let h=kC(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ua([e,h.pathname])),(d.replace?s.replace:s.push)(h,d.state,d)},[e,s,o,i,t])}const EO=v.createContext(null);function TO(t){let e=v.useContext(wo).outlet;return e&&v.createElement(EO.Provider,{value:t},e)}function PO(t,e){return RO(t,e)}function RO(t,e,n,s){Nd()||rn(!1);let{navigator:r}=v.useContext(Cd),{matches:i}=v.useContext(wo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=uc(),d;if(e){var h;let x=typeof e=="string"?cc(e):e;l==="/"||(h=x.pathname)!=null&&h.startsWith(l)||rn(!1),d=x}else d=u;let f=d.pathname||"/",p=f;if(l!=="/"){let x=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let w=nO(t,{pathname:p}),y=DO(w&&w.map(x=>Object.assign({},x,{params:Object.assign({},a,x.params),pathname:ua([l,r.encodeLocation?r.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:ua([l,r.encodeLocation?r.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n,s);return e&&y?v.createElement(Wp.Provider,{value:{location:$u({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:qi.Pop}},y):y}function AO(){let t=zO(),e=SO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),n?v.createElement("pre",{style:r},n):null,null)}const OO=v.createElement(AO,null);class MO extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?v.createElement(wo.Provider,{value:this.props.routeContext},v.createElement(SC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function IO(t){let{routeContext:e,match:n,children:s}=t,r=v.useContext(Bv);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),v.createElement(wo.Provider,{value:e},s)}function DO(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let d=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);d>=0||rn(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=n,w=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||w){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let p,w=!1,y=null,x=null;n&&(p=a&&h.route.id?a[h.route.id]:void 0,y=h.route.errorElement||OO,l&&(u<0&&f===0?(UO("route-fallback"),w=!0,x=null):u===f&&(w=!0,x=h.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),m=()=>{let b;return p?b=y:w?b=x:h.route.Component?b=v.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,v.createElement(IO,{match:h,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?v.createElement(MO,{location:n.location,revalidation:n.revalidation,component:y,error:p,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var CC=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(CC||{}),NC=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(NC||{});function LO(t){let e=v.useContext(Bv);return e||rn(!1),e}function $O(t){let e=v.useContext(CO);return e||rn(!1),e}function FO(t){let e=v.useContext(wo);return e||rn(!1),e}function EC(t){let e=FO(),n=e.matches[e.matches.length-1];return n.route.id||rn(!1),n.route.id}function zO(){var t;let e=v.useContext(SC),n=$O(),s=EC();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function BO(){let{router:t}=LO(CC.UseNavigateStable),e=EC(NC.UseNavigateStable),n=v.useRef(!1);return jC(()=>{n.current=!0}),v.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,$u({fromRouteId:e},i)))},[t,e])}const Nw={};function UO(t,e,n){Nw[t]||(Nw[t]=!0)}function HO(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function mf(t){let{to:e,replace:n,state:s,relative:r}=t;Nd()||rn(!1);let{future:i,static:o}=v.useContext(Cd),{matches:a}=v.useContext(wo),{pathname:l}=uc(),u=Ed(),d=kC(e,wC(a,i.v7_relativeSplatPath),l,r==="path"),h=JSON.stringify(d);return v.useEffect(()=>u(JSON.parse(h),{replace:n,state:s,relative:r}),[u,h,r,n,s]),null}function WO(t){return TO(t.context)}function Dn(t){rn(!1)}function VO(t){let{basename:e="/",children:n=null,location:s,navigationType:r=qi.Pop,navigator:i,static:o=!1,future:a}=t;Nd()&&rn(!1);let l=e.replace(/^\/*/,"/"),u=v.useMemo(()=>({basename:l,navigator:i,static:o,future:$u({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=cc(s));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:w="default"}=s,y=v.useMemo(()=>{let x=bC(d,l);return x==null?null:{location:{pathname:x,search:h,hash:f,state:p,key:w},navigationType:r}},[l,d,h,f,p,w,r]);return y==null?null:v.createElement(Cd.Provider,{value:u},v.createElement(Wp.Provider,{children:n,value:y}))}function qO(t){let{children:e,location:n}=t;return PO(Dx(e),n)}new Promise(()=>{});function Dx(t,e){e===void 0&&(e=[]);let n=[];return v.Children.forEach(t,(s,r)=>{if(!v.isValidElement(s))return;let i=[...e,r];if(s.type===v.Fragment){n.push.apply(n,Dx(s.props.children,i));return}s.type!==Dn&&rn(!1),!s.props.index||!s.props.children||rn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Dx(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const KO="6";try{window.__reactRouterVersion=KO}catch{}const GO="startTransition",Ew=Ep[GO];function YO(t){let{basename:e,children:n,future:s,window:r}=t,i=v.useRef();i.current==null&&(i.current=ZA({window:r,v5Compat:!0}));let o=i.current,[a,l]=v.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},d=v.useCallback(h=>{u&&Ew?Ew(()=>l(h)):l(h)},[l,u]);return v.useLayoutEffect(()=>o.listen(d),[o,d]),v.useEffect(()=>HO(s),[s]),v.createElement(VO,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}var Tw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Tw||(Tw={}));var Pw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Pw||(Pw={}));var ep=["light","dark"],Uv="(prefers-color-scheme: dark)",QO=typeof window>"u",Hv=v.createContext(void 0),XO={setTheme:t=>{},themes:[]},JO=()=>{var t;return(t=v.useContext(Hv))!=null?t:XO},ZO=t=>v.useContext(Hv)?t.children:v.createElement(tM,{...t}),eM=["light","dark"],tM=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:s=!0,storageKey:r="theme",themes:i=eM,defaultTheme:o=n?"system":"light",attribute:a="data-theme",value:l,children:u,nonce:d})=>{let[h,f]=v.useState(()=>Rw(r,o)),[p,w]=v.useState(()=>Rw(r)),y=l?Object.values(l):i,x=v.useCallback(k=>{let _=k;if(!_)return;k==="system"&&n&&(_=Aw());let C=l?l[_]:_,S=e?sM():null,j=document.documentElement;if(a==="class"?(j.classList.remove(...y),C&&j.classList.add(C)):C?j.setAttribute(a,C):j.removeAttribute(a),s){let N=ep.includes(o)?o:null,P=ep.includes(_)?_:N;j.style.colorScheme=P}S==null||S()},[]),g=v.useCallback(k=>{let _=typeof k=="function"?k(k):k;f(_);try{localStorage.setItem(r,_)}catch{}},[t]),m=v.useCallback(k=>{let _=Aw(k);w(_),h==="system"&&n&&!t&&x("system")},[h,t]);v.useEffect(()=>{let k=window.matchMedia(Uv);return k.addListener(m),m(k),()=>k.removeListener(m)},[m]),v.useEffect(()=>{let k=_=>{if(_.key!==r)return;let C=_.newValue||o;g(C)};return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[g]),v.useEffect(()=>{x(t??h)},[t,h]);let b=v.useMemo(()=>({theme:h,setTheme:g,forcedTheme:t,resolvedTheme:h==="system"?p:h,themes:n?[...i,"system"]:i,systemTheme:n?p:void 0}),[h,g,t,p,n,i]);return v.createElement(Hv.Provider,{value:b},v.createElement(nM,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:s,storageKey:r,themes:i,defaultTheme:o,attribute:a,value:l,children:u,attrs:y,nonce:d}),u)},nM=v.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:s,enableColorScheme:r,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let u=i==="system",d=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(w=>`'${w}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=r?ep.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(w,y=!1,x=!0)=>{let g=o?o[w]:w,m=y?w+"|| ''":`'${g}'`,b="";return r&&x&&!y&&ep.includes(w)&&(b+=`d.style.colorScheme = '${w}';`),n==="class"?y||g?b+=`c.add(${m})`:b+="null":g&&(b+=`d[s](n,${m})`),b},p=t?`!function(){${d}${f(t)}}()`:s?`!function(){try{${d}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${Uv}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return v.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),Rw=(t,e)=>{if(QO)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},sM=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},Aw=t=>(t||(t=window.matchMedia(Uv)),t.matches?"dark":"light"),Ea=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},rM={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Mi,Vy,VS,iM=(VS=class{constructor(){Ce(this,Mi,rM);Ce(this,Vy,!1)}setTimeoutProvider(t){xe(this,Mi,t)}setTimeout(t,e){return M(this,Mi).setTimeout(t,e)}clearTimeout(t){M(this,Mi).clearTimeout(t)}setInterval(t,e){return M(this,Mi).setInterval(t,e)}clearInterval(t){M(this,Mi).clearInterval(t)}},Mi=new WeakMap,Vy=new WeakMap,VS),Yo=new iM;function oM(t){setTimeout(t,0)}var va=typeof window>"u"||"Deno"in globalThis;function En(){}function aM(t,e){return typeof t=="function"?t(e):t}function Lx(t){return typeof t=="number"&&t>=0&&t!==1/0}function TC(t,e){return Math.max(t+(e||0)-Date.now(),0)}function io(t,e){return typeof t=="function"?t(e):t}function Is(t,e){return typeof t=="function"?t(e):t}function Ow(t,e){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:o,stale:a}=t;if(o){if(s){if(e.queryHash!==Wv(o,e.options))return!1}else if(!Fu(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||r&&r!==e.state.fetchStatus||i&&!i(e))}function Mw(t,e){const{exact:n,status:s,predicate:r,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(ba(e.options.mutationKey)!==ba(i))return!1}else if(!Fu(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||r&&!r(e))}function Wv(t,e){return((e==null?void 0:e.queryKeyHashFn)||ba)(t)}function ba(t){return JSON.stringify(t,(e,n)=>$x(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Fu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Fu(t[n],e[n])):!1}var lM=Object.prototype.hasOwnProperty;function Vv(t,e){if(t===e)return t;const n=Iw(t)&&Iw(e);if(!n&&!($x(t)&&$x(e)))return e;const r=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let l=0;for(let u=0;u<o;u++){const d=n?u:i[u],h=t[d],f=e[d];if(h===f){a[d]=h,(n?u<r:lM.call(t,d))&&l++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){a[d]=f;continue}const p=Vv(h,f);a[d]=p,p===h&&l++}return r===o&&l===r?t:a}function zu(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Iw(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function $x(t){if(!Dw(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Dw(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Dw(t){return Object.prototype.toString.call(t)==="[object Object]"}function cM(t){return new Promise(e=>{Yo.setTimeout(e,t)})}function Fx(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Vv(t,e):e}function uM(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function dM(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var qv=Symbol();function PC(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===qv?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function RC(t,e){return typeof t=="function"?t(...e):!!t}var Zo,Ii,Dl,qS,hM=(qS=class extends Ea{constructor(){super();Ce(this,Zo);Ce(this,Ii);Ce(this,Dl);xe(this,Dl,e=>{if(!va&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){M(this,Ii)||this.setEventListener(M(this,Dl))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,Ii))==null||e.call(this),xe(this,Ii,void 0))}setEventListener(e){var n;xe(this,Dl,e),(n=M(this,Ii))==null||n.call(this),xe(this,Ii,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){M(this,Zo)!==e&&(xe(this,Zo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof M(this,Zo)=="boolean"?M(this,Zo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Zo=new WeakMap,Ii=new WeakMap,Dl=new WeakMap,qS),Kv=new hM;function zx(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),t(r)},n.reject=r=>{s({status:"rejected",reason:r}),e(r)},n}var fM=oM;function pM(){let t=[],e=0,n=a=>{a()},s=a=>{a()},r=fM;const i=a=>{e?t.push(a):r(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&r(()=>{s(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{r=a}}}var qt=pM(),Ll,Di,$l,KS,mM=(KS=class extends Ea{constructor(){super();Ce(this,Ll,!0);Ce(this,Di);Ce(this,$l);xe(this,$l,e=>{if(!va&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){M(this,Di)||this.setEventListener(M(this,$l))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,Di))==null||e.call(this),xe(this,Di,void 0))}setEventListener(e){var n;xe(this,$l,e),(n=M(this,Di))==null||n.call(this),xe(this,Di,e(this.setOnline.bind(this)))}setOnline(e){M(this,Ll)!==e&&(xe(this,Ll,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return M(this,Ll)}},Ll=new WeakMap,Di=new WeakMap,$l=new WeakMap,KS),tp=new mM;function gM(t){return Math.min(1e3*2**t,3e4)}function AC(t){return(t??"online")==="online"?tp.isOnline():!0}var Bx=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function OC(t){let e=!1,n=0,s;const r=zx(),i=()=>r.status!=="pending",o=y=>{var x;if(!i()){const g=new Bx(y);f(g),(x=t.onCancel)==null||x.call(t,g)}},a=()=>{e=!0},l=()=>{e=!1},u=()=>Kv.isFocused()&&(t.networkMode==="always"||tp.isOnline())&&t.canRun(),d=()=>AC(t.networkMode)&&t.canRun(),h=y=>{i()||(s==null||s(),r.resolve(y))},f=y=>{i()||(s==null||s(),r.reject(y))},p=()=>new Promise(y=>{var x;s=g=>{(i()||u())&&y(g)},(x=t.onPause)==null||x.call(t)}).then(()=>{var y;s=void 0,i()||(y=t.onContinue)==null||y.call(t)}),w=()=>{if(i())return;let y;const x=n===0?t.initialPromise:void 0;try{y=x??t.fn()}catch(g){y=Promise.reject(g)}Promise.resolve(y).then(h).catch(g=>{var C;if(i())return;const m=t.retry??(va?0:3),b=t.retryDelay??gM,k=typeof b=="function"?b(n,g):b,_=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,g);if(e||!_){f(g);return}n++,(C=t.onFail)==null||C.call(t,n,g),cM(k).then(()=>u()?void 0:p()).then(()=>{e?f(g):w()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(s==null||s(),r),cancelRetry:a,continueRetry:l,canStart:d,start:()=>(d()?w():p().then(w),r)}}var ea,GS,MC=(GS=class{constructor(){Ce(this,ea)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Lx(this.gcTime)&&xe(this,ea,Yo.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(va?1/0:5*60*1e3))}clearGcTimeout(){M(this,ea)&&(Yo.clearTimeout(M(this,ea)),xe(this,ea,void 0))}},ea=new WeakMap,GS),ta,Fl,Os,na,hn,hd,sa,sr,Vr,YS,xM=(YS=class extends MC{constructor(e){super();Ce(this,sr);Ce(this,ta);Ce(this,Fl);Ce(this,Os);Ce(this,na);Ce(this,hn);Ce(this,hd);Ce(this,sa);xe(this,sa,!1),xe(this,hd,e.defaultOptions),this.setOptions(e.options),this.observers=[],xe(this,na,e.client),xe(this,Os,M(this,na).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,xe(this,ta,$w(this.options)),this.state=e.state??M(this,ta),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=M(this,hn))==null?void 0:e.promise}setOptions(e){if(this.options={...M(this,hd),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=$w(this.options);n.data!==void 0&&(this.setState(Lw(n.data,n.dataUpdatedAt)),xe(this,ta,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&M(this,Os).remove(this)}setData(e,n){const s=Fx(this.state.data,e,this.options);return Fe(this,sr,Vr).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){Fe(this,sr,Vr).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,r;const n=(s=M(this,hn))==null?void 0:s.promise;return(r=M(this,hn))==null||r.cancel(e),n?n.then(En).catch(En):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(M(this,ta))}isActive(){return this.observers.some(e=>Is(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===qv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>io(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!TC(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=M(this,hn))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=M(this,hn))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),M(this,Os).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(M(this,hn)&&(M(this,sa)?M(this,hn).cancel({revert:!0}):M(this,hn).cancelRetry()),this.scheduleGc()),M(this,Os).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Fe(this,sr,Vr).call(this,{type:"invalidate"})}async fetch(e,n){var l,u,d,h,f,p,w,y,x,g,m,b;if(this.state.fetchStatus!=="idle"&&((l=M(this,hn))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(M(this,hn))return M(this,hn).continueRetry(),M(this,hn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const k=this.observers.find(_=>_.options.queryFn);k&&this.setOptions(k.options)}const s=new AbortController,r=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(xe(this,sa,!0),s.signal)})},i=()=>{const k=PC(this.options,n),C=(()=>{const S={client:M(this,na),queryKey:this.queryKey,meta:this.meta};return r(S),S})();return xe(this,sa,!1),this.options.persister?this.options.persister(k,C,this):k(C)},a=(()=>{const k={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:M(this,na),state:this.state,fetchFn:i};return r(k),k})();(u=this.options.behavior)==null||u.onFetch(a,this),xe(this,Fl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=a.fetchOptions)==null?void 0:d.meta))&&Fe(this,sr,Vr).call(this,{type:"fetch",meta:(h=a.fetchOptions)==null?void 0:h.meta}),xe(this,hn,OC({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,onCancel:k=>{k instanceof Bx&&k.revert&&this.setState({...M(this,Fl),fetchStatus:"idle"}),s.abort()},onFail:(k,_)=>{Fe(this,sr,Vr).call(this,{type:"failed",failureCount:k,error:_})},onPause:()=>{Fe(this,sr,Vr).call(this,{type:"pause"})},onContinue:()=>{Fe(this,sr,Vr).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const k=await M(this,hn).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(p=(f=M(this,Os).config).onSuccess)==null||p.call(f,k,this),(y=(w=M(this,Os).config).onSettled)==null||y.call(w,k,this.state.error,this),k}catch(k){if(k instanceof Bx){if(k.silent)return M(this,hn).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw Fe(this,sr,Vr).call(this,{type:"error",error:k}),(g=(x=M(this,Os).config).onError)==null||g.call(x,k,this),(b=(m=M(this,Os).config).onSettled)==null||b.call(m,this.state.data,k,this),k}finally{this.scheduleGc()}}},ta=new WeakMap,Fl=new WeakMap,Os=new WeakMap,na=new WeakMap,hn=new WeakMap,hd=new WeakMap,sa=new WeakMap,sr=new WeakSet,Vr=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...IC(s.data,this.options),fetchMeta:e.meta??null};case"success":const r={...s,...Lw(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return xe(this,Fl,e.manual?r:void 0),r;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),qt.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),M(this,Os).notify({query:this,type:"updated",action:e})})},YS);function IC(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:AC(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Lw(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function $w(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Xn,Ze,fd,Ln,ra,zl,Jr,Li,pd,Bl,Ul,ia,oa,$i,Hl,ht,Qc,Ux,Hx,Wx,Vx,qx,Kx,Gx,DC,QS,Gv=(QS=class extends Ea{constructor(e,n){super();Ce(this,ht);Ce(this,Xn);Ce(this,Ze);Ce(this,fd);Ce(this,Ln);Ce(this,ra);Ce(this,zl);Ce(this,Jr);Ce(this,Li);Ce(this,pd);Ce(this,Bl);Ce(this,Ul);Ce(this,ia);Ce(this,oa);Ce(this,$i);Ce(this,Hl,new Set);this.options=n,xe(this,Xn,e),xe(this,Li,null),xe(this,Jr,zx()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(M(this,Ze).addObserver(this),Fw(M(this,Ze),this.options)?Fe(this,ht,Qc).call(this):this.updateResult(),Fe(this,ht,Vx).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Yx(M(this,Ze),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Yx(M(this,Ze),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Fe(this,ht,qx).call(this),Fe(this,ht,Kx).call(this),M(this,Ze).removeObserver(this)}setOptions(e){const n=this.options,s=M(this,Ze);if(this.options=M(this,Xn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Is(this.options.enabled,M(this,Ze))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Fe(this,ht,Gx).call(this),M(this,Ze).setOptions(this.options),n._defaulted&&!zu(this.options,n)&&M(this,Xn).getQueryCache().notify({type:"observerOptionsUpdated",query:M(this,Ze),observer:this});const r=this.hasListeners();r&&zw(M(this,Ze),s,this.options,n)&&Fe(this,ht,Qc).call(this),this.updateResult(),r&&(M(this,Ze)!==s||Is(this.options.enabled,M(this,Ze))!==Is(n.enabled,M(this,Ze))||io(this.options.staleTime,M(this,Ze))!==io(n.staleTime,M(this,Ze)))&&Fe(this,ht,Ux).call(this);const i=Fe(this,ht,Hx).call(this);r&&(M(this,Ze)!==s||Is(this.options.enabled,M(this,Ze))!==Is(n.enabled,M(this,Ze))||i!==M(this,$i))&&Fe(this,ht,Wx).call(this,i)}getOptimisticResult(e){const n=M(this,Xn).getQueryCache().build(M(this,Xn),e),s=this.createResult(n,e);return vM(this,s)&&(xe(this,Ln,s),xe(this,zl,this.options),xe(this,ra,M(this,Ze).state)),s}getCurrentResult(){return M(this,Ln)}trackResult(e,n){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),n==null||n(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&M(this,Jr).status==="pending"&&M(this,Jr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){M(this,Hl).add(e)}getCurrentQuery(){return M(this,Ze)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=M(this,Xn).defaultQueryOptions(e),s=M(this,Xn).getQueryCache().build(M(this,Xn),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return Fe(this,ht,Qc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),M(this,Ln)))}createResult(e,n){var N;const s=M(this,Ze),r=this.options,i=M(this,Ln),o=M(this,ra),a=M(this,zl),u=e!==s?e.state:M(this,fd),{state:d}=e;let h={...d},f=!1,p;if(n._optimisticResults){const P=this.hasListeners(),L=!P&&Fw(e,n),I=P&&zw(e,s,n,r);(L||I)&&(h={...h,...IC(d.data,e.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:w,errorUpdatedAt:y,status:x}=h;p=h.data;let g=!1;if(n.placeholderData!==void 0&&p===void 0&&x==="pending"){let P;i!=null&&i.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData)?(P=i.data,g=!0):P=typeof n.placeholderData=="function"?n.placeholderData((N=M(this,Ul))==null?void 0:N.state.data,M(this,Ul)):n.placeholderData,P!==void 0&&(x="success",p=Fx(i==null?void 0:i.data,P,n),f=!0)}if(n.select&&p!==void 0&&!g)if(i&&p===(o==null?void 0:o.data)&&n.select===M(this,pd))p=M(this,Bl);else try{xe(this,pd,n.select),p=n.select(p),p=Fx(i==null?void 0:i.data,p,n),xe(this,Bl,p),xe(this,Li,null)}catch(P){xe(this,Li,P)}M(this,Li)&&(w=M(this,Li),p=M(this,Bl),y=Date.now(),x="error");const m=h.fetchStatus==="fetching",b=x==="pending",k=x==="error",_=b&&m,C=p!==void 0,j={status:x,fetchStatus:h.fetchStatus,isPending:b,isSuccess:x==="success",isError:k,isInitialLoading:_,isLoading:_,data:p,dataUpdatedAt:h.dataUpdatedAt,error:w,errorUpdatedAt:y,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:m,isRefetching:m&&!b,isLoadingError:k&&!C,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:k&&C,isStale:Yv(e,n),refetch:this.refetch,promise:M(this,Jr),isEnabled:Is(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const P=O=>{j.status==="error"?O.reject(j.error):j.data!==void 0&&O.resolve(j.data)},L=()=>{const O=xe(this,Jr,j.promise=zx());P(O)},I=M(this,Jr);switch(I.status){case"pending":e.queryHash===s.queryHash&&P(I);break;case"fulfilled":(j.status==="error"||j.data!==I.value)&&L();break;case"rejected":(j.status!=="error"||j.error!==I.reason)&&L();break}}return j}updateResult(){const e=M(this,Ln),n=this.createResult(M(this,Ze),this.options);if(xe(this,ra,M(this,Ze).state),xe(this,zl,this.options),M(this,ra).data!==void 0&&xe(this,Ul,M(this,Ze)),zu(n,e))return;xe(this,Ln,n);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!M(this,Hl).size)return!0;const o=new Set(i??M(this,Hl));return this.options.throwOnError&&o.add("error"),Object.keys(M(this,Ln)).some(a=>{const l=a;return M(this,Ln)[l]!==e[l]&&o.has(l)})};Fe(this,ht,DC).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Fe(this,ht,Vx).call(this)}},Xn=new WeakMap,Ze=new WeakMap,fd=new WeakMap,Ln=new WeakMap,ra=new WeakMap,zl=new WeakMap,Jr=new WeakMap,Li=new WeakMap,pd=new WeakMap,Bl=new WeakMap,Ul=new WeakMap,ia=new WeakMap,oa=new WeakMap,$i=new WeakMap,Hl=new WeakMap,ht=new WeakSet,Qc=function(e){Fe(this,ht,Gx).call(this);let n=M(this,Ze).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(En)),n},Ux=function(){Fe(this,ht,qx).call(this);const e=io(this.options.staleTime,M(this,Ze));if(va||M(this,Ln).isStale||!Lx(e))return;const s=TC(M(this,Ln).dataUpdatedAt,e)+1;xe(this,ia,Yo.setTimeout(()=>{M(this,Ln).isStale||this.updateResult()},s))},Hx=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(M(this,Ze)):this.options.refetchInterval)??!1},Wx=function(e){Fe(this,ht,Kx).call(this),xe(this,$i,e),!(va||Is(this.options.enabled,M(this,Ze))===!1||!Lx(M(this,$i))||M(this,$i)===0)&&xe(this,oa,Yo.setInterval(()=>{(this.options.refetchIntervalInBackground||Kv.isFocused())&&Fe(this,ht,Qc).call(this)},M(this,$i)))},Vx=function(){Fe(this,ht,Ux).call(this),Fe(this,ht,Wx).call(this,Fe(this,ht,Hx).call(this))},qx=function(){M(this,ia)&&(Yo.clearTimeout(M(this,ia)),xe(this,ia,void 0))},Kx=function(){M(this,oa)&&(Yo.clearInterval(M(this,oa)),xe(this,oa,void 0))},Gx=function(){const e=M(this,Xn).getQueryCache().build(M(this,Xn),this.options);if(e===M(this,Ze))return;const n=M(this,Ze);xe(this,Ze,e),xe(this,fd,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},DC=function(e){qt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(M(this,Ln))}),M(this,Xn).getQueryCache().notify({query:M(this,Ze),type:"observerResultsUpdated"})})},QS);function yM(t,e){return Is(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Fw(t,e){return yM(t,e)||t.state.data!==void 0&&Yx(t,e,e.refetchOnMount)}function Yx(t,e,n){if(Is(e.enabled,t)!==!1&&io(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&Yv(t,e)}return!1}function zw(t,e,n,s){return(t!==e||Is(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Yv(t,n)}function Yv(t,e){return Is(e.enabled,t)!==!1&&t.isStaleByTime(io(e.staleTime,t))}function vM(t,e){return!zu(t.getCurrentResult(),e)}function Bw(t){return{onFetch:(e,n)=>{var d,h,f,p,w;const s=e.options,r=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((w=e.state.data)==null?void 0:w.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const u=async()=>{let y=!1;const x=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?y=!0:e.signal.addEventListener("abort",()=>{y=!0}),e.signal)})},g=PC(e.options,e.fetchOptions),m=async(b,k,_)=>{if(y)return Promise.reject();if(k==null&&b.pages.length)return Promise.resolve(b);const S=(()=>{const L={client:e.client,queryKey:e.queryKey,pageParam:k,direction:_?"backward":"forward",meta:e.options.meta};return x(L),L})(),j=await g(S),{maxPages:N}=e.options,P=_?dM:uM;return{pages:P(b.pages,j,N),pageParams:P(b.pageParams,k,N)}};if(r&&i.length){const b=r==="backward",k=b?bM:Uw,_={pages:i,pageParams:o},C=k(s,_);a=await m(_,C,b)}else{const b=t??i.length;do{const k=l===0?o[0]??s.initialPageParam:Uw(s,a);if(l>0&&k==null)break;a=await m(a,k),l++}while(l<b)}return a};e.options.persister?e.fetchFn=()=>{var y,x;return(x=(y=e.options).persister)==null?void 0:x.call(y,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function Uw(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function bM(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var md,Nr,$n,aa,Er,ji,XS,wM=(XS=class extends MC{constructor(e){super();Ce(this,Er);Ce(this,md);Ce(this,Nr);Ce(this,$n);Ce(this,aa);xe(this,md,e.client),this.mutationId=e.mutationId,xe(this,$n,e.mutationCache),xe(this,Nr,[]),this.state=e.state||LC(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){M(this,Nr).includes(e)||(M(this,Nr).push(e),this.clearGcTimeout(),M(this,$n).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){xe(this,Nr,M(this,Nr).filter(n=>n!==e)),this.scheduleGc(),M(this,$n).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){M(this,Nr).length||(this.state.status==="pending"?this.scheduleGc():M(this,$n).remove(this))}continue(){var e;return((e=M(this,aa))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,a,l,u,d,h,f,p,w,y,x,g,m,b,k,_,C,S,j,N;const n=()=>{Fe(this,Er,ji).call(this,{type:"continue"})},s={client:M(this,md),meta:this.options.meta,mutationKey:this.options.mutationKey};xe(this,aa,OC({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(P,L)=>{Fe(this,Er,ji).call(this,{type:"failed",failureCount:P,error:L})},onPause:()=>{Fe(this,Er,ji).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>M(this,$n).canRun(this)}));const r=this.state.status==="pending",i=!M(this,aa).canStart();try{if(r)n();else{Fe(this,Er,ji).call(this,{type:"pending",variables:e,isPaused:i}),await((a=(o=M(this,$n).config).onMutate)==null?void 0:a.call(o,e,this,s));const L=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,e,s));L!==this.state.context&&Fe(this,Er,ji).call(this,{type:"pending",context:L,variables:e,isPaused:i})}const P=await M(this,aa).start();return await((h=(d=M(this,$n).config).onSuccess)==null?void 0:h.call(d,P,e,this.state.context,this,s)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,P,e,this.state.context,s)),await((y=(w=M(this,$n).config).onSettled)==null?void 0:y.call(w,P,null,this.state.variables,this.state.context,this,s)),await((g=(x=this.options).onSettled)==null?void 0:g.call(x,P,null,e,this.state.context,s)),Fe(this,Er,ji).call(this,{type:"success",data:P}),P}catch(P){try{throw await((b=(m=M(this,$n).config).onError)==null?void 0:b.call(m,P,e,this.state.context,this,s)),await((_=(k=this.options).onError)==null?void 0:_.call(k,P,e,this.state.context,s)),await((S=(C=M(this,$n).config).onSettled)==null?void 0:S.call(C,void 0,P,this.state.variables,this.state.context,this,s)),await((N=(j=this.options).onSettled)==null?void 0:N.call(j,void 0,P,e,this.state.context,s)),P}finally{Fe(this,Er,ji).call(this,{type:"error",error:P})}}finally{M(this,$n).runNext(this)}}},md=new WeakMap,Nr=new WeakMap,$n=new WeakMap,aa=new WeakMap,Er=new WeakSet,ji=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),qt.batch(()=>{M(this,Nr).forEach(s=>{s.onMutationUpdate(e)}),M(this,$n).notify({mutation:this,type:"updated",action:e})})},XS);function LC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Zr,rr,gd,JS,kM=(JS=class extends Ea{constructor(e={}){super();Ce(this,Zr);Ce(this,rr);Ce(this,gd);this.config=e,xe(this,Zr,new Set),xe(this,rr,new Map),xe(this,gd,0)}build(e,n,s){const r=new wM({client:e,mutationCache:this,mutationId:++Zd(this,gd)._,options:e.defaultMutationOptions(n),state:s});return this.add(r),r}add(e){M(this,Zr).add(e);const n=xh(e);if(typeof n=="string"){const s=M(this,rr).get(n);s?s.push(e):M(this,rr).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(M(this,Zr).delete(e)){const n=xh(e);if(typeof n=="string"){const s=M(this,rr).get(n);if(s)if(s.length>1){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}else s[0]===e&&M(this,rr).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=xh(e);if(typeof n=="string"){const s=M(this,rr).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===e}else return!0}runNext(e){var s;const n=xh(e);if(typeof n=="string"){const r=(s=M(this,rr).get(n))==null?void 0:s.find(i=>i!==e&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){qt.batch(()=>{M(this,Zr).forEach(e=>{this.notify({type:"removed",mutation:e})}),M(this,Zr).clear(),M(this,rr).clear()})}getAll(){return Array.from(M(this,Zr))}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Mw(n,s))}findAll(e={}){return this.getAll().filter(n=>Mw(e,n))}notify(e){qt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return qt.batch(()=>Promise.all(e.map(n=>n.continue().catch(En))))}},Zr=new WeakMap,rr=new WeakMap,gd=new WeakMap,JS);function xh(t){var e;return(e=t.options.scope)==null?void 0:e.id}var ei,Fi,Jn,ti,li,gf,Qx,ZS,_M=(ZS=class extends Ea{constructor(n,s){super();Ce(this,li);Ce(this,ei);Ce(this,Fi);Ce(this,Jn);Ce(this,ti);xe(this,ei,n),this.setOptions(s),this.bindMethods(),Fe(this,li,gf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const s=this.options;this.options=M(this,ei).defaultMutationOptions(n),zu(this.options,s)||M(this,ei).getMutationCache().notify({type:"observerOptionsUpdated",mutation:M(this,Jn),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&ba(s.mutationKey)!==ba(this.options.mutationKey)?this.reset():((r=M(this,Jn))==null?void 0:r.state.status)==="pending"&&M(this,Jn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=M(this,Jn))==null||n.removeObserver(this)}onMutationUpdate(n){Fe(this,li,gf).call(this),Fe(this,li,Qx).call(this,n)}getCurrentResult(){return M(this,Fi)}reset(){var n;(n=M(this,Jn))==null||n.removeObserver(this),xe(this,Jn,void 0),Fe(this,li,gf).call(this),Fe(this,li,Qx).call(this)}mutate(n,s){var r;return xe(this,ti,s),(r=M(this,Jn))==null||r.removeObserver(this),xe(this,Jn,M(this,ei).getMutationCache().build(M(this,ei),this.options)),M(this,Jn).addObserver(this),M(this,Jn).execute(n)}},ei=new WeakMap,Fi=new WeakMap,Jn=new WeakMap,ti=new WeakMap,li=new WeakSet,gf=function(){var s;const n=((s=M(this,Jn))==null?void 0:s.state)??LC();xe(this,Fi,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Qx=function(n){qt.batch(()=>{var s,r,i,o,a,l,u,d;if(M(this,ti)&&this.hasListeners()){const h=M(this,Fi).variables,f=M(this,Fi).context,p={client:M(this,ei),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((r=(s=M(this,ti)).onSuccess)==null||r.call(s,n.data,h,f,p),(o=(i=M(this,ti)).onSettled)==null||o.call(i,n.data,null,h,f,p)):(n==null?void 0:n.type)==="error"&&((l=(a=M(this,ti)).onError)==null||l.call(a,n.error,h,f,p),(d=(u=M(this,ti)).onSettled)==null||d.call(u,void 0,n.error,h,f,p))}this.listeners.forEach(h=>{h(M(this,Fi))})})},ZS);function Hw(t,e){const n=new Set(e);return t.filter(s=>!n.has(s))}function SM(t,e,n){const s=t.slice(0);return s[e]=n,s}var Wl,xs,Vl,ql,Ms,zi,xd,yd,vd,kn,Xx,Jx,Zx,ey,ty,e1,jM=(e1=class extends Ea{constructor(e,n,s){super();Ce(this,kn);Ce(this,Wl);Ce(this,xs);Ce(this,Vl);Ce(this,ql);Ce(this,Ms);Ce(this,zi);Ce(this,xd);Ce(this,yd);Ce(this,vd,[]);xe(this,Wl,e),xe(this,ql,s),xe(this,Vl,[]),xe(this,Ms,[]),xe(this,xs,[]),this.setQueries(n)}onSubscribe(){this.listeners.size===1&&M(this,Ms).forEach(e=>{e.subscribe(n=>{Fe(this,kn,ey).call(this,e,n)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,M(this,Ms).forEach(e=>{e.destroy()})}setQueries(e,n){xe(this,Vl,e),xe(this,ql,n),qt.batch(()=>{const s=M(this,Ms),r=Fe(this,kn,Zx).call(this,M(this,Vl));xe(this,vd,r),r.forEach(h=>h.observer.setOptions(h.defaultedQueryOptions));const i=r.map(h=>h.observer),o=i.map(h=>h.getCurrentResult()),a=s.length!==i.length,l=i.some((h,f)=>h!==s[f]),u=a||l,d=u?!0:o.some((h,f)=>{const p=M(this,xs)[f];return!p||!zu(h,p)});!u&&!d||(u&&xe(this,Ms,i),xe(this,xs,o),this.hasListeners()&&(u&&(Hw(s,i).forEach(h=>{h.destroy()}),Hw(i,s).forEach(h=>{h.subscribe(f=>{Fe(this,kn,ey).call(this,h,f)})})),Fe(this,kn,ty).call(this)))})}getCurrentResult(){return M(this,xs)}getQueries(){return M(this,Ms).map(e=>e.getCurrentQuery())}getObservers(){return M(this,Ms)}getOptimisticResult(e,n){const s=Fe(this,kn,Zx).call(this,e),r=s.map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[r,i=>Fe(this,kn,Jx).call(this,i??r,n),()=>Fe(this,kn,Xx).call(this,r,s)]}},Wl=new WeakMap,xs=new WeakMap,Vl=new WeakMap,ql=new WeakMap,Ms=new WeakMap,zi=new WeakMap,xd=new WeakMap,yd=new WeakMap,vd=new WeakMap,kn=new WeakSet,Xx=function(e,n){return n.map((s,r)=>{const i=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?i:s.observer.trackResult(i,o=>{n.forEach(a=>{a.observer.trackProp(o)})})})},Jx=function(e,n){return n?((!M(this,zi)||M(this,xs)!==M(this,yd)||n!==M(this,xd))&&(xe(this,xd,n),xe(this,yd,M(this,xs)),xe(this,zi,Vv(M(this,zi),n(e)))),M(this,zi)):e},Zx=function(e){const n=new Map;M(this,Ms).forEach(r=>{const i=r.options.queryHash;if(!i)return;const o=n.get(i);o?o.push(r):n.set(i,[r])});const s=[];return e.forEach(r=>{var l;const i=M(this,Wl).defaultQueryOptions(r),a=((l=n.get(i.queryHash))==null?void 0:l.shift())??new Gv(M(this,Wl),i);s.push({defaultedQueryOptions:i,observer:a})}),s},ey=function(e,n){const s=M(this,Ms).indexOf(e);s!==-1&&(xe(this,xs,SM(M(this,xs),s,n)),Fe(this,kn,ty).call(this))},ty=function(){var e;if(this.hasListeners()){const n=M(this,zi),s=Fe(this,kn,Xx).call(this,M(this,xs),M(this,vd)),r=Fe(this,kn,Jx).call(this,s,(e=M(this,ql))==null?void 0:e.combine);n!==r&&qt.batch(()=>{this.listeners.forEach(i=>{i(M(this,xs))})})}},e1),Tr,t1,CM=(t1=class extends Ea{constructor(e={}){super();Ce(this,Tr);this.config=e,xe(this,Tr,new Map)}build(e,n,s){const r=n.queryKey,i=n.queryHash??Wv(r,n);let o=this.get(i);return o||(o=new xM({client:e,queryKey:r,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(o)),o}add(e){M(this,Tr).has(e.queryHash)||(M(this,Tr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=M(this,Tr).get(e.queryHash);n&&(e.destroy(),n===e&&M(this,Tr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){qt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return M(this,Tr).get(e)}getAll(){return[...M(this,Tr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Ow(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>Ow(e,s)):n}notify(e){qt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){qt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){qt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Tr=new WeakMap,t1),Ht,Bi,Ui,Kl,Gl,Hi,Yl,Ql,n1,NM=(n1=class{constructor(t={}){Ce(this,Ht);Ce(this,Bi);Ce(this,Ui);Ce(this,Kl);Ce(this,Gl);Ce(this,Hi);Ce(this,Yl);Ce(this,Ql);xe(this,Ht,t.queryCache||new CM),xe(this,Bi,t.mutationCache||new kM),xe(this,Ui,t.defaultOptions||{}),xe(this,Kl,new Map),xe(this,Gl,new Map),xe(this,Hi,0)}mount(){Zd(this,Hi)._++,M(this,Hi)===1&&(xe(this,Yl,Kv.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Ht).onFocus())})),xe(this,Ql,tp.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Ht).onOnline())})))}unmount(){var t,e;Zd(this,Hi)._--,M(this,Hi)===0&&((t=M(this,Yl))==null||t.call(this),xe(this,Yl,void 0),(e=M(this,Ql))==null||e.call(this),xe(this,Ql,void 0))}isFetching(t){return M(this,Ht).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return M(this,Bi).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,Ht).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=M(this,Ht).build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(io(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return M(this,Ht).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),r=M(this,Ht).get(s.queryHash),i=r==null?void 0:r.state.data,o=aM(e,i);if(o!==void 0)return M(this,Ht).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return qt.batch(()=>M(this,Ht).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,Ht).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=M(this,Ht);qt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=M(this,Ht);return qt.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=qt.batch(()=>M(this,Ht).findAll(t).map(r=>r.cancel(n)));return Promise.all(s).then(En).catch(En)}invalidateQueries(t,e={}){return qt.batch(()=>(M(this,Ht).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=qt.batch(()=>M(this,Ht).findAll(t).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(En)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(En)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=M(this,Ht).build(this,e);return n.isStaleByTime(io(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(En).catch(En)}fetchInfiniteQuery(t){return t.behavior=Bw(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(En).catch(En)}ensureInfiniteQueryData(t){return t.behavior=Bw(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return tp.isOnline()?M(this,Bi).resumePausedMutations():Promise.resolve()}getQueryCache(){return M(this,Ht)}getMutationCache(){return M(this,Bi)}getDefaultOptions(){return M(this,Ui)}setDefaultOptions(t){xe(this,Ui,t)}setQueryDefaults(t,e){M(this,Kl).set(ba(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...M(this,Kl).values()],n={};return e.forEach(s=>{Fu(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){M(this,Gl).set(ba(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...M(this,Gl).values()],n={};return e.forEach(s=>{Fu(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...M(this,Ui).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Wv(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===qv&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...M(this,Ui).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){M(this,Ht).clear(),M(this,Bi).clear()}},Ht=new WeakMap,Bi=new WeakMap,Ui=new WeakMap,Kl=new WeakMap,Gl=new WeakMap,Hi=new WeakMap,Yl=new WeakMap,Ql=new WeakMap,n1),$C=v.createContext(void 0),Ks=t=>{const e=v.useContext($C);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},EM=({client:t,children:e})=>(v.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),c.jsx($C.Provider,{value:t,children:e})),FC=v.createContext(!1),zC=()=>v.useContext(FC);FC.Provider;function TM(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var PM=v.createContext(TM()),BC=()=>v.useContext(PM),UC=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},HC=t=>{v.useEffect(()=>{t.clearReset()},[t])},WC=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:r})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(r&&t.data===void 0||RC(n,[t.error,s])),VC=t=>{if(t.suspense){const n=r=>r==="static"?r:Math.max(r??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...r)=>n(s(...r)):n(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},qC=(t,e)=>t.isLoading&&t.isFetching&&!e,ny=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,np=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function RM({queries:t,...e},n){const s=Ks(),r=zC(),i=BC(),o=v.useMemo(()=>t.map(y=>{const x=s.defaultQueryOptions(y);return x._optimisticResults=r?"isRestoring":"optimistic",x}),[t,s,r]);o.forEach(y=>{VC(y),UC(y,i)}),HC(i);const[a]=v.useState(()=>new jM(s,o,e)),[l,u,d]=a.getOptimisticResult(o,e.combine),h=!r&&e.subscribed!==!1;v.useSyncExternalStore(v.useCallback(y=>h?a.subscribe(qt.batchCalls(y)):En,[a,h]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),v.useEffect(()=>{a.setQueries(o,e)},[o,e,a]);const p=l.some((y,x)=>ny(o[x],y))?l.flatMap((y,x)=>{const g=o[x];if(g){const m=new Gv(s,g);if(ny(g,y))return np(g,m,i);qC(y,r)&&np(g,m,i)}return[]}):[];if(p.length>0)throw Promise.all(p);const w=l.find((y,x)=>{const g=o[x];return g&&WC({result:y,errorResetBoundary:i,throwOnError:g.throwOnError,query:s.getQueryCache().get(g.queryHash),suspense:g.suspense})});if(w!=null&&w.error)throw w.error;return u(d())}function AM(t,e,n){var h,f,p,w,y;const s=zC(),r=BC(),i=Ks(),o=i.defaultQueryOptions(t);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,o),o._optimisticResults=s?"isRestoring":"optimistic",VC(o),UC(o,r),HC(r);const a=!i.getQueryCache().get(o.queryHash),[l]=v.useState(()=>new e(i,o)),u=l.getOptimisticResult(o),d=!s&&t.subscribed!==!1;if(v.useSyncExternalStore(v.useCallback(x=>{const g=d?l.subscribe(qt.batchCalls(x)):En;return l.updateResult(),g},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),v.useEffect(()=>{l.setOptions(o)},[o,l]),ny(o,u))throw np(o,l,r);if(WC({result:u,errorResetBoundary:r,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((w=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||w.call(p,o,u),o.experimental_prefetchInRender&&!va&&qC(u,s)){const x=a?np(o,l,r):(y=i.getQueryCache().get(o.queryHash))==null?void 0:y.promise;x==null||x.catch(En).finally(()=>{l.updateResult()})}return o.notifyOnChangeProps?u:l.trackResult(u)}function Kt(t,e){return AM(t,Gv)}function KC(t,e){const n=Ks(),[s]=v.useState(()=>new _M(n,t));v.useEffect(()=>{s.setOptions(t)},[s,t]);const r=v.useSyncExternalStore(v.useCallback(o=>s.subscribe(qt.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((o,a)=>{s.mutate(o,a).catch(En)},[s]);if(r.error&&RC(s.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),GC=(...t)=>t.filter((e,n,s)=>!!e&&s.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var MM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=v.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...a},l)=>v.createElement("svg",{ref:l,...MM,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:GC("lucide",r),...a},[...o.map(([u,d])=>v.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=(t,e)=>{const n=v.forwardRef(({className:s,...r},i)=>v.createElement(IM,{ref:i,iconNode:e,className:GC(`lucide-${OM(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DM=it("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=it("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=it("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=it("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=it("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=it("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=it("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=it("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=it("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=it("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=it("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=it("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=it("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=it("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=it("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=it("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=it("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=it("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=it("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=it("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=it("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=it("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=it("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=it("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=it("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=it("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=it("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=it("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=it("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YM=it("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=it("UserRoundX",[["path",{d:"M2 21a8 8 0 0 1 11.873-7",key:"74fkxq"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m17 17 5 5",key:"p7ous7"}],["path",{d:"m22 17-5 5",key:"gqnmv0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=it("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=it("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Ww(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Ta(...t){return e=>{let n=!1;const s=t.map(r=>{const i=Ww(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():Ww(t[r],null)}}}}function cs(...t){return v.useCallback(Ta(...t),t)}var XM=Symbol.for("react.lazy"),sp=Ep[" use ".trim().toString()];function JM(t){return typeof t=="object"&&t!==null&&"then"in t}function eN(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===XM&&"_payload"in t&&JM(t._payload)}function ZM(t){const e=tI(t),n=v.forwardRef((s,r)=>{let{children:i,...o}=s;eN(i)&&typeof sp=="function"&&(i=sp(i._payload));const a=v.Children.toArray(i),l=a.find(sI);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}var eI=ZM("Slot");function tI(t){const e=v.forwardRef((n,s)=>{let{children:r,...i}=n;if(eN(r)&&typeof sp=="function"&&(r=sp(r._payload)),v.isValidElement(r)){const o=iI(r),a=rI(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Ta(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var nI=Symbol("radix.slottable");function sI(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===nI}function rI(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function iI(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function tN(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=tN(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function nN(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=tN(t))&&(s&&(s+=" "),s+=e);return s}const Vw=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,qw=nN,oI=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return qw(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=Vw(d)||Vw(h);return r[u][f]}),a=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(w=>{let[y,x]=w;return Array.isArray(x)?x.includes({...i,...a}[y]):{...i,...a}[y]===x})?[...u,h,f]:u},[]);return qw(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},Jv="-",aI=t=>{const e=cI(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const a=o.split(Jv);return a[0]===""&&a.length!==1&&a.shift(),sN(a,e)||lI(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&s[o]?[...l,...s[o]]:l}}},sN=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?sN(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const i=t.join(Jv);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},Kw=/^\[(.+)\]$/,lI=t=>{if(Kw.test(t)){const e=Kw.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},cI=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return dI(Object.entries(t.classGroups),n).forEach(([i,o])=>{sy(o,s,i,e)}),s},sy=(t,e,n,s)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?e:Gw(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(uI(r)){sy(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([i,o])=>{sy(o,Gw(e,i),n,s)})})},Gw=(t,e)=>{let n=t;return e.split(Jv).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},uI=t=>t.isThemeGetter,dI=(t,e)=>e?t.map(([n,s])=>{const r=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,r]}):t,hI=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const r=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return r(i,o),o},set(i,o){n.has(i)?n.set(i,o):r(i,o)}}},rN="!",fI=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,r=e[0],i=e.length,o=a=>{const l=[];let u=0,d=0,h;for(let x=0;x<a.length;x++){let g=a[x];if(u===0){if(g===r&&(s||a.slice(x,x+i)===e)){l.push(a.slice(d,x)),d=x+i;continue}if(g==="/"){h=x;continue}}g==="["?u++:g==="]"&&u--}const f=l.length===0?a:a.substring(d),p=f.startsWith(rN),w=p?f.substring(1):f,y=h&&h>d?h-d:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:w,maybePostfixModifierPosition:y}};return n?a=>n({className:a,parseClassName:o}):o},pI=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},mI=t=>({cache:hI(t.cacheSize),parseClassName:fI(t),...aI(t)}),gI=/\s+/,xI=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,i=[],o=t.trim().split(gI);let a="";for(let l=o.length-1;l>=0;l-=1){const u=o[l],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=n(u);let w=!!p,y=s(w?f.substring(0,p):f);if(!y){if(!w){a=u+(a.length>0?" "+a:a);continue}if(y=s(f),!y){a=u+(a.length>0?" "+a:a);continue}w=!1}const x=pI(d).join(":"),g=h?x+rN:x,m=g+y;if(i.includes(m))continue;i.push(m);const b=r(y,w);for(let k=0;k<b.length;++k){const _=b[k];i.push(g+_)}a=u+(a.length>0?" "+a:a)}return a};function yI(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=iN(e))&&(s&&(s+=" "),s+=n);return s}const iN=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=iN(t[s]))&&(n&&(n+=" "),n+=e);return n};function vI(t,...e){let n,s,r,i=o;function o(l){const u=e.reduce((d,h)=>h(d),t());return n=mI(u),s=n.cache.get,r=n.cache.set,i=a,a(l)}function a(l){const u=s(l);if(u)return u;const d=xI(l,n);return r(l,d),d}return function(){return i(yI.apply(null,arguments))}}const Ct=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},oN=/^\[(?:([a-z-]+):)?(.+)\]$/i,bI=/^\d+\/\d+$/,wI=new Set(["px","full","screen"]),kI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,_I=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,SI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,jI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,CI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Hr=t=>Cl(t)||wI.has(t)||bI.test(t),_i=t=>dc(t,"length",MI),Cl=t=>!!t&&!Number.isNaN(Number(t)),Km=t=>dc(t,"number",Cl),Dc=t=>!!t&&Number.isInteger(Number(t)),NI=t=>t.endsWith("%")&&Cl(t.slice(0,-1)),Ge=t=>oN.test(t),Si=t=>kI.test(t),EI=new Set(["length","size","percentage"]),TI=t=>dc(t,EI,aN),PI=t=>dc(t,"position",aN),RI=new Set(["image","url"]),AI=t=>dc(t,RI,DI),OI=t=>dc(t,"",II),Lc=()=>!0,dc=(t,e,n)=>{const s=oN.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},MI=t=>_I.test(t)&&!SI.test(t),aN=()=>!1,II=t=>jI.test(t),DI=t=>CI.test(t),LI=()=>{const t=Ct("colors"),e=Ct("spacing"),n=Ct("blur"),s=Ct("brightness"),r=Ct("borderColor"),i=Ct("borderRadius"),o=Ct("borderSpacing"),a=Ct("borderWidth"),l=Ct("contrast"),u=Ct("grayscale"),d=Ct("hueRotate"),h=Ct("invert"),f=Ct("gap"),p=Ct("gradientColorStops"),w=Ct("gradientColorStopPositions"),y=Ct("inset"),x=Ct("margin"),g=Ct("opacity"),m=Ct("padding"),b=Ct("saturate"),k=Ct("scale"),_=Ct("sepia"),C=Ct("skew"),S=Ct("space"),j=Ct("translate"),N=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],L=()=>["auto",Ge,e],I=()=>[Ge,e],O=()=>["",Hr,_i],$=()=>["auto",Cl,Ge],D=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],F=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],E=()=>["start","end","center","between","around","evenly","stretch"],R=()=>["","0",Ge],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[Cl,Ge];return{cacheSize:500,separator:":",theme:{colors:[Lc],spacing:[Hr,_i],blur:["none","",Si,Ge],brightness:K(),borderColor:[t],borderRadius:["none","","full",Si,Ge],borderSpacing:I(),borderWidth:O(),contrast:K(),grayscale:R(),hueRotate:K(),invert:R(),gap:I(),gradientColorStops:[t],gradientColorStopPositions:[NI,_i],inset:L(),margin:L(),opacity:K(),padding:I(),saturate:K(),scale:K(),sepia:R(),skew:K(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Ge]}],container:["container"],columns:[{columns:[Si]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...D(),Ge]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Dc,Ge]}],basis:[{basis:L()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ge]}],grow:[{grow:R()}],shrink:[{shrink:R()}],order:[{order:["first","last","none",Dc,Ge]}],"grid-cols":[{"grid-cols":[Lc]}],"col-start-end":[{col:["auto",{span:["full",Dc,Ge]},Ge]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[Lc]}],"row-start-end":[{row:["auto",{span:[Dc,Ge]},Ge]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ge]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ge]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...E()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...E(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...E(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[m]}],px:[{px:[m]}],py:[{py:[m]}],ps:[{ps:[m]}],pe:[{pe:[m]}],pt:[{pt:[m]}],pr:[{pr:[m]}],pb:[{pb:[m]}],pl:[{pl:[m]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ge,e]}],"min-w":[{"min-w":[Ge,e,"min","max","fit"]}],"max-w":[{"max-w":[Ge,e,"none","full","min","max","fit","prose",{screen:[Si]},Si]}],h:[{h:[Ge,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ge,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ge,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ge,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Si,_i]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Km]}],"font-family":[{font:[Lc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ge]}],"line-clamp":[{"line-clamp":["none",Cl,Km]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Hr,Ge]}],"list-image":[{"list-image":["none",Ge]}],"list-style-type":[{list:["none","disc","decimal",Ge]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...F(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Hr,_i]}],"underline-offset":[{"underline-offset":["auto",Hr,Ge]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ge]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ge]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...D(),PI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",TI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},AI]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...F(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:F()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...F()]}],"outline-offset":[{"outline-offset":[Hr,Ge]}],"outline-w":[{outline:[Hr,_i]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Hr,_i]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Si,OI]}],"shadow-color":[{shadow:[Lc]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Si,Ge]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ge]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",Ge]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ge]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Dc,Ge]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ge]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ge]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ge]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Hr,_i,Km]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},$I=vI(LI);function Pe(...t){return $I(nN(t))}function vn(t){return t.split(/\n|,/).map(e=>e.trim()).filter(Boolean)}function ry(t){if(!t)return{module:"",service:"",action:""};const[e,n,s]=t.split(":");return{module:(e==null?void 0:e.trim())||"",service:(n==null?void 0:n.trim())||"",action:(s==null?void 0:s.trim())||""}}function Yw({module:t,service:e,action:n}){return!t||!e||!n?"":`${t}:${e}:${n}`}function Nl(t,e,n=`${e}s`){return t?`${t} ${t===1?e:n} selected`:`No ${n} selected`}function yf(t,e={}){return{...e,...t||{}}}const FI=oI("inline-flex items-center justify-center whitespace-nowrap rounded-xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black/10 dark:focus-visible:ring-white/15 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"mmg-btn-primary bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90 shadow-soft",secondary:"bg-black/5 text-black hover:bg-black/8 dark:bg-white/10 dark:text-white dark:hover:bg-white/15 shadow-soft",ghost:"bg-transparent hover:bg-black/5 text-black dark:text-white dark:hover:bg-white/10 shadow-soft"},size:{default:"h-10 px-4",sm:"h-9 px-3",lg:"h-11 px-5",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),se=ve.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...r},i)=>{const o=s?eI:"button";return c.jsx(o,{className:Pe(FI({variant:e,size:n,className:t})),ref:i,...r})});se.displayName="Button";function Ve({text:t="Loading",className:e=""}){return c.jsxs("span",{className:["inline-flex items-center gap-2",e].filter(Boolean).join(" "),children:[c.jsx("span",{children:t}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}var Or=function(){return Or=Object.assign||function(e){for(var n,s=1,r=arguments.length;s<r;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Or.apply(this,arguments)};function hc(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function zI(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function l(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,l)}u((s=s.apply(t,e||[])).next())})}function BI(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}const UI=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Zv extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class HI extends Zv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Qw extends Zv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Xw extends Zv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var iy;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(iy||(iy={}));class WI{constructor(e,{headers:n={},customFetch:s,region:r=iy.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=UI(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return zI(this,arguments,void 0,function*(n,s={}){var r;let i,o;try{const{headers:a,method:l,body:u,signal:d,timeout:h}=s;let f={},{region:p}=s;p||(p=this.region);const w=new URL(`${this.url}/${n}`);p&&p!=="any"&&(f["x-region"]=p,w.searchParams.set("forceFunctionRegion",p));let y;u&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",y=u):typeof u=="string"?(f["Content-Type"]="text/plain",y=u):typeof FormData<"u"&&u instanceof FormData?y=u:(f["Content-Type"]="application/json",y=JSON.stringify(u)):y=u;let x=d;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),d?(x=o.signal,d.addEventListener("abort",()=>o.abort())):x=o.signal);const g=yield this.fetch(w.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:y,signal:x}).catch(_=>{throw new HI(_)}),m=g.headers.get("x-relay-error");if(m&&m==="true")throw new Qw(g);if(!g.ok)throw new Xw(g);let b=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return b==="application/json"?k=yield g.json():b==="application/octet-stream"||b==="application/pdf"?k=yield g.blob():b==="text/event-stream"?k=g:b==="multipart/form-data"?k=yield g.formData():k=yield g.text(),{data:k,error:null,response:g}}catch(a){return{data:null,error:a,response:a instanceof Xw||a instanceof Qw?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var VI=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},qI=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,a=null,l=null,u=i.status,d=i.statusText;if(i.ok){var h,f;if(n.method!=="HEAD"){var p;const g=await i.text();g===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((p=n.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?a=g:a=JSON.parse(g))}const y=(h=n.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),x=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");y&&x&&x.length>1&&(l=parseInt(x[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,u=406,d="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var w;const y=await i.text();try{o=JSON.parse(y),Array.isArray(o)&&i.status===404&&(a=[],o=null,u=200,d="OK")}catch{i.status===404&&y===""?(u=204,d="No Content"):o={message:y}}if(o&&n.isMaybeSingle&&(!(o==null||(w=o.details)===null||w===void 0)&&w.includes("0 rows"))&&(o=null,u=200,d="OK"),o&&n.shouldThrowOnError)throw new VI(o)}return{error:o,data:a,count:l,status:u,statusText:d}});return this.shouldThrowOnError||(r=r.catch(i=>{var o;let a="";const l=i==null?void 0:i.cause;if(l){var u,d,h,f;const w=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",y=(d=l==null?void 0:l.code)!==null&&d!==void 0?d:"";a=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,a+=`

Caused by: ${(f=l==null?void 0:l.name)!==null&&f!==void 0?f:"Error"}: ${w}`,y&&(a+=` (${y})`),l!=null&&l.stack&&(a+=`
${l.stack}`)}else{var p;a=(p=i==null?void 0:i.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},KI=class extends qI{select(t){let e=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:r=s}={}){const i=r?`${r}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:r=!1,format:i="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Jw=new RegExp("[,()]");var nl=class extends KI{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&Jw.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&Jw.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${r}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},GI=class{constructor(t,{headers:e={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=s}select(t,e){const{head:n=!1,count:s}=e??{},r=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new nl({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var s;const r="POST";if(e&&this.headers.append("Prefer",`count=${e}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,a)=>o.concat(Object.keys(a)),[]);if(i.length>0){const o=[...new Set(i)].map(a=>`"${a}"`);this.url.searchParams.set("columns",o.join(","))}}return new nl({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new nl({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var n;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new nl({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new nl({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},YI=class lN{constructor(e,{headers:n={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new GI(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new lN(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:r=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let u;s||r?(a=s?"HEAD":"GET",Object.entries(n).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{l.searchParams.append(h,f)})):(a="POST",u=n);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new nl({method:a,url:l,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class QI{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const XI="2.88.0",JI=`realtime-js/${XI}`,cN="1.0.0",ZI="2.0.0",Zw=cN,oy=1e4,eD=1e3,tD=100;var Ti;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ti||(Ti={}));var on;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(on||(on={}));var or;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(or||(or={}));var ay;(function(t){t.websocket="websocket"})(ay||(ay={}));var Wo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Wo||(Wo={}));class nD{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,s){var r,i;const o=e.topic,a=(r=e.ref)!==null&&r!==void 0?r:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+u.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let w=new DataView(p),y=0;w.setUint8(y++,this.KINDS.userBroadcastPush),w.setUint8(y++,l.length),w.setUint8(y++,a.length),w.setUint8(y++,o.length),w.setUint8(y++,u.length),w.setUint8(y++,h.length),w.setUint8(y++,n),Array.from(l,g=>w.setUint8(y++,g.charCodeAt(0))),Array.from(a,g=>w.setUint8(y++,g.charCodeAt(0))),Array.from(o,g=>w.setUint8(y++,g.charCodeAt(0))),Array.from(u,g=>w.setUint8(y++,g.charCodeAt(0))),Array.from(h,g=>w.setUint8(y++,g.charCodeAt(0)));var x=new Uint8Array(p.byteLength+s.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(s),p.byteLength),x.buffer}decode(e,n){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return n(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,i,o,a,l]=s;return n({join_ref:r,ref:i,topic:o,event:a,payload:l})}return n({})}_binaryDecode(e){const n=new DataView(e),s=n.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,r)}}_decodeUserBroadcast(e,n,s){const r=n.getUint8(1),i=n.getUint8(2),o=n.getUint8(3),a=n.getUint8(4);let l=this.HEADER_LENGTH+4;const u=s.decode(e.slice(l,l+r));l=l+r;const d=s.decode(e.slice(l,l+i));l=l+i;const h=s.decode(e.slice(l,l+o));l=l+o;const f=e.slice(l,e.byteLength),p=a===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,w={type:this.BROADCAST_EVENT,event:d,payload:p};return o>0&&(w.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>n.includes(s)))}}class uN{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var kt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(kt||(kt={}));const ek=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=sD(o,t,e,r),i),{}):{}},sD=(t,e,n,s)=>{const r=e.find(a=>a.name===t),i=r==null?void 0:r.type,o=n[t];return i&&!s.includes(i)?dN(i,o):ly(o)},dN=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return aD(e,n)}switch(t){case kt.bool:return rD(e);case kt.float4:case kt.float8:case kt.int2:case kt.int4:case kt.int8:case kt.numeric:case kt.oid:return iD(e);case kt.json:case kt.jsonb:return oD(e);case kt.timestamp:return lD(e);case kt.abstime:case kt.date:case kt.daterange:case kt.int4range:case kt.int8range:case kt.money:case kt.reltime:case kt.text:case kt.time:case kt.timestamptz:case kt.timetz:case kt.tsrange:case kt.tstzrange:return ly(e);default:return ly(e)}},ly=t=>t,rD=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},iD=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},oD=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},aD=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>dN(e,a))}return t},lD=t=>typeof t=="string"?t.replace(" ","T"):t,hN=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Gm{constructor(e,n,s={},r=oy){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var tk;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(tk||(tk={}));class fu{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fu.syncState(this.state,r,i,o),this.pendingDiffs.forEach(l=>{this.state=fu.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=fu.syncDiff(this.state,r,i,o),a())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const i=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(i,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(x=>x.presence_ref),p=h.map(x=>x.presence_ref),w=d.filter(x=>p.indexOf(x.presence_ref)<0),y=h.filter(x=>f.indexOf(x.presence_ref)<0);w.length>0&&(a[u]=w),y.length>0&&(l[u]=y)}else a[u]=d}),this.syncDiff(i,{joins:a,leaves:l},s,r)}static syncDiff(e,n,s,r){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(a,l)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),d.length>0){const h=e[a].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...f)}s(a,d,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[a]=u,r(a,u,l),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var nk;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(nk||(nk={}));var pu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(pu||(pu={}));var Yr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Yr||(Yr={}));class xl{constructor(e,n={config:{}},s){var r,i;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=on.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Gm(this,or.join,this.params,this.timeout),this.rejoinTimer=new uN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=on.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=on.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=on.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=on.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=on.errored,this.rejoinTimer.scheduleTimeout())}),this._on(or.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new fu(this),this.broadcastEndpointURL=hN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==on.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,u=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&r!==void 0?r:[],d=!!this.bindings[pu.PRESENCE]&&this.bindings[pu.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Yr.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Yr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(Yr.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,x=(w=y==null?void 0:y.length)!==null&&w!==void 0?w:0,g=[];for(let m=0;m<x;m++){const b=y[m],{filter:{event:k,schema:_,table:C,filter:S}}=b,j=p&&p[m];if(j&&j.event===k&&xl.isFilterValueEqual(j.schema,_)&&xl.isFilterValueEqual(j.table,C)&&xl.isFilterValueEqual(j.filter,S))g.push(Object.assign(Object.assign({},b),{id:j.id}));else{this.unsubscribe(),this.state=on.errored,e==null||e(Yr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Yr.SUBSCRIBED);return}}).receive("error",p=>{this.state=on.errored,e==null||e(Yr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Yr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===on.joined&&e===pu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var r;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const u=await a.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=on.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(or.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new Gm(this,or.leave,{},e),s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=on.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(i),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Gm(this,e,n,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>tD){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:d}=or;if(s&&[a,l,u,d].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,n,s);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var w,y,x;return((w=p.filter)===null||w===void 0?void 0:w.event)==="*"||((x=(y=p.filter)===null||y===void 0?void 0:y.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(p=>p.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var w,y,x,g,m,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const k=p.id,_=(w=p.filter)===null||w===void 0?void 0:w.event;return k&&((y=n.ids)===null||y===void 0?void 0:y.includes(k))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((x=n.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const k=(m=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return k==="*"||k===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const w=f.data,{schema:y,table:x,commit_timestamp:g,type:m,errors:b}=w;f=Object.assign(Object.assign({},{schema:y,table:x,commit_timestamp:g,eventType:m,new:{},old:{},errors:b}),this._getPayloadRecords(w))}p.callback(f,s)})}_isClosed(){return this.state===on.closed}_isJoined(){return this.state===on.joined}_isJoining(){return this.state===on.joining}_isLeaving(){return this.state===on.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),i={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&xl.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(or.close,{},e)}_onError(e){this._on(or.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=on.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=ek(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=ek(e.columns,e.old_record)),n}}const Ym=()=>{},wh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},cD=[1e3,2e3,5e3,1e4],uD=1e4,dD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class hD{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=oy,this.transport=null,this.heartbeatIntervalMs=wh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ym,this.ref=0,this.reconnectTimer=null,this.vsn=Zw,this.logger=Ym,this.conn=null,this.sendBuffer=[],this.serializer=new nD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((s=n==null?void 0:n.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${ay.websocket}`,this.httpEndpoint=hN(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=QI.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ti.connecting:return Wo.Connecting;case Ti.open:return Wo.Open;case Ti.closing:return Wo.Closing;default:return Wo.Closed}}isConnected(){return this.connectionState()===Wo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new xl(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(eD,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},wh.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:i,ref:o}=n,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${r} ${a}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(r,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ti.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ti.open||this.conn.readyState===Ti.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(or.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([dD],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,s=!1;if(e)n=e,s=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),n=this.accessTokenValue}else n=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:JI};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(or.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new uN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},wh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,r,i,o,a,l,u,d,h,f,p;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:oy,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:wh.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Ym,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:Zw,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:w=>cD[w-1]||uD,this.vsn){case cN:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(w,y)=>y(JSON.stringify(w)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(w,y)=>y(JSON.parse(w));break;case ZI:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Bu=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function fD(t,e,n){const s=new URL(e,t);if(n)for(const[r,i]of Object.entries(n))i!==void 0&&s.searchParams.set(r,i);return s.toString()}async function pD(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function mD(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:s,query:r,body:i,headers:o}){const a=fD(t.baseUrl,s,r),l=await pD(t.auth),u=await e(a,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const p=h?f:void 0,w=p==null?void 0:p.error;throw new Bu((w==null?void 0:w.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function kh(t){return t.join("")}var gD=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:kh(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${kh(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${kh(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${kh(t.namespace)}`}),!0}catch(e){if(e instanceof Bu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Bu&&n.status===409)return;throw n}}};function Ha(t){return t.join("")}var xD=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ha(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ha(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ha(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ha(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ha(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ha(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Bu&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Bu&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},yD=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=mD({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new gD(this.client,e),this.tableOps=new xD(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Vp=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function $t(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var vD=class extends Vp{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},cy=class extends Vp{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const e0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),bD=()=>Response,uy=t=>{if(Array.isArray(t))return t.map(n=>uy(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=uy(s)}),e},wD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},kD=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Uu(t){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uu(t)}function _D(t,e){if(Uu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Uu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SD(t){var e=_D(t,"string");return Uu(e)=="symbol"?e:e+""}function jD(t,e,n){return(e=SD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Be(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sk(Object(n),!0).forEach(function(s){jD(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sk(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const Qm=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},CD=async(t,e,n)=>{t instanceof await bD()&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const r=t.status||500,i=(s==null?void 0:s.statusCode)||r+"";e(new vD(Qm(s),r,i))}).catch(s=>{e(new cy(Qm(s),s))}):e(new cy(Qm(t),t))},ND=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?r:(wD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),Be(Be({},r),n))};async function Pd(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,ND(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>CD(l,a,s))})}async function Hu(t,e,n,s){return Pd(t,"GET",e,n,s)}async function nr(t,e,n,s,r){return Pd(t,"POST",e,s,r,n)}async function dy(t,e,n,s,r){return Pd(t,"PUT",e,s,r,n)}async function ED(t,e,n,s){return Pd(t,"HEAD",e,Be(Be({},n),{},{noResolveJson:!0}),s)}async function t0(t,e,n,s,r){return Pd(t,"DELETE",e,s,r,n)}var TD=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if($t(e))return{data:null,error:e};throw e}}};let fN;fN=Symbol.toStringTag;var PD=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[fN]="BlobDownloadBuilder",this.promise=null}asStream(){return new TD(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if($t(e))return{data:null,error:e};throw e}}};const RD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var AD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=e0(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,s){var r=this;try{let i;const o=Be(Be({},rk),s);let a=Be(Be({},r.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",r.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",r.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=r.toBase64(r.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(a=Be(Be({},a),s.headers));const u=r._removeEmptyFolders(e),d=r._getFinalPath(u),h=await(t=="PUT"?dy:nr)(r.fetch,`${r.url}/object/${d}`,i,Be({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(r.shouldThrowOnError)throw i;if($t(i))return{data:null,error:i};throw i}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,s){var r=this;const i=r._removeEmptyFolders(t),o=r._getFinalPath(i),a=new URL(r.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l;const u=Be({upsert:rk.upsert},s),d=Be(Be({},r.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await dy(r.fetch,a.toString(),l,{headers:d})).Key},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if($t(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var n=this;try{let s=n._getFinalPath(t);const r=Be({},n.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const i=await nr(n.fetch,`${n.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(n.url+i.url),a=o.searchParams.get("token");if(!a)throw new Vp("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var s=this;try{return{data:await nr(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers}),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async copy(t,e,n){var s=this;try{return{data:{path:(await nr(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers})).Key},error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async createSignedUrl(t,e,n){var s=this;try{let r=s._getFinalPath(t),i=await nr(s.fetch,`${s.url}/object/sign/${r}`,Be({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:s.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async createSignedUrls(t,e,n){var s=this;try{const r=await nr(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:r.map(o=>Be(Be({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),r=s?`?${s}`:"",i=this._getFinalPath(t),o=()=>Hu(this.fetch,`${this.url}/${n}/${i}${r}`,{headers:this.headers,noResolveJson:!0});return new PD(o,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:uy(await Hu(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await ED(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if($t(s)&&s instanceof cy){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&s.push(o);let a=s.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${a}`)}}}async remove(t){var e=this;try{return{data:await t0(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async list(t,e,n){var s=this;try{const r=Be(Be(Be({},RD),e),{},{prefix:t||""});return{data:await nr(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},n),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async listV2(t,e){var n=this;try{const s=Be({},t);return{data:await nr(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,s,{headers:n.headers},e),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const pN="2.88.0",mN={"X-Client-Info":`storage-js/${pN}`};var OD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1;const r=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Be(Be({},mN),e),this.fetch=e0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await Hu(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await Hu(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await nr(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var n=this;try{return{data:await dy(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await nr(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await t0(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},MD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},mN),e),this.fetch=e0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await nr(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const s=n.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Hu(e.fetch,r,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await t0(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!kD(t))throw new Vp("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new yD({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(n,{get(r,i){const o=r[i];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(r,a),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const n0={"X-Client-Info":`storage-js/${pN}`,"Content-Type":"application/json"};var gN=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function bs(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Xm=class extends gN{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ID=class extends gN{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const s0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),DD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},ik=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),LD=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const s=t.status||500,r=t;if(typeof r.json=="function")r.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new Xm(ik(i),s,o))}).catch(()=>{const i=s+"";e(new Xm(r.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new Xm(r.statusText||`HTTP ${s} error`,s,i))}}else e(new ID(ik(t),t))},$D=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(DD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,Be(Be({},r),n)):r};async function FD(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,$D(e,s,r,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>LD(l,a,s))})}async function ws(t,e,n,s,r){return FD(t,"POST",e,s,r,n)}var zD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},n0),e),this.fetch=s0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await ws(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bs(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await ws(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bs(s))return{data:null,error:s};throw s}}},BD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},n0),e),this.fetch=s0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ws(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await ws(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ws(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}},UD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},n0),e),this.fetch=s0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await ws(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}},HD=class extends UD{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new WD(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},WD=class extends zD{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new VD(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},VD=class extends BD{constructor(t,e,n,s,r){super(t,e,r),this.vectorBucketName=n,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},qD=class extends OD{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new AD(this.url,this.headers,t,this.fetch)}get vectors(){return new HD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new MD(this.url+"/iceberg",this.headers,this.fetch)}};const xN="2.88.0",sl=30*1e3,hy=3,Jm=hy*sl,KD="http://localhost:9999",GD="supabase.auth.token",YD={"X-Client-Info":`gotrue-js/${xN}`},fy="X-Supabase-Api-Version",yN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},QD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,XD=10*60*1e3;class Wu extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Me(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class JD extends Wu{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function ZD(t){return Me(t)&&t.name==="AuthApiError"}class Vo extends Wu{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class yi extends Wu{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class ms extends yi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function eL(t){return Me(t)&&t.name==="AuthSessionMissingError"}class Wa extends yi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _h extends yi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Sh extends yi{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function tL(t){return Me(t)&&t.name==="AuthImplicitGrantRedirectError"}class ok extends yi{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class nL extends yi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class py extends yi{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Zm(t){return Me(t)&&t.name==="AuthRetryableFetchError"}class ak extends yi{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class my extends yi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const rp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lk=` 	
\r=`.split(""),sL=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<lk.length;e+=1)t[lk[e].charCodeAt(0)]=-2;for(let e=0;e<rp.length;e+=1)t[rp[e].charCodeAt(0)]=e;return t})();function ck(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(rp[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(rp[s]),e.queuedBits-=6}}function vN(t,e,n){const s=sL[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function uk(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=o=>{oL(o,s,n)};for(let o=0;o<t.length;o+=1)vN(t.charCodeAt(o),r,i);return e.join("")}function rL(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function iL(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}rL(s,e)}}function oL(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function El(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)vN(t.charCodeAt(r),n,s);return new Uint8Array(e)}function aL(t){const e=[];return iL(t,n=>e.push(n)),new Uint8Array(e)}function Qo(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>ck(r,n,s)),ck(null,n,s),e.join("")}function lL(t){return Math.round(Date.now()/1e3)+t}function cL(){return Symbol("auth-callback")}const xn=()=>typeof window<"u"&&typeof document<"u",Mo={tested:!1,writable:!1},bN=()=>{if(!xn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Mo.tested)return Mo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Mo.tested=!0,Mo.writable=!0}catch{Mo.tested=!0,Mo.writable=!1}return Mo.writable};function uL(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const wN=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),dL=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",rl=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Io=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},gn=async(t,e)=>{await t.removeItem(e)};class qp{constructor(){this.promise=new qp.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}qp.promiseConstructor=Promise;function eg(t){const e=t.split(".");if(e.length!==3)throw new my("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!QD.test(e[s]))throw new my("JWT not in base64url format");return{header:JSON.parse(uk(e[0])),payload:JSON.parse(uk(e[1])),signature:El(e[2]),raw:{header:e[0],payload:e[1]}}}async function hL(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function fL(t,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function pL(t){return("0"+t.toString(16)).substr(-2)}function mL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let i=0;i<56;i++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,pL).join("")}async function gL(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function xL(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await gL(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Va(t,e,n=!1){const s=mL();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await rl(t,`${e}-code-verifier`,r);const i=await xL(s);return[i,s===i?"plain":"s256"]}const yL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function vL(t){const e=t.headers.get(fy);if(!e||!e.match(yL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function bL(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function wL(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const kL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qa(t){if(!kL.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function tg(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function _L(t,e){return new Proxy(t,{get:(n,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,r)}})}function dk(t){return JSON.parse(JSON.stringify(t))}const Bo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),SL=[502,503,504];async function hk(t){var e;if(!dL(t))throw new py(Bo(t),0);if(SL.includes(t.status))throw new py(Bo(t),t.status);let n;try{n=await t.json()}catch(i){throw new Vo(Bo(i),i)}let s;const r=vL(t);if(r&&r.getTime()>=yN["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new ak(Bo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new ms}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new ak(Bo(n),t.status,n.weak_password.reasons);throw new JD(Bo(n),t.status||500,s)}const jL=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function ze(t,e,n,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[fy]||(i[fy]=yN["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await CL(t,e,n+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function CL(t,e,n,s,r,i){const o=jL(e,s,r,i);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new py(Bo(l),0)}if(a.ok||await hk(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await hk(l)}}function er(t){var e;let n=null;TL(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=lL(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function fk(t){const e=er(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ai(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function NL(t){return{data:t,error:null}}function EL(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i}=t,o=hc(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function pk(t){return t}function TL(t){return t.access_token&&t.refresh_token&&t.expires_in}const ng=["global","local","others"];class PL{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=wN(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=ng[0]){if(ng.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ng.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Me(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ai})}catch(s){if(Me(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=hc(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:EL,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Me(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ai})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:pk});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(w=>{const y=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(w.split(";")[1].split("=")[1]);u[`${x}Page`]=y}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Me(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){qa(e);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ai})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){qa(e);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ai})}catch(s){if(Me(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){qa(e);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ai})}catch(s){if(Me(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){qa(e.userId);try{const{data:n,error:s}=await ze(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _deleteFactor(e){qa(e.userId),qa(e.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:pk});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(w=>{const y=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(w.split(";")[1].split("=")[1]);u[`${x}Page`]=y}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Me(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Me(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}}function mk(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Ka={debug:!!(globalThis&&bN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class kN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class RL extends kN{}async function AL(t,e,n){Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw Ka.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new RL(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ka.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function OL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function _N(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function ML(t){return parseInt(t,16)}function IL(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function DL(t){var e;const{chainId:n,domain:s,expirationTime:r,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=_N(t.address),w=d?`${d}://${s}`:s,y=t.statement?`${t.statement}
`:"",x=`${w} wants you to sign in with your Ethereum account:
${p}

${y}`;let g=`URI: ${h}
Version: ${f}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(r&&(g+=`
Expiration Time: ${r.toISOString()}`),a&&(g+=`
Not Before: ${a.toISOString()}`),l&&(g+=`
Request ID: ${l}`),u){let m=`
Resources:`;for(const b of u){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);m+=`
- ${b}`}g+=m}return`${x}
${g}`}class en extends Error{constructor({message:e,code:n,cause:s,name:r}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=r??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class ip extends en{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function LL({error:t,options:e}){var n,s,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new en({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new en({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new en({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new en({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new en({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new en({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new en({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new en({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(SN(o)){if(i.rp.id!==o)return new en({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new en({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new en({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new en({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new en({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function $L({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new en({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new en({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(SN(s)){if(n.rpId!==s)return new en({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new en({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new en({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new en({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class FL{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const zL=new FL;function BL(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,r=hc(t,["challenge","user","excludeCredentials"]),i=El(e).buffer,o=Object.assign(Object.assign({},n),{id:El(n.id).buffer}),a=Object.assign(Object.assign({},r),{challenge:i,user:o});if(s&&s.length>0){a.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const u=s[l];a.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:El(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function UL(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=hc(t,["challenge","allowCredentials"]),r=El(e).buffer,i=Object.assign(Object.assign({},s),{challenge:r});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const a=n[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:El(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function HL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Qo(new Uint8Array(t.response.attestationObject)),clientDataJSON:Qo(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function WL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Qo(new Uint8Array(r.authenticatorData)),clientDataJSON:Qo(new Uint8Array(r.clientDataJSON)),signature:Qo(new Uint8Array(r.signature)),userHandle:r.userHandle?Qo(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function SN(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function gk(){var t,e;return!!(xn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function VL(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ip("Browser returned unexpected credential type",e)}:{data:null,error:new ip("Empty credential response",e)}}catch(e){return{data:null,error:LL({error:e,options:t})}}}async function qL(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ip("Browser returned unexpected credential type",e)}:{data:null,error:new ip("Empty credential response",e)}}catch(e){return{data:null,error:$L({error:e,options:t})}}}const KL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},GL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function op(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const i in r){const o=r[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(n(o))s[i]=o;else if(e(o)){const a=s[i];e(a)?s[i]=op(a,o):s[i]=op(o)}else s[i]=o}return s}function YL(t,e){return op(KL,t,e||{})}function QL(t,e){return op(GL,t,e||{})}class XL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:r},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!o)return{data:null,error:a};const l=r??zL.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=YL(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:h}=await VL({publicKey:u,signal:l});return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=QL(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:h}=await qL(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(o){return Me(o)?{data:null,error:o}:{data:null,error:new Vo("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Wu("rpId is required for WebAuthn authentication")};try{if(!gk())return{data:null,error:new Vo("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:r},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:s,credential_response:l.credential_response}})}catch(o){return Me(o)?{data:null,error:o}:{data:null,error:new Vo("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Wu("rpId is required for WebAuthn registration")};try{if(!gk())return{data:null,error:new Vo("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:a};const{data:l,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:r},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Me(o)?{data:null,error:o}:{data:null,error:new Vo("Unexpected error in register",o)}}}}OL();const JL={url:KD,storageKey:GD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:YD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function xk(t,e,n){return await n()}const Ga={};class Vu{get jwks(){var e,n;return(n=(e=Ga[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Ga[this.storageKey]=Object.assign(Object.assign({},Ga[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Ga[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ga[this.storageKey]=Object.assign(Object.assign({},Ga[this.storageKey]),{cachedAt:e})}constructor(e){var n,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},JL),e);if(this.storageKey=i.storageKey,this.instanceID=(n=Vu.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Vu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&xn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new PL({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=wN(i.fetch),this.lock=i.lock||xk,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&xn()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=AL:this.lock=xk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new XL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:bN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=mk(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=mk(this.memoryStorage)),xn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${xN}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(xn()&&(n=uL(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),xn()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(n,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),tL(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Me(n)?this._returnResult({error:n}):this._returnResult({error:new Vo("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:er}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(Me(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,s,r;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,w=null;this.flowType==="pkce"&&([p,w]=await Va(this.storage,this.storageKey)),i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:w},xform:er})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:er})}else throw new _h("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return await gn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(await gn(this.storage,`${this.storageKey}-code-verifier`),Me(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:fk})}else if("phone"in e){const{phone:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:fk})}else throw new _h("You must provide either an email or phone number and a password");const{data:s,error:r}=n;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const i=new Wa;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,r,i,o,a,l,u,d,h,f;let p,w;if("message"in e)p=e.message,w=e.signature;else{const{chain:y,wallet:x,statement:g,options:m}=e;let b;if(xn())if(typeof x=="object")b=x;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")b=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const k=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href),_=await b.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=_N(_[0]);let S=(s=m==null?void 0:m.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!S){const N=await b.request({method:"eth_chainId"});S=ML(N)}const j={domain:k.host,address:C,statement:g,uri:k.href,version:"1",chainId:S,nonce:(r=m==null?void 0:m.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(i=m==null?void 0:m.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=m==null?void 0:m.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=m==null?void 0:m.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=m==null?void 0:m.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=m==null?void 0:m.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=DL(j),w=await b.request({method:"personal_sign",params:[IL(p),C]})}try{const{data:y,error:x}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:w},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:er});if(x)throw x;if(!y||!y.session||!y.user){const g=new Wa;return this._returnResult({data:{user:null,session:null},error:g})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:x})}catch(y){if(Me(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async signInWithSolana(e){var n,s,r,i,o,a,l,u,d,h,f,p;let w,y;if("message"in e)w=e.message,y=e.signature;else{const{chain:x,wallet:g,statement:m,options:b}=e;let k;if(xn())if(typeof g=="object")k=g;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))k=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const _=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in k&&k.signIn){const C=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),m?{statement:m}:null));let S;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")S=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)S=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)w=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),y=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${_.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(r=(s=b==null?void 0:b.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((u=b==null?void 0:b.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(d=b==null?void 0:b.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const C=await k.signMessage(new TextEncoder().encode(w),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=C}}try{const{data:x,error:g}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Qo(y)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:er});if(g)throw g;if(!x||!x.session||!x.user){const m=new Wa;return this._returnResult({data:{user:null,session:null},error:m})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:g})}catch(x){if(Me(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const n=await Io(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{if(!s&&this.flowType==="pkce")throw new nL;const{data:i,error:o}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:er});if(await gn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new Wa;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}catch(i){if(await gn(this.storage,`${this.storageKey}-code-verifier`),Me(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:i,nonce:o}=e,a=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:er}),{data:l,error:u}=a;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Wa;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,r,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Va(this.storage,this.storageKey));const{error:h}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:d}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new _h("You must provide either an email or phone number.")}catch(a){if(await gn(this.storage,`${this.storageKey}-code-verifier`),Me(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,s;try{let r,i;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:er});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(r){if(Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var n,s,r,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await Va(this.storage,this.storageKey));const u=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:NL});return!((i=u.data)===null||i===void 0)&&i.url&&xn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(a){if(await gn(this.storage,`${this.storageKey}-code-verifier`),Me(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new ms;const{error:r}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(Me(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:a}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new _h("You must provide either an email or phone number and a type")}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Io(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Jm:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Io(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=tg()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=_L(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ai}):await this._useSession(async n=>{var s,r,i;const{data:o,error:a}=n;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ms}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:Ai})})}catch(n){if(Me(n))return eL(n)&&(await this._removeSession(),await gn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new ms;const o=r.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Va(this.storage,this.storageKey));const{data:u,error:d}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ai});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await gn(this.storage,`${this.storageKey}-code-verifier`),Me(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ms;const n=Date.now()/1e3;let s=n,r=!0,i=null;const{payload:o}=eg(e.access_token);if(o.exp&&(s=o.exp,r=s<=n),r){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(Me(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new ms;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!xn())throw new Sh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Sh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new ok("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Sh("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ok("No code detected.");const{data:m,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new Sh("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(a);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=sl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const w=f-h;d-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,f,d):d-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,f,d);const{data:y,error:x}=await this._getUser(i);if(x)throw x;const g={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(s){if(Me(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Io(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({error:i});const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(ZD(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await gn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=cL(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:i},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Va(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await gn(this.storage,`${this.storageKey}-code-verifier`),Me(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:r}=await this._useSession(async i=>{var o,a,l,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(r)throw r;return xn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Me(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:r,data:{session:i}}=n;if(r)throw r;const{options:o,provider:a,token:l,access_token:u,nonce:d}=e,h=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:a,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:er}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Wa}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(r){if(await gn(this.storage,`${this.storageKey}-code-verifier`),Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)throw o;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await fL(async r=>(r>0&&await hL(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:er})),(r,i)=>{const o=200*Math.pow(2,r);return i&&Zm(i)&&Date.now()+o-s<sl})}catch(s){if(this._debug(n,"error",s),Me(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),xn()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Io(this.storage,this.storageKey);if(r&&this.userStorage){let o=await Io(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await rl(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:tg()}else if(r&&!r.user&&!r.user){const o=await Io(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(r.user=o.user,await gn(this.storage,this.storageKey+"-user"),await rl(this.storage,this.storageKey,r)):r.user=tg()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const i=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Jm;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Jm}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),Zm(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(r.access_token);!a&&(o!=null&&o.user)?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new ms;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new qp;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new ms;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(r,"error",i),Me(i)){const o={data:null,error:i};return Zm(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await gn(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await rl(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const i=dk(r);await rl(this.storage,this.storageKey,i)}else{const r=dk(n);await rl(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await gn(this.storage,this.storageKey),await gn(this.storage,this.storageKey+"-code-verifier"),await gn(this.storage,this.storageKey+"-user"),this.userStorage&&await gn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),sl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/sl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${sl}ms, refresh threshold is ${hy} ticks`),r<=hy&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof kN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Va(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(a.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;return i?this._returnResult({data:null,error:i}):await ze(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&l.type==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?HL(e.webauthn.credential_response):WL(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:BL(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:UL(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=eg(s.access_token);let o=null;i.aal&&(o=i.aal);let a=o;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(a="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ms})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new ms});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&xn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Me(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new ms});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&xn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Me(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;return s?this._returnResult({data:null,error:s}):n?await ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new ms})})}catch(e){if(Me(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?(await ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ms})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(a=>a.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+XD>r)return s;const{data:i,error:o}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:p,error:w}=await this.getSession();if(w||!p.session)return this._returnResult({data:null,error:w});s=p.session.access_token}const{header:r,payload:i,signature:o,raw:{header:a,payload:l}}=eg(s);n!=null&&n.allowExpired||bL(i.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:r,signature:o},error:null}}const d=wL(r.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,aL(`${a}.${l}`)))throw new my("Invalid JWT signature");return{data:{claims:i,header:r,signature:o},error:null}}catch(s){if(Me(s))return this._returnResult({data:null,error:s});throw s}}}Vu.nextInstanceID={};const ZL=Vu,e5="2.88.0";let Xc="";typeof Deno<"u"?Xc="deno":typeof document<"u"?Xc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xc="react-native":Xc="node";const t5={"X-Client-Info":`supabase-js-${Xc}/${e5}`},n5={headers:t5},s5={schema:"public"},r5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},i5={};function qu(t){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qu(t)}function o5(t,e){if(qu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(qu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a5(t){var e=o5(t,"string");return qu(e)=="symbol"?e:e+""}function l5(t,e,n){return(e=a5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Wt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yk(Object(n),!0).forEach(function(s){l5(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yk(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const c5=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),u5=()=>Headers,d5=(t,e,n)=>{const s=c5(n),r=u5();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:t;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(i,Wt(Wt({},o),{},{headers:u}))}};function h5(t){return t.endsWith("/")?t:t+"/"}function f5(t,e){var n,s;const{db:r,auth:i,realtime:o,global:a}=t,{db:l,auth:u,realtime:d,global:h}=e,f={db:Wt(Wt({},l),r),auth:Wt(Wt({},u),i),realtime:Wt(Wt({},d),o),storage:{},global:Wt(Wt(Wt({},h),a),{},{headers:Wt(Wt({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(s=a==null?void 0:a.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function p5(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(h5(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var m5=class extends ZL{constructor(t){super(t)}},g5=class{constructor(t,e,n){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const i=p5(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a={db:s5,realtime:i5,auth:Wt(Wt({},r5),{},{storageKey:o}),global:n5},l=f5(n??{},a);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=l.global.headers)!==null&&r!==void 0?r:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=d5(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Wt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new YI(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new qD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new WI(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new m5({url:this.authUrl.href,headers:Wt(Wt({},f),d),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,flowType:o,lock:a,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new hD(this.realtimeUrl.href,Wt(Wt({},t),{},{params:Wt(Wt({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const x5=(t,e,n)=>new g5(t,e,n);function y5(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}y5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Pa={SUPABASE_URL:window.SUPABASE_URL||void 0||"",SUPABASE_ANON_KEY:window.SUPABASE_ANON_KEY||void 0||"",API_BASE_URL:window.API_BASE_URL||void 0||""};let jh=null;function r0(){if(jh)return jh;const{SUPABASE_URL:t,SUPABASE_ANON_KEY:e}=Pa;return!t||!e?null:(jh=x5(t,e),jh)}const i0="authToken";function fc(){return localStorage.getItem(i0)}function yl(t){t&&localStorage.setItem(i0,t)}function ai(){localStorage.removeItem(i0)}const Ku=3e4;let sg=!1,Ch=null;function jN(t=Ku){const e=new AbortController,n=setTimeout(()=>e.abort(),t);return{controller:e,clear:()=>clearTimeout(n)}}async function CN(){var r;const t=fc();if(t)return t;const e=r0();if(!e)return null;const{data:n}=await e.auth.getSession(),s=((r=n==null?void 0:n.session)==null?void 0:r.access_token)||null;return s&&yl(s),s}async function NN(){return sg||(sg=!0,Ch=(async()=>{var t;try{const e=r0();if(!e)return null;const{data:n,error:s}=await e.auth.refreshSession();return s||!((t=n.session)!=null&&t.access_token)?null:(yl(n.session.access_token),n.session.access_token)}catch(e){return console.error("Token refresh failed:",e),null}finally{sg=!1,Ch=null}})()),Ch}async function De(t,e={}){const{baseUrl:n,timeout:s,...r}=e,i=`${n??Pa.API_BASE_URL}${t}`,o=new Headers(r.headers||{});!(r.body instanceof FormData)&&!o.has("Content-Type")&&o.set("Content-Type","application/json");const l=await CN();l&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${l}`);const u=s!==0&&s!==!1,{controller:d,clear:h}=u?jN(s||Ku):{controller:null,clear:()=>{}};try{let f=await fetch(i,{...r,headers:o,signal:d==null?void 0:d.signal});if(f.status===401){const w=await NN();if(w){if(o.set("Authorization",`Bearer ${w}`),f=await fetch(i,{...r,headers:o,signal:d==null?void 0:d.signal}),!(f.ok||f.status!==401))return ai(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return ai(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!f.ok){const w=await f.json().catch(()=>({detail:"Request failed"})),y=new Error(w.detail||w.error||`Request failed: ${f.status}`);throw y.status=f.status,y.data=w,y}return f.status===204?null:(f.headers.get("content-type")||"").includes("application/json")?f.json():f}catch(f){if(f.name==="AbortError"){const p=new Error(`Request timed out after ${s||Ku}ms`);throw p.status=408,p.isTimeout=!0,p}throw f}finally{h()}}async function EN(t,e={}){const{baseUrl:n,timeout:s,...r}=e,i=`${n??Pa.API_BASE_URL}${t}`,o=new Headers(r.headers||{}),a=await CN();a&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${a}`);const l=s!==0&&s!==!1,{controller:u,clear:d}=l?jN(s||Ku):{controller:null,clear:()=>{}};try{let h=await fetch(i,{...r,headers:o,signal:u==null?void 0:u.signal});if(h.status===401){const f=await NN();if(f){if(o.set("Authorization",`Bearer ${f}`),h=await fetch(i,{...r,headers:o,signal:u==null?void 0:u.signal}),!(h.ok||h.status!==401))return ai(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return ai(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!h.ok){const f=await h.json().catch(()=>({detail:"Request failed"})),p=new Error(f.detail||f.error||`Request failed: ${h.status}`);throw p.status=h.status,p.data=f,p}return h.blob()}catch(h){if(h.name==="AbortError"){const f=new Error(`Request timed out after ${s||Ku}ms`);throw f.status=408,f.isTimeout=!0,f}throw h}finally{d()}}const TN=v.createContext(null),rg={system_admin:["admin","hos","sales_person"],sales_manager:["hos","sales_person"],sales_user:["sales_person"],coordinator:["coordinator"],finance:["finance"],viewer:["viewer"]},v5={"admin@mmg.com":{password:"admin123",id:"dev-admin-1",name:"Sales Admin",email:"admin@mmg.com",roles:["admin","hos","sales_person"]},"hos@mmg.com":{password:"hos123",id:"dev-hos-1",name:"Head of Sales",email:"hos@mmg.com",roles:["hos","sales_person"]},"sales@mmg.com":{password:"sales123",id:"dev-sales-1",name:"Sales Person",email:"sales@mmg.com",roles:["sales_person"]}};function ig(t){return Array.from(new Set((t||[]).filter(Boolean).map(e=>String(e).toLowerCase())))}function vk(t=[]){return t.map(e=>String(e||"").replaceAll(".",":"))}function b5(t){return(t||"sales_user").toLowerCase()}function bk(t,e){var n,s,r,i,o,a,l,u,d;return((n=t==null?void 0:t.user_metadata)==null?void 0:n.full_name)||((s=t==null?void 0:t.user_metadata)==null?void 0:s.name)||((o=(i=(r=t==null?void 0:t.identities)==null?void 0:r[0])==null?void 0:i.identity_data)==null?void 0:o.full_name)||((u=(l=(a=t==null?void 0:t.identities)==null?void 0:a[0])==null?void 0:l.identity_data)==null?void 0:u.name)||((d=t==null?void 0:t.email)==null?void 0:d.split("@")[0])||e||"User"}function vf(t,e){const n=(t==null?void 0:t.permissions)||[];if(!n.length)return!1;const s=u=>String(u||"").trim().replaceAll(".",":"),r=n.map(s),i=s(e);if(r.includes("*:*:*"))return!0;const[o,a,l]=i.split(":");return r.some(u=>{const[d,h,f]=u.split(":");return u===i?!0:(d==="*"||d===o)&&(h==="*"||h===a)&&(f==="*"||f===l||f==="manage")})}function Rd(t){var e,n,s;return((e=t==null?void 0:t.roles)==null?void 0:e.includes("admin"))||((s=(n=t==null?void 0:t.profile)==null?void 0:n.toLowerCase)==null?void 0:s.call(n))==="system_admin"||vf(t,"*:*:*")||vf(t,"core:*:*")||vf(t,"core:system:admin")}function w5({children:t}){const e=r0(),n=!e&&window.location.hostname==="localhost",[s,r]=v.useState(null),[i,o]=v.useState(()=>{const m=localStorage.getItem("mmg_user")||localStorage.getItem("userData");return m?JSON.parse(m):null}),[a,l]=v.useState(!1),[u,d]=v.useState(null);v.useEffect(()=>{const m=window.location.hash;if(!m||!m.includes("error="))return;const b=new URLSearchParams(m.substring(1)),k=b.get("error"),_=b.get("error_code"),C=b.get("error_description");if(k){let S=C?decodeURIComponent(C.replace(/\+/g," ")):"Authentication failed";_==="otp_expired"?S="Email link has expired. Please sign up again to receive a new confirmation email.":_==="access_denied"&&(S="Access denied. The link may have expired or already been used."),setTimeout(()=>alert(S),300),window.history.replaceState(null,"",window.location.pathname+window.location.search)}},[]),v.useEffect(()=>{let m=null;async function b(){console.log("[Auth] init() starting");try{if(!e){console.log("[Auth] No supabase client - dev mode");const C=localStorage.getItem("mmg_user")||localStorage.getItem("userData");C&&o(JSON.parse(C)),l(!0),console.log("[Auth] Dev mode ready");return}console.log("[Auth] Getting supabase session...");const{data:k}=await e.auth.getSession(),_=(k==null?void 0:k.session)||null;console.log("[Auth] Session retrieved",{hasSession:!!_,hasToken:!!(_!=null&&_.access_token)}),r(_||null),l(!0),console.log("[Auth] authReady set to true"),_||(console.log("[Auth] No session - clearing auth"),ai(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData")),_!=null&&_.access_token&&yl(_.access_token),_!=null&&_.access_token&&(console.log("[Auth] Starting background profile refresh"),h(_.access_token,_.user).catch(console.error)),m=e.auth.onAuthStateChange(async(C,S)=>{if(console.log("[Auth] onAuthStateChange",{event:C,hasSession:!!S}),C==="INITIAL_SESSION"){console.log("[Auth] Skipping INITIAL_SESSION (already handled)");return}r(S||null),S!=null&&S.access_token?(yl(S.access_token),u||(console.log("[Auth] Auth state change - refreshing profile"),h(S.access_token,S.user).catch(console.error))):(console.log("[Auth] Auth state change - no session, clearing"),ai(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"))}).data.subscription}catch(k){console.log("[Auth] init() error",k),l(!0)}}return b(),()=>{var k;return(k=m==null?void 0:m.unsubscribe)==null?void 0:k.call(m)}},[e,u]),v.useEffect(()=>{const m=()=>{d(null),x()};return window.addEventListener("auth:logout",m),()=>window.removeEventListener("auth:logout",m)},[]);async function h(m,b=null){var k,_,C,S;console.log("[Auth] refreshProfile() starting");try{console.log("[Auth] Fetching /api/base/auth/me...");const j=await De("/api/base/auth/me",{headers:{Authorization:`Bearer ${m}`}});if(console.log("[Auth] /api/base/auth/me response received",{hasProfile:!!j}),!j)return console.log("[Auth] No profile returned"),null;const N=b5((j==null?void 0:j.profile_name)||(j==null?void 0:j.profile)||(j==null?void 0:j.profileName)),P=rg[N]||["sales_person"],L=(j==null?void 0:j.roles)||(j==null?void 0:j.rbac_roles)||(j==null?void 0:j.user_roles)||[],I={id:(j==null?void 0:j.id)||(b==null?void 0:b.id),email:(j==null?void 0:j.email)||(b==null?void 0:b.email),name:(j==null?void 0:j.name)||bk(b,N),profile:N,profile_name:N,roles:ig([...P,...L]),permissions:vk((j==null?void 0:j.permissions)||[]),raw:j};return console.log("[Auth] Profile loaded, setting user",{email:I.email,roles:I.roles}),o(I),localStorage.setItem("mmg_user",JSON.stringify(I)),localStorage.setItem("userData",JSON.stringify(I)),d(null),I}catch(j){if(console.log("[Auth] refreshProfile error",j),(j==null?void 0:j.status)===403&&((k=j==null?void 0:j.data)!=null&&k.requiresLogout)){const N=(b==null?void 0:b.email)||(i==null?void 0:i.email)||"";return((_=j==null?void 0:j.data)==null?void 0:_.code)==="USER_PENDING_APPROVAL"?(d({pending:!0,email:N,message:((C=j==null?void 0:j.data)==null?void 0:C.error)||"Your account is pending administrator approval."}),null):(await x(),null)}if(b){console.log("[Auth] Using fallback session user data");const N=((S=b.user_metadata)==null?void 0:S.profile)||"sales_user",P=rg[N]||["sales_person"],L={id:b.id,email:b.email,name:bk(b,N),profile:N,profile_name:N,roles:ig(P),permissions:[],raw:b};return console.log("[Auth] Fallback user set",{email:L.email}),o(L),localStorage.setItem("mmg_user",JSON.stringify(L)),localStorage.setItem("userData",JSON.stringify(L)),d(null),L}return console.log("[Auth] No fallback available, returning null"),null}}async function f(){return s!=null&&s.access_token?s.access_token:localStorage.getItem("authToken")}async function p({email:m,password:b}){var C;if(d(null),!e){if(!n)throw new Error("Supabase not configured");const S=v5[m.toLowerCase()];if(!S||S.password!==b)throw new Error("Invalid email or password");const j=S.profile||((C=S.roles)!=null&&C.includes("admin")?"system_admin":"sales_user"),N=ig(S.roles||rg[j]||["sales_person"]),P={id:S.id,email:S.email,name:S.name,profile:j,profile_name:j,roles:N,permissions:vk(S.permissions||[]),raw:S},L=`dev-token-${Date.now()}`;return yl(L),o(P),localStorage.setItem("mmg_user",JSON.stringify(P)),localStorage.setItem("userData",JSON.stringify(P)),P}const{data:k,error:_}=await e.auth.signInWithPassword({email:m,password:b});if(_)throw _;return yl(k.session.access_token),await h(k.session.access_token,k.session.user),k}async function w(){if(!e)throw new Error("Supabase not configured. Please contact your administrator.");const m=k5(),{data:b,error:k}=await e.auth.signInWithOAuth({provider:"azure",options:{scopes:"email profile openid",redirectTo:m}});if(k)throw k;return b}async function y({token:m,email:b,password:k,fullName:_}){var N;if(!e)throw new Error("Supabase not configured");const C=await De("/api/base/auth/validate-invite",{method:"POST",body:JSON.stringify({token:m,email:b})}),{data:S,error:j}=await e.auth.signUp({email:b,password:k,options:{data:{full_name:_,profile:(C==null?void 0:C.profile_name)||"sales_user"}}});if(j)throw j;return await De("/api/base/auth/consume-invite",{method:"POST",body:JSON.stringify({token:m,email:b,supabase_user_id:(N=S==null?void 0:S.user)==null?void 0:N.id,profile_name:C==null?void 0:C.profile_name,name:_})}),S}async function x(){try{e&&await e.auth.signOut()}finally{ai(),r(null),o(null),d(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"),sessionStorage.removeItem("msSsoPending")}}const g=v.useMemo(()=>({authReady:a,user:i,session:s,pendingAccess:u,getAccessToken:f,signInWithPassword:p,signInWithMicrosoft:w,signUpWithInvite:y,refreshProfile:h,logout:x}),[a,i,s,u]);return c.jsx(TN.Provider,{value:g,children:t})}function fi(){const t=v.useContext(TN);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function k5(){const t=`${window.location.protocol}//${window.location.host}`,e=window.SUPABASE_REDIRECT_URL||void 0||"";return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?`${t}/auth/callback`:`${(e||t).replace(/\/$/,"")}/auth/callback`}function _5(){const{signInWithMicrosoft:t}=fi(),e=Ed(),n=uc(),s=v.useMemo(()=>{var h;return((h=n.state)==null?void 0:h.from)||"/app/chat"},[n.state]),[r,i]=v.useState(""),[o,a]=v.useState(!1),{user:l,authReady:u}=fi();v.useEffect(()=>{u&&l&&e(s,{replace:!0})},[u,l,s,e]);async function d(){if(!o){i("");try{a(!0),sessionStorage.setItem("postAuthRedirect",s||"/app/chat"),await new Promise(h=>requestAnimationFrame(h)),await t()}catch(h){i((h==null?void 0:h.message)||"SSO failed"),a(!1)}}}return c.jsxs("div",{className:"relative min-h-screen px-4 py-8 flex items-center justify-center overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 mmg-login-bg"}),c.jsx("div",{className:"mmg-particle one"}),c.jsx("div",{className:"mmg-particle two"}),c.jsx("div",{className:"mmg-particle three"}),c.jsxs("div",{className:"relative z-10 w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center",children:[c.jsxs("div",{className:"flex flex-col items-center text-center gap-4 min-h-[260px] lg:min-h-[520px] lg:pr-12 lg:border-r lg:border-black/10 dark:lg:border-white/10",children:[c.jsxs("div",{className:"flex flex-col items-center gap-4 pt-6",children:[c.jsx("img",{src:"/MMG_Logo_Blk.png",alt:"MMG",className:"h-24 sm:h-36 lg:h-40 w-auto ml-4 dark:hidden"}),c.jsx("img",{src:"/MMG_Logo.png",alt:"MMG",className:"hidden h-24 sm:h-36 lg:h-40 w-auto ml-4 dark:block"}),c.jsx("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-semibold tracking-[0.32em] sm:tracking-[0.35em] text-[#ca9e2c]",children:"NOVA AI"})]}),c.jsxs("div",{className:"mt-auto pb-6 hidden lg:flex flex-nowrap items-center justify-center gap-4 text-black/40 dark:text-white/35",children:[c.jsx("img",{src:"/backlite.png",alt:"Backlite",className:"h-8 sm:h-9 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-6 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/viola.png",alt:"Viola",className:"h-8 sm:h-9 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-6 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/media.png",alt:"Media",className:"h-8 sm:h-9 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-6 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/purple.png",alt:"Purple",className:"h-8 sm:h-9 w-auto"})]})]}),c.jsx("div",{className:"w-full max-w-md justify-self-center lg:pl-12",children:c.jsxs("div",{className:"space-y-3 flex flex-col items-center sm:items-stretch",children:[r?c.jsx("div",{className:"text-sm text-red-700 rounded-2xl px-4 py-2 bg-black/5 dark:bg-white/10 w-full max-w-xs sm:max-w-none",children:r}):null,c.jsx(se,{variant:"secondary",size:"lg",className:"w-full max-w-xs sm:max-w-none justify-center gap-2",onClick:d,disabled:o,children:o?c.jsx(Ve,{text:"Signing you in"}):c.jsxs(c.Fragment,{children:[c.jsx($M,{size:18}),"Sign in with Microsoft"]})})]})}),c.jsxs("div",{className:"flex lg:hidden flex-nowrap items-center justify-center gap-2 text-black/40 dark:text-white/35",children:[c.jsx("img",{src:"/backlite.png",alt:"Backlite",className:"h-6 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-4 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/viola.png",alt:"Viola",className:"h-6 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-4 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/media.png",alt:"Media",className:"h-6 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-4 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/purple.png",alt:"Purple",className:"h-6 w-auto"})]})]})]})}function PN({email:t,message:e,onSignOut:n}){return c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsxs("div",{className:"w-full max-w-[520px] space-y-4 rounded-2xl bg-white/60 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 p-6 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:"Access Pending"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:e||"Your account is pending administrator approval."}),t?c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:["Signed in as ",c.jsx("strong",{children:t})]}):null,c.jsx("div",{className:"flex justify-center pt-2",children:c.jsx(se,{variant:"secondary",onClick:n,children:"Sign Out"})})]})})}function S5(){const t=Ed(),{authReady:e,session:n,user:s,pendingAccess:r,logout:i}=fi();return v.useEffect(()=>{if(e&&!n){t("/login",{replace:!0});return}if(e&&n&&s){const o=sessionStorage.getItem("postAuthRedirect")||"/app/chat";sessionStorage.removeItem("postAuthRedirect"),t(o,{replace:!0})}},[e,n,s,t]),e&&r?c.jsx(PN,{email:r.email,message:r.message,onSignOut:i}):c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ve,{text:"Loading"})})})}function j5({size:t=128}){return c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("img",{src:"/MMG_Logo_Blk.png",width:t,height:t,alt:"MMG",className:"shrink-0 dark:hidden"}),c.jsx("img",{src:"/MMG_Logo.png",width:t,height:t,alt:"MMG",className:"shrink-0 hidden dark:block"}),c.jsx("span",{className:"mmg-brand-gold font-semibold text-lg leading-none tracking-tight hidden sm:inline-flex",children:"Nova"})]})}function RN(){const{theme:t,setTheme:e}=JO(),n=t==="dark";return c.jsx(se,{variant:"ghost",size:"icon","aria-label":"Toggle theme",onClick:()=>e(n?"light":"dark"),title:"Toggle theme",className:"rounded-2xl",children:n?c.jsx(GM,{size:18}):c.jsx(HM,{size:18})})}function tt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Ad(t,e=[]){let n=[];function s(i,o){const a=v.createContext(o),l=n.length;n=[...n,o];const u=h=>{var g;const{scope:f,children:p,...w}=h,y=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,x=v.useMemo(()=>w,Object.values(w));return c.jsx(y.Provider,{value:x,children:p})};u.displayName=i+"Provider";function d(h,f){var y;const p=((y=f==null?void 0:f[t])==null?void 0:y[l])||a,w=v.useContext(p);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const r=()=>{const i=n.map(o=>v.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[s,C5(r,...e)]}function C5(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:u})=>{const h=l(i)[`__scope${u}`];return{...a,...h}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var fo=globalThis!=null&&globalThis.document?v.useLayoutEffect:()=>{},N5=Ep[" useInsertionEffect ".trim().toString()]||fo;function AN({prop:t,defaultProp:e,onChange:n=()=>{},caller:s}){const[r,i,o]=E5({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const d=v.useRef(t!==void 0);v.useEffect(()=>{const h=d.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=a},[a,s])}const u=v.useCallback(d=>{var h;if(a){const f=T5(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[a,t,i,o]);return[l,u]}function E5({defaultProp:t,onChange:e}){const[n,s]=v.useState(t),r=v.useRef(n),i=v.useRef(e);return N5(()=>{i.current=e},[e]),v.useEffect(()=>{var o;r.current!==n&&((o=i.current)==null||o.call(i,n),r.current=n)},[n,r]),[n,s,i]}function T5(t){return typeof t=="function"}function P5(t){const e=R5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(O5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function R5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=I5(r),a=M5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Ta(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var A5=Symbol("radix.slottable");function O5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===A5}function M5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function I5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var D5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wn=D5.reduce((t,e)=>{const n=P5(`Primitive.${e}`),s=v.forwardRef((r,i)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function ON(t,e){t&&jd.flushSync(()=>t.dispatchEvent(e))}function wk(t){const e=L5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(F5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function L5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=B5(r),a=z5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Ta(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var $5=Symbol("radix.slottable");function F5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===$5}function z5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function B5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function MN(t){const e=t+"CollectionProvider",[n,s]=Ad(e),[r,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=y=>{const{scope:x,children:g}=y,m=ve.useRef(null),b=ve.useRef(new Map).current;return c.jsx(r,{scope:x,itemMap:b,collectionRef:m,children:g})};o.displayName=e;const a=t+"CollectionSlot",l=wk(a),u=ve.forwardRef((y,x)=>{const{scope:g,children:m}=y,b=i(a,g),k=cs(x,b.collectionRef);return c.jsx(l,{ref:k,children:m})});u.displayName=a;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=wk(d),p=ve.forwardRef((y,x)=>{const{scope:g,children:m,...b}=y,k=ve.useRef(null),_=cs(x,k),C=i(d,g);return ve.useEffect(()=>(C.itemMap.set(k,{ref:k,...b}),()=>void C.itemMap.delete(k))),c.jsx(f,{[h]:"",ref:_,children:m})});p.displayName=d;function w(y){const x=i(t+"CollectionConsumer",y);return ve.useCallback(()=>{const m=x.collectionRef.current;if(!m)return[];const b=Array.from(m.querySelectorAll(`[${h}]`));return Array.from(x.itemMap.values()).sort((C,S)=>b.indexOf(C.ref.current)-b.indexOf(S.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:u,ItemSlot:p},w,s]}var U5=v.createContext(void 0);function IN(t){const e=v.useContext(U5);return t||e||"ltr"}function pi(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function H5(t,e=globalThis==null?void 0:globalThis.document){const n=pi(t);v.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var W5="DismissableLayer",gy="dismissableLayer.update",V5="dismissableLayer.pointerDownOutside",q5="dismissableLayer.focusOutside",kk,DN=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),LN=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,u=v.useContext(DN),[d,h]=v.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=v.useState({}),w=cs(e,S=>h(S)),y=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),g=y.indexOf(x),m=d?y.indexOf(d):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,k=m>=g,_=Y5(S=>{const j=S.target,N=[...u.branches].some(P=>P.contains(j));!k||N||(r==null||r(S),o==null||o(S),S.defaultPrevented||a==null||a())},f),C=Q5(S=>{const j=S.target;[...u.branches].some(P=>P.contains(j))||(i==null||i(S),o==null||o(S),S.defaultPrevented||a==null||a())},f);return H5(S=>{m===u.layers.size-1&&(s==null||s(S),!S.defaultPrevented&&a&&(S.preventDefault(),a()))},f),v.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(kk=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),_k(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=kk)}},[d,f,n,u]),v.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),_k())},[d,u]),v.useEffect(()=>{const S=()=>p({});return document.addEventListener(gy,S),()=>document.removeEventListener(gy,S)},[]),c.jsx(Wn.div,{...l,ref:w,style:{pointerEvents:b?k?"auto":"none":void 0,...t.style},onFocusCapture:tt(t.onFocusCapture,C.onFocusCapture),onBlurCapture:tt(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:tt(t.onPointerDownCapture,_.onPointerDownCapture)})});LN.displayName=W5;var K5="DismissableLayerBranch",G5=v.forwardRef((t,e)=>{const n=v.useContext(DN),s=v.useRef(null),r=cs(e,s);return v.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),c.jsx(Wn.div,{...t,ref:r})});G5.displayName=K5;function Y5(t,e=globalThis==null?void 0:globalThis.document){const n=pi(t),s=v.useRef(!1),r=v.useRef(()=>{});return v.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){$N(V5,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function Q5(t,e=globalThis==null?void 0:globalThis.document){const n=pi(t),s=v.useRef(!1);return v.useEffect(()=>{const r=i=>{i.target&&!s.current&&$N(q5,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function _k(){const t=new CustomEvent(gy);document.dispatchEvent(t)}function $N(t,e,n,{discrete:s}){const r=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?ON(r,i):r.dispatchEvent(i)}var og=0;function X5(){v.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Sk()),document.body.insertAdjacentElement("beforeend",t[1]??Sk()),og++,()=>{og===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),og--}},[])}function Sk(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var ag="focusScope.autoFocusOnMount",lg="focusScope.autoFocusOnUnmount",jk={bubbles:!1,cancelable:!0},J5="FocusScope",FN=v.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:i,...o}=t,[a,l]=v.useState(null),u=pi(r),d=pi(i),h=v.useRef(null),f=cs(e,y=>l(y)),p=v.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;v.useEffect(()=>{if(s){let y=function(b){if(p.paused||!a)return;const k=b.target;a.contains(k)?h.current=k:Ci(h.current,{select:!0})},x=function(b){if(p.paused||!a)return;const k=b.relatedTarget;k!==null&&(a.contains(k)||Ci(h.current,{select:!0}))},g=function(b){if(document.activeElement===document.body)for(const _ of b)_.removedNodes.length>0&&Ci(a)};document.addEventListener("focusin",y),document.addEventListener("focusout",x);const m=new MutationObserver(g);return a&&m.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",x),m.disconnect()}}},[s,a,p.paused]),v.useEffect(()=>{if(a){Nk.add(p);const y=document.activeElement;if(!a.contains(y)){const g=new CustomEvent(ag,jk);a.addEventListener(ag,u),a.dispatchEvent(g),g.defaultPrevented||(Z5(r$(zN(a)),{select:!0}),document.activeElement===y&&Ci(a))}return()=>{a.removeEventListener(ag,u),setTimeout(()=>{const g=new CustomEvent(lg,jk);a.addEventListener(lg,d),a.dispatchEvent(g),g.defaultPrevented||Ci(y??document.body,{select:!0}),a.removeEventListener(lg,d),Nk.remove(p)},0)}}},[a,u,d,p]);const w=v.useCallback(y=>{if(!n&&!s||p.paused)return;const x=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,g=document.activeElement;if(x&&g){const m=y.currentTarget,[b,k]=e$(m);b&&k?!y.shiftKey&&g===k?(y.preventDefault(),n&&Ci(b,{select:!0})):y.shiftKey&&g===b&&(y.preventDefault(),n&&Ci(k,{select:!0})):g===m&&y.preventDefault()}},[n,s,p.paused]);return c.jsx(Wn.div,{tabIndex:-1,...o,ref:f,onKeyDown:w})});FN.displayName=J5;function Z5(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(Ci(s,{select:e}),document.activeElement!==n)return}function e$(t){const e=zN(t),n=Ck(e,t),s=Ck(e.reverse(),t);return[n,s]}function zN(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Ck(t,e){for(const n of t)if(!t$(n,{upTo:e}))return n}function t$(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function n$(t){return t instanceof HTMLInputElement&&"select"in t}function Ci(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&n$(t)&&e&&t.select()}}var Nk=s$();function s$(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Ek(t,e),t.unshift(e)},remove(e){var n;t=Ek(t,e),(n=t[0])==null||n.resume()}}}function Ek(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function r$(t){return t.filter(e=>e.tagName!=="A")}var i$=Ep[" useId ".trim().toString()]||(()=>{}),o$=0;function xy(t){const[e,n]=v.useState(i$());return fo(()=>{n(s=>s??String(o$++))},[t]),e?`radix-${e}`:""}const a$=["top","right","bottom","left"],po=Math.min,vs=Math.max,ap=Math.round,Nh=Math.floor,$r=t=>({x:t,y:t}),l$={left:"right",right:"left",bottom:"top",top:"bottom"},c$={start:"end",end:"start"};function yy(t,e,n){return vs(t,po(e,n))}function mi(t,e){return typeof t=="function"?t(e):t}function gi(t){return t.split("-")[0]}function pc(t){return t.split("-")[1]}function o0(t){return t==="x"?"y":"x"}function a0(t){return t==="y"?"height":"width"}const u$=new Set(["top","bottom"]);function Mr(t){return u$.has(gi(t))?"y":"x"}function l0(t){return o0(Mr(t))}function d$(t,e,n){n===void 0&&(n=!1);const s=pc(t),r=l0(t),i=a0(r);let o=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=lp(o)),[o,lp(o)]}function h$(t){const e=lp(t);return[vy(t),e,vy(e)]}function vy(t){return t.replace(/start|end/g,e=>c$[e])}const Tk=["left","right"],Pk=["right","left"],f$=["top","bottom"],p$=["bottom","top"];function m$(t,e,n){switch(t){case"top":case"bottom":return n?e?Pk:Tk:e?Tk:Pk;case"left":case"right":return e?f$:p$;default:return[]}}function g$(t,e,n,s){const r=pc(t);let i=m$(gi(t),n==="start",s);return r&&(i=i.map(o=>o+"-"+r),e&&(i=i.concat(i.map(vy)))),i}function lp(t){return t.replace(/left|right|bottom|top/g,e=>l$[e])}function x$(t){return{top:0,right:0,bottom:0,left:0,...t}}function BN(t){return typeof t!="number"?x$(t):{top:t,right:t,bottom:t,left:t}}function cp(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function Rk(t,e,n){let{reference:s,floating:r}=t;const i=Mr(e),o=l0(e),a=a0(o),l=gi(e),u=i==="y",d=s.x+s.width/2-r.width/2,h=s.y+s.height/2-r.height/2,f=s[a]/2-r[a]/2;let p;switch(l){case"top":p={x:d,y:s.y-r.height};break;case"bottom":p={x:d,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:h};break;case"left":p={x:s.x-r.width,y:h};break;default:p={x:s.x,y:s.y}}switch(pc(e)){case"start":p[o]-=f*(n&&u?-1:1);break;case"end":p[o]+=f*(n&&u?-1:1);break}return p}const y$=async(t,e,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:d,y:h}=Rk(u,s,l),f=s,p={},w=0;for(let y=0;y<a.length;y++){const{name:x,fn:g}=a[y],{x:m,y:b,data:k,reset:_}=await g({x:d,y:h,initialPlacement:s,placement:f,strategy:r,middlewareData:p,rects:u,platform:o,elements:{reference:t,floating:e}});d=m??d,h=b??h,p={...p,[x]:{...p[x],...k}},_&&w<=50&&(w++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(u=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):_.rects),{x:d,y:h}=Rk(u,f,l)),y=-1)}return{x:d,y:h,placement:f,strategy:r,middlewareData:p}};async function Gu(t,e){var n;e===void 0&&(e={});const{x:s,y:r,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=mi(e,t),w=BN(p),x=a[f?h==="floating"?"reference":"floating":h],g=cp(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(x)))==null||n?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:u,rootBoundary:d,strategy:l})),m=h==="floating"?{x:s,y:r,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),k=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},_=cp(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:m,offsetParent:b,strategy:l}):m);return{top:(g.top-_.top+w.top)/k.y,bottom:(_.bottom-g.bottom+w.bottom)/k.y,left:(g.left-_.left+w.left)/k.x,right:(_.right-g.right+w.right)/k.x}}const v$=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:r,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:d=0}=mi(t,e)||{};if(u==null)return{};const h=BN(d),f={x:n,y:s},p=l0(r),w=a0(p),y=await o.getDimensions(u),x=p==="y",g=x?"top":"left",m=x?"bottom":"right",b=x?"clientHeight":"clientWidth",k=i.reference[w]+i.reference[p]-f[p]-i.floating[w],_=f[p]-i.reference[p],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let S=C?C[b]:0;(!S||!await(o.isElement==null?void 0:o.isElement(C)))&&(S=a.floating[b]||i.floating[w]);const j=k/2-_/2,N=S/2-y[w]/2-1,P=po(h[g],N),L=po(h[m],N),I=P,O=S-y[w]-L,$=S/2-y[w]/2+j,D=yy(I,$,O),F=!l.arrow&&pc(r)!=null&&$!==D&&i.reference[w]/2-($<I?P:L)-y[w]/2<0,q=F?$<I?$-I:$-O:0;return{[p]:f[p]+q,data:{[p]:D,centerOffset:$-D-q,...F&&{alignmentOffset:q}},reset:F}}}),b$=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:r,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:y=!0,...x}=mi(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const g=gi(r),m=Mr(a),b=gi(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(u.floating)),_=f||(b||!y?[lp(a)]:h$(a)),C=w!=="none";!f&&C&&_.push(...g$(a,y,w,k));const S=[a,..._],j=await Gu(e,x),N=[];let P=((s=i.flip)==null?void 0:s.overflows)||[];if(d&&N.push(j[g]),h){const $=d$(r,o,k);N.push(j[$[0]],j[$[1]])}if(P=[...P,{placement:r,overflows:N}],!N.every($=>$<=0)){var L,I;const $=(((L=i.flip)==null?void 0:L.index)||0)+1,D=S[$];if(D&&(!(h==="alignment"?m!==Mr(D):!1)||P.every(E=>Mr(E.placement)===m?E.overflows[0]>0:!0)))return{data:{index:$,overflows:P},reset:{placement:D}};let F=(I=P.filter(q=>q.overflows[0]<=0).sort((q,E)=>q.overflows[1]-E.overflows[1])[0])==null?void 0:I.placement;if(!F)switch(p){case"bestFit":{var O;const q=(O=P.filter(E=>{if(C){const R=Mr(E.placement);return R===m||R==="y"}return!0}).map(E=>[E.placement,E.overflows.filter(R=>R>0).reduce((R,V)=>R+V,0)]).sort((E,R)=>E[1]-R[1])[0])==null?void 0:O[0];q&&(F=q);break}case"initialPlacement":F=a;break}if(r!==F)return{reset:{placement:F}}}return{}}}};function Ak(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Ok(t){return a$.some(e=>t[e]>=0)}const w$=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...r}=mi(t,e);switch(s){case"referenceHidden":{const i=await Gu(e,{...r,elementContext:"reference"}),o=Ak(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Ok(o)}}}case"escaped":{const i=await Gu(e,{...r,altBoundary:!0}),o=Ak(i,n.floating);return{data:{escapedOffsets:o,escaped:Ok(o)}}}default:return{}}}}},UN=new Set(["left","top"]);async function k$(t,e){const{placement:n,platform:s,elements:r}=t,i=await(s.isRTL==null?void 0:s.isRTL(r.floating)),o=gi(n),a=pc(n),l=Mr(n)==="y",u=UN.has(o)?-1:1,d=i&&l?-1:1,h=mi(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:w}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof w=="number"&&(p=a==="end"?w*-1:w),l?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const _$=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:r,y:i,placement:o,middlewareData:a}=e,l=await k$(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:i+l.y,data:{...l,placement:o}}}}},S$=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:x=>{let{x:g,y:m}=x;return{x:g,y:m}}},...l}=mi(t,e),u={x:n,y:s},d=await Gu(e,l),h=Mr(gi(r)),f=o0(h);let p=u[f],w=u[h];if(i){const x=f==="y"?"top":"left",g=f==="y"?"bottom":"right",m=p+d[x],b=p-d[g];p=yy(m,p,b)}if(o){const x=h==="y"?"top":"left",g=h==="y"?"bottom":"right",m=w+d[x],b=w-d[g];w=yy(m,w,b)}const y=a.fn({...e,[f]:p,[h]:w});return{...y,data:{x:y.x-n,y:y.y-s,enabled:{[f]:i,[h]:o}}}}}},j$=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:r,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=mi(t,e),d={x:n,y:s},h=Mr(r),f=o0(h);let p=d[f],w=d[h];const y=mi(a,e),x=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(l){const b=f==="y"?"height":"width",k=i.reference[f]-i.floating[b]+x.mainAxis,_=i.reference[f]+i.reference[b]-x.mainAxis;p<k?p=k:p>_&&(p=_)}if(u){var g,m;const b=f==="y"?"width":"height",k=UN.has(gi(r)),_=i.reference[h]-i.floating[b]+(k&&((g=o.offset)==null?void 0:g[h])||0)+(k?0:x.crossAxis),C=i.reference[h]+i.reference[b]+(k?0:((m=o.offset)==null?void 0:m[h])||0)-(k?x.crossAxis:0);w<_?w=_:w>C&&(w=C)}return{[f]:p,[h]:w}}}},C$=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:r,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...u}=mi(t,e),d=await Gu(e,u),h=gi(r),f=pc(r),p=Mr(r)==="y",{width:w,height:y}=i.floating;let x,g;h==="top"||h==="bottom"?(x=h,g=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(g=h,x=f==="end"?"top":"bottom");const m=y-d.top-d.bottom,b=w-d.left-d.right,k=po(y-d[x],m),_=po(w-d[g],b),C=!e.middlewareData.shift;let S=k,j=_;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(j=b),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(S=m),C&&!f){const P=vs(d.left,0),L=vs(d.right,0),I=vs(d.top,0),O=vs(d.bottom,0);p?j=w-2*(P!==0||L!==0?P+L:vs(d.left,d.right)):S=y-2*(I!==0||O!==0?I+O:vs(d.top,d.bottom))}await l({...e,availableWidth:j,availableHeight:S});const N=await o.getDimensions(a.floating);return w!==N.width||y!==N.height?{reset:{rects:!0}}:{}}}};function Kp(){return typeof window<"u"}function mc(t){return HN(t)?(t.nodeName||"").toLowerCase():"#document"}function js(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function zr(t){var e;return(e=(HN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function HN(t){return Kp()?t instanceof Node||t instanceof js(t).Node:!1}function hr(t){return Kp()?t instanceof Element||t instanceof js(t).Element:!1}function Fr(t){return Kp()?t instanceof HTMLElement||t instanceof js(t).HTMLElement:!1}function Mk(t){return!Kp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof js(t).ShadowRoot}const N$=new Set(["inline","contents"]);function Od(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=fr(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!N$.has(r)}const E$=new Set(["table","td","th"]);function T$(t){return E$.has(mc(t))}const P$=[":popover-open",":modal"];function Gp(t){return P$.some(e=>{try{return t.matches(e)}catch{return!1}})}const R$=["transform","translate","scale","rotate","perspective"],A$=["transform","translate","scale","rotate","perspective","filter"],O$=["paint","layout","strict","content"];function c0(t){const e=u0(),n=hr(t)?fr(t):t;return R$.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||A$.some(s=>(n.willChange||"").includes(s))||O$.some(s=>(n.contain||"").includes(s))}function M$(t){let e=mo(t);for(;Fr(e)&&!rc(e);){if(c0(e))return e;if(Gp(e))return null;e=mo(e)}return null}function u0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const I$=new Set(["html","body","#document"]);function rc(t){return I$.has(mc(t))}function fr(t){return js(t).getComputedStyle(t)}function Yp(t){return hr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function mo(t){if(mc(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Mk(t)&&t.host||zr(t);return Mk(e)?e.host:e}function WN(t){const e=mo(t);return rc(e)?t.ownerDocument?t.ownerDocument.body:t.body:Fr(e)&&Od(e)?e:WN(e)}function Yu(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=WN(t),i=r===((s=t.ownerDocument)==null?void 0:s.body),o=js(r);if(i){const a=by(o);return e.concat(o,o.visualViewport||[],Od(r)?r:[],a&&n?Yu(a):[])}return e.concat(r,Yu(r,[],n))}function by(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function VN(t){const e=fr(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=Fr(t),i=r?t.offsetWidth:n,o=r?t.offsetHeight:s,a=ap(n)!==i||ap(s)!==o;return a&&(n=i,s=o),{width:n,height:s,$:a}}function d0(t){return hr(t)?t:t.contextElement}function Tl(t){const e=d0(t);if(!Fr(e))return $r(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:i}=VN(e);let o=(i?ap(n.width):n.width)/s,a=(i?ap(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const D$=$r(0);function qN(t){const e=js(t);return!u0()||!e.visualViewport?D$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function L$(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==js(t)?!1:e}function ka(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=d0(t);let o=$r(1);e&&(s?hr(s)&&(o=Tl(s)):o=Tl(t));const a=L$(i,n,s)?qN(i):$r(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,d=r.width/o.x,h=r.height/o.y;if(i){const f=js(i),p=s&&hr(s)?js(s):s;let w=f,y=by(w);for(;y&&s&&p!==w;){const x=Tl(y),g=y.getBoundingClientRect(),m=fr(y),b=g.left+(y.clientLeft+parseFloat(m.paddingLeft))*x.x,k=g.top+(y.clientTop+parseFloat(m.paddingTop))*x.y;l*=x.x,u*=x.y,d*=x.x,h*=x.y,l+=b,u+=k,w=js(y),y=by(w)}}return cp({width:d,height:h,x:l,y:u})}function Qp(t,e){const n=Yp(t).scrollLeft;return e?e.left+n:ka(zr(t)).left+n}function KN(t,e){const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-Qp(t,n),r=n.top+e.scrollTop;return{x:s,y:r}}function $$(t){let{elements:e,rect:n,offsetParent:s,strategy:r}=t;const i=r==="fixed",o=zr(s),a=e?Gp(e.floating):!1;if(s===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},u=$r(1);const d=$r(0),h=Fr(s);if((h||!h&&!i)&&((mc(s)!=="body"||Od(o))&&(l=Yp(s)),Fr(s))){const p=ka(s);u=Tl(s),d.x=p.x+s.clientLeft,d.y=p.y+s.clientTop}const f=o&&!h&&!i?KN(o,l):$r(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-l.scrollTop*u.y+d.y+f.y}}function F$(t){return Array.from(t.getClientRects())}function z$(t){const e=zr(t),n=Yp(t),s=t.ownerDocument.body,r=vs(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=vs(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+Qp(t);const a=-n.scrollTop;return fr(s).direction==="rtl"&&(o+=vs(e.clientWidth,s.clientWidth)-r),{width:r,height:i,x:o,y:a}}const Ik=25;function B$(t,e){const n=js(t),s=zr(t),r=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(r){i=r.width,o=r.height;const d=u0();(!d||d&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}const u=Qp(s);if(u<=0){const d=s.ownerDocument,h=d.body,f=getComputedStyle(h),p=d.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,w=Math.abs(s.clientWidth-h.clientWidth-p);w<=Ik&&(i-=w)}else u<=Ik&&(i+=u);return{width:i,height:o,x:a,y:l}}const U$=new Set(["absolute","fixed"]);function H$(t,e){const n=ka(t,!0,e==="fixed"),s=n.top+t.clientTop,r=n.left+t.clientLeft,i=Fr(t)?Tl(t):$r(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=r*i.x,u=s*i.y;return{width:o,height:a,x:l,y:u}}function Dk(t,e,n){let s;if(e==="viewport")s=B$(t,n);else if(e==="document")s=z$(zr(t));else if(hr(e))s=H$(e,n);else{const r=qN(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return cp(s)}function GN(t,e){const n=mo(t);return n===e||!hr(n)||rc(n)?!1:fr(n).position==="fixed"||GN(n,e)}function W$(t,e){const n=e.get(t);if(n)return n;let s=Yu(t,[],!1).filter(a=>hr(a)&&mc(a)!=="body"),r=null;const i=fr(t).position==="fixed";let o=i?mo(t):t;for(;hr(o)&&!rc(o);){const a=fr(o),l=c0(o);!l&&a.position==="fixed"&&(r=null),(i?!l&&!r:!l&&a.position==="static"&&!!r&&U$.has(r.position)||Od(o)&&!l&&GN(t,o))?s=s.filter(d=>d!==o):r=a,o=mo(o)}return e.set(t,s),s}function V$(t){let{element:e,boundary:n,rootBoundary:s,strategy:r}=t;const o=[...n==="clippingAncestors"?Gp(e)?[]:W$(e,this._c):[].concat(n),s],a=o[0],l=o.reduce((u,d)=>{const h=Dk(e,d,r);return u.top=vs(h.top,u.top),u.right=po(h.right,u.right),u.bottom=po(h.bottom,u.bottom),u.left=vs(h.left,u.left),u},Dk(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function q$(t){const{width:e,height:n}=VN(t);return{width:e,height:n}}function K$(t,e,n){const s=Fr(e),r=zr(e),i=n==="fixed",o=ka(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=$r(0);function u(){l.x=Qp(r)}if(s||!s&&!i)if((mc(e)!=="body"||Od(r))&&(a=Yp(e)),s){const p=ka(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else r&&u();i&&!s&&r&&u();const d=r&&!s&&!i?KN(r,a):$r(0),h=o.left+a.scrollLeft-l.x-d.x,f=o.top+a.scrollTop-l.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function cg(t){return fr(t).position==="static"}function Lk(t,e){if(!Fr(t)||fr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return zr(t)===n&&(n=n.ownerDocument.body),n}function YN(t,e){const n=js(t);if(Gp(t))return n;if(!Fr(t)){let r=mo(t);for(;r&&!rc(r);){if(hr(r)&&!cg(r))return r;r=mo(r)}return n}let s=Lk(t,e);for(;s&&T$(s)&&cg(s);)s=Lk(s,e);return s&&rc(s)&&cg(s)&&!c0(s)?n:s||M$(t)||n}const G$=async function(t){const e=this.getOffsetParent||YN,n=this.getDimensions,s=await n(t.floating);return{reference:K$(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Y$(t){return fr(t).direction==="rtl"}const Q$={convertOffsetParentRelativeRectToViewportRelativeRect:$$,getDocumentElement:zr,getClippingRect:V$,getOffsetParent:YN,getElementRects:G$,getClientRects:F$,getDimensions:q$,getScale:Tl,isElement:hr,isRTL:Y$};function QN(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function X$(t,e){let n=null,s;const r=zr(t);function i(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:p}=u;if(a||e(),!f||!p)return;const w=Nh(h),y=Nh(r.clientWidth-(d+f)),x=Nh(r.clientHeight-(h+p)),g=Nh(d),b={rootMargin:-w+"px "+-y+"px "+-x+"px "+-g+"px",threshold:vs(0,po(1,l))||1};let k=!0;function _(C){const S=C[0].intersectionRatio;if(S!==l){if(!k)return o();S?o(!1,S):s=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!QN(u,t.getBoundingClientRect())&&o(),k=!1}try{n=new IntersectionObserver(_,{...b,root:r.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(t)}return o(!0),i}function J$(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,u=d0(t),d=r||i?[...u?Yu(u):[],...Yu(e)]:[];d.forEach(g=>{r&&g.addEventListener("scroll",n,{passive:!0}),i&&g.addEventListener("resize",n)});const h=u&&a?X$(u,n):null;let f=-1,p=null;o&&(p=new ResizeObserver(g=>{let[m]=g;m&&m.target===u&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(e)})),n()}),u&&!l&&p.observe(u),p.observe(e));let w,y=l?ka(t):null;l&&x();function x(){const g=ka(t);y&&!QN(y,g)&&n(),y=g,w=requestAnimationFrame(x)}return n(),()=>{var g;d.forEach(m=>{r&&m.removeEventListener("scroll",n),i&&m.removeEventListener("resize",n)}),h==null||h(),(g=p)==null||g.disconnect(),p=null,l&&cancelAnimationFrame(w)}}const Z$=_$,eF=S$,tF=b$,nF=C$,sF=w$,$k=v$,rF=j$,iF=(t,e,n)=>{const s=new Map,r={platform:Q$,...n},i={...r.platform,_c:s};return y$(t,e,{...r,platform:i})};var oF=typeof document<"u",aF=function(){},bf=oF?v.useLayoutEffect:aF;function up(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!up(t[s],e[s]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){const i=r[s];if(!(i==="_owner"&&t.$$typeof)&&!up(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function XN(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Fk(t,e){const n=XN(t);return Math.round(e*n)/n}function ug(t){const e=v.useRef(t);return bf(()=>{e.current=t}),e}function lF(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[d,h]=v.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=v.useState(s);up(f,s)||p(s);const[w,y]=v.useState(null),[x,g]=v.useState(null),m=v.useCallback(E=>{E!==C.current&&(C.current=E,y(E))},[]),b=v.useCallback(E=>{E!==S.current&&(S.current=E,g(E))},[]),k=i||w,_=o||x,C=v.useRef(null),S=v.useRef(null),j=v.useRef(d),N=l!=null,P=ug(l),L=ug(r),I=ug(u),O=v.useCallback(()=>{if(!C.current||!S.current)return;const E={placement:e,strategy:n,middleware:f};L.current&&(E.platform=L.current),iF(C.current,S.current,E).then(R=>{const V={...R,isPositioned:I.current!==!1};$.current&&!up(j.current,V)&&(j.current=V,jd.flushSync(()=>{h(V)}))})},[f,e,n,L,I]);bf(()=>{u===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,h(E=>({...E,isPositioned:!1})))},[u]);const $=v.useRef(!1);bf(()=>($.current=!0,()=>{$.current=!1}),[]),bf(()=>{if(k&&(C.current=k),_&&(S.current=_),k&&_){if(P.current)return P.current(k,_,O);O()}},[k,_,O,P,N]);const D=v.useMemo(()=>({reference:C,floating:S,setReference:m,setFloating:b}),[m,b]),F=v.useMemo(()=>({reference:k,floating:_}),[k,_]),q=v.useMemo(()=>{const E={position:n,left:0,top:0};if(!F.floating)return E;const R=Fk(F.floating,d.x),V=Fk(F.floating,d.y);return a?{...E,transform:"translate("+R+"px, "+V+"px)",...XN(F.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:R,top:V}},[n,a,F.floating,d.x,d.y]);return v.useMemo(()=>({...d,update:O,refs:D,elements:F,floatingStyles:q}),[d,O,D,F,q])}const cF=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:r}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?$k({element:s.current,padding:r}).fn(n):{}:s?$k({element:s,padding:r}).fn(n):{}}}},uF=(t,e)=>({...Z$(t),options:[t,e]}),dF=(t,e)=>({...eF(t),options:[t,e]}),hF=(t,e)=>({...rF(t),options:[t,e]}),fF=(t,e)=>({...tF(t),options:[t,e]}),pF=(t,e)=>({...nF(t),options:[t,e]}),mF=(t,e)=>({...sF(t),options:[t,e]}),gF=(t,e)=>({...cF(t),options:[t,e]});var xF="Arrow",JN=v.forwardRef((t,e)=>{const{children:n,width:s=10,height:r=5,...i}=t;return c.jsx(Wn.svg,{...i,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});JN.displayName=xF;var yF=JN;function vF(t){const[e,n]=v.useState(void 0);return fo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var h0="Popper",[ZN,eE]=Ad(h0),[bF,tE]=ZN(h0),nE=t=>{const{__scopePopper:e,children:n}=t,[s,r]=v.useState(null);return c.jsx(bF,{scope:e,anchor:s,onAnchorChange:r,children:n})};nE.displayName=h0;var sE="PopperAnchor",rE=v.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...r}=t,i=tE(sE,n),o=v.useRef(null),a=cs(e,o),l=v.useRef(null);return v.useEffect(()=>{const u=l.current;l.current=(s==null?void 0:s.current)||o.current,u!==l.current&&i.onAnchorChange(l.current)}),s?null:c.jsx(Wn.div,{...r,ref:a})});rE.displayName=sE;var f0="PopperContent",[wF,kF]=ZN(f0),iE=v.forwardRef((t,e)=>{var Y,B,J,be,pe,H;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:w,...y}=t,x=tE(f0,n),[g,m]=v.useState(null),b=cs(e,ye=>m(ye)),[k,_]=v.useState(null),C=vF(k),S=(C==null?void 0:C.width)??0,j=(C==null?void 0:C.height)??0,N=s+(i!=="center"?"-"+i:""),P=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},L=Array.isArray(u)?u:[u],I=L.length>0,O={padding:P,boundary:L.filter(SF),altBoundary:I},{refs:$,floatingStyles:D,placement:F,isPositioned:q,middlewareData:E}=lF({strategy:"fixed",placement:N,whileElementsMounted:(...ye)=>J$(...ye,{animationFrame:p==="always"}),elements:{reference:x.anchor},middleware:[uF({mainAxis:r+j,alignmentAxis:o}),l&&dF({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?hF():void 0,...O}),l&&fF({...O}),pF({...O,apply:({elements:ye,rects:X,availableWidth:ue,availableHeight:ce})=>{const{width:de,height:ie}=X.reference,Se=ye.floating.style;Se.setProperty("--radix-popper-available-width",`${ue}px`),Se.setProperty("--radix-popper-available-height",`${ce}px`),Se.setProperty("--radix-popper-anchor-width",`${de}px`),Se.setProperty("--radix-popper-anchor-height",`${ie}px`)}}),k&&gF({element:k,padding:a}),jF({arrowWidth:S,arrowHeight:j}),f&&mF({strategy:"referenceHidden",...O})]}),[R,V]=lE(F),K=pi(w);fo(()=>{q&&(K==null||K())},[q,K]);const Q=(Y=E.arrow)==null?void 0:Y.x,re=(B=E.arrow)==null?void 0:B.y,ee=((J=E.arrow)==null?void 0:J.centerOffset)!==0,[z,A]=v.useState();return fo(()=>{g&&A(window.getComputedStyle(g).zIndex)},[g]),c.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...D,transform:q?D.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:z,"--radix-popper-transform-origin":[(be=E.transformOrigin)==null?void 0:be.x,(pe=E.transformOrigin)==null?void 0:pe.y].join(" "),...((H=E.hide)==null?void 0:H.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:c.jsx(wF,{scope:n,placedSide:R,onArrowChange:_,arrowX:Q,arrowY:re,shouldHideArrow:ee,children:c.jsx(Wn.div,{"data-side":R,"data-align":V,...y,ref:b,style:{...y.style,animation:q?void 0:"none"}})})})});iE.displayName=f0;var oE="PopperArrow",_F={top:"bottom",right:"left",bottom:"top",left:"right"},aE=v.forwardRef(function(e,n){const{__scopePopper:s,...r}=e,i=kF(oE,s),o=_F[i.placedSide];return c.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:c.jsx(yF,{...r,ref:n,style:{...r.style,display:"block"}})})});aE.displayName=oE;function SF(t){return t!==null}var jF=t=>({name:"transformOrigin",options:t,fn(e){var x,g,m;const{placement:n,rects:s,middlewareData:r}=e,o=((x=r.arrow)==null?void 0:x.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,d]=lE(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((g=r.arrow)==null?void 0:g.x)??0)+a/2,p=(((m=r.arrow)==null?void 0:m.y)??0)+l/2;let w="",y="";return u==="bottom"?(w=o?h:`${f}px`,y=`${-l}px`):u==="top"?(w=o?h:`${f}px`,y=`${s.floating.height+l}px`):u==="right"?(w=`${-l}px`,y=o?h:`${p}px`):u==="left"&&(w=`${s.floating.width+l}px`,y=o?h:`${p}px`),{data:{x:w,y}}}});function lE(t){const[e,n="center"]=t.split("-");return[e,n]}var CF=nE,NF=rE,EF=iE,TF=aE,PF="Portal",cE=v.forwardRef((t,e)=>{var a;const{container:n,...s}=t,[r,i]=v.useState(!1);fo(()=>i(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?gC.createPortal(c.jsx(Wn.div,{...s,ref:e}),o):null});cE.displayName=PF;function RF(t,e){return v.useReducer((n,s)=>e[n][s]??n,t)}var Md=t=>{const{present:e,children:n}=t,s=AF(e),r=typeof n=="function"?n({present:s.isPresent}):v.Children.only(n),i=cs(s.ref,OF(r));return typeof n=="function"||s.isPresent?v.cloneElement(r,{ref:i}):null};Md.displayName="Presence";function AF(t){const[e,n]=v.useState(),s=v.useRef(null),r=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=RF(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const u=Eh(s.current);i.current=a==="mounted"?u:"none"},[a]),fo(()=>{const u=s.current,d=r.current;if(d!==t){const f=i.current,p=Eh(u);t?l("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),fo(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=p=>{const y=Eh(s.current).includes(CSS.escape(p.animationName));if(p.target===e&&y&&(l("ANIMATION_END"),!r.current)){const x=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=x)})}},f=p=>{p.target===e&&(i.current=Eh(s.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(u=>{s.current=u?getComputedStyle(u):null,n(u)},[])}}function Eh(t){return(t==null?void 0:t.animationName)||"none"}function OF(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var dg="rovingFocusGroup.onEntryFocus",MF={bubbles:!1,cancelable:!0},Id="RovingFocusGroup",[wy,uE,IF]=MN(Id),[DF,dE]=Ad(Id,[IF]),[LF,$F]=DF(Id),hE=v.forwardRef((t,e)=>c.jsx(wy.Provider,{scope:t.__scopeRovingFocusGroup,children:c.jsx(wy.Slot,{scope:t.__scopeRovingFocusGroup,children:c.jsx(FF,{...t,ref:e})})}));hE.displayName=Id;var FF=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:r=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=v.useRef(null),p=cs(e,f),w=IN(i),[y,x]=AN({prop:o,defaultProp:a??null,onChange:l,caller:Id}),[g,m]=v.useState(!1),b=pi(u),k=uE(n),_=v.useRef(!1),[C,S]=v.useState(0);return v.useEffect(()=>{const j=f.current;if(j)return j.addEventListener(dg,b),()=>j.removeEventListener(dg,b)},[b]),c.jsx(LF,{scope:n,orientation:s,dir:w,loop:r,currentTabStopId:y,onItemFocus:v.useCallback(j=>x(j),[x]),onItemShiftTab:v.useCallback(()=>m(!0),[]),onFocusableItemAdd:v.useCallback(()=>S(j=>j+1),[]),onFocusableItemRemove:v.useCallback(()=>S(j=>j-1),[]),children:c.jsx(Wn.div,{tabIndex:g||C===0?-1:0,"data-orientation":s,...h,ref:p,style:{outline:"none",...t.style},onMouseDown:tt(t.onMouseDown,()=>{_.current=!0}),onFocus:tt(t.onFocus,j=>{const N=!_.current;if(j.target===j.currentTarget&&N&&!g){const P=new CustomEvent(dg,MF);if(j.currentTarget.dispatchEvent(P),!P.defaultPrevented){const L=k().filter(F=>F.focusable),I=L.find(F=>F.active),O=L.find(F=>F.id===y),D=[I,O,...L].filter(Boolean).map(F=>F.ref.current);mE(D,d)}}_.current=!1}),onBlur:tt(t.onBlur,()=>m(!1))})})}),fE="RovingFocusGroupItem",pE=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:r=!1,tabStopId:i,children:o,...a}=t,l=xy(),u=i||l,d=$F(fE,n),h=d.currentTabStopId===u,f=uE(n),{onFocusableItemAdd:p,onFocusableItemRemove:w,currentTabStopId:y}=d;return v.useEffect(()=>{if(s)return p(),()=>w()},[s,p,w]),c.jsx(wy.ItemSlot,{scope:n,id:u,focusable:s,active:r,children:c.jsx(Wn.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...a,ref:e,onMouseDown:tt(t.onMouseDown,x=>{s?d.onItemFocus(u):x.preventDefault()}),onFocus:tt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:tt(t.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){d.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const g=UF(x,d.orientation,d.dir);if(g!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let b=f().filter(k=>k.focusable).map(k=>k.ref.current);if(g==="last")b.reverse();else if(g==="prev"||g==="next"){g==="prev"&&b.reverse();const k=b.indexOf(x.currentTarget);b=d.loop?HF(b,k+1):b.slice(k+1)}setTimeout(()=>mE(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:y!=null}):o})})});pE.displayName=fE;var zF={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function BF(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function UF(t,e,n){const s=BF(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return zF[s]}function mE(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function HF(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var WF=hE,VF=pE;function qF(t){const e=KF(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(YF);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function KF(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=XF(r),a=QF(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Ta(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var GF=Symbol("radix.slottable");function YF(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===GF}function QF(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function XF(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var JF=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ya=new WeakMap,Th=new WeakMap,Ph={},hg=0,gE=function(t){return t&&(t.host||gE(t.parentNode))},ZF=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=gE(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},ez=function(t,e,n,s){var r=ZF(e,Array.isArray(t)?t:[t]);Ph[n]||(Ph[n]=new WeakMap);var i=Ph[n],o=[],a=new Set,l=new Set(r),u=function(h){!h||a.has(h)||(a.add(h),u(h.parentNode))};r.forEach(u);var d=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))d(f);else try{var p=f.getAttribute(s),w=p!==null&&p!=="false",y=(Ya.get(f)||0)+1,x=(i.get(f)||0)+1;Ya.set(f,y),i.set(f,x),o.push(f),y===1&&w&&Th.set(f,!0),x===1&&f.setAttribute(n,"true"),w||f.setAttribute(s,"true")}catch(g){console.error("aria-hidden: cannot operate on ",f,g)}})};return d(e),a.clear(),hg++,function(){o.forEach(function(h){var f=Ya.get(h)-1,p=i.get(h)-1;Ya.set(h,f),i.set(h,p),f||(Th.has(h)||h.removeAttribute(s),Th.delete(h)),p||h.removeAttribute(n)}),hg--,hg||(Ya=new WeakMap,Ya=new WeakMap,Th=new WeakMap,Ph={})}},tz=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=JF(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),ez(s,r,n,"aria-hidden")):function(){return null}},wf="right-scroll-bar-position",kf="width-before-scroll-bar",nz="with-scroll-bars-hidden",sz="--removed-body-scroll-bar-size";function fg(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function rz(t,e){var n=v.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var r=n.value;r!==s&&(n.value=s,n.callback(s,r))}}}})[0];return n.callback=e,n.facade}var iz=typeof window<"u"?v.useLayoutEffect:v.useEffect,zk=new WeakMap;function oz(t,e){var n=rz(null,function(s){return t.forEach(function(r){return fg(r,s)})});return iz(function(){var s=zk.get(n);if(s){var r=new Set(s),i=new Set(t),o=n.current;r.forEach(function(a){i.has(a)||fg(a,null)}),i.forEach(function(a){r.has(a)||fg(a,o)})}zk.set(n,t)},[t]),n}function az(t){return t}function lz(t,e){e===void 0&&(e=az);var n=[],s=!1,r={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,s);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(s=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){s=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return r}function cz(t){t===void 0&&(t={});var e=lz(null);return e.options=Or({async:!0,ssr:!1},t),e}var xE=function(t){var e=t.sideCar,n=hc(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return v.createElement(s,Or({},n))};xE.isSideCarExport=!0;function uz(t,e){return t.useMedium(e),xE}var yE=cz(),pg=function(){},Xp=v.forwardRef(function(t,e){var n=v.useRef(null),s=v.useState({onScrollCapture:pg,onWheelCapture:pg,onTouchMoveCapture:pg}),r=s[0],i=s[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,p=t.noRelative,w=t.noIsolation,y=t.inert,x=t.allowPinchZoom,g=t.as,m=g===void 0?"div":g,b=t.gapMode,k=hc(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=f,C=oz([n,e]),S=Or(Or({},k),r);return v.createElement(v.Fragment,null,d&&v.createElement(_,{sideCar:yE,removeScrollBar:u,shards:h,noRelative:p,noIsolation:w,inert:y,setCallbacks:i,allowPinchZoom:!!x,lockRef:n,gapMode:b}),o?v.cloneElement(v.Children.only(a),Or(Or({},S),{ref:C})):v.createElement(m,Or({},S,{className:l,ref:C}),a))});Xp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Xp.classNames={fullWidth:kf,zeroRight:wf};var dz=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function hz(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=dz();return e&&t.setAttribute("nonce",e),t}function fz(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function pz(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var mz=function(){var t=0,e=null;return{add:function(n){t==0&&(e=hz())&&(fz(e,n),pz(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},gz=function(){var t=mz();return function(e,n){v.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},vE=function(){var t=gz(),e=function(n){var s=n.styles,r=n.dynamic;return t(s,r),null};return e},xz={left:0,top:0,right:0,gap:0},mg=function(t){return parseInt(t||"",10)||0},yz=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[mg(n),mg(s),mg(r)]},vz=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return xz;var e=yz(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},bz=vE(),Pl="data-scroll-locked",wz=function(t,e,n,s){var r=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(nz,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(a,"px ").concat(s,`;
  }
  body[`).concat(Pl,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(wf,` {
    right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(kf,` {
    margin-right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(wf," .").concat(wf,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(kf," .").concat(kf,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Pl,`] {
    `).concat(sz,": ").concat(a,`px;
  }
`)},Bk=function(){var t=parseInt(document.body.getAttribute(Pl)||"0",10);return isFinite(t)?t:0},kz=function(){v.useEffect(function(){return document.body.setAttribute(Pl,(Bk()+1).toString()),function(){var t=Bk()-1;t<=0?document.body.removeAttribute(Pl):document.body.setAttribute(Pl,t.toString())}},[])},_z=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,r=s===void 0?"margin":s;kz();var i=v.useMemo(function(){return vz(r)},[r]);return v.createElement(bz,{styles:wz(i,!e,r,n?"":"!important")})},ky=!1;if(typeof window<"u")try{var Rh=Object.defineProperty({},"passive",{get:function(){return ky=!0,!0}});window.addEventListener("test",Rh,Rh),window.removeEventListener("test",Rh,Rh)}catch{ky=!1}var Qa=ky?{passive:!1}:!1,Sz=function(t){return t.tagName==="TEXTAREA"},bE=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Sz(t)&&n[e]==="visible")},jz=function(t){return bE(t,"overflowY")},Cz=function(t){return bE(t,"overflowX")},Uk=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var r=wE(t,s);if(r){var i=kE(t,s),o=i[1],a=i[2];if(o>a)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},Nz=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},Ez=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},wE=function(t,e){return t==="v"?jz(e):Cz(e)},kE=function(t,e){return t==="v"?Nz(e):Ez(e)},Tz=function(t,e){return t==="h"&&e==="rtl"?-1:1},Pz=function(t,e,n,s,r){var i=Tz(t,window.getComputedStyle(e).direction),o=i*s,a=n.target,l=e.contains(a),u=!1,d=o>0,h=0,f=0;do{if(!a)break;var p=kE(t,a),w=p[0],y=p[1],x=p[2],g=y-x-i*w;(w||g)&&wE(t,a)&&(h+=g,f+=w);var m=a.parentNode;a=m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE?m.host:m}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(d&&Math.abs(h)<1||!d&&Math.abs(f)<1)&&(u=!0),u},Ah=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Hk=function(t){return[t.deltaX,t.deltaY]},Wk=function(t){return t&&"current"in t?t.current:t},Rz=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Az=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Oz=0,Xa=[];function Mz(t){var e=v.useRef([]),n=v.useRef([0,0]),s=v.useRef(),r=v.useState(Oz++)[0],i=v.useState(vE)[0],o=v.useRef(t);v.useEffect(function(){o.current=t},[t]),v.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var y=BI([t.lockRef.current],(t.shards||[]).map(Wk),!0).filter(Boolean);return y.forEach(function(x){return x.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),y.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=v.useCallback(function(y,x){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!o.current.allowPinchZoom;var g=Ah(y),m=n.current,b="deltaX"in y?y.deltaX:m[0]-g[0],k="deltaY"in y?y.deltaY:m[1]-g[1],_,C=y.target,S=Math.abs(b)>Math.abs(k)?"h":"v";if("touches"in y&&S==="h"&&C.type==="range")return!1;var j=window.getSelection(),N=j&&j.anchorNode,P=N?N===C||N.contains(C):!1;if(P)return!1;var L=Uk(S,C);if(!L)return!0;if(L?_=S:(_=S==="v"?"h":"v",L=Uk(S,C)),!L)return!1;if(!s.current&&"changedTouches"in y&&(b||k)&&(s.current=_),!_)return!0;var I=s.current||_;return Pz(I,x,y,I==="h"?b:k)},[]),l=v.useCallback(function(y){var x=y;if(!(!Xa.length||Xa[Xa.length-1]!==i)){var g="deltaY"in x?Hk(x):Ah(x),m=e.current.filter(function(_){return _.name===x.type&&(_.target===x.target||x.target===_.shadowParent)&&Rz(_.delta,g)})[0];if(m&&m.should){x.cancelable&&x.preventDefault();return}if(!m){var b=(o.current.shards||[]).map(Wk).filter(Boolean).filter(function(_){return _.contains(x.target)}),k=b.length>0?a(x,b[0]):!o.current.noIsolation;k&&x.cancelable&&x.preventDefault()}}},[]),u=v.useCallback(function(y,x,g,m){var b={name:y,delta:x,target:g,should:m,shadowParent:Iz(g)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(k){return k!==b})},1)},[]),d=v.useCallback(function(y){n.current=Ah(y),s.current=void 0},[]),h=v.useCallback(function(y){u(y.type,Hk(y),y.target,a(y,t.lockRef.current))},[]),f=v.useCallback(function(y){u(y.type,Ah(y),y.target,a(y,t.lockRef.current))},[]);v.useEffect(function(){return Xa.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Qa),document.addEventListener("touchmove",l,Qa),document.addEventListener("touchstart",d,Qa),function(){Xa=Xa.filter(function(y){return y!==i}),document.removeEventListener("wheel",l,Qa),document.removeEventListener("touchmove",l,Qa),document.removeEventListener("touchstart",d,Qa)}},[]);var p=t.removeScrollBar,w=t.inert;return v.createElement(v.Fragment,null,w?v.createElement(i,{styles:Az(r)}):null,p?v.createElement(_z,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Iz(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Dz=uz(yE,Mz);var _E=v.forwardRef(function(t,e){return v.createElement(Xp,Or({},t,{ref:e,sideCar:Dz}))});_E.classNames=Xp.classNames;var _y=["Enter"," "],Lz=["ArrowDown","PageUp","Home"],SE=["ArrowUp","PageDown","End"],$z=[...Lz,...SE],Fz={ltr:[..._y,"ArrowRight"],rtl:[..._y,"ArrowLeft"]},zz={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Dd="Menu",[Qu,Bz,Uz]=MN(Dd),[Ra,jE]=Ad(Dd,[Uz,eE,dE]),Jp=eE(),CE=dE(),[Hz,Aa]=Ra(Dd),[Wz,Ld]=Ra(Dd),NE=t=>{const{__scopeMenu:e,open:n=!1,children:s,dir:r,onOpenChange:i,modal:o=!0}=t,a=Jp(e),[l,u]=v.useState(null),d=v.useRef(!1),h=pi(i),f=IN(r);return v.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",w,{capture:!0,once:!0}),document.addEventListener("pointermove",w,{capture:!0,once:!0})},w=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",w,{capture:!0}),document.removeEventListener("pointermove",w,{capture:!0})}},[]),c.jsx(CF,{...a,children:c.jsx(Hz,{scope:e,open:n,onOpenChange:h,content:l,onContentChange:u,children:c.jsx(Wz,{scope:e,onClose:v.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:s})})})};NE.displayName=Dd;var Vz="MenuAnchor",p0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=Jp(n);return c.jsx(NF,{...r,...s,ref:e})});p0.displayName=Vz;var m0="MenuPortal",[qz,EE]=Ra(m0,{forceMount:void 0}),TE=t=>{const{__scopeMenu:e,forceMount:n,children:s,container:r}=t,i=Aa(m0,e);return c.jsx(qz,{scope:e,forceMount:n,children:c.jsx(Md,{present:n||i.open,children:c.jsx(cE,{asChild:!0,container:r,children:s})})})};TE.displayName=m0;var Us="MenuContent",[Kz,g0]=Ra(Us),PE=v.forwardRef((t,e)=>{const n=EE(Us,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Aa(Us,t.__scopeMenu),o=Ld(Us,t.__scopeMenu);return c.jsx(Qu.Provider,{scope:t.__scopeMenu,children:c.jsx(Md,{present:s||i.open,children:c.jsx(Qu.Slot,{scope:t.__scopeMenu,children:o.modal?c.jsx(Gz,{...r,ref:e}):c.jsx(Yz,{...r,ref:e})})})})}),Gz=v.forwardRef((t,e)=>{const n=Aa(Us,t.__scopeMenu),s=v.useRef(null),r=cs(e,s);return v.useEffect(()=>{const i=s.current;if(i)return tz(i)},[]),c.jsx(x0,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:tt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Yz=v.forwardRef((t,e)=>{const n=Aa(Us,t.__scopeMenu);return c.jsx(x0,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Qz=qF("MenuContent.ScrollLock"),x0=v.forwardRef((t,e)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:w,...y}=t,x=Aa(Us,n),g=Ld(Us,n),m=Jp(n),b=CE(n),k=Bz(n),[_,C]=v.useState(null),S=v.useRef(null),j=cs(e,S,x.onContentChange),N=v.useRef(0),P=v.useRef(""),L=v.useRef(0),I=v.useRef(null),O=v.useRef("right"),$=v.useRef(0),D=w?_E:v.Fragment,F=w?{as:Qz,allowPinchZoom:!0}:void 0,q=R=>{var Y,B;const V=P.current+R,K=k().filter(J=>!J.disabled),Q=document.activeElement,re=(Y=K.find(J=>J.ref.current===Q))==null?void 0:Y.textValue,ee=K.map(J=>J.textValue),z=l3(ee,V,re),A=(B=K.find(J=>J.textValue===z))==null?void 0:B.ref.current;(function J(be){P.current=be,window.clearTimeout(N.current),be!==""&&(N.current=window.setTimeout(()=>J(""),1e3))})(V),A&&setTimeout(()=>A.focus())};v.useEffect(()=>()=>window.clearTimeout(N.current),[]),X5();const E=v.useCallback(R=>{var K,Q;return O.current===((K=I.current)==null?void 0:K.side)&&u3(R,(Q=I.current)==null?void 0:Q.area)},[]);return c.jsx(Kz,{scope:n,searchRef:P,onItemEnter:v.useCallback(R=>{E(R)&&R.preventDefault()},[E]),onItemLeave:v.useCallback(R=>{var V;E(R)||((V=S.current)==null||V.focus(),C(null))},[E]),onTriggerLeave:v.useCallback(R=>{E(R)&&R.preventDefault()},[E]),pointerGraceTimerRef:L,onPointerGraceIntentChange:v.useCallback(R=>{I.current=R},[]),children:c.jsx(D,{...F,children:c.jsx(FN,{asChild:!0,trapped:r,onMountAutoFocus:tt(i,R=>{var V;R.preventDefault(),(V=S.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:c.jsx(LN,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:c.jsx(WF,{asChild:!0,...b,dir:g.dir,orientation:"vertical",loop:s,currentTabStopId:_,onCurrentTabStopIdChange:C,onEntryFocus:tt(l,R=>{g.isUsingKeyboardRef.current||R.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(EF,{role:"menu","aria-orientation":"vertical","data-state":qE(x.open),"data-radix-menu-content":"",dir:g.dir,...m,...y,ref:j,style:{outline:"none",...y.style},onKeyDown:tt(y.onKeyDown,R=>{const K=R.target.closest("[data-radix-menu-content]")===R.currentTarget,Q=R.ctrlKey||R.altKey||R.metaKey,re=R.key.length===1;K&&(R.key==="Tab"&&R.preventDefault(),!Q&&re&&q(R.key));const ee=S.current;if(R.target!==ee||!$z.includes(R.key))return;R.preventDefault();const A=k().filter(Y=>!Y.disabled).map(Y=>Y.ref.current);SE.includes(R.key)&&A.reverse(),o3(A)}),onBlur:tt(t.onBlur,R=>{R.currentTarget.contains(R.target)||(window.clearTimeout(N.current),P.current="")}),onPointerMove:tt(t.onPointerMove,Xu(R=>{const V=R.target,K=$.current!==R.clientX;if(R.currentTarget.contains(V)&&K){const Q=R.clientX>$.current?"right":"left";O.current=Q,$.current=R.clientX}}))})})})})})})});PE.displayName=Us;var Xz="MenuGroup",y0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{role:"group",...s,ref:e})});y0.displayName=Xz;var Jz="MenuLabel",RE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{...s,ref:e})});RE.displayName=Jz;var dp="MenuItem",Vk="menu.itemSelect",Zp=v.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:s,...r}=t,i=v.useRef(null),o=Ld(dp,t.__scopeMenu),a=g0(dp,t.__scopeMenu),l=cs(e,i),u=v.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(Vk,{bubbles:!0,cancelable:!0});h.addEventListener(Vk,p=>s==null?void 0:s(p),{once:!0}),ON(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return c.jsx(AE,{...r,ref:l,disabled:n,onClick:tt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:tt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:tt(t.onKeyDown,h=>{const f=a.searchRef.current!=="";n||f&&h.key===" "||_y.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Zp.displayName=dp;var AE=v.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:s=!1,textValue:r,...i}=t,o=g0(dp,n),a=CE(n),l=v.useRef(null),u=cs(e,l),[d,h]=v.useState(!1),[f,p]=v.useState("");return v.useEffect(()=>{const w=l.current;w&&p((w.textContent??"").trim())},[i.children]),c.jsx(Qu.ItemSlot,{scope:n,disabled:s,textValue:r??f,children:c.jsx(VF,{asChild:!0,...a,focusable:!s,children:c.jsx(Wn.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:u,onPointerMove:tt(t.onPointerMove,Xu(w=>{s?o.onItemLeave(w):(o.onItemEnter(w),w.defaultPrevented||w.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:tt(t.onPointerLeave,Xu(w=>o.onItemLeave(w))),onFocus:tt(t.onFocus,()=>h(!0)),onBlur:tt(t.onBlur,()=>h(!1))})})})}),Zz="MenuCheckboxItem",OE=v.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:s,...r}=t;return c.jsx($E,{scope:t.__scopeMenu,checked:n,children:c.jsx(Zp,{role:"menuitemcheckbox","aria-checked":hp(n)?"mixed":n,...r,ref:e,"data-state":b0(n),onSelect:tt(r.onSelect,()=>s==null?void 0:s(hp(n)?!0:!n),{checkForDefaultPrevented:!1})})})});OE.displayName=Zz;var ME="MenuRadioGroup",[e3,t3]=Ra(ME,{value:void 0,onValueChange:()=>{}}),IE=v.forwardRef((t,e)=>{const{value:n,onValueChange:s,...r}=t,i=pi(s);return c.jsx(e3,{scope:t.__scopeMenu,value:n,onValueChange:i,children:c.jsx(y0,{...r,ref:e})})});IE.displayName=ME;var DE="MenuRadioItem",LE=v.forwardRef((t,e)=>{const{value:n,...s}=t,r=t3(DE,t.__scopeMenu),i=n===r.value;return c.jsx($E,{scope:t.__scopeMenu,checked:i,children:c.jsx(Zp,{role:"menuitemradio","aria-checked":i,...s,ref:e,"data-state":b0(i),onSelect:tt(s.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});LE.displayName=DE;var v0="MenuItemIndicator",[$E,n3]=Ra(v0,{checked:!1}),FE=v.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:s,...r}=t,i=n3(v0,n);return c.jsx(Md,{present:s||hp(i.checked)||i.checked===!0,children:c.jsx(Wn.span,{...r,ref:e,"data-state":b0(i.checked)})})});FE.displayName=v0;var s3="MenuSeparator",zE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{role:"separator","aria-orientation":"horizontal",...s,ref:e})});zE.displayName=s3;var r3="MenuArrow",BE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=Jp(n);return c.jsx(TF,{...r,...s,ref:e})});BE.displayName=r3;var i3="MenuSub",[n7,UE]=Ra(i3),Jc="MenuSubTrigger",HE=v.forwardRef((t,e)=>{const n=Aa(Jc,t.__scopeMenu),s=Ld(Jc,t.__scopeMenu),r=UE(Jc,t.__scopeMenu),i=g0(Jc,t.__scopeMenu),o=v.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,u={__scopeMenu:t.__scopeMenu},d=v.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return v.useEffect(()=>d,[d]),v.useEffect(()=>{const h=a.current;return()=>{window.clearTimeout(h),l(null)}},[a,l]),c.jsx(p0,{asChild:!0,...u,children:c.jsx(AE,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":qE(n.open),...t,ref:Ta(e,r.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:tt(t.onPointerMove,Xu(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:tt(t.onPointerLeave,Xu(h=>{var p,w;d();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const y=(w=n.content)==null?void 0:w.dataset.side,x=y==="right",g=x?-5:5,m=f[x?"left":"right"],b=f[x?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+g,y:h.clientY},{x:m,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:m,y:f.bottom}],side:y}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:tt(t.onKeyDown,h=>{var p;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||Fz[s.dir].includes(h.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),h.preventDefault())})})})});HE.displayName=Jc;var WE="MenuSubContent",VE=v.forwardRef((t,e)=>{const n=EE(Us,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Aa(Us,t.__scopeMenu),o=Ld(Us,t.__scopeMenu),a=UE(WE,t.__scopeMenu),l=v.useRef(null),u=cs(e,l);return c.jsx(Qu.Provider,{scope:t.__scopeMenu,children:c.jsx(Md,{present:s||i.open,children:c.jsx(Qu.Slot,{scope:t.__scopeMenu,children:c.jsx(x0,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:tt(t.onFocusOutside,d=>{d.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:tt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:tt(t.onKeyDown,d=>{var p;const h=d.currentTarget.contains(d.target),f=zz[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(p=a.trigger)==null||p.focus(),d.preventDefault())})})})})})});VE.displayName=WE;function qE(t){return t?"open":"closed"}function hp(t){return t==="indeterminate"}function b0(t){return hp(t)?"indeterminate":t?"checked":"unchecked"}function o3(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function a3(t,e){return t.map((n,s)=>t[(e+s)%t.length])}function l3(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=a3(t,Math.max(i,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function c3(t,e){const{x:n,y:s}=t;let r=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],u=a.x,d=a.y,h=l.x,f=l.y;d>s!=f>s&&n<(h-u)*(s-d)/(f-d)+u&&(r=!r)}return r}function u3(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return c3(n,e)}function Xu(t){return e=>e.pointerType==="mouse"?t(e):void 0}var d3=NE,h3=p0,f3=TE,p3=PE,m3=y0,g3=RE,x3=Zp,y3=OE,v3=IE,b3=LE,w3=FE,k3=zE,_3=BE,S3=HE,j3=VE,em="DropdownMenu",[C3]=Ad(em,[jE]),Vn=jE(),[N3,KE]=C3(em),GE=t=>{const{__scopeDropdownMenu:e,children:n,dir:s,open:r,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=Vn(e),u=v.useRef(null),[d,h]=AN({prop:r,defaultProp:i??!1,onChange:o,caller:em});return c.jsx(N3,{scope:e,triggerId:xy(),triggerRef:u,contentId:xy(),open:d,onOpenChange:h,onOpenToggle:v.useCallback(()=>h(f=>!f),[h]),modal:a,children:c.jsx(d3,{...l,open:d,onOpenChange:h,dir:s,modal:a,children:n})})};GE.displayName=em;var YE="DropdownMenuTrigger",QE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...r}=t,i=KE(YE,n),o=Vn(n);return c.jsx(h3,{asChild:!0,...o,children:c.jsx(Wn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...r,ref:Ta(e,i.triggerRef),onPointerDown:tt(t.onPointerDown,a=>{!s&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:tt(t.onKeyDown,a=>{s||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});QE.displayName=YE;var E3="DropdownMenuPortal",XE=t=>{const{__scopeDropdownMenu:e,...n}=t,s=Vn(e);return c.jsx(f3,{...s,...n})};XE.displayName=E3;var JE="DropdownMenuContent",ZE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=KE(JE,n),i=Vn(n),o=v.useRef(!1);return c.jsx(p3,{id:r.contentId,"aria-labelledby":r.triggerId,...i,...s,ref:e,onCloseAutoFocus:tt(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:tt(t.onInteractOutside,a=>{const l=a.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;(!r.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ZE.displayName=JE;var T3="DropdownMenuGroup",P3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(m3,{...r,...s,ref:e})});P3.displayName=T3;var R3="DropdownMenuLabel",e2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(g3,{...r,...s,ref:e})});e2.displayName=R3;var A3="DropdownMenuItem",t2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(x3,{...r,...s,ref:e})});t2.displayName=A3;var O3="DropdownMenuCheckboxItem",M3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(y3,{...r,...s,ref:e})});M3.displayName=O3;var I3="DropdownMenuRadioGroup",D3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(v3,{...r,...s,ref:e})});D3.displayName=I3;var L3="DropdownMenuRadioItem",$3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(b3,{...r,...s,ref:e})});$3.displayName=L3;var F3="DropdownMenuItemIndicator",z3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(w3,{...r,...s,ref:e})});z3.displayName=F3;var B3="DropdownMenuSeparator",n2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(k3,{...r,...s,ref:e})});n2.displayName=B3;var U3="DropdownMenuArrow",H3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(_3,{...r,...s,ref:e})});H3.displayName=U3;var W3="DropdownMenuSubTrigger",V3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(S3,{...r,...s,ref:e})});V3.displayName=W3;var q3="DropdownMenuSubContent",K3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(j3,{...r,...s,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});K3.displayName=q3;var G3=GE,Y3=QE,Q3=XE,X3=ZE,J3=e2,Z3=t2,eB=n2;const tm=G3,nm=Y3,$d=ve.forwardRef(({className:t,sideOffset:e=8,...n},s)=>c.jsx(Q3,{children:c.jsx(X3,{ref:s,sideOffset:e,className:Pe("z-[90] min-w-[220px] overflow-hidden rounded-2xl p-1","bg-white/75 dark:bg-black/40 backdrop-blur-md shadow-soft2","ring-1 ring-black/5 dark:ring-white/10",t),...n})}));$d.displayName="DropdownMenuContent";const s2=ve.forwardRef(({className:t,...e},n)=>c.jsx(J3,{ref:n,className:Pe("px-3 py-2 text-xs text-black/60 dark:text-white/60",t),...e}));s2.displayName="DropdownMenuLabel";const fp=ve.forwardRef(({className:t,...e},n)=>c.jsx(eB,{ref:n,className:Pe("my-1 h-px bg-black/5 dark:bg-white/10",t),...e}));fp.displayName="DropdownMenuSeparator";const Ju=ve.forwardRef(({className:t,inset:e,...n},s)=>c.jsx(Z3,{ref:s,className:Pe("relative flex cursor-default select-none items-center gap-2 rounded-xl px-3 py-2 text-sm outline-none","text-black/90 dark:text-white/90","focus:bg-black/5 dark:focus:bg-white/10",e&&"pl-8",t),...n}));Ju.displayName="DropdownMenuItem";function An({className:t,variant:e="secondary",...n}){return c.jsx(se,{variant:e,size:"icon",className:Pe("rounded-xl h-8 w-8",t),...n})}function Cs({open:t,onClose:e,title:n,children:s,maxWidth:r="520px"}){if(!t)return null;const i=c.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm px-4 py-6 overflow-y-auto",children:c.jsx("div",{className:"w-full",style:{maxWidth:r},children:c.jsxs("div",{className:"rounded-2xl bg-white/90 dark:bg-neutral-900/95 shadow-2xl ring-1 ring-black/10 dark:ring-white/10 max-h-[85vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-black/5 dark:border-white/10",children:[c.jsx("div",{className:"text-sm font-semibold",children:n}),c.jsx("button",{className:"text-black/60 dark:text-white/60 hover:opacity-100 opacity-70",onClick:e,children:""})]}),c.jsx("div",{className:"p-4 overflow-y-auto",children:s})]})})});return typeof document>"u"?i:jd.createPortal(i,document.body)}function gc({open:t,onClose:e,onConfirm:n,message:s}){return t?c.jsx(Cs,{open:t,onClose:e,title:"Confirm",maxWidth:"420px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-black/70 dark:text-white/70",children:s||"Are you sure?"}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:n,children:"Confirm"})]})]})}):null}const r2=v.createContext(null);function w0(){const t=v.useContext(r2);if(!t)throw new Error("useNotifications must be used inside NotificationsProvider");return t}function tB({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function nB(){const t=Ed(),{notifications:e,unreadCount:n,clearAll:s,dismissNotification:r,markRead:i,formatTime:o}=w0(),[a,l]=v.useState(null),u=v.useMemo(()=>e.slice(0,6),[e]);return c.jsxs(c.Fragment,{children:[c.jsxs(tm,{children:[c.jsx(nm,{asChild:!0,children:c.jsxs("button",{className:"relative flex h-9 w-9 items-center justify-center rounded-2xl bg-black/5 dark:bg-white/10 text-black/80 dark:text-white/80 shadow-soft","aria-label":"Notifications",children:[c.jsx(DM,{size:18}),n?c.jsx("span",{className:"absolute -right-1 -top-1 min-w-[18px] rounded-full bg-rose-500 px-1 text-[11px] font-semibold leading-4 text-white",children:n>99?"99+":n}):null]})}),c.jsxs($d,{align:"end",className:"w-[320px] p-0 bg-white/90 dark:bg-neutral-900/85",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold",children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:e.length?`${e.length} total`:"No alerts"})]}),c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:s,disabled:!e.length,children:"Clear all"})]}),c.jsx(fp,{}),c.jsx("div",{className:"max-h-[320px] overflow-y-auto p-2 space-y-2",children:u.length?u.map(d=>c.jsx("div",{className:Pe("rounded-xl px-3 py-2 ring-1 transition-colors",d.read?"bg-white/50 dark:bg-white/5 ring-black/5 dark:ring-white/10":"bg-black/5 dark:bg-white/10 ring-black/10 dark:ring-white/20"),children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:d.title||"Notification"}),d.message?c.jsx("div",{className:"mt-0.5 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:d.message}):null,d.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:o(d.created_at)}):null]}),c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx(An,{variant:"ghost",className:"h-7 w-7",onClick:()=>r(d.id),"aria-label":"Dismiss notification",children:c.jsx(Xv,{size:14})}),c.jsx(An,{variant:"ghost",className:"h-7 w-7",onClick:()=>{i(d.id),l(d)},"aria-label":"View notification",children:c.jsx(QC,{size:14})})]})]})},d.id)):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 p-4 text-xs text-black/50 dark:text-white/60 text-center",children:"You're all caught up."})}),c.jsx(fp,{}),c.jsx("div",{className:"px-3 py-2",children:c.jsx(se,{variant:"secondary",className:"w-full rounded-2xl",onClick:()=>t("/app/notifications"),children:"View all notifications"})})]})]}),c.jsx(Cs,{open:!!a,onClose:()=>l(null),title:(a==null?void 0:a.title)||"Notification",maxWidth:"520px",children:c.jsx(tB,{notification:a})})]})}function zt({className:t,...e}){return c.jsx("div",{className:Pe("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 shadow-soft",t),...e})}function sB(){const{toasts:t,dismissToast:e,formatTime:n}=w0();return t.length?c.jsx("div",{className:"fixed right-6 top-24 z-50 flex w-[320px] flex-col gap-2",children:t.map(s=>{const r=s.notification;return c.jsx(zt,{className:"p-3 bg-white dark:bg-neutral-900 shadow-soft ring-1 ring-black/10 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:r.title||"Notification"}),r.message?c.jsx("div",{className:"mt-1 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:r.message}):null,r.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:n(r.created_at)}):null]}),c.jsx("button",{type:"button",className:"rounded-full p-1 text-black/50 hover:text-black/80 dark:text-white/50 dark:hover:text-white/80",onClick:()=>e(s.id),"aria-label":"Dismiss notification",children:c.jsx(Xv,{size:14})})]})},s.id)})}):null}async function rB(){return De("/api/modules/accessible",{method:"GET"})}async function iB({limit:t,offset:e=0,newestFirst:n=!1,signal:s}={}){const r=new URLSearchParams;t!=null&&r.set("limit",t),e>0&&r.set("offset",e),n&&r.set("newest_first","true");const i=r.toString();return De(`/api/sales/chat/history${i?`?${i}`:""}`,{signal:s})}async function oB(t,e=[]){return De("/api/sales/chat/attachments/refresh",{method:"POST",body:JSON.stringify({file_ids:t,prefetch_ids:e})})}async function aB({conversationId:t,message:e,fileIds:n,onEvent:s,onChunk:r,onDone:i,onError:o,signal:a}){try{const l=fc(),u=Pa.API_BASE_URL||"",d=await fetch(`${u}/api/sales/chat/stream`,{method:"POST",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}},body:JSON.stringify({message:e,conversation_id:t,...n!=null&&n.length?{file_ids:n}:{}}),signal:a});if(d.status===401){ai(),window.dispatchEvent(new CustomEvent("auth:logout")),o==null||o(new Error("Unauthorized"));return}if(!d.ok){const y=await d.json().catch(()=>({}));throw new Error(y.detail||`API error: ${d.status}`)}const h=d.body.getReader(),f=new TextDecoder;let p="",w=!1;for(;;){const{done:y,value:x}=await h.read();if(y)break;p+=f.decode(x,{stream:!0});const g=p.split(`
`);p=g.pop()||"";for(const m of g){const b=m.trim();if(!b.startsWith("data:"))continue;const k=b.replace(/^data:\s?/,"");if(!k||k==="[DONE]"){w=!0,i==null||i();continue}try{const _=JSON.parse(k);s==null||s(_),!s&&r&&(_.type==="chunk"||_.type==="content")&&r(_)}catch{const _={content:k};s==null||s(_),s||r==null||r(_)}}}w||i==null||i()}catch(l){throw o==null||o(l),l}}async function lB({requestId:t,eventIndex:e=0,onEvent:n,onDone:s,onError:r,onNotFound:i,signal:o}){try{const a=fc(),u=`${Pa.API_BASE_URL||""}/api/sales/chat/resume/${t}?event_index=${e}`,d=await fetch(u,{method:"GET",headers:{...a?{Authorization:`Bearer ${a}`}:{}},signal:o});if(d.status===401)return ai(),window.dispatchEvent(new CustomEvent("auth:logout")),r==null||r(new Error("Unauthorized")),{status:"error"};if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(f.detail||`API error: ${d.status}`)}const h=d.headers.get("content-type")||"";if(h.includes("application/json")){const f=await d.json();if(f.status==="not_found")return i==null||i(),{status:"not_found"};if(f.status==="completed"){for(const p of f.events||[])n==null||n(p);return s==null||s(),{status:"completed",events:f.events}}return f}else if(h.includes("text/event-stream")){const f=d.body.getReader(),p=new TextDecoder;let w="",y=!1;for(;;){const{done:x,value:g}=await f.read();if(x)break;w+=p.decode(g,{stream:!0});const m=w.split(`
`);w=m.pop()||"";for(const b of m){const k=b.trim();if(!k.startsWith("data:"))continue;const _=k.replace(/^data:\s?/,"");if(!_||_==="[DONE]"){y=!0,s==null||s();continue}try{const C=JSON.parse(_);n==null||n(C)}catch{}}}return y||s==null||s(),{status:"streaming_completed"}}return{status:"unknown"}}catch(a){return a.name==="AbortError"?{status:"aborted"}:(r==null||r(a),{status:"error",error:a.message})}}async function cB(t){const e=new FormData;return e.append("file",t),De("/api/sales/files/upload",{method:"POST",body:e})}async function uB(){return De("/api/assets/asset-types")}async function qk(t,{timeOfDay:e,side:n,venueType:s}={}){const r=new URLSearchParams;e&&r.set("time_of_day",e),n&&r.set("side",n),s&&r.set("venue_type",s);const i=Array.isArray(t)?t[0]:t;return i?De(`/api/sales/mockup/templates/${encodeURIComponent(i)}?${r.toString()}`):[]}async function dB(t){return De("/api/sales/mockup/save-frame",{method:"POST",body:t})}async function hB(t){return De("/api/sales/mockup/update-frame",{method:"PUT",body:t})}async function fB(t,e,{timeOfDay:n,side:s}={}){const r=new URLSearchParams;return r.set("photo_filename",e),n&&r.set("time_of_day",n),s&&r.set("side",s),De(`/api/sales/mockup/photo/${t}?${r.toString()}`,{method:"DELETE"})}async function pB({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),i&&o.set("photo_filename",i);const a=encodeURIComponent(e);return De(`/api/assets/mockup-frames/${t}/${a}/frame?${o.toString()}`)}async function mB({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e||!i)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),o.set("photo_filename",i);const a=encodeURIComponent(e);return De(`/api/assets/mockup-frames/${t}/${a}?${o.toString()}`,{method:"DELETE"})}async function gB(t){return EN("/api/sales/mockup/test-preview",{method:"POST",body:t})}async function xB(t){return De("/api/sales/mockup/generate",{method:"POST",body:t})}async function i2(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){if(!t||!e)return null;const o=new URLSearchParams;o.set("photo_filename",e),n&&o.set("time_of_day",n),s&&o.set("side",s),r&&o.set("company",r),i&&o.set("venue_type",i);const a=`/api/sales/mockup/photo/${t}?${o.toString()}`;return EN(a)}async function yB(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){const o=await i2(t,e,{timeOfDay:n,side:s,company:r,venueType:i});return o?URL.createObjectURL(o):""}async function o2(){return De("/api/sales/mockup/eligibility/setup")}async function a2(){return De("/api/sales/mockup/eligibility/generate")}async function vB({service:t,displayType:e}={}){const n=new URLSearchParams;t&&n.set("service",t),e&&n.set("display_type",e);const s=n.toString();return De(`/api/sales/locations${s?`?${s}`:""}`)}async function bB(t){return t?De(`/api/sales/locations/${encodeURIComponent(t)}`):null}async function wB(t){return De("/api/sales/proposals",{method:"POST",body:JSON.stringify(t)})}async function kB(){return De("/api/sales/proposals/history")}async function _B({limit:t=100,offset:e=0}={}){return De("/api/rbac/users")}async function SB(t){return De(`/api/rbac/user/${t}`)}async function jB(t){return De(`/api/rbac/users/${t}/permissions`)}async function CB(t){return De("/api/rbac/users",{method:"POST",body:JSON.stringify(t)})}async function NB(t,e){return De(`/api/rbac/users/${t}`,{method:"PUT",body:JSON.stringify(e)})}async function EB(t){return De(`/api/rbac/users/${encodeURIComponent(t)}/deactivate`,{method:"POST"})}async function TB(t){return De(`/api/rbac/users/${encodeURIComponent(t)}/reactivate`,{method:"POST"})}async function PB(){return De("/api/rbac/profiles")}async function RB(t){return De("/api/rbac/profiles",{method:"POST",body:JSON.stringify(t)})}async function AB(t,e){return De(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function OB(t){return De(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"DELETE"})}async function Kk(t,e){return De(`/api/rbac/users/${t}/permissions`,{method:"PUT",body:JSON.stringify({permissions:e})})}async function MB(){return await De("/api/rbac/permissions")}async function gg(t,e){return De("/api/rbac/permissions",{method:"POST",body:JSON.stringify({name:t,description:e})})}async function Gk(t){return De(`/api/rbac/permissions/${encodeURIComponent(t)}`,{method:"DELETE"})}async function IB(){const t=await De("/api/rbac/companies");return t.companies||t}async function DB(t){return De("/api/assets/companies",{method:"POST",body:JSON.stringify(t)})}async function LB(t,e){return De(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function $B(t){return De(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"DELETE"})}async function FB(){return De("/api/rbac/permission-sets")}async function zB(t){return De("/api/rbac/permission-sets",{method:"POST",body:JSON.stringify(t)})}async function BB(t,e){return De(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function UB(t){return De(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"DELETE"})}async function k0(){return De("/api/admin/service-visibility")}async function HB(t){return De("/api/admin/service-visibility",{method:"PUT",body:JSON.stringify(t)})}const _0="mmg-notifications",Fd="/api/notifications";function WB(t,e){if(!t)return e;try{return JSON.parse(t)}catch{return e}}function oo(){if(typeof window>"u")return[];const t=window.localStorage.getItem(_0),e=WB(t,[]);return Array.isArray(e)?e:[]}function sm(t){typeof window>"u"||window.localStorage.setItem(_0,JSON.stringify(t))}function Yk(t){const e=new Date().toISOString();return{id:(t==null?void 0:t.id)||(typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`ntf_${Date.now()}_${Math.random().toString(16).slice(2,8)}`),title:(t==null?void 0:t.title)||"Notification",message:(t==null?void 0:t.message)||"",created_at:(t==null?void 0:t.created_at)||e,read:!!(t!=null&&t.read),level:(t==null?void 0:t.level)||"info",meta:(t==null?void 0:t.meta)||{}}}function VB(t){return Array.isArray(t)?t:Array.isArray(t==null?void 0:t.notifications)?t.notifications:Array.isArray(t==null?void 0:t.data)?t.data:[]}function qB(){return De(Fd).then(t=>VB(t)).catch(()=>oo())}function KB(t){return De(Fd,{method:"POST",body:JSON.stringify(t||{})}).then(e=>(e==null?void 0:e.notification)||(e==null?void 0:e.data)||e||Yk(t)).catch(()=>{const e=oo(),n=Yk(t),s=[n,...e];return sm(s),n})}function GB(){return De(Fd,{method:"DELETE"}).then(()=>[]).catch(()=>(sm([]),[]))}function YB(t){return t?De(`${Fd}/${encodeURIComponent(t)}`,{method:"DELETE"}).then(()=>oo()).catch(()=>{const e=oo().filter(n=>n.id!==t);return sm(e),e}):Promise.resolve(oo())}function QB(t){return t?De(`${Fd}/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify({read:!0})}).then(()=>oo()).catch(()=>{const e=oo().map(n=>n.id===t?{...n,read:!0}:n);return sm(e),e}):Promise.resolve(oo())}const XB=_0;function Vs(t){if(!t||t==="NA")return null;if(t.includes("T")){const i=new Date(t);if(!Number.isNaN(i.getTime()))return i}const e=t.split(" "),n=e[0],s=e[1],r=n.split("-");if(r.length===3){const i=Number(r[0]),o=Number(r[1])-1,a=Number(r[2]);if(Number.isNaN(i)||Number.isNaN(o)||Number.isNaN(a))return null;if(s){const u=s.split(":"),d=Number(u[0]||0),h=Number(u[1]||0),f=Number(u[2]||0),p=new Date(a,o,i,d,h,f);return Number.isNaN(p.getTime())?null:p}const l=new Date(a,o,i);return l.setHours(0,0,0,0),Number.isNaN(l.getTime())?null:l}return null}function l2(t){var n;if(!((n=t==null?void 0:t.lifecycle)!=null&&n.length))return"";const e=t.lifecycle[t.lifecycle.length-1];return((e==null?void 0:e.stage)||"").toLowerCase()}function c2(t){const e={};return t.forEach(n=>{const s=n.videographer||n.Videographer||"Unassigned";e[s]||(e[s]=[]),e[s].push(n)}),e}function Oi(t){const e={pending:0,rejected:0,returned:0,submitted:0,accepted:0};return t.forEach(n=>{(n.versions||[]).forEach(s=>{const r=l2(s);r==="pending"||r==="critique"?e.pending+=1:r==="rejected"||r==="editing"?e.rejected+=1:r==="returned"?e.returned+=1:r==="submitted"||r==="submitted to sales"?e.submitted+=1:(r==="accepted"||r==="done")&&(e.accepted+=1)})}),e}function u2(t){const e=t.length,n=t.filter(a=>{const l=a.videographer||a.Videographer||"Unassigned";return l&&l!=="Unassigned"&&a.status!=="Not assigned yet"}).length;let s=0;t.forEach(a=>{s+=(a.versions||[]).length});const r=Oi(t),i=r.accepted+r.submitted+r.rejected+r.returned,o=i>0?Math.round((r.accepted+r.submitted)/i*100):0;return{total:e,assigned:n,uploads:s,pending:r.pending,rejected:r.rejected,returned:r.returned,submitted_to_sales:r.submitted,accepted_videos:r.accepted,accepted_pct:o}}function d2(t){const e=t.filter(n=>n.status==="Accepted"||n.status==="Done").length;return{completed:e,not_completed:t.length-e}}function JB(t){let e=0,n=0,s=0,r=0,i=0;t.forEach(d=>{(d.versions||[]).forEach(h=>{const f=h.lifecycle||[];if(f.length<2)return;let p=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="pending"||m==="critique"){p=Vs(g.at);break}}let w=null,y=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="rejected"||m==="editing"||m==="accepted"||m==="submitted"||m==="submitted to sales"){w=Vs(g.at),y=m;break}}if(!p||!w||!y)return;s+=1;const x=Math.round((w-p)/(1e3*60*60));if(e+=x,n+=1,y==="accepted"||y==="submitted"||y==="submitted to sales"){let g=!1,m=!1;f.forEach(b=>{const k=(b.stage||"").toLowerCase();(k==="accepted"||k==="done")&&(g=!0),k==="returned"&&(m=!0)}),g&&(r+=1),m&&(i+=1)}})});const o=n>0?Math.round(e/n):0,a=o>0?`${o} hrs`:"0 hrs",l=r+i,u=l>0?Math.round(r/l*100):0;return{avg_response_display:a,handled:s,accepted:r,handled_percent:u}}function h2(t){const e=c2(t),n={},s=new Date;return s.setHours(0,0,0,0),Object.entries(e).forEach(([r,i])=>{let o=0,a=0,l=0,u=0;i.forEach(p=>{(p.status==="Accepted"||p.status==="Done")&&(o+=1),a+=(p.versions||[]).length;const w=Vs(p.filming_deadline||p.filming_date||"");w&&w<=s&&(u+=1);const y=Vs(p.submission_date||"");y&&y<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(l+=1)});const d=Oi(i),h=d.accepted+d.submitted+d.rejected+d.returned,f=h>0?Math.round((d.accepted+d.submitted)/h*100):0;n[r]={total:i.length,started:u,late:l,completed:o,uploads:a,accepted_pct:f}}),n}function Zu(t,e){const n=[];return t.forEach(s=>{(s.versions||[]).forEach(r=>{const i=l2(r);(i==="submitted to sales"?"submitted":i)===e&&n.push({task:s,version:r,stage:i})})}),n}function xg(t,e){const n=[];return t.forEach(s=>{const r=[];(s.versions||[]).forEach(i=>{(i.lifecycle||[]).forEach(o=>{const a=(o.stage||"").toLowerCase();(e==="hod"&&(a==="rejected"||a==="editing")||e==="hos"&&a==="returned")&&r.push({version:i.version,event:o,stage:a})})}),r.length&&n.push({...s,rejectionEvents:r,rejectionCount:r.length})}),n}function f2(t){const e=Zu(t,"pending"),n=[];return e.forEach(({task:s,version:r})=>{let i=null;(r.lifecycle||[]).forEach(a=>{const l=(a.stage||"").toLowerCase();(l==="pending"||l==="critique")&&(i=Vs(a.at))});const o=i?Math.round((Date.now()-i.getTime())/(1e3*60*60)):null;n.push({task:s,version:r,uploadTime:i,waitingHours:o})}),{count:n.length,reviews:n}}function p2(t){const e=[];return t.forEach(n=>{(n.versions||[]).forEach(s=>{let r=null,i=null,o=null,a=null,l=null;if((s.lifecycle||[]).forEach(u=>{const d=(u.stage||"").toLowerCase();!r&&(d==="pending"||d==="critique")&&(r=Vs(u.at)),!i&&(d==="rejected"||d==="editing"||d==="accepted"||d==="submitted"||d==="submitted to sales")&&(i=Vs(u.at),o=d,a=u.rejection_class||null,l=u.rejection_comments||null)}),r&&i&&o){const u=Math.round((i-r)/36e5);e.push({task:n,version:s,responseHours:u,uploadTime:r,reviewTime:i,decision:o,rejectionClass:a,comments:l})}})}),e}function m2(t){const e=u2(t),n=d2(t),s=new Date;s.setHours(0,0,0,0);let r=0,i=0,o=0,a=0,l=0,u=0;t.forEach(p=>{const w=Vs(p.filming_deadline||p.filming_date||"");w&&w<=s&&(r+=1);const y=Vs(p.submission_date||"");y&&y<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(i+=1),(p.status==="Accepted"||p.status==="Done")&&(a+=1,o+=(p.versions||[]).length),(p.versions||[]).forEach(x=>{(x.lifecycle||[]).forEach(g=>{const m=(g.stage||"").toLowerCase();(m==="rejected"||m==="editing")&&(l+=1),m==="returned"&&(u+=1)})})});const d=a>0?(o/a).toFixed(2):"0",h=Zu(t,"pending"),f=Zu(t,"submitted");return{summary:e,pie:n,tasksStarted:r,lateTasks:i,pendingHOD:h.length,pendingHOS:f.length,rejectionsByHOD:l,rejectionsByHOS:u,uploadRatio:d}}function yg(t){const e=Vs(t.submission_date||"");if(!e)return!1;const n=new Date;return n.setHours(0,0,0,0),e<n&&t.status!=="Accepted"&&t.status!=="Done"}const br=[{task_number:2217,brand:"City Brand Launch",filming_deadline:"17-02-2025",submission_date:"20-02-2025",status:"Critique",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"18-02-2025 10:00:00"}]}]},{task_number:2216,brand:"Mall LED Loop",filming_deadline:"16-02-2025",submission_date:"19-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"17-02-2025 09:00:00"},{stage:"submitted to sales",at:"18-02-2025 11:30:00"}]}]},{task_number:2215,brand:"Festival Teaser",filming_deadline:"15-02-2025",submission_date:"18-02-2025",status:"Returned",videographer:"Alyssa Reed",location:"Abu Dhabi",versions:[{version:1,lifecycle:[{stage:"pending",at:"15-02-2025 10:00:00"},{stage:"submitted",at:"16-02-2025 12:00:00"},{stage:"returned",at:"17-02-2025 15:30:00",rejection_class:"Lighting",rejection_comments:"Exposure too dark",rejected_by:"Head of Sales"}]}]},{task_number:2214,brand:"Luxury Auto Montage",filming_deadline:"14-02-2025",submission_date:"17-02-2025",status:"Editing",videographer:"Noah Chen",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"14-02-2025 09:30:00"},{stage:"rejected",at:"15-02-2025 12:10:00",rejection_class:"Artwork Color",rejection_comments:"Incorrect color profile",rejected_by:"Reviewer"}]}]},{task_number:2213,brand:"Airport Arrival Hero",filming_deadline:"12-02-2025",submission_date:"15-02-2025",status:"Accepted",videographer:"Noah Chen",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"12-02-2025 10:00:00"},{stage:"submitted to sales",at:"13-02-2025 15:00:00"},{stage:"accepted",at:"14-02-2025 12:00:00"}]}]},{task_number:2212,brand:"Retail Weekend Promo",filming_deadline:"10-02-2025",submission_date:"13-02-2025",status:"Done",videographer:"Ravi Sharma",location:"Ajman",versions:[{version:1,lifecycle:[{stage:"pending",at:"10-02-2025 10:00:00"},{stage:"submitted",at:"11-02-2025 14:00:00"},{stage:"done",at:"12-02-2025 10:00:00"}]}]},{task_number:2211,brand:"Harbor Night Loop",filming_deadline:"18-02-2025",submission_date:"21-02-2025",status:"Editing",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"16-02-2025 11:00:00"},{stage:"editing",at:"17-02-2025 13:00:00",rejection_class:"Environment Too Dark",rejection_comments:"Please brighten the surrounding scene",rejected_by:"Reviewer"}]}]},{task_number:2210,brand:"City Center Countdown",filming_deadline:"22-02-2025",submission_date:"25-02-2025",status:"Assigned to Alyssa",videographer:"Alyssa Reed",location:"Dubai",versions:[]},{task_number:2209,brand:"Expo Walkthrough",filming_deadline:"24-02-2025",submission_date:"27-02-2025",status:"Not assigned yet",videographer:"Unassigned",location:"Abu Dhabi",versions:[]},{task_number:2208,brand:"Weekend Highlights",filming_deadline:"13-02-2025",submission_date:"16-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"13-02-2025 09:00:00"},{stage:"rejected",at:"14-02-2025 10:30:00",rejection_class:"Lighting",rejection_comments:"Flicker in the panel",rejected_by:"Reviewer"}]},{version:2,lifecycle:[{stage:"pending",at:"15-02-2025 12:15:00"},{stage:"submitted",at:"16-02-2025 14:40:00"}]}]}],ZB={session_id:"vc-session-01",messages:[{id:"vc-msg-1",role:"assistant",content:"Good morning. Upload a cut or describe the request, and I will log the critique, checklist, and next steps.",timestamp:"2025-02-18T08:40:12+04:00"}],message_count:1,last_updated:"2025-02-18T08:40:12+04:00"},e4=[{workflow_id:"workflow-2217",task_number:2217,folder_name:"City Brand Launch",status:"pending_reviewer",created_at:"2025-02-18T09:10:00+04:00",reviewer_approved:!1,hos_approved:!1}];function pr(t){return new Promise(e=>setTimeout(e,t))}function t4(t,e){const n=[];let s=0;for(;s<t.length;)n.push(t.slice(s,s+e)),s+=e;return n}function S0(t,e){const n=(t||"").trim();return[`${n?`Thanks for the details on "${n}".`:"Thanks for the upload."} ${e?"I reviewed the file and captured the critique highlights below:":"Here is a quick critique outline to confirm before I log the request:"}`,"","- Narrative clarity: tighten the opening 3 seconds.","- Visual hierarchy: spotlight the primary CTA earlier.","- Audio mix: reduce music by about 3dB under VO.","- Export: keep 1080x1920, 29.97fps.","","Reply with any edits or confirm if I should submit to the reviewer."].join(`
`)}function n4(t){return[{action_id:"approve_reviewer",label:"Approve",workflow_id:t,variant:"secondary"},{action_id:"reject_reviewer",label:"Reject",workflow_id:t,variant:"ghost"}]}function s4(t){let e=!1;return t&&(t.aborted?e=!0:t.addEventListener("abort",()=>{e=!0},{once:!0})),()=>e}function r4(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function i4(){const t=u2(br),e=d2(br),n=JB(br),s=h2(br),r=c2(br),i=m2(br),o=Oi(br),a=f2(br),l=p2(br);return{mode:"month",period:"2025-02",tasks:br,summary:t,pie:e,reviewer:n,summary_videographers:s,videographers:r,quick_stats:i,status_counts:o,pending_reviews:a,response_times:l}}async function o4({mode:t,period:e}={}){return await pr(240),{...i4(),mode:t||"month",period:e||"2025-02"}}async function a4(){return await pr(200),ZB}async function l4({file:t,message:e,sessionId:n}){await pr(200);const s=n||`vc-session-${Date.now()}`,r=`vc-file-${Date.now()}`;return r4(t)?{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",type:"video",message:"Video received. Which task number is this for?",session_id:s}:{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",file_url:URL.createObjectURL(t),type:"image",response:S0(e,!0),session_id:s,timestamp:new Date().toISOString()}}async function c4({file:t}){return await pr(200),{file_id:`vc-asset-${Date.now()}`,filename:(t==null?void 0:t.name)||"attachment",file_url:URL.createObjectURL(t)}}async function u4({file:t,taskNumber:e}){return await pr(260),{success:!0,file_id:`vc-video-${Date.now()}`,workflow_id:`workflow-${Date.now()}`,version:1,message:`Video uploaded successfully (v1) for task #${e}`}}async function d4({command:t,args:e,sessionId:n}){await pr(200);const s=n||`vc-session-${Date.now()}`,r=(t||"").toLowerCase(),i=(e||"").trim();return r?r==="help"?{success:!0,command:r,response:`**Video Critique Commands**

- /log or /design - Start a new design request
- /recent - Export recent task data
- /edit <task_number> - Edit an existing task
- /delete <task_number> - Delete a task

You can also paste briefs or upload images/videos.`,session_id:s}:r==="log"||r==="design"?{success:!0,command:r,response:S0(i||"I want to log a design request",!1),session_id:s}:r==="edit"?{success:!0,command:r,response:i?"Editing task "+i+". Which fields should I update?":"Please provide a task number: /edit <task_number>",session_id:s}:r==="delete"?{success:!0,command:r,response:i?"Delete request queued for task "+i+". Confirm to proceed.":"Please provide a task number: /delete <task_number>",session_id:s}:r==="recent"?{success:!0,command:r,response:"Preparing the latest export. I will send the download link shortly.",session_id:s}:{success:!1,command:r,error:"Unknown command: /"+r+". Use /help for available commands.",session_id:s}:{success:!1,command:"",error:"Unknown command: /. Use /help for available commands.",session_id:s}}async function h4({actionId:t,workflowId:e}){return await pr(200),t==="reject_reviewer"||t==="return_hos"?{success:!0,message:"Please provide rejection details.",requires_form:!0,form_type:t==="return_hos"?"return":"rejection",workflow_id:e}:{success:!0,message:`Action ${t} applied for ${e}.`}}async function f4({formType:t,workflowId:e}){return await pr(200),{success:!0,message:`${t} submitted for ${e}.`}}async function p4(t){return await pr(120),t==="return"?{title:"Return for Revision",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be revised..."}]}:{title:"Reject Video",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be fixed..."}]}}function m4(t){return t!=null&&t.preview_url?t.preview_url:t!=null&&t.file_url?t.file_url:t!=null&&t.url?t.url:null}async function g4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){const a=s4(o);try{const l=t||`vc-session-${Date.now()}`;if(a()||(await pr(180),a()))return;const u=S0(e,!1),d=t4(u,48);for(const h of d){if(a())return;s==null||s({type:"delta",content:h}),await pr(90)}if(a())return;s==null||s({type:"text_done",content:u}),n!=null&&n.length&&(s==null||s({type:"files",files:n.map((h,f)=>({file_id:h,filename:f===0?"Brief.pdf":`Attachment-${f+1}.pdf`,file_url:`https://example.com/mock-${h}.pdf`}))})),(e||"").toLowerCase().includes("approval")&&(s==null||s({type:"actions",actions:n4(e4[0].workflow_id)})),s==null||s({type:"done",session_id:l}),r==null||r()}catch(l){throw s==null||s({type:"error",message:(l==null?void 0:l.message)||"Stream failed"}),i==null||i(l),l}}async function x4(t){return o4(t)}async function y4(){return a4()}async function v4({file:t,message:e,sessionId:n}){return l4({file:t,message:e,sessionId:n})}async function b4({file:t}){return c4({file:t})}async function Qk({file:t,taskNumber:e}){return u4({file:t,taskNumber:e})}async function w4({command:t,args:e,sessionId:n}){return d4({command:t,args:e,sessionId:n})}async function k4({actionId:t,workflowId:e}){return h4({actionId:t,workflowId:e})}async function _4({formType:t,workflowId:e,category:n,reason:s}){return f4({formType:t,workflowId:e})}async function S4(t){return p4(t)}function j4(t){return m4(t)}async function C4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){return g4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o})}function zd(t,e,n){Array.isArray(n)&&n.filter(Boolean).forEach(s=>t.append(e,s))}async function N4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;zd(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return De(`/api/assets/networks${s?`?${s}`:""}`)}async function E4({companies:t,networkId:e,activeOnly:n=!0}={}){const s=new URLSearchParams;zd(s,"companies",t),e!=null&&s.set("network_id",String(e)),n!==void 0&&s.set("active_only",String(n));const r=s.toString();return De(`/api/assets/asset-types${r?`?${r}`:""}`)}async function T4({companies:t,networkId:e,typeId:n,activeOnly:s=!0}={}){const r=new URLSearchParams;zd(r,"companies",t),e!=null&&r.set("network_id",String(e)),n!=null&&r.set("type_id",String(n)),s!==void 0&&r.set("active_only",String(s));const i=r.toString();return De(`/api/assets/network-assets${i?`?${i}`:""}`)}async function P4({companies:t,networkId:e,typeId:n,activeOnly:s=!0,includeEligibility:r=!1}={}){const i=new URLSearchParams;zd(i,"companies",t),e!=null&&i.set("network_id",String(e)),n!=null&&i.set("type_id",String(n)),s!==void 0&&i.set("active_only",String(s)),r!==void 0&&i.set("include_eligibility",String(r));const o=i.toString();return De(`/api/assets/locations${o?`?${o}`:""}`)}async function R4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;zd(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return De(`/api/assets/packages${s?`?${s}`:""}`)}const A4={chat:"chat",video_critique:"video_critique",mockup:["mockup_setup","mockup_generate"],proposals:"proposals",asset_management:"asset_management"},Sy={chat:{to:"/app/chat",label:"AI Chat Assistant",icon:UM},video_critique:{to:"/app/video-critique",label:"Video Critique",icon:xf},mockup:{to:"/app/mockup",label:"Mockup Assistant",icon:zM},proposals:{to:"/app/proposals",label:"Proposal Assistant",icon:VM},admin:{to:"/app/admin",label:"Admin",icon:KM},asset_management:{to:"/app/asset-management",label:"Asset Management",icon:WM},settings:{to:"/app/settings",label:"Settings",icon:ZC}},O4=["chat","mockup","proposals","video_critique","admin","asset_management","settings"];function M4(t){return t.includes("/app/video-critique")?"Video Critique":t.includes("/app/chat")?"AI Chat Assistant":t.includes("/app/mockup")?"Mockup Assistant":t.includes("/app/proposals")?"Proposal Assistant":t.includes("/app/notifications")?"Notifications":t.includes("/app/admin")?"Admin Panel":t.includes("/app/asset-management")?"Asset Management":t.includes("/app/settings")?"Settings":"Workspace"}function I4(t){const e=[{name:"sales",tools:["chat","video_critique","mockup","proposals"],sort_order:1}];return Rd(t)&&e.push({name:"core",tools:["admin"],sort_order:100}),e}function D4(t,e){var a;const s=[...((a=t==null?void 0:t.modules)!=null&&a.length?t.modules:I4(e))||[]].sort((l,u)=>(l.sort_order||0)-(u.sort_order||0)),r=new Set;s.forEach(l=>{(l.tools||[]).forEach(u=>{r.add(u==="ai_costs"?"costs":u)})}),r.has("chat")&&r.add("video_critique"),Rd(e)&&(r.add("admin"),r.add("asset_management")),r.add("settings");const i=[],o=new Set;return O4.forEach(l=>{if(!r.has(l))return;const u=Sy[l];u&&!o.has(u.to)&&(o.add(u.to),i.push(u))}),i}function L4(t,e){if(!e)return!0;const n=A4[t];return n?Array.isArray(n)?n.some(s=>e[s]!==!1):e[n]!==!1:!0}function $4(){const{user:t,logout:e,authReady:n}=fi(),s=uc(),r=Ed(),[i,o]=v.useState(!1),[a,l]=v.useState(!1),u=Kt({queryKey:["modules","accessible"],queryFn:rB}),d=Kt({queryKey:["service-visibility"],queryFn:k0,staleTime:3e4}),h=v.useMemo(()=>((t==null?void 0:t.name)||"User").split(" ").slice(0,2).map(g=>g[0]).join("").toUpperCase(),[t]),f=v.useMemo(()=>D4(u.data,t),[u.data,t]),p=x=>{const g=d.data,m=Object.keys(Sy).find(b=>Sy[b].to===x.to);return L4(m,g)},w=!d.isLoading||d.data||d.isError;return!n||!w?c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ve,{text:"Loading"})})}):c.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[c.jsx("header",{className:"sticky top-0 z-40",children:c.jsx("div",{className:"w-full px-6 lg:px-10",children:c.jsx("div",{className:"mmg-header-card mt-4 rounded-2xl bg-white/65 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 gap-3",children:[c.jsxs("div",{className:"flex items-end gap-3",children:[c.jsx(j5,{size:64}),c.jsx("div",{className:"hidden sm:block text-sm leading-none text-black/50 dark:text-white/60 relative -top-px",children:"|"}),c.jsx("div",{className:"hidden sm:block text-sm font-medium leading-none text-black/70 dark:text-white/70",children:M4(s.pathname)})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl lg:hidden",onClick:()=>l(!0),title:"Open sidebar","aria-label":"Open sidebar",children:c.jsx(qm,{size:18})}),c.jsx(nB,{}),c.jsx(RN,{}),c.jsxs(tm,{children:[c.jsx(nm,{asChild:!0,children:c.jsxs("button",{className:"flex items-center gap-2 rounded-2xl px-2.5 py-1.5 hover:bg-black/5 dark:hover:bg-white/10 transition-colors","aria-label":"User menu",children:[c.jsx("div",{className:"h-9 w-9 rounded-2xl bg-black/5 dark:bg-white/10 flex items-center justify-center shadow-soft",children:c.jsx("span",{className:"text-xs font-semibold",children:h})}),c.jsxs("div",{className:"hidden sm:flex flex-col items-start leading-tight",children:[c.jsx("span",{className:"mmg-brand-gold text-sm font-medium",children:t==null?void 0:t.name}),c.jsx("span",{className:"text-xs text-black/50 dark:text-white/60",children:t==null?void 0:t.email})]})]})}),c.jsxs($d,{align:"end",children:[c.jsx(s2,{children:c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("span",{className:"truncate",children:t==null?void 0:t.email}),c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:((t==null?void 0:t.roles)||[]).join(" | ")})]})}),c.jsx(fp,{}),c.jsxs(Ju,{onSelect:()=>r("/app/settings"),children:[c.jsx(ZC,{size:16}),"Settings"]}),c.jsxs(Ju,{onSelect:()=>{e(),r("/")},children:[c.jsx(BM,{size:16}),"Logout"]})]})]})]})]})})})}),c.jsx(sB,{}),c.jsx("div",{className:"w-full px-6 lg:px-10 pb-4 flex-1 flex overflow-hidden min-w-0",children:c.jsxs("div",{className:Pe("mt-4 grid grid-cols-1 gap-4 lg:grid-cols-[280px_1fr] flex-1 min-h-0 min-w-0","transition-[grid-template-columns] duration-500",i&&"lg:grid-cols-[64px_1fr] 2xl:grid-cols-[72px_1fr]"),children:[c.jsxs("aside",{className:Pe("hidden lg:block rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10","overflow-hidden"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:Pe("text-s ms-3 font-semibold tracking-wide text-black/50 dark:text-white/60",i&&"hidden lg:block lg:sr-only"),children:"Tools"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>o(x=>!x),title:"Toggle sidebar","aria-label":"Toggle sidebar",children:c.jsx(qm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-2",children:f.map(x=>{const g=s.pathname===x.to||s.pathname.startsWith(`${x.to}/`),m=x.icon,b=p(x);return c.jsx("div",{className:Pe("mmg-nav-item",!b&&"mmg-nav-item-hidden"),children:c.jsxs("button",{onClick:()=>r(x.to),className:Pe("mmg-nav-btn w-full flex items-center gap-3 rounded-2xl p-2 text-sm transition-colors mb-1.5 shadow-soft",g?"mmg-nav-btn-active":"","text-base",i&&"lg:justify-center lg:gap-0"),tabIndex:b?0:-1,children:[c.jsx("span",{className:"mmg-nav-icon h-8 w-8 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(m,{size:22})}),c.jsx("span",{className:Pe("min-w-0 truncate",i&&"hidden"),children:x.label})]})},x.to)})}),c.jsx("div",{className:"px-3 pb-3 pt-1",children:c.jsx("div",{className:Pe("h-px bg-black/5 dark:bg-white/10",i&&"lg:mx-auto lg:w-10")})})]}),c.jsx("main",{className:"min-h-0 min-w-0 h-full",children:c.jsx(WO,{})})]})}),c.jsxs("div",{className:Pe("fixed inset-0 z-50 lg:hidden",a?"pointer-events-auto":"pointer-events-none"),children:[c.jsx("div",{className:Pe("absolute inset-0 bg-black/40 transition-opacity",a?"opacity-100":"opacity-0"),onClick:()=>l(!1)}),c.jsxs("aside",{className:Pe("absolute inset-y-0 left-0 w-72 max-w-full rounded-r-2xl bg-white/90 dark:bg-neutral-900/95","backdrop-blur-xl shadow-2xl ring-1 ring-black/10 dark:ring-white/10","transition-transform duration-200",a?"translate-x-0":"-translate-x-full"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:"text-sm font-semibold tracking-wide text-black/60 dark:text-white/70",children:"Tools"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>l(!1),title:"Close sidebar","aria-label":"Close sidebar",children:c.jsx(qm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-3",children:f.map(x=>{const g=s.pathname===x.to||s.pathname.startsWith(`${x.to}/`),m=x.icon,b=p(x);return c.jsx("div",{className:Pe("mmg-nav-item",!b&&"mmg-nav-item-hidden"),children:c.jsxs("button",{onClick:()=>{r(x.to),l(!1)},className:Pe("mmg-nav-btn w-full flex items-center gap-2.5 rounded-2xl p-2.5 text-sm transition-colors mb-1.5 shadow-soft",g?"mmg-nav-btn-active":"","text-sm"),tabIndex:b?0:-1,children:[c.jsx("span",{className:"mmg-nav-icon h-9 w-9 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(m,{size:20})}),c.jsx("span",{className:"min-w-0 truncate",children:x.label})]})},x.to)})})]})]})]})}const rm=0,ko=1,xc=2,g2=4;function Xk(t){return()=>t}function F4(t){t()}function x2(t,e){return n=>t(e(n))}function Jk(t,e){return()=>t(e)}function z4(t,e){return n=>t(e,n)}function j0(t){return t!==void 0}function B4(...t){return()=>{t.map(F4)}}function yc(){}function im(t,e){return e(t),t}function U4(t,e){return e(t)}function At(...t){return t}function dt(t,e){return t(ko,e)}function Ye(t,e){t(rm,e)}function C0(t){t(xc)}function It(t){return t(g2)}function Ae(t,e){return dt(t,z4(e,rm))}function ur(t,e){const n=t(ko,s=>{n(),e(s)});return n}function Zk(t){let e,n;return s=>r=>{e=r,n&&clearTimeout(n),n=setTimeout(()=>{s(e)},t)}}function y2(t,e){return t===e}function Pt(t=y2){let e;return n=>s=>{t(e,s)||(e=s,n(s))}}function He(t){return e=>n=>{t(n)&&e(n)}}function _e(t){return e=>x2(e,t)}function Pr(t){return e=>()=>{e(t)}}function le(t,...e){const n=H4(...e);return(s,r)=>{switch(s){case xc:C0(t);return;case ko:return dt(t,n(r))}}}function Ir(t,e){return n=>s=>{n(e=t(e,s))}}function _a(t){return e=>n=>{t>0?t--:e(n)}}function ri(t){let e=null,n;return s=>r=>{e=r,!n&&(n=setTimeout(()=>{n=void 0,s(e)},t))}}function Qe(...t){const e=new Array(t.length);let n=0,s=null;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);dt(i,l=>{const u=n;n=n|a,e[o]=l,u!==r&&n===r&&s&&(s(),s=null)})}),i=>o=>{const a=()=>{i([o].concat(e))};n===r?a():s=a}}function H4(...t){return e=>t.reduceRight(U4,e)}function W4(t){let e,n;const s=()=>e==null?void 0:e();return function(r,i){switch(r){case ko:return i?n===i?void 0:(s(),n=i,e=dt(t,i),e):(s(),yc);case xc:s(),n=null;return}}}function ge(t){let e=t;const n=et();return(s,r)=>{switch(s){case rm:e=r;break;case ko:{r(e);break}case g2:return e}return n(s,r)}}function Rn(t,e){return im(ge(e),n=>Ae(t,n))}function et(){const t=[];return(e,n)=>{switch(e){case rm:t.slice().forEach(s=>{s(n)});return;case xc:t.splice(0,t.length);return;case ko:return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}}}function Ns(t){return im(et(),e=>Ae(t,e))}function at(t,e=[],{singleton:n}={singleton:!0}){return{constructor:t,dependencies:e,id:V4(),singleton:n}}const V4=()=>Symbol();function q4(t){const e=new Map,n=({constructor:s,dependencies:r,id:i,singleton:o})=>{if(o&&e.has(i))return e.get(i);const a=s(r.map(l=>n(l)));return o&&e.set(i,a),a};return n(t)}function nn(...t){const e=et(),n=new Array(t.length);let s=0;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);dt(i,l=>{n[o]=l,s=s|a,s===r&&Ye(e,n)})}),function(i,o){switch(i){case xc:{C0(e);return}case ko:return s===r&&o(n),dt(e,o)}}}function Ue(t,e=y2){return le(t,Pt(e))}function jy(...t){return function(e,n){switch(e){case xc:return;case ko:return B4(...t.map(s=>dt(s,n)))}}}var ls=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t))(ls||{});const K4={0:"debug",3:"error",1:"log",2:"warn"},G4=()=>typeof globalThis>"u"?window:globalThis,_o=at(()=>{const t=ge(3);return{log:ge((e,n,s=1)=>{var r;const i=(r=G4().VIRTUOSO_LOG_LEVEL)!=null?r:It(t);s>=i&&console[K4[s]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,n)}),logLevel:t}},[],{singleton:!0});function Oa(t,e,n){return N0(t,e,n).callbackRef}function N0(t,e,n){const s=ve.useRef(null);let r=o=>{};const i=ve.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const a=()=>{const l=o[0].target;l.offsetParent!==null&&t(l)};n?a():requestAnimationFrame(a)}):null,[t,n]);return r=o=>{o&&e?(i==null||i.observe(o),s.current=o):(s.current&&(i==null||i.unobserve(s.current)),s.current=null)},{callbackRef:r,ref:s}}function Y4(t,e,n,s,r,i,o,a,l){const u=ve.useCallback(d=>{const h=Q4(d.children,e,a?"offsetWidth":"offsetHeight",r);let f=d.parentElement;for(;!f.dataset.virtuosoScroller;)f=f.parentElement;const p=f.lastElementChild.dataset.viewportType==="window";let w;p&&(w=f.ownerDocument.defaultView);const y=o?a?o.scrollLeft:o.scrollTop:p?a?w.scrollX||w.document.documentElement.scrollLeft:w.scrollY||w.document.documentElement.scrollTop:a?f.scrollLeft:f.scrollTop,x=o?a?o.scrollWidth:o.scrollHeight:p?a?w.document.documentElement.scrollWidth:w.document.documentElement.scrollHeight:a?f.scrollWidth:f.scrollHeight,g=o?a?o.offsetWidth:o.offsetHeight:p?a?w.innerWidth:w.innerHeight:a?f.offsetWidth:f.offsetHeight;s({scrollHeight:x,scrollTop:Math.max(y,0),viewportHeight:g}),i==null||i(a?e_("column-gap",getComputedStyle(d).columnGap,r):e_("row-gap",getComputedStyle(d).rowGap,r)),h!==null&&t(h)},[t,e,r,i,o,s,a]);return N0(u,n,l)}function Q4(t,e,n,s){const r=t.length;if(r===0)return null;const i=[];for(let o=0;o<r;o++){const a=t.item(o);if(a.dataset.index===void 0)continue;const l=parseInt(a.dataset.index),u=parseFloat(a.dataset.knownSize),d=e(a,n);if(d===0&&s("Zero-sized element, this should not happen",{child:a},ls.ERROR),d===u)continue;const h=i[i.length-1];i.length===0||h.size!==d||h.endIndex!==l-1?i.push({endIndex:l,size:d,startIndex:l}):i[i.length-1].endIndex++}return i}function e_(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,ls.WARN),e==="normal"?0:parseInt(e??"0",10)}function v2(t,e,n){const s=ve.useRef(null),r=ve.useCallback(l=>{if(!(l!=null&&l.offsetParent))return;const u=l.getBoundingClientRect(),d=u.width;let h,f;if(e){const p=e.getBoundingClientRect(),w=u.top-p.top;f=p.height-Math.max(0,w),h=w+e.scrollTop}else{const p=o.current.ownerDocument.defaultView;f=p.innerHeight-Math.max(0,u.top),h=u.top+p.scrollY}s.current={offsetTop:h,visibleHeight:f,visibleWidth:d},t(s.current)},[t,e]),{callbackRef:i,ref:o}=N0(r,!0,n),a=ve.useCallback(()=>{r(o.current)},[r,o]);return ve.useEffect(()=>{var l;if(e){e.addEventListener("scroll",a);const u=new ResizeObserver(()=>{requestAnimationFrame(a)});return u.observe(e),()=>{e.removeEventListener("scroll",a),u.unobserve(e)}}else{const u=(l=o.current)==null?void 0:l.ownerDocument.defaultView;return u==null||u.addEventListener("scroll",a),u==null||u.addEventListener("resize",a),()=>{u==null||u.removeEventListener("scroll",a),u==null||u.removeEventListener("resize",a)}}},[a,e,o]),i}const qn=at(()=>{const t=et(),e=et(),n=ge(0),s=et(),r=ge(0),i=et(),o=et(),a=ge(0),l=ge(0),u=ge(0),d=ge(0),h=et(),f=et(),p=ge(!1),w=ge(!1),y=ge(!1);return Ae(le(t,_e(({scrollTop:x})=>x)),e),Ae(le(t,_e(({scrollHeight:x})=>x)),o),Ae(e,r),{deviation:n,fixedFooterHeight:u,fixedHeaderHeight:l,footerHeight:d,headerHeight:a,horizontalDirection:w,scrollBy:f,scrollContainerState:t,scrollHeight:o,scrollingInProgress:p,scrollTo:h,scrollTop:e,skipAnimationFrameInResizeObserver:y,smoothScrollTargetReached:s,statefulScrollTop:r,viewportHeight:i}},[],{singleton:!0}),ed={lvl:0};function b2(t,e){const n=t.length;if(n===0)return[];let{index:s,value:r}=e(t[0]);const i=[];for(let o=1;o<n;o++){const{index:a,value:l}=e(t[o]);i.push({end:a-1,start:s,value:r}),s=a,r=l}return i.push({end:1/0,start:s,value:r}),i}function bt(t){return t===ed}function td(t,e){if(!bt(t))return e===t.k?t.v:e<t.k?td(t.l,e):td(t.r,e)}function mr(t,e,n="k"){if(bt(t))return[-1/0,void 0];if(Number(t[n])===e)return[t.k,t.v];if(Number(t[n])<e){const s=mr(t.r,e,n);return s[0]===-1/0?[t.k,t.v]:s}return mr(t.l,e,n)}function ks(t,e,n){return bt(t)?_2(e,n,1):e===t.k?ln(t,{k:e,v:n}):e<t.k?t_(ln(t,{l:ks(t.l,e,n)})):t_(ln(t,{r:ks(t.r,e,n)}))}function Rl(){return ed}function Al(t,e,n){if(bt(t))return[];const s=mr(t,e)[0];return X4(Ny(t,s,n))}function Cy(t,e){if(bt(t))return ed;const{k:n,l:s,r}=t;if(e===n){if(bt(s))return r;if(bt(r))return s;{const[i,o]=k2(s);return _f(ln(t,{k:i,l:w2(s),v:o}))}}else return e<n?_f(ln(t,{l:Cy(s,e)})):_f(ln(t,{r:Cy(r,e)}))}function Xo(t){return bt(t)?[]:[...Xo(t.l),{k:t.k,v:t.v},...Xo(t.r)]}function Ny(t,e,n){if(bt(t))return[];const{k:s,l:r,r:i,v:o}=t;let a=[];return s>e&&(a=a.concat(Ny(r,e,n))),s>=e&&s<=n&&a.push({k:s,v:o}),s<=n&&(a=a.concat(Ny(i,e,n))),a}function _f(t){const{l:e,lvl:n,r:s}=t;if(s.lvl>=n-1&&e.lvl>=n-1)return t;if(n>s.lvl+1){if(vg(e))return S2(ln(t,{lvl:n-1}));if(!bt(e)&&!bt(e.r))return ln(e.r,{l:ln(e,{r:e.r.l}),lvl:n,r:ln(t,{l:e.r.r,lvl:n-1})});throw new Error("Unexpected empty nodes")}else{if(vg(t))return Ey(ln(t,{lvl:n-1}));if(!bt(s)&&!bt(s.l)){const r=s.l,i=vg(r)?s.lvl-1:s.lvl;return ln(r,{l:ln(t,{lvl:n-1,r:r.l}),lvl:r.lvl+1,r:Ey(ln(s,{l:r.r,lvl:i}))})}else throw new Error("Unexpected empty nodes")}}function ln(t,e){return _2(e.k!==void 0?e.k:t.k,e.v!==void 0?e.v:t.v,e.lvl!==void 0?e.lvl:t.lvl,e.l!==void 0?e.l:t.l,e.r!==void 0?e.r:t.r)}function w2(t){return bt(t.r)?t.l:_f(ln(t,{r:w2(t.r)}))}function vg(t){return bt(t)||t.lvl>t.r.lvl}function k2(t){return bt(t.r)?[t.k,t.v]:k2(t.r)}function _2(t,e,n,s=ed,r=ed){return{k:t,l:s,lvl:n,r,v:e}}function t_(t){return Ey(S2(t))}function S2(t){const{l:e}=t;return!bt(e)&&e.lvl===t.lvl?ln(e,{r:ln(t,{l:e.r})}):t}function Ey(t){const{lvl:e,r:n}=t;return!bt(n)&&!bt(n.r)&&n.lvl===e&&n.r.lvl===e?ln(n,{l:ln(t,{r:n.l}),lvl:e+1}):t}function X4(t){return b2(t,({k:e,v:n})=>({index:e,value:n}))}function j2(t,e){return!!(t&&t.startIndex===e.startIndex&&t.endIndex===e.endIndex)}function nd(t,e){return!!(t&&t[0]===e[0]&&t[1]===e[1])}const E0=at(()=>({recalcInProgress:ge(!1)}),[],{singleton:!0});function C2(t,e,n){return t[pp(t,e,n)]}function pp(t,e,n,s=0){let r=t.length-1;for(;s<=r;){const i=Math.floor((s+r)/2),o=t[i],a=n(o,e);if(a===0)return i;if(a===-1){if(r-s<2)return i-1;r=i-1}else{if(r===s)return i;s=i+1}}throw new Error(`Failed binary finding record in array - ${t.join(",")}, searched for ${e}`)}function J4(t,e,n,s){const r=pp(t,e,s),i=pp(t,n,s,r);return t.slice(r,i+1)}function go(t,e){return Math.round(t.getBoundingClientRect()[e])}function om(t){return!bt(t.groupOffsetTree)}function T0({index:t},e){return e===t?0:e<t?-1:1}function Z4(){return{groupIndices:[],groupOffsetTree:Rl(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:Rl()}}function e6(t,e){let n=bt(t)?0:1/0;for(const s of e){const{endIndex:r,size:i,startIndex:o}=s;if(n=Math.min(n,o),bt(t)){t=ks(t,0,i);continue}const a=Al(t,o-1,r+1);if(a.some(a6(s)))continue;let l=!1,u=!1;for(const{end:d,start:h,value:f}of a)l?(r>=h||i===f)&&(t=Cy(t,h)):(u=f!==i,l=!0),d>r&&r>=h&&f!==i&&(t=ks(t,r+1,f));u&&(t=ks(t,o,i))}return[t,n]}function t6(t){return typeof t.groupIndex<"u"}function n6({offset:t},e){return e===t?0:e<t?-1:1}function sd(t,e,n){if(e.length===0)return 0;const{index:s,offset:r,size:i}=C2(e,t,T0),o=t-s,a=i*o+(o-1)*n+r;return a>0?a+n:a}function N2(t,e){if(!om(e))return t;let n=0;for(;e.groupIndices[n]<=t+n;)n++;return t+n}function E2(t,e,n){if(t6(t))return e.groupIndices[t.groupIndex]+1;{const s=t.index==="LAST"?n:t.index;let r=N2(s,e);return r=Math.max(0,r,Math.min(n,r)),r}}function s6(t,e,n,s=0){return s>0&&(e=Math.max(e,C2(t,s,T0).offset)),b2(J4(t,e,n,n6),o6)}function r6(t,[e,n,s,r]){e.length>0&&s("received item sizes",e,ls.DEBUG);const i=t.sizeTree;let o=i,a=0;if(n.length>0&&bt(i)&&e.length===2){const f=e[0].size,p=e[1].size;o=n.reduce((w,y)=>ks(ks(w,y,f),y+1,p),o)}else[o,a]=e6(o,e);if(o===i)return t;const{lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h}=Ty(t.offsetTree,a,o,r);return{groupIndices:n,groupOffsetTree:n.reduce((f,p)=>ks(f,p,sd(p,h,r)),Rl()),lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h,sizeTree:o}}function i6(t){return Xo(t).map(({k:e,v:n},s,r)=>{const i=r[s+1];return{endIndex:i?i.k-1:1/0,size:n,startIndex:e}})}function n_(t,e){let n=0,s=0;for(;n<t;)n+=e[s+1]-e[s]-1,s++;return s-(n===t?0:1)}function Ty(t,e,n,s){let r=t,i=0,o=0,a=0,l=0;if(e!==0){l=pp(r,e-1,T0),a=r[l].offset;const u=mr(n,e-1);i=u[0],o=u[1],r.length&&r[l].size===mr(n,e)[1]&&(l-=1),r=r.slice(0,l+1)}else r=[];for(const{start:u,value:d}of Al(n,e,1/0)){const h=u-i,f=h*o+a+h*s;r.push({index:u,offset:f,size:d}),i=u,a=f,o=d}return{lastIndex:i,lastOffset:a,lastSize:o,offsetTree:r}}function o6(t){return{index:t.index,value:t}}function a6(t){const{endIndex:e,size:n,startIndex:s}=t;return r=>r.start===s&&(r.end===e||r.end===1/0)&&r.value===n}const l6={offsetHeight:"height",offsetWidth:"width"},Br=at(([{log:t},{recalcInProgress:e}])=>{const n=et(),s=et(),r=Rn(s,0),i=et(),o=et(),a=ge(0),l=ge([]),u=ge(void 0),d=ge(void 0),h=ge(void 0),f=ge(void 0),p=ge((S,j)=>go(S,l6[j])),w=ge(void 0),y=ge(0),x=Z4(),g=Rn(le(n,Qe(l,t,y),Ir(r6,x),Pt()),x),m=Rn(le(l,Pt(),Ir((S,j)=>({current:j,prev:S.current}),{current:[],prev:[]}),_e(({prev:S})=>S)),[]);Ae(le(l,He(S=>S.length>0),Qe(g,y),_e(([S,j,N])=>{const P=S.reduce((L,I,O)=>ks(L,I,sd(I,j.offsetTree,N)||O),Rl());return{...j,groupIndices:S,groupOffsetTree:P}})),g),Ae(le(s,Qe(g),He(([S,{lastIndex:j}])=>S<j),_e(([S,{lastIndex:j,lastSize:N}])=>[{endIndex:j,size:N,startIndex:S}])),n),Ae(u,d);const b=Rn(le(u,_e(S=>S===void 0)),!0);Ae(le(d,He(S=>S!==void 0&&bt(It(g).sizeTree)),_e(S=>{const j=It(h),N=It(l).length>0;return j?N?[{endIndex:0,size:j,startIndex:0},{endIndex:1,size:S,startIndex:1}]:[]:[{endIndex:0,size:S,startIndex:0}]})),n),Ae(le(f,He(S=>S!==void 0&&S.length>0&&bt(It(g).sizeTree)),_e(S=>{const j=[];let N=S[0],P=0;for(let L=1;L<S.length;L++){const I=S[L];I!==N&&(j.push({endIndex:L-1,size:N,startIndex:P}),N=I,P=L)}return j.push({endIndex:S.length-1,size:N,startIndex:P}),j})),n),Ae(le(l,Qe(h,d),He(([,S,j])=>S!==void 0&&j!==void 0),_e(([S,j,N])=>{const P=[];for(let L=0;L<S.length;L++){const I=S[L],O=S[L+1];P.push({startIndex:I,endIndex:I,size:j}),O!==void 0&&P.push({startIndex:I+1,endIndex:O-1,size:N})}return P})),n);const k=Ns(le(n,Qe(g),Ir(({sizes:S},[j,N])=>({changed:N!==S,sizes:N}),{changed:!1,sizes:x}),_e(S=>S.changed)));dt(le(a,Ir((S,j)=>({diff:S.prev-j,prev:j}),{diff:0,prev:0}),_e(S=>S.diff)),S=>{const{groupIndices:j}=It(g);if(S>0)Ye(e,!0),Ye(i,S+n_(S,j));else if(S<0){const N=It(m);N.length>0&&(S-=n_(-S,N)),Ye(o,S)}}),dt(le(a,Qe(t)),([S,j])=>{S<0&&j("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},ls.ERROR)});const _=Ns(i);Ae(le(i,Qe(g),_e(([S,j])=>{const N=j.groupIndices.length>0,P=[],L=j.lastSize;if(N){const I=td(j.sizeTree,0);let O=0,$=0;for(;O<S;){const F=j.groupIndices[$],q=j.groupIndices.length===$+1?1/0:j.groupIndices[$+1]-F-1;P.push({endIndex:F,size:I,startIndex:F}),P.push({endIndex:F+1+q-1,size:L,startIndex:F+1}),$++,O+=q+1}const D=Xo(j.sizeTree);return O!==S&&D.shift(),D.reduce((F,{k:q,v:E})=>{let R=F.ranges;return F.prevSize!==0&&(R=[...F.ranges,{endIndex:q+S-1,size:F.prevSize,startIndex:F.prevIndex}]),{prevIndex:q+S,prevSize:E,ranges:R}},{prevIndex:S,prevSize:0,ranges:P}).ranges}return Xo(j.sizeTree).reduce((I,{k:O,v:$})=>({prevIndex:O+S,prevSize:$,ranges:[...I.ranges,{endIndex:O+S-1,size:I.prevSize,startIndex:I.prevIndex}]}),{prevIndex:0,prevSize:L,ranges:[]}).ranges})),n);const C=Ns(le(o,Qe(g,y),_e(([S,{offsetTree:j},N])=>{const P=-S;return sd(P,j,N)})));return Ae(le(o,Qe(g,y),_e(([S,j,N])=>{if(j.groupIndices.length>0){if(bt(j.sizeTree))return j;let P=Rl();const L=It(m);let I=0,O=0,$=0;for(;I<-S;){$=L[O];const D=L[O+1]-$-1;O++,I+=D+1}if(P=Xo(j.sizeTree).reduce((D,{k:F,v:q})=>ks(D,Math.max(0,F+S),q),P),I!==-S){const D=td(j.sizeTree,$);P=ks(P,0,D);const F=mr(j.sizeTree,-S+1)[1];P=ks(P,1,F)}return{...j,sizeTree:P,...Ty(j.offsetTree,0,P,N)}}else{const P=Xo(j.sizeTree).reduce((L,{k:I,v:O})=>ks(L,Math.max(0,I+S),O),Rl());return{...j,sizeTree:P,...Ty(j.offsetTree,0,P,N)}}})),g),{beforeUnshiftWith:_,data:w,defaultItemSize:d,firstItemIndex:a,fixedItemSize:u,fixedGroupSize:h,gap:y,groupIndices:l,heightEstimates:f,itemSize:p,listRefresh:k,shiftWith:o,shiftWithOffset:C,sizeRanges:n,sizes:g,statefulTotalCount:r,totalCount:s,trackItemSizes:b,unshiftWith:i}},At(_o,E0),{singleton:!0});function c6(t){return t.reduce((e,n)=>(e.groupIndices.push(e.totalCount),e.totalCount+=n+1,e),{groupIndices:[],totalCount:0})}const T2=at(([{groupIndices:t,sizes:e,totalCount:n},{headerHeight:s,scrollTop:r}])=>{const i=et(),o=et(),a=Ns(le(i,_e(c6)));return Ae(le(a,_e(l=>l.totalCount)),n),Ae(le(a,_e(l=>l.groupIndices)),t),Ae(le(nn(r,e,s),He(([l,u])=>om(u)),_e(([l,u,d])=>mr(u.groupOffsetTree,Math.max(l-d,0),"v")[0]),Pt(),_e(l=>[l])),o),{groupCounts:i,topItemsIndexes:o}},At(Br,qn)),So=at(([{log:t}])=>{const e=ge(!1),n=Ns(le(e,He(s=>s),Pt()));return dt(e,s=>{s&&It(t)("props updated",{},ls.DEBUG)}),{didMount:n,propsReady:e}},At(_o),{singleton:!0}),u6=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function P2(t){const e=typeof t=="number"?{index:t}:t;return e.align||(e.align="start"),(!e.behavior||!u6)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const Bd=at(([{gap:t,listRefresh:e,sizes:n,totalCount:s},{fixedFooterHeight:r,fixedHeaderHeight:i,footerHeight:o,headerHeight:a,scrollingInProgress:l,scrollTo:u,smoothScrollTargetReached:d,viewportHeight:h},{log:f}])=>{const p=et(),w=et(),y=ge(0);let x=null,g=null,m=null;function b(){x&&(x(),x=null),m&&(m(),m=null),g&&(clearTimeout(g),g=null),Ye(l,!1)}return Ae(le(p,Qe(n,h,s,y,a,o,f),Qe(t,i,r),_e(([[k,_,C,S,j,N,P,L],I,O,$])=>{const D=P2(k),{align:F,behavior:q,offset:E}=D,R=S-1,V=E2(D,_,R);let K=sd(V,_.offsetTree,I)+N;F==="end"?(K+=O+mr(_.sizeTree,V)[1]-C+$,V===R&&(K+=P)):F==="center"?K+=(O+mr(_.sizeTree,V)[1]-C+$)/2:K-=j,E&&(K+=E);const Q=re=>{b(),re?(L("retrying to scroll to",{location:k},ls.DEBUG),Ye(p,k)):(Ye(w,!0),L("list did not change, scroll successful",{},ls.DEBUG))};if(b(),q==="smooth"){let re=!1;m=dt(e,ee=>{re=re||ee}),x=ur(d,()=>{Q(re)})}else x=ur(le(e,d6(150)),Q);return g=setTimeout(()=>{b()},1200),Ye(l,!0),L("scrolling from index to",{behavior:q,index:V,top:K},ls.DEBUG),{behavior:q,top:K}})),u),{scrollTargetReached:w,scrollToIndex:p,topListHeight:y}},At(Br,qn,_o),{singleton:!0});function d6(t){return e=>{const n=setTimeout(()=>{e(!1)},t);return s=>{s&&(e(!0),clearTimeout(n))}}}function P0(t,e){t==0?e():requestAnimationFrame(()=>{P0(t-1,e)})}function R0(t,e){const n=e-1;return typeof t=="number"?t:t.index==="LAST"?n:t.index}const Ud=at(([{defaultItemSize:t,listRefresh:e,sizes:n},{scrollTop:s},{scrollTargetReached:r,scrollToIndex:i},{didMount:o}])=>{const a=ge(!0),l=ge(0),u=ge(!0);return Ae(le(o,Qe(l),He(([d,h])=>!!h),Pr(!1)),a),Ae(le(o,Qe(l),He(([d,h])=>!!h),Pr(!1)),u),dt(le(nn(e,o),Qe(a,n,t,u),He(([[,d],h,{sizeTree:f},p,w])=>d&&(!bt(f)||j0(p))&&!h&&!w),Qe(l)),([,d])=>{ur(r,()=>{Ye(u,!0)}),P0(4,()=>{ur(s,()=>{Ye(a,!0)}),Ye(i,d)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:l,scrolledToInitialItem:a}},At(Br,qn,Bd,So),{singleton:!0});function R2(t,e){return Math.abs(t-e)<1.01}const rd="up",mu="down",h6="none",f6={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},p6=0,Hd=at(([{footerHeight:t,headerHeight:e,scrollBy:n,scrollContainerState:s,scrollTop:r,viewportHeight:i}])=>{const o=ge(!1),a=ge(!0),l=et(),u=et(),d=ge(4),h=ge(p6),f=Rn(le(jy(le(Ue(r),_a(1),Pr(!0)),le(Ue(r),_a(1),Pr(!1),Zk(100))),Pt()),!1),p=Rn(le(jy(le(n,Pr(!0)),le(n,Pr(!1),Zk(200))),Pt()),!1);Ae(le(nn(Ue(r),Ue(h)),_e(([m,b])=>m<=b),Pt()),a),Ae(le(a,ri(50)),u);const w=Ns(le(nn(s,Ue(i),Ue(e),Ue(t),Ue(d)),Ir((m,[{scrollHeight:b,scrollTop:k},_,C,S,j])=>{const N=k+_-b>-j,P={scrollHeight:b,scrollTop:k,viewportHeight:_};if(N){let I,O;return k>m.state.scrollTop?(I="SCROLLED_DOWN",O=m.state.scrollTop-k):(I="SIZE_DECREASED",O=m.state.scrollTop-k||m.scrollTopDelta),{atBottom:!0,atBottomBecause:I,scrollTopDelta:O,state:P}}let L;return P.scrollHeight>m.state.scrollHeight?L="SIZE_INCREASED":_<m.state.viewportHeight?L="VIEWPORT_HEIGHT_DECREASING":k<m.state.scrollTop?L="SCROLLING_UPWARDS":L="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:L,state:P}},f6),Pt((m,b)=>m&&m.atBottom===b.atBottom))),y=Rn(le(s,Ir((m,{scrollHeight:b,scrollTop:k,viewportHeight:_})=>{if(R2(m.scrollHeight,b))return{changed:!1,jump:0,scrollHeight:b,scrollTop:k};{const C=b-(k+_)<1;return m.scrollTop!==k&&C?{changed:!0,jump:m.scrollTop-k,scrollHeight:b,scrollTop:k}:{changed:!0,jump:0,scrollHeight:b,scrollTop:k}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),He(m=>m.changed),_e(m=>m.jump)),0);Ae(le(w,_e(m=>m.atBottom)),o),Ae(le(o,ri(50)),l);const x=ge(mu);Ae(le(s,_e(({scrollTop:m})=>m),Pt(),Ir((m,b)=>It(p)?{direction:m.direction,prevScrollTop:b}:{direction:b<m.prevScrollTop?rd:mu,prevScrollTop:b},{direction:mu,prevScrollTop:0}),_e(m=>m.direction)),x),Ae(le(s,ri(50),Pr(h6)),x);const g=ge(0);return Ae(le(f,He(m=>!m),Pr(0)),g),Ae(le(r,ri(100),Qe(f),He(([m,b])=>b),Ir(([m,b],[k])=>[b,k],[0,0]),_e(([m,b])=>b-m)),g),{atBottomState:w,atBottomStateChange:l,atBottomThreshold:d,atTopStateChange:u,atTopThreshold:h,isAtBottom:o,isAtTop:a,isScrolling:f,lastJumpDueToItemResize:y,scrollDirection:x,scrollVelocity:g}},At(qn)),id="top",od="bottom",s_="none";function r_(t,e,n){return typeof t=="number"?n===rd&&e===id||n===mu&&e===od?t:0:n===rd?e===id?t.main:t.reverse:e===od?t.main:t.reverse}function i_(t,e){var n;return typeof t=="number"?t:(n=t[e])!=null?n:0}const A0=at(([{deviation:t,fixedHeaderHeight:e,headerHeight:n,scrollTop:s,viewportHeight:r}])=>{const i=et(),o=ge(0),a=ge(0),l=ge(0),u=Rn(le(nn(Ue(s),Ue(r),Ue(n),Ue(i,nd),Ue(l),Ue(o),Ue(e),Ue(t),Ue(a)),_e(([d,h,f,[p,w],y,x,g,m,b])=>{const k=d-m,_=x+g,C=Math.max(f-k,0);let S=s_;const j=i_(b,id),N=i_(b,od);return p-=m,p+=f+g,w+=f+g,w-=m,p>d+_-j&&(S=rd),w<d-C+h+N&&(S=mu),S!==s_?[Math.max(k-f-r_(y,id,S)-j,0),k-C-g+h+r_(y,od,S)+N]:null}),He(d=>d!=null),Pt(nd)),[0,0]);return{increaseViewportBy:a,listBoundary:i,overscan:l,topListHeight:o,visibleRange:u}},At(qn),{singleton:!0});function m6(t,e,n){if(om(e)){const s=N2(t,e);return[{index:mr(e.groupOffsetTree,s)[0],offset:0,size:0},{data:n==null?void 0:n[0],index:s,offset:0,size:0}]}return[{data:n==null?void 0:n[0],index:t,offset:0,size:0}]}const bg={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function Sf(t,e,n,s,r,i){const{lastIndex:o,lastOffset:a,lastSize:l}=r;let u=0,d=0;if(t.length>0){u=t[0].offset;const y=t[t.length-1];d=y.offset+y.size}const h=n-o,f=a+h*l+(h-1)*s,p=u,w=f-d;return{bottom:d,firstItemIndex:i,items:o_(t,r,i),offsetBottom:w,offsetTop:u,top:p,topItems:o_(e,r,i),topListHeight:e.reduce((y,x)=>x.size+y,0),totalCount:n}}function A2(t,e,n,s,r,i){let o=0;if(n.groupIndices.length>0)for(const d of n.groupIndices){if(d-o>=t)break;o++}const a=t+o,l=R0(e,a),u=Array.from({length:a}).map((d,h)=>({data:i[h+l],index:h+l,offset:0,size:0}));return Sf(u,[],a,r,n,s)}function o_(t,e,n){if(t.length===0)return[];if(!om(e))return t.map(u=>({...u,index:u.index+n,originalIndex:u.index}));const s=t[0].index,r=t[t.length-1].index,i=[],o=Al(e.groupOffsetTree,s,r);let a,l=0;for(const u of t){(!a||a.end<u.index)&&(a=o.shift(),l=e.groupIndices.indexOf(a.start));let d;u.index===a.start?d={index:l,type:"group"}:d={groupIndex:l,index:u.index-(l+1)+n},i.push({...d,data:u.data,offset:u.offset,originalIndex:u.index,size:u.size})}return i}function a_(t,e){var n;return t===void 0?0:typeof t=="number"?t:(n=t[e])!=null?n:0}const Ma=at(([{data:t,firstItemIndex:e,gap:n,sizes:s,totalCount:r},i,{listBoundary:o,topListHeight:a,visibleRange:l},{initialTopMostItemIndex:u,scrolledToInitialItem:d},{topListHeight:h},f,{didMount:p},{recalcInProgress:w}])=>{const y=ge([]),x=ge(0),g=et(),m=ge(0);Ae(i.topItemsIndexes,y);const b=Rn(le(nn(p,w,Ue(l,nd),Ue(r),Ue(s),Ue(u),d,Ue(y),Ue(e),Ue(n),Ue(m),t),He(([S,j,,N,,,,,,,,P])=>{const L=P&&P.length!==N;return S&&!j&&!L}),_e(([,,[S,j],N,P,L,I,O,$,D,F,q])=>{var E,R,V,K;const Q=P,{offsetTree:re,sizeTree:ee}=Q,z=It(x);if(N===0)return{...bg,totalCount:N};if(S===0&&j===0)return z===0?{...bg,totalCount:N}:A2(z,L,P,$,D,q||[]);if(bt(ee))return z>0?null:Sf(m6(R0(L,N),Q,q),[],N,D,Q,$);const A=[];if(O.length>0){const ye=O[0],X=O[O.length-1];let ue=0;for(const ce of Al(ee,ye,X)){const de=ce.value,ie=Math.max(ce.start,ye),Se=Math.min(ce.end,X);for(let oe=ie;oe<=Se;oe++)A.push({data:q==null?void 0:q[oe],index:oe,offset:ue,size:de}),ue+=de}}if(!I)return Sf([],A,N,D,Q,$);const Y=O.length>0?O[O.length-1]+1:0,B=s6(re,S,j,Y);if(B.length===0)return null;const J=N-1,be=im([],ye=>{for(const X of B){const ue=X.value;let ce=ue.offset,de=X.start;const ie=ue.size;if(ue.offset<S){de+=Math.floor((S-ue.offset+D)/(ie+D));const oe=de-X.start;ce+=oe*ie+oe*D}de<Y&&(ce+=(Y-de)*ie,de=Y);const Se=Math.min(X.end,J);for(let oe=de;oe<=Se&&!(ce>=j);oe++)ye.push({data:q==null?void 0:q[oe],index:oe,offset:ce,size:ie}),ce+=ie+D}}),pe=a_(F,id),H=a_(F,od);if(be.length>0&&(pe>0||H>0)){const ye=be[0],X=be[be.length-1];if(pe>0&&ye.index>Y){const ue=Math.min(pe,ye.index-Y),ce=[];let de=ye.offset;for(let ie=ye.index-1;ie>=ye.index-ue;ie--){const Se=(R=(E=Al(ee,ie,ie)[0])==null?void 0:E.value)!=null?R:ye.size;de-=Se+D,ce.unshift({data:q==null?void 0:q[ie],index:ie,offset:de,size:Se})}be.unshift(...ce)}if(H>0&&X.index<J){const ue=Math.min(H,J-X.index);let ce=X.offset+X.size+D;for(let de=X.index+1;de<=X.index+ue;de++){const ie=(K=(V=Al(ee,de,de)[0])==null?void 0:V.value)!=null?K:X.size;be.push({data:q==null?void 0:q[de],index:de,offset:ce,size:ie}),ce+=ie+D}}}return Sf(be,A,N,D,Q,$)}),He(S=>S!==null),Pt()),bg);Ae(le(t,He(j0),_e(S=>S==null?void 0:S.length)),r),Ae(le(b,_e(S=>S.topListHeight)),h),Ae(h,a),Ae(le(b,_e(S=>[S.top,S.bottom])),o),Ae(le(b,_e(S=>S.items)),g);const k=Ns(le(b,He(({items:S})=>S.length>0),Qe(r,t),He(([{items:S},j])=>S[S.length-1].originalIndex===j-1),_e(([,S,j])=>[S-1,j]),Pt(nd),_e(([S])=>S))),_=Ns(le(b,ri(200),He(({items:S,topItems:j})=>S.length>0&&S[0].originalIndex===j.length),_e(({items:S})=>S[0].index),Pt())),C=Ns(le(b,He(({items:S})=>S.length>0),_e(({items:S})=>{let j=0,N=S.length-1;for(;S[j].type==="group"&&j<N;)j++;for(;S[N].type==="group"&&N>j;)N--;return{endIndex:S[N].index,startIndex:S[j].index}}),Pt(j2)));return{endReached:k,initialItemCount:x,itemsRendered:g,listState:b,minOverscanItemCount:m,rangeChanged:C,startReached:_,topItemsIndexes:y,...f}},At(Br,T2,A0,Ud,Bd,Hd,So,E0),{singleton:!0}),O2=at(([{fixedFooterHeight:t,fixedHeaderHeight:e,footerHeight:n,headerHeight:s},{listState:r}])=>{const i=et(),o=Rn(le(nn(n,t,s,e,r),_e(([a,l,u,d,h])=>a+l+u+d+h.offsetBottom+h.bottom)),0);return Ae(Ue(o),i),{totalListHeight:o,totalListHeightChanged:i}},At(qn,Ma),{singleton:!0}),g6=at(([{viewportHeight:t},{totalListHeight:e}])=>{const n=ge(!1),s=Rn(le(nn(n,t,e),He(([r])=>r),_e(([,r,i])=>Math.max(0,r-i)),ri(0),Pt()),0);return{alignToBottom:n,paddingTopAddition:s}},At(qn,O2),{singleton:!0}),M2=at(()=>({context:ge(null)})),x6=({itemBottom:t,itemTop:e,locationParams:{align:n,behavior:s,...r},viewportBottom:i,viewportTop:o})=>e<o?{...r,align:n??"start",behavior:s}:t>i?{...r,align:n??"end",behavior:s}:null,I2=at(([{gap:t,sizes:e,totalCount:n},{fixedFooterHeight:s,fixedHeaderHeight:r,headerHeight:i,scrollingInProgress:o,scrollTop:a,viewportHeight:l},{scrollToIndex:u}])=>{const d=et();return Ae(le(d,Qe(e,l,n,i,r,s,a),Qe(t),_e(([[h,f,p,w,y,x,g,m],b])=>{const{align:k,behavior:_,calculateViewLocation:C=x6,done:S,...j}=h,N=E2(h,f,w-1),P=sd(N,f.offsetTree,b)+y+x,L=P+mr(f.sizeTree,N)[1],I=m+x,O=m+p-g,$=C({itemBottom:L,itemTop:P,locationParams:{align:k,behavior:_,...j},viewportBottom:O,viewportTop:I});return $?S&&ur(le(o,He(D=>!D),_a(It(o)?1:2)),S):S==null||S(),$}),He(h=>h!==null)),u),{scrollIntoView:d}},At(Br,qn,Bd,Ma,_o),{singleton:!0});function l_(t){return t?t==="smooth"?"smooth":"auto":!1}const y6=(t,e)=>typeof t=="function"?l_(t(e)):e&&l_(t),v6=at(([{listRefresh:t,totalCount:e,fixedItemSize:n,data:s},{atBottomState:r,isAtBottom:i},{scrollToIndex:o},{scrolledToInitialItem:a},{didMount:l,propsReady:u},{log:d},{scrollingInProgress:h},{context:f},{scrollIntoView:p}])=>{const w=ge(!1),y=et();let x=null;function g(_){Ye(o,{align:"end",behavior:_,index:"LAST"})}dt(le(nn(le(Ue(e),_a(1)),l),Qe(Ue(w),i,a,h),_e(([[_,C],S,j,N,P])=>{let L=C&&N,I="auto";return L&&(I=y6(S,j||P),L=L&&!!I),{followOutputBehavior:I,shouldFollow:L,totalCount:_}}),He(({shouldFollow:_})=>_)),({followOutputBehavior:_,totalCount:C})=>{x&&(x(),x=null),It(n)?requestAnimationFrame(()=>{It(d)("following output to ",{totalCount:C},ls.DEBUG),g(_)}):x=ur(t,()=>{It(d)("following output to ",{totalCount:C},ls.DEBUG),g(_),x=null})});function m(_){const C=ur(r,S=>{_&&!S.atBottom&&S.notAtBottomBecause==="SIZE_INCREASED"&&!x&&(It(d)("scrolling to bottom due to increased size",{},ls.DEBUG),g("auto"))});setTimeout(C,100)}dt(le(nn(Ue(w),e,u),He(([_,,C])=>_&&C),Ir(({value:_},[,C])=>({refreshed:_===C,value:C}),{refreshed:!1,value:0}),He(({refreshed:_})=>_),Qe(w,e)),([,_])=>{It(a)&&m(_!==!1)}),dt(y,()=>{m(It(w)!==!1)}),dt(nn(Ue(w),r),([_,C])=>{_&&!C.atBottom&&C.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&g("auto")});const b=ge(null),k=et();return Ae(jy(le(Ue(s),_e(_=>{var C;return(C=_==null?void 0:_.length)!=null?C:0})),le(Ue(e))),k),dt(le(nn(le(k,_a(1)),l),Qe(Ue(b),a,h,f),_e(([[_,C],S,j,N,P])=>C&&j&&(S==null?void 0:S({context:P,totalCount:_,scrollingInProgress:N}))),He(_=>!!_),ri(0)),_=>{x&&(x(),x=null),It(n)?requestAnimationFrame(()=>{It(d)("scrolling into view",{}),Ye(p,_)}):x=ur(t,()=>{It(d)("scrolling into view",{}),Ye(p,_),x=null})}),{autoscrollToBottom:y,followOutput:w,scrollIntoViewOnChange:b}},At(Br,Hd,Bd,Ud,So,_o,qn,M2,I2)),b6=at(([{data:t,firstItemIndex:e,gap:n,sizes:s},{initialTopMostItemIndex:r},{initialItemCount:i,listState:o},{didMount:a}])=>(Ae(le(a,Qe(i),He(([,l])=>l!==0),Qe(r,s,e,n,t),_e(([[,l],u,d,h,f,p=[]])=>A2(l,u,d,h,f,p))),o),{}),At(Br,Ud,Ma,So),{singleton:!0}),w6=at(([{didMount:t},{scrollTo:e},{listState:n}])=>{const s=ge(0);return dt(le(t,Qe(s),He(([,r])=>r!==0),_e(([,r])=>({top:r}))),r=>{ur(le(n,_a(1),He(i=>i.items.length>1)),()=>{requestAnimationFrame(()=>{Ye(e,r)})})}),{initialScrollTop:s}},At(So,qn,Ma),{singleton:!0}),D2=at(([{scrollVelocity:t}])=>{const e=ge(!1),n=et(),s=ge(!1);return Ae(le(t,Qe(s,e,n),He(([r,i])=>!!i),_e(([r,i,o,a])=>{const{enter:l,exit:u}=i;if(o){if(u(r,a))return!1}else if(l(r,a))return!0;return o}),Pt()),e),dt(le(nn(e,t,n),Qe(s)),([[r,i,o],a])=>{r&&a&&a.change&&a.change(i,o)}),{isSeeking:e,scrollSeekConfiguration:s,scrollSeekRangeChanged:n,scrollVelocity:t}},At(Hd),{singleton:!0}),O0=at(([{scrollContainerState:t,scrollTo:e}])=>{const n=et(),s=et(),r=et(),i=ge(!1),o=ge(void 0);return Ae(le(nn(n,s),_e(([{scrollHeight:a,scrollTop:l,viewportHeight:u},{offsetTop:d}])=>({scrollHeight:a,scrollTop:Math.max(0,l-d),viewportHeight:u}))),t),Ae(le(e,Qe(s),_e(([a,{offsetTop:l}])=>({...a,top:a.top+l}))),r),{customScrollParent:o,useWindowScroll:i,windowScrollContainerState:n,windowScrollTo:r,windowViewportRect:s}},At(qn)),k6=at(([{sizeRanges:t,sizes:e},{headerHeight:n,scrollTop:s},{initialTopMostItemIndex:r},{didMount:i},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:l}])=>{const u=et(),d=ge(void 0),h=ge(null),f=ge(null);return Ae(a,h),Ae(l,f),dt(le(u,Qe(e,s,o,h,f,n)),([p,w,y,x,g,m,b])=>{const k=i6(w.sizeTree);x&&g!==null&&m!==null&&(y=g.scrollTop-m.offsetTop),y-=b,p({ranges:k,scrollTop:y})}),Ae(le(d,He(j0),_e(_6)),r),Ae(le(i,Qe(d),He(([,p])=>p!==void 0),Pt(),_e(([,p])=>p.ranges)),t),{getState:u,restoreStateFrom:d}},At(Br,qn,Ud,So,O0));function _6(t){return{align:"start",index:0,offset:t.scrollTop}}const S6=at(([{topItemsIndexes:t}])=>{const e=ge(0);return Ae(le(e,He(n=>n>=0),_e(n=>Array.from({length:n}).map((s,r)=>r))),t),{topItemCount:e}},At(Ma));function L2(t){let e=!1,n;return()=>(e||(e=!0,n=t()),n)}const j6=L2(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),C6=at(([{deviation:t,scrollBy:e,scrollingInProgress:n,scrollTop:s},{isAtBottom:r,isScrolling:i,lastJumpDueToItemResize:o,scrollDirection:a},{listState:l},{beforeUnshiftWith:u,gap:d,shiftWithOffset:h,sizes:f},{log:p},{recalcInProgress:w}])=>{const y=Ns(le(l,Qe(o),Ir(([,g,m,b],[{bottom:k,items:_,offsetBottom:C,totalCount:S},j])=>{const N=k+C;let P=0;return m===S&&g.length>0&&_.length>0&&(_[0].originalIndex===0&&g[0].originalIndex===0||(P=N-b,P!==0&&(P+=j))),[P,_,S,N]},[0,[],0,0]),He(([g])=>g!==0),Qe(s,a,n,r,p,w),He(([,g,m,b,,,k])=>!k&&!b&&g!==0&&m===rd),_e(([[g],,,,,m])=>(m("Upward scrolling compensation",{amount:g},ls.DEBUG),g))));function x(g){g>0?(Ye(e,{behavior:"auto",top:-g}),Ye(t,0)):(Ye(t,0),Ye(e,{behavior:"auto",top:-g}))}return dt(le(y,Qe(t,i)),([g,m,b])=>{b&&j6()?Ye(t,m-g):x(-g)}),dt(le(nn(Rn(i,!1),t,w),He(([g,m,b])=>!g&&!b&&m!==0),_e(([g,m])=>m),ri(1)),x),Ae(le(h,_e(g=>({top:-g}))),e),dt(le(u,Qe(f,d),_e(([g,{groupIndices:m,lastSize:b,sizeTree:k},_])=>{function C(S){return S*(b+_)}if(m.length===0)return C(g);{let S=0;const j=td(k,0);let N=0,P=0;for(;N<g;){N++,S+=j;let L=m.length===P+1?1/0:m[P+1]-m[P]-1;N+L>g&&(S-=j,L=g-N+1),N+=L,S+=C(L),P++}return S}})),g=>{Ye(t,g),requestAnimationFrame(()=>{Ye(e,{top:g}),requestAnimationFrame(()=>{Ye(t,0),Ye(w,!1)})})}),{deviation:t}},At(qn,Hd,Ma,Br,_o,E0)),N6=at(([t,e,n,s,r,i,o,a,l,u,d])=>({...t,...e,...n,...s,...r,...i,...o,...a,...l,...u,...d}),At(A0,b6,So,D2,O2,w6,g6,O0,I2,_o,M2)),$2=at(([{data:t,defaultItemSize:e,firstItemIndex:n,fixedItemSize:s,fixedGroupSize:r,gap:i,groupIndices:o,heightEstimates:a,itemSize:l,sizeRanges:u,sizes:d,statefulTotalCount:h,totalCount:f,trackItemSizes:p},{initialItemFinalLocationReached:w,initialTopMostItemIndex:y,scrolledToInitialItem:x},g,m,b,k,{scrollToIndex:_},C,{topItemCount:S},{groupCounts:j},N])=>{const{listState:P,minOverscanItemCount:L,topItemsIndexes:I,rangeChanged:O,...$}=k;return Ae(O,N.scrollSeekRangeChanged),Ae(le(N.windowViewportRect,_e(D=>D.visibleHeight)),g.viewportHeight),{data:t,defaultItemHeight:e,firstItemIndex:n,fixedItemHeight:s,fixedGroupHeight:r,gap:i,groupCounts:j,heightEstimates:a,initialItemFinalLocationReached:w,initialTopMostItemIndex:y,scrolledToInitialItem:x,sizeRanges:u,topItemCount:S,topItemsIndexes:I,totalCount:f,...b,groupIndices:o,itemSize:l,listState:P,minOverscanItemCount:L,scrollToIndex:_,statefulTotalCount:h,trackItemSizes:p,rangeChanged:O,...$,...N,...g,sizes:d,...m}},At(Br,Ud,qn,k6,v6,Ma,Bd,C6,S6,T2,N6));function E6(t,e){const n={},s={};let r=0;const i=t.length;for(;r<i;)s[t[r]]=1,r+=1;for(const o in e)Object.hasOwn(s,o)||(n[o]=e[o]);return n}const Oh=typeof document<"u"?ve.useLayoutEffect:ve.useEffect;function F2(t,e,n){const s=Object.keys(e.required||{}),r=Object.keys(e.optional||{}),i=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),a=ve.createContext({});function l(x,g){x.propsReady&&Ye(x.propsReady,!1);for(const m of s){const b=x[e.required[m]];Ye(b,g[m])}for(const m of r)if(m in g){const b=x[e.optional[m]];Ye(b,g[m])}x.propsReady&&Ye(x.propsReady,!0)}function u(x){return i.reduce((g,m)=>(g[m]=b=>{const k=x[e.methods[m]];Ye(k,b)},g),{})}function d(x){return o.reduce((g,m)=>(g[m]=W4(x[e.events[m]]),g),{})}const h=ve.forwardRef((x,g)=>{const{children:m,...b}=x,[k]=ve.useState(()=>im(q4(t),S=>{l(S,b)})),[_]=ve.useState(Jk(d,k));Oh(()=>{for(const S of o)S in b&&dt(_[S],b[S]);return()=>{Object.values(_).map(C0)}},[b,_,k]),Oh(()=>{l(k,b)}),ve.useImperativeHandle(g,Xk(u(k)));const C=n;return c.jsx(a.Provider,{value:k,children:n?c.jsx(C,{...E6([...s,...r,...o],b),children:m}):m})}),f=x=>{const g=ve.useContext(a);return ve.useCallback(m=>{Ye(g[x],m)},[g,x])},p=x=>{const g=ve.useContext(a)[x],m=ve.useCallback(b=>dt(g,b),[g]);return ve.useSyncExternalStore(m,()=>It(g),()=>It(g))},w=x=>{const g=ve.useContext(a)[x],[m,b]=ve.useState(Jk(It,g));return Oh(()=>dt(g,k=>{k!==m&&b(Xk(k))}),[g,m]),m},y=ve.version.startsWith("18")?p:w;return{Component:h,useEmitter:(x,g)=>{const m=ve.useContext(a)[x];Oh(()=>dt(m,g),[g,m])},useEmitterValue:y,usePublisher:f}}const z2=ve.createContext(void 0),B2=ve.createContext(void 0),U2=typeof document<"u"?ve.useLayoutEffect:ve.useEffect;function wg(t){return"self"in t}function T6(t){return"body"in t}function H2(t,e,n,s=yc,r,i){const o=ve.useRef(null),a=ve.useRef(null),l=ve.useRef(null),u=ve.useCallback(f=>{let p,w,y;const x=f.target;if(T6(x)||wg(x)){const m=wg(x)?x:x.defaultView;y=i?m.scrollX:m.scrollY,p=i?m.document.documentElement.scrollWidth:m.document.documentElement.scrollHeight,w=i?m.innerWidth:m.innerHeight}else y=i?x.scrollLeft:x.scrollTop,p=i?x.scrollWidth:x.scrollHeight,w=i?x.offsetWidth:x.offsetHeight;const g=()=>{t({scrollHeight:p,scrollTop:Math.max(y,0),viewportHeight:w})};f.suppressFlushSync?g():gC.flushSync(g),a.current!==null&&(y===a.current||y<=0||y===p-w)&&(a.current=null,e(!0),l.current&&(clearTimeout(l.current),l.current=null))},[t,e,i]);ve.useEffect(()=>{const f=r||o.current;return s(r||o.current),u({suppressFlushSync:!0,target:f}),f.addEventListener("scroll",u,{passive:!0}),()=>{s(null),f.removeEventListener("scroll",u)}},[o,u,n,s,r]);function d(f){const p=o.current;if(!p||(i?"offsetWidth"in p&&p.offsetWidth===0:"offsetHeight"in p&&p.offsetHeight===0))return;const w=f.behavior==="smooth";let y,x,g;wg(p)?(x=Math.max(go(p.document.documentElement,i?"width":"height"),i?p.document.documentElement.scrollWidth:p.document.documentElement.scrollHeight),y=i?p.innerWidth:p.innerHeight,g=i?window.scrollX:window.scrollY):(x=p[i?"scrollWidth":"scrollHeight"],y=go(p,i?"width":"height"),g=p[i?"scrollLeft":"scrollTop"]);const m=x-y;if(f.top=Math.ceil(Math.max(Math.min(m,f.top),0)),R2(y,x)||f.top===g){t({scrollHeight:x,scrollTop:g,viewportHeight:y}),w&&e(!0);return}w?(a.current=f.top,l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{l.current=null,a.current=null,e(!0)},1e3)):a.current=null,i&&(f={behavior:f.behavior,left:f.top}),p.scrollTo(f)}function h(f){i&&(f={behavior:f.behavior,left:f.top}),o.current.scrollBy(f)}return{scrollByCallback:h,scrollerRef:o,scrollToCallback:d}}const kg="-webkit-sticky",c_="sticky",M0=L2(()=>{if(typeof document>"u")return c_;const t=document.createElement("div");return t.style.position=kg,t.style.position===kg?kg:c_});function I0(t){return t}const P6=at(()=>{const t=ge(a=>`Item ${a}`),e=ge(a=>`Group ${a}`),n=ge({}),s=ge(I0),r=ge("div"),i=ge(yc),o=(a,l=null)=>Rn(le(n,_e(u=>u[a]),Pt()),l);return{components:n,computeItemKey:s,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:e,HeaderComponent:o("Header"),HeaderFooterTag:r,ItemComponent:o("Item","div"),itemContent:t,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:i,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}}),R6=at(([t,e])=>({...t,...e}),At($2,P6)),A6=({height:t})=>c.jsx("div",{style:{height:t}}),O6={overflowAnchor:"none",position:M0(),zIndex:1},W2={overflowAnchor:"none"},M6={...W2,display:"inline-block",height:"100%"},u_=ve.memo(function({showTopList:t=!1}){const e=We("listState"),n=Fs("sizeRanges"),s=We("useWindowScroll"),r=We("customScrollParent"),i=Fs("windowScrollContainerState"),o=Fs("scrollContainerState"),a=r||s?i:o,l=We("itemContent"),u=We("context"),d=We("groupContent"),h=We("trackItemSizes"),f=We("itemSize"),p=We("log"),w=Fs("gap"),y=We("horizontalDirection"),{callbackRef:x}=Y4(n,f,h,t?yc:a,p,w,r,y,We("skipAnimationFrameInResizeObserver")),[g,m]=ve.useState(0);D0("deviation",$=>{g!==$&&m($)});const b=We("EmptyPlaceholder"),k=We("ScrollSeekPlaceholder")||A6,_=We("ListComponent"),C=We("ItemComponent"),S=We("GroupComponent"),j=We("computeItemKey"),N=We("isSeeking"),P=We("groupIndices").length>0,L=We("alignToBottom"),I=We("initialItemFinalLocationReached"),O=t?{}:{boxSizing:"border-box",...y?{display:"inline-block",height:"100%",marginLeft:g!==0?g:L?"auto":0,paddingLeft:e.offsetTop,paddingRight:e.offsetBottom,whiteSpace:"nowrap"}:{marginTop:g!==0?g:L?"auto":0,paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},...I?{}:{visibility:"hidden"}};return!t&&e.totalCount===0&&b?c.jsx(b,{...Pn(b,u)}):c.jsx(_,{...Pn(_,u),"data-testid":t?"virtuoso-top-item-list":"virtuoso-item-list",ref:x,style:O,children:(t?e.topItems:e.items).map($=>{const D=$.originalIndex,F=j(D+e.firstItemIndex,$.data,u);return N?v.createElement(k,{...Pn(k,u),height:$.size,index:$.index,key:F,type:$.type||"item",...$.type==="group"?{}:{groupIndex:$.groupIndex}}):$.type==="group"?v.createElement(S,{...Pn(S,u),"data-index":D,"data-item-index":$.index,"data-known-size":$.size,key:F,style:O6},d($.index,u)):v.createElement(C,{...Pn(C,u),...$6(C,$.data),"data-index":D,"data-item-group-index":$.groupIndex,"data-item-index":$.index,"data-known-size":$.size,key:F,style:y?M6:W2},P?l($.index,$.groupIndex,$.data,u):l($.index,$.data,u))})})}),I6={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},D6={outline:"none",overflowX:"auto",position:"relative"},am=t=>({height:"100%",position:"absolute",top:0,width:"100%",...t?{display:"flex",flexDirection:"column"}:{}}),L6={position:M0(),top:0,width:"100%",zIndex:1};function Pn(t,e){if(typeof t!="string")return{context:e}}function $6(t,e){return{item:typeof t=="string"?void 0:e}}const F6=ve.memo(function(){const t=We("HeaderComponent"),e=Fs("headerHeight"),n=We("HeaderFooterTag"),s=Oa(ve.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null}),z6=ve.memo(function(){const t=We("FooterComponent"),e=Fs("footerHeight"),n=We("HeaderFooterTag"),s=Oa(ve.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null});function V2({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ve.memo(function({children:s,style:r,context:i,...o}){const a=n("scrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("scrollerRef"),h=e("horizontalDirection")||!1,{scrollByCallback:f,scrollerRef:p,scrollToCallback:w}=H2(a,u,l,d,void 0,h);return t("scrollTo",w),t("scrollBy",f),c.jsx(l,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:p,style:{...h?D6:I6,...r},tabIndex:0,...o,...Pn(l,i),children:s})})}function q2({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ve.memo(function({children:s,style:r,context:i,...o}){const a=n("windowScrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("totalListHeight"),h=e("deviation"),f=e("customScrollParent"),p=ve.useRef(null),w=e("scrollerRef"),{scrollByCallback:y,scrollerRef:x,scrollToCallback:g}=H2(a,u,l,w,f);return U2(()=>{var m;return x.current=f||((m=p.current)==null?void 0:m.ownerDocument.defaultView),()=>{x.current=null}},[x,f]),t("windowScrollTo",g),t("scrollBy",y),c.jsx(l,{ref:p,"data-virtuoso-scroller":!0,style:{position:"relative",...r,...d!==0?{height:d+h}:{}},...o,...Pn(l,i),children:s})})}const B6=({children:t})=>{const e=ve.useContext(z2),n=Fs("viewportHeight"),s=Fs("fixedItemHeight"),r=We("alignToBottom"),i=We("horizontalDirection"),o=ve.useMemo(()=>x2(n,l=>go(l,i?"width":"height")),[n,i]),a=Oa(o,!0,We("skipAnimationFrameInResizeObserver"));return ve.useEffect(()=>{e&&(n(e.viewportHeight),s(e.itemHeight))},[e,n,s]),c.jsx("div",{"data-viewport-type":"element",ref:a,style:am(r),children:t})},U6=({children:t})=>{const e=ve.useContext(z2),n=Fs("windowViewportRect"),s=Fs("fixedItemHeight"),r=We("customScrollParent"),i=v2(n,r,We("skipAnimationFrameInResizeObserver")),o=We("alignToBottom");return ve.useEffect(()=>{e&&(s(e.itemHeight),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,n,s]),c.jsx("div",{"data-viewport-type":"window",ref:i,style:am(o),children:t})},H6=({children:t})=>{const e=We("TopItemListComponent")||"div",n=We("headerHeight"),s={...L6,marginTop:`${n}px`},r=We("context");return c.jsx(e,{style:s,...Pn(e,r),children:t})},W6=ve.memo(function(t){const e=We("useWindowScroll"),n=We("topItemsIndexes").length>0,s=We("customScrollParent"),r=We("context");return c.jsxs(s||e?K6:q6,{...t,context:r,children:[n&&c.jsx(H6,{children:c.jsx(u_,{showTopList:!0})}),c.jsxs(s||e?U6:B6,{children:[c.jsx(F6,{}),c.jsx(u_,{}),c.jsx(z6,{})]})]})}),{Component:V6,useEmitter:D0,useEmitterValue:We,usePublisher:Fs}=F2(R6,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},W6),q6=V2({useEmitter:D0,useEmitterValue:We,usePublisher:Fs}),K6=q2({useEmitter:D0,useEmitterValue:We,usePublisher:Fs}),G6=V6,Y6=at(()=>{const t=ge(u=>c.jsxs("td",{children:["Item $",u]})),e=ge(null),n=ge(u=>c.jsxs("td",{colSpan:1e3,children:["Group ",u]})),s=ge(null),r=ge(null),i=ge({}),o=ge(I0),a=ge(yc),l=(u,d=null)=>Rn(le(i,_e(h=>h[u]),Pt()),d);return{components:i,computeItemKey:o,context:e,EmptyPlaceholder:l("EmptyPlaceholder"),FillerRow:l("FillerRow"),fixedFooterContent:r,fixedHeaderContent:s,itemContent:t,groupContent:n,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),TableBodyComponent:l("TableBody","tbody"),TableComponent:l("Table","table"),TableFooterComponent:l("TableFoot","tfoot"),TableHeadComponent:l("TableHead","thead"),TableRowComponent:l("TableRow","tr"),GroupComponent:l("Group","tr")}});At($2,Y6);M0();const d_={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},Q6={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:h_,floor:mp,max:gu,min:_g,round:f_}=Math;function p_(t,e,n){return Array.from({length:e-t+1}).map((s,r)=>({data:n===null?null:n[r+t],index:r+t}))}function X6(t){return{...Q6,items:t}}function Mh(t,e){return t&&t.width===e.width&&t.height===e.height}function J6(t,e){return t&&t.column===e.column&&t.row===e.row}const Z6=at(([{increaseViewportBy:t,listBoundary:e,overscan:n,visibleRange:s},{footerHeight:r,headerHeight:i,scrollBy:o,scrollContainerState:a,scrollTo:l,scrollTop:u,smoothScrollTargetReached:d,viewportHeight:h},f,p,{didMount:w,propsReady:y},{customScrollParent:x,useWindowScroll:g,windowScrollContainerState:m,windowScrollTo:b,windowViewportRect:k},_])=>{const C=ge(0),S=ge(0),j=ge(d_),N=ge({height:0,width:0}),P=ge({height:0,width:0}),L=et(),I=et(),O=ge(0),$=ge(null),D=ge({column:0,row:0}),F=et(),q=et(),E=ge(!1),R=ge(0),V=ge(!0),K=ge(!1),Q=ge(!1);dt(le(w,Qe(R),He(([B,J])=>!!J)),()=>{Ye(V,!1)}),dt(le(nn(w,V,P,N,R,K),He(([B,J,be,pe,,H])=>B&&!J&&be.height!==0&&pe.height!==0&&!H)),([,,,,B])=>{Ye(K,!0),P0(1,()=>{Ye(L,B)}),ur(le(u),()=>{Ye(e,[0,0]),Ye(V,!0)})}),Ae(le(q,He(B=>B!=null&&B.scrollTop>0),Pr(0)),S),dt(le(w,Qe(q),He(([,B])=>B!=null)),([,B])=>{B&&(Ye(N,B.viewport),Ye(P,B.item),Ye(D,B.gap),B.scrollTop>0&&(Ye(E,!0),ur(le(u,_a(1)),J=>{Ye(E,!1)}),Ye(l,{top:B.scrollTop})))}),Ae(le(N,_e(({height:B})=>B)),h),Ae(le(nn(Ue(N,Mh),Ue(P,Mh),Ue(D,(B,J)=>B&&B.column===J.column&&B.row===J.row),Ue(u)),_e(([B,J,be,pe])=>({gap:be,item:J,scrollTop:pe,viewport:B}))),F),Ae(le(nn(Ue(C),s,Ue(D,J6),Ue(P,Mh),Ue(N,Mh),Ue($),Ue(S),Ue(E),Ue(V),Ue(R)),He(([,,,,,,,B])=>!B),_e(([B,[J,be],pe,H,ye,X,ue,,ce,de])=>{const{column:ie,row:Se}=pe,{height:oe,width:W}=H,{width:ke}=ye;if(ue===0&&(B===0||ke===0))return d_;if(W===0){const Mn=R0(de,B),Kn=Mn+Math.max(ue-1,0);return X6(p_(Mn,Kn,X))}const Re=K2(ke,W,ie);let Oe,ae;ce?J===0&&be===0&&ue>0?(Oe=0,ae=ue-1):(Oe=Re*mp((J+Se)/(oe+Se)),ae=Re*h_((be+Se)/(oe+Se))-1,ae=_g(B-1,gu(ae,Re-1)),Oe=_g(ae,gu(0,Oe))):(Oe=0,ae=-1);const te=p_(Oe,ae,X),{bottom:ne,top:je}=m_(ye,pe,H,te),Xt=h_(B/Re),Gs=Xt*oe+(Xt-1)*Se-ne;return{bottom:ne,itemHeight:oe,items:te,itemWidth:W,offsetBottom:Gs,offsetTop:je,top:je}})),j),Ae(le($,He(B=>B!==null),_e(B=>B.length)),C),Ae(le(nn(N,P,j,D),He(([B,J,{items:be}])=>be.length>0&&J.height!==0&&B.height!==0),_e(([B,J,{items:be},pe])=>{const{bottom:H,top:ye}=m_(B,pe,J,be);return[ye,H]}),Pt(nd)),e);const re=ge(!1);Ae(le(u,Qe(re),_e(([B,J])=>J||B!==0)),re);const ee=Ns(le(nn(j,C),He(([{items:B}])=>B.length>0),Qe(re),He(([[B,J],be])=>{const pe=B.items[B.items.length-1].index===J-1;return(be||B.bottom>0&&B.itemHeight>0&&B.offsetBottom===0&&B.items.length===J)&&pe}),_e(([[,B]])=>B-1),Pt())),z=Ns(le(Ue(j),He(({items:B})=>B.length>0&&B[0].index===0),Pr(0),Pt())),A=Ns(le(Ue(j),Qe(E),He(([{items:B},J])=>B.length>0&&!J),_e(([{items:B}])=>({endIndex:B[B.length-1].index,startIndex:B[0].index})),Pt(j2),ri(0)));Ae(A,p.scrollSeekRangeChanged),Ae(le(L,Qe(N,P,C,D),_e(([B,J,be,pe,H])=>{const ye=P2(B),{align:X,behavior:ue,offset:ce}=ye;let de=ye.index;de==="LAST"&&(de=pe-1),de=gu(0,de,_g(pe-1,de));let ie=Py(J,H,be,de);return X==="end"?ie=f_(ie-J.height+be.height):X==="center"&&(ie=f_(ie-J.height/2+be.height/2)),ce&&(ie+=ce),{behavior:ue,top:ie}})),l);const Y=Rn(le(j,_e(B=>B.offsetBottom+B.bottom)),0);return Ae(le(k,_e(B=>({height:B.visibleHeight,width:B.visibleWidth}))),N),{customScrollParent:x,data:$,deviation:O,footerHeight:r,gap:D,headerHeight:i,increaseViewportBy:t,initialItemCount:S,itemDimensions:P,overscan:n,restoreStateFrom:q,scrollBy:o,scrollContainerState:a,scrollHeight:I,scrollTo:l,scrollToIndex:L,scrollTop:u,smoothScrollTargetReached:d,totalCount:C,useWindowScroll:g,viewportDimensions:N,windowScrollContainerState:m,windowScrollTo:b,windowViewportRect:k,...p,gridState:j,horizontalDirection:Q,initialTopMostItemIndex:R,totalListHeight:Y,...f,endReached:ee,propsReady:y,rangeChanged:A,startReached:z,stateChanged:F,stateRestoreInProgress:E,..._}},At(A0,qn,Hd,D2,So,O0,_o));function K2(t,e,n){return gu(1,mp((t+n)/(mp(e)+n)))}function m_(t,e,n,s){const{height:r}=n;if(r===void 0||s.length===0)return{bottom:0,top:0};const i=Py(t,e,n,s[0].index);return{bottom:Py(t,e,n,s[s.length-1].index)+r,top:i}}function Py(t,e,n,s){const r=K2(t.width,n.width,e.column),i=mp(s/r),o=i*n.height+gu(0,i-1)*e.row;return o>0?o+e.row:o}const eU=at(()=>{const t=ge(h=>`Item ${h}`),e=ge({}),n=ge(null),s=ge("virtuoso-grid-item"),r=ge("virtuoso-grid-list"),i=ge(I0),o=ge("div"),a=ge(yc),l=(h,f=null)=>Rn(le(e,_e(p=>p[h]),Pt()),f),u=ge(!1),d=ge(!1);return Ae(Ue(d),u),{components:e,computeItemKey:i,context:n,FooterComponent:l("Footer"),HeaderComponent:l("Header"),headerFooterTag:o,itemClassName:s,ItemComponent:l("Item","div"),itemContent:t,listClassName:r,ListComponent:l("List","div"),readyStateChanged:u,reportReadyState:d,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}}),tU=at(([t,e])=>({...t,...e}),At(Z6,eU)),nU=ve.memo(function(){const t=Mt("gridState"),e=Mt("listClassName"),n=Mt("itemClassName"),s=Mt("itemContent"),r=Mt("computeItemKey"),i=Mt("isSeeking"),o=zs("scrollHeight"),a=Mt("ItemComponent"),l=Mt("ListComponent"),u=Mt("ScrollSeekPlaceholder"),d=Mt("context"),h=zs("itemDimensions"),f=zs("gap"),p=Mt("log"),w=Mt("stateRestoreInProgress"),y=zs("reportReadyState"),x=Oa(ve.useMemo(()=>g=>{const m=g.parentElement.parentElement.scrollHeight;o(m);const b=g.firstChild;if(b){const{height:k,width:_}=b.getBoundingClientRect();h({height:k,width:_})}f({column:g_("column-gap",getComputedStyle(g).columnGap,p),row:g_("row-gap",getComputedStyle(g).rowGap,p)})},[o,h,f,p]),!0,!1);return U2(()=>{t.itemHeight>0&&t.itemWidth>0&&y(!0)},[t]),w?null:c.jsx(l,{className:e,ref:x,...Pn(l,d),"data-testid":"virtuoso-item-list",style:{paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},children:t.items.map(g=>{const m=r(g.index,g.data,d);return i?c.jsx(u,{...Pn(u,d),height:t.itemHeight,index:g.index,width:t.itemWidth},m):v.createElement(a,{...Pn(a,d),className:n,"data-index":g.index,key:m},s(g.index,g.data,d))})})}),sU=ve.memo(function(){const t=Mt("HeaderComponent"),e=zs("headerHeight"),n=Mt("headerFooterTag"),s=Oa(ve.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,!1),r=Mt("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null}),rU=ve.memo(function(){const t=Mt("FooterComponent"),e=zs("footerHeight"),n=Mt("headerFooterTag"),s=Oa(ve.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,!1),r=Mt("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null}),iU=({children:t})=>{const e=ve.useContext(B2),n=zs("itemDimensions"),s=zs("viewportDimensions"),r=Oa(ve.useMemo(()=>i=>{s(i.getBoundingClientRect())},[s]),!0,!1);return ve.useEffect(()=>{e&&(s({height:e.viewportHeight,width:e.viewportWidth}),n({height:e.itemHeight,width:e.itemWidth}))},[e,s,n]),c.jsx("div",{ref:r,style:am(!1),children:t})},oU=({children:t})=>{const e=ve.useContext(B2),n=zs("windowViewportRect"),s=zs("itemDimensions"),r=Mt("customScrollParent"),i=v2(n,r,!1);return ve.useEffect(()=>{e&&(s({height:e.itemHeight,width:e.itemWidth}),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,n,s]),c.jsx("div",{ref:i,style:am(!1),children:t})},aU=ve.memo(function({...t}){const e=Mt("useWindowScroll"),n=Mt("customScrollParent"),s=n||e?cU:lU,r=n||e?oU:iU,i=Mt("context");return c.jsx(s,{...t,...Pn(s,i),children:c.jsxs(r,{children:[c.jsx(sU,{}),c.jsx(nU,{}),c.jsx(rU,{})]})})}),{useEmitter:G2,useEmitterValue:Mt,usePublisher:zs}=F2(tU,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},aU),lU=V2({useEmitter:G2,useEmitterValue:Mt,usePublisher:zs}),cU=q2({useEmitter:G2,useEmitterValue:Mt,usePublisher:zs});function g_(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,ls.WARN),e==="normal"?0:parseInt(e??"0",10)}function St({className:t,...e}){return c.jsx("div",{className:Pe("mmg-card rounded-2xl bg-white/70 dark:bg-white/5 backdrop-blur-xs shadow-soft","ring-1 ring-black/5 dark:ring-white/10",t),...e})}function Gt({className:t,...e}){return c.jsx("div",{className:Pe("p-5 pb-3",t),...e})}function Yt({className:t,...e}){return c.jsx("h3",{className:Pe("text-base font-semibold",t),...e})}function Qt({className:t,...e}){return c.jsx("div",{className:Pe("p-5 pt-0",t),...e})}const Sg=new Set,jg=6;function uU(){const t=Ks(),[e,n]=v.useState([]),[s,r]=v.useState(""),[i,o]=v.useState([]),[a,l]=v.useState(""),[u,d]=v.useState(!0),[h,f]=v.useState(!1),[p,w]=v.useState(null),[y,x]=v.useState(!1),g=v.useRef(null),m=v.useRef(null),b=v.useRef(null),k=v.useRef(null),_=v.useRef(0),C=v.useRef(!1);v.useEffect(()=>{fc()&&Promise.allSettled([t.prefetchQuery({queryKey:["mockup","eligibility","setup"],queryFn:o2}),t.prefetchQuery({queryKey:["mockup","eligibility","generate"],queryFn:a2})])},[t]),v.useEffect(()=>{console.log("[ChatPage] Mount - starting loadHistory, showing loading spinner");async function O(){var $,D;try{console.log("[ChatPage] Fetching history from API...");const F=await iB({limit:500,newestFirst:!0});if(console.log("[ChatPage] History received:",{messageCount:(($=F==null?void 0:F.messages)==null?void 0:$.length)||0}),(D=F==null?void 0:F.messages)!=null&&D.length){const q=F.messages.map(yU);n(q),w(F.session_id||null),d(!1),console.log("[ChatPage] Loading complete - hiding spinner, showing messages"),P();const E=q.flatMap(R=>R.files||[]).filter(R=>R==null?void 0:R.file_id).map(R=>R.file_id);E.length>0&&(console.log("[ChatPage] Loading URLs for",E.length,"attachments in background..."),oB(E).then(R=>{console.log("[ChatPage] Attachment URLs loaded:",Object.keys((R==null?void 0:R.urls)||{}).length),R!=null&&R.urls&&(n(V=>V.map(K=>({...K,files:(K.files||[]).map(Q=>{const re=R.urls[Q.file_id];if(re){const ee=typeof re=="string"?re:re.full||re.url;return{...Q,url:ee,width:re.width||Q.width,height:re.height||Q.height}}return Q})}))),P())}).catch(R=>{console.warn("[ChatPage] Failed to load attachment URLs:",R)}))}else console.log("[ChatPage] No history - showing greeting"),n([x_()]),d(!1),P()}catch(F){console.error("[ChatPage] Failed to load history:",F),n([x_()]),d(!1),P()}}O()},[]),v.useEffect(()=>{const O=sessionStorage.getItem("pendingChatRequest");if(O)try{const $=JSON.parse(O),{requestId:D,eventIndex:F,userMessage:q,timestamp:E,assistantMsgId:R}=$,V=5*60*1e3;if(Date.now()-E>V){console.log("[ChatPage] Pending request expired, clearing"),sessionStorage.removeItem("pendingChatRequest");return}console.log("[ChatPage] Found pending request, attempting resume:",D),x(!0);const K=crypto.randomUUID(),Q=R||crypto.randomUUID(),re={id:K,role:"user",content:q,files:[],status:null},ee={id:Q,role:"assistant",content:"",files:[],status:"Resuming"};n(A=>[...A,re,ee]),f(!0);let z="";lB({requestId:D,eventIndex:F||0,onEvent:A=>{var Y;if(_.current++,A!=null&&A.conversation_id&&w(B=>B||A.conversation_id),A!=null&&A.error){n(B=>B.map(J=>J.id===Q?{...J,status:null,content:`Error: ${A.error}`}:J));return}if((A==null?void 0:A.type)==="status"){n(B=>B.map(J=>J.id===Q?{...J,status:A.content||"Processing"}:J));return}if((A==null?void 0:A.type)==="delete"){n(B=>B.map(J=>J.id===Q?{...J,status:null}:J));return}if((A==null?void 0:A.type)==="tool_call"){const B=((Y=A.tool)==null?void 0:Y.name)||"processing";n(J=>J.map(be=>be.id===Q?{...be,status:`Processing ${B}`}:be));return}if(((A==null?void 0:A.type)==="chunk"||(A==null?void 0:A.type)==="content")&&A.content){z=A.type==="content"?A.content:z+A.content,n(B=>B.map(J=>J.id===Q?{...J,status:null,content:z}:J));return}if(A!=null&&A.content&&!A.type){z+=A.content,n(B=>B.map(J=>J.id===Q?{...J,status:null,content:z}:J));return}if(((A==null?void 0:A.type)==="files"||(A==null?void 0:A.type)==="file")&&(A.files||A.file||A.file_id)){const B=A.file||{},J=A.files||(A.file?[{file_id:B.file_id,url:B.url,filename:B.filename,title:B.title}]:[{file_id:A.file_id,url:A.url,filename:A.filename,title:A.title}]),be=B.comment||A.comment||"";be&&(z=be),n(pe=>pe.map(H=>H.id===Q?{...H,content:be||H.content,files:[...H.files||[],...J]}:H));return}},onDone:()=>{console.log("[ChatPage] Resume completed successfully"),sessionStorage.removeItem("pendingChatRequest"),n(A=>A.map(Y=>{var B;return Y.id===Q&&!Y.content&&!((B=Y.files)!=null&&B.length)?{...Y,status:null,content:"I'm ready to help. What would you like to do?"}:Y.id===Q?{...Y,status:null}:Y})),f(!1),x(!1)},onError:A=>{console.error("[ChatPage] Resume failed:",A),sessionStorage.removeItem("pendingChatRequest"),n(Y=>Y.map(B=>B.id===Q?{...B,status:null,content:"Failed to resume previous request. Please try again."}:B)),f(!1),x(!1)},onNotFound:()=>{console.log("[ChatPage] Request not found on server, clearing pending state"),sessionStorage.removeItem("pendingChatRequest"),n(A=>A.filter(Y=>Y.id!==K&&Y.id!==Q)),f(!1),x(!1)}})}catch($){console.error("[ChatPage] Error parsing pending request:",$),sessionStorage.removeItem("pendingChatRequest")}},[]);const S=v.useMemo(()=>(s.trim().length>0||i.length>0)&&!h,[s,i.length,h]),j=v.useMemo(()=>e.filter(O=>!O.is_tool_response),[e]),N=v.useCallback((O=!1)=>{var $,D;O?($=b.current)==null||$.scrollToIndex({index:"LAST",behavior:"auto",align:"end"}):(D=b.current)==null||D.scrollToIndex({index:"LAST",behavior:"smooth",align:"end"})},[]),P=v.useCallback(()=>{C.current||(C.current=!0,N(!0),requestAnimationFrame(()=>N(!0)),setTimeout(()=>N(!0),120))},[N]),L=v.useCallback((O,$)=>c.jsx("div",{className:"px-2 py-1.5",style:{contain:"layout"},children:c.jsx(fU,{msg:$})}),[]);async function I(){var K,Q;if(!S)return;const O=s.trim(),$=i,D=$.map(re=>({filename:re.name,preview_url:URL.createObjectURL(re)})),F=O||($.length===1?`Please process this file: ${$[0].name}`:`Please process these files: ${$.map(re=>re.name).join(", ")}`),q=crypto.randomUUID(),E={id:q,role:"user",content:O,files:D,status:null},R=crypto.randomUUID(),V={id:R,role:"assistant",content:"",files:[],status:"Thinking"};n(re=>[...re,E,V]),r(""),o([]),l(""),requestAnimationFrame(()=>N(!0));try{f(!0),(Q=(K=m.current)==null?void 0:K.abort)==null||Q.call(K);const re=new AbortController;m.current=re;let ee=[],z="";if($.length>0){const A=await Promise.all($.map(Y=>cB(Y)));if(A.some(Y=>!(Y!=null&&Y.file_id)))throw new Error("Upload failed");ee=A.map(Y=>Y.file_id),n(Y=>Y.map(B=>B.id===q?{...B,files:A.map((J,be)=>{var pe,H;return{file_id:J.file_id,filename:((pe=$[be])==null?void 0:pe.name)||J.filename||"Attachment",url:J.url,width:J.image_width,height:J.image_height,preview_url:(H=D[be])==null?void 0:H.preview_url}})}:B))}k.current=null,_.current=0,await aB({conversationId:p,message:F,fileIds:ee,signal:re.signal,onEvent:A=>{var Y;if(!re.signal.aborted){if(_.current++,A!=null&&A.request_id&&!k.current&&(k.current=A.request_id,sessionStorage.setItem("pendingChatRequest",JSON.stringify({requestId:A.request_id,eventIndex:0,userMessage:F,assistantMsgId:R,timestamp:Date.now()}))),k.current&&_.current%5===0){const B=sessionStorage.getItem("pendingChatRequest");if(B){const J=JSON.parse(B);J.eventIndex=_.current,sessionStorage.setItem("pendingChatRequest",JSON.stringify(J))}}if(A!=null&&A.conversation_id&&w(B=>B||A.conversation_id),A!=null&&A.error){n(B=>B.map(J=>J.id===R?{...J,status:null,content:`Error: ${A.error}`}:J));return}if((A==null?void 0:A.type)==="status"){const B=Q2(A.content||"Processing");n(J=>J.map(be=>be.id===R?{...be,status:B}:be));return}if((A==null?void 0:A.type)==="delete"){n(B=>B.map(J=>J.id===R?{...J,status:null}:J));return}if((A==null?void 0:A.type)==="tool_call"){const B=((Y=A.tool)==null?void 0:Y.name)||"processing";n(J=>J.map(be=>be.id===R?{...be,status:`Processing ${B}`}:be));return}if(((A==null?void 0:A.type)==="chunk"||(A==null?void 0:A.type)==="content")&&A.content){z=A.type==="content"?A.content:z+A.content,n(B=>B.map(J=>J.id===R?{...J,status:null,content:ad(z)}:J));return}if(A!=null&&A.content&&!A.type){z+=A.content,n(B=>B.map(J=>J.id===R?{...J,status:null,content:ad(z)}:J));return}if(((A==null?void 0:A.type)==="files"||(A==null?void 0:A.type)==="file")&&(A.files||A.file||A.file_id)){const B=A.file||{},J=A.files||(A.file?[{file_id:B.file_id,url:B.url,filename:B.filename,title:B.title}]:[{file_id:A.file_id,url:A.url,filename:A.filename,title:A.title}]),be=B.comment||A.comment||"";be&&(z=be),n(pe=>pe.map(H=>H.id===R?{...H,content:be||H.content,files:[...H.files||[],...J]}:H));return}}},onDone:()=>{sessionStorage.removeItem("pendingChatRequest"),k.current=null,_.current=0,n(A=>A.map(Y=>{var B;return Y.id===R&&!Y.content&&!((B=Y.files)!=null&&B.length)?{...Y,status:null,content:"I'm ready to help. What would you like to do?"}:Y.id===R?{...Y,status:null}:Y}))}})}catch(re){sessionStorage.removeItem("pendingChatRequest"),k.current=null,_.current=0,n(ee=>ee.map(z=>z.id===R?{...z,status:null,content:(re==null?void 0:re.message)||"Failed to get response"}:z))}finally{f(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(St,{className:"p-4 overflow-hidden flex-1 min-h-0",children:u?c.jsx("div",{className:"h-full flex items-center justify-center",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ve,{text:"Loading conversation"})})}):c.jsx(G6,{ref:b,className:"h-full scrollbar-thin",data:j,initialTopMostItemIndex:j.length-1,followOutput:"smooth",overscan:200,increaseViewportBy:{top:200,bottom:200},computeItemKey:(O,$)=>$.id,itemContent:L,skipAnimationFrameInResizeObserver:!0})}),c.jsxs(St,{className:"p-3",children:[a?c.jsx("div",{className:"mb-2 text-xs text-red-600 dark:text-red-300",children:a}):null,i.length>0&&c.jsx("div",{className:"mb-2 space-y-1",children:i.map((O,$)=>c.jsxs("div",{className:"flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:O.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>{o(D=>D.filter((F,q)=>q!==$)),l("")},children:""})]},`${O.name}-${O.size}-${$}`))}),c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:g,type:"file",className:"hidden",multiple:!0,onChange:O=>{const $=Array.from(O.target.files||[]);$.length&&(o(D=>{const F=Math.max(0,jg-D.length);if(F<=0)return l(`You can upload up to ${jg} files.`),D;const q=$.slice(0,F);return $.length>F?l(`You can upload up to ${jg} files.`):l(""),[...D,...q]}),O.target.value="")},accept:"image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var O;return(O=g.current)==null?void 0:O.click()},children:c.jsx(XC,{size:18})}),c.jsx(gU,{value:s,onChange:r,placeholder:"Type your message...",onEnter:I}),c.jsx(se,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!S,onClick:I,children:c.jsx(JC,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"AI can make mistakes. Verify important information."})]})]})}const L0=320,dU=200,Y2=320,hU=100,fU=ve.memo(function({msg:e}){var d;const n=e.role==="user",s=v.useMemo(()=>vU(e.content||""),[e.content]),r=!!e.status,i=e.files||[],o=i.some(h=>{const f=Ry((h==null?void 0:h.filename)||(h==null?void 0:h.url)||"");return["jpg","jpeg","png","gif","webp","bmp"].includes(f)}),a=i.some(h=>{const f=Ry((h==null?void 0:h.filename)||(h==null?void 0:h.url)||"");return f&&!["jpg","jpeg","png","gif","webp","bmp"].includes(f)}),l=o?L0:a?Y2:null,u=v.useMemo(()=>{const h={overflowWrap:"anywhere",wordBreak:"break-word"};return l?{...h,maxWidth:l}:h},[l]);return c.jsx("div",{className:n?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",n?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[r?c.jsx(xU,{text:e.status}):c.jsx("div",{dangerouslySetInnerHTML:{__html:s},style:u}),((d=e.files)==null?void 0:d.length)>0&&c.jsx("div",{className:"mt-2 space-y-1",children:e.files.map((h,f)=>c.jsx(pU,{file:h,isUser:n},h.file_id||`file-${f}`))})]})})}),pU=ve.memo(function({file:e,isUser:n}){const s=Ry(e.filename||e.url||""),r=["jpg","jpeg","png","gif","webp","bmp"].includes(s),i=e.filename||"Attachment",o=f=>f&&!f.startsWith("/api/"),a=e.preview_url||(o(e.url)?e.url:null),l=a;if(r){const f={width:L0,maxWidth:"100%"};return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",style:f,children:[c.jsx(mU,{src:a,fullUrl:l,alt:i,isUser:n}),!n&&l&&o(l)&&c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"})," Open"]})}),c.jsxs(se,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>y_(l,i),children:[c.jsx(wa,{size:14,className:"mr-1"})," Download"]})]})]})}const u=s==="pdf",d=s==="pdf",h={width:Y2,height:hU,maxWidth:"100%"};return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3 flex flex-col",style:h,children:[c.jsxs("div",{className:"flex items-start gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:[u?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Qv,{size:12})," PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:s?s.toUpperCase():"FILE"}),n?null:c.jsx("div",{className:"text-xs font-semibold text-black/80 dark:text-white/85 leading-5 truncate",children:i})]}),!n&&l&&c.jsxs("div",{className:"mt-auto pt-3 flex items-center gap-2",children:[d?c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"})," Open"]})}):null,c.jsxs(se,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>y_(l,i),children:[c.jsx(wa,{size:14,className:"mr-1"})," Download"]})]})]})}),mU=ve.memo(function({src:e,fullUrl:n,alt:s,isUser:r}){const i=e&&Sg.has(e),[o,a]=v.useState(i),[l,u]=v.useState(!1);v.useEffect(()=>{e&&Sg.has(e)?a(!0):e&&(a(!1),u(!1))},[e]);const d=v.useCallback(()=>{e&&Sg.add(e),a(!0)},[e]),h=v.useCallback(()=>{u(!0)},[]),f=v.useMemo(()=>({width:L0,height:dU,maxWidth:"100%"}),[]);if(l)return c.jsx("div",{className:"flex items-center justify-center bg-black/5 dark:bg-white/5 rounded-lg",style:f,children:c.jsx(FM,{className:"text-red-400",size:24})});const p=c.jsxs("div",{className:"relative overflow-hidden rounded-lg bg-black/5 dark:bg-white/5",style:{...f,contain:"layout"},children:[e?c.jsx("img",{src:e,alt:s,className:`w-full h-full object-contain transition-opacity duration-150 ${o?"opacity-100":"opacity-0"}`,onLoad:d,onError:h}):null,o?null:c.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})]});return!r&&n?c.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"block",children:p}):p});function gU({value:t,onChange:e,placeholder:n,onEnter:s}){const r=v.useRef(null);return v.useEffect(()=>{const i=r.current;i&&(i.style.height="0px",i.style.height=Math.min(i.scrollHeight,132)+"px")},[t]),c.jsx("textarea",{ref:r,rows:1,value:t,onChange:i=>e(i.target.value),onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),s==null||s())},placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function xU({text:t}){const e=Q2(t||"Thinking");return c.jsx("span",{className:"inline-flex items-center opacity-80",children:c.jsx(Ve,{text:e})})}function ad(t){return t?String(t).replace(/_+Building Proposal\.{3,}_+/gi,"Building Proposal").replace(/_?Building Proposal\.{3,}_?/gi,"Building Proposal"):""}function Q2(t){return t?ad(t).replace(/\s*\.{3,}$/,"").trim():"Thinking"}function yU(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||"assistant",content:ad(t.content||""),files:t.files||t.attachments||[],status:null,is_tool_response:!!t.is_tool_response}}function x_(){const t=new Date().getHours(),e=t>=5&&t<12?"morning":t<17?"afternoon":t<21?"evening":"night";return{id:crypto.randomUUID(),role:"assistant",content:`Good ${e}, how can I help?`,files:[],status:null}}function Ry(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length>1?n.pop().toLowerCase():""}async function y_(t,e){try{const n=fc(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{window.open(t,"_blank")}}function Ay(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function vU(t){if(!t)return"";t=ad(t);const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(u,d,h)=>(e.push({lang:d,code:h.trim()}),`__CODE_BLOCK_${e.length-1}__`));const s=[];n=n.replace(/`([^`]+)`/g,(u,d)=>(s.push(d),`__INLINE_CODE_${s.length-1}__`));const r=n.split(`
`),i=[];let o=!1,a=null;for(const u of r){const d=u.trim();if(/^_?Building Proposal\.{3,}_?$/i.test(d)){i.push("Building Proposal<br>");continue}const h=u.match(/^__CODE_BLOCK_(\d+)__$/);if(h){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const y=e[parseInt(h[1])];i.push(`<pre class="chat-code-block"><code>${Ay(y.code)}</code></pre>`);continue}const f=u.match(/^(#{1,6})\s+(.*)$/);if(f){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const y=f[1].length;i.push(`<h${y} class="chat-header">${Ih(f[2])}</h${y}>`);continue}const p=u.match(/^[-*]\s+(.*)$/);if(p){(!o||a!=="ul")&&(o&&i.push("</ol>"),i.push('<ul class="chat-list">'),o=!0,a="ul"),i.push(`<li>${Ih(p[1])}</li>`);continue}const w=u.match(/^\d+\.\s+(.*)$/);if(w){(!o||a!=="ol")&&(o&&i.push("</ul>"),i.push('<ol class="chat-numbered-list">'),o=!0,a="ol"),i.push(`<li>${Ih(w[1])}</li>`);continue}o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1),u.trim()===""?i.push("<br>"):i.push(Ih(u)+"<br>")}o&&i.push(a==="ul"?"</ul>":"</ol>");let l=i.join("");return s.forEach((u,d)=>{l=l.replace(`__INLINE_CODE_${d}__`,`<code class="chat-inline-code">${Ay(u)}</code>`)}),l}function Ih(t){return t?Ay(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>"):""}function Ee({label:t,children:e,className:n,labelClassName:s,withGap:r=!0}){return c.jsxs("label",{className:Pe("block",r&&"space-y-1",n),children:[c.jsx("div",{className:Pe("text-xs font-semibold text-black/60 dark:text-white/65",s),children:t}),e]})}function ot({value:t="",options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,className:i,contentClassName:o,useNativeSelect:a=!1}){const l=v.useMemo(()=>e.find(u=>u.value===t),[e,t]);return a?c.jsxs("select",{className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","disabled:opacity-60 disabled:cursor-not-allowed",i),value:t,onChange:u=>n==null?void 0:n(u.target.value),disabled:r,children:[s?c.jsx("option",{value:"",disabled:!0,children:s}):null,e.map(u=>c.jsx("option",{value:u.value,disabled:u.disabled,children:u.label},u.value))]}):r?c.jsxs("button",{type:"button",disabled:!0,className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Pe("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(ns,{size:16,className:"text-black/50 dark:text-white/60"})]}):c.jsxs(tm,{children:[c.jsx(nm,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Pe("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(ns,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx($d,{align:"start",className:Pe("min-w-[220px]",o),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(u=>{const d=u.value===t;return c.jsx(Ju,{disabled:u.disabled,onSelect:()=>{u.disabled||n==null||n(u.value)},className:Pe("cursor-pointer gap-0 py-1",d&&"bg-black/5 dark:bg-white/10 font-semibold"),children:c.jsx("span",{className:"min-w-0 truncate",children:u.label})},u.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]})}function bU({locations:t,timeOfDay:e,side:n,templateOptions:s,getTemplateKey:r,defaultFrameConfig:i,templateKey:o,setTemplateKey:a,venueType:l,timeOfDayDisabled:u,locationOptions:d}){const[h,f]=v.useState(""),p=o??h,w=a??f,[y,x]=v.useState(null),[g,m]=v.useState(i),[b,k]=v.useState(""),[_,C]=v.useState([]),[S,j]=v.useState(!1),[N,P]=v.useState([]),[L,I]=v.useState(!1),[O,$]=v.useState(""),D=ve.useRef([]),F=v.useMemo(()=>{const A=new Map;return s.forEach(Y=>{A.set(r(Y),Y)}),A},[r,s]),q=v.useMemo(()=>{const A=new Map;return(d||[]).forEach(Y=>{const B=(Y==null?void 0:Y.location_key)??(Y==null?void 0:Y.key)??(Y==null?void 0:Y.id)??(Y==null?void 0:Y.value)??Y;if(!B)return;const J=(Y==null?void 0:Y.display_name)??(Y==null?void 0:Y.name)??(Y==null?void 0:Y.label)??B;A.set(String(B),J)}),A},[d]),E=v.useMemo(()=>t.length?t.map(A=>q.get(String(A))||A).filter(Boolean).join(", "):"",[q,t]),R=(y==null?void 0:y.frame_count)||0,V=_.length>1,K=V&&!y,Q=V&&R&&_.length!==R,re=K?"Select a template to map multiple creatives to frames.":Q?`Upload exactly ${R} creatives to match the template frames.`:"",ee=t.length&&(_.length||b.trim())&&!L&&!re;v.useEffect(()=>{if(!p){x(null),m(i);return}const A=F.get(p);if(!A){x(null),m(i);return}x(A),m(yf(A.config,i))},[i,p,F]),v.useEffect(()=>{p&&w("")},[n,e,t,l,u]),v.useEffect(()=>{D.current=N},[N]),v.useEffect(()=>()=>{jU(D.current)},[]);async function z(){if(ee){$("");try{I(!0);const A=new FormData,Y=u?"all":e;A.append("location_key",t[0]||""),A.append("location_keys",JSON.stringify(t)),A.append("venue_type",l),y?(A.append("time_of_day",y.time_of_day||Y||"all"),A.append("side",y.side||n||"all"),A.append("specific_photo",y.photo),A.append("frame_config",JSON.stringify(g))):(A.append("time_of_day",Y||"all"),A.append("side",n||"all")),b.trim()?A.append("ai_prompt",b.trim()):_.length&&_.forEach(pe=>A.append("creative",pe.file));const B=await xB(A),J=await _U(B,E),be={id:crypto.randomUUID(),location:E,images:J};P(pe=>[be,...pe])}catch(A){$((A==null?void 0:A.message)||"Unable to generate mockup.")}finally{I(!1)}}}return{templateKey:p,setTemplateKey:w,aiPrompt:b,setAiPrompt:k,creativeFiles:_,setCreativeFiles:C,creativeDragActive:S,setCreativeDragActive:j,multiCreativeError:re,selectedTemplate:y,lastResults:N,generating:L,generateError:O,setGenerateError:$,onGenerate:z,canGenerate:ee}}function wU(t){const e=bU(t);return c.jsx(kU,{...t,...e})}function kU({locations:t,setLocations:e,venueType:n,setVenueType:s,setTemplateKey:r,locationOptions:i,locationsQuery:o,timeOfDay:a,setTimeOfDay:l,timeOfDayDisabled:u,sideDisabled:d,side:h,setSide:f,timeOfDayOptions:p,sideOptions:w,venueTypeOptions:y,templateKey:x,templateOptions:g,templatesQuery:m,templateThumbs:b,getTemplateKey:k,setCreativeFiles:_,creativeFiles:C,creativeDragActive:S,setCreativeDragActive:j,multiCreativeError:N,selectedTemplate:P,aiPrompt:L,setAiPrompt:I,generateError:O,setGenerateError:$,generating:D,onGenerate:F,canGenerate:q,lastResults:E,useNativeSelects:R}){const V=v.useMemo(()=>i.map(H=>{const ye=(H==null?void 0:H.key)??(H==null?void 0:H.id)??(H==null?void 0:H.value)??H,X=(H==null?void 0:H.name)??(H==null?void 0:H.label)??ye;return{value:ye,label:X}}),[i]),K=P==null?void 0:P.frame_count,Q=v.useMemo(()=>E.flatMap(H=>(H.images||[]).map((ye,X)=>({entryId:H.id,location:H.location,image:ye,index:X}))),[E]);function re(H){const ye=Array.from(H||[]).filter(Boolean);ye.length&&(_(X=>{const ue=[...X];return ye.forEach(ce=>{ue.some(ie=>ie.file.name===ce.name&&ie.file.size===ce.size&&ie.file.lastModified===ce.lastModified)||ue.push({id:crypto.randomUUID(),file:ce})}),ue}),I(""))}function ee(H){H.preventDefault(),j(!0)}function z(H){H.preventDefault(),j(!1)}function A(H){var ye;H.preventDefault(),j(!1),re((ye=H.dataTransfer)==null?void 0:ye.files)}function Y(H){_(ye=>ye.filter(X=>X.id!==H))}function B(){_([])}function J(H){I(H),H.trim()&&_([])}function be(){e([]),s("all"),l("all"),f("all"),r(""),_([]),I(""),$("")}const pe=v.useRef(null);return c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Mockup Generator"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[c.jsxs(Ee,{label:"Location",children:[c.jsx(ot,{value:t[0]||"",options:V,placeholder:"Select a location",onChange:H=>{e(H?[H]:[]),r("")},useNativeSelect:R}),o.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading locations"})}):null]}),c.jsx(Ee,{label:"Venue Type",children:c.jsx(ot,{value:n,options:y,onChange:H=>s(H),useNativeSelect:R})}),!u&&c.jsx(Ee,{label:"Time of Day",children:c.jsx(ot,{value:a,options:p,onChange:H=>l(H),useNativeSelect:R})}),!d&&c.jsx(Ee,{label:"Billboard Side",children:c.jsx(ot,{value:h,options:w,onChange:H=>f(H),useNativeSelect:R})})]}),t.length?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Templates (optional)"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Select a template or keep random."})]}),x?c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>r(""),children:"Use random"}):null]}),m.isLoading?c.jsx(Ve,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!m.isLoading&&!g.length?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:g.map(H=>{const ye=k(H),X=ye===x,ue=b[ye],ce=H.environment||n||"all",de=H.time_of_day||(u?"all":a)||"all",ie=H.side||(d?"all":h)||"all";return c.jsxs("div",{className:Pe("rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-left text-sm transition flex flex-col",X?"border-2":"hover:bg-black/5 dark:hover:bg-white/10"),style:X?{borderColor:"rgb(var(--brand-accent) / 0.6)",boxShadow:"0 0 0 1px rgb(var(--brand-accent) / 0.25)"}:void 0,children:[c.jsxs("button",{type:"button",onClick:()=>r(ye),className:"text-left flex flex-col flex-1",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:ue?c.jsx("img",{src:ue,alt:H.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-1",children:[c.jsx("div",{className:"font-semibold truncate",children:H.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[ce,"/",de,"/",ie," - ",H.frame_count," frame",H.frame_count>1?"s":""]})]})]}),c.jsx("div",{className:"pt-2",children:ue?c.jsx(se,{variant:"secondary",size:"sm",className:"w-full rounded-xl",asChild:!0,children:c.jsxs("a",{href:ue,target:"_blank",rel:"noreferrer",children:[c.jsx(ho,{size:16,className:"mr-2"}),"Open"]})}):c.jsx(se,{variant:"secondary",size:"sm",className:"w-full rounded-xl",disabled:!0,children:"Open"})})]},ye)})})]}):null,c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsxs(Ee,{label:"Upload Creative/Ad Image",children:[C.length?c.jsx("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:ee,onDragLeave:z,onDrop:A,children:c.jsxs("div",{className:"w-full space-y-2",children:[C.map(H=>c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("div",{className:"truncate",children:H.file.name}),c.jsx("button",{type:"button",className:"opacity-70 hover:opacity-100",onClick:ye=>{ye.preventDefault(),ye.stopPropagation(),Y(H.id)},children:"x"})]},H.id)),c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-black/50 dark:text-white/60",children:[c.jsxs("span",{children:[C.length," file",C.length>1?"s":""," selected"]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"underline",onClick:()=>{var H;return(H=pe.current)==null?void 0:H.click()},children:"Add more"}),c.jsx("button",{type:"button",className:"underline",onClick:B,children:"Clear all"})]})]})]})}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:ee,onDragLeave:z,onDrop:A,children:[c.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:"image/jpeg,image/png,image/webp,image/gif",onChange:H=>{re(H.target.files),H.target.value=""}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP, GIF up to 10MB each"})]}),c.jsx("input",{ref:pe,type:"file",multiple:!0,accept:"image/jpeg,image/png,image/webp,image/gif",className:"hidden",onChange:H=>{re(H.target.files),H.target.value=""}}),c.jsx("div",{className:"mt-2 text-xs text-black/55 dark:text-white/60",children:K?`Upload 1 image to reuse across ${K} frames, or upload exactly ${K} images (one per frame).`:"Upload 1 image to reuse across frames, or select a template to upload multiple images."}),N?c.jsx("div",{className:"mt-2 text-xs text-red-600 dark:text-red-300",children:N}):null]}),c.jsx(Ee,{label:"Or use AI prompt",children:c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px]",value:L,onChange:H=>J(H.target.value),placeholder:"Describe what you want to generate..."})})]}),O?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:O}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(se,{className:"rounded-2xl",onClick:F,disabled:!q,children:D?c.jsx(Ve,{text:"Generating Mockup"}):"Generate Mockup"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:be,disabled:D,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4",children:[!E.length&&!D?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,D?c.jsx(Ve,{text:"Processing mockup",className:"text-sm text-black/60 dark:text-white/65"}):null,E.length?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Mockups generated this session"}),Q.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:Q.map(H=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("a",{href:H.image.url,target:"_blank",rel:"noopener noreferrer",className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:H.image.url,alt:H.image.label||"Generated mockup",className:"w-full h-40 object-cover",loading:"lazy"})}),c.jsxs("div",{className:"mt-2 space-y-2",children:[H.location?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60 truncate",children:H.location}):null,c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:H.image.url,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:ye=>{ye.preventDefault(),w_(H.image.url,H.image.filename)},onKeyDown:ye=>{(ye.key==="Enter"||ye.key===" ")&&(ye.preventDefault(),w_(H.image.url,H.image.filename))},className:"inline-flex items-center",children:[c.jsx(wa,{size:14,className:"mr-1"}),"Download"]})})]})]})]},`${H.entryId}-img-${H.index}`))}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No images returned yet."})]}):null]})]})]})}function v_(t){return typeof Blob<"u"&&t instanceof Blob}async function _U(t,e){if(!t)return[];if(t instanceof Response){const i=await t.blob();return i?[Cg(i,e,1)]:[]}if(v_(t))return[Cg(t,e,1)];const n=t,s=(n==null?void 0:n.images)||(n==null?void 0:n.image_urls)||(n==null?void 0:n.urls)||(n==null?void 0:n.results)||(n==null?void 0:n.files)||(n==null?void 0:n.data)||null,r=Array.isArray(s)?s:n!=null&&n.url?[n.url]:[];return r.length?r.map((i,o)=>{if(typeof i=="string")return b_(i,e,o+1);if(v_(i))return Cg(i,e,o+1);const a=(i==null?void 0:i.url)||(i==null?void 0:i.image_url)||(i==null?void 0:i.file_url)||"";return b_(a,e,o+1)}):[]}function Cg(t,e,n){const s=URL.createObjectURL(t),r=Oy(s,e,n);return{url:s,filename:r}}function b_(t,e,n){return t?{url:t,filename:Oy(t,e,n)}:{url:"",filename:Oy("",e,n)}}function Oy(t,e,n){const s=SU(t);if(s)return s;const r=(e||"result").toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),i=n?`_${n}`:"";return`mockup_${r||"result"}${i}.jpg`}function SU(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function jU(t){(Array.isArray(t)?t:[]).forEach(n=>{((n==null?void 0:n.images)||[]).forEach(s=>{var r;(r=s==null?void 0:s.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(s.url)})})}async function w_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e||"download",document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function CU(t,e,n){return t.length?t.length<=n?t.join(", "):`${t.slice(0,n).join(", ")} +${t.length-n}`:e}function NU({value:t=[],options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,maxLabelCount:i=2,className:o,contentClassName:a}){const l=v.useMemo(()=>new Set(t),[t]),u=v.useMemo(()=>e.filter(f=>l.has(f.value)).map(f=>f.label),[e,l]);function d(f){r||n&&(l.has(f)?n(t.filter(p=>p!==f)):n([...t,f]))}const h=CU(u,s,i);return c.jsxs("div",{className:"space-y-2",children:[c.jsxs(tm,{children:[c.jsx(nm,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",o),children:[c.jsx("span",{className:Pe("truncate",!u.length&&"text-black/50 dark:text-white/55"),children:h}),c.jsx(ns,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx($d,{align:"start",className:Pe("min-w-[220px]",a),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(f=>{const p=l.has(f.value);return c.jsxs(Ju,{onSelect:w=>{w.preventDefault(),d(f.value)},className:"cursor-pointer py-1",children:[c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",p?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(da,{size:10,className:p?"opacity-100":"opacity-0"})}),c.jsx("span",{className:"min-w-0 truncate",children:f.label})]},f.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]}),u.length?c.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(f=>c.jsx("span",{className:"text-[11px] rounded-md bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/70 px-2",children:f},f))}):null]})}function EU({locations:t,setLocations:e,venueType:n,setVenueType:s,assetType:r,setAssetType:i,setTemplateKey:o,locationOptions:a,locationsQuery:l,assetTypeOptions:u,assetTypesQuery:d,timeOfDay:h,setTimeOfDay:f,timeOfDayDisabled:p,sideDisabled:w,side:y,setSide:x,timeOfDayOptions:g,sideOptions:m,venueTypeOptions:b,editingTemplate:k,editingTemplateLoading:_,stopEditTemplate:C,templatesOpen:S,setTemplatesOpen:j,templateOptions:N,templatesQuery:P,templateThumbs:L,getTemplateKey:I,startEditTemplate:O,deleteTemplate:$,setupPhoto:D,setSetupPhoto:F,handleSetupPhoto:q,handleSetupDragOver:E,handleSetupDragLeave:R,handleSetupDrop:V,setupDragActive:K,handleSetupPhotoClear:Q,framesJson:re,setFramesJson:ee,setFramesJsonDirty:z,applyFramesJsonToCanvas:A,buildFramesPayload:Y,setupImageReady:B,greenscreenOpen:J,setGreenscreenOpen:be,greenscreenColor:pe,setGreenscreenColor:H,greenscreenDetecting:ye,colorTolerance:X,setColorTolerance:ue,RangeField:ce,handleGreenscreenDetect:de,canDetectGreenscreen:ie,hasActiveFrame:Se,frameSettingsOpen:oe,setFrameSettingsOpen:W,setupFrameConfig:ke,handleSetupFrameConfigChange:Re,FrameConfigControls:Oe,previewOpen:ae,setPreviewOpen:te,testPreviewMode:ne,setTestPreviewMode:je,testPreviewImgRef:Xt,testPreviewUrlRef:Gs,previewImgRef:Mn,drawPreview:Kn,activeTestCreativeFile:Ys,updateTestCreativeForActive:Ur,generateTestPreview:xr,testPreviewing:lt,activeFrameIndex:ct,canvasRef:ft,canvasWidth:dn,canvasHeight:vi,handleCanvasPointerDown:Co,handleCanvasPointerMove:Ia,handleCanvasPointerUp:No,handleCanvasWheel:Da,setupHint:Vd,handleZoomOut:qd,handleZoomIn:Ot,handleFitToScreen:pt,zoomPercent:Qs,pixelUpscale:Xs,setPixelUpscale:us,setupError:kc,setupMessage:Eo,addFrame:_c,resetCurrentFrame:ds,saveSetup:ut,setupSaving:mt,clearAllFrames:La,currentPoints:_n,frameCount:Sn,useNativeSelects:bi}){var Yd,jc,Cc;const[hs,To]=v.useState({open:!1,template:null}),[wi,$a]=v.useState(!1),Sc=((Yd=hs.template)==null?void 0:Yd.time_of_day)||"all",Po=((jc=hs.template)==null?void 0:jc.side)||"all",Fa=((Cc=hs.template)==null?void 0:Cc.storage_key)||"",hm=Fa?` for ${Fa}`:"",fm=hs.template?`Delete "${hs.template.photo}" (${Sc}/${Po})${hm}? This removes the photo and its frames.`:"Delete this template? This removes the photo and its frames.";async function Kd(){if(!(!hs.template||wi)){$a(!0);try{await $(hs.template)}finally{$a(!1),To({open:!1,template:null})}}}function Gd(){wi||To({open:!1,template:null})}return c.jsxs(c.Fragment,{children:[c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Mockup Setup"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[c.jsxs(Ee,{label:"Location",children:[c.jsx(NU,{value:t,onChange:he=>{e(he),o("")},options:a.map(he=>{const jn=(he==null?void 0:he.key)??(he==null?void 0:he.id)??(he==null?void 0:he.value)??he,za=(he==null?void 0:he.name)??(he==null?void 0:he.label)??jn;return{value:jn,label:za}}),placeholder:"Select locations"}),l.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading locations"})}):null]}),c.jsxs(Ee,{label:"Asset Type",children:[c.jsx(ot,{value:r,options:[{value:"",label:"All asset types"},...u.map(he=>typeof he=="string"?{value:he,label:he}:{value:(he==null?void 0:he.type_key)??(he==null?void 0:he.key)??(he==null?void 0:he.id)??(he==null?void 0:he.value)??"",label:(he==null?void 0:he.name)??(he==null?void 0:he.label)??(he==null?void 0:he.type_key)??"Unknown"})],placeholder:"Select asset type",onChange:he=>i(he),useNativeSelect:bi}),d!=null&&d.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading asset types"})}):null]}),c.jsx(Ee,{label:"Venue Type",children:c.jsx(ot,{value:n,options:b,placeholder:"Select venue type",onChange:he=>s(he),useNativeSelect:bi})}),!p&&c.jsx(Ee,{label:"Time of Day",children:c.jsx(ot,{value:h,options:g,placeholder:"Select time of day",onChange:he=>f(he),useNativeSelect:bi})}),!w&&c.jsx(Ee,{label:"Billboard Side",children:c.jsx(ot,{value:y,options:m,placeholder:"Select side",onChange:he=>x(he),useNativeSelect:bi})})]}),k?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/50 dark:bg-white/5 px-4 py-3 flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:"Editing template:"})," ",k.photo," (",k.time_of_day,"/",k.side,")"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[_?c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"}):null,c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,children:"Stop editing"})]})]}):null,k?null:c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>j(he=>!he),"aria-expanded":S,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Existing templates"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:t.length?`${N.length} template${N.length===1?"":"s"}`:"Select at least one location to load templates."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:S?"Hide":"Show"}),c.jsx(ns,{size:16,className:Pe("transition-transform",S&&"rotate-180")})]})]}),S?c.jsxs("div",{className:"mt-3 space-y-2",children:[P.isLoading?c.jsx(Ve,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!P.isLoading&&(!N.length||!t.length)?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:N.map(he=>{const jn=I(he);return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:L[jn]?c.jsx("img",{src:L[jn],alt:he.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-2",children:[c.jsx("div",{className:"font-semibold truncate",children:he.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[he.time_of_day,"/",he.side," - ",he.frame_count," frame",he.frame_count>1?"s":""]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>O(he),disabled:_||wi,children:"Edit"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>To({open:!0,template:he}),disabled:wi,children:"Delete"})]})]})]},jn)})})]}):null]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Upload Billboard Photo",children:D?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${K?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:E,onDragLeave:R,onDrop:V,children:[c.jsx("div",{className:"truncate",children:D.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:Q,children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${K?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:E,onDragLeave:R,onDrop:V,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp",onChange:he=>{var za;const jn=(za=he.target.files)==null?void 0:za[0];jn&&(F(jn),q(jn))}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP up to 20MB"})]})}),c.jsxs(Ee,{label:"Frames Data",children:[c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px] font-mono",value:re,onChange:he=>{ee(he.target.value),z(!0)},placeholder:'[{"points":[0,0,0,0],"config":{"brightness":100}}]'}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-black/50 dark:text-white/60",children:[c.jsx("span",{children:"Auto-filled from canvas. Edit to override."}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"text-xs underline",onClick:A,children:"Apply to canvas"}),c.jsx("button",{type:"button",className:"text-xs underline",onClick:()=>{z(!1);const he=Y();ee(he.length?JSON.stringify(he,null,2):"[]")},children:"Sync from canvas"})]})]})]})]}),B?c.jsxs(c.Fragment,{children:[c.jsxs(zt,{className:"bg-white/50 dark:bg-white/5 p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>be(he=>!he),"aria-expanded":J,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Green Screen Detection"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Detect billboard frame using chroma key."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:J?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",J&&"rotate-180")})]})]}),J?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"color",value:pe,onChange:he=>H(he.target.value.toUpperCase()),className:"h-10 w-16 rounded-lg border border-black/10 dark:border-white/20"}),c.jsx("input",{type:"text",value:pe,onChange:he=>H(he.target.value.toUpperCase()),className:"flex-1 rounded-xl bg-white/70 dark:bg-white/10 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none font-mono"})]}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Tip: Shift+click to pick a color. Shift+drag or middle mouse pans."}),c.jsx(ce,{label:"Color Tolerance",value:X,min:10,max:100,onChange:he=>ue(he),helper:"Lower is stricter, higher is more forgiving."}),c.jsx(se,{className:"rounded-2xl w-full",onClick:de,disabled:!ie||ye,children:ye?c.jsx(Ve,{text:"Detecting"}):"Detect Green Screen Now"})]}):null]}),Se?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>W(he=>!he),"aria-expanded":oe,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Current Frame Settings"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Adjust the current frame appearance."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:oe?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",oe&&"rotate-180")})]})]}),oe?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsx(Oe,{config:ke,onChange:Re}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Settings apply to the current frame only."})]}):null]}):null,Se?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>te(he=>!he),"aria-expanded":ae,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Test Preview Mode"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Preview creative on the current frame before saving."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:ae?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",ae&&"rotate-180")})]})]}),ae?c.jsxs("div",{className:"mt-3 space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3 text-sm",children:[c.jsx("input",{type:"checkbox",checked:ne,onChange:he=>{je(he.target.checked),he.target.checked||(Xt.current=null,Gs.current="",Kn())}}),c.jsx("span",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Enable preview"})]}),ne?c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-semibold text-blue-900 dark:text-blue-100",children:"Upload Test Creative"}),c.jsx("input",{type:"file",accept:"image/*",onChange:he=>{var jn;return Ur(((jn=he.target.files)==null?void 0:jn[0])||null)},className:"w-full text-sm"}),Ys?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Selected: ",Ys.name]}):null,c.jsx(se,{className:"rounded-2xl w-full",onClick:xr,disabled:!Ys||!D||!Se||lt,children:lt?c.jsx(Ve,{text:"Generating"}):"Generate Test Preview"}),ct>=0?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Preview applies to frame ",ct+1,"."]}):null]}):null]}):null]}):null]}):null]}),B?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-2",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:qd,disabled:!Mn.current,children:"-"}),c.jsx(se,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:Ot,disabled:!Mn.current,children:"+"}),c.jsx(se,{variant:"ghost",size:"sm",onClick:pt,disabled:!Mn.current,children:"Fit"}),c.jsxs("span",{className:"text-xs text-black/60 dark:text-white/60",children:[Qs,"%"]})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-black/70 dark:text-white/70",children:[c.jsx("input",{type:"checkbox",checked:Xs,onChange:he=>us(he.target.checked)}),"Pixel Upscale"]})]}),c.jsx("canvas",{ref:ft,width:dn,height:vi,className:"w-full h-auto rounded-xl border border-black/10 dark:border-white/10 bg-white",onPointerDown:Co,onPointerMove:Ia,onPointerUp:No,onPointerLeave:No,onWheel:Da,style:{touchAction:"none"}}),c.jsx("div",{className:"text-xs text-black/60 dark:text-white/60",children:Vd})]}):c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-black/5 dark:bg-white/10 px-4 py-3 text-sm text-black/60 dark:text-white/65",children:"Upload a billboard photo or pick an existing template to enable the canvas tools."})]}),kc?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:kc}):null,Eo?c.jsx("div",{className:"rounded-xl bg-green-50/70 text-green-700 px-4 py-2 text-sm dark:bg-green-500/10 dark:text-green-200",children:Eo}):null,c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(se,{className:"rounded-2xl",onClick:_c,disabled:_n.length!==4,children:"Add Frame"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:ds,children:"Reset Current Frame"}),c.jsx(se,{className:"rounded-2xl",onClick:ut,disabled:mt||!t.length||!D,children:mt?c.jsx(Ve,{text:"Saving"}):k?"Save Changes":"Save All Frames"}),c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>La(!1),children:"Clear All Frames"})]}),Sn?c.jsxs("div",{className:"rounded-xl bg-blue-50/70 text-blue-900 px-3 py-2 text-sm dark:bg-blue-500/10 dark:text-blue-100",children:["Frames configured: ",Sn]}):null]})]}),c.jsx(gc,{open:hs.open,message:fm,onClose:Gd,onConfirm:Kd})]})}const X2=[{value:"all",label:"All (Default)"},{value:"day",label:"Day"},{value:"night",label:"Night"}],TU=X2.filter(t=>t.value!=="all"),J2=[{value:"all",label:"All (Default)"},{value:"gold",label:"Gold"},{value:"silver",label:"Silver"},{value:"single_side",label:"Single Side"}],PU=J2.filter(t=>t.value!=="all"),Z2=[{value:"all",label:"All (Default)"},{value:"outdoor",label:"Outdoor"},{value:"indoor",label:"Indoor"}],RU=Z2.filter(t=>t.value!=="all"),k_=!1,Dh=1200,Lh=800,AU=.5,OU=4,__=.1,MU=4,Uo={brightness:100,contrast:100,saturation:100,depthMultiplier:15,lightDirection:"top",imageBlur:0,edgeBlur:1,overlayOpacity:0,shadowIntensity:0,lightingAdjustment:0,colorTemperature:0,vignette:0,edgeSmoother:3,sharpening:0},eT=[{value:"top-left",label:"Top Left",glyph:""},{value:"top",label:"Top",glyph:""},{value:"top-right",label:"Top Right",glyph:""},{value:"left",label:"Left",glyph:""},{value:"center",label:"Center",glyph:""},{value:"right",label:"Right",glyph:""},{value:"bottom-left",label:"Bottom Left",glyph:""},{value:"bottom",label:"Bottom",glyph:""},{value:"bottom-right",label:"Bottom Right",glyph:""}],IU=eT.reduce((t,e)=>(t[e.value]=e.label,t),{});function DU(t,e,n){const s=(t-e)/(n-e)*100;return`linear-gradient(to right, rgb(var(--brand-accent, 102 126 234)) ${s}%, rgba(0, 0, 0, 0.1) ${s}%)`}function LU(){var ub,db;const t=Ks(),{user:e}=fi(),n=vf(e,"sales:mockups:setup"),s=Kt({queryKey:["service-visibility"],queryFn:k0,staleTime:3e4}),r=((ub=s.data)==null?void 0:ub.mockup_generate)!==!1,i=((db=s.data)==null?void 0:db.mockup_setup)!==!1,o=()=>r?"generate":i&&n?"setup":"history",[a,l]=v.useState(o);v.useEffect(()=>{a==="generate"&&!r?l(i&&n?"setup":"history"):a==="setup"&&!i&&l(r?"generate":"history")},[r,i,n,a]);const[u,d]=v.useState([]),[h,f]=v.useState("all"),[p,w]=v.useState(""),[y,x]=v.useState("all"),[g,m]=v.useState("all"),[b,k]=v.useState(""),_=u[0]||"",C=h==="indoor",S=C,j=C,N=S?"all":y;v.useEffect(()=>{h==="indoor"&&(y&&x(""),g&&m(""))},[h]);const P=v.useRef(a),[L,I]=v.useState(null),[O,$]=v.useState(!1),[D,F]=v.useState(""),[q,E]=v.useState(""),[R,V]=v.useState("[]"),[K,Q]=v.useState(!1),[re,ee]=v.useState({}),[z,A]=v.useState(null),[Y,B]=v.useState(!1),[J,be]=v.useState(!1),[pe,H]=v.useState("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),[ye,X]=v.useState(Uo),[ue,ce]=v.useState("#1CFF1C"),[de,ie]=v.useState(40),[Se,oe]=v.useState(!1),[W,ke]=v.useState([]),[Re,Oe]=v.useState(0),[ae,te]=v.useState(1),[ne,je]=v.useState(!1),[Xt,Gs]=v.useState(-1),[Mn,Kn]=v.useState(!1),[Ys,Ur]=v.useState(!0),[xr,lt]=v.useState(!0),[ct,ft]=v.useState(!0),[dn,vi]=v.useState(!0),[Co,Ia]=v.useState(!1),[No,Da]=v.useState({}),[Vd,qd]=v.useState(!1),Ot=v.useRef(null),pt=v.useRef(null),Qs=v.useRef(null),Xs=v.useRef(""),us=v.useRef(new Map),kc=v.useRef({}),Eo=v.useRef({}),_c=v.useRef([]),ds=v.useRef(!1),ut=v.useRef([]),mt=v.useRef([]),La=v.useRef(-1),_n=v.useRef({zoom:1,panX:0,panY:0}),Sn=v.useRef({isDrawing:!1,isDraggingCorner:!1,isDraggingFrame:!1,dragFrameIndex:-1,dragPointIndex:-1,startX:0,startY:0,isPanning:!1,shiftPanPending:!1,hasPanned:!1,panStartX:0,panStartY:0,panOriginX:0,panOriginY:0}),bi=v.useRef({pointers:new Map,isPinching:!1,startDistance:0,startZoom:1,startPanX:0,startPanY:0,startCenterX:0,startCenterY:0}),hs=v.useRef({drawX:0,drawY:0,drawW:0,drawH:0,scale:1,imgNaturalW:0,imgNaturalH:0}),To=Kt({queryKey:["mockup","eligibility","setup"],queryFn:o2,enabled:a==="setup"}),wi=Kt({queryKey:["mockup","eligibility","generate"],queryFn:a2,enabled:a==="generate"}),$a=Kt({queryKey:["mockup","asset-types"],queryFn:uB,enabled:a==="setup"}),Sc=Kt({queryKey:["mockup","templates",_,N,g,h],queryFn:()=>qk(_,{timeOfDay:N,side:g,venueType:h}),enabled:a==="generate"&&!!_}),Po=RM({queries:a==="setup"?u.map(T=>({queryKey:["mockup","templates",T,N,g,h],queryFn:()=>qk(T,{timeOfDay:N,side:g,venueType:h}),enabled:!!T,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:!1,staleTime:1/0})):[]}),Fa=v.useMemo(()=>{var G;return{data:Po.flatMap((U,me)=>{const Z=U.data,we=Array.isArray(Z)?Z:(Z==null?void 0:Z.templates)||[],Te=u[me];return we.map(Le=>({...Le,storage_key:Le.storage_key||Te}))}),isLoading:Po.some(U=>U.isLoading),isFetching:Po.some(U=>U.isFetching),error:((G=Po.find(U=>U.error))==null?void 0:G.error)||null}},[u,Po]);v.useEffect(()=>()=>{us.current.forEach(T=>{T!=null&&T.url&&URL.revokeObjectURL(T.url)}),us.current.clear(),Xs.current&&URL.revokeObjectURL(Xs.current)},[]),v.useEffect(()=>{kc.current=No},[No]),v.useEffect(()=>{Eo.current=re},[re]);const hm=v.useMemo(()=>{const T=To.data;return Array.isArray(T)?T:(T==null?void 0:T.locations)||[]},[To.data]),fm=v.useMemo(()=>{const T=wi.data;return Array.isArray(T)?T:(T==null?void 0:T.locations)||[]},[wi.data]),Kd=a==="setup"?hm:fm,Gd=a==="setup"?To:wi,Yd=v.useMemo(()=>{const T=$a.data;return Array.isArray(T)?T:(T==null?void 0:T.asset_types)||(T==null?void 0:T.types)||[]},[$a.data]),jc=v.useMemo(()=>{const T=Sc.data;return Array.isArray(T)?T:(T==null?void 0:T.templates)||[]},[Sc.data]),Cc=v.useMemo(()=>{const T=Fa.data;return Array.isArray(T)?T:(T==null?void 0:T.templates)||[]},[Fa.data]),he=a==="setup"?Cc:jc,jn=v.useMemo(()=>he.map(T=>wr(T)).join("|"),[he,wr]);v.useEffect(()=>{_c.current=he},[he]),v.useEffect(()=>{P.current!==a&&(P.current==="setup"&&z&&tb(),d([]),a==="setup"?(f(""),w(""),x(""),m("")):(f("all"),w(""),x("all"),m("all")),k("")),P.current=a},[z,a]),v.useEffect(()=>{h==="indoor"&&y&&x("")},[y,h]),v.useEffect(()=>{ee(T=>{const G=new Set(_c.current.map(Z=>wr(Z))),U={};let me=!1;return Object.entries(T).forEach(([Z,we])=>{G.has(Z)?U[Z]=we:we&&(me=!0,URL.revokeObjectURL(we))}),me?U:T})},[jn,wr]),v.useEffect(()=>{let T=!0;const G=_c.current;if(!_||!G.length)return()=>{};const U=G.filter(me=>!Eo.current[wr(me)]);return U.length?((async()=>{const me=await Promise.all(U.map(async we=>{const Te=wr(we);let Le="";try{Le=await yB(we.storage_key||_,we.photo,{timeOfDay:we.time_of_day||N,side:we.side||g,company:we.company,venueType:we.venue_type||we.environment||h})}catch{Le=""}return{key:Te,url:Le}}));if(!T){me.forEach(({url:we})=>{we&&URL.revokeObjectURL(we)});return}const Z={};me.forEach(({key:we,url:Te})=>{Te&&!Eo.current[we]?Z[we]=Te:Te&&URL.revokeObjectURL(Te)}),Object.keys(Z).length>0&&ee(we=>({...we,...Z}))})(),()=>{T=!1}):()=>{}},[_,jn,N,g,h,wr]),v.useEffect(()=>()=>{Object.values(Eo.current).forEach(T=>{T&&URL.revokeObjectURL(T)})},[]);const za=!!pt.current,UT=W.length===4||Xt>=0,Js=Xt>=0?`frame-${Xt}`:W.length===4?"current":null,Z0=Js?No[Js]:null,HT=Math.round(ae*100);v.useEffect(()=>{if(!Js){Qs.current=null,Xs.current="";return}const T=us.current.get(Js);Qs.current=(T==null?void 0:T.img)||null,Xs.current=(T==null?void 0:T.url)||"",Co&&yt()},[Js,No,Co]),v.useEffect(()=>{pt.current&&Nc(),yt()},[Co]),v.useEffect(()=>{yt()},[ne]),v.useEffect(()=>{Mn&&pt.current&&yt()},[Mn]),v.useEffect(()=>{if(K)return;const T=Ba();V(T.length?JSON.stringify(T,null,2):"[]")},[W,Re,ye,K]);async function WT(){F(""),E("");const T=z?wr(z):null;if(!u.length){E("Select at least one location first");return}if(!L){E("Upload a billboard photo first");return}let G=Ba();if(R.trim())try{G=JSON.parse(R)}catch(U){E((U==null?void 0:U.message)||"Frames JSON is invalid");return}if(!Array.isArray(G)||!G.length){E("Add at least one frame before saving");return}try{$(!0);const U=new FormData;z?(U.append("location_key",z.storage_key||_),U.append("photo_filename",z.photo),U.append("venue_type",h),p&&U.append("asset_type_key",p),U.append("time_of_day",N||"all"),U.append("side",g||"all"),U.append("frames_data",JSON.stringify(G)),L&&L.name!==z.photo&&U.append("photo",L),await hB(U),F("Updated frames successfully")):(U.append("location_keys",JSON.stringify(u)),U.append("venue_type",h),p&&U.append("asset_type_key",p),U.append("time_of_day",N||"all"),U.append("side",g||"all"),U.append("frames_data",JSON.stringify(G)),U.append("photo",L),await dB(U),F("Saved frames successfully")),cb(!0),A(null),B(!1),I(null),pt.current=null,Kn(!1),T&&ee(me=>{if(!me[T])return me;const Z={...me},we=Z[T];return we&&URL.revokeObjectURL(we),delete Z[T],Z}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"}),yt()}catch(U){E((U==null?void 0:U.message)||"Failed to save template")}finally{$(!1)}}async function VT(T){const G=(T==null?void 0:T.storage_key)||_;if(!G||!(T!=null&&T.photo))return;const U=(T==null?void 0:T.environment)||(T==null?void 0:T.venue_type)||"outdoor",me=T!=null&&T.time_of_day&&T.time_of_day!=="all"?T.time_of_day:"day",Z=T!=null&&T.side&&T.side!=="all"?T.side:"gold";try{T!=null&&T.company?await mB({company:T.company,locationKey:G,environment:U,timeOfDay:me,side:Z,photoFilename:T.photo}):await fB(G,T.photo,{timeOfDay:T.time_of_day,side:T.side}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"})}catch(we){E((we==null?void 0:we.message)||"Failed to delete template")}}function eb(T,{resetFrames:G=!0}={}){pt.current=T,Kn(!0);const U=tP(T.naturalWidth,T.naturalHeight);hs.current={drawX:U.x,drawY:U.y,drawW:U.w,drawH:U.h,scale:U.scale,imgNaturalW:T.naturalWidth,imgNaturalH:T.naturalHeight},gm(!1),G&&(ut.current=[],mt.current=[],Rs(),ds.current=!1,uP(),Qd(),fs(),Ao(),V("[]"),Q(!1)),Nc(),yt()}function qT(T,G){return new Promise((U,me)=>{const Z=new Image;Z.onload=()=>{eb(Z,G),U()},Z.onerror=()=>me(new Error("Failed to load image")),Z.src=T})}function KT(T,G){return new Promise((U,me)=>{const Z=new FileReader;Z.onload=we=>{const Te=new Image;Te.onload=()=>{eb(Te,G),U()},Te.onerror=()=>me(new Error("Failed to load image")),Te.src=we.target.result},Z.onerror=()=>me(new Error("Failed to read image")),Z.readAsDataURL(T)})}function pm(T){return T?Array.isArray(T)&&T.length===4&&Array.isArray(T[0])?T:Array.isArray(T)&&T.length>=8&&typeof T[0]=="number"?[[T[0],T[1]],[T[2],T[3]],[T[4],T[5]],[T[6],T[7]]]:null:null}function GT(T){if(!T)return[];let G=T.frames||T.frames_data||T.framesData||T.frame_data||T.frame_points;if(typeof G=="string")try{G=JSON.parse(G)}catch{G=[]}return Array.isArray(G)?G.map(U=>{const me=pm((U==null?void 0:U.points)||(U==null?void 0:U.frame_points)||U)||pm(U==null?void 0:U.points);if(!me)return null;let Z=(U==null?void 0:U.config)||(T==null?void 0:T.config);if(typeof Z=="string")try{Z=JSON.parse(Z)}catch{Z=null}const we=yf(Z,Uo);return{points:me,config:we,source:"existing"}}).filter(Boolean):[]}async function YT(T){if(!(!_||!(T!=null&&T.photo))){A(T),B(!0),E(""),F(""),I(null);try{const G=T.venue_type||T.environment||"outdoor",U=T.time_of_day&&T.time_of_day!=="all"?T.time_of_day:"day",me=T.side&&T.side!=="all"?T.side:"gold";f(G),G==="indoor"?(x(""),m("")):(T.time_of_day&&T.time_of_day!=="all"?x(T.time_of_day):x(""),T.side&&T.side!=="all"?m(T.side):m(""));const Z=await i2(T.storage_key||_,T.photo,{timeOfDay:T.time_of_day||N,side:T.side||g,company:T.company,venueType:T.venue_type||T.environment||h});if(!Z)throw new Error("Failed to load template image");const we=URL.createObjectURL(Z);try{await qT(we,{resetFrames:!1})}finally{URL.revokeObjectURL(we)}let Te=T;if(T.company){const Xe=await pB({company:T.company,locationKey:T.storage_key||_,environment:G,timeOfDay:U,side:me,photoFilename:T.photo});Xe!=null&&Xe.frames_data&&(Te={...T,frames_data:Xe.frames_data,config:Xe.config??T.config,time_of_day:Xe.time_of_day||T.time_of_day,side:Xe.side||T.side,environment:Xe.environment||T.environment})}const Le=GT(Te);mt.current=Le,ut.current=[],Rs(),ds.current=!1,fs(),Ao(),V(Le.length?JSON.stringify(Ba(),null,2):"[]"),Q(!1),yt();const vt=new File([Z],T.photo,{type:Z.type||"image/jpeg"});I(vt)}catch(G){E((G==null?void 0:G.message)||"Failed to load template for editing")}finally{B(!1)}}}function tb(){A(null),B(!1),F(""),E(""),x(""),m(""),I(null),pt.current=null,Kn(!1),ut.current=[],mt.current=[],Rs(),ds.current=!1,fs(),Ao(),V("[]"),Q(!1),Nc(),yt()}function mm(T){const G=Ot.current;if(!G)return null;const U=G.getBoundingClientRect(),me=G.width/U.width,Z=G.height/U.height;return{x:(T.clientX-U.left)*me,y:(T.clientY-U.top)*Z}}function nb(T){return Math.min(OU,Math.max(AU,T))}function Ro(){const{drawX:T,drawY:G,drawW:U,drawH:me,scale:Z}=hs.current,{zoom:we,panX:Te,panY:Le}=_n.current;return{drawX:T+Te,drawY:G+Le,drawW:U*we,drawH:me*we,scale:Z*we}}function gm(T=!0){_n.current={zoom:1,panX:0,panY:0},te(1),T&&yt()}function sb(){const T=Ot.current;return T?{x:T.width/2,y:T.height/2}:{x:Dh/2,y:Lh/2}}function rb(T,G,U){const{drawX:me,drawY:Z,scale:we}=hs.current,{zoom:Te,panX:Le,panY:vt}=_n.current,Xe=nb(T),Ie=we*Te,qe=we*Xe;if(!Ie||!qe)return;const Ke=(G-(me+Le))/Ie,Lt=(U-(Z+vt))/Ie,jt=G-me-Ke*qe,Gn=U-Z-Lt*qe;_n.current={zoom:Xe,panX:jt,panY:Gn},te(Xe),yt()}function QT(T,G){if(!pt.current)return;const{drawX:U,drawY:me,drawW:Z,drawH:we,scale:Te}=Ro();if(T<U||G<me||T>U+Z||G>me+we)return;const Le=Math.floor((T-U)/Te),vt=Math.floor((G-me)/Te),Xe=document.createElement("canvas");Xe.width=pt.current.naturalWidth,Xe.height=pt.current.naturalHeight;const Ie=Xe.getContext("2d");Ie.drawImage(pt.current,0,0);const qe=Ie.getImageData(Le,vt,1,1),[Ke,Lt,jt]=qe.data,Gn=`#${[Ke,Lt,jt].map(yr=>yr.toString(16).padStart(2,"0")).join("").toUpperCase()}`;ce(Gn)}function XT(T){}function JT(){if(!pt.current)return;const T=sb();rb(_n.current.zoom+__,T.x,T.y)}function ZT(){if(!pt.current)return;const T=sb();rb(_n.current.zoom-__,T.x,T.y)}function eP(){pt.current&&gm()}function tP(T,G){const U=Math.min(Dh/T,Lh/G),me=Math.round(T*U),Z=Math.round(G*U),we=Math.round((Dh-me)/2),Te=Math.round((Lh-Z)/2);return{x:we,y:Te,w:me,h:Z,scale:U}}function nP(){const T=Ot.current;if(!T)return;const G=T.getContext("2d");G.clearRect(0,0,T.width,T.height),G.fillStyle="#f8f9fa",G.fillRect(0,0,T.width,T.height)}function yt(){const T=Ot.current;if(!T)return;const G=T.getContext("2d");nP();const U=pt.current;if(!U)return;const{drawX:me,drawY:Z,drawW:we,drawH:Te,scale:Le}=Ro();if(G.imageSmoothingEnabled=!ne,ne||(G.imageSmoothingQuality="high"),Co&&Qs.current){G.drawImage(Qs.current,me,Z,we,Te);return}G.drawImage(U,me,Z,we,Te),mt.current.forEach((Ie,qe)=>{const Ke=Ie.points,Lt=La.current===qe,jt=1;G.fillStyle="rgba(128, 128, 128, 0.3)",G.strokeStyle=Lt?"#667eea":"#333",G.lineWidth=jt,G.setLineDash([8,4]),G.lineCap="butt",G.lineJoin="miter",G.beginPath(),Ke.forEach((Gn,yr)=>{const Oo=me+Gn[0]*Le,ps=Z+Gn[1]*Le;yr===0?G.moveTo(Oo,ps):G.lineTo(Oo,ps)}),G.closePath(),G.fill(),G.stroke(),G.setLineDash([]),Ke.forEach(Gn=>{const yr=me+Gn[0]*Le,Oo=Z+Gn[1]*Le,ps=4;G.fillStyle=Lt?"#667eea":"#333",G.fillRect(yr-ps/2,Oo-ps/2,ps,ps)})});const Xe=ut.current;Xe.length>0&&(G.fillStyle="rgba(128, 128, 128, 0.3)",G.strokeStyle="#667eea",G.lineWidth=1,G.setLineDash([8,4]),G.lineCap="butt",G.lineJoin="miter",G.beginPath(),Xe.forEach((qe,Ke)=>{const Lt=me+qe[0]*Le,jt=Z+qe[1]*Le;Ke===0?G.moveTo(Lt,jt):G.lineTo(Lt,jt)}),Xe.length===4&&(G.closePath(),G.fill()),G.stroke(),G.setLineDash([]),Xe.forEach(qe=>{const Ke=me+qe[0]*Le,Lt=Z+qe[1]*Le;G.fillStyle="#667eea",G.fillRect(Ke-4/2,Lt-4/2,4,4)}))}function fs(){ke([...ut.current])}function Ao(){Oe(mt.current.length)}function Rs(){La.current=-1,Gs(-1)}function sP(){if(Xt>=0){const T=mt.current[Xt];return T?{key:`frame-${Xt}`,points:T.points,config:T.config}:null}return ut.current.length===4?{key:"current",points:ut.current,config:ye}:null}function rP(){us.current.forEach(T=>{T!=null&&T.url&&URL.revokeObjectURL(T.url)}),us.current.clear(),Xs.current&&URL.revokeObjectURL(Xs.current),Xs.current="",Qs.current=null}function Qd(){rP(),Ia(!1),Da({})}function iP(T){Js&&Da(G=>{const U={...G};return T?U[Js]=T:delete U[Js],U})}function Xd(T){ut.current=[],fs(),La.current=T,Gs(T);const G=mt.current[T];G!=null&&G.config&&X(yf(G.config,Uo)),ft(!0),Q(!1);const U=Ba();V(U.length?JSON.stringify(U,null,2):"[]")}function oP(T,G){X(U=>{const me={...U,[T]:G},Z=La.current;return Z>=0&&mt.current[Z]&&(mt.current[Z].config=me),me})}function ib(T,G,U){const{drawX:me,drawY:Z,scale:we}=Ro(),Te=(T-me)/we,Le=(G-Z)/we;let vt=!1;for(let Xe=0,Ie=U.length-1;Xe<U.length;Ie=Xe++){const qe=U[Xe][0],Ke=U[Xe][1],Lt=U[Ie][0],jt=U[Ie][1];Ke>Le!=jt>Le&&Te<(Lt-qe)*(Le-Ke)/(jt-Ke)+qe&&(vt=!vt)}return vt}function ob(T,G){if(ut.current.length===4&&ib(T,G,ut.current))return-1;for(let U=mt.current.length-1;U>=0;U-=1)if(ib(T,G,mt.current[U].points))return U;return null}function ab(T,G){const{drawX:me,drawY:Z,scale:we}=Ro();if(ut.current.length>0)for(let Te=0;Te<ut.current.length;Te+=1){const Le=me+ut.current[Te][0]*we,vt=Z+ut.current[Te][1]*we;if(Math.hypot(T-Le,G-vt)<15)return{frame:-1,point:Te}}for(let Te=0;Te<mt.current.length;Te+=1){const Le=mt.current[Te].points;for(let vt=0;vt<Le.length;vt+=1){const Xe=me+Le[vt][0]*we,Ie=Z+Le[vt][1]*we;if(Math.hypot(T-Xe,G-Ie)<15)return{frame:Te,point:vt}}}return null}function Nc(){if(!pt.current){H("Select one or more locations, upload a billboard photo, then click four corners to define the frame.");return}H("Click and drag to draw a box. Use +/Fit to zoom; Shift+drag or middle mouse pans; pinch to zoom.")}function lb(T){T&&KT(T,{resetFrames:!0}).catch(G=>{E((G==null?void 0:G.message)||"Failed to load image")})}function aP(T){if(a!=="setup"||!pt.current)return;const G=mm(T);if(!G)return;const{x:U,y:me}=G,Z=Sn.current;if(T.pointerType==="touch"){const Ke=bi.current;if(Ke.pointers.set(T.pointerId,{x:U,y:me}),Ke.pointers.size===2){const[Lt,jt]=Array.from(Ke.pointers.values()),Gn=(Lt.x+jt.x)/2,yr=(Lt.y+jt.y)/2;Ke.isPinching=!0,Ke.startDistance=Math.hypot(Lt.x-jt.x,Lt.y-jt.y),Ke.startZoom=_n.current.zoom,Ke.startPanX=_n.current.panX,Ke.startPanY=_n.current.panY,Ke.startCenterX=Gn,Ke.startCenterY=yr,Z.isDrawing=!1,Z.isDraggingCorner=!1,Z.isDraggingFrame=!1,Z.isPanning=!1,Ot.current&&(Ot.current.style.cursor="grabbing");return}}if(T.button===1||T.shiftKey){T.preventDefault(),Z.isPanning=!0,Z.shiftPanPending=T.shiftKey&&T.button===0,Z.hasPanned=!1,Z.panStartX=U,Z.panStartY=me,Z.panOriginX=_n.current.panX,Z.panOriginY=_n.current.panY,Ot.current&&(Ot.current.style.cursor="grabbing");return}Z.shiftPanPending=!1,Z.hasPanned=!1;const{drawX:Te,drawY:Le,drawW:vt,drawH:Xe}=Ro(),Ie=ab(U,me);if(Ie){Sn.current.isDraggingCorner=!0,Sn.current.dragFrameIndex=Ie.frame,Sn.current.dragPointIndex=Ie.point,Ie.frame>=0?Xd(Ie.frame):(Rs(),ft(!0)),yt();return}const qe=ob(U,me);if(qe!==null){Sn.current.isDraggingFrame=!0,Sn.current.dragFrameIndex=qe,Sn.current.startX=U,Sn.current.startY=me,qe>=0?Xd(qe):(Rs(),ft(!0)),Ot.current&&(Ot.current.style.cursor="move"),yt();return}U<Te||me<Le||U>Te+vt||me>Le+Xe||(ds.current=!1,Sn.current.isDrawing=!0,Sn.current.startX=U,Sn.current.startY=me,Rs())}function lP(T){if(a!=="setup"||!pt.current)return;const G=mm(T);if(!G)return;const{x:U,y:me}=G,Z=Sn.current;if(T.pointerType==="touch"){const Ie=bi.current;if(Ie.pointers.has(T.pointerId)&&Ie.pointers.set(T.pointerId,{x:U,y:me}),Ie.isPinching&&Ie.pointers.size>=2){const[qe,Ke]=Array.from(Ie.pointers.values()),Lt=(qe.x+Ke.x)/2,jt=(qe.y+Ke.y)/2,Gn=Math.hypot(qe.x-Ke.x,qe.y-Ke.y),{drawX:yr,drawY:Oo,scale:ps}=hs.current,xm=Ie.startZoom;if(Ie.startDistance>0&&ps){const Jd=nb(xm*(Gn/Ie.startDistance)),wP=(Ie.startCenterX-(yr+Ie.startPanX))/(ps*xm),kP=(Ie.startCenterY-(Oo+Ie.startPanY))/(ps*xm),_P=Lt-yr-wP*ps*Jd,SP=jt-Oo-kP*ps*Jd;_n.current={zoom:Jd,panX:_P,panY:SP},te(Jd),yt()}return}}if(Z.isPanning){T.preventDefault();const Ie=U-Z.panStartX,qe=me-Z.panStartY;if(Z.shiftPanPending&&!Z.hasPanned){if(Math.hypot(Ie,qe)<MU)return;Z.hasPanned=!0}_n.current.panX=Z.panOriginX+Ie,_n.current.panY=Z.panOriginY+qe,yt();return}const{drawX:we,drawY:Te,scale:Le}=Ro();if(Z.isDraggingCorner){const Ie=(U-we)/Le,qe=(me-Te)/Le;Z.dragFrameIndex===-1?ut.current[Z.dragPointIndex]=[Math.round(Ie),Math.round(qe)]:mt.current[Z.dragFrameIndex].points[Z.dragPointIndex]=[Math.round(Ie),Math.round(qe)],yt();return}if(Z.isDraggingFrame){const Ie=(U-Z.startX)/Le,qe=(me-Z.startY)/Le;Z.dragFrameIndex===-1?ut.current=ut.current.map(Ke=>[Math.round(Ke[0]+Ie),Math.round(Ke[1]+qe)]):mt.current[Z.dragFrameIndex].points=mt.current[Z.dragFrameIndex].points.map(Ke=>[Math.round(Ke[0]+Ie),Math.round(Ke[1]+qe)]),Z.startX=U,Z.startY=me,yt();return}if(Z.isDrawing){yt();const Ie=Ot.current.getContext("2d");Ie.fillStyle="rgba(128, 128, 128, 0.3)";const qe=U-Z.startX,Ke=me-Z.startY;Ie.fillRect(Z.startX,Z.startY,qe,Ke),Ie.strokeStyle="#667eea",Ie.lineWidth=1,Ie.setLineDash([8,4]),Ie.lineCap="butt",Ie.lineJoin="miter",Ie.strokeRect(Z.startX,Z.startY,qe,Ke),Ie.setLineDash([]);return}const vt=ab(U,me),Xe=ob(U,me);Ot.current&&(vt?Ot.current.style.cursor="pointer":Xe!==null?Ot.current.style.cursor="move":Ot.current.style.cursor="crosshair")}function cP(T){if(a!=="setup"||!pt.current)return;const G=mm(T),U=Sn.current;if(T.pointerType==="touch"){const jt=bi.current;if(jt.pointers.has(T.pointerId)&&jt.pointers.delete(T.pointerId),jt.isPinching&&jt.pointers.size<2&&(jt.isPinching=!1),jt.isPinching)return}if(U.isPanning){U.isPanning=!1,Ot.current&&(Ot.current.style.cursor="crosshair"),U.shiftPanPending&&!U.hasPanned&&xr&&G&&QT(G.x,G.y),U.shiftPanPending=!1,U.hasPanned=!1;return}if(U.isDraggingCorner){U.isDraggingCorner=!1,U.dragFrameIndex=-1,U.dragPointIndex=-1,Ot.current&&(Ot.current.style.cursor="crosshair"),fs(),yt();return}if(U.isDraggingFrame){U.isDraggingFrame=!1,U.dragFrameIndex=-1,Ot.current&&(Ot.current.style.cursor="crosshair"),fs(),yt();return}if(!U.isDrawing||!G)return;const{x:me,y:Z}=G,{drawX:we,drawY:Te,scale:Le}=Ro(),vt=U.startX,Xe=U.startY,Ie=(Math.min(vt,me)-we)/Le,qe=(Math.min(Xe,Z)-Te)/Le,Ke=(Math.max(vt,me)-we)/Le,Lt=(Math.max(Xe,Z)-Te)/Le;ut.current=[[Math.round(Ie),Math.round(qe)],[Math.round(Ke),Math.round(qe)],[Math.round(Ke),Math.round(Lt)],[Math.round(Ie),Math.round(Lt)]],U.isDrawing=!1,fs(),Rs(),ft(!0),H("Frame drawn. Drag corners to adjust, or drag inside to move. Click Add Frame to save."),yt()}function uP(){X(Uo)}function dP(){if(ut.current.length!==4){E("Select 4 corner points first");return}const T={...ye},G=ds.current?"greenscreen":"manual";mt.current.push({points:[...ut.current],config:T,source:G});const U="current";ut.current=[];const me=mt.current.length-1;Xd(me),ds.current=!1,fs(),Ao(),H(`Frame ${mt.current.length} added. Draw another box or save when done.`);const Z=us.current.get(U);Z&&(us.current.set(`frame-${me}`,Z),us.current.delete(U));const we=kc.current[U];we&&Da(Te=>{const Le={...Te};return Le[`frame-${me}`]=we,delete Le[U],Le}),Ia(!1),Qs.current=null,yt()}function hP(){ut.current=[],Rs(),ds.current=!1,fs(),us.current.delete("current"),Da(T=>{if(!T.current)return T;const G={...T};return delete G.current,G}),Ia(!1),Qs.current=null,mt.current.length?H(`Frames saved: ${mt.current.length}. Draw another box or save all frames.`):Nc(),yt()}function cb(T=!1){!T&&!window.confirm("Clear all frames? This will reset your work.")||(mt.current=[],ut.current=[],Rs(),ds.current=!1,Qd(),fs(),Ao(),V("[]"),Q(!1),Nc(),yt())}function Ba(){const T=[...mt.current];return ut.current.length===4&&T.push({points:[...ut.current],config:{...ye}}),T.map(G=>({points:G.points.map(U=>[U[0],U[1]]),config:G.config}))}function fP(T){if(!T.trim())return[];let G=[];try{G=JSON.parse(T)}catch(U){throw new Error((U==null?void 0:U.message)||"Frames JSON is invalid")}if(!Array.isArray(G))throw new Error("Frames JSON must be an array of frames.");return G.map((U,me)=>{const Z=pm((U==null?void 0:U.points)||(U==null?void 0:U.frame_points)||U);if(!Z||Z.length!==4)throw new Error(`Frame ${me+1} must include 4 points.`);const we=Z.map(Le=>{const vt=Number(Le[0]),Xe=Number(Le[1]);if(!Number.isFinite(vt)||!Number.isFinite(Xe))throw new Error(`Frame ${me+1} has invalid point values.`);return[vt,Xe]});let Te=U==null?void 0:U.config;if(typeof Te=="string")try{Te=JSON.parse(Te)}catch{Te=null}return{points:we,config:yf(Te,Uo),source:"json"}})}function pP(){E("");try{const T=fP(R);mt.current=T,ut.current=[],ds.current=!1,Qd(),T.length?Xd(0):Rs(),fs(),Ao(),Q(!1),V(T.length?JSON.stringify(Ba(),null,2):"[]"),yt()}catch(T){E((T==null?void 0:T.message)||"Frames JSON is invalid")}}function mP(){!pt.current||Se||(oe(!0),setTimeout(()=>{if(!pt.current){oe(!1);return}try{const T=document.createElement("canvas");T.width=pt.current.width,T.height=pt.current.height;const G=T.getContext("2d");G.drawImage(pt.current,0,0);const U=G.getImageData(0,0,pt.current.width,pt.current.height),me=zU(U,{color:ue,tolerance:de,depthMultiplier:ye.depthMultiplier,existingFrames:mt.current});me?(ut.current=me,Rs(),ds.current=!0,fs(),ft(!0),H("Click and drag to draw a box. Use +/Fit to zoom; Shift+drag or middle mouse pans; pinch to zoom."),yt()):H("No green screen detected. Adjust tolerance or draw frame manually.")}finally{oe(!1)}},0))}async function gP(){const T=sP();if(!L||!T||!Js){E("Upload a photo and select or draw a frame first.");return}const G=Z0;if(!G){E("Upload a test creative for the active frame first.");return}if(!Vd){E(""),qd(!0);try{const U=new FormData;U.append("billboard_photo",L),U.append("creative",G),U.append("frame_points",JSON.stringify(T.points)),U.append("config",JSON.stringify(T.config)),U.append("time_of_day",y||"day");const me=await gB(U),Z=us.current.get(Js);Z!=null&&Z.url&&URL.revokeObjectURL(Z.url);const we=URL.createObjectURL(me),Te=new Image;Te.onload=()=>{us.current.set(Js,{url:we,img:Te}),Xs.current=we,Qs.current=Te,yt()},Te.src=we}catch(U){E((U==null?void 0:U.message)||"Failed to generate preview")}finally{qd(!1)}}}function xP(){I(null),pt.current=null,ut.current=[],mt.current=[],Rs(),ds.current=!1,Kn(!1),Qd(),gm(!1),fs(),Ao(),V("[]"),Q(!1),H("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),yt()}function yP(T){T.preventDefault(),be(!0)}function vP(T){T.preventDefault(),be(!1)}function bP(T){var U,me;T.preventDefault(),be(!1);const G=(me=(U=T.dataTransfer)==null?void 0:U.files)==null?void 0:me[0];G&&(I(G),lb(G))}return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3 py-1",children:[r&&c.jsx(se,{variant:a==="generate"?"default":"ghost",onClick:()=>l("generate"),className:`rounded-2xl mmg-tab-btn ${a==="generate"?"mmg-tab-btn-active":""}`,children:"Generate"}),i&&n&&c.jsx(se,{variant:a==="setup"?"default":"ghost",onClick:()=>l("setup"),className:`rounded-2xl mmg-tab-btn ${a==="setup"?"mmg-tab-btn-active":""}`,children:"Setup"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:a==="generate"?"h-full":"hidden","aria-hidden":a!=="generate",children:c.jsx(wU,{locations:u,setLocations:d,venueType:h,setVenueType:f,templateKey:b,setTemplateKey:k,locationOptions:Kd,locationsQuery:Gd,timeOfDay:y,setTimeOfDay:x,timeOfDayDisabled:S,sideDisabled:j,side:g,setSide:m,timeOfDayOptions:X2,sideOptions:J2,venueTypeOptions:Z2,templateOptions:jc,templatesQuery:Sc,templateThumbs:re,getTemplateKey:wr,defaultFrameConfig:Uo,useNativeSelects:k_})}),a==="setup"?c.jsx("div",{className:"h-full",children:c.jsx(EU,{locations:u,setLocations:d,venueType:h,setVenueType:f,assetType:p,setAssetType:w,setTemplateKey:k,locationOptions:Kd,locationsQuery:Gd,assetTypeOptions:Yd,assetTypesQuery:$a,timeOfDay:y,setTimeOfDay:x,timeOfDayDisabled:S,sideDisabled:j,side:g,setSide:m,timeOfDayOptions:TU,sideOptions:PU,venueTypeOptions:RU,editingTemplate:z,editingTemplateLoading:Y,stopEditTemplate:tb,templatesOpen:Ys,setTemplatesOpen:Ur,templateOptions:Cc,templatesQuery:Fa,templateThumbs:re,getTemplateKey:wr,startEditTemplate:YT,deleteTemplate:VT,setupPhoto:L,setSetupPhoto:I,handleSetupPhoto:lb,handleSetupDragOver:yP,handleSetupDragLeave:vP,handleSetupDrop:bP,setupDragActive:J,handleSetupPhotoClear:xP,framesJson:R,setFramesJson:V,setFramesJsonDirty:Q,applyFramesJsonToCanvas:pP,buildFramesPayload:Ba,setupImageReady:Mn,greenscreenOpen:xr,setGreenscreenOpen:lt,greenscreenColor:ue,setGreenscreenColor:ce,greenscreenDetecting:Se,colorTolerance:de,setColorTolerance:ie,RangeField:Qn,handleGreenscreenDetect:mP,canDetectGreenscreen:za,hasActiveFrame:UT,frameSettingsOpen:ct,setFrameSettingsOpen:ft,setupFrameConfig:ye,handleSetupFrameConfigChange:oP,FrameConfigControls:$U,previewOpen:dn,setPreviewOpen:vi,testPreviewMode:Co,setTestPreviewMode:Ia,testPreviewImgRef:Qs,testPreviewUrlRef:Xs,previewImgRef:pt,drawPreview:yt,activeTestCreativeFile:Z0,updateTestCreativeForActive:iP,generateTestPreview:gP,testPreviewing:Vd,activeFrameIndex:Xt,canvasRef:Ot,canvasWidth:Dh,canvasHeight:Lh,handleCanvasPointerDown:aP,handleCanvasPointerMove:lP,handleCanvasPointerUp:cP,handleCanvasWheel:XT,setupHint:pe,handleZoomOut:ZT,handleZoomIn:JT,handleFitToScreen:eP,zoomPercent:HT,pixelUpscale:ne,setPixelUpscale:je,setupError:q,setupMessage:D,addFrame:dP,resetCurrentFrame:hP,saveSetup:WT,setupSaving:O,clearAllFrames:cb,currentPoints:W,frameCount:Re,useNativeSelects:k_})}):null]})]})})}function $U({config:t,onChange:e}){return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Qn,{label:"Brightness",value:t.brightness,min:50,max:200,suffix:"%",onChange:n=>e("brightness",n)}),c.jsx(Qn,{label:"Contrast",value:t.contrast,min:50,max:200,suffix:"%",onChange:n=>e("contrast",n)}),c.jsx(Qn,{label:"Saturation",value:t.saturation,min:0,max:200,suffix:"%",onChange:n=>e("saturation",n)}),c.jsx(Qn,{label:"Image Blur",value:t.imageBlur,min:0,max:20,onChange:n=>e("imageBlur",n),helper:"Blur entire creative (0 = off)."}),c.jsx(Qn,{label:"Edge Blur",value:t.edgeBlur,min:1,max:20,suffix:"px",onChange:n=>e("edgeBlur",n),helper:"Edge blur amount (1 = off)."}),c.jsx(Qn,{label:"Overlay Opacity",value:t.overlayOpacity,min:0,max:50,suffix:"%",onChange:n=>e("overlayOpacity",n),helper:"Billboard overlay strength."}),c.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(FU,{value:t.lightDirection,onChange:n=>e("lightDirection",n)}),c.jsx(Qn,{label:"Depth Perception",value:t.depthMultiplier,min:5,max:30,suffix:"x",onChange:n=>e("depthMultiplier",n),helper:"Perspective compensation."})]}),c.jsx(Qn,{label:"Shadow Intensity",value:t.shadowIntensity,min:0,max:100,suffix:"%",onChange:n=>e("shadowIntensity",n),helper:"Edge darkening."}),c.jsx(Qn,{label:"Lighting Match",value:t.lightingAdjustment,min:-50,max:50,suffix:"%",onChange:n=>e("lightingAdjustment",n),helper:"Brightness matching."}),c.jsx(Qn,{label:"Color Temperature",value:t.colorTemperature,min:-50,max:50,onChange:n=>e("colorTemperature",n),helper:"Warm/cool shift."}),c.jsx(Qn,{label:"Vignette",value:t.vignette,min:0,max:100,suffix:"%",onChange:n=>e("vignette",n),helper:"Corner darkening."}),c.jsx(Qn,{label:"Edge Smoother",value:t.edgeSmoother,min:1,max:20,suffix:"x",onChange:n=>e("edgeSmoother",n),helper:"Higher = softer edges."}),c.jsx(Qn,{label:"Sharpening",value:t.sharpening,min:0,max:100,suffix:"%",onChange:n=>e("sharpening",n),helper:"Unsharp mask strength (0 = off)."})]})}function FU({value:t,onChange:e}){return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:["Light Direction: ",IU[t]||"Top"]}),c.jsx("div",{className:"grid grid-cols-3 gap-2 w-[150px]",children:eT.map(n=>c.jsx("button",{type:"button",onClick:()=>e(n.value),className:`rounded-lg border px-2 py-2 text-sm font-semibold ${t===n.value?"border-black/40 dark:border-white/50 bg-black/5 dark:bg-white/15 text-black dark:text-white":"border-black/10 dark:border-white/20 bg-white/80 dark:bg-black/40 text-black/70 dark:text-white/80"}`,title:n.label,children:n.glyph},n.value))})]})}function Qn({label:t,value:e,min:n,max:s,step:r=1,suffix:i="",helper:o,onChange:a}){return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:[t,": ",e,i]}),c.jsx("input",{type:"range",min:n,max:s,step:r,value:e,onChange:l=>a(Number(l.target.value)),style:{background:DU(e,n,s)},className:"w-full accent-black"}),o?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:o}):null]})}function wr(t){return`${t.storage_key||""}::${t.photo}::${t.time_of_day||"all"}::${t.side||"all"}`}function zU(t,{color:e,tolerance:n,depthMultiplier:s,existingFrames:r}){const i=t.data,o=t.width,a=t.height,l=parseInt(e.slice(1,3),16),u=parseInt(e.slice(3,5),16),d=parseInt(e.slice(5,7),16),h=n,f=new Uint8Array(o*a);r.forEach(O=>{const $=O.points;for(let D=0;D<a;D+=1)for(let F=0;F<o;F+=1)BU(F,D,$)&&(f[D*o+F]=1)});const p=new Uint8Array(o*a);let w=0;for(let O=0;O<a;O+=1)for(let $=0;$<o;$+=1){const D=O*o+$;if(f[D]===1)continue;const F=D*4,q=i[F],E=i[F+1],R=i[F+2];Math.sqrt((q-l)**2+(E-u)**2+(R-d)**2)<=h&&(p[D]=255,w+=1)}if(w<1e3)return null;const y=new Uint8Array(o*a),x=3;for(let O=0;O<a;O+=1)for(let $=0;$<o;$+=1){const D=O*o+$;let F=!1;for(let q=-x;q<=x;q+=1){for(let E=-x;E<=x;E+=1){const R=O+q,V=$+E;if(R>=0&&R<a&&V>=0&&V<o&&p[R*o+V]===255){F=!0;break}}if(F)break}y[D]=F?255:0}const g=[];for(let O=1;O<a-1;O+=1)for(let $=1;$<o-1;$+=1){const D=O*o+$;y[D]===0&&(y[D-1]===255||y[D+1]===255||y[D-o]===255||y[D+o]===255||y[D-o-1]===255||y[D-o+1]===255||y[D+o-1]===255||y[D+o+1]===255)&&g.push([$,O])}if(g.length<4)return null;let m=g[0],b=g[0],k=g[0],_=g[0];g.forEach(O=>{const[$,D]=O;$+D<m[0]+m[1]&&(m=O),$-D>b[0]-b[1]&&(b=O),$+D>k[0]+k[1]&&(k=O),$-D<_[0]-_[1]&&(_=O)});const C=Math.abs(b[0]-m[0]),S=Math.abs(k[0]-_[0]),j=Math.abs(_[1]-m[1]),N=Math.abs(k[1]-b[1]),P=C/S,L=j/N,I=s||Uo.depthMultiplier;if(P>1.1){const O=Math.floor((P-1)*I);_=[_[0],Math.min(a-1,_[1]+O)],k=[k[0],Math.min(a-1,k[1]+O)]}else if(P<.9){const O=Math.floor((1/P-1)*I);m=[m[0],Math.max(0,m[1]-O)],b=[b[0],Math.max(0,b[1]-O)]}if(L>1.1){const O=Math.floor((L-1)*I);b=[Math.min(o-1,b[0]+O),b[1]],k=[Math.min(o-1,k[0]+O),k[1]]}else if(L<.9){const O=Math.floor((1/L-1)*I);m=[Math.max(0,m[0]-O),m[1]],_=[Math.max(0,_[0]-O),_[1]]}return[m,b,k,_]}function BU(t,e,n){let s=!1;for(let r=0,i=n.length-1;r<n.length;i=r++){const o=n[r][0],a=n[r][1],l=n[i][0],u=n[i][1];a>e!=u>e&&t<(l-o)*(e-a)/(u-a)+o&&(s=!s)}return s}function UU(t){if(!t)return"";const e=String(t).trim();if(!e)return"";if(e.includes("/"))return e;const n=e.split("-");if(n.length===3){const[s,r,i]=n;if(s&&r&&i)return`${i}/${r}/${s}`}return e}function S_(t){const e=Number.parseInt(t,10),n=Number.isFinite(e)&&e>0?e:1;return`${n} ${n===1?"Week":"Weeks"}`}function $h(t,e){const n=e;if(t==null||t==="")return`${n} 0`;const s=typeof t=="string"?t.trim():t;if(typeof s=="string"&&s.toUpperCase().startsWith(n))return s;const r=typeof s=="number"?s:Number.parseFloat(String(s).replace(/,/g,""));return Number.isFinite(r)?`${n} ${r.toLocaleString()}`:`${n} 0`}function j_(t){if(t==null)return 0;const e=Number.parseFloat(String(t).replace(/[^\d.-]/g,""));return Number.isFinite(e)?e:0}function HU(){const t=Ks(),[e,n]=v.useState(""),s=()=>({id:crypto.randomUUID(),startDate:"",duration:"",netRate:""}),r=()=>({id:crypto.randomUUID(),location:"",spots:"1",productionFee:"",periods:[s()]}),[i,o]=v.useState(()=>[r()]),[a,l]=v.useState("separate"),[u,d]=v.useState(""),[h,f]=v.useState("AED"),[p,w]=v.useState("100% upfront"),[y,x]=v.useState([]),[g,m]=v.useState({}),b=Kt({queryKey:["locations","proposals"],queryFn:()=>vB({service:"proposals"})}),k=v.useMemo(()=>{const D=b.data;return Array.isArray(D)?D:(D==null?void 0:D.locations)||(D==null?void 0:D.data)||[]},[b.data]),_=v.useMemo(()=>Array.from(new Set(i.map(D=>D.location).filter(Boolean))),[i]);v.useEffect(()=>{if(!_.length)return;const D=_.filter(q=>!g[q]);if(!D.length)return;let F=!0;return(async()=>{const q=await Promise.all(D.map(async E=>{try{const R=await bB(E);return[E,R]}catch{return[E,null]}}));F&&m(E=>{const R={...E};return q.forEach(([V,K])=>{K&&(R[V]=K)}),R})})(),()=>{F=!1}},[_,g]);const C=KC({mutationFn:D=>wB(D),onSuccess:()=>{t.invalidateQueries({queryKey:["proposals","history"]})}});function S(D,F,q){o(E=>E.map(R=>R.id===D?{...R,[F]:q}:R))}function j(D,F,q,E){o(R=>R.map(V=>V.id!==D?V:{...V,periods:V.periods.map(K=>K.id===F?{...K,[q]:E}:K)}))}function N(){o(D=>[...D,r()])}function P(D){o(F=>F.length>1?F.filter(q=>q.id!==D):F)}function L(D){o(F=>F.map(q=>q.id===D?{...q,periods:[...q.periods,s()]}:q))}function I(D,F){o(q=>q.map(E=>E.id!==D||E.periods.length<=1?E:{...E,periods:E.periods.filter(R=>R.id!==F)}))}function O(){const D=h||"AED",F=$h(u,D),q=i.filter(Q=>Q.location),E=q.map(Q=>{const re=Q.periods.filter(de=>de.startDate||de.duration||de.netRate),ee=a==="combined"?[re[0]||Q.periods[0]]:re,z=ee.map(de=>UU((de==null?void 0:de.startDate)||"")),A=ee.map(de=>S_(de==null?void 0:de.duration)),Y=ee.map(de=>$h(de==null?void 0:de.netRate,D)),B=Number.parseInt(Q.spots,10),J=Number.isFinite(B)&&B>0?B:1,be=g[Q.location]||{},pe=be.location||be,H=(pe.display_type||pe.displayType||"").toLowerCase()==="static",ye=pe.upload_fee??pe.uploadFee??0,X=pe.production_fee??pe.productionFee??0,ue=Q.productionFee,ce={location:Q.location||"",upload_fee:$h(ye,D),spots:J};return H&&(ce.production_fee=$h(ue!==""&&ue!==null&&ue!==void 0?ue:X,D)),a==="combined"?(ce.start_date=z[0]||"",ce.duration=A[0]||S_(1)):(ce.start_dates=z,ce.durations=A,ce.net_rates=Y),ce}),R=q.map(Q=>{const re=k.find(ee=>(ee.location_key||ee.key||ee.id)===Q.location);return(re==null?void 0:re.display_name)||(re==null?void 0:re.name)||(re==null?void 0:re.label)||Q.location}).filter(Boolean).join(", "),V={proposals:E,client_name:e,proposal_type:a,payment_terms:p||"100% upfront",currency:D};a==="combined"&&(V.combined_net_rate=F);const K={client:e,packageType:a,items:E.map(Q=>({location:Q.location,netRatesValue:Array.isArray(Q.net_rates)?Q.net_rates.map(j_):[]})),combinedNetRateValue:a==="combined"?j_(F):0,locationsLabel:R,currency:D,paymentTerms:p||"100% upfront"};C.mutate(V,{onSuccess:Q=>{x(re=>[{data:Q,meta:K},...re].slice(0,3))}})}function $(){n(""),o([r()]),l("separate"),d(""),f("AED"),w("100% upfront")}return{client:e,setClient:n,items:i,updateItem:S,addItem:N,removeItem:P,addPeriod:L,removePeriod:I,updatePeriod:j,packageType:a,setPackageType:l,combinedNetRate:u,setCombinedNetRate:d,currency:h,setCurrency:f,paymentTerms:p,setPaymentTerms:w,lastResults:y,locationsQuery:b,locationOptions:k,generateMutation:C,handleGenerate:O,resetForm:$}}function WU(){const t=HU();return c.jsx(VU,{...t})}function VU({client:t,setClient:e,items:n,updateItem:s,addItem:r,removeItem:i,addPeriod:o,removePeriod:a,updatePeriod:l,packageType:u,setPackageType:d,combinedNetRate:h,setCombinedNetRate:f,currency:p,setCurrency:w,paymentTerms:y,setPaymentTerms:x,lastResults:g,locationsQuery:m,locationOptions:b,generateMutation:k,handleGenerate:_,resetForm:C}){var I;const S=Array.isArray(g)?g:[],j=k.isPending,N=v.useMemo(()=>{const O=b.map($=>{const D=$.location_key||$.key||$.id||"",F=$.display_name||$.name||$.label||D||"";return{value:D,label:F}}).filter($=>$.value);return[{value:"",label:"Select a location"},...O]},[b]),P=v.useMemo(()=>[{value:"separate",label:"Separate"},{value:"combined",label:"Combined"}],[]),L=v.useMemo(()=>[{value:"AED",label:"AED"},{value:"EUR",label:"EUR"},{value:"USD",label:"USD"},{value:"GBP",label:"GBP"}],[]);return c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{className:"flex flex-row items-center justify-between",children:c.jsx(Yt,{children:"Generate Proposal"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Client",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:t,onChange:O=>e(O.target.value),placeholder:"Client name"})}),c.jsx(Ee,{label:"Package Type",children:c.jsx(ot,{value:u,options:P,onChange:d})})]}),u==="combined"?c.jsx(Ee,{label:"Combined Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:h,onChange:O=>f(O.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Locations"}),m.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading locations"})}):null]}),c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:r,children:"Add Location"})]}),c.jsx("div",{className:"space-y-3",children:n.map(O=>{var F,q;const $=b.find(E=>(E.location_key||E.key||E.id)===O.location),D=(($==null?void 0:$.display_type)||"").toLowerCase()==="static";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[u==="combined"?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1.4fr_0.6fr_0.9fr_0.7fr_auto] gap-2 items-end",children:[c.jsx(Ee,{label:"Location",children:c.jsx(ot,{value:O.location,options:N,onChange:E=>s(O.id,"location",E)})}),c.jsx(Ee,{label:"Spots",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.spots,onChange:E=>s(O.id,"spots",E.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Ee,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((F=O.periods[0])==null?void 0:F.startDate)||"",onChange:E=>{var R;return l(O.id,(R=O.periods[0])==null?void 0:R.id,"startDate",E.target.value)},type:"date"})}),c.jsx(Ee,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((q=O.periods[0])==null?void 0:q.duration)||"",onChange:E=>{var R;return l(O.id,(R=O.periods[0])==null?void 0:R.id,"duration",E.target.value)},type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(O.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ha,{size:16})})]}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 items-end",children:[c.jsx(Ee,{label:"Location",children:c.jsx(ot,{value:O.location,options:N,onChange:E=>s(O.id,"location",E)})}),c.jsxs("div",{className:"flex items-end justify-between gap-2",children:[c.jsx(Ee,{label:"Spots",className:"flex-1",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.spots,onChange:E=>s(O.id,"spots",E.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(O.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ha,{size:16})})]})]}),D?c.jsx(Ee,{label:"Production Fee",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.productionFee,onChange:E=>s(O.id,"productionFee",E.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,u!=="combined"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/60",children:"Line Items"}),c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>o(O.id),children:"Add Line Item"})]}),c.jsx("div",{className:"space-y-2",children:O.periods.map(E=>c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_1fr_1fr_auto] gap-2 items-end",children:[c.jsx(Ee,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.startDate,onChange:R=>l(O.id,E.id,"startDate",R.target.value),type:"date"})}),c.jsx(Ee,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.duration,onChange:R=>l(O.id,E.id,"duration",R.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Ee,{label:"Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.netRate,onChange:R=>l(O.id,E.id,"netRate",R.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>a(O.id,E.id),disabled:O.periods.length===1,title:"Remove dates",children:c.jsx(ha,{size:16})})]},E.id))})]}):null]},O.id)})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Currency",children:c.jsx(ot,{value:p,options:L,onChange:w})}),c.jsx(Ee,{label:"Payment Terms",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:y,onChange:O=>x(O.target.value),placeholder:"Payment terms"})})]}),k.isError?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:((I=k.error)==null?void 0:I.message)||"Generation failed"}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(se,{className:"rounded-2xl",onClick:_,disabled:j,children:j?c.jsx(Ve,{text:"Generating Proposal"}):"Generate Proposal"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:C,disabled:j,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 space-y-3",children:[!S.length&&!j?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,j?c.jsx(Ve,{text:"Processing proposal",className:"text-sm text-black/60 dark:text-white/65"}):null,S.length?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Proposals"}),c.jsx("div",{className:"space-y-4",children:S.map((O,$)=>{const D=(O==null?void 0:O.data)||null,F=(O==null?void 0:O.meta)||null,q=[];D!=null&&D.pptx_url&&q.push({url:D.pptx_url,type:"pptx"}),D!=null&&D.pdf_url&&q.push({url:D.pdf_url,type:"pdf"});const E=(D==null?void 0:D.locations)||(F==null?void 0:F.locationsLabel)||"",R=(F==null?void 0:F.packageType)==="combined"?F==null?void 0:F.combinedNetRateValue:((F==null?void 0:F.items)||[]).reduce((K,Q)=>{const re=Array.isArray(Q.netRatesValue)?Q.netRatesValue:[];return K+re.reduce((ee,z)=>ee+(z||0),0)},0),V=Number.isFinite(R)?`${(F==null?void 0:F.currency)||"AED"} ${Number(R).toLocaleString()}`:"";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Client"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(F==null?void 0:F.client)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Package"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(F==null?void 0:F.packageType)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 sm:col-span-2",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Locations"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:E})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Total Amount"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:V})]})]}),q.length?c.jsx("div",{className:"space-y-2",children:q.map(K=>{const Q=qU(K.url),re=KU(Q),ee=K.type==="pdf"?"proposal.pdf":"proposal.pptx",z=re||ee,A=K.type==="pdf";return c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:A?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Qv,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:"PPTX"})}),c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:z})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:Q,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:Y=>{Y.preventDefault(),C_(Q,z)},onKeyDown:Y=>{(Y.key==="Enter"||Y.key===" ")&&(Y.preventDefault(),C_(Q,z))},className:"inline-flex items-center",children:[c.jsx(wa,{size:14,className:"mr-1"}),"Download"]})})]})]})},`${K.type}-${K.url}`)})}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No files returned yet."})]},`proposal-output-${$}`)})})]}):null]})]})]})}function qU(t){return t?t.startsWith("http")?t:`${Pa.API_BASE_URL}${t}`:""}function KU(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function C_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function jo({className:t,placeholder:e="Search...",...n}){return c.jsx("input",{type:"text",placeholder:e,className:Pe("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",t),...n})}function GU(){const{user:t}=fi(),[e,n]=v.useState({}),[s,r]=v.useState(!1),i=Kt({queryKey:["proposals","history"],queryFn:kB}),o=v.useMemo(()=>{var h;return Array.isArray(i.data)?i.data:(h=i.data)!=null&&h.proposals?i.data.proposals:i.data||[]},[i.data]),a=v.useMemo(()=>Rd(t),[t]),l=v.useMemo(()=>{const h=o||[];if(a)return h;const f=(t==null?void 0:t.id)||(t==null?void 0:t.user_id)||(t==null?void 0:t.email)||"";return f?h.filter(p=>(p.submitted_by||p.user_id||"")===f):h},[o,a,t==null?void 0:t.id,t==null?void 0:t.user_id,t==null?void 0:t.email]),u=v.useMemo(()=>{const h=new Set;return(l||[]).forEach(f=>{const p=f.submitted_by||f.user_id;p&&h.add(p)}),Array.from(h)},[l]),d=v.useMemo(()=>u.filter(h=>!e[h]),[u,e]);return v.useEffect(()=>{if(!d.length)return;r(!0);let h=!0;return(async()=>{const f=await Promise.all(d.map(async p=>{var w,y;try{const x=await SB(p),g=(x==null?void 0:x.name)||((w=x==null?void 0:x.user)==null?void 0:w.name)||((y=x==null?void 0:x.profile)==null?void 0:y.name)||p;return[p,g]}catch{return[p,p]}}));h&&(n(p=>{const w={...p};return f.forEach(([y,x])=>{w[y]||(w[y]=x)}),w}),r(!1))})(),()=>{h=!1}},[d]),v.useEffect(()=>{d.length||r(!1)},[d.length]),{historyQuery:i,userNamesLoading:s,visibleProposals:l,userNameById:e}}function YU(){const t=GU();return c.jsx(QU,{...t})}function QU({historyQuery:t,userNamesLoading:e,visibleProposals:n,userNameById:s}){const[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),d=v.useMemo(()=>(n||[]).map((x,g)=>{var P;const m=x.client_name||x.client||"Proposal",b=x.submitted_by||x.user_id||"",k=b?s[b]||b:"",_=x.date_generated||x.created_at,C=x.package_type||"",S=x.locations||((P=x.proposal_data)==null?void 0:P.locations_text)||x.location||"",j=x.total_amount||(x.total_amount_value!=null?`${x.currency||""} ${Number(x.total_amount_value).toLocaleString()}`:""),N=[];return x.pptx_url&&N.push({url:x.pptx_url,type:"pptx"}),x.pdf_url&&N.push({url:x.pdf_url,type:"pdf"}),!N.length&&x.file_url&&N.push({url:x.file_url,type:"pdf"}),{id:x.id||x.file_url||g,clientName:m,userName:k,generatedAt:_,packageType:C,locationText:S,totalAmount:j,fileEntries:N}}),[n,s]),h=v.useMemo(()=>{const x=new Set;return d.forEach(g=>{g.packageType&&g.packageType!==""&&x.add(g.packageType)}),Array.from(x)},[d]),f=v.useMemo(()=>{const x=new Set;return d.forEach(g=>{!g.locationText||g.locationText===""||g.locationText.split(",").forEach(m=>{const b=m.trim();b&&x.add(b)})}),Array.from(x)},[d]),p=v.useMemo(()=>[{value:"",label:"All packages"},...h.map(x=>({value:x,label:x}))],[h]),w=v.useMemo(()=>[{value:"",label:"All locations"},...f.map(x=>({value:x,label:x}))],[f]),y=v.useMemo(()=>{const x=l.trim().toLowerCase();return d.filter(g=>!(r&&g.packageType!==r||o&&!(g.locationText||"").split(",").map(b=>b.trim()).filter(Boolean).includes(o)||x&&!`${g.clientName} ${g.locationText}`.toLowerCase().includes(x)))},[d,r,o,l]);return c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{className:"space-y-2",children:c.jsx(Yt,{children:"History"})}),c.jsx(Qt,{className:"flex-1 min-h-0 flex flex-col",children:t.isLoading||e?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):n!=null&&n.length?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(jo,{value:l,onChange:x=>u(x.target.value),className:"w-full sm:w-[260px]",placeholder:"Search..."}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(ot,{value:r,options:p,onChange:i,className:"sm:w-[200px]"}),c.jsx(ot,{value:o,options:w,onChange:a,className:"sm:w-[220px]"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full min-w-0 overflow-hidden",children:c.jsx("div",{className:"h-full w-full min-w-0 overflow-auto",children:c.jsxs("table",{className:"min-w-[760px] w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Client"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Locations"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Amount"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"User"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Generated"}),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:(y||[]).map(x=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[c.jsx("td",{className:"px-4 py-3 font-semibold",children:x.clientName}),c.jsx("td",{className:"px-4 py-3",children:x.locationText}),c.jsx("td",{className:"px-4 py-3",children:x.totalAmount}),c.jsx("td",{className:"px-4 py-3",children:x.userName}),c.jsx("td",{className:"px-4 py-3",children:x.generatedAt?new Date(x.generatedAt).toLocaleString():""}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:x.fileEntries.length?c.jsx("div",{className:"flex flex-col gap-2",children:x.fileEntries.map(g=>{const m=XU(g.url),b=JU(m),k=g.type==="pdf"?"proposal.pdf":"proposal.pptx",_=b||k;return c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wide text-black/50 dark:text-white/60",children:g.type}),c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:C=>{C.preventDefault(),N_(m,_)},onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),N_(m,_))},className:"inline-flex items-center",children:[c.jsx(wa,{size:14,className:"mr-1"}),"Download"]})})]},`${g.type}-${g.url}`)})}):c.jsx("span",{className:"text-xs text-black/50 dark:text-white/55",children:""})})]},x.id))})]})})}),y.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No matching proposals."})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No proposals yet."})})]})}function XU(t){return t?t.startsWith("http")?t:`${Pa.API_BASE_URL}${t}`:""}function JU(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function N_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function ZU(){const[t,e]=v.useState("generate");return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3 py-1",children:[c.jsx(se,{variant:t==="generate"?"default":"ghost",onClick:()=>e("generate"),className:`rounded-2xl mmg-tab-btn ${t==="generate"?"mmg-tab-btn-active":""}`,children:"Generate"}),c.jsx(se,{variant:t==="history"?"default":"ghost",onClick:()=>e("history"),className:`rounded-2xl mmg-tab-btn ${t==="history"?"mmg-tab-btn-active":""}`,children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="generate"?"h-full":"hidden","aria-hidden":t!=="generate",children:c.jsx(WU,{})}),c.jsx("div",{className:t==="history"?"h-full":"hidden","aria-hidden":t!=="history",children:c.jsx(YU,{})})]})]})})}function tT(t){return t?typeof t=="string"?t:t.name||t.id||t.value||"":""}function nT(t){return t?typeof t=="string"?t:t.name||t.value||t.permission||"":""}function Ng(t,e){if(!t||!e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function eH(t){const e=new Map;return(t||[]).forEach(n=>{const s=tT(n);if(!s)return;const r=(n.permissions||n.permission_list||n.permissionList||[]).map(nT).filter(Boolean);e.set(s,new Set(r))}),e}function tH(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permission_sets||n.permissionSets||n.permission_set_names||[]).map(tT).filter(Boolean);e.set(s,new Set(r))}),e}function nH(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permissions||[]).map(nT).filter(Boolean);e.set(s,new Set(r))}),e}function sH({q:t,setQ:e,openNewUserModal:n,usersQuery:s,users:r,user:i,selectUser:o,setConfirmDelete:a,companyLookup:l,userCompanyFilter:u,setUserCompanyFilter:d,userProfileFilter:h,setUserProfileFilter:f,companyFilterOptions:p,profileFilterOptions:w}){const y=v.useMemo(()=>[{value:"",label:"All companies"},...p.map(m=>({...m}))],[p]),x=v.useMemo(()=>[{value:"",label:"All profiles"},...w.map(m=>({...m}))],[w]),g=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Users"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:m=>e(m.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:n,children:"Add user"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(ot,{value:u,options:y,onChange:d}),c.jsx(ot,{value:h,options:x,onChange:f})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:g}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:g}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(m=>{var P,L,I,O;const b=Array.isArray(m.profiles)?m.profiles.map($=>($==null?void 0:$.display_name)||($==null?void 0:$.name)||$).filter(Boolean):[((P=m.profiles)==null?void 0:P.display_name)||((L=m.profiles)==null?void 0:L.name)||m.profile||m.profile_name].filter(Boolean),k=b.length?b.length>2?`${b[0]}, +${b.length-1}`:b.join(", "):"",_=!!(m.id&&(i!=null&&i.id)&&m.id===i.id||m.user_id&&(i!=null&&i.user_id)&&m.user_id===i.user_id||m.email&&(i!=null&&i.email)&&m.email===i.email),C=m.is_active??m.isActive??m.active,S=typeof C=="boolean",j=S?C:!0,N=j?"Deactivate":"Reactivate";return c.jsxs(zt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("div",{className:"text-base font-semibold",children:m.name||""}),S&&!j?c.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-semibold text-red-700 dark:bg-red-500/20 dark:text-red-200",children:"Inactive"}):null]}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:m.email})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>o(m),title:"Edit user","aria-label":"Edit user",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>a({open:!0,type:"user",payload:{id:m.id||m.user_id,isActive:j},label:`${N} user "${m.email}"?`}),disabled:_,title:_?"You cannot deactivate yourself":`${N} user`,"aria-label":`${N} user`,className:j?void 0:"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300",children:j?c.jsx(QM,{size:16}):c.jsx(YM,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Profiles: ",c.jsx("span",{className:"font-semibold",children:k})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Company:"," ",c.jsx("span",{className:"font-semibold",children:((I=m.company)==null?void 0:I.name)||l.get(((O=m.company)==null?void 0:O.code)||m.company_code||m.company_id)||""})]})]},m.id||m.user_id||m.email)})})})]})]})}function rH({q:t,setQ:e,usersQuery:n,users:s,user:r,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h,companyList:f,profileOptions:p,profileValues:w,permissionSetList:y,permissionSetValues:x,permissionList:g,permissionsQuery:m,page:b}){const{selectedUser:k,setSelectedUser:_,userForm:C,setUserForm:S,userModalOpen:j,setUserModalOpen:N,userModalLoading:P,setUserModalLoading:L,userModalMode:I,setUserModalMode:O,userProfilesOpen:$,setUserProfilesOpen:D,userPermissionSetsOpen:F,setUserPermissionSetsOpen:q,userPermissionsOpen:E,setUserPermissionsOpen:R,savingUser:V,setPermissionsMessage:K,selectUser:Q,openNewUserModal:re,saveUser:ee,deleteUser:z,selectedUserProfiles:A,selectedUserPermissionSets:Y,selectedUserPermissions:B,selectedUserPermissionSet:J,customUserPermissions:be,toggleUserPermission:pe,selectAllUserPermissions:H,clearUserPermissions:ye,toggleUserProfile:X,selectAllUserProfiles:ue,clearUserProfiles:ce,toggleUserPermissionSet:de,selectAllUserPermissionSets:ie,clearUserPermissionSets:Se}=iH({permissionList:g,profileValues:w,permissionSetValues:x,profileOptions:p,permissionSetList:y}),[oe,W]=v.useState({open:!1,type:"",payload:null,label:""}),ke=!!(k&&(k.id&&(r!=null&&r.id)&&k.id===(r==null?void 0:r.id)||k.user_id&&(r!=null&&r.user_id)&&k.user_id===(r==null?void 0:r.user_id)||k.email&&(r!=null&&r.email)&&k.email===(r==null?void 0:r.email)));v.useEffect(()=>{_(null)},[b,_]);async function Re(){if(!(!oe.open||!oe.payload))try{const Oe=oe.payload,ae=(Oe==null?void 0:Oe.id)??Oe;if(!ae||r!=null&&r.id&&ae===r.id||r!=null&&r.user_id&&ae===r.user_id)return;await z(Oe)}finally{W({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(sH,{q:t,setQ:e,openNewUserModal:re,usersQuery:n,users:s,user:r,selectUser:Q,setConfirmDelete:W,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h}),c.jsx(oH,{open:j,onClose:()=>{N(!1),_(null),K(""),L(!1),O("edit"),D(!1),q(!1),R(!1)},userModalLoading:P,userModalMode:I,selectedUser:k,userForm:C,setUserForm:S,companyList:f,profileOptions:p,profileValues:w,userProfilesOpen:$,setUserProfilesOpen:D,selectAllUserProfiles:ue,clearUserProfiles:ce,selectedUserProfiles:A,toggleUserProfile:X,permissionSetList:y,permissionSetValues:x,userPermissionSetsOpen:F,setUserPermissionSetsOpen:q,selectAllUserPermissionSets:ie,clearUserPermissionSets:Se,selectedUserPermissionSets:Y,toggleUserPermissionSet:de,userPermissionsOpen:E,setUserPermissionsOpen:R,selectedUserPermissions:B,permissionList:g,permissionsQuery:m,selectedUserPermissionSet:J,toggleUserPermission:pe,selectAllUserPermissions:H,clearUserPermissions:ye,customUserPermissions:be,isSelfUser:ke,setConfirmDelete:W,saveUser:ee,savingUser:V}),c.jsx(gc,{open:oe.open,message:oe.label,onClose:()=>W({open:!1,type:"",payload:null,label:""}),onConfirm:Re})]})}function iH({permissionList:t,profileValues:e,permissionSetValues:n,profileOptions:s,permissionSetList:r}){const i=Ks(),[o,a]=v.useState(null),[l,u]=v.useState({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,y]=v.useState("edit"),[x,g]=v.useState(!1),[m,b]=v.useState(!1),[k,_]=v.useState(!1),[C,S]=v.useState(!1),[j,N]=v.useState(""),P=v.useMemo(()=>new Set(l.profiles||[]),[l.profiles]),L=v.useMemo(()=>new Set(l.permissionSets||[]),[l.permissionSets]),I=v.useMemo(()=>vn(l.permissionsText),[l.permissionsText]),O=v.useMemo(()=>new Set(I),[I]),$=v.useMemo(()=>{if(!t.length)return I;const X=new Set(t);return I.filter(ue=>!X.has(ue))},[t,I]),D=v.useMemo(()=>eH(r),[r]),F=v.useMemo(()=>tH(s),[s]),q=v.useMemo(()=>nH(s),[s]);function E(X,ue,ce){return(X||[]).filter(de=>{const ie=ue.get(de);return ie?Ng(ie,ce):!0})}function R(X,ue,ce){const de=new Set(ce||[]);return(X||[]).filter(ie=>{const Se=q.get(ie),oe=F.get(ie);if(!Se&&!oe)return!0;if(oe&&!Ng(oe,de))return!1;const W=new Set;return Se&&Se.forEach(ke=>W.add(ke)),oe&&oe.forEach(ke=>{const Re=D.get(ke);Re&&Re.forEach(Oe=>W.add(Oe))}),Ng(W,ue)})}function V(X,ue){const ce=new Set(X.profiles||[]),de=new Set(X.permissionSets||[]),ie=new Set(vn(X.permissionsText));return ce.forEach(Se=>{const oe=F.get(Se);oe&&oe.forEach(ke=>de.add(ke));const W=q.get(Se);W&&W.forEach(ke=>ie.add(ke)),oe&&oe.forEach(ke=>{const Re=D.get(ke);Re&&Re.forEach(Oe=>ie.add(Oe))})}),{...X,permissionSets:Array.from(de),permissionsText:Array.from(ie).join(`
`)}}async function K(X){var ie,Se;a(X),N(""),y("edit"),h(!0),p(!0),g(!1),b(!1),_(!1);const ue=Array.isArray(X.profiles)?X.profiles.map(oe=>(oe==null?void 0:oe.name)||(oe==null?void 0:oe.id)||oe).filter(Boolean):[((ie=X.profiles)==null?void 0:ie.name)||X.profile||X.profile_name].filter(Boolean),ce=(X.permission_sets||X.permissionSets||X.permission_set_names||[]).map(oe=>typeof oe=="string"?oe:(oe==null?void 0:oe.name)||(oe==null?void 0:oe.id)).filter(Boolean);u({name:X.name||"",email:X.email||"",profiles:ue,permissionSets:ce,company:((Se=X.company)==null?void 0:Se.code)||X.company_code||X.company_id||"",is_active:X.is_active!==!1,permissionsText:""});const de=X.id||X.user_id;if(de)try{const oe=await jB(de),W=(oe==null?void 0:oe.permissions)??oe,ke=Array.isArray(W)?W.map(Re=>typeof Re=="string"?Re:Re==null?void 0:Re.name).filter(Boolean):[];u(Re=>V({...Re,permissionsText:ke.join(`
`)}))}catch{}p(!1)}function Q(){a(null),N(""),y("add"),p(!1),g(!1),b(!1),_(!1),u({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),h(!0)}async function re(){var ie,Se;if(w==="edit"&&!o)return;S(!0),N("");const X=(o==null?void 0:o.id)||(o==null?void 0:o.user_id);if(w==="edit"&&!X){S(!1),N("Missing user id");return}const ue=vn(l.permissionsText),ce=l.profiles||[],de={name:l.name,is_active:!!l.is_active,profile_names:ce,profile_name:ce[0]||null,permission_sets:l.permissionSets||[],company_code:l.company||null,...w==="add"?{email:l.email}:{}};try{if(w==="add"){const oe=await CB(de),W=(oe==null?void 0:oe.id)||(oe==null?void 0:oe.user_id)||((ie=oe==null?void 0:oe.user)==null?void 0:ie.id)||((Se=oe==null?void 0:oe.user)==null?void 0:Se.user_id);W!=null&&await Kk(W,ue),N("User created")}else await NB(X,de),await Kk(X,ue),N("User updated");i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch(oe){N((oe==null?void 0:oe.message)||"Failed to save user")}finally{S(!1)}}async function ee(X){const ue=(X==null?void 0:X.id)??X;if(ue)try{const ce=(X==null?void 0:X.isActive)??(X==null?void 0:X.is_active);(typeof ce=="boolean"?ce:!0)?await EB(ue):await TB(ue),i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch{}}function z(X){u(ue=>{const ce=new Set(vn(ue.permissionsText)),de=ce.has(X);de?ce.delete(X):ce.add(X);let ie=ue.permissionSets||[],Se=ue.profiles||[];return de&&(ie=E(ie,D,ce),Se=R(Se,ce,ie)),{...ue,permissionsText:Array.from(ce).join(`
`),permissionSets:ie,profiles:Se}})}function A(){const X=new Set([...I,...t]);u(ue=>({...ue,permissionsText:Array.from(X).join(`
`)}))}function Y(){u(X=>({...X,permissionsText:"",permissionSets:[],profiles:[]}))}function B(X){u(ue=>{const ce=new Set(ue.profiles||[]),de=new Set(ue.permissionSets||[]),ie=new Set(vn(ue.permissionsText));if(ce.has(X)){ce.delete(X);const ke=E(Array.from(de),D,ie),Re=R(Array.from(ce),ie,ke);return{...ue,profiles:Re,permissionSets:ke,permissionsText:Array.from(ie).join(`
`)}}ce.add(X);const oe=F.get(X);oe&&oe.forEach(ke=>de.add(ke));const W=q.get(X);return W&&W.forEach(ke=>ie.add(ke)),oe&&oe.forEach(ke=>{const Re=D.get(ke);Re&&Re.forEach(Oe=>ie.add(Oe))}),{...ue,profiles:Array.from(ce),permissionSets:Array.from(de),permissionsText:Array.from(ie).join(`
`)}})}function J(){u(X=>{const ue=new Set([...X.profiles||[],...e]),ce=new Set(X.permissionSets||[]),de=new Set(vn(X.permissionsText));return ue.forEach(ie=>{const Se=F.get(ie);Se&&Se.forEach(W=>ce.add(W));const oe=q.get(ie);oe&&oe.forEach(W=>de.add(W)),Se&&Se.forEach(W=>{const ke=D.get(W);ke&&ke.forEach(Re=>de.add(Re))})}),{...X,profiles:Array.from(ue),permissionSets:Array.from(ce),permissionsText:Array.from(de).join(`
`)}})}function be(){u(X=>({...X,profiles:[]}))}function pe(X){u(ue=>{const ce=new Set(ue.permissionSets||[]),de=new Set(vn(ue.permissionsText));if(ce.has(X)){ce.delete(X);const oe=R(ue.profiles||[],de,Array.from(ce));return{...ue,permissionSets:Array.from(ce),profiles:oe,permissionsText:Array.from(de).join(`
`)}}ce.add(X);const Se=D.get(X);return Se&&Se.forEach(oe=>de.add(oe)),{...ue,permissionSets:Array.from(ce),permissionsText:Array.from(de).join(`
`)}})}function H(){u(X=>{const ue=new Set([...X.permissionSets||[],...n]),ce=new Set(vn(X.permissionsText));return ue.forEach(de=>{const ie=D.get(de);ie&&ie.forEach(Se=>ce.add(Se))}),{...X,permissionSets:Array.from(ue),permissionsText:Array.from(ce).join(`
`)}})}function ye(){u(X=>{const ue=new Set(vn(X.permissionsText)),ce=R(X.profiles||[],ue,[]);return{...X,permissionSets:[],profiles:ce,permissionsText:Array.from(ue).join(`
`)}})}return{selectedUser:o,setSelectedUser:a,userForm:l,setUserForm:u,userModalOpen:d,setUserModalOpen:h,userModalLoading:f,setUserModalLoading:p,userModalMode:w,setUserModalMode:y,userProfilesOpen:x,setUserProfilesOpen:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:b,userPermissionsOpen:k,setUserPermissionsOpen:_,savingUser:C,permissionsMessage:j,setPermissionsMessage:N,selectUser:K,openNewUserModal:Q,saveUser:re,selectedUserProfiles:P,selectedUserPermissionSets:L,selectedUserPermissions:I,selectedUserPermissionSet:O,customUserPermissions:$,toggleUserPermission:z,selectAllUserPermissions:A,clearUserPermissions:Y,toggleUserProfile:B,selectAllUserProfiles:J,clearUserProfiles:be,toggleUserPermissionSet:pe,selectAllUserPermissionSets:H,clearUserPermissionSets:ye,deleteUser:ee}}function oH({open:t,onClose:e,userModalLoading:n,userModalMode:s,selectedUser:r,userForm:i,setUserForm:o,companyList:a,profileOptions:l,profileValues:u,userProfilesOpen:d,setUserProfilesOpen:h,selectAllUserProfiles:f,clearUserProfiles:p,selectedUserProfiles:w,toggleUserProfile:y,permissionSetList:x,permissionSetValues:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:b,selectAllUserPermissionSets:k,clearUserPermissionSets:_,selectedUserPermissionSets:C,toggleUserPermissionSet:S,userPermissionsOpen:j,setUserPermissionsOpen:N,selectedUserPermissions:P,permissionList:L,permissionsQuery:I,selectedUserPermissionSet:O,toggleUserPermission:$,selectAllUserPermissions:D,clearUserPermissions:F,customUserPermissions:q,isSelfUser:E,setConfirmDelete:R,saveUser:V,savingUser:K}){const Q=v.useMemo(()=>{const ee=a.map(z=>{const A=z.code||z.id||"";return{value:A,label:z.name||z.code||A||""}}).filter(z=>z.value);return[{value:"",label:"Select company"},...ee]},[a]),re=v.useMemo(()=>[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],[]);return c.jsx(Cs,{open:t,onClose:e,title:s==="add"?"Add user":"Edit user",maxWidth:"560px",children:n?c.jsx(Ve,{text:"Loading user",className:"text-sm text-black/60 dark:text-white/65"}):s==="add"||r?c.jsxs("div",{className:"space-y-3",children:[s==="edit"?c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/55",children:["Editing ",r==null?void 0:r.email]}):null,c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.name,onChange:ee=>o(z=>({...z,name:ee.target.value}))})}),c.jsx(Ee,{label:"Email",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.email,onChange:ee=>o(z=>({...z,email:ee.target.value})),type:"email",disabled:s==="edit"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Company",children:c.jsx(ot,{value:i.company||"",options:Q,onChange:ee=>o(z=>({...z,company:ee}))})}),c.jsx(Ee,{label:"Status",children:c.jsx(ot,{value:i.is_active?"active":"inactive",options:re,onChange:ee=>o(z=>({...z,is_active:ee==="active"}))})})]}),c.jsx(Ee,{label:"Profiles",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>h(ee=>!ee),"aria-expanded":d,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Profiles"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Nl(i.profiles.length,"profile")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:d?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",d&&"rotate-180")})]})]}),d?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!u.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!i.profiles.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[l.map(ee=>{const z=ee.name||ee.id;if(!z)return null;const A=w.has(z);return c.jsxs("button",{type:"button",onClick:()=>y(z),className:Pe("mmg-profile-option flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",A?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee.display_name||ee.name||z}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",A?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(da,{size:14,className:A?"opacity-100":"opacity-0"})})]},z)}),l.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No profiles available."})]})]}):null]})}),c.jsx(Ee,{label:"Permission Sets",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>b(ee=>!ee),"aria-expanded":m,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Nl(i.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:m?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",m&&"rotate-180")})]})]}),m?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:k,disabled:!g.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:_,disabled:!i.permissionSets.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[x.map(ee=>{const z=ee.name||ee.id;if(!z)return null;const A=C.has(z);return c.jsxs("button",{type:"button",onClick:()=>S(z),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",A?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee.display_name||ee.name||z}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",A?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(da,{size:14,className:A?"opacity-100":"opacity-0"})})]},z)}),x.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]})]}):null]})}),c.jsx(Ee,{label:"Permissions",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>N(ee=>!ee),"aria-expanded":j,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Nl(P.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:j?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",j&&"rotate-180")})]})]}),j?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:D,disabled:!L.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:F,disabled:!P.length,children:"Clear"})]})}),I.isLoading?c.jsx(Ve,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):L.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:L.map(ee=>{const z=O.has(ee);return c.jsxs("button",{type:"button",onClick:()=>$(ee),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",z?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",z?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(da,{size:14,className:z?"opacity-100":"opacity-0"})})]},ee)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),q.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:q.map(ee=>c.jsxs("button",{type:"button",onClick:()=>$(ee),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:ee}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},ee))})]}):null]}):null]})}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[s==="edit"?c.jsx(se,{variant:"ghost",className:Pe("rounded-2xl",typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"&&!((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))?"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300":"text-red-600 hover:text-red-700 dark:text-red-300"),onClick:()=>R({open:!0,type:"user",payload:{id:(r==null?void 0:r.id)||(r==null?void 0:r.user_id),isActive:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active):!0},label:`${typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"} user "${r==null?void 0:r.email}"?`}),disabled:E,children:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:V,disabled:K,children:K?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Select a user to edit."})})}function aH({companySearch:t,setCompanySearch:e,openCompanyModal:n,companiesQuery:s,filteredCompanyList:r,companyLookup:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Companies"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add company"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:a}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(zt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.name||l.code}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.code||""})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>n(l),title:"Edit company","aria-label":"Edit company",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>o({open:!0,type:"company",payload:l.code||l.id,label:`Delete company "${l.name||l.code}"?`}),title:"Delete company","aria-label":"Delete company",children:c.jsx(ha,{size:16})})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[l.country?c.jsx("span",{children:l.country}):null,l.currency?c.jsxs("span",{children:[" ",l.currency]}):null,l.timezone?c.jsxs("span",{children:[" ",l.timezone]}):null]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[c.jsxs("span",{children:["Parent: ",i.get(l.parent_id)||""]}),c.jsxs("span",{children:[" ",l.isgroup?"Group":"Company"]}),c.jsxs("span",{children:[" ",l.is_active===!1?"Inactive":"Active"]})]})]},l.code||l.id)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching companies.":"No companies available."})]})})]})]})}function lH({companySearch:t,setCompanySearch:e,companiesQuery:n,filteredCompanyList:s,companyLookup:r,companyList:i}){const{companyForm:o,setCompanyForm:a,editingCompany:l,setEditingCompany:u,companyModalOpen:d,setCompanyModalOpen:h,savingCompany:f,openCompanyModal:p,saveCompany:w,deleteCompany:y}=cH(),[x,g]=v.useState({open:!1,type:"",payload:null,label:""});async function m(){if(!(!x.open||!x.payload))try{await y(x.payload)}finally{g({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(aH,{companySearch:t,setCompanySearch:e,openCompanyModal:p,companiesQuery:n,filteredCompanyList:s,companyLookup:r,setConfirmDelete:g}),c.jsx(uH,{open:d,onClose:()=>{h(!1),u(null),a({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})},editingCompany:l,companyForm:o,setCompanyForm:a,companyList:i,setConfirmDelete:g,saveCompany:w,savingCompany:f}),c.jsx(gc,{open:x.open,message:x.label,onClose:()=>g({open:!1,type:"",payload:null,label:""}),onConfirm:m})]})}function cH(){const t=Ks(),[e,n]=v.useState({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0}),[s,r]=v.useState(null),[i,o]=v.useState(!1),[a,l]=v.useState(!1);function u(f){f?(r(f.code||f.id),n({code:f.code||"",name:f.name||"",parent_id:f.parent_id??"",country:f.country??"",currency:f.currency??"",timezone:f.timezone??"",isgroup:!!f.isgroup,is_active:f.is_active!==!1})):(r(null),n({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})),o(!0)}async function d(){if(!e.code.trim()||!e.name.trim())return;l(!0);const f={code:e.code.trim(),name:e.name.trim(),parent_id:e.parent_id||null,country:e.country||null,currency:e.currency||null,timezone:e.timezone||null,isgroup:!!e.isgroup,is_active:!!e.is_active};try{s?await LB(s,f):await DB(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}finally{l(!1)}}async function h(f){if(f)try{await $B(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}}return{companyForm:e,setCompanyForm:n,editingCompany:s,setEditingCompany:r,companyModalOpen:i,setCompanyModalOpen:o,savingCompany:a,openCompanyModal:u,saveCompany:d,deleteCompany:h}}function uH({open:t,onClose:e,editingCompany:n,companyForm:s,setCompanyForm:r,companyList:i,setConfirmDelete:o,saveCompany:a,savingCompany:l}){const u=[{value:"",label:"None"},...i.filter(f=>(f.code||f.id)!==s.code).map(f=>{const p=f.code||f.id||"";return{value:p,label:f.name||f.code||p||""}}).filter(f=>f.value)],d=[{value:"company",label:"Company"},{value:"group",label:"Group"}],h=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return c.jsx(Cs,{open:t,onClose:e,title:n?`Edit company: ${s.name||s.code}`:"Add company",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Code",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.code,onChange:f=>r(p=>({...p,code:f.target.value})),placeholder:"MMG-001",disabled:!!n})}),c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:f=>r(p=>({...p,name:f.target.value})),placeholder:"MMG Global"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Parent company",children:c.jsx(ot,{value:s.parent_id||"",options:u,onChange:f=>r(p=>({...p,parent_id:f}))})}),c.jsx(Ee,{label:"Country",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.country,onChange:f=>r(p=>({...p,country:f.target.value})),placeholder:"US"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Currency",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.currency,onChange:f=>r(p=>({...p,currency:f.target.value})),placeholder:"USD"})}),c.jsx(Ee,{label:"Timezone",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.timezone,onChange:f=>r(p=>({...p,timezone:f.target.value})),placeholder:"America/New_York"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Type",children:c.jsx(ot,{value:s.isgroup?"group":"company",options:d,onChange:f=>r(p=>({...p,isgroup:f==="group"}))})}),c.jsx(Ee,{label:"Status",children:c.jsx(ot,{value:s.is_active?"active":"inactive",options:h,onChange:f=>r(p=>({...p,is_active:f==="active"}))})})]}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(se,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>o({open:!0,type:"company",payload:n,label:`Delete company "${s.name||s.code}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:a,disabled:l,children:l?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]})})}function dH({profileSearch:t,setProfileSearch:e,openProfileModal:n,filteredProfileOptions:s,duplicateProfile:r,setConfirmDelete:i}){const o=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Profiles"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:a=>e(a.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add profile"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:o}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:o}),c.jsxs("div",{className:"space-y-4 p-5 pt-1",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.map(a=>c.jsxs(zt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:a.display_name||a.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:a.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>r(a),title:"Duplicate profile","aria-label":"Duplicate profile",children:c.jsx(YC,{size:16})}),a.is_system?c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:"System"}):c.jsxs(c.Fragment,{children:[c.jsx(An,{onClick:()=>n(a),title:"Edit profile","aria-label":"Edit profile",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>i({open:!0,type:"profile",payload:a.id||a.name,label:`Delete profile "${a.display_name||a.name}"?`}),title:"Delete profile","aria-label":"Delete profile",children:c.jsx(ha,{size:16})})]})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(a.permissions||[]).length," permission",(a.permissions||[]).length===1?"":"s"]}),a.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:a.description}):null]},a.id||a.name))}),s.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching profiles.":"No profiles available."})]})]})]})}function hH({profileSearch:t,setProfileSearch:e,filteredProfileOptions:n,permissionList:s,permissionSetValues:r,permissionSetList:i,permissionSetsQuery:o,permissionsQuery:a}){const{profileForm:l,setProfileForm:u,editingProfile:d,setEditingProfile:h,profileModalOpen:f,setProfileModalOpen:p,profileIsSystem:w,setProfileIsSystem:y,profilePermissionSetsOpen:x,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:b,savingProfile:k,openProfileModal:_,duplicateProfile:C,saveProfile:S,deleteProfile:j,selectedProfilePermissions:N,selectedProfilePermissionSet:P,selectedProfilePermissionSets:L,customProfilePermissions:I,toggleProfilePermission:O,selectAllProfilePermissions:$,clearProfilePermissions:D,toggleProfilePermissionSet:F,selectAllProfilePermissionSets:q,clearProfilePermissionSets:E}=fH({permissionList:s,permissionSetValues:r,permissionSetList:i}),[R,V]=v.useState({open:!1,type:"",payload:null,label:""});async function K(){if(!(!R.open||!R.payload))try{await j(R.payload)}finally{V({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(dH,{profileSearch:t,setProfileSearch:e,openProfileModal:_,filteredProfileOptions:n,duplicateProfile:C,setConfirmDelete:V}),c.jsx(pH,{open:f,onClose:()=>{p(!1),h(null),u({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),y(!1),g(!1),b(!1)},editingProfile:d,profileForm:l,setProfileForm:u,profileIsSystem:w,profilePermissionSetsOpen:x,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:b,permissionSetValues:r,permissionSetsQuery:o,permissionSetList:i,selectedProfilePermissionSets:L,toggleProfilePermissionSet:F,selectAllProfilePermissionSets:q,clearProfilePermissionSets:E,selectedProfilePermissions:N,permissionList:s,permissionsQuery:a,selectedProfilePermissionSet:P,toggleProfilePermission:O,selectAllProfilePermissions:$,clearProfilePermissions:D,customProfilePermissions:I,setConfirmDelete:V,saveProfile:S,savingProfile:k}),c.jsx(gc,{open:R.open,message:R.label,onClose:()=>V({open:!1,type:"",payload:null,label:""}),onConfirm:K})]})}function fH({permissionList:t,permissionSetValues:e,permissionSetList:n}){const s=Ks(),[r,i]=v.useState({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),[o,a]=v.useState(null),[l,u]=v.useState(!1),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,y]=v.useState(!1),[x,g]=v.useState(!1),m=v.useMemo(()=>vn(r.permissionsText),[r.permissionsText]),b=v.useMemo(()=>new Set(m),[m]),k=v.useMemo(()=>new Set(r.permissionSets||[]),[r.permissionSets]),_=v.useMemo(()=>{if(!t.length)return m;const E=new Set(t);return m.filter(R=>!E.has(R))},[t,m]),C=v.useMemo(()=>{const E=new Map;return(n||[]).forEach(R=>{const V=R.name||R.id;if(!V)return;const K=(R.permissions||R.permission_list||R.permissionList||[]).map(Q=>typeof Q=="string"?Q:(Q==null?void 0:Q.name)||(Q==null?void 0:Q.value)||(Q==null?void 0:Q.permission)).filter(Boolean);E.set(V,new Set(K))}),E},[n]);function S(E,R){return(E||[]).filter(V=>{const K=C.get(V);if(!K)return!0;for(const Q of K)if(!R.has(Q))return!1;return!0})}function j(E){h(!!(E!=null&&E.is_system)),!(E!=null&&E.is_system)&&(p(!1),y(!1),E?(a(E.id||E.name),i({name:E.name,display_name:E.display_name||E.name,description:E.description||"",permissionsText:(E.permissions||[]).map(R=>typeof R=="string"?R:R==null?void 0:R.name).filter(Boolean).join(`
`),permissionSets:(E.permission_sets||E.permissionSets||E.permission_set_names||[]).map(R=>typeof R=="string"?R:(R==null?void 0:R.name)||(R==null?void 0:R.id)).filter(Boolean)})):(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!0))}function N(E){if(!E)return;const R=E.name||E.display_name||"profile",V=E.display_name||E.name||R;h(!1),a(null),p(!1),y(!1),i({name:`${R}_new`,display_name:`${V}_new`,description:E.description||"",permissionsText:(E.permissions||[]).map(K=>typeof K=="string"?K:K==null?void 0:K.name).filter(Boolean).join(`
`),permissionSets:(E.permission_sets||E.permissionSets||E.permission_set_names||[]).map(K=>typeof K=="string"?K:(K==null?void 0:K.name)||(K==null?void 0:K.id)).filter(Boolean)}),u(!0)}async function P(){if(r.name.trim()){g(!0);try{const E={name:r.name.trim(),display_name:r.display_name||r.name,description:r.description,permissions:vn(r.permissionsText),permission_sets:r.permissionSets||[]};o?await AB(o,E):await RB(E),s.invalidateQueries({queryKey:["admin","profiles"]}),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),a(null),u(!1)}catch{}finally{g(!1)}}}async function L(E){try{await OB(E),s.invalidateQueries({queryKey:["admin","profiles"]}),o===E&&(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!1)}catch{}}function I(E){i(R=>{const V=new Set(vn(R.permissionsText)),K=V.has(E);K?V.delete(E):V.add(E);let Q=R.permissionSets||[];return K&&(Q=S(Q,V)),{...R,permissionsText:Array.from(V).join(`
`),permissionSets:Q}})}function O(){const E=new Set([...m,...t]);i(R=>({...R,permissionsText:Array.from(E).join(`
`)}))}function $(){i(E=>({...E,permissionsText:""}))}function D(E){i(R=>{const V=new Set(R.permissionSets||[]),K=new Set(vn(R.permissionsText));if(V.has(E))return V.delete(E),{...R,permissionSets:Array.from(V),permissionsText:Array.from(K).join(`
`)};V.add(E);const re=C.get(E);return re&&re.forEach(ee=>K.add(ee)),{...R,permissionSets:Array.from(V),permissionsText:Array.from(K).join(`
`)}})}function F(){i(E=>{const R=new Set([...E.permissionSets||[],...e]),V=new Set(vn(E.permissionsText));return R.forEach(K=>{const Q=C.get(K);Q&&Q.forEach(re=>V.add(re))}),{...E,permissionSets:Array.from(R),permissionsText:Array.from(V).join(`
`)}})}function q(){i(E=>({...E,permissionSets:[]}))}return{profileForm:r,setProfileForm:i,editingProfile:o,setEditingProfile:a,profileModalOpen:l,setProfileModalOpen:u,profileIsSystem:d,setProfileIsSystem:h,profilePermissionSetsOpen:f,setProfilePermissionSetsOpen:p,profilePermissionsOpen:w,setProfilePermissionsOpen:y,savingProfile:x,openProfileModal:j,duplicateProfile:N,saveProfile:P,deleteProfile:L,selectedProfilePermissions:m,selectedProfilePermissionSet:b,selectedProfilePermissionSets:k,customProfilePermissions:_,toggleProfilePermission:I,selectAllProfilePermissions:O,clearProfilePermissions:$,toggleProfilePermissionSet:D,selectAllProfilePermissionSets:F,clearProfilePermissionSets:q}}function pH({open:t,onClose:e,editingProfile:n,profileForm:s,setProfileForm:r,profileIsSystem:i,profilePermissionSetsOpen:o,setProfilePermissionSetsOpen:a,profilePermissionsOpen:l,setProfilePermissionsOpen:u,permissionSetValues:d,permissionSetsQuery:h,permissionSetList:f,selectedProfilePermissionSets:p,toggleProfilePermissionSet:w,selectAllProfilePermissionSets:y,clearProfilePermissionSets:x,selectedProfilePermissions:g,permissionList:m,permissionsQuery:b,selectedProfilePermissionSet:k,toggleProfilePermission:_,selectAllProfilePermissions:C,clearProfilePermissions:S,customProfilePermissions:j,setConfirmDelete:N,saveProfile:P,savingProfile:L}){return c.jsx(Cs,{open:t,onClose:e,title:n?`Edit profile: ${n}`:"Add profile",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:I=>r(O=>({...O,name:I.target.value})),placeholder:"system_admin",disabled:!!n})}),c.jsx(Ee,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:I=>r(O=>({...O,display_name:I.target.value})),placeholder:"System Admin"})})]}),c.jsx(Ee,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:I=>r(O=>({...O,description:I.target.value})),placeholder:"What this profile can do"})}),c.jsx(Ee,{label:"Permission Sets",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>a(I=>!I),"aria-expanded":o,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Nl(s.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:o?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",o&&"rotate-180")})]})]}),o?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:y,disabled:!d.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:x,disabled:!s.permissionSets.length,children:"Clear"})]})}),h.isLoading?c.jsx(Ve,{text:"Loading permission sets",className:"text-sm text-black/60 dark:text-white/65"}):f.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:f.map(I=>{const O=I.name||I.id;if(!O)return null;const $=p.has(O);return c.jsxs("button",{type:"button",onClick:()=>w(O),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",$?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate text-xs font-medium",children:I.display_name||I.name||O}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",$?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(da,{size:14,className:$?"opacity-100":"opacity-0"})})]},O)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]}):null]})}),c.jsx(Ee,{label:"Permissions",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>u(I=>!I),"aria-expanded":l,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Nl(g.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:l?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",l&&"rotate-180")})]})]}),l?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,disabled:!m.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:S,disabled:!g.length,children:"Clear"})]})}),b.isLoading?c.jsx(Ve,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):m.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[110px] overflow-y-auto p-1",children:m.map(I=>{const O=k.has(I);return c.jsxs("button",{type:"button",onClick:()=>_(I),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",O?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:I}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",O?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(da,{size:14,className:O?"opacity-100":"opacity-0"})})]},I)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),j.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:j.map(I=>c.jsxs("button",{type:"button",onClick:()=>_(I),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:I}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},I))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(se,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>N({open:!0,type:"profile",payload:n,label:`Delete profile "${s.display_name||s.name}"?`}),disabled:i,children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:P,disabled:L||i,children:L?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]})})}function mH({permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:n,permissionSetsQuery:s,filteredPermissionSetList:r,duplicatePermissionSet:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Permission Sets"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add permission set"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:a}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(zt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.display_name||l.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>i(l),title:"Duplicate permission set","aria-label":"Duplicate permission set",children:c.jsx(YC,{size:16})}),c.jsx(An,{onClick:()=>n(l),title:"Edit permission set","aria-label":"Edit permission set",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>o({open:!0,type:"permission-set",payload:l.name,label:`Delete permission set "${l.display_name||l.name}"?`}),title:"Delete permission set","aria-label":"Delete permission set",children:c.jsx(ha,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(l.permissions||[]).length," permission",(l.permissions||[]).length===1?"":"s"]}),l.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:l.description}):null]},l.name)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permission sets.":"No permission sets available."})]})})]})]})}function gH({permissionSetSearch:t,setPermissionSetSearch:e,permissionSetsQuery:n,filteredPermissionSetList:s,permissionList:r,permissionsQuery:i}){const{permissionSetForm:o,setPermissionSetForm:a,editingPermissionSet:l,setEditingPermissionSet:u,permissionSetModalOpen:d,setPermissionSetModalOpen:h,savingPermissionSet:f,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:w,openPermissionSetModal:y,duplicatePermissionSet:x,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:b,selectedPermissionSetPermissionSet:k,customPermissionSetPermissions:_,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j}=xH({permissionList:r}),[N,P]=v.useState({open:!1,type:"",payload:null,label:""});async function L(){if(!(!N.open||!N.payload))try{await m(N.payload)}finally{P({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(mH,{permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:y,permissionSetsQuery:n,filteredPermissionSetList:s,duplicatePermissionSet:x,setConfirmDelete:P}),c.jsx(yH,{open:d,onClose:()=>{h(!1),u(null),a({name:"",display_name:"",description:"",permissionsText:""}),w(!1)},editingPermissionSet:l,permissionSetForm:o,setPermissionSetForm:a,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:w,selectedPermissionSetPermissions:b,permissionList:r,permissionsQuery:i,selectedPermissionSetPermissionSet:k,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j,customPermissionSetPermissions:_,setConfirmDelete:P,savePermissionSet:g,savingPermissionSet:f}),c.jsx(gc,{open:N.open,message:N.label,onClose:()=>P({open:!1,type:"",payload:null,label:""}),onConfirm:L})]})}function xH({permissionList:t}){const e=Ks(),[n,s]=v.useState({name:"",display_name:"",description:"",permissionsText:""}),[r,i]=v.useState(null),[o,a]=v.useState(!1),[l,u]=v.useState(!1),[d,h]=v.useState(!1),f=v.useMemo(()=>vn(n.permissionsText),[n.permissionsText]),p=v.useMemo(()=>new Set(f),[f]),w=v.useMemo(()=>{if(!t.length)return f;const C=new Set(t);return f.filter(S=>!C.has(S))},[t,f]);function y(C){h(!1),C?(i(C.name),s({name:C.name||"",display_name:C.display_name||C.name||"",description:C.description||"",permissionsText:(C.permissions||[]).map(S=>typeof S=="string"?S:S==null?void 0:S.name).filter(Boolean).join(`
`)})):(i(null),s({name:"",display_name:"",description:"",permissionsText:""})),a(!0)}function x(C){if(!C)return;const S=C.name||C.display_name||"permission_set",j=C.display_name||C.name||S;i(null),h(!1),s({name:`${S}_new`,display_name:`${j}_new`,description:C.description||"",permissionsText:(C.permissions||[]).map(N=>typeof N=="string"?N:N==null?void 0:N.name).filter(Boolean).join(`
`)}),a(!0)}async function g(){if(!n.name.trim())return;u(!0);const C={name:n.name.trim(),display_name:n.display_name||n.name.trim(),description:n.description,permissions:vn(n.permissionsText)};try{r?await BB(r,C):await zB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}finally{u(!1)}}async function m(C){if(C)try{await UB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}}function b(C){s(S=>{const j=new Set(vn(S.permissionsText));return j.has(C)?j.delete(C):j.add(C),{...S,permissionsText:Array.from(j).join(`
`)}})}function k(){const C=new Set([...f,...t]);s(S=>({...S,permissionsText:Array.from(C).join(`
`)}))}function _(){s(C=>({...C,permissionsText:""}))}return{permissionSetForm:n,setPermissionSetForm:s,editingPermissionSet:r,setEditingPermissionSet:i,permissionSetModalOpen:o,setPermissionSetModalOpen:a,savingPermissionSet:l,permissionSetPermissionsOpen:d,setPermissionSetPermissionsOpen:h,openPermissionSetModal:y,duplicatePermissionSet:x,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:f,selectedPermissionSetPermissionSet:p,customPermissionSetPermissions:w,togglePermissionSetPermission:b,selectAllPermissionSetPermissions:k,clearPermissionSetPermissions:_}}function yH({open:t,onClose:e,editingPermissionSet:n,permissionSetForm:s,setPermissionSetForm:r,permissionSetPermissionsOpen:i,setPermissionSetPermissionsOpen:o,selectedPermissionSetPermissions:a,permissionList:l,permissionsQuery:u,selectedPermissionSetPermissionSet:d,togglePermissionSetPermission:h,selectAllPermissionSetPermissions:f,clearPermissionSetPermissions:p,customPermissionSetPermissions:w,setConfirmDelete:y,savePermissionSet:x,savingPermissionSet:g}){return c.jsx(Cs,{open:t,onClose:e,title:n?`Edit permission set: ${n}`:"Add permission set",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:m=>r(b=>({...b,name:m.target.value})),placeholder:"sales_ops",disabled:!!n})}),c.jsx(Ee,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:m=>r(b=>({...b,display_name:m.target.value})),placeholder:"Sales Ops"})})]}),c.jsx(Ee,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:m=>r(b=>({...b,description:m.target.value})),placeholder:"What this permission set grants"})}),c.jsx(Ee,{label:"Permissions",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>o(m=>!m),"aria-expanded":i,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Nl(a.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:i?"Hide":"Edit"}),c.jsx(ns,{size:16,className:Pe("transition-transform",i&&"rotate-180")})]})]}),i?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!l.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!a.length,children:"Clear"})]})}),u.isLoading?c.jsx(Ve,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:l.map(m=>{const b=d.has(m);return c.jsxs("button",{type:"button",onClick:()=>h(m),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",b?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:m}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",b?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(da,{size:14,className:b?"opacity-100":"opacity-0"})})]},m)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),w.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:w.map(m=>c.jsxs("button",{type:"button",onClick:()=>h(m),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:m}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},m))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(se,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>y({open:!0,type:"permission-set",payload:n,label:`Delete permission set "${s.display_name||s.name}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:x,disabled:g,children:g?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]})})}function vH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:y,setConfirmDelete:x}){const g=[{value:"",label:"All modules"},...u.map(_=>({value:_,label:_}))],m=[{value:"",label:"All services"},...d.map(_=>({value:_,label:_}))],b=[{value:"",label:"All permissions"},...h.map(_=>({value:_,label:_}))],k=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Permissions"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:_=>e(_.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{className:"rounded-2xl self-start sm:self-auto",variant:"secondary",onClick:()=>n("add",""),children:"Add permission"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[c.jsx(ot,{value:s,options:g,onChange:r}),c.jsx(ot,{value:i,options:m,onChange:o}),c.jsx(ot,{value:a,options:b,onChange:l,className:"col-span-2 sm:col-span-1"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:k}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:k}),c.jsx("div",{className:"space-y-3 p-5 pt-1",children:f.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):p.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:p.map(_=>{const C=w(_),S=y[_];return c.jsxs(zt,{className:"p-3",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Module"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.module})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Service"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.service})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Permission"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.action})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>n("edit",_),title:"Edit permission","aria-label":"Edit permission",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>x({open:!0,type:"permission",payload:_,label:`Delete permission "${_}"?`}),title:"Delete permission","aria-label":"Delete permission",children:c.jsx(ha,{size:16})})]})]}),S?c.jsxs("div",{className:"mt-2 flex items-baseline gap-1 text-sm min-w-0",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Description"}),c.jsx("span",{className:"text-black/60 dark:text-white/65 truncate",children:S})]}):null]},_)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permissions.":"No permissions available."})})]})]})}function bH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:y,permissionTree:x,updateLocalPermissionDescription:g}){const{permissionModal:m,setPermissionModal:b,permissionModalError:k,savingPermission:_,openPermissionModal:C,updatePermissionModalField:S,savePermissionModal:j,deletePermissionFromModal:N,setPermissionModalError:P}=wH({mergedPermissionDescriptions:y,updateLocalPermissionDescription:g}),[L,I]=v.useState({open:!1,type:"",payload:null,label:""}),O=m.module?x.servicesByModule[m.module]||[]:x.allServices,$=m.module&&m.service?x.actionsByService[`${m.module}:${m.service}`]||[]:x.allActions;async function D(){if(!(!L.open||!L.payload))try{await N(L.payload)}finally{I({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(vH,{permissionSearch:t,setPermissionSearch:e,openPermissionModal:n||C,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:y,setConfirmDelete:I}),c.jsx(kH,{open:m.open,onClose:()=>{b({open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""}),P("")},permissionModal:m,permissionModuleOptions:u,permissionServiceOptions:O,permissionActionOptions:$,updatePermissionModalField:S,permissionModalError:k,savePermissionModal:j,savingPermission:_}),c.jsx(gc,{open:L.open,message:L.label,onClose:()=>I({open:!1,type:"",payload:null,label:""}),onConfirm:D})]})}const Fh={open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""};function wH({mergedPermissionDescriptions:t,updateLocalPermissionDescription:e}){const n=Ks(),[s,r]=v.useState(Fh),[i,o]=v.useState(""),[a,l]=v.useState(!1);function u(p="add",w=""){const y=ry(w),x=w&&t[w]||"";o(""),r({open:!0,mode:p,value:w,original:w,module:y.module,service:y.service,action:y.action,description:x,originalDescription:x})}function d(p,w){r(y=>{const x={...y,[p]:w};return{...x,value:Yw(x)}}),o("")}async function h(){var w;const p=Yw(s);if(!p){o("Select module, service, and permission.");return}l(!0);try{const y=((w=s.description)==null?void 0:w.trim())||"";if(s.mode==="add")await gg(p,y),e(p,y);else if(p!==s.original)await gg(p,y),await Gk(s.original),e(s.original,""),e(p,y);else if(y!==s.originalDescription)await gg(p,y),e(p,y);else{r({...Fh});return}n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Fh})}catch{}finally{l(!1)}}async function f(p){const w=p||s.original||s.value;if(w){l(!0);try{await Gk(w),e(w,""),n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Fh})}catch{}finally{l(!1)}}}return{permissionModal:s,setPermissionModal:r,permissionModalError:i,savingPermission:a,openPermissionModal:u,updatePermissionModalField:d,savePermissionModal:h,deletePermissionFromModal:f,setPermissionModalError:o}}function kH({open:t,onClose:e,permissionModal:n,permissionModuleOptions:s,permissionServiceOptions:r,permissionActionOptions:i,updatePermissionModalField:o,permissionModalError:a,savePermissionModal:l,savingPermission:u}){return c.jsx(Cs,{open:t,onClose:e,title:n.mode==="edit"?"Edit permission":"Add permission",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ee,{label:"Permission",children:c.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr_auto_1fr] items-center gap-2",children:[c.jsxs("div",{children:[c.jsx("input",{list:"permission-module-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.module,onChange:d=>o("module",d.target.value),placeholder:"module"}),c.jsx("datalist",{id:"permission-module-options",children:s.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-service-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.service,onChange:d=>o("service",d.target.value),placeholder:"service"}),c.jsx("datalist",{id:"permission-service-options",children:r.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-action-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.action,onChange:d=>o("action",d.target.value),placeholder:"permission"}),c.jsx("datalist",{id:"permission-action-options",children:i.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]})]})}),c.jsx(Ee,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.description,onChange:d=>o("description",d.target.value),placeholder:"Short description"})}),a?c.jsx("div",{className:"text-xs text-red-600 dark:text-red-300",children:a}):null,c.jsx("div",{className:"flex justify-end",children:c.jsx(se,{className:"rounded-2xl",onClick:l,disabled:u,children:u?c.jsx(Ve,{text:"Saving"}):n.mode==="edit"?"Update Permission":"Add Permission"})})]})})}const _H=[{key:"chat",label:"AI Chat",description:"Chat assistant for general queries"},{key:"video_critique",label:"Video Critique",description:"AI-powered video analysis tool"},{key:"proposals",label:"Proposals",description:"Proposal generation and management"},{key:"asset_management",label:"Asset Management",description:"Digital asset management system"}],SH=[{key:"mockup_setup",label:"Mockup Setup",description:"Configure and upload mockup templates"},{key:"mockup_generate",label:"Mockup Generate",description:"Generate mockups from templates"}];function jH({isInitializing:t,isDevMode:e,serviceVisibility:n,isUpdating:s,onToggleService:r}){return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Gt,{className:"pb-2",children:[c.jsx(Yt,{className:"text-lg",children:"Service Visibility"}),c.jsx("p",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle which services are visible to users in the sidebar. Admin and Settings are always visible."})]}),c.jsx(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-6",children:t?c.jsxs("div",{className:"space-y-6 animate-pulse",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"h-4 w-28 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"grid gap-3",children:[1,2,3,4].map(i=>c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"h-4 w-24 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"h-3 w-40 bg-black/5 dark:bg-white/5 rounded"})]}),c.jsx("div",{className:"h-6 w-11 bg-black/10 dark:bg-white/10 rounded-full"})]},i))})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"h-4 w-28 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"grid gap-3",children:[1,2].map(i=>c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"h-4 w-24 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"h-3 w-40 bg-black/5 dark:bg-white/5 rounded"})]}),c.jsx("div",{className:"h-6 w-11 bg-black/10 dark:bg-white/10 rounded-full"})]},i))})]})]}):c.jsxs(c.Fragment,{children:[e&&c.jsxs("div",{className:"rounded-xl bg-amber-500/10 border border-amber-500/30 p-3 mb-4",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-amber-600 dark:text-amber-400 font-medium text-sm",children:"Dev Mode Active"})}),c.jsxs("p",{className:"text-xs text-amber-600/80 dark:text-amber-400/80 mt-1",children:["All services are forced visible. Running with"," ",c.jsx("code",{className:"bg-amber-500/20 px-1 rounded",children:"--dev-all-services"})," flag. Toggles are disabled in this mode."]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-sm font-medium text-black/70 dark:text-white/75",children:"General Services"}),c.jsx("div",{className:"grid gap-3",children:_H.map(i=>c.jsx(E_,{label:i.label,description:i.description,enabled:n[i.key]===!0,onChange:()=>r(i.key,n[i.key]),disabled:e||s},i.key))})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-sm font-medium text-black/70 dark:text-white/75",children:"Mockup Services"}),c.jsx("p",{className:"text-xs text-black/50 dark:text-white/50",children:"If both are disabled, the Mockup service will be hidden entirely."}),c.jsx("div",{className:"grid gap-3",children:SH.map(i=>c.jsx(E_,{label:i.label,description:i.description,enabled:n[i.key]===!0,onChange:()=>r(i.key,n[i.key]),disabled:e||s},i.key))})]}),c.jsx("div",{className:"pt-4 border-t border-black/10 dark:border-white/10",children:c.jsxs("p",{className:"text-xs text-black/50 dark:text-white/50",children:[c.jsx("strong",{children:"Always visible:"})," Admin (for admins only), Settings"]})})]})})]})}function E_({label:t,description:e,enabled:n,onChange:s,disabled:r}){return c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"flex-1 min-w-0 sm:mr-4",children:[c.jsx("div",{className:"text-sm font-medium",children:t}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/50 break-words sm:truncate",children:e})]}),c.jsx("button",{type:"button",role:"switch","aria-checked":n,disabled:r,onClick:s,className:["relative inline-flex h-6 w-11 shrink-0 cursor-pointer rounded-full border-2 border-transparent self-start sm:self-auto","transition-all duration-200 ease-in-out focus:outline-none focus-visible:ring-2 focus-visible:ring-black/20",n?"bg-green-500":"bg-black/20 dark:bg-white/20",r?"opacity-50 cursor-not-allowed":""].join(" "),children:c.jsx("span",{className:["pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow-lg ring-0","transition-transform duration-200 ease-in-out",n?"translate-x-5":"translate-x-0"].join(" ")})})]})}const Eg=20;function CH(){const{user:t}=fi(),[e,n]=v.useState("users"),[s,r]=v.useState(""),[i,o]=v.useState(0),[a,l]=v.useState(""),[u,d]=v.useState(""),[h,f]=v.useState(""),[p,w]=v.useState(""),[y,x]=v.useState(""),[g,m]=v.useState(""),[b,k]=v.useState(""),[_,C]=v.useState(""),[S,j]=v.useState("");if(!Rd(t))return c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Restricted"})}),c.jsx(Qt,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to the admin panel."})]});const N=Kt({queryKey:["admin","users",i],queryFn:()=>_B({limit:Eg,offset:i*Eg})}),P=Kt({queryKey:["admin","profiles"],queryFn:PB}),L=Kt({queryKey:["admin","permissions"],queryFn:MB}),I=Kt({queryKey:["admin","companies"],queryFn:IB}),O=Kt({queryKey:["admin","permission-sets"],queryFn:FB}),$=Ks(),D={chat:!0,video_critique:!0,mockup_setup:!0,mockup_generate:!0,proposals:!0,asset_management:!0},F=Kt({queryKey:["service-visibility"],queryFn:k0,placeholderData:D,keepPreviousData:!0}),q=F.data||D,E=F.isLoading&&!F.isFetched,R=q._dev_mode===!0,V=KC({mutationFn:HB,onMutate:async ae=>{await $.cancelQueries({queryKey:["service-visibility"]});const te=$.getQueryData(["service-visibility"]);return $.setQueryData(["service-visibility"],ae),{previousVisibility:te}},onError:(ae,te,ne)=>{$.setQueryData(["service-visibility"],ne==null?void 0:ne.previousVisibility)},onSettled:()=>{$.invalidateQueries({queryKey:["service-visibility"]})}}),K=v.useCallback((ae,te)=>{const ne={...q,[ae]:!te};V.mutate(ne)},[q,V]),Q=v.useMemo(()=>{var ne;const ae=((ne=N.data)==null?void 0:ne.users)||N.data||[],te=s.trim().toLowerCase();return ae.filter(je=>{var Kn,Ys,Ur,xr,lt;const Xt=Array.isArray(je.profiles)?je.profiles.map(ct=>(ct==null?void 0:ct.display_name)||(ct==null?void 0:ct.name)||ct).filter(Boolean).join(" "):((Kn=je.profiles)==null?void 0:Kn.display_name)||((Ys=je.profiles)==null?void 0:Ys.name)||je.profile||je.profile_name||"",Gs=`${je.email||""} ${je.name||""} ${Xt}`.toLowerCase();if(te&&!Gs.includes(te))return!1;const Mn=((Ur=je.company)==null?void 0:Ur.code)||je.company_code||je.company_id||"";return!(y&&Mn!==y||g&&!(Array.isArray(je.profiles)?je.profiles.map(ft=>(ft==null?void 0:ft.name)||(ft==null?void 0:ft.display_name)||ft).filter(Boolean):[((xr=je.profiles)==null?void 0:xr.name)||((lt=je.profiles)==null?void 0:lt.display_name)||je.profile||je.profile_name].filter(Boolean)).includes(g))})},[N.data,s,y,g]);v.useMemo(()=>{var te;return(((te=N.data)==null?void 0:te.users)||N.data||[]).length===Eg},[N.data]),v.useEffect(()=>{C(""),j("")},[b]),v.useEffect(()=>{j("")},[_]);const re=v.useMemo(()=>{var te;const ae=((te=P.data)==null?void 0:te.profiles)??P.data;return Array.isArray(ae)?ae:[]},[P.data]),ee=v.useMemo(()=>{var xr;const ae=((xr=L.data)==null?void 0:xr.permissions)??L.data,te=new Map,ne={},je=(lt,ct,ft)=>{if(!lt||!ct||!ft)return;te.has(lt)||te.set(lt,new Map);const dn=te.get(lt);dn.has(ct)||dn.set(ct,new Set),dn.get(ct).add(ft)};Array.isArray(ae)?ae.forEach(lt=>{const ct=typeof lt=="string"?lt:lt==null?void 0:lt.name,ft=typeof lt=="string"?"":(lt==null?void 0:lt.description)||"";if(ct&&ft&&(ne[ct]=ft),!ct)return;const dn=ct.split(":");dn.length>=3&&je(dn[0],dn[1],dn[2])}):ae&&typeof ae=="object"&&Object.entries(ae).forEach(([lt,ct])=>{!ct||typeof ct!="object"||Object.entries(ct).forEach(([ft,dn])=>{Array.isArray(dn)&&dn.forEach(vi=>je(lt,ft,vi))})});const Xt=Array.from(te.keys()).sort(),Gs={},Mn={},Kn=[],Ys=new Set,Ur=new Set;return Xt.forEach(lt=>{const ct=Array.from(te.get(lt).keys()).sort();Gs[lt]=ct,ct.forEach(ft=>{Ys.add(ft);const dn=Array.from(te.get(lt).get(ft)).sort();Mn[`${lt}:${ft}`]=dn,dn.forEach(vi=>{Ur.add(vi),Kn.push(`${lt}:${ft}:${vi}`)})})}),{modules:Xt,servicesByModule:Gs,actionsByService:Mn,flat:Kn,allServices:Array.from(Ys).sort(),allActions:Array.from(Ur).sort(),descriptions:ne}},[L.data]),z=v.useMemo(()=>ee.flat,[ee]),A=ee.descriptions||{},[Y,B]=v.useState({}),J=v.useMemo(()=>({...A||{},...Y}),[A,Y]),be=v.useCallback((ae,te)=>{if(!ae)return;const ne=(te==null?void 0:te.trim())||"";B(je=>{const Xt={...je};return ne?Xt[ae]=ne:delete Xt[ae],Xt})},[]),pe=ee.modules,H=b?ee.servicesByModule[b]||[]:ee.allServices,ye=b&&_?ee.actionsByService[`${b}:${_}`]||[]:ee.allActions,X=v.useMemo(()=>{var te;const ae=((te=I.data)==null?void 0:te.companies)??I.data;return Array.isArray(ae)?ae:[]},[I.data]),ue=v.useMemo(()=>{var te,ne;const ae=((te=O.data)==null?void 0:te.permission_sets)??((ne=O.data)==null?void 0:ne.permissionSets)??O.data;return Array.isArray(ae)?ae.map(je=>typeof je=="string"?{name:je}:je):[]},[O.data]),ce=v.useMemo(()=>{const ae=u.trim().toLowerCase();return ae?X.filter(te=>`${te.name||""} ${te.code||""} ${te.country||""} ${te.currency||""} ${te.timezone||""}`.toLowerCase().includes(ae)):X},[X,u]),de=v.useMemo(()=>{const ae=a.trim().toLowerCase();return ae?re.filter(te=>`${te.display_name||""} ${te.name||""} ${te.description||""}`.toLowerCase().includes(ae)):re},[re,a]),ie=v.useMemo(()=>{const ae=h.trim().toLowerCase();return ae?ue.filter(te=>`${te.display_name||""} ${te.name||""} ${te.description||""}`.toLowerCase().includes(ae)):ue},[ue,h]),Se=v.useMemo(()=>{const ae=p.trim().toLowerCase();let te=z;return(b||_||S)&&(te=te.filter(ne=>{const je=ry(ne);return!(b&&je.module!==b||_&&je.service!==_||S&&je.action!==S)})),ae?te.filter(ne=>{const je=J[ne]||"";return`${ne} ${je}`.toLowerCase().includes(ae)}):te},[z,p,J,b,_,S]),oe=v.useMemo(()=>X.map(ae=>({value:ae.code||ae.id||"",label:ae.name||ae.code||ae.id||""})).filter(ae=>ae.value),[X]),W=v.useMemo(()=>re.map(ae=>({value:ae.name||ae.display_name||"",label:ae.display_name||ae.name||""})).filter(ae=>ae.value),[re]),ke=v.useMemo(()=>ue.map(ae=>ae.name||ae.id).filter(Boolean),[ue]),Re=v.useMemo(()=>re.map(ae=>ae.name||ae.id).filter(Boolean),[re]),Oe=v.useMemo(()=>{const ae=new Map;return X.forEach(te=>{const ne=te.code||te.id;ne&&ae.set(ne,te.name||te.code||ne)}),ae},[X]);return c.jsxs("div",{className:"flex h-full min-h-0 flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto py-1",children:[c.jsx(se,{variant:e==="users"?"default":"ghost",onClick:()=>n("users"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="users"?"mmg-tab-btn-active":""}`,children:"Users"}),c.jsx(se,{variant:e==="companies"?"default":"ghost",onClick:()=>n("companies"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="companies"?"mmg-tab-btn-active":""}`,children:"Companies"}),c.jsx(se,{variant:e==="profiles"?"default":"ghost",onClick:()=>n("profiles"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="profiles"?"mmg-tab-btn-active":""}`,children:"Profiles"}),c.jsx(se,{variant:e==="permission-sets"?"default":"ghost",onClick:()=>n("permission-sets"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="permission-sets"?"mmg-tab-btn-active":""}`,children:"Permission Sets"}),c.jsx(se,{variant:e==="permissions"?"default":"ghost",onClick:()=>n("permissions"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="permissions"?"mmg-tab-btn-active":""}`,children:"Permissions"}),c.jsx(se,{variant:e==="services"?"default":"ghost",onClick:()=>n("services"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="services"?"mmg-tab-btn-active":""}`,children:"Services"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:e==="users"?"h-full":"hidden","aria-hidden":e!=="users",children:c.jsx(rH,{q:s,setQ:r,usersQuery:N,users:Q,user:t,companyLookup:Oe,userCompanyFilter:y,setUserCompanyFilter:x,userProfileFilter:g,setUserProfileFilter:m,companyFilterOptions:oe,profileFilterOptions:W,companyList:X,profileOptions:re,profileValues:Re,permissionSetList:ue,permissionSetValues:ke,permissionList:z,permissionsQuery:L,page:i})}),c.jsx("div",{className:e==="companies"?"h-full":"hidden","aria-hidden":e!=="companies",children:c.jsx(lH,{companySearch:u,setCompanySearch:d,companiesQuery:I,filteredCompanyList:ce,companyLookup:Oe,companyList:X})}),c.jsx("div",{className:e==="profiles"?"h-full":"hidden","aria-hidden":e!=="profiles",children:c.jsx(hH,{profileSearch:a,setProfileSearch:l,filteredProfileOptions:de,permissionList:z,permissionSetValues:ke,permissionSetList:ue,permissionSetsQuery:O,permissionsQuery:L})}),c.jsx("div",{className:e==="permission-sets"?"h-full":"hidden","aria-hidden":e!=="permission-sets",children:c.jsx(gH,{permissionSetSearch:h,setPermissionSetSearch:f,permissionSetsQuery:O,filteredPermissionSetList:ie,permissionList:z,permissionsQuery:L})}),c.jsx("div",{className:e==="permissions"?"h-full":"hidden","aria-hidden":e!=="permissions",children:c.jsx(bH,{permissionSearch:p,setPermissionSearch:w,permissionModuleFilter:b,setPermissionModuleFilter:k,permissionServiceFilter:_,setPermissionServiceFilter:C,permissionActionFilter:S,setPermissionActionFilter:j,permissionModuleOptions:pe,permissionFilterServiceOptions:H,permissionFilterActionOptions:ye,permissionsQuery:L,filteredPermissionList:Se,parsePermissionParts:ry,mergedPermissionDescriptions:J,permissionTree:ee,updateLocalPermissionDescription:be})}),c.jsx("div",{className:e==="services"?"h-full min-h-0":"hidden","aria-hidden":e!=="services",children:c.jsx(jH,{isInitializing:E,isDevMode:R,serviceVisibility:q,isUpdating:V.isPending,onToggleService:K})})]})]})}function NH({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function EH(){const{notifications:t,loading:e,clearAll:n,dismissNotification:s,markRead:r,formatTime:i}=w0(),[o,a]=v.useState(null),l=v.useMemo(()=>t,[t]);return c.jsxs("div",{className:"h-full min-h-0",children:[c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsxs(Gt,{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx(Yt,{children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:l.length?`${l.length} total`:"No alerts yet"})]}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:n,disabled:!l.length,children:"Clear all"})]}),c.jsx(Qt,{className:"flex-1 min-h-0 overflow-y-auto pt-2",children:e?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"space-y-2",children:l.map(u=>c.jsx(zt,{className:"p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-base font-semibold text-black/85 dark:text-white/85 truncate",children:u.title||"Notification"}),u.message?c.jsx("div",{className:"mt-1 text-sm text-black/60 dark:text-white/65 leading-5 mmg-line-clamp-2",children:u.message}):null,u.created_at?c.jsx("div",{className:"mt-1 text-xs text-black/45 dark:text-white/45",children:i(u.created_at)}):null]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{variant:"ghost",className:"h-8 w-8",onClick:()=>{r(u.id),a(u)},"aria-label":"View notification",children:c.jsx(QC,{size:14})}),c.jsx(An,{variant:"ghost",className:"h-8 w-8",onClick:()=>s(u.id),"aria-label":"Close notification",children:c.jsx(Xv,{size:14})})]})]})},u.id))}):c.jsx(zt,{className:"p-6 text-center text-sm text-black/60 dark:text-white/65",children:"You're all caught up."})})]}),c.jsx(Cs,{open:!!o,onClose:()=>a(null),title:(o==null?void 0:o.title)||"Notification",maxWidth:"520px",children:c.jsx(NH,{notification:o})})]})}function TH(){const[t,e]=v.useState(null),[n,s]=v.useState([]),[r,i]=v.useState(""),[o,a]=v.useState(null),[l,u]=v.useState(null),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,y]=v.useState(!1),[x,g]=v.useState(null),[m,b]=v.useState({}),[k,_]=v.useState(null),[C,S]=v.useState(!1),[j,N]=v.useState(!1),P=v.useRef(null),L=v.useRef(null),I=v.useRef(null),O=v.useRef(null),$=v.useRef(!0),D=Kt({queryKey:["video-critique","history"],queryFn:y4,enabled:!0}),F=v.useMemo(()=>(r.trim().length>0||!!o)&&!d,[r,o,d]);v.useEffect(()=>{var A;if(f||D.isLoading)return;const z=D.data;if(z&&((A=z.messages)!=null&&A.length||z.session_id||z.conversation_id)){e(z.session_id||z.conversation_id||null);const Y=(z.messages||[]).map(IH);s(Y.length?Y:[P_()])}else s([P_()]);p(!0)},[D.data,D.isLoading,f]),v.useEffect(()=>{const z=L.current;if(!z)return;const A=()=>{const B=z.scrollHeight-z.scrollTop-z.clientHeight<=120;$.current=B};return A(),z.addEventListener("scroll",A,{passive:!0}),()=>z.removeEventListener("scroll",A)},[]);const q=ve.useCallback((z="smooth",A=!1)=>{var Y;!A&&!$.current||(Y=I.current)==null||Y.scrollIntoView({behavior:z,block:"end"})},[]);v.useEffect(()=>{const z=d?"auto":"smooth";requestAnimationFrame(()=>q(z))},[n,d,q]),v.useEffect(()=>{f&&requestAnimationFrame(()=>q("auto",!0))},[f,q]),v.useEffect(()=>()=>{var z,A;return(A=(z=O.current)==null?void 0:z.abort)==null?void 0:A.call(z)},[]);const E=v.useMemo(()=>{var z;return(z=x==null?void 0:x.fields)!=null&&z.length?x.fields.every(A=>{if(!A.required)return!0;const Y=m==null?void 0:m[A.id];return Y!=null&&String(Y).trim()!==""}):!1},[x,m]);function R(){y(!1),g(null),b({}),_(null),S(!1),N(!1)}async function V({formType:z,workflowId:A}){y(!0),S(!0),_({formType:z,workflowId:A}),g(null),b({});try{const Y=await S4(z);g(Y);const B={};((Y==null?void 0:Y.fields)||[]).forEach(J=>{B[J.id]=J.default_value||""}),b(B)}catch(Y){g({title:"Action",submit_text:"Submit",fields:[],error:(Y==null?void 0:Y.message)||"Failed to load form."})}finally{S(!1)}}function K(z,A={}){s(Y=>[...Y,{id:crypto.randomUUID(),role:"assistant",content:z,files:[],status:null,...A}])}async function Q(z){if(!z||z.url)return;const A=z.action_id||z.id,Y=z.workflow_id||z.workflowId;if(!A||!Y){K("Missing action details. Please try again.");return}try{N(!0);const B=await k4({actionId:A,workflowId:Y});if(B!=null&&B.requires_form){N(!1),await V({formType:B.form_type||z.form_type,workflowId:B.workflow_id||Y});return}K((B==null?void 0:B.message)||"Action completed.")}catch(B){K((B==null?void 0:B.message)||"Unable to complete that action.")}finally{N(!1)}}async function re(){if(!(!(k!=null&&k.formType)||!(k!=null&&k.workflowId))&&E){N(!0);try{const z=await _4({formType:k.formType,workflowId:k.workflowId,category:m.category,reason:m.reason});R(),K((z==null?void 0:z.message)||"Form submitted.")}catch(z){K((z==null?void 0:z.message)||"Unable to submit the form."),N(!1)}}}async function ee(){var X,ue;if(!F)return;const z=r.trim(),A=o,Y=!!l&&!A,B=z||(A?`Please review this file: ${A.name}`:"");A&&l&&u(null);const J=crypto.randomUUID(),be=A?[{file_id:`local-${Date.now()}`,filename:A.name,preview_url:URL.createObjectURL(A)}]:[],pe={id:J,role:"user",content:z,files:be,status:null},H=crypto.randomUUID(),ye={id:H,role:"assistant",content:"",files:[],status:Y?null:"Reviewing..."};s(ce=>[...ce,pe,ye]),i(""),a(null),$.current=!0,requestAnimationFrame(()=>q("auto",!0));try{let ce=[];if(Y){const W=T_(z);if(!W){s(Re=>Re.map(Oe=>Oe.id===H?{...Oe,status:null,content:"Please provide a task number to upload this video."}:Oe));return}h(!0);const ke=await Qk({file:l,taskNumber:W});s(Re=>Re.map(Oe=>Oe.id===H?{...Oe,status:null,content:(ke==null?void 0:ke.message)||"Video uploaded."}:Oe)),u(null);return}if(A&&OH(A)){const W=T_(z);if(W){h(!0);const ke=await Qk({file:A,taskNumber:W});s(Re=>Re.map(Oe=>Oe.id===H?{...Oe,status:null,content:(ke==null?void 0:ke.message)||"Video uploaded."}:Oe));return}u(A),s(ke=>ke.map(Re=>Re.id===H?{...Re,status:null,content:"Video received. Which task number is this for?"}:Re));return}if(A&&MH(A)){h(!0);const W=await v4({file:A,message:z||void 0,sessionId:t});if(W!=null&&W.session_id&&e(ke=>ke||W.session_id),W!=null&&W.file_id){const ke={file_id:W.file_id,filename:A.name,file_url:W.file_url||W.url||""};s(Re=>Re.map(Oe=>{var ae,te,ne,je;return Oe.id===J?{...Oe,files:[{...ke,preview_url:((te=(ae=Oe.files)==null?void 0:ae[0])==null?void 0:te.preview_url)||((je=(ne=Oe.files)==null?void 0:ne[0])==null?void 0:je.url)||""}]}:Oe}))}s(ke=>ke.map(Re=>Re.id===H?{...Re,status:null,content:(W==null?void 0:W.response)||(W==null?void 0:W.message)||"File received."}:Re));return}if(A){h(!0);const W=await b4({file:A});if(!(W!=null&&W.file_id))throw new Error("Upload failed");ce=[W.file_id];const ke={file_id:W.file_id,filename:A.name,file_url:W.file_url||W.url||""};s(Re=>Re.map(Oe=>{var ae,te,ne,je;return Oe.id===J?{...Oe,files:[{...ke,preview_url:((te=(ae=Oe.files)==null?void 0:ae[0])==null?void 0:te.preview_url)||((je=(ne=Oe.files)==null?void 0:ne[0])==null?void 0:je.url)||""}]}:Oe}))}if(!A&&z.startsWith("/")){h(!0);const ke=z.replace(/^\/+/,"").split(/\\s+/),Re=ke.shift()||"",Oe=ke.join(" "),ae=await w4({command:Re,args:Oe,sessionId:t});ae!=null&&ae.session_id&&e(te=>te||ae.session_id),s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:(ae==null?void 0:ae.response)||(ae==null?void 0:ae.error)||"Command failed."}:ne));return}h(!0),(ue=(X=O.current)==null?void 0:X.abort)==null||ue.call(X);const de=new AbortController;O.current=de;let ie="",Se=null,oe=!1;await C4({sessionId:t,message:B,fileIds:ce,signal:de.signal,onEvent:W=>{var Oe,ae;if((W!=null&&W.session_id||W!=null&&W.conversation_id)&&e(te=>te||W.session_id||W.conversation_id),(W==null?void 0:W.type)==="error"||W!=null&&W.error){const te=(W==null?void 0:W.message)||(W==null?void 0:W.error)||"Stream error";s(ne=>ne.map(je=>je.id===H?{...je,status:null,content:`Error: ${te}`}:je));return}if((W==null?void 0:W.type)==="status"){s(te=>te.map(ne=>ne.id===H?{...ne,status:W.content||"Processing..."}:ne)),W.message_id&&(Se=W.message_id);return}if((W==null?void 0:W.type)==="delete"){W.message_id&&W.message_id===Se&&(ie="",Se=null,s(te=>te.map(ne=>ne.id===H?{...ne,status:"Reviewing...",content:""}:ne)));return}if((W==null?void 0:W.type)==="tool_call"){const te=W.name||((Oe=W.tool)==null?void 0:Oe.name)||"processing";s(ne=>ne.map(je=>je.id===H?{...je,status:`Processing ${te}...`}:je));return}const ke=((ae=W==null?void 0:W.result)==null?void 0:ae.pdf_filename)||(W==null?void 0:W.pdf_filename),Re=te=>!te||!ke||te.pdf_filename?te:{...te,pdf_filename:ke};if(ke&&s(te=>te.map(ne=>ne.id===H&&!ne.pdf_filename?{...ne,pdf_filename:ke}:ne)),(W==null?void 0:W.type)==="delta"&&W.content){ie+=W.content,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:ie}:ne));return}if((W==null?void 0:W.type)==="text_done"){ie=W.content||ie,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:ie}:ne));return}if(((W==null?void 0:W.type)==="chunk"||(W==null?void 0:W.type)==="content")&&W.content){W.message_id&&W.message_id!==Se&&(Se=W.message_id),ie=W.type==="content"?W.content:ie+W.content,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:ie}:ne));return}if(W!=null&&W.content&&!W.type){ie+=W.content,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:ie}:ne));return}if((W==null?void 0:W.type)==="actions"&&W.actions){s(te=>te.map(ne=>ne.id===H?{...ne,actions:W.actions}:ne));return}if(W!=null&&W.actions){s(te=>te.map(ne=>ne.id===H?{...ne,actions:W.actions}:ne));return}if((W==null?void 0:W.type)==="files"&&W.files){if(oe=!0,s(te=>te.map(ne=>ne.id===H?{...ne,files:[...ne.files||[],...W.files.map(Re)]}:ne)),!ie){const te=W.files.find(ne=>ne.comment);te!=null&&te.comment&&(ie=te.comment,s(ne=>ne.map(je=>je.id===H?{...je,status:null,content:ie}:je)))}return}if((W==null?void 0:W.type)==="file"&&(W.file||W.url)){const te=Re(W.file||W);oe=!0,s(ne=>ne.map(je=>je.id===H?{...je,files:[...je.files||[],te]}:je)),!ie&&te.comment&&(ie=te.comment,s(ne=>ne.map(je=>je.id===H?{...je,status:null,content:ie}:je)));return}if(W!=null&&W.files){oe=!0,s(te=>te.map(ne=>ne.id===H?{...ne,files:[...ne.files||[],...W.files.map(Re)]}:ne));return}typeof W=="string"&&W.trim()&&(ie+=W,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:ie}:ne)))},onDone:()=>{!ie&&!oe&&s(W=>W.map(ke=>ke.id===H?{...ke,status:null,content:"Ready for the next request when you are."}:ke))}})}catch(ce){s(de=>de.map(ie=>ie.id===H?{...ie,status:null,content:(ce==null?void 0:ce.message)||"Failed to get response"}:ie))}finally{h(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(St,{className:"p-4 overflow-hidden flex-1 min-h-0",children:c.jsx("div",{ref:L,className:"h-full overflow-y-auto px-2",children:c.jsxs("div",{className:"space-y-3",children:[!f&&D.isLoading?c.jsx(Ve,{text:"Loading conversation",className:"text-sm text-black/60 dark:text-white/65"}):null,n.map(z=>c.jsx(PH,{msg:z,onMediaLoad:()=>q("auto"),onAction:Q,actionsDisabled:j},z.id)),c.jsx("div",{ref:I})]})})}),c.jsxs(St,{className:"p-3",children:[l&&!o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsxs("div",{className:"truncate",children:["Awaiting task number for ",l.name]}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>u(null),children:"x"})]}):null,o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:o.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>a(null),children:"x"})]}):null,c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:P,type:"file",className:"hidden",onChange:z=>{var A;return a(((A=z.target.files)==null?void 0:A[0])||null)},accept:"video/*,image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var z;return(z=P.current)==null?void 0:z.click()},children:c.jsx(XC,{size:18})}),c.jsx(RH,{value:r,onChange:i,placeholder:"Describe the video request...",onEnter:ee}),c.jsx(se,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!F,onClick:ee,children:c.jsx(JC,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"Share a brief, a link, or upload a cut for review."})]}),c.jsx(Cs,{open:w,onClose:R,title:(x==null?void 0:x.title)||"Action",maxWidth:"520px",children:C?c.jsx(Ve,{text:"Loading form",className:"text-sm text-black/60 dark:text-white/65"}):x!=null&&x.error?c.jsx("div",{className:"text-sm text-red-600 dark:text-red-300",children:x.error}):c.jsxs("div",{className:"space-y-3",children:[((x==null?void 0:x.fields)||[]).map(z=>{if(z.type==="select"){const A=[{value:"",label:z.placeholder||"Select..."},...z.options||[]];return c.jsx(Ee,{label:z.label,children:c.jsx(ot,{value:m[z.id]||"",options:A,onChange:Y=>b(B=>({...B,[z.id]:Y}))})},z.id)}return z.type==="textarea"?c.jsx(Ee,{label:z.label,children:c.jsx("textarea",{rows:3,placeholder:z.placeholder||"",className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[z.id]||"",onChange:A=>b(Y=>({...Y,[z.id]:A.target.value}))})},z.id):c.jsx(Ee,{label:z.label,children:c.jsx("input",{type:"text",placeholder:z.placeholder||"",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[z.id]||"",onChange:A=>b(Y=>({...Y,[z.id]:A.target.value}))})},z.id)}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:R,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:re,disabled:!E||j||C,children:(x==null?void 0:x.submit_text)||"Submit"})]})]})})]})}function PH({msg:t,onMediaLoad:e,onAction:n,actionsDisabled:s}){var h;const r=t.role==="user",i=v.useMemo(()=>BH(t.content||""),[t.content]),o=v.useMemo(()=>My(t.status||""),[t.status]),a=v.useMemo(()=>!t.status&&DH(t.content||""),[t.status,t.content]),l=v.useMemo(()=>My(t.content||""),[t.content]),u=v.useRef(new Map),d=t.actions||t.buttons||[];return c.jsx("div",{className:r?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",r?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[t.status||a?c.jsx(AH,{text:o||l}):c.jsx("div",{dangerouslySetInnerHTML:{__html:i}}),(h=t.files)!=null&&h.length?c.jsx("div",{className:"mt-2 space-y-1",children:t.files.map((f,p)=>{const w=j4(f);if(!w)return null;const y=f.pdf_filename||t.pdf_filename,x=FH(y?{...f,pdf_filename:y}:f,w,u.current),g=Zc(x),m=["jpg","jpeg","png","gif","webp","bmp"].includes(g),b=!r,k=g==="pdf";return m?c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:b?c.jsxs(c.Fragment,{children:[c.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"block overflow-hidden rounded-lg",children:c.jsx("img",{src:w,alt:x,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),zh(w,x)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),zh(w,x))},className:"inline-flex items-center",children:[c.jsx(wa,{size:14,className:"mr-1"}),"Download"]})})]})]}):c.jsx("div",{className:"overflow-hidden rounded-lg",children:c.jsx("img",{src:w,alt:x,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})})},f.file_id||w||p):c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:k?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Qv,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:g?g.toUpperCase():"FILE"})}),b?c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:x}):null]}),b?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),zh(w,x)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),zh(w,x))},className:"inline-flex items-center",children:[c.jsx(wa,{size:14,className:"mr-1"}),"Download"]})})]}):null]})},f.file_id||w||p)})}):null,d.length?c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.map((f,p)=>{const w=f.action_id||f.id||`${f.label}-${p}`,y=f.variant||"secondary";return f.url?c.jsx(se,{asChild:!0,size:"sm",variant:y,className:"rounded-xl",disabled:s,children:c.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",children:f.label||"Open"})},w):c.jsx(se,{size:"sm",variant:y,className:"rounded-xl",onClick:()=>n==null?void 0:n(f),disabled:s,children:f.label||"Action"},w)})}):null]})})}function RH({value:t,onChange:e,placeholder:n,onEnter:s,disabled:r}){const i=v.useRef(null);v.useEffect(()=>{const a=i.current;if(!a)return;a.style.height="0px";const u=22*5+16;a.style.height=Math.min(a.scrollHeight,u)+"px"},[t]);function o(a){a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),s==null||s())}return c.jsx("textarea",{ref:i,rows:1,value:t,disabled:r,onChange:a=>e(a.target.value),onKeyDown:o,placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function AH({text:t}){return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:t||"Reviewing"}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function T_(t){if(!t)return null;const e=String(t).match(/\b(\d{1,6})\b/);return e?Number(e[1]):null}function OH(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function MH(t){if(!t)return!1;if(t.type&&t.type.startsWith("image/"))return!0;const e=t.name||"";return/\.(png|jpe?g|gif|webp|bmp)$/i.test(e)}function IH(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||t.sender||"assistant",content:t.content||t.message||"",files:t.files||t.attachments||[],actions:t.actions||t.buttons||[],pdf_filename:t.pdf_filename||t.pdfFilename,status:null}}function My(t){return t?String(t).replace(/[_*`]/g,"").replace(/\.+$/,"").replace(/\s+/g," ").trim():""}function DH(t){const e=My(t);return e?!!(e==="Reviewing"||e.startsWith("Processing")||e.startsWith("Analyzing")):!1}function Zc(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length<=1?"":n.pop().toLowerCase()}function LH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function $H(t){if(!t)return!0;const e=t.trim().toLowerCase();if(!e||e==="file"||e==="download")return!0;const n=e.replace(/\.[^.]+$/,"");return!!(n==="tmp"||n==="temp"||/^[a-f0-9-]{16,}$/.test(n)||/^file[-_]?\d+$/.test(n)||/^(tmp|temp)/.test(n)||/^upload[-_]?.+$/.test(n))}function FH(t,e,n){const s=(t==null?void 0:t.pdf_filename)||"",r=s||(t==null?void 0:t.filename)||(t==null?void 0:t.title)||"",i=LH(e),o=(t==null?void 0:t.file_id)||(t==null?void 0:t.id)||e||r;let a=r||i||"";const l=Zc(a)||Zc(i)||Zc(e);if(s){const u=Zc(a)||"pdf";return a.toLowerCase().endsWith(`.${u}`)||(a=`${a}.${u}`),o&&n&&n.set(o,a),a}return $H(a)?l==="pdf"?a="Review.pdf":l?a=`Attachment.${l}`:a="Attachment":l&&!a.toLowerCase().endsWith(`.${l}`)&&(a=`${a}.${l}`),o&&n&&n.set(o,a),a||(l?`Attachment.${l}`:"Attachment")}async function zh(t,e){try{const n=fc(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{const n=document.createElement("a");n.href=t,n.download=e,n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),n.remove()}}function P_(){return{id:crypto.randomUUID(),role:"assistant",content:`Good ${zH()}, ready for a video critique?`,files:[],status:null}}function zH(){const t=new Date().getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function Iy(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function $c(t){return t?Iy(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">[Image: $1]</a>').replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/___(.+?)___/g,"<strong><em>$1</em></strong>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(?!INLINE_CODE_|CODE_BLOCK_)(.+?)__/g,"<strong>$1</strong>").replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>").replace(new RegExp("(?<!\\w)_(?!_)(.+?)(?<!_)_(?!\\w)","g"),"<em>$1</em>").replace(/~~(.+?)~~/g,"<del>$1</del>").replace(/==(.+?)==/g,'<mark class="chat-highlight">$1</mark>'):""}function BH(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(d,h,f)=>{const p=e.length;return e.push({lang:h||"",code:f.trim()}),`__CODE_BLOCK_${p}__`});const s=[];n=n.replace(/`([^`]+)`/g,(d,h)=>{const f=s.length;return s.push(h),`__INLINE_CODE_${f}__`});const r=n.split(`
`);let i=[],o=!1,a=!1,l=!1;for(let d=0;d<r.length;d++){let h=r[d];const f=h.match(/^__CODE_BLOCK_(\d+)__$/);if(f){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=e[parseInt(f[1],10)],m=g.lang?` class="language-${g.lang}"`:"";i.push(`<pre class="chat-code-block"><code${m}>${Iy(g.code)}</code></pre>`);continue}const p=h.match(/^(#{1,6})\s+(.*)$/);if(p){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=p[1].length,m=$c(p[2]);i.push(`<h${g} class="chat-header chat-h${g}">${m}</h${g}>`);continue}if(/^[-*_]{3,}\s*$/.test(h)){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1),i.push('<hr class="chat-hr">');continue}const w=h.match(/^>\s*(.*)$/);if(w){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l||(i.push('<blockquote class="chat-blockquote">'),l=!0),i.push($c(w[1])+"<br>");continue}else l&&(i.push("</blockquote>"),l=!1);const y=h.match(/^(\s*)([-*])\s+(.*)$/);if(y){a&&(i.push("</ol>"),a=!1),o||(i.push('<ul class="chat-list">'),o=!0);const g=$c(y[3]);i.push(`<li>${g}</li>`);continue}else o&&(i.push("</ul>"),o=!1);const x=h.match(/^(\s*)(\d+)\.\s+(.*)$/);if(x){o&&(i.push("</ul>"),o=!1),a||(i.push('<ol class="chat-numbered-list">'),a=!0);const g=$c(x[3]);i.push(`<li>${g}</li>`);continue}else a&&(i.push("</ol>"),a=!1);if(h.trim()===""){i.push("<br>");continue}i.push($c(h)),d<r.length-1&&i.push("<br>")}o&&i.push("</ul>"),a&&i.push("</ol>"),l&&i.push("</blockquote>");let u=i.join("");return s.forEach((d,h)=>{u=u.replace(`__INLINE_CODE_${h}__`,`<code class="chat-inline-code">${Iy(d)}</code>`)}),u}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Wd(t){return t+.5|0}const Ki=(t,e,n)=>Math.max(Math.min(t,n),e);function eu(t){return Ki(Wd(t*2.55),0,255)}function ao(t){return Ki(Wd(t*255),0,255)}function Xr(t){return Ki(Wd(t/2.55)/100,0,1)}function R_(t){return Ki(Wd(t*100),0,100)}const As={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Dy=[..."0123456789ABCDEF"],UH=t=>Dy[t&15],HH=t=>Dy[(t&240)>>4]+Dy[t&15],Bh=t=>(t&240)>>4===(t&15),WH=t=>Bh(t.r)&&Bh(t.g)&&Bh(t.b)&&Bh(t.a);function VH(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&As[t[1]]*17,g:255&As[t[2]]*17,b:255&As[t[3]]*17,a:e===5?As[t[4]]*17:255}:(e===7||e===9)&&(n={r:As[t[1]]<<4|As[t[2]],g:As[t[3]]<<4|As[t[4]],b:As[t[5]]<<4|As[t[6]],a:e===9?As[t[7]]<<4|As[t[8]]:255})),n}const qH=(t,e)=>t<255?e(t):"";function KH(t){var e=WH(t)?UH:HH;return t?"#"+e(t.r)+e(t.g)+e(t.b)+qH(t.a,e):void 0}const GH=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function sT(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function YH(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function QH(t,e,n){const s=sT(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function XH(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function $0(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,u,d;return i!==o&&(d=i-o,u=a>.5?d/(2-i-o):d/(i+o),l=XH(n,s,r,d,i),l=l*60+.5),[l|0,u||0,a]}function F0(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(ao)}function z0(t,e,n){return F0(sT,t,e,n)}function JH(t,e,n){return F0(QH,t,e,n)}function ZH(t,e,n){return F0(YH,t,e,n)}function rT(t){return(t%360+360)%360}function e8(t){const e=GH.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?eu(+e[5]):ao(+e[5]));const r=rT(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=JH(r,i,o):e[1]==="hsv"?s=ZH(r,i,o):s=z0(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function t8(t,e){var n=$0(t);n[0]=rT(n[0]+e),n=z0(n),t.r=n[0],t.g=n[1],t.b=n[2]}function n8(t){if(!t)return;const e=$0(t),n=e[0],s=R_(e[1]),r=R_(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Xr(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const A_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},O_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function s8(){const t={},e=Object.keys(O_),n=Object.keys(A_);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,A_[i]);i=parseInt(O_[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Uh;function r8(t){Uh||(Uh=s8(),Uh.transparent=[0,0,0,0]);const e=Uh[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const i8=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function o8(t){const e=i8.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?eu(o):Ki(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?eu(s):Ki(s,0,255)),r=255&(e[4]?eu(r):Ki(r,0,255)),i=255&(e[6]?eu(i):Ki(i,0,255)),{r:s,g:r,b:i,a:n}}}function a8(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Xr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Tg=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Ja=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function l8(t,e,n){const s=Ja(Xr(t.r)),r=Ja(Xr(t.g)),i=Ja(Xr(t.b));return{r:ao(Tg(s+n*(Ja(Xr(e.r))-s))),g:ao(Tg(r+n*(Ja(Xr(e.g))-r))),b:ao(Tg(i+n*(Ja(Xr(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Hh(t,e,n){if(t){let s=$0(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=z0(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function iT(t,e){return t&&Object.assign(e||{},t)}function M_(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=ao(t[3]))):(e=iT(t,{r:0,g:0,b:0,a:1}),e.a=ao(e.a)),e}function c8(t){return t.charAt(0)==="r"?o8(t):e8(t)}class ld{constructor(e){if(e instanceof ld)return e;const n=typeof e;let s;n==="object"?s=M_(e):n==="string"&&(s=VH(e)||r8(e)||c8(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=iT(this._rgb);return e&&(e.a=Xr(e.a)),e}set rgb(e){this._rgb=M_(e)}rgbString(){return this._valid?a8(this._rgb):void 0}hexString(){return this._valid?KH(this._rgb):void 0}hslString(){return this._valid?n8(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,u=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-u,s.r=255&u*s.r+i*r.r+.5,s.g=255&u*s.g+i*r.g+.5,s.b=255&u*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=l8(this._rgb,e._rgb,n)),this}clone(){return new ld(this.rgb)}alpha(e){return this._rgb.a=ao(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Wd(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Hh(this._rgb,2,e),this}darken(e){return Hh(this._rgb,2,-e),this}saturate(e){return Hh(this._rgb,1,e),this}desaturate(e){return Hh(this._rgb,1,-e),this}rotate(e){return t8(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Wr(){}const u8=(()=>{let t=0;return()=>t++})();function wt(t){return t==null}function pn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function rt(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function qs(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function kr(t,e){return qs(t)?t:e}function nt(t,e){return typeof t>"u"?e:t}const d8=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,oT=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Et(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function gt(t,e,n,s){let r,i,o;if(pn(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(rt(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function gp(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function xp(t){if(pn(t))return t.map(xp);if(rt(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=xp(t[n[r]]);return e}return t}function aT(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function h8(t,e,n,s){if(!aT(t))return;const r=e[t],i=n[t];rt(r)&&rt(i)?cd(r,i,s):e[t]=xp(i)}function cd(t,e,n){const s=pn(e)?e:[e],r=s.length;if(!rt(t))return t;n=n||{};const i=n.merger||h8;let o;for(let a=0;a<r;++a){if(o=s[a],!rt(o))continue;const l=Object.keys(o);for(let u=0,d=l.length;u<d;++u)i(l[u],t,o,n)}return t}function xu(t,e){return cd(t,e,{merger:f8})}function f8(t,e,n){if(!aT(t))return;const s=e[t],r=n[t];rt(s)&&rt(r)?xu(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=xp(r))}const I_={"":t=>t,x:t=>t.x,y:t=>t.y};function p8(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function m8(t){const e=p8(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function Sa(t,e){return(I_[e]||(I_[e]=m8(e)))(t)}function B0(t){return t.charAt(0).toUpperCase()+t.slice(1)}const ud=t=>typeof t<"u",xo=t=>typeof t=="function",D_=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function g8(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Tt=Math.PI,sn=2*Tt,yp=Number.POSITIVE_INFINITY,x8=Tt/180,un=Tt/2,Do=Tt/4,L_=Tt*2/3,lT=Math.log10,lo=Math.sign;function jf(t,e,n){return Math.abs(t-e)<n}function $_(t){const e=Math.round(t);t=jf(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(lT(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function y8(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function v8(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function vp(t){return!v8(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function b8(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function w8(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function ii(t){return t*(Tt/180)}function k8(t){return t*(180/Tt)}function F_(t){if(!qs(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function cT(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*Tt&&(i+=sn),{angle:i,distance:r}}function _8(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Cr(t){return(t%sn+sn)%sn}function bp(t,e,n,s){const r=Cr(t),i=Cr(e),o=Cr(n),a=Cr(i-r),l=Cr(o-r),u=Cr(r-i),d=Cr(r-o);return r===i||r===o||s&&i===o||a>l&&u<d}function ss(t,e,n){return Math.max(e,Math.min(n,t))}function S8(t){return ss(t,-32768,32767)}function Jo(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function U0(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Ly=(t,e,n,s)=>U0(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),j8=(t,e,n)=>U0(t,n,s=>t[s][e]>=n);function C8(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const uT=["push","pop","shift","splice","unshift"];function N8(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),uT.forEach(n=>{const s="_onData"+B0(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function z_(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(uT.forEach(i=>{delete t[i]}),delete t._chartjs)}function dT(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const hT=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function fT(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,hT.call(window,()=>{s=!1,t.apply(e,n)}))}}function E8(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const pT=t=>t==="start"?"left":t==="end"?"right":"center",gs=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,T8=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,Wh=t=>t===0||t===1,B_=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*sn/n)),U_=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*sn/n)+1,yu={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*un)+1,easeOutSine:t=>Math.sin(t*un),easeInOutSine:t=>-.5*(Math.cos(Tt*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Wh(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Wh(t)?t:B_(t,.075,.3),easeOutElastic:t=>Wh(t)?t:U_(t,.075,.3),easeInOutElastic(t){return Wh(t)?t:t<.5?.5*B_(t*2,.1125,.45):.5+.5*U_(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-yu.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?yu.easeInBounce(t*2)*.5:yu.easeOutBounce(t*2-1)*.5+.5};function mT(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function H_(t){return mT(t)?t:new ld(t)}function Pg(t){return mT(t)?t:new ld(t).saturate(.5).darken(.1).hexString()}const P8=["x","y","borderWidth","radius","tension"],R8=["color","borderColor","backgroundColor"];function A8(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:R8},numbers:{type:"number",properties:P8}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function O8(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const W_=new Map;function M8(t,e){e=e||{};const n=t+JSON.stringify(e);let s=W_.get(n);return s||(s=new Intl.NumberFormat(t,e),W_.set(n,s)),s}function H0(t,e,n){return M8(e,n).format(t)}const I8={values(t){return pn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),i=D8(t,n)}const o=lT(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),H0(t,s,l)}};function D8(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var gT={formatters:I8};function L8(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:gT.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const ja=Object.create(null),$y=Object.create(null);function vu(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function Rg(t,e,n){return typeof e=="string"?cd(vu(t,e),n):cd(vu(t,""),e)}class $8{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Pg(r.backgroundColor),this.hoverBorderColor=(s,r)=>Pg(r.borderColor),this.hoverColor=(s,r)=>Pg(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Rg(this,e,n)}get(e){return vu(this,e)}describe(e,n){return Rg($y,e,n)}override(e,n){return Rg(ja,e,n)}route(e,n,s,r){const i=vu(this,e),o=vu(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],u=o[r];return rt(l)?Object.assign({},u,l):nt(l,u)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Zt=new $8({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[A8,O8,L8]);function F8(t){return!t||wt(t.size)||wt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function V_(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function Lo(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function q_(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function K_(t,e,n,s){xT(t,e,n,s,null)}function xT(t,e,n,s,r){let i,o,a,l,u,d,h,f;const p=e.pointStyle,w=e.rotation,y=e.radius;let x=(w||0)*x8;if(p&&typeof p=="object"&&(i=p.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(x),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(y)||y<=0)){switch(t.beginPath(),p){default:r?t.ellipse(n,s,r/2,y,0,0,sn):t.arc(n,s,y,0,sn),t.closePath();break;case"triangle":d=r?r/2:y,t.moveTo(n+Math.sin(x)*d,s-Math.cos(x)*y),x+=L_,t.lineTo(n+Math.sin(x)*d,s-Math.cos(x)*y),x+=L_,t.lineTo(n+Math.sin(x)*d,s-Math.cos(x)*y),t.closePath();break;case"rectRounded":u=y*.516,l=y-u,o=Math.cos(x+Do)*l,h=Math.cos(x+Do)*(r?r/2-u:l),a=Math.sin(x+Do)*l,f=Math.sin(x+Do)*(r?r/2-u:l),t.arc(n-h,s-a,u,x-Tt,x-un),t.arc(n+f,s-o,u,x-un,x),t.arc(n+h,s+a,u,x,x+un),t.arc(n-f,s+o,u,x+un,x+Tt),t.closePath();break;case"rect":if(!w){l=Math.SQRT1_2*y,d=r?r/2:l,t.rect(n-d,s-l,2*d,2*l);break}x+=Do;case"rectRot":h=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,a=Math.sin(x)*y,f=Math.sin(x)*(r?r/2:y),t.moveTo(n-h,s-a),t.lineTo(n+f,s-o),t.lineTo(n+h,s+a),t.lineTo(n-f,s+o),t.closePath();break;case"crossRot":x+=Do;case"cross":h=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,a=Math.sin(x)*y,f=Math.sin(x)*(r?r/2:y),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"star":h=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,a=Math.sin(x)*y,f=Math.sin(x)*(r?r/2:y),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o),x+=Do,h=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,a=Math.sin(x)*y,f=Math.sin(x)*(r?r/2:y),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"line":o=r?r/2:Math.cos(x)*y,a=Math.sin(x)*y,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(x)*(r?r/2:y),s+Math.sin(x)*y);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function yT(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function W0(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function V0(t){t.restore()}function z8(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function B8(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,d=r.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,d),t.lineTo(a,d),t.stroke()}}function U8(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function wp(t,e,n,s,r,i={}){const o=pn(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,u;for(t.save(),t.font=r.string,z8(t,i),l=0;l<o.length;++l)u=o[l],i.backdrop&&U8(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),wt(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(u,n,s,i.maxWidth)),t.fillText(u,n,s,i.maxWidth),B8(t,n,s,u,i),s+=Number(r.lineHeight);t.restore()}function kp(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*Tt,Tt,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,Tt,un,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,un,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-un,!0),t.lineTo(n+o.topLeft,s)}const H8=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,W8=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function V8(t,e){const n=(""+t).match(H8);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const q8=t=>+t||0;function q0(t,e){const n={},s=rt(e),r=s?Object.keys(e):e,i=rt(t)?s?o=>nt(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=q8(i(o));return n}function vT(t){return q0(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ol(t){return q0(t,["topLeft","topRight","bottomLeft","bottomRight"])}function gr(t){const e=vT(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function rs(t,e){t=t||{},e=e||Zt.font;let n=nt(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=nt(t.style,e.style);s&&!(""+s).match(W8)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:nt(t.family,e.family),lineHeight:V8(nt(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:nt(t.weight,e.weight),string:""};return r.string=F8(r),r}function Vh(t,e,n,s){let r,i,o;for(r=0,i=t.length;r<i;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function K8(t,e,n){const{min:s,max:r}=t,i=oT(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function vc(t,e){return Object.assign(Object.create(t),e)}function K0(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=_T("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>K0([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return wT(a,l,()=>tW(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return Y_(a).includes(l)},ownKeys(a){return Y_(a)},set(a,l,u){const d=a._storage||(a._storage=r());return a[l]=d[l]=u,delete a._keys,!0}})}function ic(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:bT(t,s),setContext:i=>ic(t,i,n,s),override:i=>ic(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return wT(i,o,()=>Y8(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function bT(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:xo(n)?n:()=>n,isIndexable:xo(s)?s:()=>s}}const G8=(t,e)=>t?t+B0(e):e,G0=(t,e)=>rt(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function wT(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function Y8(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return xo(a)&&o.isScriptable(e)&&(a=Q8(e,a,t,n)),pn(a)&&a.length&&(a=X8(e,a,t,o.isIndexable)),G0(e,a)&&(a=ic(a,r,i&&i[e],o)),a}function Q8(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),G0(t,l)&&(l=Y0(r._scopes,r,t,l)),l}function X8(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(rt(e[0])){const l=e,u=r._scopes.filter(d=>d!==l);e=[];for(const d of l){const h=Y0(u,r,t,d);e.push(ic(h,i,o&&o[t],a))}}return e}function kT(t,e,n){return xo(t)?t(e,n):t}const J8=(t,e)=>t===!0?e:typeof t=="string"?Sa(e,t):void 0;function Z8(t,e,n,s,r){for(const i of e){const o=J8(n,i);if(o){t.add(o);const a=kT(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function Y0(t,e,n,s){const r=e._rootScopes,i=kT(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=G_(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=G_(a,o,i,l,s),l===null)?!1:K0(Array.from(a),[""],r,i,()=>eW(e,n,s))}function G_(t,e,n,s,r){for(;n;)n=Z8(t,e,n,s,r);return n}function eW(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return pn(r)&&rt(n)?n:r||{}}function tW(t,e,n,s){let r;for(const i of e)if(r=_T(G8(i,t),n),typeof r<"u")return G0(t,r)?Y0(n,s,t,r):r}function _T(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function Y_(t){let e=t._keys;return e||(e=t._keys=nW(t._scopes)),e}function nW(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function Q0(){return typeof window<"u"&&typeof document<"u"}function X0(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function _p(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const lm=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function sW(t,e){return lm(t).getPropertyValue(e)}const rW=["top","right","bottom","left"];function fa(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=rW[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const iW=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function oW(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(iW(r,i,t.target))a=r,l=i;else{const u=e.getBoundingClientRect();a=s.clientX-u.left,l=s.clientY-u.top,o=!0}return{x:a,y:l,box:o}}function Ho(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=lm(n),i=r.boxSizing==="border-box",o=fa(r,"padding"),a=fa(r,"border","width"),{x:l,y:u,box:d}=oW(t,n),h=o.left+(d&&a.left),f=o.top+(d&&a.top);let{width:p,height:w}=e;return i&&(p-=o.width+a.width,w-=o.height+a.height),{x:Math.round((l-h)/p*n.width/s),y:Math.round((u-f)/w*n.height/s)}}function aW(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&X0(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=lm(i),l=fa(a,"border","width"),u=fa(a,"padding");e=o.width-u.width-l.width,n=o.height-u.height-l.height,s=_p(a.maxWidth,i,"clientWidth"),r=_p(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||yp,maxHeight:r||yp}}const Gi=t=>Math.round(t*10)/10;function lW(t,e,n,s){const r=lm(t),i=fa(r,"margin"),o=_p(r.maxWidth,t,"clientWidth")||yp,a=_p(r.maxHeight,t,"clientHeight")||yp,l=aW(t,e,n);let{width:u,height:d}=l;if(r.boxSizing==="content-box"){const f=fa(r,"border","width"),p=fa(r,"padding");u-=p.width+f.width,d-=p.height+f.height}return u=Math.max(0,u-i.width),d=Math.max(0,s?u/s:d-i.height),u=Gi(Math.min(u,o,l.maxWidth)),d=Gi(Math.min(d,a,l.maxHeight)),u&&!d&&(d=Gi(u/2)),(e!==void 0||n!==void 0)&&s&&l.height&&d>l.height&&(d=l.height,u=Gi(Math.floor(d*s))),{width:u,height:d}}function Q_(t,e,n){const s=e||1,r=Gi(t.height*s),i=Gi(t.width*s);t.height=Gi(t.height),t.width=Gi(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const cW=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Q0()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function X_(t,e){const n=sW(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const uW=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},dW=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Ml(t,e,n){return t?uW(e,n):dW()}function ST(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function jT(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function qh(t,e,n){return t.options.clip?t[n]:e[n]}function hW(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:qh(n,e,"left"),right:qh(n,e,"right"),top:qh(s,e,"top"),bottom:qh(s,e,"bottom")}:e}function fW(t,e){const n=e._clip;if(n.disabled)return!1;const s=hW(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class pW{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=hT.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var qr=new pW;const J_="transparent",mW={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=H_(t||J_),r=s.valid&&H_(e||J_);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class gW{constructor(e,n,s,r){const i=n[s];r=Vh([e.to,r,i,e.from]);const o=Vh([e.from,i,r]);this._active=!0,this._fn=e.fn||mW[e.type||typeof o],this._easing=yu[e.easing]||yu.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Vh([e.to,n,r,e.from]),this._from=Vh([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class CT{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!rt(e))return;const n=Object.keys(Zt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!rt(i))return;const o={};for(const a of n)o[a]=i[a];(pn(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=yW(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&xW(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const u=o[l];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,n));continue}const d=n[u];let h=i[u];const f=s.get(u);if(h)if(f&&h.active()){h.update(f,d,a);continue}else h.cancel();if(!f||!f.duration){e[u]=d;continue}i[u]=h=new gW(f,e,u,d),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return qr.add(this._chart,s),!0}}function xW(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function yW(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Z_(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function vW(t,e,n){if(n===!1)return!1;const s=Z_(t,n),r=Z_(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function bW(t){let e,n,s,r;return rt(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function NT(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function eS(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,u;if(e===null)return;let d=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(d=!0,s.all)continue;break}u=t.values[l],qs(u)&&(i||e===0||lo(e)===lo(u))&&(e+=u)}return!d&&!s.all?0:e}function wW(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,u,d;for(l=0,u=o.length;l<u;++l)d=o[l],a[l]={[r]:d,[i]:t[d]};return a}function Ag(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function kW(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function _W(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function SW(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function tS(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function nS(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,u=o.axis,d=kW(i,o,s),h=e.length;let f;for(let p=0;p<h;++p){const w=e[p],{[l]:y,[u]:x}=w,g=w._stacks||(w._stacks={});f=g[u]=SW(r,d,y),f[a]=x,f._top=tS(f,o,!0,s.type),f._bottom=tS(f,o,!1,s.type);const m=f._visualValues||(f._visualValues={});m[a]=x}}function Og(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function jW(t,e){return vc(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function CW(t,e,n){return vc(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Fc(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const Mg=t=>t==="reset"||t==="none",sS=(t,e)=>e?t:Object.assign({},t),NW=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:NT(n,!0),values:null};class Il{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Ag(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Fc(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,f,p,w)=>h==="x"?f:h==="r"?w:p,i=n.xAxisID=nt(s.xAxisID,Og(e,"x")),o=n.yAxisID=nt(s.yAxisID,Og(e,"y")),a=n.rAxisID=nt(s.rAxisID,Og(e,"r")),l=n.indexAxis,u=n.iAxisID=r(l,i,o,a),d=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&z_(this._data,this),e._stacked&&Fc(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(rt(n)){const r=this._cachedMeta;this._data=wW(n,r)}else if(s!==n){if(s){z_(s,this);const r=this._cachedMeta;Fc(r),r._parsed=[]}n&&Object.isExtensible(n)&&N8(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=Ag(n.vScale,n),n.stack!==s.stack&&(r=!0,Fc(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(nS(this,n._parsed),n._stacked=Ag(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,u=e>0&&s._parsed[e-1],d,h,f;if(this._parsing===!1)s._parsed=r,s._sorted=!0,f=r;else{pn(r[e])?f=this.parseArrayData(s,r,e,n):rt(r[e])?f=this.parseObjectData(s,r,e,n):f=this.parsePrimitiveData(s,r,e,n);const p=()=>h[a]===null||u&&h[a]<u[a];for(d=0;d<n;++d)s._parsed[d+e]=h=f[d],l&&(p()&&(l=!1),u=h);s._sorted=l}o&&nS(this,f)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,u=i.getLabels(),d=i===o,h=new Array(r);let f,p,w;for(f=0,p=r;f<p;++f)w=f+s,h[f]={[a]:d||i.parse(u[w],w),[l]:o.parse(n[w],w)};return h}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,u,d,h;for(l=0,u=r;l<u;++l)d=l+s,h=n[d],a[l]={x:i.parse(h[0],d),y:o.parse(h[1],d)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=new Array(r);let d,h,f,p;for(d=0,h=r;d<h;++d)f=d+s,p=n[f],u[d]={x:i.parse(Sa(p,a),f),y:o.parse(Sa(p,l),f)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:NT(r,!0),values:n._stacks[e.axis]._visualValues};return eS(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=eS(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=NW(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=_W(a);let f,p;function w(){p=r[f];const y=p[a.axis];return!qs(p[e.axis])||d>y||h<y}for(f=0;f<o&&!(!w()&&(this.updateRangeFromParsed(u,e,p,l),i));++f);if(i){for(f=o-1;f>=0;--f)if(!w()){this.updateRangeFromParsed(u,e,p,l);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],qs(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=bW(nt(this.options.clip,vW(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(e,i,a,l),d=a;d<a+l;++d){const h=r[d];h.hidden||(h.active&&u?o.push(h):h.draw(e,i))}for(d=0;d<o.length;++d)o[d].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=CW(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=jW(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&ud(s);if(a)return sS(a,l);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],f=u.getOptionScopes(this.getDataset(),d),p=Object.keys(Zt.elements[e]),w=()=>this.getContext(s,r,n),y=u.resolveNamedOptions(f,p,w,h);return y.$shared&&(y.$shared=l,i[o]=Object.freeze(sS(y,l))),y}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,n),f=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(f,this.getContext(e,s,n))}const u=new CT(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Mg(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){Mg(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!Mg(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,u]of this._syncList)this[a](l,u);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=u=>{for(u.length+=n,a=u.length-1;a>=o;a--)u[a]=u[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Fc(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}$e(Il,"defaults",{}),$e(Il,"datasetElementType",null),$e(Il,"dataElementType",null);function EW(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=dT(s.sort((r,i)=>r-i))}return t._cache.$bar}function TW(t){const e=t.iScale,n=EW(e,t.type);let s=e._length,r,i,o,a;const l=()=>{o===32767||o===-32768||(ud(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(r=0,i=n.length;r<i;++r)o=e.getPixelForValue(n[r]),l();for(a=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),l();return s}function PW(t,e,n,s){const r=n.barThickness;let i,o;return wt(r)?(i=e.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:e.pixels[t]-i/2}}function RW(t,e,n,s){const r=e.pixels,i=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const u=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:n.barPercentage,start:u}}function AW(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),o=Math.min(r,i),a=Math.max(r,i);let l=o,u=a;Math.abs(o)>Math.abs(a)&&(l=a,u=o),e[n.axis]=u,e._custom={barStart:l,barEnd:u,start:r,end:i,min:o,max:a}}function ET(t,e,n,s){return pn(t)?AW(t,e,n,s):e[n.axis]=n.parse(t,s),e}function rS(t,e,n,s){const r=t.iScale,i=t.vScale,o=r.getLabels(),a=r===i,l=[];let u,d,h,f;for(u=n,d=n+s;u<d;++u)f=e[u],h={},h[r.axis]=a||r.parse(o[u],u),l.push(ET(f,h,i,u));return l}function Ig(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function OW(t,e,n){return t!==0?lo(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function MW(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function IW(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:u,bottom:d}=MW(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(i[iS(d,o,a,l)]=!0,r=u)),i[iS(r,o,a,l)]=!0,t.borderSkipped=i}function iS(t,e,n,s){return s?(t=DW(t,e,n),t=oS(t,n,e)):t=oS(t,e,n),t}function DW(t,e,n){return t===e?n:t===n?e:t}function oS(t,e,n){return t==="start"?e:t==="end"?n:t}function LW(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class Cf extends Il{parsePrimitiveData(e,n,s,r){return rS(e,n,s,r)}parseArrayData(e,n,s,r){return rS(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=i.axis==="x"?a:l,d=o.axis==="x"?a:l,h=[];let f,p,w,y;for(f=s,p=s+r;f<p;++f)y=n[f],w={},w[i.axis]=i.parse(Sa(y,u),f),h.push(ET(Sa(y,d),w,o,f));return h}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),o=i._custom,a=Ig(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),u=a.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(n,r);for(let p=n;p<n+s;p++){const w=this.getParsed(p),y=i||wt(w[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),x=this._calculateBarIndexPixels(p,d),g=(w._stacks||{})[a.axis],m={horizontal:u,base:y.base,enableBorderRadius:!g||Ig(w._custom)||o===g._top||o===g._bottom,x:u?y.head:x.center,y:u?x.center:y.head,height:u?x.size:Math.abs(y.size),width:u?Math.abs(y.size):x.size};f&&(m.options=h||this.resolveDataElementOptions(p,e[p].active?"active":r));const b=m.options||e[p].options;IW(m,b,g,o),LW(m,b,d.ratio),this.updateElement(e[p],p,m,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],u=d=>{const h=d._parsed.find(p=>p[s.axis]===l),f=h&&h[d.vScale.axis];if(wt(f)||isNaN(f))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((i===!1||o.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[nt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const a=e.barThickness;return{min:a||TW(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),u=l._custom,d=Ig(u);let h=l[n.axis],f=0,p=s?this.applyStack(n,l,s):h,w,y;p!==h&&(f=p-h,p=h),d&&(h=u.barStart,p=u.barEnd-u.barStart,h!==0&&lo(h)!==lo(u.barEnd)&&(f=0),f+=h);const x=!wt(i)&&!d?i:f;let g=n.getPixelForValue(x);if(this.chart.getDataVisibility(e)?w=n.getPixelForValue(f+p):w=g,y=w-g,Math.abs(y)<o){y=OW(y,n,a)*o,h===a&&(g-=y/2);const m=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),k=Math.min(m,b),_=Math.max(m,b);g=Math.max(Math.min(g,_),k),w=g+y,s&&!d&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(w)-n.getValueForPixel(g))}if(g===n.getPixelForValue(a)){const m=lo(y)*n.getLineWidthForValue(a)/2;g+=m,y-=m}return{size:y,base:g,head:w,center:w+y/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,o=nt(r.maxBarThickness,1/0);let a,l;const u=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(e):n.stackCount,h=r.barThickness==="flex"?RW(e,n,r,d*u):PW(e,n,r,d*u),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(nt(f,this.getFirstScaleIdForIndexAxis())),w=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+p;a=h.start+h.chunk*w+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}$e(Cf,"id","bar"),$e(Cf,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),$e(Cf,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function $W(t,e,n){let s=1,r=1,i=0,o=0;if(e<sn){const a=t,l=a+e,u=Math.cos(a),d=Math.sin(a),h=Math.cos(l),f=Math.sin(l),p=(b,k,_)=>bp(b,a,l,!0)?1:Math.max(k,k*n,_,_*n),w=(b,k,_)=>bp(b,a,l,!0)?-1:Math.min(k,k*n,_,_*n),y=p(0,u,h),x=p(un,d,f),g=w(Tt,u,h),m=w(Tt+un,d,f);s=(y-g)/2,r=(x-m)/2,i=-(y+g)/2,o=-(x+m)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class vl extends Il{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(rt(s[e])){const{key:l="value"}=this._parsing;i=u=>+Sa(s[u],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return ii(this.options.rotation-90)}_getCircumference(){return ii(this.options.circumference)}_getRotationExtents(){let e=sn,n=-sn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(d8(this.options.cutout,a),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:w,offsetY:y}=$W(h,d,l),x=(s.width-o)/f,g=(s.height-o)/p,m=Math.max(Math.min(x,g)/2,0),b=oT(this.options.radius,m),k=Math.max(b*l,0),_=(b-k)/this._getVisibleDatasetWeightTotal();this.offsetX=w*b,this.offsetY=y*b,r.total=this.calculateTotal(),this.outerRadius=b-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*u,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/sn)}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,u=o.options.animation,d=(a.left+a.right)/2,h=(a.top+a.bottom)/2,f=i&&u.animateScale,p=f?0:this.innerRadius,w=f?0:this.outerRadius,{sharedOptions:y,includeOptions:x}=this._getSharedOptions(n,r);let g=this._getRotation(),m;for(m=0;m<n;++m)g+=this._circumference(m,i);for(m=n;m<n+s;++m){const b=this._circumference(m,i),k=e[m],_={x:d+this.offsetX,y:h+this.offsetY,startAngle:g,endAngle:g+b,circumference:b,outerRadius:w,innerRadius:p};x&&(_.options=y||this.resolveDataElementOptions(m,k.active?"active":r)),g+=b,this.updateElement(k,m,_,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?sn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=H0(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,o,a,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(nt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}$e(vl,"id","doughnut"),$e(vl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),$e(vl,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),$e(vl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((l,u)=>{const h=e.getDatasetMeta(0).controller.getStyle(u);return{text:l,fillStyle:h.backgroundColor,fontColor:i,hidden:!e.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(a||h.borderRadius),index:u}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class Fy extends vl{}$e(Fy,"id","pie"),$e(Fy,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function $o(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class J0{constructor(e){$e(this,"options");this.options=e||{}}static override(e){Object.assign(J0.prototype,e)}init(){}formats(){return $o()}parse(){return $o()}format(){return $o()}add(){return $o()}diff(){return $o()}startOf(){return $o()}endOf(){return $o()}}var FW={_date:J0};function zW(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const u=a._reversePixels?j8:Ly;if(s){if(r._sharedOptions){const d=i[0],h=typeof d.getRange=="function"&&d.getRange(e);if(h){const f=u(i,e,n-h),p=u(i,e,n+h);return{lo:f.lo,hi:p.hi}}}}else{const d=u(i,e,n);if(l){const{vScale:h}=r._cachedMeta,{_parsed:f}=t,p=f.slice(0,d.lo+1).reverse().findIndex(y=>!wt(y[h.axis]));d.lo-=Math.max(0,p);const w=f.slice(d.hi).findIndex(y=>!wt(y[h.axis]));d.hi+=Math.max(0,w)}return d}}return{lo:0,hi:i.length-1}}function cm(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:u,data:d}=i[a],{lo:h,hi:f}=zW(i[a],e,o,r);for(let p=h;p<=f;++p){const w=d[p];w.skip||s(w,u,p)}}}function BW(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Dg(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||cm(t,n,e,function(a,l,u){!r&&!yT(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:u})},!0),i}function UW(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],s),{angle:h}=cT(o,{x:e.x,y:e.y});bp(h,u,d)&&r.push({element:o,datasetIndex:a,index:l})}return cm(t,n,e,i),r}function HW(t,e,n,s,r,i){let o=[];const a=BW(n);let l=Number.POSITIVE_INFINITY;function u(d,h,f){const p=d.inRange(e.x,e.y,r);if(s&&!p)return;const w=d.getCenterPoint(r);if(!(!!i||t.isPointInArea(w))&&!p)return;const x=a(e,w);x<l?(o=[{element:d,datasetIndex:h,index:f}],l=x):x===l&&o.push({element:d,datasetIndex:h,index:f})}return cm(t,n,e,u),o}function Lg(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?UW(t,e,n,r):HW(t,e,n,s,r,i)}function aS(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return cm(t,n,e,(l,u,d)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:u,index:d}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var WW={modes:{index(t,e,n,s){const r=Ho(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?Dg(t,r,i,s,o):Lg(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const d=a[0].index,h=u.data[d];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:d})}),l):[]},dataset(t,e,n,s){const r=Ho(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?Dg(t,r,i,s,o):Lg(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,u=t.getDatasetMeta(l).data;a=[];for(let d=0;d<u.length;++d)a.push({element:u[d],datasetIndex:l,index:d})}return a},point(t,e,n,s){const r=Ho(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Dg(t,r,i,s,o)},nearest(t,e,n,s){const r=Ho(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Lg(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=Ho(e,t);return aS(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Ho(e,t);return aS(t,r,"y",n.intersect,s)}}};const TT=["left","top","right","bottom"];function zc(t,e){return t.filter(n=>n.pos===e)}function lS(t,e){return t.filter(n=>TT.indexOf(n.pos)===-1&&n.box.axis===e)}function Bc(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function VW(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function qW(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!TT.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function KW(t,e){const n=qW(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,u=n[a.stack],d=u&&a.stackWeight/u.weight;a.horizontal?(a.width=d?d*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=d?d*r:l&&e.availableHeight)}return n}function GW(t){const e=VW(t),n=Bc(e.filter(u=>u.box.fullSize),!0),s=Bc(zc(e,"left"),!0),r=Bc(zc(e,"right")),i=Bc(zc(e,"top"),!0),o=Bc(zc(e,"bottom")),a=lS(e,"x"),l=lS(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:zc(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function cS(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function PT(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function YW(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!rt(r)){n.size&&(t[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,t[r]+=n.size}i.getPadding&&PT(o,i.getPadding());const a=Math.max(0,e.outerWidth-cS(o,t,"left","right")),l=Math.max(0,e.outerHeight-cS(o,t,"top","bottom")),u=a!==t.w,d=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:u,other:d}:{same:d,other:u}}function QW(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function XW(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function tu(t,e,n,s){const r=[];let i,o,a,l,u,d;for(i=0,o=t.length,u=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,XW(a.horizontal,e));const{same:h,other:f}=YW(e,n,a,s);u|=h&&r.length,d=d||f,l.fullSize||r.push(a)}return u&&tu(r,e,n,s)||d}function Kh(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function uS(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,u=s[a.stack]||{placed:0,weight:1},d=a.stackWeight/u.weight||1;if(a.horizontal){const h=e.w*d,f=u.size||l.height;ud(u.start)&&(o=u.start),l.fullSize?Kh(l,r.left,o,n.outerWidth-r.right-r.left,f):Kh(l,e.left+u.placed,o,h,f),u.start=o,u.placed+=h,o=l.bottom}else{const h=e.h*d,f=u.size||l.width;ud(u.start)&&(i=u.start),l.fullSize?Kh(l,i,r.top,f,n.outerHeight-r.bottom-r.top):Kh(l,i,e.top+u.placed,f,h),u.start=i,u.placed+=h,i=l.right}}e.x=i,e.y=o}var Yi={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=gr(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=GW(t.boxes),l=a.vertical,u=a.horizontal;gt(t.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});const d=l.reduce((y,x)=>x.box.options&&x.box.options.display===!1?y:y+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/d,hBoxMaxHeight:o/2}),f=Object.assign({},r);PT(f,gr(s));const p=Object.assign({maxPadding:f,w:i,h:o,x:r.left,y:r.top},r),w=KW(l.concat(u),h);tu(a.fullSize,p,h,w),tu(l,p,h,w),tu(u,p,h,w)&&tu(l,p,h,w),QW(p),uS(a.leftAndTop,p,h,w),p.x+=p.w,p.y+=p.h,uS(a.rightAndBottom,p,h,w),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},gt(a.chartArea,y=>{const x=y.box;Object.assign(x,t.chartArea),x.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class RT{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class JW extends RT{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Nf="$chartjs",ZW={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},dS=t=>t===null||t==="";function eV(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Nf]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",dS(r)){const i=X_(t,"width");i!==void 0&&(t.width=i)}if(dS(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=X_(t,"height");i!==void 0&&(t.height=i)}return t}const AT=cW?{passive:!0}:!1;function tV(t,e,n){t&&t.addEventListener(e,n,AT)}function nV(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,AT)}function sV(t,e){const n=ZW[t.type]||t.type,{x:s,y:r}=Ho(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function Sp(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function rV(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Sp(a.addedNodes,s),o=o&&!Sp(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function iV(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Sp(a.removedNodes,s),o=o&&!Sp(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const dd=new Map;let hS=0;function OT(){const t=window.devicePixelRatio;t!==hS&&(hS=t,dd.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function oV(t,e){dd.size||window.addEventListener("resize",OT),dd.set(t,e)}function aV(t){dd.delete(t),dd.size||window.removeEventListener("resize",OT)}function lV(t,e,n){const s=t.canvas,r=s&&X0(s);if(!r)return;const i=fT((a,l)=>{const u=r.clientWidth;n(a,l),u<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],u=l.contentRect.width,d=l.contentRect.height;u===0&&d===0||i(u,d)});return o.observe(r),oV(t,i),o}function $g(t,e,n){n&&n.disconnect(),e==="resize"&&aV(t)}function cV(t,e,n){const s=t.canvas,r=fT(i=>{t.ctx!==null&&n(sV(i,t))},t);return tV(s,e,r),r}class uV extends RT{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(eV(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Nf])return!1;const s=n[Nf].initial;["height","width"].forEach(i=>{const o=s[i];wt(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[Nf],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:rV,detach:iV,resize:lV}[n]||cV;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:$g,detach:$g,resize:$g}[n]||nV)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return lW(e,n,s,r)}isAttached(e){const n=e&&X0(e);return!!(n&&n.isConnected)}}function dV(t){return!Q0()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?JW:uV}var tf;let bc=(tf=class{constructor(){$e(this,"x");$e(this,"y");$e(this,"active",!1);$e(this,"options");$e(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return vp(this.x)&&vp(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},$e(tf,"defaults",{}),$e(tf,"defaultRoutes"),tf);function hV(t,e){const n=t.options.ticks,s=fV(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?mV(e):[],o=i.length,a=i[0],l=i[o-1],u=[];if(o>r)return gV(e,u,i,o/r),u;const d=pV(i,e,r);if(o>0){let h,f;const p=o>1?Math.round((l-a)/(o-1)):null;for(Gh(e,u,d,wt(p)?0:a-p,a),h=0,f=o-1;h<f;h++)Gh(e,u,d,i[h],i[h+1]);return Gh(e,u,d,l,wt(p)?e.length:l+p),u}return Gh(e,u,d),u}function fV(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function pV(t,e,n){const s=xV(t),r=e.length/n;if(!s)return Math.max(r,1);const i=y8(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function mV(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function gV(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function Gh(t,e,n,s,r){const i=nt(s,0),o=Math.min(nt(r,t.length),t.length);let a=0,l,u,d;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),d=i;d<0;)a++,d=Math.round(i+a*n);for(u=Math.max(i,0);u<o;u++)u===d&&(e.push(t[u]),a++,d=Math.round(i+a*n))}function xV(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const yV=t=>t==="left"?"right":t==="right"?"left":t,fS=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,pS=(t,e)=>Math.min(e||t,t);function mS(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function vV(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(l-i,o-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(r-1))/2,l+=r<e?u:-u,l<i-a||l>o+a)))return l}function bV(t,e){gt(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function Uc(t){return t.drawTicks?t.tickLength:0}function gS(t,e){if(!t.display)return 0;const n=rs(t.font,e),s=gr(t.padding);return(pn(t.text)?t.text.length:1)*n.lineHeight+s.height}function wV(t,e){return vc(t,{scale:e,type:"scale"})}function kV(t,e,n){return vc(t,{tick:n,index:e,type:"tick"})}function _V(t,e,n){let s=pT(t);return(n&&e!=="right"||!n&&e==="right")&&(s=yV(s)),s}function SV(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:u,scales:d}=l;let h=0,f,p,w;const y=o-r,x=a-i;if(t.isHorizontal()){if(p=gs(s,i,a),rt(n)){const g=Object.keys(n)[0],m=n[g];w=d[g].getPixelForValue(m)+y-e}else n==="center"?w=(u.bottom+u.top)/2+y-e:w=fS(t,n,e);f=a-i}else{if(rt(n)){const g=Object.keys(n)[0],m=n[g];p=d[g].getPixelForValue(m)-x+e}else n==="center"?p=(u.left+u.right)/2-x+e:p=fS(t,n,e);w=gs(s,o,r),h=n==="left"?-un:un}return{titleX:p,titleY:w,maxWidth:f,rotation:h}}class wc extends bc{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=kr(e,Number.POSITIVE_INFINITY),n=kr(n,Number.NEGATIVE_INFINITY),s=kr(s,Number.POSITIVE_INFINITY),r=kr(r,Number.NEGATIVE_INFINITY),{min:kr(e,s),max:kr(n,r),minDefined:qs(e),maxDefined:qs(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,u=a.length;l<u;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:kr(n,kr(s,n)),max:kr(s,kr(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Et(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=K8(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?mS(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=hV(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Et(this.options.afterUpdate,[this])}beforeSetDimensions(){Et(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Et(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Et(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Et(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=Et(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){Et(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Et(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=pS(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,u;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,f=d.highest.height,p=ss(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/s:p/(s-1),h+6>a&&(a=p/(s-(e.offset?.5:1)),l=this.maxHeight-Uc(e.grid)-n.padding-gS(e.title,this.chart.options.font),u=Math.sqrt(h*h+f*f),o=k8(Math.min(Math.asin(ss((d.highest.height+6)/a,-1,1)),Math.asin(ss(l/u,-1,1))-Math.asin(ss(f/u,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Et(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Et(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=gS(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=Uc(i)+l):(e.height=this.maxHeight,e.width=Uc(i)+l),s.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:f}=this._getLabelSizes(),p=s.padding*2,w=ii(this.labelRotation),y=Math.cos(w),x=Math.sin(w);if(a){const g=s.mirror?0:x*h.width+y*f.height;e.height=Math.min(this.maxHeight,e.height+g+p)}else{const g=s.mirror?0:y*h.width+x*f.height;e.width=Math.min(this.maxWidth,e.width+g+p)}this._calculatePadding(u,d,x,y)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;l?u?(f=r*e.width,p=s*n.height):(f=s*e.height,p=r*n.width):i==="start"?p=n.width:i==="end"?f=e.width:i!=="inner"&&(f=e.width/2,p=n.width/2),this.paddingLeft=Math.max((f-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((p-h+o)*this.width/(this.width-h),0)}else{let d=n.height/2,h=e.height/2;i==="start"?(d=0,h=e.height):i==="end"&&(d=n.height,h=0),this.paddingTop=d+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Et(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)wt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=mS(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/pS(n,s));let u=0,d=0,h,f,p,w,y,x,g,m,b,k,_;for(h=0;h<n;h+=l){if(w=e[h].label,y=this._resolveTickFontOptions(h),r.font=x=y.string,g=i[x]=i[x]||{data:{},gc:[]},m=y.lineHeight,b=k=0,!wt(w)&&!pn(w))b=V_(r,g.data,g.gc,b,w),k=m;else if(pn(w))for(f=0,p=w.length;f<p;++f)_=w[f],!wt(_)&&!pn(_)&&(b=V_(r,g.data,g.gc,b,_),k+=m);o.push(b),a.push(k),u=Math.max(b,u),d=Math.max(k,d)}bV(i,n);const C=o.indexOf(u),S=a.indexOf(d),j=N=>({width:o[N]||0,height:a[N]||0});return{first:j(0),last:j(n-1),widest:j(C),highest:j(S),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return S8(this._alignToPixels?Lo(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=kV(this.getContext(),e,s))}return this.$context||(this.$context=wV(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=ii(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=Uc(i),p=[],w=a.setContext(this.getContext()),y=w.display?w.width:0,x=y/2,g=function(F){return Lo(s,F,y)};let m,b,k,_,C,S,j,N,P,L,I,O;if(o==="top")m=g(this.bottom),S=this.bottom-f,N=m-x,L=g(e.top)+x,O=e.bottom;else if(o==="bottom")m=g(this.top),L=e.top,O=g(e.bottom)-x,S=m+x,N=this.top+f;else if(o==="left")m=g(this.right),C=this.right-f,j=m-x,P=g(e.left)+x,I=e.right;else if(o==="right")m=g(this.left),P=e.left,I=g(e.right)-x,C=m+x,j=this.left+f;else if(n==="x"){if(o==="center")m=g((e.top+e.bottom)/2+.5);else if(rt(o)){const F=Object.keys(o)[0],q=o[F];m=g(this.chart.scales[F].getPixelForValue(q))}L=e.top,O=e.bottom,S=m+x,N=S+f}else if(n==="y"){if(o==="center")m=g((e.left+e.right)/2);else if(rt(o)){const F=Object.keys(o)[0],q=o[F];m=g(this.chart.scales[F].getPixelForValue(q))}C=m-x,j=C-f,P=e.left,I=e.right}const $=nt(r.ticks.maxTicksLimit,h),D=Math.max(1,Math.ceil(h/$));for(b=0;b<h;b+=D){const F=this.getContext(b),q=i.setContext(F),E=a.setContext(F),R=q.lineWidth,V=q.color,K=E.dash||[],Q=E.dashOffset,re=q.tickWidth,ee=q.tickColor,z=q.tickBorderDash||[],A=q.tickBorderDashOffset;k=vV(this,b,l),k!==void 0&&(_=Lo(s,k,R),u?C=j=P=I=_:S=N=L=O=_,p.push({tx1:C,ty1:S,tx2:j,ty2:N,x1:P,y1:L,x2:I,y2:O,width:R,color:V,borderDash:K,borderDashOffset:Q,tickWidth:re,tickColor:ee,tickBorderDash:z,tickBorderDashOffset:A}))}return this._ticksLength=h,this._borderValue=m,p}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:u,padding:d,mirror:h}=i,f=Uc(s.grid),p=f+d,w=h?-d:p,y=-ii(this.labelRotation),x=[];let g,m,b,k,_,C,S,j,N,P,L,I,O="middle";if(r==="top")C=this.bottom-w,S=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+w,S=this._getXAxisLabelAlignment();else if(r==="left"){const D=this._getYAxisLabelAlignment(f);S=D.textAlign,_=D.x}else if(r==="right"){const D=this._getYAxisLabelAlignment(f);S=D.textAlign,_=D.x}else if(n==="x"){if(r==="center")C=(e.top+e.bottom)/2+p;else if(rt(r)){const D=Object.keys(r)[0],F=r[D];C=this.chart.scales[D].getPixelForValue(F)+p}S=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")_=(e.left+e.right)/2-p;else if(rt(r)){const D=Object.keys(r)[0],F=r[D];_=this.chart.scales[D].getPixelForValue(F)}S=this._getYAxisLabelAlignment(f).textAlign}n==="y"&&(l==="start"?O="top":l==="end"&&(O="bottom"));const $=this._getLabelSizes();for(g=0,m=a.length;g<m;++g){b=a[g],k=b.label;const D=i.setContext(this.getContext(g));j=this.getPixelForTick(g)+i.labelOffset,N=this._resolveTickFontOptions(g),P=N.lineHeight,L=pn(k)?k.length:1;const F=L/2,q=D.color,E=D.textStrokeColor,R=D.textStrokeWidth;let V=S;o?(_=j,S==="inner"&&(g===m-1?V=this.options.reverse?"left":"right":g===0?V=this.options.reverse?"right":"left":V="center"),r==="top"?u==="near"||y!==0?I=-L*P+P/2:u==="center"?I=-$.highest.height/2-F*P+P:I=-$.highest.height+P/2:u==="near"||y!==0?I=P/2:u==="center"?I=$.highest.height/2-F*P:I=$.highest.height-L*P,h&&(I*=-1),y!==0&&!D.showLabelBackdrop&&(_+=P/2*Math.sin(y))):(C=j,I=(1-L)*P/2);let K;if(D.showLabelBackdrop){const Q=gr(D.backdropPadding),re=$.heights[g],ee=$.widths[g];let z=I-Q.top,A=0-Q.left;switch(O){case"middle":z-=re/2;break;case"bottom":z-=re;break}switch(S){case"center":A-=ee/2;break;case"right":A-=ee;break;case"inner":g===m-1?A-=ee:g>0&&(A-=ee/2);break}K={left:A,top:z,width:ee+Q.width,height:re+Q.height,color:D.backdropColor}}x.push({label:k,font:N,textOffset:I,options:{rotation:y,color:q,strokeColor:E,strokeWidth:R,textAlign:V,textBaseline:O,translation:[_,C],backdrop:K}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-ii(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let u,d;return n==="left"?r?(d=this.right+i,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d+=l)):(d=this.right-a,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+i,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d-=l)):(d=this.left+a,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,d,h,f;this.isHorizontal()?(u=Lo(e,this.left,o)-o/2,d=Lo(e,this.right,a)+a/2,h=f=l):(h=Lo(e,this.top,o)-o/2,f=Lo(e,this.bottom,a)+a/2,u=d=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,h),n.lineTo(d,f),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&W0(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,u=o.label,d=o.textOffset;wp(s,u,0,d,l,a)}r&&V0(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=rs(s.font),o=gr(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||rt(n)?(l+=o.bottom,pn(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:u,titleY:d,maxWidth:h,rotation:f}=SV(this,l,n,a);wp(e,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:f,textAlign:_V(a,n,r),textBaseline:"middle",translation:[u,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=nt(e.grid&&e.grid.z,-1),r=nt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==wc.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return rs(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Yh{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;NV(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,jV(e,o,s),this.override&&Zt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in Zt[r]&&(delete Zt[r][s],this.override&&delete ja[s])}}function jV(t,e,n){const s=cd(Object.create(null),[n?Zt.get(n):{},Zt.get(e),t.defaults]);Zt.set(e,s),t.defaultRoutes&&CV(e,t.defaultRoutes),t.descriptors&&Zt.describe(e,t.descriptors)}function CV(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Zt.route(i,r,l,a)})}function NV(t){return"id"in t&&"defaults"in t}class EV{constructor(){this.controllers=new Yh(Il,"datasets",!0),this.elements=new Yh(bc,"elements"),this.plugins=new Yh(Object,"plugins"),this.scales=new Yh(wc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):gt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=B0(e);Et(s["before"+r],[],s),n[e](s),Et(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var jr=new EV;class TV{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(Et(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){wt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=nt(s.options&&s.options.plugins,{}),i=PV(s);return r===!1&&!n?[]:AV(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function PV(t){const e={},n=[],s=Object.keys(jr.plugins.items);for(let i=0;i<s.length;i++)n.push(jr.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function RV(t,e){return!e&&t===!1?null:t===!0?{}:t}function AV(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,u=RV(s[l],r);u!==null&&i.push({plugin:a,options:OV(t.config,{plugin:a,local:n[l]},u,o)})}return i}function OV(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function zy(t,e){const n=Zt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function MV(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function IV(t,e){return t===e?"_index_":"_value_"}function xS(t){if(t==="x"||t==="y"||t==="r")return t}function DV(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function By(t,...e){if(xS(t))return t;for(const n of e){const s=n.axis||DV(n.position)||t.length>1&&xS(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function yS(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function LV(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return yS(t,"x",n[0])||yS(t,"y",n[0])}return{}}function $V(t,e){const n=ja[t.type]||{scales:{}},s=e.scales||{},r=zy(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!rt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=By(o,a,LV(o,t),Zt.scales[a.type]),u=IV(l,r),d=n.scales||{};i[o]=xu(Object.create(null),[{axis:l},a,d[l],d[u]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||zy(a,e),d=(ja[a]||{}).scales||{};Object.keys(d).forEach(h=>{const f=MV(h,l),p=o[f+"AxisID"]||f;i[p]=i[p]||Object.create(null),xu(i[p],[{axis:f},s[p],d[h]])})}),Object.keys(i).forEach(o=>{const a=i[o];xu(a,[Zt.scales[a.type],Zt.scale])}),i}function MT(t){const e=t.options||(t.options={});e.plugins=nt(e.plugins,{}),e.scales=$V(t,e)}function IT(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function FV(t){return t=t||{},t.data=IT(t.data),MT(t),t}const vS=new Map,DT=new Set;function Qh(t,e){let n=vS.get(t);return n||(n=e(),vS.set(t,n),DT.add(n)),n}const Hc=(t,e,n)=>{const s=Sa(e,n);s!==void 0&&t.add(s)};class zV{constructor(e){this._config=FV(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=IT(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),MT(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Qh(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Qh(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Qh(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Qh(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(d=>{e&&(l.add(e),d.forEach(h=>Hc(l,e,h))),d.forEach(h=>Hc(l,r,h)),d.forEach(h=>Hc(l,ja[i]||{},h)),d.forEach(h=>Hc(l,Zt,h)),d.forEach(h=>Hc(l,$y,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),DT.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,ja[n]||{},Zt.datasets[n]||{},{type:n},Zt,$y]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=bS(this._resolverCache,e,r);let l=o;if(UV(o,n)){i.$shared=!1,s=xo(s)?s():s;const u=this.createResolver(e,s,a);l=ic(o,s,u)}for(const u of n)i[u]=l[u];return i}createResolver(e,n,s=[""],r){const{resolver:i}=bS(this._resolverCache,e,s);return rt(n)?ic(i,n,void 0,r):i}}function bS(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:K0(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const BV=t=>rt(t)&&Object.getOwnPropertyNames(t).some(e=>xo(t[e]));function UV(t,e){const{isScriptable:n,isIndexable:s}=bT(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(xo(a)||BV(a))||o&&pn(a))return!0}return!1}var HV="4.5.1";const WV=["top","bottom","left","right","chartArea"];function wS(t,e){return t==="top"||t==="bottom"||WV.indexOf(t)===-1&&e==="x"}function kS(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function _S(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Et(n&&n.onComplete,[t],e)}function VV(t){const e=t.chart,n=e.options.animation;Et(n&&n.onProgress,[t],e)}function LT(t){return Q0()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Ef={},SS=t=>{const e=LT(t);return Object.values(Ef).filter(n=>n.canvas===e).pop()};function qV(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function KV(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}class Rr{static register(...e){jr.add(...e),jS()}static unregister(...e){jr.remove(...e),jS()}constructor(e,n){const s=this.config=new zV(n),r=LT(e),i=SS(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||dV(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,u=l&&l.height,d=l&&l.width;if(this.id=u8(),this.ctx=a,this.canvas=l,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new TV,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=E8(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Ef[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}qr.listen(this,"complete",_S),qr.listen(this,"progress",VV),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return wt(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return jr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Q_(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return q_(this.canvas,this.ctx),this}stop(){return qr.stop(this),this}resize(e,n){qr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Q_(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Et(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};gt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=By(o,a),u=l==="r",d=l==="x";return{options:a,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),gt(i,o=>{const a=o.options,l=a.id,u=By(l,a),d=nt(a.type,o.dtype);(a.position===void 0||wS(a.position,u)!==wS(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in s&&s[l].type===d)h=s[l];else{const f=jr.getScale(d);h=new f({id:l,type:d,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(a,e)}),gt(r,(o,a)=>{o||delete s[a]}),gt(s,o=>{Yi.configure(this,o,o.options),Yi.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(kS("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||zy(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=jr.getController(a),{datasetElementType:u,dataElementType:d}=Zt.datasets[a];Object.assign(l,{dataElementType:jr.getElement(d),datasetElementType:u&&jr.getElement(u)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){gt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),f=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(f),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||gt(i,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(kS("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){gt(this.scales,e=>{Yi.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!D_(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;qV(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!D_(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Yi.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],gt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,xo(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(qr.has(this)?this.attached&&!qr.running(this)&&qr.start(this):(this.draw(),_S({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=fW(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&W0(n,r),e.controller.draw(),r&&V0(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return yT(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=WW.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=vc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);ud(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),qr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),q_(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Ef[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};gt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,u)=>{n.addEventListener(this,l,u),e[l]=u},r=(l,u)=>{e[l]&&(n.removeEventListener(this,l,u),delete e[l])},i=(l,u)=>{this.canvas&&this.resize(l,u)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){gt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},gt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!gp(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,u)=>l.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=g8(e),u=KV(e,this._lastEvent,s,l);s&&(this._lastEvent=null,Et(i.onHover,[e,a,this],this),l&&Et(i.onClick,[e,a,this],this));const d=!gp(a,r);return(d||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=u,d}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}$e(Rr,"defaults",Zt),$e(Rr,"instances",Ef),$e(Rr,"overrides",ja),$e(Rr,"registry",jr),$e(Rr,"version",HV),$e(Rr,"getChart",SS);function jS(){return gt(Rr.instances,t=>t._plugins.invalidate())}function GV(t,e,n){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:u,borderJoinStyle:d}=l,h=Math.min(u/o,Cr(s-n));if(t.beginPath(),t.arc(r,i,o-u/2,s+h/2,n-h/2),a>0){const f=Math.min(u/a,Cr(s-n));t.arc(r,i,a+u/2,n-f/2,s+f/2,!0)}else{const f=Math.min(u/2,o*Cr(s-n));if(d==="round")t.arc(r,i,f,n-Tt/2,s+Tt/2,!0);else if(d==="bevel"){const p=2*f*f,w=-p*Math.cos(n+Tt/2)+r,y=-p*Math.sin(n+Tt/2)+i,x=p*Math.cos(s+Tt/2)+r,g=p*Math.sin(s+Tt/2)+i;t.lineTo(w,y),t.lineTo(x,g)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function YV(t,e,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:a,innerRadius:l}=e;let u=r/a;t.beginPath(),t.arc(i,o,a,s-u,n+u),l>r?(u=r/l,t.arc(i,o,l,n+u,s-u,!0)):t.arc(i,o,r,n+un,s-un),t.closePath(),t.clip()}function QV(t){return q0(t,["outerStart","outerEnd","innerStart","innerEnd"])}function XV(t,e,n,s){const r=QV(t.options.borderRadius),i=(n-e)/2,o=Math.min(i,s*e/2),a=l=>{const u=(n-Math.min(i,l))*s/2;return ss(l,0,Math.min(i,u))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:ss(r.innerStart,0,o),innerEnd:ss(r.innerEnd,0,o)}}function Za(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function jp(t,e,n,s,r,i){const{x:o,y:a,startAngle:l,pixelMargin:u,innerRadius:d}=e,h=Math.max(e.outerRadius+s+n-u,0),f=d>0?d+s+n+u:0;let p=0;const w=r-l;if(s){const D=d>0?d-s:0,F=h>0?h-s:0,q=(D+F)/2,E=q!==0?w*q/(q+s):w;p=(w-E)/2}const y=Math.max(.001,w*h-n/Tt)/h,x=(w-y)/2,g=l+x+p,m=r-x-p,{outerStart:b,outerEnd:k,innerStart:_,innerEnd:C}=XV(e,f,h,m-g),S=h-b,j=h-k,N=g+b/S,P=m-k/j,L=f+_,I=f+C,O=g+_/L,$=m-C/I;if(t.beginPath(),i){const D=(N+P)/2;if(t.arc(o,a,h,N,D),t.arc(o,a,h,D,P),k>0){const R=Za(j,P,o,a);t.arc(R.x,R.y,k,P,m+un)}const F=Za(I,m,o,a);if(t.lineTo(F.x,F.y),C>0){const R=Za(I,$,o,a);t.arc(R.x,R.y,C,m+un,$+Math.PI)}const q=(m-C/f+(g+_/f))/2;if(t.arc(o,a,f,m-C/f,q,!0),t.arc(o,a,f,q,g+_/f,!0),_>0){const R=Za(L,O,o,a);t.arc(R.x,R.y,_,O+Math.PI,g-un)}const E=Za(S,g,o,a);if(t.lineTo(E.x,E.y),b>0){const R=Za(S,N,o,a);t.arc(R.x,R.y,b,g-un,N)}}else{t.moveTo(o,a);const D=Math.cos(N)*h+o,F=Math.sin(N)*h+a;t.lineTo(D,F);const q=Math.cos(P)*h+o,E=Math.sin(P)*h+a;t.lineTo(q,E)}t.closePath()}function JV(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){jp(t,e,n,s,l,r);for(let u=0;u<i;++u)t.fill();isNaN(a)||(l=o+(a%sn||sn))}return jp(t,e,n,s,l,r),t.fill(),l}function ZV(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:f,borderRadius:p}=l,w=l.borderAlign==="inner";if(!u)return;t.setLineDash(h||[]),t.lineDashOffset=f,w?(t.lineWidth=u*2,t.lineJoin=d||"round"):(t.lineWidth=u,t.lineJoin=d||"bevel");let y=e.endAngle;if(i){jp(t,e,n,s,y,r);for(let x=0;x<i;++x)t.stroke();isNaN(a)||(y=o+(a%sn||sn))}w&&YV(t,e,y),l.selfJoin&&y-o>=Tt&&p===0&&d!=="miter"&&GV(t,e,y),i||(jp(t,e,n,s,y,r),t.stroke())}class nu extends bc{constructor(n){super();$e(this,"circumference");$e(this,"endAngle");$e(this,"fullCircles");$e(this,"innerRadius");$e(this,"outerRadius");$e(this,"pixelMargin");$e(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:a}=cT(i,{x:n,y:s}),{startAngle:l,endAngle:u,innerRadius:d,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),p=(this.options.spacing+this.options.borderWidth)/2,w=nt(f,u-l),y=bp(o,l,u)&&l!==u,x=w>=sn||y,g=Jo(a,d+p,h+p);return x&&g}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:u,spacing:d}=this.options,h=(i+o)/2,f=(a+l+d+u)/2;return{x:s+Math.cos(h)*f,y:r+Math.sin(h)*f}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>sn?Math.floor(r/sn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const u=1-Math.sin(Math.min(Tt,r||0)),d=i*u;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,JV(n,this,d,o,a),ZV(n,this,d,o,a),n.restore()}}$e(nu,"id","arc"),$e(nu,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),$e(nu,"defaultRoutes",{backgroundColor:"backgroundColor"}),$e(nu,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function $T(t,e){const{x:n,y:s,base:r,width:i,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,u,d,h;return t.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),u=s-h,d=s+h):(h=i/2,a=n-h,l=n+h,u=Math.min(s,r),d=Math.max(s,r)),{left:a,top:u,right:l,bottom:d}}function Qi(t,e,n,s){return t?0:ss(e,n,s)}function eq(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=vT(s);return{t:Qi(r.top,i.top,0,n),r:Qi(r.right,i.right,0,e),b:Qi(r.bottom,i.bottom,0,n),l:Qi(r.left,i.left,0,e)}}function tq(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=Ol(r),o=Math.min(e,n),a=t.borderSkipped,l=s||rt(r);return{topLeft:Qi(!l||a.top||a.left,i.topLeft,0,o),topRight:Qi(!l||a.top||a.right,i.topRight,0,o),bottomLeft:Qi(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:Qi(!l||a.bottom||a.right,i.bottomRight,0,o)}}function nq(t){const e=$T(t),n=e.right-e.left,s=e.bottom-e.top,r=eq(t,n/2,s/2),i=tq(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function Fg(t,e,n,s){const r=e===null,i=n===null,a=t&&!(r&&i)&&$T(t,s);return a&&(r||Jo(e,a.left,a.right))&&(i||Jo(n,a.top,a.bottom))}function sq(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function rq(t,e){t.rect(e.x,e.y,e.w,e.h)}function zg(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+o,radius:t.radius}}class Tf extends bc{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=nq(this),a=sq(o.radius)?kp:rq;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,zg(o,n,i)),e.clip(),a(e,zg(i,-n,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),a(e,zg(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Fg(this,e,n,s)}inXRange(e,n){return Fg(this,e,null,n)}inYRange(e,n){return Fg(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}$e(Tf,"id","bar"),$e(Tf,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),$e(Tf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const CS=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},iq=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class NS extends bc{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Et(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=rs(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=CS(s,i);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,i,a,l)+10):(d=this.maxHeight,u=this._fitCols(o,r,a,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+a;let h=e;i.textAlign="left",i.textBaseline="middle";let f=-1,p=-d;return this.legendItems.forEach((w,y)=>{const x=s+n/2+i.measureText(w.text).width;(y===0||u[u.length-1]+x+2*a>o)&&(h+=d,u[u.length-(y>0?0:1)]=0,p+=d,f++),l[y]={left:0,top:p,row:f,width:x,height:r},u[u.length-1]+=x+a}),h}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-e;let h=a,f=0,p=0,w=0,y=0;return this.legendItems.forEach((x,g)=>{const{itemWidth:m,itemHeight:b}=oq(s,n,i,x,r);g>0&&p+b+2*a>d&&(h+=f+a,u.push({width:f,height:p}),w+=f+a,y++,f=p=0),l[g]={left:w,top:p,col:y,width:m,height:b},f=Math.max(f,m),p+=b+a}),h+=f,u.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=Ml(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=gs(s,this.left+r,this.right-this.lineWidths[a]);for(const u of n)a!==u.row&&(a=u.row,l=gs(s,this.left+r,this.right-this.lineWidths[a])),u.top+=this.top+e+r,u.left=o.leftForLtr(o.x(l),u.width),l+=u.width+r}else{let a=0,l=gs(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const u of n)u.col!==a&&(a=u.col,l=gs(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),u.top=l,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),l+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;W0(e,this),this._draw(),V0(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=Zt.color,l=Ml(e.rtl,this.left,this.width),u=rs(o.font),{padding:d}=o,h=u.size,f=h/2;let p;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:w,boxHeight:y,itemHeight:x}=CS(o,h),g=function(C,S,j){if(isNaN(w)||w<=0||isNaN(y)||y<0)return;r.save();const N=nt(j.lineWidth,1);if(r.fillStyle=nt(j.fillStyle,a),r.lineCap=nt(j.lineCap,"butt"),r.lineDashOffset=nt(j.lineDashOffset,0),r.lineJoin=nt(j.lineJoin,"miter"),r.lineWidth=N,r.strokeStyle=nt(j.strokeStyle,a),r.setLineDash(nt(j.lineDash,[])),o.usePointStyle){const P={radius:y*Math.SQRT2/2,pointStyle:j.pointStyle,rotation:j.rotation,borderWidth:N},L=l.xPlus(C,w/2),I=S+f;xT(r,P,L,I,o.pointStyleWidth&&w)}else{const P=S+Math.max((h-y)/2,0),L=l.leftForLtr(C,w),I=Ol(j.borderRadius);r.beginPath(),Object.values(I).some(O=>O!==0)?kp(r,{x:L,y:P,w,h:y,radius:I}):r.rect(L,P,w,y),r.fill(),N!==0&&r.stroke()}r.restore()},m=function(C,S,j){wp(r,j.text,C,S+x/2,u,{strikethrough:j.hidden,textAlign:l.textAlign(j.textAlign)})},b=this.isHorizontal(),k=this._computeTitleHeight();b?p={x:gs(i,this.left+d,this.right-s[0]),y:this.top+d+k,line:0}:p={x:this.left+d,y:gs(i,this.top+k+d,this.bottom-n[0].height),line:0},ST(this.ctx,e.textDirection);const _=x+d;this.legendItems.forEach((C,S)=>{r.strokeStyle=C.fontColor,r.fillStyle=C.fontColor;const j=r.measureText(C.text).width,N=l.textAlign(C.textAlign||(C.textAlign=o.textAlign)),P=w+f+j;let L=p.x,I=p.y;l.setWidth(this.width),b?S>0&&L+P+d>this.right&&(I=p.y+=_,p.line++,L=p.x=gs(i,this.left+d,this.right-s[p.line])):S>0&&I+_>this.bottom&&(L=p.x=L+n[p.line].width+d,p.line++,I=p.y=gs(i,this.top+k+d,this.bottom-n[p.line].height));const O=l.x(L);if(g(O,I,C),L=T8(N,L+w+f,b?L+P:this.right,e.rtl),m(l.x(L),I,C),b)p.x+=P+d;else if(typeof C.text!="string"){const $=u.lineHeight;p.y+=FT(C,$)+d}else p.y+=_}),jT(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=rs(n.font),r=gr(n.padding);if(!n.display)return;const i=Ml(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,u=r.top+l;let d,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),d=this.top+u,h=gs(e.align,h,this.right-f);else{const w=this.columnSizes.reduce((y,x)=>Math.max(y,x.height),0);d=u+gs(e.align,this.top,this.bottom-w-e.labels.padding-this._computeTitleHeight())}const p=gs(a,h,h+f);o.textAlign=i.textAlign(pT(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,wp(o,n.text,p,d,s)}_computeTitleHeight(){const e=this.options.title,n=rs(e.font),s=gr(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(Jo(e,this.left,this.right)&&Jo(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],Jo(e,r.left,r.left+r.width)&&Jo(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!cq(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=iq(r,s);r&&!i&&Et(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&Et(n.onHover,[e,s,this],this)}else s&&Et(n.onClick,[e,s,this],this)}}function oq(t,e,n,s,r){const i=aq(s,t,e,n),o=lq(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function aq(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function lq(t,e,n){let s=t;return typeof e.text!="string"&&(s=FT(e,n)),s}function FT(t,e){const n=t.text?t.text.length:0;return e*n}function cq(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var uq={id:"legend",_element:NS,start(t,e,n){const s=t.legend=new NS({ctx:t.ctx,options:n,chart:t});Yi.configure(t,s,n),Yi.addBox(t,s)},stop(t){Yi.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Yi.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(n?0:void 0),d=gr(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const su={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),d=_8(e,u);d<r&&(r=d,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function _r(t,e){return e&&(pn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Kr(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function dq(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function ES(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=rs(e.bodyFont),u=rs(e.titleFont),d=rs(e.footerFont),h=i.length,f=r.length,p=s.length,w=gr(e.padding);let y=w.height,x=0,g=s.reduce((k,_)=>k+_.before.length+_.lines.length+_.after.length,0);if(g+=t.beforeBody.length+t.afterBody.length,h&&(y+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),g){const k=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;y+=p*k+(g-p)*l.lineHeight+(g-1)*e.bodySpacing}f&&(y+=e.footerMarginTop+f*d.lineHeight+(f-1)*e.footerSpacing);let m=0;const b=function(k){x=Math.max(x,n.measureText(k).width+m)};return n.save(),n.font=u.string,gt(t.title,b),n.font=l.string,gt(t.beforeBody.concat(t.afterBody),b),m=e.displayColors?o+2+e.boxPadding:0,gt(s,k=>{gt(k.before,b),gt(k.lines,b),gt(k.after,b)}),m=0,n.font=d.string,gt(t.footer,b),n.restore(),x+=w.width,{width:x,height:y}}function hq(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function fq(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function pq(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let u="center";return s==="center"?u=r<=(a+l)/2?"left":"right":r<=i/2?u="left":r>=o-i/2&&(u="right"),fq(u,t,e,n)&&(u="center"),u}function TS(t,e,n){const s=n.yAlign||e.yAlign||hq(t,n);return{xAlign:n.xAlign||e.xAlign||pq(t,e,n,s),yAlign:s}}function mq(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function gq(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function PS(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,u=r+i,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Ol(o);let w=mq(e,a);const y=gq(e,l,u);return l==="center"?a==="left"?w+=u:a==="right"&&(w-=u):a==="left"?w-=Math.max(d,f)+r:a==="right"&&(w+=Math.max(h,p)+r),{x:ss(w,0,s.width-e.width),y:ss(y,0,s.height-e.height)}}function Xh(t,e,n){const s=gr(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function RS(t){return _r([],Kr(t))}function xq(t,e,n){return vc(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function AS(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const zT={beforeTitle:Wr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Wr,beforeBody:Wr,beforeLabel:Wr,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return wt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Wr,afterBody:Wr,beforeFooter:Wr,footer:Wr,afterFooter:Wr};function Yn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?zT[e].call(n,s):r}class Uy extends bc{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new CT(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=xq(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=Yn(s,"beforeTitle",this,e),i=Yn(s,"title",this,e),o=Yn(s,"afterTitle",this,e);let a=[];return a=_r(a,Kr(r)),a=_r(a,Kr(i)),a=_r(a,Kr(o)),a}getBeforeBody(e,n){return RS(Yn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return gt(e,i=>{const o={before:[],lines:[],after:[]},a=AS(s,i);_r(o.before,Kr(Yn(a,"beforeLabel",this,i))),_r(o.lines,Yn(a,"label",this,i)),_r(o.after,Kr(Yn(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return RS(Yn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=Yn(s,"beforeFooter",this,e),i=Yn(s,"footer",this,e),o=Yn(s,"afterFooter",this,e);let a=[];return a=_r(a,Kr(r)),a=_r(a,Kr(i)),a=_r(a,Kr(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,u;for(l=0,u=n.length;l<u;++l)a.push(dq(this.chart,n[l]));return e.filter&&(a=a.filter((d,h,f)=>e.filter(d,h,f,s))),e.itemSort&&(a=a.sort((d,h)=>e.itemSort(d,h,s))),gt(a,d=>{const h=AS(e.callbacks,d);r.push(Yn(h,"labelColor",this,d)),i.push(Yn(h,"labelPointStyle",this,d)),o.push(Yn(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=su[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=ES(this,s),u=Object.assign({},a,l),d=TS(this.chart,s,u),h=PS(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:h}=Ol(a),{x:f,y:p}=e,{width:w,height:y}=n;let x,g,m,b,k,_;return i==="center"?(k=p+y/2,r==="left"?(x=f,g=x-o,b=k+o,_=k-o):(x=f+w,g=x+o,b=k-o,_=k+o),m=x):(r==="left"?g=f+Math.max(l,d)+o:r==="right"?g=f+w-Math.max(u,h)-o:g=this.caretX,i==="top"?(b=p,k=b-o,x=g-o,m=g+o):(b=p+y,k=b+o,x=g+o,m=g-o),_=b),{x1:x,x2:g,x3:m,y1:b,y2:k,y3:_}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const u=Ml(s.rtl,this.x,this.width);for(e.x=Xh(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",o=rs(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:u}=i,d=rs(i.bodyFont),h=Xh(this,"left",i),f=r.x(h),p=l<d.lineHeight?(d.lineHeight-l)/2:0,w=n.y+p;if(i.usePointStyle){const y={radius:Math.min(u,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},x=r.leftForLtr(f,u)+u/2,g=w+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,K_(e,y,x,g),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,K_(e,y,x,g)}else{e.lineWidth=rt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const y=r.leftForLtr(f,u),x=r.leftForLtr(r.xPlus(f,1),u-2),g=Ol(o.borderRadius);Object.values(g).some(m=>m!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,kp(e,{x:y,y:w,w:u,h:l,radius:g}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),kp(e,{x,y:w+1,w:u-2,h:l-2,radius:g}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(y,w,u,l),e.strokeRect(y,w,u,l),e.fillStyle=o.backgroundColor,e.fillRect(x,w+1,u-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:u,boxPadding:d}=s,h=rs(s.bodyFont);let f=h.lineHeight,p=0;const w=Ml(s.rtl,this.x,this.width),y=function(j){n.fillText(j,w.x(e.x+p),e.y+f/2),e.y+=f+i},x=w.textAlign(o);let g,m,b,k,_,C,S;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,e.x=Xh(this,x,s),n.fillStyle=s.bodyColor,gt(this.beforeBody,y),p=a&&x!=="right"?o==="center"?u/2+d:u+2+d:0,k=0,C=r.length;k<C;++k){for(g=r[k],m=this.labelTextColors[k],n.fillStyle=m,gt(g.before,y),b=g.lines,a&&b.length&&(this._drawColorBox(n,e,k,w,s),f=Math.max(h.lineHeight,l)),_=0,S=b.length;_<S;++_)y(b[_]),f=h.lineHeight;gt(g.after,y)}p=0,f=h.lineHeight,gt(this.afterBody,y),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=Ml(s.rtl,this.x,this.width);for(e.x=Xh(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=rs(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:u,height:d}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:w}=Ol(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+h,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+u-f,l),n.quadraticCurveTo(a+u,l,a+u,l+f),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+u,l+d-w),n.quadraticCurveTo(a+u,l+d,a+u-w,l+d),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+p,l+d),n.quadraticCurveTo(a,l+d,a,l+d-p),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+h),n.quadraticCurveTo(a,l,a+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=su[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=ES(this,e),l=Object.assign({},o,this._size),u=TS(n,e,l),d=PS(e,l,u,n);(r._to!==d.x||i._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=gr(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),ST(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),jT(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const u=this.chart.getDatasetMeta(a);if(!u)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:u.data[l],index:l}}),i=!gp(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!gp(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=su[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}$e(Uy,"positioners",su);var yq={id:"tooltip",_element:Uy,positioners:su,afterInit(t,e,n){n&&(t.tooltip=new Uy({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:zT},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const vq=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function bq(t,e,n,s){const r=t.indexOf(e);if(r===-1)return vq(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const wq=(t,e)=>t===null?null:ss(Math.round(t),0,e);function OS(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Hy extends wc{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(wt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:bq(s,e,nt(n,e),this._addedLabels),wq(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return OS.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}$e(Hy,"id","category"),$e(Hy,"defaults",{ticks:{callback:OS}});function kq(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:u,maxTicks:d,maxDigits:h,includeBounds:f}=t,p=i||1,w=d-1,{min:y,max:x}=e,g=!wt(o),m=!wt(a),b=!wt(u),k=(x-y)/(h+1);let _=$_((x-y)/w/p)*p,C,S,j,N;if(_<1e-14&&!g&&!m)return[{value:y},{value:x}];N=Math.ceil(x/_)-Math.floor(y/_),N>w&&(_=$_(N*_/w/p)*p),wt(l)||(C=Math.pow(10,l),_=Math.ceil(_*C)/C),r==="ticks"?(S=Math.floor(y/_)*_,j=Math.ceil(x/_)*_):(S=y,j=x),g&&m&&i&&b8((a-o)/i,_/1e3)?(N=Math.round(Math.min((a-o)/_,d)),_=(a-o)/N,S=o,j=a):b?(S=g?o:S,j=m?a:j,N=u-1,_=(j-S)/N):(N=(j-S)/_,jf(N,Math.round(N),_/1e3)?N=Math.round(N):N=Math.ceil(N));const P=Math.max(F_(_),F_(S));C=Math.pow(10,wt(l)?P:l),S=Math.round(S*C)/C,j=Math.round(j*C)/C;let L=0;for(g&&(f&&S!==o?(n.push({value:o}),S<o&&L++,jf(Math.round((S+L*_)*C)/C,o,MS(o,k,t))&&L++):S<o&&L++);L<N;++L){const I=Math.round((S+L*_)*C)/C;if(m&&I>a)break;n.push({value:I})}return m&&f&&j!==a?n.length&&jf(n[n.length-1].value,a,MS(a,k,t))?n[n.length-1].value=a:n.push({value:a}):(!m||j===a)&&n.push({value:j}),n}function MS(t,e,{horizontal:n,minRotation:s}){const r=ii(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class _q extends wc{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return wt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=lo(r),u=lo(i);l<0&&u<0?a(0):l>0&&u>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=kq(r,i);return e.bounds==="ticks"&&w8(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return H0(e,this.chart.options.locale,this.options.ticks.format)}}class Wy extends _q{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=qs(e)?e:0,this.max=qs(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=ii(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}$e(Wy,"id","linear"),$e(Wy,"defaults",{ticks:{callback:gT.formatters.numeric}});const um={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},es=Object.keys(um);function IS(t,e){return t-e}function DS(t,e){if(wt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),qs(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(vp(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function LS(t,e,n,s){const r=es.length;for(let i=es.indexOf(t);i<r-1;++i){const o=um[es[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return es[i]}return es[r-1]}function Sq(t,e,n,s,r){for(let i=es.length-1;i>=es.indexOf(n);i--){const o=es[i];if(um[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return es[n?es.indexOf(n):0]}function jq(t){for(let e=es.indexOf(t)+1,n=es.length;e<n;++e)if(um[es[e]].common)return es[e]}function $S(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=U0(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function Cq(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function FS(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:Cq(t,s,r,n)}class Cp extends wc{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new FW._date(e.adapters.date);r.init(n),xu(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:DS(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!a&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=qs(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=qs(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=C8(r,i,o);return this._unit=n.unit||(s.autoSkip?LS(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):Sq(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:jq(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),FS(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=ss(n,0,o),s=ss(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||LS(i.minUnit,n,s,this._getLabelCapacity(n)),a=nt(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,u=vp(l)||l===!0,d={};let h=n,f,p;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const w=r.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,a,o),p++)$S(d,f,w);return(f===s||r.bounds==="ticks"||p===1)&&$S(d,f,w),Object.keys(d).sort(IS).map(y=>+y)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return Et(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,u=this._majorUnit,d=l&&a[l],h=u&&a[u],f=s[n],p=u&&h&&f&&f.major;return this._adapter.format(e,r||(p?h:d))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=ii(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,FS(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(DS(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return dT(e.sort(IS))}}$e(Cp,"id","time"),$e(Cp,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Jh(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Ly(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Ly(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const u=o-i;return u?a+(l-a)*(e-i)/u:a}class zS extends Cp{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Jh(n,this.min),this._tableRange=Jh(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,u,d;for(o=0,a=e.length;o<a;++o)u=e[o],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)d=r[o+1],l=r[o-1],u=r[o],Math.round((d+l)/2)!==u&&i.push({time:u,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Jh(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Jh(this._table,s*this._tableRange+this._minPos,!0)}}$e(zS,"id","timeseries"),$e(zS,"defaults",Cp.defaults);Rr.register(nu,Tf,Hy,vl,Fy,Cf,uq,Wy,yq);const Fn={pending:"rgba(234, 179, 8, 0.7)",rejected:"rgba(239, 68, 68, 0.7)",returned:"rgba(249, 115, 22, 0.7)",submitted:"rgba(59, 130, 246, 0.7)",accepted:"rgba(34, 197, 94, 0.7)"},Nq=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}];function Eq(t){const e=t-4,n=t+1,s=[];for(let r=e;r<=n;r+=1)s.push(r);return s}function In({icon:t,label:e,value:n,helper:s,accentClass:r,onClick:i}){const o=!!i;return c.jsxs(zt,{className:`p-4 ${o?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:i,role:o?"button":void 0,tabIndex:o?0:void 0,onKeyDown:o?a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),i==null||i())}:void 0,children:[c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("div",{className:`h-10 w-10 rounded-xl flex items-center justify-center ${r}`,children:c.jsx(t,{size:18})}),c.jsx("div",{className:"text-2xl font-semibold",children:n})]}),c.jsx("div",{className:"mt-2 text-xs text-black/55 dark:text-white/60",children:e}),s?c.jsx("div",{className:"text-xs text-black/45 dark:text-white/55",children:s}):null]})}function el({title:t,children:e}){return c.jsxs(St,{className:"h-full",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:t})}),c.jsx(Qt,{children:c.jsx("div",{className:"h-[260px]",children:e})})]})}function BT({title:t,subtitle:e,children:n,defaultOpen:s=!1}){const[r,i]=v.useState(s);return c.jsxs(zt,{className:"p-3",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>i(o=>!o),"aria-expanded":r,children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:t}),e?c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:e}):null]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:r?"Hide":"View"}),c.jsx(ns,{size:16,className:`transition-transform ${r?"rotate-180":""}`})]})]}),r?c.jsx("div",{className:"mt-3 space-y-2 text-xs text-black/60 dark:text-white/65",children:n}):null]})}function tl({type:t,data:e,options:n}){const s=ve.useRef(null);return ve.useEffect(()=>{if(!s.current)return;const r=Rr.getChart(s.current);r&&r.destroy();const i=new Rr(s.current,{type:t,data:e,options:n});return()=>i.destroy()},[e,n,t]),c.jsx("canvas",{ref:s})}function Tq(t){const e=Number(t)||0;return e>=80?"bg-emerald-500/80":e>=60?"bg-amber-500/80":"bg-rose-500/80"}function BS(t){if(!t)return"--";const e=Vs(t);return e?e.toLocaleDateString():t}function Pq({mode:t,period:e}){if(!e)return"Current period";if(t==="month"){const[n,s]=e.split("-");return new Date(Number(n),Number(s)-1,1).toLocaleString(void 0,{month:"long",year:"numeric"})}if(t==="year")return e;if(t==="range"){const[n,s]=e.split(",");return`${n} to ${s}`}return e}function US(t){return{labels:["Pending","Rejected","Returned","Submitted","Accepted"],datasets:[{data:[t.pending,t.rejected,t.returned,t.submitted,t.accepted],backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]}}function Zh(t){const e={Pending:0,Rejected:0,Returned:0,"Submitted to Sales":0,Accepted:0};return t.forEach(n=>{const s=n.status||"";s.includes("Pending")||s==="Critique"||s==="Raw"?e.Pending+=1:s==="Rejected"||s==="Editing"?e.Rejected+=1:s==="Returned"?e.Returned+=1:s==="Submitted to Sales"?e["Submitted to Sales"]+=1:(s==="Accepted"||s==="Done")&&(e.Accepted+=1)}),e}function Wc(t){return t.length?c.jsx("div",{className:"space-y-3",children:t.map(e=>c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:["#",e.task_number," - ",e.brand]}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[e.status," - ",e.videographer||"Unassigned"]})]}),c.jsxs("div",{className:"text-right text-xs text-black/50 dark:text-white/60",children:[c.jsxs("div",{children:["Film: ",BS(e.filming_deadline)]}),c.jsxs("div",{children:["Due: ",BS(e.submission_date)]})]})]})},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No tasks found."})}function ef(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:(e.versions||[]).map(n=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsx("div",{className:"mt-1 text-black/50 dark:text-white/60",children:(n.lifecycle||[]).map(s=>`${s.stage} (${s.at||""})`).join(" -> ")})]},n.version))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No versions found."})}function Bg(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:e.rejectionEvents.map((n,s)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsxs("div",{className:"text-black/50 dark:text-white/60",children:[n.event.rejection_class||"Unclassified"," - ",n.event.rejection_comments||"No notes"]})]},`${e.task_number}-${s}`))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection events."})}function Rq(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No pending reviews."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,versions:[]}),n[r].versions.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(BT,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.versions.map(s=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Waiting: ",s.waitingHours??"--"," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]})]},`${n.task.task_number}-${s.version.version}`))},n.task.task_number))})}function Aq(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No response data."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,responses:[]}),n[r].responses.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(BT,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.responses.map((s,r)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Decision: ",s.decision]}),c.jsxs("div",{children:["Response: ",s.responseHours," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]}),c.jsxs("div",{children:["Reviewed: ",s.reviewTime?s.reviewTime.toLocaleString():"--"]}),s.rejectionClass?c.jsxs("div",{children:["Class: ",s.rejectionClass]}):null,s.comments?c.jsxs("div",{children:["Notes: ",s.comments]}):null]},`${n.task.task_number}-${r}`))},n.task.task_number))})}function Oq(){const t=new Date,e=t.getFullYear(),[n,s]=v.useState("month"),[r,i]=v.useState(e),[o,a]=v.useState(t.getMonth()+1),[l,u]=v.useState(""),[d,h]=v.useState(""),[f,p]=v.useState(!1),[w,y]=v.useState(null),[x,g]=v.useState(null),m=Eq(e),b=v.useMemo(()=>m.map(pe=>({value:pe,label:String(pe)})),[m]),k=v.useMemo(()=>[{value:"month",label:"Month"},{value:"year",label:"Year"},{value:"range",label:"Range"}],[]),_=v.useMemo(()=>n==="month"?`${r}-${String(o).padStart(2,"0")}`:n==="year"?`${r}`:n==="range"&&l&&d?`${l},${d}`:"",[n,l,d,o,r]),C=Kt({queryKey:["video-critique","dashboard",n,_],queryFn:()=>x4({mode:n,period:_})}),S=C.data||{},j=S.tasks||[],N=S.summary||{},P=S.pie||{},L=S.reviewer||{},I=S.summary_videographers&&Object.keys(S.summary_videographers).length?S.summary_videographers:h2(j),O=S.videographers||{},$=v.useMemo(()=>m2(j),[j]),D=v.useMemo(()=>Oi(j),[j]),F=v.useMemo(()=>f2(j),[j]),q=v.useMemo(()=>p2(j),[j]),E=v.useMemo(()=>({labels:["Completed","Not Completed"],datasets:[{data:[P.completed||0,P.not_completed||0],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}),[P.completed,P.not_completed]),R=v.useMemo(()=>{const pe=$.tasksStarted||0,H=P.completed||0,ye=Math.max(pe-H,0);return{labels:["Completed","Not Completed"],datasets:[{data:[H,ye],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}},[$.tasksStarted,P.completed]),V=v.useMemo(()=>US(D),[D]),K=v.useMemo(()=>Object.entries(I).sort((pe,H)=>H[1].total-pe[1].total),[I]),Q=!!w,re=!!x,ee=x?I[x]:null,z=x?O[x]||[]:[],A=v.useMemo(()=>Zu(j,"pending"),[j]),Y=v.useMemo(()=>Zu(j,"submitted"),[j]),B=v.useMemo(()=>xg(j,"hod"),[j]),J=v.useMemo(()=>xg(j,"hos"),[j]),be=v.useMemo(()=>{const pe={};let H=0,ye=0;j.forEach(ie=>{(ie.versions||[]).forEach(Se=>{const oe=Se.lifecycle||[];if(!oe.length)return;const W=oe[oe.length-1],ke=((W==null?void 0:W.stage)||"").toLowerCase();(ke==="accepted"||ke==="done")&&(H+=1),(ke==="rejected"||ke==="editing"||ke==="returned")&&(ye+=1),oe.forEach(Re=>{const Oe=(Re.stage||"").toLowerCase();if(Oe==="rejected"||Oe==="editing"||Oe==="returned"){const ae=Re.rejection_class||"Unclassified";pe[ae]=(pe[ae]||0)+1}})})});const X=H+ye,ue=X?(H/X*100).toFixed(1):"0",ce=X?(ye/X*100).toFixed(1):"0",de=Object.entries(pe).sort((ie,Se)=>Se[1]-ie[1]);return{acceptedPct:ue,rejectedPct:ce,classes:de,totalRejections:ye}},[j]);return C.isLoading?c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Video Critique Dashboard"})}),c.jsx(Qt,{children:c.jsx(Ve,{text:"Loading dashboard",className:"text-sm text-black/60 dark:text-white/65"})})]}):c.jsxs("div",{className:"flex flex-col gap-4 min-h-0 pb-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-1",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Video Critique Dashboard"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:Pq({mode:n,period:_})})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(ot,{value:n,options:k,onChange:s,className:"sm:w-[200px]"}),n==="month"?c.jsxs(c.Fragment,{children:[c.jsx(ot,{value:o,options:Nq,onChange:a,className:"sm:w-[200px]"}),c.jsx(ot,{value:r,options:b,onChange:i,className:"sm:w-[200px]"})]}):null,n==="year"?c.jsx(ot,{value:r,options:b,onChange:i,className:"sm:w-[200px]"}):null,n==="range"?c.jsxs(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!0),children:[c.jsx(LM,{size:16,className:"mr-2"}),"Pick Range"]}):null,c.jsxs(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>C.refetch(),children:[c.jsx(qM,{size:16,className:"mr-2"}),"Refresh"]})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(In,{icon:xf,label:"Total Tasks",value:N.total||0,helper:"Tasks created",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>y("total_created")}),c.jsx(In,{icon:yh,label:"Assigned",value:N.assigned||0,helper:"Assigned to videographers",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>y("total_assigned")}),c.jsx(In,{icon:vh,label:"Tasks Started",value:$.tasksStarted||0,helper:"Filming date passed",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>y("total_started")}),c.jsx(In,{icon:bh,label:"Late Tasks",value:$.lateTasks||0,helper:"Submission overdue",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>y("total_late")}),c.jsx(In,{icon:xf,label:"Uploads",value:N.uploads||0,helper:"Total versions",accentClass:"bg-purple-500/10 text-purple-700 dark:text-purple-200",onClick:()=>y("upload_ratio")}),c.jsx(In,{icon:yh,label:"Completed",value:P.completed||0,helper:"Accepted or done",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>y("completed")})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(In,{icon:vh,label:"Pending HOD",value:$.pendingHOD||0,helper:"Versions in critique",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>y("pending_hod")}),c.jsx(In,{icon:vh,label:"Pending HOS",value:$.pendingHOS||0,helper:"Submitted to sales",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>y("pending_hos")}),c.jsx(In,{icon:bh,label:"Rejected by HOD",value:$.rejectionsByHOD||0,helper:"Editing / rejected",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>y("rejected_hod")}),c.jsx(In,{icon:bh,label:"Rejected by HOS",value:$.rejectionsByHOS||0,helper:"Returned",accentClass:"bg-orange-500/10 text-orange-700 dark:text-orange-200",onClick:()=>y("rejected_hos")}),c.jsx(In,{icon:xf,label:"Upload Ratio",value:$.uploadRatio||"0",helper:"Avg versions/task",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>y("upload_ratio")}),c.jsx(In,{icon:yh,label:"Acceptance Rate",value:`${N.accepted_pct||0}%`,helper:"Accepted vs reviewed",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>y("acceptance_rate")})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsx(el,{title:"Completion Overview",children:c.jsx(tl,{type:"doughnut",data:E,options:{maintainAspectRatio:!1}})}),c.jsx(el,{title:"Started vs Completed",children:c.jsx(tl,{type:"doughnut",data:R,options:{maintainAspectRatio:!1}})}),c.jsx(el,{title:"Status Distribution",children:c.jsx(tl,{type:"bar",data:V,options:{maintainAspectRatio:!1,indexAxis:"y",scales:{x:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}},y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}}}}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Reviewer Performance"})}),c.jsx(Qt,{children:c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Avg response time"}),c.jsx("span",{className:"font-semibold",children:L.avg_response_display||"0 hrs"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Handled"}),c.jsx("span",{className:"font-semibold",children:L.handled||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Accepted by HOS"}),c.jsx("span",{className:"font-semibold",children:L.accepted||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Success rate"}),c.jsxs("span",{className:"font-semibold",children:[L.handled_percent||0,"%"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Pending reviews"}),c.jsx("span",{className:"font-semibold",children:F.count||0})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(se,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>y("response_time"),children:"View response times"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>y("pending_reviews"),children:"View pending reviews"})]})]})})]}),c.jsxs(St,{className:"lg:col-span-2",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Videographers"})}),c.jsx(Qt,{children:K.length?c.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:K.map(([pe,H])=>c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>g(pe),children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:pe}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[H.total," tasks"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-lg font-semibold",children:[H.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]})]}),c.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-black/60 dark:text-white/60",children:[c.jsxs("div",{children:["Started: ",H.started]}),c.jsxs("div",{children:["Late: ",H.late]}),c.jsxs("div",{children:["Completed: ",H.completed]}),c.jsxs("div",{children:["Uploads: ",H.uploads]})]}),c.jsx("div",{className:"mt-3 h-2 rounded-full bg-black/10 dark:bg-white/10 overflow-hidden",children:c.jsx("div",{className:`h-full ${Tq(H.accepted_pct)}`,style:{width:`${H.accepted_pct}%`}})})]},pe))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No videographer data."})})]})]}),c.jsxs(Cs,{open:Q,onClose:()=>y(null),title:"Details",maxWidth:"820px",children:[w==="total_created"?Wc(j):null,w==="total_assigned"?Wc(j.filter(pe=>pe.status!=="Not assigned yet")):null,w==="total_started"?Wc(j.filter(pe=>{const H=Vs(pe.filming_deadline||"");if(!H)return!1;const ye=new Date;return ye.setHours(0,0,0,0),H<=ye})):null,w==="total_late"?Wc(j.filter(yg)):null,w==="completed"?Wc(j.filter(pe=>pe.status==="Accepted"||pe.status==="Done")):null,w==="pending_hod"?ef(A.map(pe=>({...pe.task,versions:[pe.version]}))):null,w==="pending_hos"?ef(Y.map(pe=>({...pe.task,versions:[pe.version]}))):null,w==="rejected_hod"?Bg(B):null,w==="rejected_hos"?Bg(J):null,w==="upload_ratio"?ef(j.filter(pe=>{var H;return(H=pe.versions)==null?void 0:H.length})):null,w==="acceptance_rate"?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(zt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-emerald-600",children:[be.acceptedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]}),c.jsxs(zt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-red-600",children:[be.rejectedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Rejection"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/70 dark:text-white/70 mb-2",children:"Rejection classes"}),be.classes.length?c.jsx("div",{className:"space-y-2",children:be.classes.map(([pe,H])=>c.jsx("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:pe}),c.jsx("span",{children:H})]})},pe))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection data."})]})]}):null,w==="response_time"?Aq(q):null,w==="pending_reviews"?Rq(F.reviews||[]):null]}),c.jsx(Cs,{open:re,onClose:()=>g(null),title:x?`${x} Details`:"Videographer",maxWidth:"980px",children:x&&ee?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(zt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold",children:[ee.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance rate"})]}),c.jsxs(zt,{className:"p-4 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:ee.late}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Late tasks"})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[c.jsx(In,{icon:vh,label:"Pending",value:Oi(z).pending,accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200"}),c.jsx(In,{icon:bh,label:"Rejected",value:Oi(z).rejected,accentClass:"bg-red-500/10 text-red-700 dark:text-red-200"}),c.jsx(In,{icon:yh,label:"Accepted",value:Oi(z).accepted,accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200"})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(el,{title:"Version Distribution",children:c.jsx(tl,{type:"bar",data:US(Oi(z)),options:{maintainAspectRatio:!1,indexAxis:"y"}})}),c.jsx(el,{title:"All Tasks Status",children:c.jsx(tl,{type:"pie",data:{labels:Object.keys(Zh(z)),datasets:[{data:Object.values(Zh(z)),backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(el,{title:"Overdue Tasks",children:c.jsx(tl,{type:"pie",data:{labels:Object.keys(Zh(z.filter(yg))),datasets:[{data:Object.values(Zh(z.filter(yg))),backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})}),c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Failure Analysis"})}),c.jsx(Qt,{children:Bg(xg(z,"hod"))})]})]}),c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Version History"})}),c.jsx(Qt,{children:ef(z)})]})]}):null}),c.jsx(Cs,{open:f,onClose:()=>p(!1),title:"Select date range",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Start date"}),c.jsx("input",{type:"date",value:l,onChange:pe=>u(pe.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"End date"}),c.jsx("input",{type:"date",value:d,onChange:pe=>h(pe.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!1),children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:()=>p(!1),children:"Apply"})]})]})})]})}function Mq(){const[t,e]=v.useState("chat");return c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 py-1",children:[c.jsx(se,{variant:t==="chat"?"default":"ghost",className:`rounded-2xl mmg-tab-btn ${t==="chat"?"mmg-tab-btn-active":""}`,onClick:()=>e("chat"),children:"Chat"}),c.jsx(se,{variant:t==="dashboard"?"default":"ghost",className:`rounded-2xl mmg-tab-btn ${t==="dashboard"?"mmg-tab-btn-active":""}`,onClick:()=>e("dashboard"),children:"Dashboard"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="chat"?"h-full":"hidden","aria-hidden":t!=="chat",children:c.jsx(TH,{})}),c.jsx("div",{className:t==="dashboard"?"h-full overflow-y-auto px-2 py-1":"hidden","aria-hidden":t!=="dashboard",children:c.jsx(Oq,{})})]})]})}function Iq(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function HS(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function WS(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function Dq({locations:t,locationsQuery:e}){var b;const[n,s]=v.useState(null),[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),[d,h]=v.useState(""),f=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.display_type)||"";S&&_.add(S)}),[{value:"",label:"All display types"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),p=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.company_schema)||"";S&&_.add(S)}),[{value:"",label:"All companies"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),w=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.series)||"";S&&_.add(S)}),[{value:"",label:"All series"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),y=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=r.trim().toLowerCase();return k.filter(S=>!(o&&((S==null?void 0:S.display_type)||"")!==o||l&&((S==null?void 0:S.company_schema)||"")!==l||d&&((S==null?void 0:S.series)||"")!==d||_&&!Iq(S).includes(_))).map((S,j)=>({id:(S==null?void 0:S.location_key)||`location-${j}`,raw:S}))},[t,o,l,d,r]),x=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;k.forEach(j=>{Object.keys(j||{}).forEach(N=>_.add(N))});const C=["display_name","location_key","display_type","company_schema","series","city","area","upload_fee","height","width","number_of_faces","spot_duration","loop_duration","sov_percent","eligible_for_proposals","eligible_for_mockups"],S=Array.from(_).filter(j=>!C.includes(j)).sort();return[...C.filter(j=>_.has(j)),...S]},[t]),g=v.useMemo(()=>n?Object.entries(n):[],[n]),m=n||null;return c.jsxs(c.Fragment,{children:[c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Gt,{className:"space-y-1",children:[c.jsx(Yt,{children:"Locations"}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[y.length," location",y.length===1?"":"s"]})]}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-4 md:shrink-0",children:[c.jsx(jo,{value:r,onChange:k=>i(k.target.value),className:"w-full",placeholder:"Search locations..."}),c.jsx(ot,{value:o,options:f,onChange:a,className:"w-full"}),c.jsx(ot,{value:l,options:p,onChange:u,className:"w-full"}),c.jsx(ot,{value:d,options:w,onChange:h,className:"w-full"})]}),e.isLoading?c.jsx(Ve,{text:"Loading locations",className:"text-sm text-black/60 dark:text-white/65"}):e.isError?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:((b=e.error)==null?void 0:b.message)||"Failed to load locations."}):y.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsxs("tr",{children:[x.map(k=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:HS(k)},k)),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:y.map(k=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[x.map(_=>{var S;const C=WS((S=k.raw)==null?void 0:S[_]);return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:C},`${k.id}-${_}`)}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>s(k.raw),children:"Edit"})})]},k.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No locations found."})]})]}),c.jsx(Cs,{open:!!n,onClose:()=>s(null),title:"Edit location",maxWidth:"560px",children:m?c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ee,{label:"Location Key",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.location_key||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_name||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Display Type",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_type||"",disabled:!0,readOnly:!0})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Company",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.company_schema||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Series",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.series||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"City",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.city||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Area",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.area||"",disabled:!0,readOnly:!0})})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>s(null),children:"Close"}),c.jsx(se,{className:"rounded-2xl",disabled:!0,children:"Save"})]}),c.jsxs("div",{className:"pt-2",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60 mb-2",children:"All fields"}),c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 divide-y divide-black/5 dark:divide-white/10",children:g.map(([k,_])=>c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 px-3 py-2 text-sm",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/45 dark:text-white/55 md:w-56",children:HS(k)}),c.jsx("div",{className:"text-black/80 dark:text-white/85 break-all",children:WS(_)})]},k))})]})]}):null})]})}function Lq(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function $q(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function Fq(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function dm({title:t,items:e,itemsQuery:n,itemLabel:s="item",searchPlaceholder:r="Search...",emptyMessage:i="No items found.",preferredColumns:o=[],stringKey:a="value"}){var x;const[l,u]=v.useState(""),d=v.useMemo(()=>(Array.isArray(e)?e:[]).map(m=>m==null?{[a]:""}:typeof m=="string"||typeof m=="number"||typeof m=="boolean"?{[a]:m}:m),[e,a]),h=v.useMemo(()=>{const g=new Set;d.forEach(b=>{Object.keys(b||{}).forEach(k=>g.add(k))});const m=Array.from(g).filter(b=>!o.includes(b)).sort();return[...o.filter(b=>g.has(b)),...m]},[d,o]),f=v.useMemo(()=>{const g=l.trim().toLowerCase();return d.filter(b=>g?Lq(b).includes(g):!0).map((b,k)=>({id:(b==null?void 0:b.id)??(b==null?void 0:b[a])??`row-${k}`,raw:b}))},[d,l,a]),p=n==null?void 0:n.isLoading,w=n==null?void 0:n.isError,y=((x=n==null?void 0:n.error)==null?void 0:x.message)||"Failed to load data.";return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Gt,{className:"space-y-1",children:[c.jsx(Yt,{children:t}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[f.length," ",s,f.length===1?"":"s"]})]}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsx(jo,{value:l,onChange:g=>u(g.target.value),className:"w-full md:shrink-0",placeholder:r}),p?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):w?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:y}):f.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsx("tr",{children:h.map(g=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:$q(g)},g))})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:f.map(g=>c.jsx("tr",{className:"text-black/80 dark:text-white/85",children:h.map(m=>{var b;return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:Fq((b=g.raw)==null?void 0:b[m])},`${g.id}-${m}`)})},g.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:i})]})]})}function zq({networks:t,networksQuery:e}){return c.jsx(dm,{title:"Networks",items:t,itemsQuery:e,itemLabel:"network",searchPlaceholder:"Search networks...",emptyMessage:"No networks found.",preferredColumns:["network_name","name","company","company_schema","is_active","location_count"]})}function Bq({assetTypes:t,assetTypesQuery:e}){return c.jsx(dm,{title:"Asset Types",items:t,itemsQuery:e,itemLabel:"type",searchPlaceholder:"Search asset types...",emptyMessage:"No asset types found.",preferredColumns:["name","type_key","company","network_id","is_active","location_count"]})}function Uq({networkAssets:t,networkAssetsQuery:e}){return c.jsx(dm,{title:"Network Assets",items:t,itemsQuery:e,itemLabel:"asset",searchPlaceholder:"Search assets...",emptyMessage:"No network assets found.",preferredColumns:["display_name","asset_key","location_key","network_id","type_id","company","is_active"]})}function Hq({packages:t,packagesQuery:e}){return c.jsx(dm,{title:"Packages",items:t,itemsQuery:e,itemLabel:"package",searchPlaceholder:"Search packages...",emptyMessage:"No packages found.",preferredColumns:["name","company","is_active"]})}const Wq=[{key:"networks",label:"Networks",disabled:!1},{key:"asset-types",label:"Asset Types",disabled:!1},{key:"network-assets",label:"Network Assets",disabled:!1},{key:"packages",label:"Packages",disabled:!1},{key:"locations",label:"Locations",disabled:!1}];function Vc(t,e=[]){if(Array.isArray(t))return t;for(const n of e)if(Array.isArray(t==null?void 0:t[n]))return t[n];return Array.isArray(t==null?void 0:t.data)?t.data:[]}function Vq(){const{user:t}=fi(),[e,n]=v.useState("networks");if(!Rd(t))return c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Restricted"})}),c.jsx(Qt,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to asset management."})]});const s=Kt({queryKey:["asset-management","networks"],queryFn:()=>N4(),enabled:e==="networks"}),r=Kt({queryKey:["asset-management","asset-types"],queryFn:()=>E4(),enabled:e==="asset-types"}),i=Kt({queryKey:["asset-management","network-assets"],queryFn:()=>T4(),enabled:e==="network-assets"}),o=Kt({queryKey:["asset-management","packages"],queryFn:()=>R4(),enabled:e==="packages"}),a=Kt({queryKey:["asset-management","locations"],queryFn:()=>P4(),enabled:e==="locations"}),l=v.useMemo(()=>Vc(s.data,["networks"]),[s.data]),u=v.useMemo(()=>Vc(r.data,["asset_types","types"]),[r.data]),d=v.useMemo(()=>Vc(i.data,["network_assets","assets"]),[i.data]),h=v.useMemo(()=>Vc(o.data,["packages"]),[o.data]),f=v.useMemo(()=>Vc(a.data,["locations"]),[a.data]);return c.jsxs("div",{className:"flex h-full min-h-0 min-w-0 flex-col gap-4",children:[c.jsx("div",{className:"flex items-center gap-2 overflow-x-auto py-1",children:Wq.map(p=>c.jsx(se,{variant:e===p.key?"default":"ghost",onClick:()=>n(p.key),className:`rounded-2xl shrink-0 mmg-tab-btn ${e===p.key?"mmg-tab-btn-active":""}`,disabled:p.disabled,title:p.disabled?"Coming soon":void 0,children:p.label},p.key))}),c.jsxs("div",{className:"flex-1 min-h-0 min-w-0",children:[e==="networks"?c.jsx("div",{className:"h-full",children:c.jsx(zq,{networks:l,networksQuery:s})}):null,e==="asset-types"?c.jsx("div",{className:"h-full",children:c.jsx(Bq,{assetTypes:u,assetTypesQuery:r})}):null,e==="network-assets"?c.jsx("div",{className:"h-full",children:c.jsx(Uq,{networkAssets:d,networkAssetsQuery:i})}):null,e==="packages"?c.jsx("div",{className:"h-full",children:c.jsx(Hq,{packages:h,packagesQuery:o})}):null,e==="locations"?c.jsx("div",{className:"h-full",children:c.jsx(Dq,{locations:f,locationsQuery:a})}):null]})]})}function qq({children:t}){const{user:e,authReady:n,session:s,pendingAccess:r,logout:i}=fi(),o=uc();return!n||s&&!e?(console.log("[ProtectedRoute] Waiting for auth",{authReady:n,hasSession:!!s,hasUser:!!e}),null):(console.log("[ProtectedRoute] Auth ready, rendering children",{user:e==null?void 0:e.email}),r?c.jsx(PN,{email:r.email,message:r.message,onSignOut:i}):e?t:c.jsx(mf,{to:"/login",replace:!0,state:{from:o.pathname}}))}function Kq(){const t="mmg-brand-theme",[e,n]=v.useState("none");v.useEffect(()=>{if(typeof window>"u")return;const i=window.localStorage.getItem(t)||"none";n(i),i==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",i)},[]);const s=r=>{n(r),typeof window<"u"&&window.localStorage.setItem(t,r),r==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",r)};return c.jsx("div",{className:"h-full min-h-0",children:c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Settings"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto pt-1 text-sm text-black/60 dark:text-white/65 space-y-4",children:[c.jsxs(zt,{className:"flex items-center justify-between p-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle dark / light mode"})]}),c.jsx(RN,{})]}),c.jsxs(zt,{className:"space-y-3 p-4",children:[c.jsx("div",{className:"flex items-center justify-between gap-4",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Color theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Choose a color palette that layers on top of light / dark mode."})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2",children:[c.jsx("button",{type:"button",onClick:()=>s("none"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="none"?"border-black/60 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:c.jsx("span",{className:"font-medium",children:"System default"})}),c.jsxs("button",{type:"button",onClick:()=>s("blue"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="blue"?"border-blue-500/80 bg-blue-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Blue"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#007AFF]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("green"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="green"?"border-emerald-500/80 bg-emerald-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Green"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#0F806B]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("orange"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="orange"?"border-orange-500/80 bg-orange-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Orange"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#FF7900]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("gold"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="gold"?"border-amber-500/80 bg-amber-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Gold"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#CA9E2C]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("brand"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="brand"?"border-black/70 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Brand Theme"}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#000000]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#007AFF]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#CA9E2C]"})]})]})]})]})]})]})})}function Gq(){return c.jsxs(qO,{children:[c.jsx(Dn,{path:"/",element:c.jsx(mf,{to:"/login",replace:!0})}),c.jsx(Dn,{path:"/login",element:c.jsx(_5,{})}),c.jsx(Dn,{path:"/auth/callback",element:c.jsx(S5,{})}),c.jsxs(Dn,{path:"/app",element:c.jsx(qq,{children:c.jsx($4,{})}),children:[c.jsx(Dn,{index:!0,element:c.jsx(mf,{to:"chat",replace:!0})}),c.jsx(Dn,{path:"chat",element:c.jsx(uU,{})}),c.jsx(Dn,{path:"video-critique",element:c.jsx(Mq,{})}),c.jsx(Dn,{path:"mockup",element:c.jsx(LU,{})}),c.jsx(Dn,{path:"proposals",element:c.jsx(ZU,{})}),c.jsx(Dn,{path:"notifications",element:c.jsx(EH,{})}),c.jsx(Dn,{path:"admin",element:c.jsx(CH,{})}),c.jsx(Dn,{path:"asset-management",element:c.jsx(Vq,{})}),c.jsx(Dn,{path:"settings",element:c.jsx(Kq,{})})]}),c.jsx(Dn,{path:"*",element:c.jsx(mf,{to:"/login",replace:!0})})]})}function Yq(){if(!(typeof window>"u"))try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=e.createOscillator(),s=e.createGain();n.type="sine",n.frequency.value=740,s.gain.value=.15,n.connect(s),s.connect(e.destination),n.start(),s.gain.exponentialRampToValueAtTime(.001,e.currentTime+.25),n.stop(e.currentTime+.3),n.onended=()=>{e.close()}}catch{}}function Qq(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?"":e.toLocaleString()}function Xq({children:t}){const[e,n]=v.useState([]),[s,r]=v.useState(!0),[i,o]=v.useState([]),a=v.useRef(new Set),l=v.useRef(!1),u=v.useRef(new Map),d=v.useCallback(async()=>{r(!0);const b=await qB();n(Array.isArray(b)?b:[]),r(!1)},[]),h=v.useCallback(async()=>{await GB(),n([])},[]),f=v.useCallback(async b=>{b&&(await YB(b),n(k=>k.filter(_=>_.id!==b)))},[]),p=v.useCallback(async b=>{b&&(await QB(b),n(k=>k.map(_=>_.id===b?{..._,read:!0}:_)))},[]),w=v.useCallback(async b=>{const k=await KB(b);return n(_=>[k,..._]),k},[]),y=v.useCallback(b=>{o(_=>_.filter(C=>C.id!==b));const k=u.current.get(b);k&&(clearTimeout(k),u.current.delete(b))},[]),x=v.useCallback(b=>{if(!(b!=null&&b.id))return;o(_=>[..._,{id:b.id,notification:b}]);const k=setTimeout(()=>y(b.id),4200);u.current.set(b.id,k)},[y]);v.useEffect(()=>{d()},[d]),v.useEffect(()=>{if(!l.current){e.forEach(k=>a.current.add(k.id)),l.current=!0;return}const b=e.filter(k=>k.id&&!a.current.has(k.id));b.length&&(Yq(),b.forEach(k=>{a.current.add(k.id),x(k)}))},[e,x]),v.useEffect(()=>{if(typeof window>"u")return;const b=k=>{k.key===XB&&d()};return window.addEventListener("storage",b),()=>window.removeEventListener("storage",b)},[d]),v.useEffect(()=>{if(!(typeof window>"u"))return window.mmgNotify=b=>w(b),window.mmgNotifications={add:b=>w(b),clear:h,dismiss:f,markRead:p},()=>{delete window.mmgNotify,delete window.mmgNotifications}},[w,h,f,p]);const g=v.useMemo(()=>e.filter(b=>!b.read).length,[e]),m=v.useMemo(()=>({notifications:e,loading:s,unreadCount:g,toasts:i,addNotification:w,clearAll:h,dismissNotification:f,markRead:p,dismissToast:y,formatTime:Qq}),[e,s,g,i,w,h,f,p,y]);return c.jsx(r2.Provider,{value:m,children:t})}const Jq="mmg-brand-theme";if(typeof window<"u"){const t=window.localStorage.getItem(Jq);t&&t!=="none"?document.body.setAttribute("data-brand-theme",t):document.body.removeAttribute("data-brand-theme"),window.addEventListener("wheel",e=>{const n=e.target;n instanceof HTMLInputElement&&n.type==="number"&&n===document.activeElement&&e.preventDefault()},{passive:!1})}const Zq=new NM({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});Ug.createRoot(document.getElementById("root")).render(c.jsx(ve.StrictMode,{children:c.jsx(ZO,{attribute:"class",defaultTheme:"light",enableSystem:!1,children:c.jsx(EM,{client:Zq,children:c.jsx(w5,{children:c.jsx(Xq,{children:c.jsx(YO,{children:c.jsx(Gq,{})})})})})})}));
