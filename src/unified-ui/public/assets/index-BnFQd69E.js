var wE=Object.defineProperty;var av=t=>{throw TypeError(t)};var _E=(t,e,n)=>e in t?wE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ee=(t,e,n)=>_E(t,typeof e!="symbol"?e+"":e,n),Ff=(t,e,n)=>e.has(t)||av("Cannot "+n);var R=(t,e,n)=>(Ff(t,e,"read from private field"),n?n.call(t):e.get(t)),fe=(t,e,n)=>e.has(t)?av("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),se=(t,e,n,s)=>(Ff(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n),Pe=(t,e,n)=>(Ff(t,e,"access private method"),n);var Ru=(t,e,n,s)=>({set _(r){se(t,e,r,n)},get _(){return R(t,e,s)}});function kE(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function R_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var A_={exports:{}},Qh={},O_={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tu=Symbol.for("react.element"),SE=Symbol.for("react.portal"),jE=Symbol.for("react.fragment"),CE=Symbol.for("react.strict_mode"),NE=Symbol.for("react.profiler"),EE=Symbol.for("react.provider"),PE=Symbol.for("react.context"),RE=Symbol.for("react.forward_ref"),AE=Symbol.for("react.suspense"),OE=Symbol.for("react.memo"),TE=Symbol.for("react.lazy"),ov=Symbol.iterator;function ME(t){return t===null||typeof t!="object"?null:(t=ov&&t[ov]||t["@@iterator"],typeof t=="function"?t:null)}var T_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M_=Object.assign,I_={};function rl(t,e,n){this.props=t,this.context=e,this.refs=I_,this.updater=n||T_}rl.prototype.isReactComponent={};rl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function D_(){}D_.prototype=rl.prototype;function Jg(t,e,n){this.props=t,this.context=e,this.refs=I_,this.updater=n||T_}var Zg=Jg.prototype=new D_;Zg.constructor=Jg;M_(Zg,rl.prototype);Zg.isPureReactComponent=!0;var lv=Array.isArray,L_=Object.prototype.hasOwnProperty,ex={current:null},$_={key:!0,ref:!0,__self:!0,__source:!0};function F_(t,e,n){var s,r={},i=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)L_.call(e,s)&&!$_.hasOwnProperty(s)&&(r[s]=e[s]);var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(s in o=t.defaultProps,o)r[s]===void 0&&(r[s]=o[s]);return{$$typeof:tu,type:t,key:i,ref:a,props:r,_owner:ex.current}}function IE(t,e){return{$$typeof:tu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function tx(t){return typeof t=="object"&&t!==null&&t.$$typeof===tu}function DE(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cv=/\/+/g;function zf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?DE(""+t.key):e.toString(36)}function Rd(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case tu:case SE:a=!0}}if(a)return a=t,r=r(a),t=s===""?"."+zf(a,0):s,lv(r)?(n="",t!=null&&(n=t.replace(cv,"$&/")+"/"),Rd(r,e,n,"",function(u){return u})):r!=null&&(tx(r)&&(r=IE(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(cv,"$&/")+"/")+t)),e.push(r)),1;if(a=0,s=s===""?".":s+":",lv(t))for(var o=0;o<t.length;o++){i=t[o];var l=s+zf(i,o);a+=Rd(i,e,n,l,r)}else if(l=ME(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=s+zf(i,o++),a+=Rd(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Au(t,e,n){if(t==null)return t;var s=[],r=0;return Rd(t,s,"","",function(i){return e.call(n,i,r++)}),s}function LE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yn={current:null},Ad={transition:null},$E={ReactCurrentDispatcher:yn,ReactCurrentBatchConfig:Ad,ReactCurrentOwner:ex};function z_(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:Au,forEach:function(t,e,n){Au(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Au(t,function(){e++}),e},toArray:function(t){return Au(t,function(e){return e})||[]},only:function(t){if(!tx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=rl;Fe.Fragment=jE;Fe.Profiler=NE;Fe.PureComponent=Jg;Fe.StrictMode=CE;Fe.Suspense=AE;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$E;Fe.act=z_;Fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=M_({},t.props),r=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=ex.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)L_.call(e,l)&&!$_.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:tu,type:t.type,key:r,ref:i,props:s,_owner:a}};Fe.createContext=function(t){return t={$$typeof:PE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:EE,_context:t},t.Consumer=t};Fe.createElement=F_;Fe.createFactory=function(t){var e=F_.bind(null,t);return e.type=t,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:RE,render:t}};Fe.isValidElement=tx;Fe.lazy=function(t){return{$$typeof:TE,_payload:{_status:-1,_result:t},_init:LE}};Fe.memo=function(t,e){return{$$typeof:OE,type:t,compare:e===void 0?null:e}};Fe.startTransition=function(t){var e=Ad.transition;Ad.transition={};try{t()}finally{Ad.transition=e}};Fe.unstable_act=z_;Fe.useCallback=function(t,e){return yn.current.useCallback(t,e)};Fe.useContext=function(t){return yn.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return yn.current.useDeferredValue(t)};Fe.useEffect=function(t,e){return yn.current.useEffect(t,e)};Fe.useId=function(){return yn.current.useId()};Fe.useImperativeHandle=function(t,e,n){return yn.current.useImperativeHandle(t,e,n)};Fe.useInsertionEffect=function(t,e){return yn.current.useInsertionEffect(t,e)};Fe.useLayoutEffect=function(t,e){return yn.current.useLayoutEffect(t,e)};Fe.useMemo=function(t,e){return yn.current.useMemo(t,e)};Fe.useReducer=function(t,e,n){return yn.current.useReducer(t,e,n)};Fe.useRef=function(t){return yn.current.useRef(t)};Fe.useState=function(t){return yn.current.useState(t)};Fe.useSyncExternalStore=function(t,e,n){return yn.current.useSyncExternalStore(t,e,n)};Fe.useTransition=function(){return yn.current.useTransition()};Fe.version="18.3.1";O_.exports=Fe;var m=O_.exports;const zt=R_(m),Xh=kE({__proto__:null,default:zt},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FE=m,zE=Symbol.for("react.element"),BE=Symbol.for("react.fragment"),UE=Object.prototype.hasOwnProperty,WE=FE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,HE={key:!0,ref:!0,__self:!0,__source:!0};function B_(t,e,n){var s,r={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)UE.call(e,s)&&!HE.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:zE,type:t,key:i,ref:a,props:r,_owner:WE.current}}Qh.Fragment=BE;Qh.jsx=B_;Qh.jsxs=B_;A_.exports=Qh;var c=A_.exports,tm={},U_={exports:{}},es={},W_={exports:{}},H_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(E,C){var F=E.length;E.push(C);e:for(;0<F;){var K=F-1>>>1,U=E[K];if(0<r(U,C))E[K]=C,E[F]=U,F=K;else break e}}function n(E){return E.length===0?null:E[0]}function s(E){if(E.length===0)return null;var C=E[0],F=E.pop();if(F!==C){E[0]=F;e:for(var K=0,U=E.length,ie=U>>>1;K<ie;){var V=2*(K+1)-1,O=E[V],q=V+1,ae=E[q];if(0>r(O,F))q<U&&0>r(ae,O)?(E[K]=ae,E[q]=F,K=q):(E[K]=O,E[V]=F,K=V);else if(q<U&&0>r(ae,F))E[K]=ae,E[q]=F,K=q;else break e}}return C}function r(E,C){var F=E.sortIndex-C.sortIndex;return F!==0?F:E.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,h=null,f=3,p=!1,b=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(E){for(var C=n(u);C!==null;){if(C.callback===null)s(u);else if(C.startTime<=E)s(u),C.sortIndex=C.expirationTime,e(l,C);else break;C=n(u)}}function _(E){if(x=!1,w(E),!b)if(n(l)!==null)b=!0,D(k);else{var C=n(u);C!==null&&G(_,C.startTime-E)}}function k(E,C){b=!1,x&&(x=!1,y(N),N=-1),p=!0;var F=f;try{for(w(C),h=n(l);h!==null&&(!(h.expirationTime>C)||E&&!z());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var U=K(h.expirationTime<=C);C=t.unstable_now(),typeof U=="function"?h.callback=U:h===n(l)&&s(l),w(C)}else s(l);h=n(l)}if(h!==null)var ie=!0;else{var V=n(u);V!==null&&G(_,V.startTime-C),ie=!1}return ie}finally{h=null,f=F,p=!1}}var S=!1,j=null,N=-1,T=5,A=-1;function z(){return!(t.unstable_now()-A<T)}function M(){if(j!==null){var E=t.unstable_now();A=E;var C=!0;try{C=j(!0,E)}finally{C?I():(S=!1,j=null)}}else S=!1}var I;if(typeof g=="function")I=function(){g(M)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,L=H.port2;H.port1.onmessage=M,I=function(){L.postMessage(null)}}else I=function(){v(M,0)};function D(E){j=E,S||(S=!0,I())}function G(E,C){N=v(function(){E(t.unstable_now())},C)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(E){E.callback=null},t.unstable_continueExecution=function(){b||p||(b=!0,D(k))},t.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<E?Math.floor(1e3/E):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(E){switch(f){case 1:case 2:case 3:var C=3;break;default:C=f}var F=f;f=C;try{return E()}finally{f=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(E,C){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var F=f;f=E;try{return C()}finally{f=F}},t.unstable_scheduleCallback=function(E,C,F){var K=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?K+F:K):F=K,E){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=F+U,E={id:d++,callback:C,priorityLevel:E,startTime:F,expirationTime:U,sortIndex:-1},F>K?(E.sortIndex=F,e(u,E),n(l)===null&&E===n(u)&&(x?(y(N),N=-1):x=!0,G(_,F-K))):(E.sortIndex=U,e(l,E),b||p||(b=!0,D(k))),E},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(E){var C=f;return function(){var F=f;f=C;try{return E.apply(this,arguments)}finally{f=F}}}})(H_);W_.exports=H_;var VE=W_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qE=m,Zn=VE;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var V_=new Set,uc={};function Ea(t,e){Yo(t,e),Yo(t+"Capture",e)}function Yo(t,e){for(uc[t]=e,t=0;t<e.length;t++)V_.add(e[t])}var wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nm=Object.prototype.hasOwnProperty,KE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uv={},dv={};function GE(t){return nm.call(dv,t)?!0:nm.call(uv,t)?!1:KE.test(t)?dv[t]=!0:(uv[t]=!0,!1)}function YE(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QE(t,e,n,s){if(e===null||typeof e>"u"||YE(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vn(t,e,n,s,r,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Zt[t]=new vn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Zt[e]=new vn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Zt[t]=new vn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Zt[t]=new vn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Zt[t]=new vn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Zt[t]=new vn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Zt[t]=new vn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Zt[t]=new vn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Zt[t]=new vn(t,5,!1,t.toLowerCase(),null,!1,!1)});var nx=/[\-:]([a-z])/g;function sx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(nx,sx);Zt[e]=new vn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(nx,sx);Zt[e]=new vn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(nx,sx);Zt[e]=new vn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Zt[t]=new vn(t,1,!1,t.toLowerCase(),null,!1,!1)});Zt.xlinkHref=new vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Zt[t]=new vn(t,1,!1,t.toLowerCase(),null,!0,!0)});function rx(t,e,n,s){var r=Zt.hasOwnProperty(e)?Zt[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QE(e,n,r,s)&&(n=null),s||r===null?GE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Pr=qE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ou=Symbol.for("react.element"),ro=Symbol.for("react.portal"),io=Symbol.for("react.fragment"),ix=Symbol.for("react.strict_mode"),sm=Symbol.for("react.profiler"),q_=Symbol.for("react.provider"),K_=Symbol.for("react.context"),ax=Symbol.for("react.forward_ref"),rm=Symbol.for("react.suspense"),im=Symbol.for("react.suspense_list"),ox=Symbol.for("react.memo"),$r=Symbol.for("react.lazy"),G_=Symbol.for("react.offscreen"),hv=Symbol.iterator;function yl(t){return t===null||typeof t!="object"?null:(t=hv&&t[hv]||t["@@iterator"],typeof t=="function"?t:null)}var kt=Object.assign,Bf;function Dl(t){if(Bf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bf=e&&e[1]||""}return`
`+Bf+t}var Uf=!1;function Wf(t,e){if(!t||Uf)return"";Uf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),a=r.length-1,o=i.length-1;1<=a&&0<=o&&r[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==i[o]){var l=`
`+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Uf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Dl(t):""}function XE(t){switch(t.tag){case 5:return Dl(t.type);case 16:return Dl("Lazy");case 13:return Dl("Suspense");case 19:return Dl("SuspenseList");case 0:case 2:case 15:return t=Wf(t.type,!1),t;case 11:return t=Wf(t.type.render,!1),t;case 1:return t=Wf(t.type,!0),t;default:return""}}function am(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case io:return"Fragment";case ro:return"Portal";case sm:return"Profiler";case ix:return"StrictMode";case rm:return"Suspense";case im:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case K_:return(t.displayName||"Context")+".Consumer";case q_:return(t._context.displayName||"Context")+".Provider";case ax:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ox:return e=t.displayName||null,e!==null?e:am(t.type)||"Memo";case $r:e=t._payload,t=t._init;try{return am(t(e))}catch{}}return null}function JE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return am(e);case 8:return e===ix?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Y_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ZE(t){var e=Y_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){s=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Tu(t){t._valueTracker||(t._valueTracker=ZE(t))}function Q_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=Y_(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function th(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function om(t,e){var n=e.checked;return kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fv(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=bi(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function X_(t,e){e=e.checked,e!=null&&rx(t,"checked",e,!1)}function lm(t,e){X_(t,e);var n=bi(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?cm(t,e.type,n):e.hasOwnProperty("defaultValue")&&cm(t,e.type,bi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function cm(t,e,n){(e!=="number"||th(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ll=Array.isArray;function vo(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+bi(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function um(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(Ll(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:bi(n)}}function J_(t,e){var n=bi(e.value),s=bi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function gv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Z_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Z_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Mu,ek=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Mu=Mu||document.createElement("div"),Mu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Mu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function dc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ql={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},e2=["Webkit","ms","Moz","O"];Object.keys(Ql).forEach(function(t){e2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ql[e]=Ql[t]})});function tk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ql.hasOwnProperty(t)&&Ql[t]?(""+e).trim():e+"px"}function nk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=tk(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var t2=kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hm(t,e){if(e){if(t2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function fm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pm=null;function lx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mm=null,bo=null,wo=null;function xv(t){if(t=ru(t)){if(typeof mm!="function")throw Error(te(280));var e=t.stateNode;e&&(e=nf(e),mm(t.stateNode,t.type,e))}}function sk(t){bo?wo?wo.push(t):wo=[t]:bo=t}function rk(){if(bo){var t=bo,e=wo;if(wo=bo=null,xv(t),e)for(t=0;t<e.length;t++)xv(e[t])}}function ik(t,e){return t(e)}function ak(){}var Hf=!1;function ok(t,e,n){if(Hf)return t(e,n);Hf=!0;try{return ik(t,e,n)}finally{Hf=!1,(bo!==null||wo!==null)&&(ak(),rk())}}function hc(t,e){var n=t.stateNode;if(n===null)return null;var s=nf(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var gm=!1;if(wr)try{var vl={};Object.defineProperty(vl,"passive",{get:function(){gm=!0}}),window.addEventListener("test",vl,vl),window.removeEventListener("test",vl,vl)}catch{gm=!1}function n2(t,e,n,s,r,i,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Xl=!1,nh=null,sh=!1,xm=null,s2={onError:function(t){Xl=!0,nh=t}};function r2(t,e,n,s,r,i,a,o,l){Xl=!1,nh=null,n2.apply(s2,arguments)}function i2(t,e,n,s,r,i,a,o,l){if(r2.apply(this,arguments),Xl){if(Xl){var u=nh;Xl=!1,nh=null}else throw Error(te(198));sh||(sh=!0,xm=u)}}function Pa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function lk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function yv(t){if(Pa(t)!==t)throw Error(te(188))}function a2(t){var e=t.alternate;if(!e){if(e=Pa(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return yv(r),t;if(i===s)return yv(r),e;i=i.sibling}throw Error(te(188))}if(n.return!==s.return)n=r,s=i;else{for(var a=!1,o=r.child;o;){if(o===n){a=!0,n=r,s=i;break}if(o===s){a=!0,s=r,n=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===n){a=!0,n=i,s=r;break}if(o===s){a=!0,s=i,n=r;break}o=o.sibling}if(!a)throw Error(te(189))}}if(n.alternate!==s)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function ck(t){return t=a2(t),t!==null?uk(t):null}function uk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uk(t);if(e!==null)return e;t=t.sibling}return null}var dk=Zn.unstable_scheduleCallback,vv=Zn.unstable_cancelCallback,o2=Zn.unstable_shouldYield,l2=Zn.unstable_requestPaint,Rt=Zn.unstable_now,c2=Zn.unstable_getCurrentPriorityLevel,cx=Zn.unstable_ImmediatePriority,hk=Zn.unstable_UserBlockingPriority,rh=Zn.unstable_NormalPriority,u2=Zn.unstable_LowPriority,fk=Zn.unstable_IdlePriority,Jh=null,Qs=null;function d2(t){if(Qs&&typeof Qs.onCommitFiberRoot=="function")try{Qs.onCommitFiberRoot(Jh,t,void 0,(t.current.flags&128)===128)}catch{}}var Es=Math.clz32?Math.clz32:p2,h2=Math.log,f2=Math.LN2;function p2(t){return t>>>=0,t===0?32:31-(h2(t)/f2|0)|0}var Iu=64,Du=4194304;function $l(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ih(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~r;o!==0?s=$l(o):(i&=a,i!==0&&(s=$l(i)))}else a=n&~r,a!==0?s=$l(a):i!==0&&(s=$l(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Es(e),r=1<<n,s|=t[n],e&=~r;return s}function m2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function g2(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Es(i),o=1<<a,l=r[a];l===-1?(!(o&n)||o&s)&&(r[a]=m2(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function ym(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function pk(){var t=Iu;return Iu<<=1,!(Iu&4194240)&&(Iu=64),t}function Vf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function nu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Es(e),t[e]=n}function x2(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Es(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function ux(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Es(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var Ze=0;function mk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var gk,dx,xk,yk,vk,vm=!1,Lu=[],li=null,ci=null,ui=null,fc=new Map,pc=new Map,Br=[],y2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bv(t,e){switch(t){case"focusin":case"focusout":li=null;break;case"dragenter":case"dragleave":ci=null;break;case"mouseover":case"mouseout":ui=null;break;case"pointerover":case"pointerout":fc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pc.delete(e.pointerId)}}function bl(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=ru(e),e!==null&&dx(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function v2(t,e,n,s,r){switch(e){case"focusin":return li=bl(li,t,e,n,s,r),!0;case"dragenter":return ci=bl(ci,t,e,n,s,r),!0;case"mouseover":return ui=bl(ui,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return fc.set(i,bl(fc.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,pc.set(i,bl(pc.get(i)||null,t,e,n,s,r)),!0}return!1}function bk(t){var e=Qi(t.target);if(e!==null){var n=Pa(e);if(n!==null){if(e=n.tag,e===13){if(e=lk(n),e!==null){t.blockedOn=e,vk(t.priority,function(){xk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Od(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=bm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);pm=s,n.target.dispatchEvent(s),pm=null}else return e=ru(n),e!==null&&dx(e),t.blockedOn=n,!1;e.shift()}return!0}function wv(t,e,n){Od(t)&&n.delete(e)}function b2(){vm=!1,li!==null&&Od(li)&&(li=null),ci!==null&&Od(ci)&&(ci=null),ui!==null&&Od(ui)&&(ui=null),fc.forEach(wv),pc.forEach(wv)}function wl(t,e){t.blockedOn===e&&(t.blockedOn=null,vm||(vm=!0,Zn.unstable_scheduleCallback(Zn.unstable_NormalPriority,b2)))}function mc(t){function e(r){return wl(r,t)}if(0<Lu.length){wl(Lu[0],t);for(var n=1;n<Lu.length;n++){var s=Lu[n];s.blockedOn===t&&(s.blockedOn=null)}}for(li!==null&&wl(li,t),ci!==null&&wl(ci,t),ui!==null&&wl(ui,t),fc.forEach(e),pc.forEach(e),n=0;n<Br.length;n++)s=Br[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Br.length&&(n=Br[0],n.blockedOn===null);)bk(n),n.blockedOn===null&&Br.shift()}var _o=Pr.ReactCurrentBatchConfig,ah=!0;function w2(t,e,n,s){var r=Ze,i=_o.transition;_o.transition=null;try{Ze=1,hx(t,e,n,s)}finally{Ze=r,_o.transition=i}}function _2(t,e,n,s){var r=Ze,i=_o.transition;_o.transition=null;try{Ze=4,hx(t,e,n,s)}finally{Ze=r,_o.transition=i}}function hx(t,e,n,s){if(ah){var r=bm(t,e,n,s);if(r===null)tp(t,e,s,oh,n),bv(t,s);else if(v2(r,t,e,n,s))s.stopPropagation();else if(bv(t,s),e&4&&-1<y2.indexOf(t)){for(;r!==null;){var i=ru(r);if(i!==null&&gk(i),i=bm(t,e,n,s),i===null&&tp(t,e,s,oh,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else tp(t,e,s,null,n)}}var oh=null;function bm(t,e,n,s){if(oh=null,t=lx(s),t=Qi(t),t!==null)if(e=Pa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=lk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return oh=t,null}function wk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(c2()){case cx:return 1;case hk:return 4;case rh:case u2:return 16;case fk:return 536870912;default:return 16}default:return 16}}var ti=null,fx=null,Td=null;function _k(){if(Td)return Td;var t,e=fx,n=e.length,s,r="value"in ti?ti.value:ti.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===r[i-s];s++);return Td=r.slice(t,1<s?1-s:void 0)}function Md(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $u(){return!0}function _v(){return!1}function ts(t){function e(n,s,r,i,a){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$u:_v,this.isPropagationStopped=_v,this}return kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$u)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$u)},persist:function(){},isPersistent:$u}),e}var il={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},px=ts(il),su=kt({},il,{view:0,detail:0}),k2=ts(su),qf,Kf,_l,Zh=kt({},su,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==_l&&(_l&&t.type==="mousemove"?(qf=t.screenX-_l.screenX,Kf=t.screenY-_l.screenY):Kf=qf=0,_l=t),qf)},movementY:function(t){return"movementY"in t?t.movementY:Kf}}),kv=ts(Zh),S2=kt({},Zh,{dataTransfer:0}),j2=ts(S2),C2=kt({},su,{relatedTarget:0}),Gf=ts(C2),N2=kt({},il,{animationName:0,elapsedTime:0,pseudoElement:0}),E2=ts(N2),P2=kt({},il,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),R2=ts(P2),A2=kt({},il,{data:0}),Sv=ts(A2),O2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},M2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=M2[t])?!!e[t]:!1}function mx(){return I2}var D2=kt({},su,{key:function(t){if(t.key){var e=O2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Md(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?T2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mx,charCode:function(t){return t.type==="keypress"?Md(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Md(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),L2=ts(D2),$2=kt({},Zh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jv=ts($2),F2=kt({},su,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mx}),z2=ts(F2),B2=kt({},il,{propertyName:0,elapsedTime:0,pseudoElement:0}),U2=ts(B2),W2=kt({},Zh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),H2=ts(W2),V2=[9,13,27,32],gx=wr&&"CompositionEvent"in window,Jl=null;wr&&"documentMode"in document&&(Jl=document.documentMode);var q2=wr&&"TextEvent"in window&&!Jl,kk=wr&&(!gx||Jl&&8<Jl&&11>=Jl),Cv=" ",Nv=!1;function Sk(t,e){switch(t){case"keyup":return V2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ao=!1;function K2(t,e){switch(t){case"compositionend":return jk(e);case"keypress":return e.which!==32?null:(Nv=!0,Cv);case"textInput":return t=e.data,t===Cv&&Nv?null:t;default:return null}}function G2(t,e){if(ao)return t==="compositionend"||!gx&&Sk(t,e)?(t=_k(),Td=fx=ti=null,ao=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return kk&&e.locale!=="ko"?null:e.data;default:return null}}var Y2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ev(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Y2[t.type]:e==="textarea"}function Ck(t,e,n,s){sk(s),e=lh(e,"onChange"),0<e.length&&(n=new px("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Zl=null,gc=null;function Q2(t){Lk(t,0)}function ef(t){var e=co(t);if(Q_(e))return t}function X2(t,e){if(t==="change")return e}var Nk=!1;if(wr){var Yf;if(wr){var Qf="oninput"in document;if(!Qf){var Pv=document.createElement("div");Pv.setAttribute("oninput","return;"),Qf=typeof Pv.oninput=="function"}Yf=Qf}else Yf=!1;Nk=Yf&&(!document.documentMode||9<document.documentMode)}function Rv(){Zl&&(Zl.detachEvent("onpropertychange",Ek),gc=Zl=null)}function Ek(t){if(t.propertyName==="value"&&ef(gc)){var e=[];Ck(e,gc,t,lx(t)),ok(Q2,e)}}function J2(t,e,n){t==="focusin"?(Rv(),Zl=e,gc=n,Zl.attachEvent("onpropertychange",Ek)):t==="focusout"&&Rv()}function Z2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ef(gc)}function eP(t,e){if(t==="click")return ef(e)}function tP(t,e){if(t==="input"||t==="change")return ef(e)}function nP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Rs=typeof Object.is=="function"?Object.is:nP;function xc(t,e){if(Rs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!nm.call(e,r)||!Rs(t[r],e[r]))return!1}return!0}function Av(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ov(t,e){var n=Av(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Av(n)}}function Pk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Pk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Rk(){for(var t=window,e=th();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=th(t.document)}return e}function xx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sP(t){var e=Rk(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Pk(n.ownerDocument.documentElement,n)){if(s!==null&&xx(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=Ov(n,i);var a=Ov(n,s);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var rP=wr&&"documentMode"in document&&11>=document.documentMode,oo=null,wm=null,ec=null,_m=!1;function Tv(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_m||oo==null||oo!==th(s)||(s=oo,"selectionStart"in s&&xx(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ec&&xc(ec,s)||(ec=s,s=lh(wm,"onSelect"),0<s.length&&(e=new px("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=oo)))}function Fu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var lo={animationend:Fu("Animation","AnimationEnd"),animationiteration:Fu("Animation","AnimationIteration"),animationstart:Fu("Animation","AnimationStart"),transitionend:Fu("Transition","TransitionEnd")},Xf={},Ak={};wr&&(Ak=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function tf(t){if(Xf[t])return Xf[t];if(!lo[t])return t;var e=lo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ak)return Xf[t]=e[n];return t}var Ok=tf("animationend"),Tk=tf("animationiteration"),Mk=tf("animationstart"),Ik=tf("transitionend"),Dk=new Map,Mv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(t,e){Dk.set(t,e),Ea(e,[t])}for(var Jf=0;Jf<Mv.length;Jf++){var Zf=Mv[Jf],iP=Zf.toLowerCase(),aP=Zf[0].toUpperCase()+Zf.slice(1);Ni(iP,"on"+aP)}Ni(Ok,"onAnimationEnd");Ni(Tk,"onAnimationIteration");Ni(Mk,"onAnimationStart");Ni("dblclick","onDoubleClick");Ni("focusin","onFocus");Ni("focusout","onBlur");Ni(Ik,"onTransitionEnd");Yo("onMouseEnter",["mouseout","mouseover"]);Yo("onMouseLeave",["mouseout","mouseover"]);Yo("onPointerEnter",["pointerout","pointerover"]);Yo("onPointerLeave",["pointerout","pointerover"]);Ea("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ea("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ea("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ea("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ea("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ea("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fl));function Iv(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,i2(s,e,void 0,t),t.currentTarget=null}function Lk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&r.isPropagationStopped())break e;Iv(r,o,u),i=l}else for(a=0;a<s.length;a++){if(o=s[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==i&&r.isPropagationStopped())break e;Iv(r,o,u),i=l}}}if(sh)throw t=xm,sh=!1,xm=null,t}function dt(t,e){var n=e[Nm];n===void 0&&(n=e[Nm]=new Set);var s=t+"__bubble";n.has(s)||($k(e,t,2,!1),n.add(s))}function ep(t,e,n){var s=0;e&&(s|=4),$k(n,t,s,e)}var zu="_reactListening"+Math.random().toString(36).slice(2);function yc(t){if(!t[zu]){t[zu]=!0,V_.forEach(function(n){n!=="selectionchange"&&(oP.has(n)||ep(n,!1,t),ep(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[zu]||(e[zu]=!0,ep("selectionchange",!1,e))}}function $k(t,e,n,s){switch(wk(e)){case 1:var r=w2;break;case 4:r=_2;break;default:r=hx}n=r.bind(null,e,n,t),r=void 0,!gm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function tp(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=s.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=Qi(o),a===null)return;if(l=a.tag,l===5||l===6){s=i=a;continue e}o=o.parentNode}}s=s.return}ok(function(){var u=i,d=lx(n),h=[];e:{var f=Dk.get(t);if(f!==void 0){var p=px,b=t;switch(t){case"keypress":if(Md(n)===0)break e;case"keydown":case"keyup":p=L2;break;case"focusin":b="focus",p=Gf;break;case"focusout":b="blur",p=Gf;break;case"beforeblur":case"afterblur":p=Gf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=kv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=j2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=z2;break;case Ok:case Tk:case Mk:p=E2;break;case Ik:p=U2;break;case"scroll":p=k2;break;case"wheel":p=H2;break;case"copy":case"cut":case"paste":p=R2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=jv}var x=(e&4)!==0,v=!x&&t==="scroll",y=x?f!==null?f+"Capture":null:f;x=[];for(var g=u,w;g!==null;){w=g;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,y!==null&&(_=hc(g,y),_!=null&&x.push(vc(g,_,w)))),v)break;g=g.return}0<x.length&&(f=new p(f,b,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==pm&&(b=n.relatedTarget||n.fromElement)&&(Qi(b)||b[_r]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(b=n.relatedTarget||n.toElement,p=u,b=b?Qi(b):null,b!==null&&(v=Pa(b),b!==v||b.tag!==5&&b.tag!==6)&&(b=null)):(p=null,b=u),p!==b)){if(x=kv,_="onMouseLeave",y="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(x=jv,_="onPointerLeave",y="onPointerEnter",g="pointer"),v=p==null?f:co(p),w=b==null?f:co(b),f=new x(_,g+"leave",p,n,d),f.target=v,f.relatedTarget=w,_=null,Qi(d)===u&&(x=new x(y,g+"enter",b,n,d),x.target=w,x.relatedTarget=v,_=x),v=_,p&&b)t:{for(x=p,y=b,g=0,w=x;w;w=Ba(w))g++;for(w=0,_=y;_;_=Ba(_))w++;for(;0<g-w;)x=Ba(x),g--;for(;0<w-g;)y=Ba(y),w--;for(;g--;){if(x===y||y!==null&&x===y.alternate)break t;x=Ba(x),y=Ba(y)}x=null}else x=null;p!==null&&Dv(h,f,p,x,!1),b!==null&&v!==null&&Dv(h,v,b,x,!0)}}e:{if(f=u?co(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var k=X2;else if(Ev(f))if(Nk)k=tP;else{k=Z2;var S=J2}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=eP);if(k&&(k=k(t,u))){Ck(h,k,n,d);break e}S&&S(t,f,u),t==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&cm(f,"number",f.value)}switch(S=u?co(u):window,t){case"focusin":(Ev(S)||S.contentEditable==="true")&&(oo=S,wm=u,ec=null);break;case"focusout":ec=wm=oo=null;break;case"mousedown":_m=!0;break;case"contextmenu":case"mouseup":case"dragend":_m=!1,Tv(h,n,d);break;case"selectionchange":if(rP)break;case"keydown":case"keyup":Tv(h,n,d)}var j;if(gx)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else ao?Sk(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(kk&&n.locale!=="ko"&&(ao||N!=="onCompositionStart"?N==="onCompositionEnd"&&ao&&(j=_k()):(ti=d,fx="value"in ti?ti.value:ti.textContent,ao=!0)),S=lh(u,N),0<S.length&&(N=new Sv(N,t,null,n,d),h.push({event:N,listeners:S}),j?N.data=j:(j=jk(n),j!==null&&(N.data=j)))),(j=q2?K2(t,n):G2(t,n))&&(u=lh(u,"onBeforeInput"),0<u.length&&(d=new Sv("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=j))}Lk(h,e)})}function vc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function lh(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=hc(t,n),i!=null&&s.unshift(vc(t,i,r)),i=hc(t,e),i!=null&&s.push(vc(t,i,r))),t=t.return}return s}function Ba(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Dv(t,e,n,s,r){for(var i=e._reactName,a=[];n!==null&&n!==s;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===s)break;o.tag===5&&u!==null&&(o=u,r?(l=hc(n,i),l!=null&&a.unshift(vc(n,l,o))):r||(l=hc(n,i),l!=null&&a.push(vc(n,l,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var lP=/\r\n?/g,cP=/\u0000|\uFFFD/g;function Lv(t){return(typeof t=="string"?t:""+t).replace(lP,`
`).replace(cP,"")}function Bu(t,e,n){if(e=Lv(e),Lv(t)!==e&&n)throw Error(te(425))}function ch(){}var km=null,Sm=null;function jm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Cm=typeof setTimeout=="function"?setTimeout:void 0,uP=typeof clearTimeout=="function"?clearTimeout:void 0,$v=typeof Promise=="function"?Promise:void 0,dP=typeof queueMicrotask=="function"?queueMicrotask:typeof $v<"u"?function(t){return $v.resolve(null).then(t).catch(hP)}:Cm;function hP(t){setTimeout(function(){throw t})}function np(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),mc(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);mc(e)}function di(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var al=Math.random().toString(36).slice(2),Ks="__reactFiber$"+al,bc="__reactProps$"+al,_r="__reactContainer$"+al,Nm="__reactEvents$"+al,fP="__reactListeners$"+al,pP="__reactHandles$"+al;function Qi(t){var e=t[Ks];if(e)return e;for(var n=t.parentNode;n;){if(e=n[_r]||n[Ks]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Fv(t);t!==null;){if(n=t[Ks])return n;t=Fv(t)}return e}t=n,n=t.parentNode}return null}function ru(t){return t=t[Ks]||t[_r],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function nf(t){return t[bc]||null}var Em=[],uo=-1;function Ei(t){return{current:t}}function pt(t){0>uo||(t.current=Em[uo],Em[uo]=null,uo--)}function ot(t,e){uo++,Em[uo]=t.current,t.current=e}var wi={},cn=Ei(wi),Mn=Ei(!1),xa=wi;function Qo(t,e){var n=t.type.contextTypes;if(!n)return wi;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function In(t){return t=t.childContextTypes,t!=null}function uh(){pt(Mn),pt(cn)}function zv(t,e,n){if(cn.current!==wi)throw Error(te(168));ot(cn,e),ot(Mn,n)}function Fk(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(te(108,JE(t)||"Unknown",r));return kt({},n,s)}function dh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||wi,xa=cn.current,ot(cn,t),ot(Mn,Mn.current),!0}function Bv(t,e,n){var s=t.stateNode;if(!s)throw Error(te(169));n?(t=Fk(t,e,xa),s.__reactInternalMemoizedMergedChildContext=t,pt(Mn),pt(cn),ot(cn,t)):pt(Mn),ot(Mn,n)}var ur=null,sf=!1,sp=!1;function zk(t){ur===null?ur=[t]:ur.push(t)}function mP(t){sf=!0,zk(t)}function Pi(){if(!sp&&ur!==null){sp=!0;var t=0,e=Ze;try{var n=ur;for(Ze=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}ur=null,sf=!1}catch(r){throw ur!==null&&(ur=ur.slice(t+1)),dk(cx,Pi),r}finally{Ze=e,sp=!1}}return null}var ho=[],fo=0,hh=null,fh=0,os=[],ls=0,ya=null,gr=1,xr="";function Wi(t,e){ho[fo++]=fh,ho[fo++]=hh,hh=t,fh=e}function Bk(t,e,n){os[ls++]=gr,os[ls++]=xr,os[ls++]=ya,ya=t;var s=gr;t=xr;var r=32-Es(s)-1;s&=~(1<<r),n+=1;var i=32-Es(e)+r;if(30<i){var a=r-r%5;i=(s&(1<<a)-1).toString(32),s>>=a,r-=a,gr=1<<32-Es(e)+r|n<<r|s,xr=i+t}else gr=1<<i|n<<r|s,xr=t}function yx(t){t.return!==null&&(Wi(t,1),Bk(t,1,0))}function vx(t){for(;t===hh;)hh=ho[--fo],ho[fo]=null,fh=ho[--fo],ho[fo]=null;for(;t===ya;)ya=os[--ls],os[ls]=null,xr=os[--ls],os[ls]=null,gr=os[--ls],os[ls]=null}var Qn=null,Yn=null,xt=!1,Ns=null;function Uk(t,e){var n=cs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Uv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qn=t,Yn=di(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qn=t,Yn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ya!==null?{id:gr,overflow:xr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qn=t,Yn=null,!0):!1;default:return!1}}function Pm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rm(t){if(xt){var e=Yn;if(e){var n=e;if(!Uv(t,e)){if(Pm(t))throw Error(te(418));e=di(n.nextSibling);var s=Qn;e&&Uv(t,e)?Uk(s,n):(t.flags=t.flags&-4097|2,xt=!1,Qn=t)}}else{if(Pm(t))throw Error(te(418));t.flags=t.flags&-4097|2,xt=!1,Qn=t}}}function Wv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qn=t}function Uu(t){if(t!==Qn)return!1;if(!xt)return Wv(t),xt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jm(t.type,t.memoizedProps)),e&&(e=Yn)){if(Pm(t))throw Wk(),Error(te(418));for(;e;)Uk(t,e),e=di(e.nextSibling)}if(Wv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Yn=di(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Yn=null}}else Yn=Qn?di(t.stateNode.nextSibling):null;return!0}function Wk(){for(var t=Yn;t;)t=di(t.nextSibling)}function Xo(){Yn=Qn=null,xt=!1}function bx(t){Ns===null?Ns=[t]:Ns.push(t)}var gP=Pr.ReactCurrentBatchConfig;function kl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var s=n.stateNode}if(!s)throw Error(te(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=r.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function Wu(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Hv(t){var e=t._init;return e(t._payload)}function Hk(t){function e(y,g){if(t){var w=y.deletions;w===null?(y.deletions=[g],y.flags|=16):w.push(g)}}function n(y,g){if(!t)return null;for(;g!==null;)e(y,g),g=g.sibling;return null}function s(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function r(y,g){return y=mi(y,g),y.index=0,y.sibling=null,y}function i(y,g,w){return y.index=w,t?(w=y.alternate,w!==null?(w=w.index,w<g?(y.flags|=2,g):w):(y.flags|=2,g)):(y.flags|=1048576,g)}function a(y){return t&&y.alternate===null&&(y.flags|=2),y}function o(y,g,w,_){return g===null||g.tag!==6?(g=up(w,y.mode,_),g.return=y,g):(g=r(g,w),g.return=y,g)}function l(y,g,w,_){var k=w.type;return k===io?d(y,g,w.props.children,_,w.key):g!==null&&(g.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$r&&Hv(k)===g.type)?(_=r(g,w.props),_.ref=kl(y,g,w),_.return=y,_):(_=Bd(w.type,w.key,w.props,null,y.mode,_),_.ref=kl(y,g,w),_.return=y,_)}function u(y,g,w,_){return g===null||g.tag!==4||g.stateNode.containerInfo!==w.containerInfo||g.stateNode.implementation!==w.implementation?(g=dp(w,y.mode,_),g.return=y,g):(g=r(g,w.children||[]),g.return=y,g)}function d(y,g,w,_,k){return g===null||g.tag!==7?(g=ha(w,y.mode,_,k),g.return=y,g):(g=r(g,w),g.return=y,g)}function h(y,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return g=up(""+g,y.mode,w),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ou:return w=Bd(g.type,g.key,g.props,null,y.mode,w),w.ref=kl(y,null,g),w.return=y,w;case ro:return g=dp(g,y.mode,w),g.return=y,g;case $r:var _=g._init;return h(y,_(g._payload),w)}if(Ll(g)||yl(g))return g=ha(g,y.mode,w,null),g.return=y,g;Wu(y,g)}return null}function f(y,g,w,_){var k=g!==null?g.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return k!==null?null:o(y,g,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ou:return w.key===k?l(y,g,w,_):null;case ro:return w.key===k?u(y,g,w,_):null;case $r:return k=w._init,f(y,g,k(w._payload),_)}if(Ll(w)||yl(w))return k!==null?null:d(y,g,w,_,null);Wu(y,w)}return null}function p(y,g,w,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(w)||null,o(g,y,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ou:return y=y.get(_.key===null?w:_.key)||null,l(g,y,_,k);case ro:return y=y.get(_.key===null?w:_.key)||null,u(g,y,_,k);case $r:var S=_._init;return p(y,g,w,S(_._payload),k)}if(Ll(_)||yl(_))return y=y.get(w)||null,d(g,y,_,k,null);Wu(g,_)}return null}function b(y,g,w,_){for(var k=null,S=null,j=g,N=g=0,T=null;j!==null&&N<w.length;N++){j.index>N?(T=j,j=null):T=j.sibling;var A=f(y,j,w[N],_);if(A===null){j===null&&(j=T);break}t&&j&&A.alternate===null&&e(y,j),g=i(A,g,N),S===null?k=A:S.sibling=A,S=A,j=T}if(N===w.length)return n(y,j),xt&&Wi(y,N),k;if(j===null){for(;N<w.length;N++)j=h(y,w[N],_),j!==null&&(g=i(j,g,N),S===null?k=j:S.sibling=j,S=j);return xt&&Wi(y,N),k}for(j=s(y,j);N<w.length;N++)T=p(j,y,N,w[N],_),T!==null&&(t&&T.alternate!==null&&j.delete(T.key===null?N:T.key),g=i(T,g,N),S===null?k=T:S.sibling=T,S=T);return t&&j.forEach(function(z){return e(y,z)}),xt&&Wi(y,N),k}function x(y,g,w,_){var k=yl(w);if(typeof k!="function")throw Error(te(150));if(w=k.call(w),w==null)throw Error(te(151));for(var S=k=null,j=g,N=g=0,T=null,A=w.next();j!==null&&!A.done;N++,A=w.next()){j.index>N?(T=j,j=null):T=j.sibling;var z=f(y,j,A.value,_);if(z===null){j===null&&(j=T);break}t&&j&&z.alternate===null&&e(y,j),g=i(z,g,N),S===null?k=z:S.sibling=z,S=z,j=T}if(A.done)return n(y,j),xt&&Wi(y,N),k;if(j===null){for(;!A.done;N++,A=w.next())A=h(y,A.value,_),A!==null&&(g=i(A,g,N),S===null?k=A:S.sibling=A,S=A);return xt&&Wi(y,N),k}for(j=s(y,j);!A.done;N++,A=w.next())A=p(j,y,N,A.value,_),A!==null&&(t&&A.alternate!==null&&j.delete(A.key===null?N:A.key),g=i(A,g,N),S===null?k=A:S.sibling=A,S=A);return t&&j.forEach(function(M){return e(y,M)}),xt&&Wi(y,N),k}function v(y,g,w,_){if(typeof w=="object"&&w!==null&&w.type===io&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ou:e:{for(var k=w.key,S=g;S!==null;){if(S.key===k){if(k=w.type,k===io){if(S.tag===7){n(y,S.sibling),g=r(S,w.props.children),g.return=y,y=g;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$r&&Hv(k)===S.type){n(y,S.sibling),g=r(S,w.props),g.ref=kl(y,S,w),g.return=y,y=g;break e}n(y,S);break}else e(y,S);S=S.sibling}w.type===io?(g=ha(w.props.children,y.mode,_,w.key),g.return=y,y=g):(_=Bd(w.type,w.key,w.props,null,y.mode,_),_.ref=kl(y,g,w),_.return=y,y=_)}return a(y);case ro:e:{for(S=w.key;g!==null;){if(g.key===S)if(g.tag===4&&g.stateNode.containerInfo===w.containerInfo&&g.stateNode.implementation===w.implementation){n(y,g.sibling),g=r(g,w.children||[]),g.return=y,y=g;break e}else{n(y,g);break}else e(y,g);g=g.sibling}g=dp(w,y.mode,_),g.return=y,y=g}return a(y);case $r:return S=w._init,v(y,g,S(w._payload),_)}if(Ll(w))return b(y,g,w,_);if(yl(w))return x(y,g,w,_);Wu(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,g!==null&&g.tag===6?(n(y,g.sibling),g=r(g,w),g.return=y,y=g):(n(y,g),g=up(w,y.mode,_),g.return=y,y=g),a(y)):n(y,g)}return v}var Jo=Hk(!0),Vk=Hk(!1),ph=Ei(null),mh=null,po=null,wx=null;function _x(){wx=po=mh=null}function kx(t){var e=ph.current;pt(ph),t._currentValue=e}function Am(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function ko(t,e){mh=t,wx=po=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rn=!0),t.firstContext=null)}function hs(t){var e=t._currentValue;if(wx!==t)if(t={context:t,memoizedValue:e,next:null},po===null){if(mh===null)throw Error(te(308));po=t,mh.dependencies={lanes:0,firstContext:t}}else po=po.next=t;return e}var Xi=null;function Sx(t){Xi===null?Xi=[t]:Xi.push(t)}function qk(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,Sx(e)):(n.next=r.next,r.next=n),e.interleaved=n,kr(t,s)}function kr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fr=!1;function jx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hi(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,We&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,kr(t,n)}return r=s.interleaved,r===null?(e.next=e,Sx(s)):(e.next=r.next,r.next=e),s.interleaved=e,kr(t,n)}function Id(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ux(t,n)}}function Vv(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function gh(t,e,n,s){var r=t.updateQueue;Fr=!1;var i=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?i=u:a.next=u,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;a=0,d=u=l=null,o=i;do{var f=o.lane,p=o.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var b=t,x=o;switch(f=e,p=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){h=b.call(p,h,f);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,f=typeof b=="function"?b.call(p,h,f):b,f==null)break e;h=kt({},h,f);break e;case 2:Fr=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,l=h):d=d.next=p,a|=f;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;f=o,o=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(d===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);ba|=a,t.lanes=a,t.memoizedState=h}}function qv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(te(191,r));r.call(s)}}}var iu={},Xs=Ei(iu),wc=Ei(iu),_c=Ei(iu);function Ji(t){if(t===iu)throw Error(te(174));return t}function Cx(t,e){switch(ot(_c,e),ot(wc,t),ot(Xs,iu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=dm(e,t)}pt(Xs),ot(Xs,e)}function Zo(){pt(Xs),pt(wc),pt(_c)}function Gk(t){Ji(_c.current);var e=Ji(Xs.current),n=dm(e,t.type);e!==n&&(ot(wc,t),ot(Xs,n))}function Nx(t){wc.current===t&&(pt(Xs),pt(wc))}var wt=Ei(0);function xh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rp=[];function Ex(){for(var t=0;t<rp.length;t++)rp[t]._workInProgressVersionPrimary=null;rp.length=0}var Dd=Pr.ReactCurrentDispatcher,ip=Pr.ReactCurrentBatchConfig,va=0,_t=null,Ft=null,Ht=null,yh=!1,tc=!1,kc=0,xP=0;function nn(){throw Error(te(321))}function Px(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Rs(t[n],e[n]))return!1;return!0}function Rx(t,e,n,s,r,i){if(va=i,_t=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Dd.current=t===null||t.memoizedState===null?wP:_P,t=n(s,r),tc){i=0;do{if(tc=!1,kc=0,25<=i)throw Error(te(301));i+=1,Ht=Ft=null,e.updateQueue=null,Dd.current=kP,t=n(s,r)}while(tc)}if(Dd.current=vh,e=Ft!==null&&Ft.next!==null,va=0,Ht=Ft=_t=null,yh=!1,e)throw Error(te(300));return t}function Ax(){var t=kc!==0;return kc=0,t}function zs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?_t.memoizedState=Ht=t:Ht=Ht.next=t,Ht}function fs(){if(Ft===null){var t=_t.alternate;t=t!==null?t.memoizedState:null}else t=Ft.next;var e=Ht===null?_t.memoizedState:Ht.next;if(e!==null)Ht=e,Ft=t;else{if(t===null)throw Error(te(310));Ft=t,t={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Ht===null?_t.memoizedState=Ht=t:Ht=Ht.next=t}return Ht}function Sc(t,e){return typeof e=="function"?e(t):e}function ap(t){var e=fs(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var s=Ft,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var a=r.next;r.next=i.next,i.next=a}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var o=a=null,l=null,u=i;do{var d=u.lane;if((va&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=s):l=l.next=h,_t.lanes|=d,ba|=d}u=u.next}while(u!==null&&u!==i);l===null?a=s:l.next=o,Rs(s,e.memoizedState)||(Rn=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,_t.lanes|=i,ba|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function op(t){var e=fs(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do i=t(i,a.action),a=a.next;while(a!==r);Rs(i,e.memoizedState)||(Rn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function Yk(){}function Qk(t,e){var n=_t,s=fs(),r=e(),i=!Rs(s.memoizedState,r);if(i&&(s.memoizedState=r,Rn=!0),s=s.queue,Ox(Zk.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Ht!==null&&Ht.memoizedState.tag&1){if(n.flags|=2048,jc(9,Jk.bind(null,n,s,r,e),void 0,null),qt===null)throw Error(te(349));va&30||Xk(n,e,r)}return r}function Xk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Jk(t,e,n,s){e.value=n,e.getSnapshot=s,eS(e)&&tS(t)}function Zk(t,e,n){return n(function(){eS(e)&&tS(t)})}function eS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Rs(t,n)}catch{return!0}}function tS(t){var e=kr(t,1);e!==null&&Ps(e,t,1,-1)}function Kv(t){var e=zs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sc,lastRenderedState:t},e.queue=t,t=t.dispatch=bP.bind(null,_t,t),[e.memoizedState,t]}function jc(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function nS(){return fs().memoizedState}function Ld(t,e,n,s){var r=zs();_t.flags|=t,r.memoizedState=jc(1|e,n,void 0,s===void 0?null:s)}function rf(t,e,n,s){var r=fs();s=s===void 0?null:s;var i=void 0;if(Ft!==null){var a=Ft.memoizedState;if(i=a.destroy,s!==null&&Px(s,a.deps)){r.memoizedState=jc(e,n,i,s);return}}_t.flags|=t,r.memoizedState=jc(1|e,n,i,s)}function Gv(t,e){return Ld(8390656,8,t,e)}function Ox(t,e){return rf(2048,8,t,e)}function sS(t,e){return rf(4,2,t,e)}function rS(t,e){return rf(4,4,t,e)}function iS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function aS(t,e,n){return n=n!=null?n.concat([t]):null,rf(4,4,iS.bind(null,e,t),n)}function Tx(){}function oS(t,e){var n=fs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Px(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function lS(t,e){var n=fs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Px(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function cS(t,e,n){return va&21?(Rs(n,e)||(n=pk(),_t.lanes|=n,ba|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rn=!0),t.memoizedState=n)}function yP(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var s=ip.transition;ip.transition={};try{t(!1),e()}finally{Ze=n,ip.transition=s}}function uS(){return fs().memoizedState}function vP(t,e,n){var s=pi(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},dS(t))hS(e,n);else if(n=qk(t,e,n,s),n!==null){var r=xn();Ps(n,t,s,r),fS(n,e,s)}}function bP(t,e,n){var s=pi(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(dS(t))hS(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,n);if(r.hasEagerState=!0,r.eagerState=o,Rs(o,a)){var l=e.interleaved;l===null?(r.next=r,Sx(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=qk(t,e,r,s),n!==null&&(r=xn(),Ps(n,t,s,r),fS(n,e,s))}}function dS(t){var e=t.alternate;return t===_t||e!==null&&e===_t}function hS(t,e){tc=yh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function fS(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ux(t,n)}}var vh={readContext:hs,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useInsertionEffect:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useSyncExternalStore:nn,useId:nn,unstable_isNewReconciler:!1},wP={readContext:hs,useCallback:function(t,e){return zs().memoizedState=[t,e===void 0?null:e],t},useContext:hs,useEffect:Gv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ld(4194308,4,iS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ld(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ld(4,2,t,e)},useMemo:function(t,e){var n=zs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=zs();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=vP.bind(null,_t,t),[s.memoizedState,t]},useRef:function(t){var e=zs();return t={current:t},e.memoizedState=t},useState:Kv,useDebugValue:Tx,useDeferredValue:function(t){return zs().memoizedState=t},useTransition:function(){var t=Kv(!1),e=t[0];return t=yP.bind(null,t[1]),zs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=_t,r=zs();if(xt){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),qt===null)throw Error(te(349));va&30||Xk(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,Gv(Zk.bind(null,s,i,t),[t]),s.flags|=2048,jc(9,Jk.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=zs(),e=qt.identifierPrefix;if(xt){var n=xr,s=gr;n=(s&~(1<<32-Es(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=kc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=xP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},_P={readContext:hs,useCallback:oS,useContext:hs,useEffect:Ox,useImperativeHandle:aS,useInsertionEffect:sS,useLayoutEffect:rS,useMemo:lS,useReducer:ap,useRef:nS,useState:function(){return ap(Sc)},useDebugValue:Tx,useDeferredValue:function(t){var e=fs();return cS(e,Ft.memoizedState,t)},useTransition:function(){var t=ap(Sc)[0],e=fs().memoizedState;return[t,e]},useMutableSource:Yk,useSyncExternalStore:Qk,useId:uS,unstable_isNewReconciler:!1},kP={readContext:hs,useCallback:oS,useContext:hs,useEffect:Ox,useImperativeHandle:aS,useInsertionEffect:sS,useLayoutEffect:rS,useMemo:lS,useReducer:op,useRef:nS,useState:function(){return op(Sc)},useDebugValue:Tx,useDeferredValue:function(t){var e=fs();return Ft===null?e.memoizedState=t:cS(e,Ft.memoizedState,t)},useTransition:function(){var t=op(Sc)[0],e=fs().memoizedState;return[t,e]},useMutableSource:Yk,useSyncExternalStore:Qk,useId:uS,unstable_isNewReconciler:!1};function ws(t,e){if(t&&t.defaultProps){e=kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Om(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var af={isMounted:function(t){return(t=t._reactInternals)?Pa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=xn(),r=pi(t),i=vr(s,r);i.payload=e,n!=null&&(i.callback=n),e=hi(t,i,r),e!==null&&(Ps(e,t,r,s),Id(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=xn(),r=pi(t),i=vr(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=hi(t,i,r),e!==null&&(Ps(e,t,r,s),Id(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=xn(),s=pi(t),r=vr(n,s);r.tag=2,e!=null&&(r.callback=e),e=hi(t,r,s),e!==null&&(Ps(e,t,s,n),Id(e,t,s))}};function Yv(t,e,n,s,r,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,a):e.prototype&&e.prototype.isPureReactComponent?!xc(n,s)||!xc(r,i):!0}function pS(t,e,n){var s=!1,r=wi,i=e.contextType;return typeof i=="object"&&i!==null?i=hs(i):(r=In(e)?xa:cn.current,s=e.contextTypes,i=(s=s!=null)?Qo(t,r):wi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=af,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function Qv(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&af.enqueueReplaceState(e,e.state,null)}function Tm(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},jx(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=hs(i):(i=In(e)?xa:cn.current,r.context=Qo(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Om(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&af.enqueueReplaceState(r,r.state,null),gh(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function el(t,e){try{var n="",s=e;do n+=XE(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function lp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Mm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var SP=typeof WeakMap=="function"?WeakMap:Map;function mS(t,e,n){n=vr(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){wh||(wh=!0,Hm=s),Mm(t,e)},n}function gS(t,e,n){n=vr(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){Mm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Mm(t,e),typeof s!="function"&&(fi===null?fi=new Set([this]):fi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Xv(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new SP;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=$P.bind(null,t,e,n),e.then(t,t))}function Jv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zv(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=vr(-1,1),e.tag=2,hi(n,e,1))),n.lanes|=1),t)}var jP=Pr.ReactCurrentOwner,Rn=!1;function gn(t,e,n,s){e.child=t===null?Vk(e,null,n,s):Jo(e,t.child,n,s)}function eb(t,e,n,s,r){n=n.render;var i=e.ref;return ko(e,r),s=Rx(t,e,n,s,i,r),n=Ax(),t!==null&&!Rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Sr(t,e,r)):(xt&&n&&yx(e),e.flags|=1,gn(t,e,s,r),e.child)}function tb(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Bx(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,xS(t,e,i,s,r)):(t=Bd(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:xc,n(a,s)&&t.ref===e.ref)return Sr(t,e,r)}return e.flags|=1,t=mi(i,s),t.ref=e.ref,t.return=e,e.child=t}function xS(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(xc(i,s)&&t.ref===e.ref)if(Rn=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Rn=!0);else return e.lanes=t.lanes,Sr(t,e,r)}return Im(t,e,n,s,r)}function yS(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(go,Vn),Vn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ot(go,Vn),Vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,ot(go,Vn),Vn|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,ot(go,Vn),Vn|=s;return gn(t,e,r,n),e.child}function vS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Im(t,e,n,s,r){var i=In(n)?xa:cn.current;return i=Qo(e,i),ko(e,r),n=Rx(t,e,n,s,i,r),s=Ax(),t!==null&&!Rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Sr(t,e,r)):(xt&&s&&yx(e),e.flags|=1,gn(t,e,n,r),e.child)}function nb(t,e,n,s,r){if(In(n)){var i=!0;dh(e)}else i=!1;if(ko(e,r),e.stateNode===null)$d(t,e),pS(e,n,s),Tm(e,n,s,r),s=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=hs(u):(u=In(n)?xa:cn.current,u=Qo(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||l!==u)&&Qv(e,a,s,u),Fr=!1;var f=e.memoizedState;a.state=f,gh(e,s,a,r),l=e.memoizedState,o!==s||f!==l||Mn.current||Fr?(typeof d=="function"&&(Om(e,n,d,s),l=e.memoizedState),(o=Fr||Yv(e,n,o,s,f,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),a.props=s,a.state=l,a.context=u,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Kk(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:ws(e.type,o),a.props=u,h=e.pendingProps,f=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=hs(l):(l=In(n)?xa:cn.current,l=Qo(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||f!==l)&&Qv(e,a,s,l),Fr=!1,f=e.memoizedState,a.state=f,gh(e,s,a,r);var b=e.memoizedState;o!==h||f!==b||Mn.current||Fr?(typeof p=="function"&&(Om(e,n,p,s),b=e.memoizedState),(u=Fr||Yv(e,n,u,s,f,b,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,b,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,b,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=b),a.props=s,a.state=b,a.context=l,s=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return Dm(t,e,n,s,i,r)}function Dm(t,e,n,s,r,i){vS(t,e);var a=(e.flags&128)!==0;if(!s&&!a)return r&&Bv(e,n,!1),Sr(t,e,i);s=e.stateNode,jP.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&a?(e.child=Jo(e,t.child,null,i),e.child=Jo(e,null,o,i)):gn(t,e,o,i),e.memoizedState=s.state,r&&Bv(e,n,!0),e.child}function bS(t){var e=t.stateNode;e.pendingContext?zv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zv(t,e.context,!1),Cx(t,e.containerInfo)}function sb(t,e,n,s,r){return Xo(),bx(r),e.flags|=256,gn(t,e,n,s),e.child}var Lm={dehydrated:null,treeContext:null,retryLane:0};function $m(t){return{baseLanes:t,cachePool:null,transitions:null}}function wS(t,e,n){var s=e.pendingProps,r=wt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(r&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),ot(wt,r&1),t===null)return Rm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,t=s.fallback,i?(s=e.mode,i=e.child,a={mode:"hidden",children:a},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=cf(a,s,0,null),t=ha(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=$m(n),e.memoizedState=Lm,t):Mx(e,a));if(r=t.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return CP(t,e,a,s,o,r,n);if(i){i=s.fallback,a=e.mode,r=t.child,o=r.sibling;var l={mode:"hidden",children:s.children};return!(a&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=mi(r,l),s.subtreeFlags=r.subtreeFlags&14680064),o!==null?i=mi(o,i):(i=ha(i,a,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,a=t.child.memoizedState,a=a===null?$m(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Lm,s}return i=t.child,t=i.sibling,s=mi(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Mx(t,e){return e=cf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Hu(t,e,n,s){return s!==null&&bx(s),Jo(e,t.child,null,n),t=Mx(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function CP(t,e,n,s,r,i,a){if(n)return e.flags&256?(e.flags&=-257,s=lp(Error(te(422))),Hu(t,e,a,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=cf({mode:"visible",children:s.children},r,0,null),i=ha(i,r,a,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Jo(e,t.child,null,a),e.child.memoizedState=$m(a),e.memoizedState=Lm,i);if(!(e.mode&1))return Hu(t,e,a,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var o=s.dgst;return s=o,i=Error(te(419)),s=lp(i,s,void 0),Hu(t,e,a,s)}if(o=(a&t.childLanes)!==0,Rn||o){if(s=qt,s!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|a)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,kr(t,r),Ps(s,t,r,-1))}return zx(),s=lp(Error(te(421))),Hu(t,e,a,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=FP.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,Yn=di(r.nextSibling),Qn=e,xt=!0,Ns=null,t!==null&&(os[ls++]=gr,os[ls++]=xr,os[ls++]=ya,gr=t.id,xr=t.overflow,ya=e),e=Mx(e,s.children),e.flags|=4096,e)}function rb(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Am(t.return,e,n)}function cp(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function _S(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(gn(t,e,s.children,n),s=wt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&rb(t,n,e);else if(t.tag===19)rb(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(ot(wt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&xh(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),cp(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&xh(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}cp(e,!0,n,null,i);break;case"together":cp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $d(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ba|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=mi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=mi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function NP(t,e,n){switch(e.tag){case 3:bS(e),Xo();break;case 5:Gk(e);break;case 1:In(e.type)&&dh(e);break;case 4:Cx(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;ot(ph,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(ot(wt,wt.current&1),e.flags|=128,null):n&e.child.childLanes?wS(t,e,n):(ot(wt,wt.current&1),t=Sr(t,e,n),t!==null?t.sibling:null);ot(wt,wt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return _S(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ot(wt,wt.current),s)break;return null;case 22:case 23:return e.lanes=0,yS(t,e,n)}return Sr(t,e,n)}var kS,Fm,SS,jS;kS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Fm=function(){};SS=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Ji(Xs.current);var i=null;switch(n){case"input":r=om(t,r),s=om(t,s),i=[];break;case"select":r=kt({},r,{value:void 0}),s=kt({},s,{value:void 0}),i=[];break;case"textarea":r=um(t,r),s=um(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=ch)}hm(n,s);var a;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var o=r[u];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(uc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var l=s[u];if(o=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(uc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&dt("scroll",t),i||o===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};jS=function(t,e,n,s){n!==s&&(e.flags|=4)};function Sl(t,e){if(!xt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function sn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function EP(t,e,n){var s=e.pendingProps;switch(vx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sn(e),null;case 1:return In(e.type)&&uh(),sn(e),null;case 3:return s=e.stateNode,Zo(),pt(Mn),pt(cn),Ex(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Uu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ns!==null&&(Km(Ns),Ns=null))),Fm(t,e),sn(e),null;case 5:Nx(e);var r=Ji(_c.current);if(n=e.type,t!==null&&e.stateNode!=null)SS(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(te(166));return sn(e),null}if(t=Ji(Xs.current),Uu(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Ks]=e,s[bc]=i,t=(e.mode&1)!==0,n){case"dialog":dt("cancel",s),dt("close",s);break;case"iframe":case"object":case"embed":dt("load",s);break;case"video":case"audio":for(r=0;r<Fl.length;r++)dt(Fl[r],s);break;case"source":dt("error",s);break;case"img":case"image":case"link":dt("error",s),dt("load",s);break;case"details":dt("toggle",s);break;case"input":fv(s,i),dt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},dt("invalid",s);break;case"textarea":mv(s,i),dt("invalid",s)}hm(n,i),r=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?s.textContent!==o&&(i.suppressHydrationWarning!==!0&&Bu(s.textContent,o,t),r=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Bu(s.textContent,o,t),r=["children",""+o]):uc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&dt("scroll",s)}switch(n){case"input":Tu(s),pv(s,i,!0);break;case"textarea":Tu(s),gv(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=ch)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Z_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=a.createElement(n,{is:s.is}):(t=a.createElement(n),n==="select"&&(a=t,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):t=a.createElementNS(t,n),t[Ks]=e,t[bc]=s,kS(t,e,!1,!1),e.stateNode=t;e:{switch(a=fm(n,s),n){case"dialog":dt("cancel",t),dt("close",t),r=s;break;case"iframe":case"object":case"embed":dt("load",t),r=s;break;case"video":case"audio":for(r=0;r<Fl.length;r++)dt(Fl[r],t);r=s;break;case"source":dt("error",t),r=s;break;case"img":case"image":case"link":dt("error",t),dt("load",t),r=s;break;case"details":dt("toggle",t),r=s;break;case"input":fv(t,s),r=om(t,s),dt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=kt({},s,{value:void 0}),dt("invalid",t);break;case"textarea":mv(t,s),r=um(t,s),dt("invalid",t);break;default:r=s}hm(n,r),o=r;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?nk(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ek(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&dc(t,l):typeof l=="number"&&dc(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(uc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&dt("scroll",t):l!=null&&rx(t,i,l,a))}switch(n){case"input":Tu(t),pv(t,s,!1);break;case"textarea":Tu(t),gv(t);break;case"option":s.value!=null&&t.setAttribute("value",""+bi(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?vo(t,!!s.multiple,i,!1):s.defaultValue!=null&&vo(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=ch)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return sn(e),null;case 6:if(t&&e.stateNode!=null)jS(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(te(166));if(n=Ji(_c.current),Ji(Xs.current),Uu(e)){if(s=e.stateNode,n=e.memoizedProps,s[Ks]=e,(i=s.nodeValue!==n)&&(t=Qn,t!==null))switch(t.tag){case 3:Bu(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bu(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Ks]=e,e.stateNode=s}return sn(e),null;case 13:if(pt(wt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xt&&Yn!==null&&e.mode&1&&!(e.flags&128))Wk(),Xo(),e.flags|=98560,i=!1;else if(i=Uu(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(te(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(te(317));i[Ks]=e}else Xo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;sn(e),i=!1}else Ns!==null&&(Km(Ns),Ns=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||wt.current&1?Bt===0&&(Bt=3):zx())),e.updateQueue!==null&&(e.flags|=4),sn(e),null);case 4:return Zo(),Fm(t,e),t===null&&yc(e.stateNode.containerInfo),sn(e),null;case 10:return kx(e.type._context),sn(e),null;case 17:return In(e.type)&&uh(),sn(e),null;case 19:if(pt(wt),i=e.memoizedState,i===null)return sn(e),null;if(s=(e.flags&128)!==0,a=i.rendering,a===null)if(s)Sl(i,!1);else{if(Bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=xh(t),a!==null){for(e.flags|=128,Sl(i,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ot(wt,wt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Rt()>tl&&(e.flags|=128,s=!0,Sl(i,!1),e.lanes=4194304)}else{if(!s)if(t=xh(a),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Sl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!xt)return sn(e),null}else 2*Rt()-i.renderingStartTime>tl&&n!==1073741824&&(e.flags|=128,s=!0,Sl(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Rt(),e.sibling=null,n=wt.current,ot(wt,s?n&1|2:n&1),e):(sn(e),null);case 22:case 23:return Fx(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Vn&1073741824&&(sn(e),e.subtreeFlags&6&&(e.flags|=8192)):sn(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function PP(t,e){switch(vx(e),e.tag){case 1:return In(e.type)&&uh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zo(),pt(Mn),pt(cn),Ex(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Nx(e),null;case 13:if(pt(wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));Xo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pt(wt),null;case 4:return Zo(),null;case 10:return kx(e.type._context),null;case 22:case 23:return Fx(),null;case 24:return null;default:return null}}var Vu=!1,an=!1,RP=typeof WeakSet=="function"?WeakSet:Set,pe=null;function mo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Ct(t,e,s)}else n.current=null}function zm(t,e,n){try{n()}catch(s){Ct(t,e,s)}}var ib=!1;function AP(t,e){if(km=ah,t=Rk(),xx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==n||r!==0&&h.nodeType!==3||(o=a+r),h!==i||s!==0&&h.nodeType!==3||(l=a+s),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++u===r&&(o=a),f===i&&++d===s&&(l=a),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sm={focusedElem:t,selectionRange:n},ah=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,v=b.memoizedState,y=e.stateNode,g=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:ws(e.type,x),v);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(_){Ct(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return b=ib,ib=!1,b}function nc(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&zm(e,n,i)}r=r.next}while(r!==s)}}function of(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Bm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function CS(t){var e=t.alternate;e!==null&&(t.alternate=null,CS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ks],delete e[bc],delete e[Nm],delete e[fP],delete e[pP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function NS(t){return t.tag===5||t.tag===3||t.tag===4}function ab(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||NS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Um(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ch));else if(s!==4&&(t=t.child,t!==null))for(Um(t,e,n),t=t.sibling;t!==null;)Um(t,e,n),t=t.sibling}function Wm(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Wm(t,e,n),t=t.sibling;t!==null;)Wm(t,e,n),t=t.sibling}var Qt=null,js=!1;function Tr(t,e,n){for(n=n.child;n!==null;)ES(t,e,n),n=n.sibling}function ES(t,e,n){if(Qs&&typeof Qs.onCommitFiberUnmount=="function")try{Qs.onCommitFiberUnmount(Jh,n)}catch{}switch(n.tag){case 5:an||mo(n,e);case 6:var s=Qt,r=js;Qt=null,Tr(t,e,n),Qt=s,js=r,Qt!==null&&(js?(t=Qt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Qt.removeChild(n.stateNode));break;case 18:Qt!==null&&(js?(t=Qt,n=n.stateNode,t.nodeType===8?np(t.parentNode,n):t.nodeType===1&&np(t,n),mc(t)):np(Qt,n.stateNode));break;case 4:s=Qt,r=js,Qt=n.stateNode.containerInfo,js=!0,Tr(t,e,n),Qt=s,js=r;break;case 0:case 11:case 14:case 15:if(!an&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&zm(n,e,a),r=r.next}while(r!==s)}Tr(t,e,n);break;case 1:if(!an&&(mo(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(o){Ct(n,e,o)}Tr(t,e,n);break;case 21:Tr(t,e,n);break;case 22:n.mode&1?(an=(s=an)||n.memoizedState!==null,Tr(t,e,n),an=s):Tr(t,e,n);break;default:Tr(t,e,n)}}function ob(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RP),e.forEach(function(s){var r=zP.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function vs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Qt=o.stateNode,js=!1;break e;case 3:Qt=o.stateNode.containerInfo,js=!0;break e;case 4:Qt=o.stateNode.containerInfo,js=!0;break e}o=o.return}if(Qt===null)throw Error(te(160));ES(i,a,r),Qt=null,js=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Ct(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)PS(e,t),e=e.sibling}function PS(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vs(e,t),Ds(t),s&4){try{nc(3,t,t.return),of(3,t)}catch(x){Ct(t,t.return,x)}try{nc(5,t,t.return)}catch(x){Ct(t,t.return,x)}}break;case 1:vs(e,t),Ds(t),s&512&&n!==null&&mo(n,n.return);break;case 5:if(vs(e,t),Ds(t),s&512&&n!==null&&mo(n,n.return),t.flags&32){var r=t.stateNode;try{dc(r,"")}catch(x){Ct(t,t.return,x)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&X_(r,i),fm(o,a);var u=fm(o,i);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?nk(r,h):d==="dangerouslySetInnerHTML"?ek(r,h):d==="children"?dc(r,h):rx(r,d,h,u)}switch(o){case"input":lm(r,i);break;case"textarea":J_(r,i);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?vo(r,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?vo(r,!!i.multiple,i.defaultValue,!0):vo(r,!!i.multiple,i.multiple?[]:"",!1))}r[bc]=i}catch(x){Ct(t,t.return,x)}}break;case 6:if(vs(e,t),Ds(t),s&4){if(t.stateNode===null)throw Error(te(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(x){Ct(t,t.return,x)}}break;case 3:if(vs(e,t),Ds(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{mc(e.containerInfo)}catch(x){Ct(t,t.return,x)}break;case 4:vs(e,t),Ds(t);break;case 13:vs(e,t),Ds(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Lx=Rt())),s&4&&ob(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(an=(u=an)||d,vs(e,t),an=u):vs(e,t),Ds(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(pe=t,d=t.child;d!==null;){for(h=pe=d;pe!==null;){switch(f=pe,p=f.child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:mo(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){Ct(s,n,x)}}break;case 5:mo(f,f.return);break;case 22:if(f.memoizedState!==null){cb(h);continue}}p!==null?(p.return=f,pe=p):cb(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=tk("display",a))}catch(x){Ct(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Ct(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vs(e,t),Ds(t),s&4&&ob(t);break;case 21:break;default:vs(e,t),Ds(t)}}function Ds(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(NS(n)){var s=n;break e}n=n.return}throw Error(te(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(dc(r,""),s.flags&=-33);var i=ab(t);Wm(t,i,r);break;case 3:case 4:var a=s.stateNode.containerInfo,o=ab(t);Um(t,o,a);break;default:throw Error(te(161))}}catch(l){Ct(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function OP(t,e,n){pe=t,RS(t)}function RS(t,e,n){for(var s=(t.mode&1)!==0;pe!==null;){var r=pe,i=r.child;if(r.tag===22&&s){var a=r.memoizedState!==null||Vu;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||an;o=Vu;var u=an;if(Vu=a,(an=l)&&!u)for(pe=r;pe!==null;)a=pe,l=a.child,a.tag===22&&a.memoizedState!==null?ub(r):l!==null?(l.return=a,pe=l):ub(r);for(;i!==null;)pe=i,RS(i),i=i.sibling;pe=r,Vu=o,an=u}lb(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,pe=i):lb(t)}}function lb(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:an||of(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!an)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:ws(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&qv(e,i,s);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}qv(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&mc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}an||e.flags&512&&Bm(e)}catch(f){Ct(e,e.return,f)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function cb(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function ub(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{of(4,e)}catch(l){Ct(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Ct(e,r,l)}}var i=e.return;try{Bm(e)}catch(l){Ct(e,i,l)}break;case 5:var a=e.return;try{Bm(e)}catch(l){Ct(e,a,l)}}}catch(l){Ct(e,e.return,l)}if(e===t){pe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,pe=o;break}pe=e.return}}var TP=Math.ceil,bh=Pr.ReactCurrentDispatcher,Ix=Pr.ReactCurrentOwner,us=Pr.ReactCurrentBatchConfig,We=0,qt=null,Mt=null,Jt=0,Vn=0,go=Ei(0),Bt=0,Cc=null,ba=0,lf=0,Dx=0,sc=null,En=null,Lx=0,tl=1/0,lr=null,wh=!1,Hm=null,fi=null,qu=!1,ni=null,_h=0,rc=0,Vm=null,Fd=-1,zd=0;function xn(){return We&6?Rt():Fd!==-1?Fd:Fd=Rt()}function pi(t){return t.mode&1?We&2&&Jt!==0?Jt&-Jt:gP.transition!==null?(zd===0&&(zd=pk()),zd):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:wk(t.type)),t):1}function Ps(t,e,n,s){if(50<rc)throw rc=0,Vm=null,Error(te(185));nu(t,n,s),(!(We&2)||t!==qt)&&(t===qt&&(!(We&2)&&(lf|=n),Bt===4&&Ur(t,Jt)),Dn(t,s),n===1&&We===0&&!(e.mode&1)&&(tl=Rt()+500,sf&&Pi()))}function Dn(t,e){var n=t.callbackNode;g2(t,e);var s=ih(t,t===qt?Jt:0);if(s===0)n!==null&&vv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&vv(n),e===1)t.tag===0?mP(db.bind(null,t)):zk(db.bind(null,t)),dP(function(){!(We&6)&&Pi()}),n=null;else{switch(mk(s)){case 1:n=cx;break;case 4:n=hk;break;case 16:n=rh;break;case 536870912:n=fk;break;default:n=rh}n=$S(n,AS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function AS(t,e){if(Fd=-1,zd=0,We&6)throw Error(te(327));var n=t.callbackNode;if(So()&&t.callbackNode!==n)return null;var s=ih(t,t===qt?Jt:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=kh(t,s);else{e=s;var r=We;We|=2;var i=TS();(qt!==t||Jt!==e)&&(lr=null,tl=Rt()+500,da(t,e));do try{DP();break}catch(o){OS(t,o)}while(!0);_x(),bh.current=i,We=r,Mt!==null?e=0:(qt=null,Jt=0,e=Bt)}if(e!==0){if(e===2&&(r=ym(t),r!==0&&(s=r,e=qm(t,r))),e===1)throw n=Cc,da(t,0),Ur(t,s),Dn(t,Rt()),n;if(e===6)Ur(t,s);else{if(r=t.current.alternate,!(s&30)&&!MP(r)&&(e=kh(t,s),e===2&&(i=ym(t),i!==0&&(s=i,e=qm(t,i))),e===1))throw n=Cc,da(t,0),Ur(t,s),Dn(t,Rt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(te(345));case 2:Hi(t,En,lr);break;case 3:if(Ur(t,s),(s&130023424)===s&&(e=Lx+500-Rt(),10<e)){if(ih(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){xn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Cm(Hi.bind(null,t,En,lr),e);break}Hi(t,En,lr);break;case 4:if(Ur(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var a=31-Es(s);i=1<<a,a=e[a],a>r&&(r=a),s&=~i}if(s=r,s=Rt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*TP(s/1960))-s,10<s){t.timeoutHandle=Cm(Hi.bind(null,t,En,lr),s);break}Hi(t,En,lr);break;case 5:Hi(t,En,lr);break;default:throw Error(te(329))}}}return Dn(t,Rt()),t.callbackNode===n?AS.bind(null,t):null}function qm(t,e){var n=sc;return t.current.memoizedState.isDehydrated&&(da(t,e).flags|=256),t=kh(t,e),t!==2&&(e=En,En=n,e!==null&&Km(e)),t}function Km(t){En===null?En=t:En.push.apply(En,t)}function MP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Rs(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ur(t,e){for(e&=~Dx,e&=~lf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Es(e),s=1<<n;t[n]=-1,e&=~s}}function db(t){if(We&6)throw Error(te(327));So();var e=ih(t,0);if(!(e&1))return Dn(t,Rt()),null;var n=kh(t,e);if(t.tag!==0&&n===2){var s=ym(t);s!==0&&(e=s,n=qm(t,s))}if(n===1)throw n=Cc,da(t,0),Ur(t,e),Dn(t,Rt()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hi(t,En,lr),Dn(t,Rt()),null}function $x(t,e){var n=We;We|=1;try{return t(e)}finally{We=n,We===0&&(tl=Rt()+500,sf&&Pi())}}function wa(t){ni!==null&&ni.tag===0&&!(We&6)&&So();var e=We;We|=1;var n=us.transition,s=Ze;try{if(us.transition=null,Ze=1,t)return t()}finally{Ze=s,us.transition=n,We=e,!(We&6)&&Pi()}}function Fx(){Vn=go.current,pt(go)}function da(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,uP(n)),Mt!==null)for(n=Mt.return;n!==null;){var s=n;switch(vx(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&uh();break;case 3:Zo(),pt(Mn),pt(cn),Ex();break;case 5:Nx(s);break;case 4:Zo();break;case 13:pt(wt);break;case 19:pt(wt);break;case 10:kx(s.type._context);break;case 22:case 23:Fx()}n=n.return}if(qt=t,Mt=t=mi(t.current,null),Jt=Vn=e,Bt=0,Cc=null,Dx=lf=ba=0,En=sc=null,Xi!==null){for(e=0;e<Xi.length;e++)if(n=Xi[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var a=i.next;i.next=r,s.next=a}n.pending=s}Xi=null}return t}function OS(t,e){do{var n=Mt;try{if(_x(),Dd.current=vh,yh){for(var s=_t.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}yh=!1}if(va=0,Ht=Ft=_t=null,tc=!1,kc=0,Ix.current=null,n===null||n.return===null){Bt=1,Cc=e,Mt=null;break}e:{var i=t,a=n.return,o=n,l=e;if(e=Jt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Jv(a);if(p!==null){p.flags&=-257,Zv(p,a,o,i,e),p.mode&1&&Xv(i,u,e),e=p,l=u;var b=e.updateQueue;if(b===null){var x=new Set;x.add(l),e.updateQueue=x}else b.add(l);break e}else{if(!(e&1)){Xv(i,u,e),zx();break e}l=Error(te(426))}}else if(xt&&o.mode&1){var v=Jv(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Zv(v,a,o,i,e),bx(el(l,o));break e}}i=l=el(l,o),Bt!==4&&(Bt=2),sc===null?sc=[i]:sc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=mS(i,l,e);Vv(i,y);break e;case 1:o=l;var g=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(fi===null||!fi.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var _=gS(i,o,e);Vv(i,_);break e}}i=i.return}while(i!==null)}IS(n)}catch(k){e=k,Mt===n&&n!==null&&(Mt=n=n.return);continue}break}while(!0)}function TS(){var t=bh.current;return bh.current=vh,t===null?vh:t}function zx(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),qt===null||!(ba&268435455)&&!(lf&268435455)||Ur(qt,Jt)}function kh(t,e){var n=We;We|=2;var s=TS();(qt!==t||Jt!==e)&&(lr=null,da(t,e));do try{IP();break}catch(r){OS(t,r)}while(!0);if(_x(),We=n,bh.current=s,Mt!==null)throw Error(te(261));return qt=null,Jt=0,Bt}function IP(){for(;Mt!==null;)MS(Mt)}function DP(){for(;Mt!==null&&!o2();)MS(Mt)}function MS(t){var e=LS(t.alternate,t,Vn);t.memoizedProps=t.pendingProps,e===null?IS(t):Mt=e,Ix.current=null}function IS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=PP(n,e),n!==null){n.flags&=32767,Mt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Bt=6,Mt=null;return}}else if(n=EP(n,e,Vn),n!==null){Mt=n;return}if(e=e.sibling,e!==null){Mt=e;return}Mt=e=t}while(e!==null);Bt===0&&(Bt=5)}function Hi(t,e,n){var s=Ze,r=us.transition;try{us.transition=null,Ze=1,LP(t,e,n,s)}finally{us.transition=r,Ze=s}return null}function LP(t,e,n,s){do So();while(ni!==null);if(We&6)throw Error(te(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(x2(t,i),t===qt&&(Mt=qt=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qu||(qu=!0,$S(rh,function(){return So(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=us.transition,us.transition=null;var a=Ze;Ze=1;var o=We;We|=4,Ix.current=null,AP(t,n),PS(n,t),sP(Sm),ah=!!km,Sm=km=null,t.current=n,OP(n),l2(),We=o,Ze=a,us.transition=i}else t.current=n;if(qu&&(qu=!1,ni=t,_h=r),i=t.pendingLanes,i===0&&(fi=null),d2(n.stateNode),Dn(t,Rt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(wh)throw wh=!1,t=Hm,Hm=null,t;return _h&1&&t.tag!==0&&So(),i=t.pendingLanes,i&1?t===Vm?rc++:(rc=0,Vm=t):rc=0,Pi(),null}function So(){if(ni!==null){var t=mk(_h),e=us.transition,n=Ze;try{if(us.transition=null,Ze=16>t?16:t,ni===null)var s=!1;else{if(t=ni,ni=null,_h=0,We&6)throw Error(te(331));var r=We;for(We|=4,pe=t.current;pe!==null;){var i=pe,a=i.child;if(pe.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(pe=u;pe!==null;){var d=pe;switch(d.tag){case 0:case 11:case 15:nc(8,d,i)}var h=d.child;if(h!==null)h.return=d,pe=h;else for(;pe!==null;){d=pe;var f=d.sibling,p=d.return;if(CS(d),d===u){pe=null;break}if(f!==null){f.return=p,pe=f;break}pe=p}}}var b=i.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var v=x.sibling;x.sibling=null,x=v}while(x!==null)}}pe=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,pe=a;else e:for(;pe!==null;){if(i=pe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:nc(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,pe=y;break e}pe=i.return}}var g=t.current;for(pe=g;pe!==null;){a=pe;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,pe=w;else e:for(a=g;pe!==null;){if(o=pe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:of(9,o)}}catch(k){Ct(o,o.return,k)}if(o===a){pe=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,pe=_;break e}pe=o.return}}if(We=r,Pi(),Qs&&typeof Qs.onPostCommitFiberRoot=="function")try{Qs.onPostCommitFiberRoot(Jh,t)}catch{}s=!0}return s}finally{Ze=n,us.transition=e}}return!1}function hb(t,e,n){e=el(n,e),e=mS(t,e,1),t=hi(t,e,1),e=xn(),t!==null&&(nu(t,1,e),Dn(t,e))}function Ct(t,e,n){if(t.tag===3)hb(t,t,n);else for(;e!==null;){if(e.tag===3){hb(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(fi===null||!fi.has(s))){t=el(n,t),t=gS(e,t,1),e=hi(e,t,1),t=xn(),e!==null&&(nu(e,1,t),Dn(e,t));break}}e=e.return}}function $P(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=xn(),t.pingedLanes|=t.suspendedLanes&n,qt===t&&(Jt&n)===n&&(Bt===4||Bt===3&&(Jt&130023424)===Jt&&500>Rt()-Lx?da(t,0):Dx|=n),Dn(t,e)}function DS(t,e){e===0&&(t.mode&1?(e=Du,Du<<=1,!(Du&130023424)&&(Du=4194304)):e=1);var n=xn();t=kr(t,e),t!==null&&(nu(t,e,n),Dn(t,n))}function FP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),DS(t,n)}function zP(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(te(314))}s!==null&&s.delete(e),DS(t,n)}var LS;LS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Mn.current)Rn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Rn=!1,NP(t,e,n);Rn=!!(t.flags&131072)}else Rn=!1,xt&&e.flags&1048576&&Bk(e,fh,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;$d(t,e),t=e.pendingProps;var r=Qo(e,cn.current);ko(e,n),r=Rx(null,e,s,t,r,n);var i=Ax();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,In(s)?(i=!0,dh(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,jx(e),r.updater=af,e.stateNode=r,r._reactInternals=e,Tm(e,s,t,n),e=Dm(null,e,s,!0,i,n)):(e.tag=0,xt&&i&&yx(e),gn(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch($d(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=UP(s),t=ws(s,t),r){case 0:e=Im(null,e,s,t,n);break e;case 1:e=nb(null,e,s,t,n);break e;case 11:e=eb(null,e,s,t,n);break e;case 14:e=tb(null,e,s,ws(s.type,t),n);break e}throw Error(te(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ws(s,r),Im(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ws(s,r),nb(t,e,s,r,n);case 3:e:{if(bS(e),t===null)throw Error(te(387));s=e.pendingProps,i=e.memoizedState,r=i.element,Kk(t,e),gh(e,s,null,n);var a=e.memoizedState;if(s=a.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=el(Error(te(423)),e),e=sb(t,e,s,n,r);break e}else if(s!==r){r=el(Error(te(424)),e),e=sb(t,e,s,n,r);break e}else for(Yn=di(e.stateNode.containerInfo.firstChild),Qn=e,xt=!0,Ns=null,n=Vk(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xo(),s===r){e=Sr(t,e,n);break e}gn(t,e,s,n)}e=e.child}return e;case 5:return Gk(e),t===null&&Rm(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,a=r.children,jm(s,r)?a=null:i!==null&&jm(s,i)&&(e.flags|=32),vS(t,e),gn(t,e,a,n),e.child;case 6:return t===null&&Rm(e),null;case 13:return wS(t,e,n);case 4:return Cx(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Jo(e,null,s,n):gn(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ws(s,r),eb(t,e,s,r,n);case 7:return gn(t,e,e.pendingProps,n),e.child;case 8:return gn(t,e,e.pendingProps.children,n),e.child;case 12:return gn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,a=r.value,ot(ph,s._currentValue),s._currentValue=a,i!==null)if(Rs(i.value,a)){if(i.children===r.children&&!Mn.current){e=Sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=vr(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Am(i.return,n,e),o.lanes|=n;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(te(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),Am(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}gn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,ko(e,n),r=hs(r),s=s(r),e.flags|=1,gn(t,e,s,n),e.child;case 14:return s=e.type,r=ws(s,e.pendingProps),r=ws(s.type,r),tb(t,e,s,r,n);case 15:return xS(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ws(s,r),$d(t,e),e.tag=1,In(s)?(t=!0,dh(e)):t=!1,ko(e,n),pS(e,s,r),Tm(e,s,r,n),Dm(null,e,s,!0,t,n);case 19:return _S(t,e,n);case 22:return yS(t,e,n)}throw Error(te(156,e.tag))};function $S(t,e){return dk(t,e)}function BP(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(t,e,n,s){return new BP(t,e,n,s)}function Bx(t){return t=t.prototype,!(!t||!t.isReactComponent)}function UP(t){if(typeof t=="function")return Bx(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ax)return 11;if(t===ox)return 14}return 2}function mi(t,e){var n=t.alternate;return n===null?(n=cs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bd(t,e,n,s,r,i){var a=2;if(s=t,typeof t=="function")Bx(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case io:return ha(n.children,r,i,e);case ix:a=8,r|=8;break;case sm:return t=cs(12,n,e,r|2),t.elementType=sm,t.lanes=i,t;case rm:return t=cs(13,n,e,r),t.elementType=rm,t.lanes=i,t;case im:return t=cs(19,n,e,r),t.elementType=im,t.lanes=i,t;case G_:return cf(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case q_:a=10;break e;case K_:a=9;break e;case ax:a=11;break e;case ox:a=14;break e;case $r:a=16,s=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=cs(a,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function ha(t,e,n,s){return t=cs(7,t,s,e),t.lanes=n,t}function cf(t,e,n,s){return t=cs(22,t,s,e),t.elementType=G_,t.lanes=n,t.stateNode={isHidden:!1},t}function up(t,e,n){return t=cs(6,t,null,e),t.lanes=n,t}function dp(t,e,n){return e=cs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WP(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vf(0),this.expirationTimes=Vf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vf(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ux(t,e,n,s,r,i,a,o,l){return t=new WP(t,e,n,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cs(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jx(i),t}function HP(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ro,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function FS(t){if(!t)return wi;t=t._reactInternals;e:{if(Pa(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(In(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(In(n))return Fk(t,n,e)}return e}function zS(t,e,n,s,r,i,a,o,l){return t=Ux(n,s,!0,t,r,i,a,o,l),t.context=FS(null),n=t.current,s=xn(),r=pi(n),i=vr(s,r),i.callback=e??null,hi(n,i,r),t.current.lanes=r,nu(t,r,s),Dn(t,s),t}function uf(t,e,n,s){var r=e.current,i=xn(),a=pi(r);return n=FS(n),e.context===null?e.context=n:e.pendingContext=n,e=vr(i,a),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=hi(r,e,a),t!==null&&(Ps(t,r,a,i),Id(t,r,a)),a}function Sh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Wx(t,e){fb(t,e),(t=t.alternate)&&fb(t,e)}function VP(){return null}var BS=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hx(t){this._internalRoot=t}df.prototype.render=Hx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));uf(t,e,null,null)};df.prototype.unmount=Hx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wa(function(){uf(null,t,null,null)}),e[_r]=null}};function df(t){this._internalRoot=t}df.prototype.unstable_scheduleHydration=function(t){if(t){var e=yk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Br.length&&e!==0&&e<Br[n].priority;n++);Br.splice(n,0,t),n===0&&bk(t)}};function Vx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pb(){}function qP(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=Sh(a);i.call(u)}}var a=zS(e,s,t,0,null,!1,!1,"",pb);return t._reactRootContainer=a,t[_r]=a.current,yc(t.nodeType===8?t.parentNode:t),wa(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var o=s;s=function(){var u=Sh(l);o.call(u)}}var l=Ux(t,0,!1,null,null,!1,!1,"",pb);return t._reactRootContainer=l,t[_r]=l.current,yc(t.nodeType===8?t.parentNode:t),wa(function(){uf(e,l,n,s)}),l}function ff(t,e,n,s,r){var i=n._reactRootContainer;if(i){var a=i;if(typeof r=="function"){var o=r;r=function(){var l=Sh(a);o.call(l)}}uf(e,a,t,r)}else a=qP(n,e,t,r,s);return Sh(a)}gk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=$l(e.pendingLanes);n!==0&&(ux(e,n|1),Dn(e,Rt()),!(We&6)&&(tl=Rt()+500,Pi()))}break;case 13:wa(function(){var s=kr(t,1);if(s!==null){var r=xn();Ps(s,t,1,r)}}),Wx(t,1)}};dx=function(t){if(t.tag===13){var e=kr(t,134217728);if(e!==null){var n=xn();Ps(e,t,134217728,n)}Wx(t,134217728)}};xk=function(t){if(t.tag===13){var e=pi(t),n=kr(t,e);if(n!==null){var s=xn();Ps(n,t,e,s)}Wx(t,e)}};yk=function(){return Ze};vk=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};mm=function(t,e,n){switch(e){case"input":if(lm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=nf(s);if(!r)throw Error(te(90));Q_(s),lm(s,r)}}}break;case"textarea":J_(t,n);break;case"select":e=n.value,e!=null&&vo(t,!!n.multiple,e,!1)}};ik=$x;ak=wa;var KP={usingClientEntryPoint:!1,Events:[ru,co,nf,sk,rk,$x]},jl={findFiberByHostInstance:Qi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GP={bundleType:jl.bundleType,version:jl.version,rendererPackageName:jl.rendererPackageName,rendererConfig:jl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ck(t),t===null?null:t.stateNode},findFiberByHostInstance:jl.findFiberByHostInstance||VP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ku.isDisabled&&Ku.supportsFiber)try{Jh=Ku.inject(GP),Qs=Ku}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KP;es.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vx(e))throw Error(te(200));return HP(t,e,null,n)};es.createRoot=function(t,e){if(!Vx(t))throw Error(te(299));var n=!1,s="",r=BS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Ux(t,1,!1,null,null,n,!1,s,r),t[_r]=e.current,yc(t.nodeType===8?t.parentNode:t),new Hx(e)};es.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=ck(e),t=t===null?null:t.stateNode,t};es.flushSync=function(t){return wa(t)};es.hydrate=function(t,e,n){if(!hf(e))throw Error(te(200));return ff(null,t,e,!0,n)};es.hydrateRoot=function(t,e,n){if(!Vx(t))throw Error(te(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",a=BS;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=zS(e,null,t,1,n??null,r,!1,i,a),t[_r]=e.current,yc(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new df(e)};es.render=function(t,e,n){if(!hf(e))throw Error(te(200));return ff(null,t,e,!1,n)};es.unmountComponentAtNode=function(t){if(!hf(t))throw Error(te(40));return t._reactRootContainer?(wa(function(){ff(null,null,t,!1,function(){t._reactRootContainer=null,t[_r]=null})}),!0):!1};es.unstable_batchedUpdates=$x;es.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!hf(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return ff(t,e,n,!1,s)};es.version="18.3.1-next-f1338f8080-20240426";function US(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(US)}catch(t){console.error(t)}}US(),U_.exports=es;var au=U_.exports;const YP=R_(au);var mb=au;tm.createRoot=mb.createRoot,tm.hydrateRoot=mb.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nc(){return Nc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Nc.apply(this,arguments)}var si;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(si||(si={}));const gb="popstate";function QP(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:a,hash:o}=s.location;return Gm("",{pathname:i,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:WS(r)}return JP(e,n,null,t)}function Dt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qx(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function XP(){return Math.random().toString(36).substr(2,8)}function xb(t,e){return{usr:t.state,key:t.key,idx:e}}function Gm(t,e,n,s){return n===void 0&&(n=null),Nc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ol(e):e,{state:n,key:e&&e.key||s||XP()})}function WS(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function ol(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function JP(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,a=r.history,o=si.Pop,l=null,u=d();u==null&&(u=0,a.replaceState(Nc({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function h(){o=si.Pop;let v=d(),y=v==null?null:v-u;u=v,l&&l({action:o,location:x.location,delta:y})}function f(v,y){o=si.Push;let g=Gm(x.location,v,y);u=d()+1;let w=xb(g,u),_=x.createHref(g);try{a.pushState(w,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(_)}i&&l&&l({action:o,location:x.location,delta:1})}function p(v,y){o=si.Replace;let g=Gm(x.location,v,y);u=d();let w=xb(g,u),_=x.createHref(g);a.replaceState(w,"",_),i&&l&&l({action:o,location:x.location,delta:0})}function b(v){let y=r.location.origin!=="null"?r.location.origin:r.location.href,g=typeof v=="string"?v:WS(v);return g=g.replace(/ $/,"%20"),Dt(y,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,y)}let x={get action(){return o},get location(){return t(r,a)},listen(v){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(gb,h),l=v,()=>{r.removeEventListener(gb,h),l=null}},createHref(v){return e(r,v)},createURL:b,encodeLocation(v){let y=b(v);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:p,go(v){return a.go(v)}};return x}var yb;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(yb||(yb={}));function ZP(t,e,n){return n===void 0&&(n="/"),eR(t,e,n)}function eR(t,e,n,s){let r=typeof e=="string"?ol(e):e,i=qS(r.pathname||"/",n);if(i==null)return null;let a=HS(t);tR(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=fR(i);o=uR(a[l],u)}return o}function HS(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,a,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(Dt(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=fa([s,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(Dt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),HS(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:lR(u,i.index),routesMeta:d})};return t.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))r(i,a);else for(let l of VS(i.path))r(i,a,l)}),e}function VS(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let a=VS(s.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),r&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function tR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:cR(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const nR=/^:[\w-]+$/,sR=3,rR=2,iR=1,aR=10,oR=-2,vb=t=>t==="*";function lR(t,e){let n=t.split("/"),s=n.length;return n.some(vb)&&(s+=oR),e&&(s+=rR),n.filter(r=>!vb(r)).reduce((r,i)=>r+(nR.test(i)?sR:i===""?iR:aR),s)}function cR(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function uR(t,e,n){let{routesMeta:s}=t,r={},i="/",a=[];for(let o=0;o<s.length;++o){let l=s[o],u=o===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=dR({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),f=l.route;if(!h)return null;Object.assign(r,h.params),a.push({params:r,pathname:fa([i,h.pathname]),pathnameBase:yR(fa([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=fa([i,h.pathnameBase]))}return a}function dR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=hR(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],a=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let x=o[h]||"";a=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const b=o[h];return p&&!b?u[f]=void 0:u[f]=(b||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:t}}function hR(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),qx(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function fR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qx(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function qS(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const pR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mR=t=>pR.test(t);function gR(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?ol(t):t,i;if(n)if(mR(n))i=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),qx(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+n))}n.startsWith("/")?i=bb(n.substring(1),"/"):i=bb(n,e)}else i=e;return{pathname:i,search:vR(s),hash:bR(r)}}function bb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function hp(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function KS(t,e){let n=xR(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function GS(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=ol(t):(r=Nc({},t),Dt(!r.pathname||!r.pathname.includes("?"),hp("?","pathname","search",r)),Dt(!r.pathname||!r.pathname.includes("#"),hp("#","pathname","hash",r)),Dt(!r.search||!r.search.includes("#"),hp("#","search","hash",r)));let i=t===""||r.pathname==="",a=i?"/":r.pathname,o;if(a==null)o=n;else{let h=e.length-1;if(!s&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;r.pathname=f.join("/")}o=h>=0?e[h]:"/"}let l=gR(r,o),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const fa=t=>t.join("/").replace(/\/\/+/g,"/"),yR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),vR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,bR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function wR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const YS=["post","put","patch","delete"];new Set(YS);const _R=["get",...YS];new Set(_R);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ec(){return Ec=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ec.apply(this,arguments)}const Kx=m.createContext(null),kR=m.createContext(null),ou=m.createContext(null),pf=m.createContext(null),Ri=m.createContext({outlet:null,matches:[],isDataRoute:!1}),QS=m.createContext(null);function lu(){return m.useContext(pf)!=null}function ll(){return lu()||Dt(!1),m.useContext(pf).location}function XS(t){m.useContext(ou).static||m.useLayoutEffect(t)}function cu(){let{isDataRoute:t}=m.useContext(Ri);return t?$R():SR()}function SR(){lu()||Dt(!1);let t=m.useContext(Kx),{basename:e,future:n,navigator:s}=m.useContext(ou),{matches:r}=m.useContext(Ri),{pathname:i}=ll(),a=JSON.stringify(KS(r,n.v7_relativeSplatPath)),o=m.useRef(!1);return XS(()=>{o.current=!0}),m.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let h=GS(u,JSON.parse(a),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:fa([e,h.pathname])),(d.replace?s.replace:s.push)(h,d.state,d)},[e,s,a,i,t])}const jR=m.createContext(null);function CR(t){let e=m.useContext(Ri).outlet;return e&&m.createElement(jR.Provider,{value:t},e)}function NR(t,e){return ER(t,e)}function ER(t,e,n,s){lu()||Dt(!1);let{navigator:r}=m.useContext(ou),{matches:i}=m.useContext(Ri),a=i[i.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=ll(),d;if(e){var h;let v=typeof e=="string"?ol(e):e;l==="/"||(h=v.pathname)!=null&&h.startsWith(l)||Dt(!1),d=v}else d=u;let f=d.pathname||"/",p=f;if(l!=="/"){let v=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let b=ZP(t,{pathname:p}),x=TR(b&&b.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:fa([l,r.encodeLocation?r.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:fa([l,r.encodeLocation?r.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,n,s);return e&&x?m.createElement(pf.Provider,{value:{location:Ec({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:si.Pop}},x):x}function PR(){let t=LR(),e=wR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),n?m.createElement("pre",{style:r},n):null,null)}const RR=m.createElement(PR,null);class AR extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?m.createElement(Ri.Provider,{value:this.props.routeContext},m.createElement(QS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function OR(t){let{routeContext:e,match:n,children:s}=t,r=m.useContext(Kx);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),m.createElement(Ri.Provider,{value:e},s)}function TR(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=(r=n)==null?void 0:r.errors;if(o!=null){let d=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||Dt(!1),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<a.length;d++){let h=a[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=n,b=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||b){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,h,f)=>{let p,b=!1,x=null,v=null;n&&(p=o&&h.route.id?o[h.route.id]:void 0,x=h.route.errorElement||RR,l&&(u<0&&f===0?(FR("route-fallback"),b=!0,v=null):u===f&&(b=!0,v=h.route.hydrateFallbackElement||null)));let y=e.concat(a.slice(0,f+1)),g=()=>{let w;return p?w=x:b?w=v:h.route.Component?w=m.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=d,m.createElement(OR,{match:h,routeContext:{outlet:d,matches:y,isDataRoute:n!=null},children:w})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?m.createElement(AR,{location:n.location,revalidation:n.revalidation,component:x,error:p,children:g(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):g()},null)}var JS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(JS||{}),ZS=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ZS||{});function MR(t){let e=m.useContext(Kx);return e||Dt(!1),e}function IR(t){let e=m.useContext(kR);return e||Dt(!1),e}function DR(t){let e=m.useContext(Ri);return e||Dt(!1),e}function e1(t){let e=DR(),n=e.matches[e.matches.length-1];return n.route.id||Dt(!1),n.route.id}function LR(){var t;let e=m.useContext(QS),n=IR(),s=e1();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function $R(){let{router:t}=MR(JS.UseNavigateStable),e=e1(ZS.UseNavigateStable),n=m.useRef(!1);return XS(()=>{n.current=!0}),m.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Ec({fromRouteId:e},i)))},[t,e])}const wb={};function FR(t,e,n){wb[t]||(wb[t]=!0)}function zR(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Ud(t){let{to:e,replace:n,state:s,relative:r}=t;lu()||Dt(!1);let{future:i,static:a}=m.useContext(ou),{matches:o}=m.useContext(Ri),{pathname:l}=ll(),u=cu(),d=GS(e,KS(o,i.v7_relativeSplatPath),l,r==="path"),h=JSON.stringify(d);return m.useEffect(()=>u(JSON.parse(h),{replace:n,state:s,relative:r}),[u,h,r,n,s]),null}function BR(t){return CR(t.context)}function hn(t){Dt(!1)}function UR(t){let{basename:e="/",children:n=null,location:s,navigationType:r=si.Pop,navigator:i,static:a=!1,future:o}=t;lu()&&Dt(!1);let l=e.replace(/^\/*/,"/"),u=m.useMemo(()=>({basename:l,navigator:i,static:a,future:Ec({v7_relativeSplatPath:!1},o)}),[l,o,i,a]);typeof s=="string"&&(s=ol(s));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:b="default"}=s,x=m.useMemo(()=>{let v=qS(d,l);return v==null?null:{location:{pathname:v,search:h,hash:f,state:p,key:b},navigationType:r}},[l,d,h,f,p,b,r]);return x==null?null:m.createElement(ou.Provider,{value:u},m.createElement(pf.Provider,{children:n,value:x}))}function WR(t){let{children:e,location:n}=t;return NR(Ym(e),n)}new Promise(()=>{});function Ym(t,e){e===void 0&&(e=[]);let n=[];return m.Children.forEach(t,(s,r)=>{if(!m.isValidElement(s))return;let i=[...e,r];if(s.type===m.Fragment){n.push.apply(n,Ym(s.props.children,i));return}s.type!==hn&&Dt(!1),!s.props.index||!s.props.children||Dt(!1);let a={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Ym(s.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const HR="6";try{window.__reactRouterVersion=HR}catch{}const VR="startTransition",_b=Xh[VR];function qR(t){let{basename:e,children:n,future:s,window:r}=t,i=m.useRef();i.current==null&&(i.current=QP({window:r,v5Compat:!0}));let a=i.current,[o,l]=m.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},d=m.useCallback(h=>{u&&_b?_b(()=>l(h)):l(h)},[l,u]);return m.useLayoutEffect(()=>a.listen(d),[a,d]),m.useEffect(()=>zR(s),[s]),m.createElement(UR,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a,future:s})}var kb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(kb||(kb={}));var Sb;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Sb||(Sb={}));var jh=["light","dark"],Gx="(prefers-color-scheme: dark)",KR=typeof window>"u",Yx=m.createContext(void 0),GR={setTheme:t=>{},themes:[]},YR=()=>{var t;return(t=m.useContext(Yx))!=null?t:GR},QR=t=>m.useContext(Yx)?t.children:m.createElement(JR,{...t}),XR=["light","dark"],JR=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:s=!0,storageKey:r="theme",themes:i=XR,defaultTheme:a=n?"system":"light",attribute:o="data-theme",value:l,children:u,nonce:d})=>{let[h,f]=m.useState(()=>jb(r,a)),[p,b]=m.useState(()=>jb(r)),x=l?Object.values(l):i,v=m.useCallback(_=>{let k=_;if(!k)return;_==="system"&&n&&(k=Cb());let S=l?l[k]:k,j=e?eA():null,N=document.documentElement;if(o==="class"?(N.classList.remove(...x),S&&N.classList.add(S)):S?N.setAttribute(o,S):N.removeAttribute(o),s){let T=jh.includes(a)?a:null,A=jh.includes(k)?k:T;N.style.colorScheme=A}j==null||j()},[]),y=m.useCallback(_=>{let k=typeof _=="function"?_(_):_;f(k);try{localStorage.setItem(r,k)}catch{}},[t]),g=m.useCallback(_=>{let k=Cb(_);b(k),h==="system"&&n&&!t&&v("system")},[h,t]);m.useEffect(()=>{let _=window.matchMedia(Gx);return _.addListener(g),g(_),()=>_.removeListener(g)},[g]),m.useEffect(()=>{let _=k=>{if(k.key!==r)return;let S=k.newValue||a;y(S)};return window.addEventListener("storage",_),()=>window.removeEventListener("storage",_)},[y]),m.useEffect(()=>{v(t??h)},[t,h]);let w=m.useMemo(()=>({theme:h,setTheme:y,forcedTheme:t,resolvedTheme:h==="system"?p:h,themes:n?[...i,"system"]:i,systemTheme:n?p:void 0}),[h,y,t,p,n,i]);return m.createElement(Yx.Provider,{value:w},m.createElement(ZR,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:s,storageKey:r,themes:i,defaultTheme:a,attribute:o,value:l,children:u,attrs:x,nonce:d}),u)},ZR=m.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:s,enableColorScheme:r,defaultTheme:i,value:a,attrs:o,nonce:l})=>{let u=i==="system",d=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(b=>`'${b}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=r?jh.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(b,x=!1,v=!0)=>{let y=a?a[b]:b,g=x?b+"|| ''":`'${y}'`,w="";return r&&v&&!x&&jh.includes(b)&&(w+=`d.style.colorScheme = '${b}';`),n==="class"?x||y?w+=`c.add(${g})`:w+="null":y&&(w+=`d[s](n,${g})`),w},p=t?`!function(){${d}${f(t)}}()`:s?`!function(){try{${d}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${Gx}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${e}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${f(a?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return m.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),jb=(t,e)=>{if(KR)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},eA=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},Cb=t=>(t||(t=window.matchMedia(Gx)),t.matches?"dark":"light"),Ra=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},tA={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Vr,Xg,y_,nA=(y_=class{constructor(){fe(this,Vr,tA);fe(this,Xg,!1)}setTimeoutProvider(t){se(this,Vr,t)}setTimeout(t,e){return R(this,Vr).setTimeout(t,e)}clearTimeout(t){R(this,Vr).clearTimeout(t)}setInterval(t,e){return R(this,Vr).setInterval(t,e)}clearInterval(t){R(this,Vr).clearInterval(t)}},Vr=new WeakMap,Xg=new WeakMap,y_),Zi=new nA;function sA(t){setTimeout(t,0)}var _a=typeof window>"u"||"Deno"in globalThis;function rn(){}function rA(t,e){return typeof t=="function"?t(e):t}function Qm(t){return typeof t=="number"&&t>=0&&t!==1/0}function t1(t,e){return Math.max(t+(e||0)-Date.now(),0)}function gi(t,e){return typeof t=="function"?t(e):t}function as(t,e){return typeof t=="function"?t(e):t}function Nb(t,e){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:a,stale:o}=t;if(a){if(s){if(e.queryHash!==Qx(a,e.options))return!1}else if(!Pc(e.queryKey,a))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||r&&r!==e.state.fetchStatus||i&&!i(e))}function Eb(t,e){const{exact:n,status:s,predicate:r,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(ka(e.options.mutationKey)!==ka(i))return!1}else if(!Pc(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||r&&!r(e))}function Qx(t,e){return((e==null?void 0:e.queryKeyHashFn)||ka)(t)}function ka(t){return JSON.stringify(t,(e,n)=>Xm(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Pc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Pc(t[n],e[n])):!1}var iA=Object.prototype.hasOwnProperty;function Xx(t,e){if(t===e)return t;const n=Pb(t)&&Pb(e);if(!n&&!(Xm(t)&&Xm(e)))return e;const r=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),a=i.length,o=n?new Array(a):{};let l=0;for(let u=0;u<a;u++){const d=n?u:i[u],h=t[d],f=e[d];if(h===f){o[d]=h,(n?u<r:iA.call(t,d))&&l++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){o[d]=f;continue}const p=Xx(h,f);o[d]=p,p===h&&l++}return r===a&&l===r?t:o}function Rc(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Pb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Xm(t){if(!Rb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Rb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Rb(t){return Object.prototype.toString.call(t)==="[object Object]"}function aA(t){return new Promise(e=>{Zi.setTimeout(e,t)})}function Jm(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Xx(t,e):e}function oA(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function lA(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var Jx=Symbol();function n1(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Jx?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function s1(t,e){return typeof t=="function"?t(...e):!!t}var na,qr,Mo,v_,cA=(v_=class extends Ra{constructor(){super();fe(this,na);fe(this,qr);fe(this,Mo);se(this,Mo,e=>{if(!_a&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){R(this,qr)||this.setEventListener(R(this,Mo))}onUnsubscribe(){var e;this.hasListeners()||((e=R(this,qr))==null||e.call(this),se(this,qr,void 0))}setEventListener(e){var n;se(this,Mo,e),(n=R(this,qr))==null||n.call(this),se(this,qr,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){R(this,na)!==e&&(se(this,na,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof R(this,na)=="boolean"?R(this,na):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},na=new WeakMap,qr=new WeakMap,Mo=new WeakMap,v_),Zx=new cA;function Zm(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),t(r)},n.reject=r=>{s({status:"rejected",reason:r}),e(r)},n}var uA=sA;function dA(){let t=[],e=0,n=o=>{o()},s=o=>{o()},r=uA;const i=o=>{e?t.push(o):r(()=>{n(o)})},a=()=>{const o=t;t=[],o.length&&r(()=>{s(()=>{o.forEach(l=>{n(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{i(()=>{o(...l)})},schedule:i,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{s=o},setScheduler:o=>{r=o}}}var Nt=dA(),Io,Kr,Do,b_,hA=(b_=class extends Ra{constructor(){super();fe(this,Io,!0);fe(this,Kr);fe(this,Do);se(this,Do,e=>{if(!_a&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){R(this,Kr)||this.setEventListener(R(this,Do))}onUnsubscribe(){var e;this.hasListeners()||((e=R(this,Kr))==null||e.call(this),se(this,Kr,void 0))}setEventListener(e){var n;se(this,Do,e),(n=R(this,Kr))==null||n.call(this),se(this,Kr,e(this.setOnline.bind(this)))}setOnline(e){R(this,Io)!==e&&(se(this,Io,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return R(this,Io)}},Io=new WeakMap,Kr=new WeakMap,Do=new WeakMap,b_),Ch=new hA;function fA(t){return Math.min(1e3*2**t,3e4)}function r1(t){return(t??"online")==="online"?Ch.isOnline():!0}var eg=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function i1(t){let e=!1,n=0,s;const r=Zm(),i=()=>r.status!=="pending",a=x=>{var v;if(!i()){const y=new eg(x);f(y),(v=t.onCancel)==null||v.call(t,y)}},o=()=>{e=!0},l=()=>{e=!1},u=()=>Zx.isFocused()&&(t.networkMode==="always"||Ch.isOnline())&&t.canRun(),d=()=>r1(t.networkMode)&&t.canRun(),h=x=>{i()||(s==null||s(),r.resolve(x))},f=x=>{i()||(s==null||s(),r.reject(x))},p=()=>new Promise(x=>{var v;s=y=>{(i()||u())&&x(y)},(v=t.onPause)==null||v.call(t)}).then(()=>{var x;s=void 0,i()||(x=t.onContinue)==null||x.call(t)}),b=()=>{if(i())return;let x;const v=n===0?t.initialPromise:void 0;try{x=v??t.fn()}catch(y){x=Promise.reject(y)}Promise.resolve(x).then(h).catch(y=>{var S;if(i())return;const g=t.retry??(_a?0:3),w=t.retryDelay??fA,_=typeof w=="function"?w(n,y):w,k=g===!0||typeof g=="number"&&n<g||typeof g=="function"&&g(n,y);if(e||!k){f(y);return}n++,(S=t.onFail)==null||S.call(t,n,y),aA(_).then(()=>u()?void 0:p()).then(()=>{e?f(y):b()})})};return{promise:r,status:()=>r.status,cancel:a,continue:()=>(s==null||s(),r),cancelRetry:o,continueRetry:l,canStart:d,start:()=>(d()?b():p().then(b),r)}}var sa,w_,a1=(w_=class{constructor(){fe(this,sa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Qm(this.gcTime)&&se(this,sa,Zi.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(_a?1/0:5*60*1e3))}clearGcTimeout(){R(this,sa)&&(Zi.clearTimeout(R(this,sa)),se(this,sa,void 0))}},sa=new WeakMap,w_),ra,Lo,rs,ia,Wt,Kc,aa,ks,ir,__,pA=(__=class extends a1{constructor(e){super();fe(this,ks);fe(this,ra);fe(this,Lo);fe(this,rs);fe(this,ia);fe(this,Wt);fe(this,Kc);fe(this,aa);se(this,aa,!1),se(this,Kc,e.defaultOptions),this.setOptions(e.options),this.observers=[],se(this,ia,e.client),se(this,rs,R(this,ia).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,se(this,ra,Ob(this.options)),this.state=e.state??R(this,ra),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=R(this,Wt))==null?void 0:e.promise}setOptions(e){if(this.options={...R(this,Kc),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Ob(this.options);n.data!==void 0&&(this.setState(Ab(n.data,n.dataUpdatedAt)),se(this,ra,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&R(this,rs).remove(this)}setData(e,n){const s=Jm(this.state.data,e,this.options);return Pe(this,ks,ir).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){Pe(this,ks,ir).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,r;const n=(s=R(this,Wt))==null?void 0:s.promise;return(r=R(this,Wt))==null||r.cancel(e),n?n.then(rn).catch(rn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(R(this,ra))}isActive(){return this.observers.some(e=>as(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Jx||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>gi(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!t1(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=R(this,Wt))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=R(this,Wt))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),R(this,rs).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(R(this,Wt)&&(R(this,aa)?R(this,Wt).cancel({revert:!0}):R(this,Wt).cancelRetry()),this.scheduleGc()),R(this,rs).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Pe(this,ks,ir).call(this,{type:"invalidate"})}async fetch(e,n){var l,u,d,h,f,p,b,x,v,y,g,w;if(this.state.fetchStatus!=="idle"&&((l=R(this,Wt))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(R(this,Wt))return R(this,Wt).continueRetry(),R(this,Wt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const _=this.observers.find(k=>k.options.queryFn);_&&this.setOptions(_.options)}const s=new AbortController,r=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(se(this,aa,!0),s.signal)})},i=()=>{const _=n1(this.options,n),S=(()=>{const j={client:R(this,ia),queryKey:this.queryKey,meta:this.meta};return r(j),j})();return se(this,aa,!1),this.options.persister?this.options.persister(_,S,this):_(S)},o=(()=>{const _={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:R(this,ia),state:this.state,fetchFn:i};return r(_),_})();(u=this.options.behavior)==null||u.onFetch(o,this),se(this,Lo,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&Pe(this,ks,ir).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),se(this,Wt,i1({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,onCancel:_=>{_ instanceof eg&&_.revert&&this.setState({...R(this,Lo),fetchStatus:"idle"}),s.abort()},onFail:(_,k)=>{Pe(this,ks,ir).call(this,{type:"failed",failureCount:_,error:k})},onPause:()=>{Pe(this,ks,ir).call(this,{type:"pause"})},onContinue:()=>{Pe(this,ks,ir).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const _=await R(this,Wt).start();if(_===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(_),(p=(f=R(this,rs).config).onSuccess)==null||p.call(f,_,this),(x=(b=R(this,rs).config).onSettled)==null||x.call(b,_,this.state.error,this),_}catch(_){if(_ instanceof eg){if(_.silent)return R(this,Wt).promise;if(_.revert){if(this.state.data===void 0)throw _;return this.state.data}}throw Pe(this,ks,ir).call(this,{type:"error",error:_}),(y=(v=R(this,rs).config).onError)==null||y.call(v,_,this),(w=(g=R(this,rs).config).onSettled)==null||w.call(g,this.state.data,_,this),_}finally{this.scheduleGc()}}},ra=new WeakMap,Lo=new WeakMap,rs=new WeakMap,ia=new WeakMap,Wt=new WeakMap,Kc=new WeakMap,aa=new WeakMap,ks=new WeakSet,ir=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...o1(s.data,this.options),fetchMeta:e.meta??null};case"success":const r={...s,...Ab(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return se(this,Lo,e.manual?r:void 0),r;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),Nt.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),R(this,rs).notify({query:this,type:"updated",action:e})})},__);function o1(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:r1(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Ab(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ob(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Cn,ze,Gc,fn,oa,$o,hr,Gr,Yc,Fo,zo,la,ca,Yr,Bo,Xe,zl,tg,ng,sg,rg,ig,ag,og,l1,k_,ey=(k_=class extends Ra{constructor(e,n){super();fe(this,Xe);fe(this,Cn);fe(this,ze);fe(this,Gc);fe(this,fn);fe(this,oa);fe(this,$o);fe(this,hr);fe(this,Gr);fe(this,Yc);fe(this,Fo);fe(this,zo);fe(this,la);fe(this,ca);fe(this,Yr);fe(this,Bo,new Set);this.options=n,se(this,Cn,e),se(this,Gr,null),se(this,hr,Zm()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(R(this,ze).addObserver(this),Tb(R(this,ze),this.options)?Pe(this,Xe,zl).call(this):this.updateResult(),Pe(this,Xe,rg).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return lg(R(this,ze),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return lg(R(this,ze),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Pe(this,Xe,ig).call(this),Pe(this,Xe,ag).call(this),R(this,ze).removeObserver(this)}setOptions(e){const n=this.options,s=R(this,ze);if(this.options=R(this,Cn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof as(this.options.enabled,R(this,ze))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Pe(this,Xe,og).call(this),R(this,ze).setOptions(this.options),n._defaulted&&!Rc(this.options,n)&&R(this,Cn).getQueryCache().notify({type:"observerOptionsUpdated",query:R(this,ze),observer:this});const r=this.hasListeners();r&&Mb(R(this,ze),s,this.options,n)&&Pe(this,Xe,zl).call(this),this.updateResult(),r&&(R(this,ze)!==s||as(this.options.enabled,R(this,ze))!==as(n.enabled,R(this,ze))||gi(this.options.staleTime,R(this,ze))!==gi(n.staleTime,R(this,ze)))&&Pe(this,Xe,tg).call(this);const i=Pe(this,Xe,ng).call(this);r&&(R(this,ze)!==s||as(this.options.enabled,R(this,ze))!==as(n.enabled,R(this,ze))||i!==R(this,Yr))&&Pe(this,Xe,sg).call(this,i)}getOptimisticResult(e){const n=R(this,Cn).getQueryCache().build(R(this,Cn),e),s=this.createResult(n,e);return gA(this,s)&&(se(this,fn,s),se(this,$o,this.options),se(this,oa,R(this,ze).state)),s}getCurrentResult(){return R(this,fn)}trackResult(e,n){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),n==null||n(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&R(this,hr).status==="pending"&&R(this,hr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){R(this,Bo).add(e)}getCurrentQuery(){return R(this,ze)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=R(this,Cn).defaultQueryOptions(e),s=R(this,Cn).getQueryCache().build(R(this,Cn),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return Pe(this,Xe,zl).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),R(this,fn)))}createResult(e,n){var T;const s=R(this,ze),r=this.options,i=R(this,fn),a=R(this,oa),o=R(this,$o),u=e!==s?e.state:R(this,Gc),{state:d}=e;let h={...d},f=!1,p;if(n._optimisticResults){const A=this.hasListeners(),z=!A&&Tb(e,n),M=A&&Mb(e,s,n,r);(z||M)&&(h={...h,...o1(d.data,e.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:b,errorUpdatedAt:x,status:v}=h;p=h.data;let y=!1;if(n.placeholderData!==void 0&&p===void 0&&v==="pending"){let A;i!=null&&i.isPlaceholderData&&n.placeholderData===(o==null?void 0:o.placeholderData)?(A=i.data,y=!0):A=typeof n.placeholderData=="function"?n.placeholderData((T=R(this,zo))==null?void 0:T.state.data,R(this,zo)):n.placeholderData,A!==void 0&&(v="success",p=Jm(i==null?void 0:i.data,A,n),f=!0)}if(n.select&&p!==void 0&&!y)if(i&&p===(a==null?void 0:a.data)&&n.select===R(this,Yc))p=R(this,Fo);else try{se(this,Yc,n.select),p=n.select(p),p=Jm(i==null?void 0:i.data,p,n),se(this,Fo,p),se(this,Gr,null)}catch(A){se(this,Gr,A)}R(this,Gr)&&(b=R(this,Gr),p=R(this,Fo),x=Date.now(),v="error");const g=h.fetchStatus==="fetching",w=v==="pending",_=v==="error",k=w&&g,S=p!==void 0,N={status:v,fetchStatus:h.fetchStatus,isPending:w,isSuccess:v==="success",isError:_,isInitialLoading:k,isLoading:k,data:p,dataUpdatedAt:h.dataUpdatedAt,error:b,errorUpdatedAt:x,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:g,isRefetching:g&&!w,isLoadingError:_&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:_&&S,isStale:ty(e,n),refetch:this.refetch,promise:R(this,hr),isEnabled:as(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const A=I=>{N.status==="error"?I.reject(N.error):N.data!==void 0&&I.resolve(N.data)},z=()=>{const I=se(this,hr,N.promise=Zm());A(I)},M=R(this,hr);switch(M.status){case"pending":e.queryHash===s.queryHash&&A(M);break;case"fulfilled":(N.status==="error"||N.data!==M.value)&&z();break;case"rejected":(N.status!=="error"||N.error!==M.reason)&&z();break}}return N}updateResult(){const e=R(this,fn),n=this.createResult(R(this,ze),this.options);if(se(this,oa,R(this,ze).state),se(this,$o,this.options),R(this,oa).data!==void 0&&se(this,zo,R(this,ze)),Rc(n,e))return;se(this,fn,n);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!R(this,Bo).size)return!0;const a=new Set(i??R(this,Bo));return this.options.throwOnError&&a.add("error"),Object.keys(R(this,fn)).some(o=>{const l=o;return R(this,fn)[l]!==e[l]&&a.has(l)})};Pe(this,Xe,l1).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Pe(this,Xe,rg).call(this)}},Cn=new WeakMap,ze=new WeakMap,Gc=new WeakMap,fn=new WeakMap,oa=new WeakMap,$o=new WeakMap,hr=new WeakMap,Gr=new WeakMap,Yc=new WeakMap,Fo=new WeakMap,zo=new WeakMap,la=new WeakMap,ca=new WeakMap,Yr=new WeakMap,Bo=new WeakMap,Xe=new WeakSet,zl=function(e){Pe(this,Xe,og).call(this);let n=R(this,ze).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(rn)),n},tg=function(){Pe(this,Xe,ig).call(this);const e=gi(this.options.staleTime,R(this,ze));if(_a||R(this,fn).isStale||!Qm(e))return;const s=t1(R(this,fn).dataUpdatedAt,e)+1;se(this,la,Zi.setTimeout(()=>{R(this,fn).isStale||this.updateResult()},s))},ng=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(R(this,ze)):this.options.refetchInterval)??!1},sg=function(e){Pe(this,Xe,ag).call(this),se(this,Yr,e),!(_a||as(this.options.enabled,R(this,ze))===!1||!Qm(R(this,Yr))||R(this,Yr)===0)&&se(this,ca,Zi.setInterval(()=>{(this.options.refetchIntervalInBackground||Zx.isFocused())&&Pe(this,Xe,zl).call(this)},R(this,Yr)))},rg=function(){Pe(this,Xe,tg).call(this),Pe(this,Xe,sg).call(this,Pe(this,Xe,ng).call(this))},ig=function(){R(this,la)&&(Zi.clearTimeout(R(this,la)),se(this,la,void 0))},ag=function(){R(this,ca)&&(Zi.clearInterval(R(this,ca)),se(this,ca,void 0))},og=function(){const e=R(this,Cn).getQueryCache().build(R(this,Cn),this.options);if(e===R(this,ze))return;const n=R(this,ze);se(this,ze,e),se(this,Gc,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},l1=function(e){Nt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(R(this,fn))}),R(this,Cn).getQueryCache().notify({query:R(this,ze),type:"observerResultsUpdated"})})},k_);function mA(t,e){return as(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Tb(t,e){return mA(t,e)||t.state.data!==void 0&&lg(t,e,e.refetchOnMount)}function lg(t,e,n){if(as(e.enabled,t)!==!1&&gi(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&ty(t,e)}return!1}function Mb(t,e,n,s){return(t!==e||as(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&ty(t,n)}function ty(t,e){return as(e.enabled,t)!==!1&&t.isStaleByTime(gi(e.staleTime,t))}function gA(t,e){return!Rc(t.getCurrentResult(),e)}function Ib(t){return{onFetch:(e,n)=>{var d,h,f,p,b;const s=e.options,r=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],a=((b=e.state.data)==null?void 0:b.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let x=!1;const v=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?x=!0:e.signal.addEventListener("abort",()=>{x=!0}),e.signal)})},y=n1(e.options,e.fetchOptions),g=async(w,_,k)=>{if(x)return Promise.reject();if(_==null&&w.pages.length)return Promise.resolve(w);const j=(()=>{const z={client:e.client,queryKey:e.queryKey,pageParam:_,direction:k?"backward":"forward",meta:e.options.meta};return v(z),z})(),N=await y(j),{maxPages:T}=e.options,A=k?lA:oA;return{pages:A(w.pages,N,T),pageParams:A(w.pageParams,_,T)}};if(r&&i.length){const w=r==="backward",_=w?xA:Db,k={pages:i,pageParams:a},S=_(s,k);o=await g(k,S,w)}else{const w=t??i.length;do{const _=l===0?a[0]??s.initialPageParam:Db(s,o);if(l>0&&_==null)break;o=await g(o,_),l++}while(l<w)}return o};e.options.persister?e.fetchFn=()=>{var x,v;return(v=(x=e.options).persister)==null?void 0:v.call(x,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function Db(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function xA(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var Qc,Ws,pn,ua,Hs,Dr,S_,yA=(S_=class extends a1{constructor(e){super();fe(this,Hs);fe(this,Qc);fe(this,Ws);fe(this,pn);fe(this,ua);se(this,Qc,e.client),this.mutationId=e.mutationId,se(this,pn,e.mutationCache),se(this,Ws,[]),this.state=e.state||c1(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){R(this,Ws).includes(e)||(R(this,Ws).push(e),this.clearGcTimeout(),R(this,pn).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){se(this,Ws,R(this,Ws).filter(n=>n!==e)),this.scheduleGc(),R(this,pn).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){R(this,Ws).length||(this.state.status==="pending"?this.scheduleGc():R(this,pn).remove(this))}continue(){var e;return((e=R(this,ua))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,o,l,u,d,h,f,p,b,x,v,y,g,w,_,k,S,j,N,T;const n=()=>{Pe(this,Hs,Dr).call(this,{type:"continue"})},s={client:R(this,Qc),meta:this.options.meta,mutationKey:this.options.mutationKey};se(this,ua,i1({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(A,z)=>{Pe(this,Hs,Dr).call(this,{type:"failed",failureCount:A,error:z})},onPause:()=>{Pe(this,Hs,Dr).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>R(this,pn).canRun(this)}));const r=this.state.status==="pending",i=!R(this,ua).canStart();try{if(r)n();else{Pe(this,Hs,Dr).call(this,{type:"pending",variables:e,isPaused:i}),await((o=(a=R(this,pn).config).onMutate)==null?void 0:o.call(a,e,this,s));const z=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,e,s));z!==this.state.context&&Pe(this,Hs,Dr).call(this,{type:"pending",context:z,variables:e,isPaused:i})}const A=await R(this,ua).start();return await((h=(d=R(this,pn).config).onSuccess)==null?void 0:h.call(d,A,e,this.state.context,this,s)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,A,e,this.state.context,s)),await((x=(b=R(this,pn).config).onSettled)==null?void 0:x.call(b,A,null,this.state.variables,this.state.context,this,s)),await((y=(v=this.options).onSettled)==null?void 0:y.call(v,A,null,e,this.state.context,s)),Pe(this,Hs,Dr).call(this,{type:"success",data:A}),A}catch(A){try{throw await((w=(g=R(this,pn).config).onError)==null?void 0:w.call(g,A,e,this.state.context,this,s)),await((k=(_=this.options).onError)==null?void 0:k.call(_,A,e,this.state.context,s)),await((j=(S=R(this,pn).config).onSettled)==null?void 0:j.call(S,void 0,A,this.state.variables,this.state.context,this,s)),await((T=(N=this.options).onSettled)==null?void 0:T.call(N,void 0,A,e,this.state.context,s)),A}finally{Pe(this,Hs,Dr).call(this,{type:"error",error:A})}}finally{R(this,pn).runNext(this)}}},Qc=new WeakMap,Ws=new WeakMap,pn=new WeakMap,ua=new WeakMap,Hs=new WeakSet,Dr=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Nt.batch(()=>{R(this,Ws).forEach(s=>{s.onMutationUpdate(e)}),R(this,pn).notify({mutation:this,type:"updated",action:e})})},S_);function c1(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var fr,Ss,Xc,j_,vA=(j_=class extends Ra{constructor(e={}){super();fe(this,fr);fe(this,Ss);fe(this,Xc);this.config=e,se(this,fr,new Set),se(this,Ss,new Map),se(this,Xc,0)}build(e,n,s){const r=new yA({client:e,mutationCache:this,mutationId:++Ru(this,Xc)._,options:e.defaultMutationOptions(n),state:s});return this.add(r),r}add(e){R(this,fr).add(e);const n=Gu(e);if(typeof n=="string"){const s=R(this,Ss).get(n);s?s.push(e):R(this,Ss).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(R(this,fr).delete(e)){const n=Gu(e);if(typeof n=="string"){const s=R(this,Ss).get(n);if(s)if(s.length>1){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}else s[0]===e&&R(this,Ss).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Gu(e);if(typeof n=="string"){const s=R(this,Ss).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===e}else return!0}runNext(e){var s;const n=Gu(e);if(typeof n=="string"){const r=(s=R(this,Ss).get(n))==null?void 0:s.find(i=>i!==e&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Nt.batch(()=>{R(this,fr).forEach(e=>{this.notify({type:"removed",mutation:e})}),R(this,fr).clear(),R(this,Ss).clear()})}getAll(){return Array.from(R(this,fr))}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Eb(n,s))}findAll(e={}){return this.getAll().filter(n=>Eb(e,n))}notify(e){Nt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Nt.batch(()=>Promise.all(e.map(n=>n.continue().catch(rn))))}},fr=new WeakMap,Ss=new WeakMap,Xc=new WeakMap,j_);function Gu(t){var e;return(e=t.options.scope)==null?void 0:e.id}var pr,Qr,Nn,mr,br,Wd,cg,C_,bA=(C_=class extends Ra{constructor(n,s){super();fe(this,br);fe(this,pr);fe(this,Qr);fe(this,Nn);fe(this,mr);se(this,pr,n),this.setOptions(s),this.bindMethods(),Pe(this,br,Wd).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const s=this.options;this.options=R(this,pr).defaultMutationOptions(n),Rc(this.options,s)||R(this,pr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:R(this,Nn),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&ka(s.mutationKey)!==ka(this.options.mutationKey)?this.reset():((r=R(this,Nn))==null?void 0:r.state.status)==="pending"&&R(this,Nn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=R(this,Nn))==null||n.removeObserver(this)}onMutationUpdate(n){Pe(this,br,Wd).call(this),Pe(this,br,cg).call(this,n)}getCurrentResult(){return R(this,Qr)}reset(){var n;(n=R(this,Nn))==null||n.removeObserver(this),se(this,Nn,void 0),Pe(this,br,Wd).call(this),Pe(this,br,cg).call(this)}mutate(n,s){var r;return se(this,mr,s),(r=R(this,Nn))==null||r.removeObserver(this),se(this,Nn,R(this,pr).getMutationCache().build(R(this,pr),this.options)),R(this,Nn).addObserver(this),R(this,Nn).execute(n)}},pr=new WeakMap,Qr=new WeakMap,Nn=new WeakMap,mr=new WeakMap,br=new WeakSet,Wd=function(){var s;const n=((s=R(this,Nn))==null?void 0:s.state)??c1();se(this,Qr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},cg=function(n){Nt.batch(()=>{var s,r,i,a,o,l,u,d;if(R(this,mr)&&this.hasListeners()){const h=R(this,Qr).variables,f=R(this,Qr).context,p={client:R(this,pr),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((r=(s=R(this,mr)).onSuccess)==null||r.call(s,n.data,h,f,p),(a=(i=R(this,mr)).onSettled)==null||a.call(i,n.data,null,h,f,p)):(n==null?void 0:n.type)==="error"&&((l=(o=R(this,mr)).onError)==null||l.call(o,n.error,h,f,p),(d=(u=R(this,mr)).onSettled)==null||d.call(u,void 0,n.error,h,f,p))}this.listeners.forEach(h=>{h(R(this,Qr))})})},C_);function Lb(t,e){const n=new Set(e);return t.filter(s=>!n.has(s))}function wA(t,e,n){const s=t.slice(0);return s[e]=n,s}var Uo,Hn,Wo,Ho,is,Xr,Jc,Zc,eu,en,ug,dg,hg,fg,pg,N_,_A=(N_=class extends Ra{constructor(e,n,s){super();fe(this,en);fe(this,Uo);fe(this,Hn);fe(this,Wo);fe(this,Ho);fe(this,is);fe(this,Xr);fe(this,Jc);fe(this,Zc);fe(this,eu,[]);se(this,Uo,e),se(this,Ho,s),se(this,Wo,[]),se(this,is,[]),se(this,Hn,[]),this.setQueries(n)}onSubscribe(){this.listeners.size===1&&R(this,is).forEach(e=>{e.subscribe(n=>{Pe(this,en,fg).call(this,e,n)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,R(this,is).forEach(e=>{e.destroy()})}setQueries(e,n){se(this,Wo,e),se(this,Ho,n),Nt.batch(()=>{const s=R(this,is),r=Pe(this,en,hg).call(this,R(this,Wo));se(this,eu,r),r.forEach(h=>h.observer.setOptions(h.defaultedQueryOptions));const i=r.map(h=>h.observer),a=i.map(h=>h.getCurrentResult()),o=s.length!==i.length,l=i.some((h,f)=>h!==s[f]),u=o||l,d=u?!0:a.some((h,f)=>{const p=R(this,Hn)[f];return!p||!Rc(h,p)});!u&&!d||(u&&se(this,is,i),se(this,Hn,a),this.hasListeners()&&(u&&(Lb(s,i).forEach(h=>{h.destroy()}),Lb(i,s).forEach(h=>{h.subscribe(f=>{Pe(this,en,fg).call(this,h,f)})})),Pe(this,en,pg).call(this)))})}getCurrentResult(){return R(this,Hn)}getQueries(){return R(this,is).map(e=>e.getCurrentQuery())}getObservers(){return R(this,is)}getOptimisticResult(e,n){const s=Pe(this,en,hg).call(this,e),r=s.map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[r,i=>Pe(this,en,dg).call(this,i??r,n),()=>Pe(this,en,ug).call(this,r,s)]}},Uo=new WeakMap,Hn=new WeakMap,Wo=new WeakMap,Ho=new WeakMap,is=new WeakMap,Xr=new WeakMap,Jc=new WeakMap,Zc=new WeakMap,eu=new WeakMap,en=new WeakSet,ug=function(e,n){return n.map((s,r)=>{const i=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?i:s.observer.trackResult(i,a=>{n.forEach(o=>{o.observer.trackProp(a)})})})},dg=function(e,n){return n?((!R(this,Xr)||R(this,Hn)!==R(this,Zc)||n!==R(this,Jc))&&(se(this,Jc,n),se(this,Zc,R(this,Hn)),se(this,Xr,Xx(R(this,Xr),n(e)))),R(this,Xr)):e},hg=function(e){const n=new Map;R(this,is).forEach(r=>{const i=r.options.queryHash;if(!i)return;const a=n.get(i);a?a.push(r):n.set(i,[r])});const s=[];return e.forEach(r=>{var l;const i=R(this,Uo).defaultQueryOptions(r),o=((l=n.get(i.queryHash))==null?void 0:l.shift())??new ey(R(this,Uo),i);s.push({defaultedQueryOptions:i,observer:o})}),s},fg=function(e,n){const s=R(this,is).indexOf(e);s!==-1&&(se(this,Hn,wA(R(this,Hn),s,n)),Pe(this,en,pg).call(this))},pg=function(){var e;if(this.hasListeners()){const n=R(this,Xr),s=Pe(this,en,ug).call(this,R(this,Hn),R(this,eu)),r=Pe(this,en,dg).call(this,s,(e=R(this,Ho))==null?void 0:e.combine);n!==r&&Nt.batch(()=>{this.listeners.forEach(i=>{i(R(this,Hn))})})}},N_),Vs,E_,kA=(E_=class extends Ra{constructor(e={}){super();fe(this,Vs);this.config=e,se(this,Vs,new Map)}build(e,n,s){const r=n.queryKey,i=n.queryHash??Qx(r,n);let a=this.get(i);return a||(a=new pA({client:e,queryKey:r,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(a)),a}add(e){R(this,Vs).has(e.queryHash)||(R(this,Vs).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=R(this,Vs).get(e.queryHash);n&&(e.destroy(),n===e&&R(this,Vs).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Nt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return R(this,Vs).get(e)}getAll(){return[...R(this,Vs).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Nb(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>Nb(e,s)):n}notify(e){Nt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Nt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Nt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Vs=new WeakMap,E_),St,Jr,Zr,Vo,qo,ei,Ko,Go,P_,SA=(P_=class{constructor(t={}){fe(this,St);fe(this,Jr);fe(this,Zr);fe(this,Vo);fe(this,qo);fe(this,ei);fe(this,Ko);fe(this,Go);se(this,St,t.queryCache||new kA),se(this,Jr,t.mutationCache||new vA),se(this,Zr,t.defaultOptions||{}),se(this,Vo,new Map),se(this,qo,new Map),se(this,ei,0)}mount(){Ru(this,ei)._++,R(this,ei)===1&&(se(this,Ko,Zx.subscribe(async t=>{t&&(await this.resumePausedMutations(),R(this,St).onFocus())})),se(this,Go,Ch.subscribe(async t=>{t&&(await this.resumePausedMutations(),R(this,St).onOnline())})))}unmount(){var t,e;Ru(this,ei)._--,R(this,ei)===0&&((t=R(this,Ko))==null||t.call(this),se(this,Ko,void 0),(e=R(this,Go))==null||e.call(this),se(this,Go,void 0))}isFetching(t){return R(this,St).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return R(this,Jr).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=R(this,St).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=R(this,St).build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(gi(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return R(this,St).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),r=R(this,St).get(s.queryHash),i=r==null?void 0:r.state.data,a=rA(e,i);if(a!==void 0)return R(this,St).build(this,s).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return Nt.batch(()=>R(this,St).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=R(this,St).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=R(this,St);Nt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=R(this,St);return Nt.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=Nt.batch(()=>R(this,St).findAll(t).map(r=>r.cancel(n)));return Promise.all(s).then(rn).catch(rn)}invalidateQueries(t,e={}){return Nt.batch(()=>(R(this,St).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=Nt.batch(()=>R(this,St).findAll(t).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(rn)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(rn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=R(this,St).build(this,e);return n.isStaleByTime(gi(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(rn).catch(rn)}fetchInfiniteQuery(t){return t.behavior=Ib(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(rn).catch(rn)}ensureInfiniteQueryData(t){return t.behavior=Ib(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Ch.isOnline()?R(this,Jr).resumePausedMutations():Promise.resolve()}getQueryCache(){return R(this,St)}getMutationCache(){return R(this,Jr)}getDefaultOptions(){return R(this,Zr)}setDefaultOptions(t){se(this,Zr,t)}setQueryDefaults(t,e){R(this,Vo).set(ka(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...R(this,Vo).values()],n={};return e.forEach(s=>{Pc(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){R(this,qo).set(ka(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...R(this,qo).values()],n={};return e.forEach(s=>{Pc(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...R(this,Zr).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Qx(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Jx&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...R(this,Zr).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){R(this,St).clear(),R(this,Jr).clear()}},St=new WeakMap,Jr=new WeakMap,Zr=new WeakMap,Vo=new WeakMap,qo=new WeakMap,ei=new WeakMap,Ko=new WeakMap,Go=new WeakMap,P_),u1=m.createContext(void 0),er=t=>{const e=m.useContext(u1);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},jA=({client:t,children:e})=>(m.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),c.jsx(u1.Provider,{value:t,children:e})),d1=m.createContext(!1),h1=()=>m.useContext(d1);d1.Provider;function CA(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var NA=m.createContext(CA()),f1=()=>m.useContext(NA),p1=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},m1=t=>{m.useEffect(()=>{t.clearReset()},[t])},g1=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:r})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(r&&t.data===void 0||s1(n,[t.error,s])),x1=t=>{if(t.suspense){const n=r=>r==="static"?r:Math.max(r??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...r)=>n(s(...r)):n(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},y1=(t,e)=>t.isLoading&&t.isFetching&&!e,mg=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Nh=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function EA({queries:t,...e},n){const s=er(),r=h1(),i=f1(),a=m.useMemo(()=>t.map(x=>{const v=s.defaultQueryOptions(x);return v._optimisticResults=r?"isRestoring":"optimistic",v}),[t,s,r]);a.forEach(x=>{x1(x),p1(x,i)}),m1(i);const[o]=m.useState(()=>new _A(s,a,e)),[l,u,d]=o.getOptimisticResult(a,e.combine),h=!r&&e.subscribed!==!1;m.useSyncExternalStore(m.useCallback(x=>h?o.subscribe(Nt.batchCalls(x)):rn,[o,h]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),m.useEffect(()=>{o.setQueries(a,e)},[a,e,o]);const p=l.some((x,v)=>mg(a[v],x))?l.flatMap((x,v)=>{const y=a[v];if(y){const g=new ey(s,y);if(mg(y,x))return Nh(y,g,i);y1(x,r)&&Nh(y,g,i)}return[]}):[];if(p.length>0)throw Promise.all(p);const b=l.find((x,v)=>{const y=a[v];return y&&g1({result:x,errorResetBoundary:i,throwOnError:y.throwOnError,query:s.getQueryCache().get(y.queryHash),suspense:y.suspense})});if(b!=null&&b.error)throw b.error;return u(d())}function PA(t,e,n){var h,f,p,b,x;const s=h1(),r=f1(),i=er(),a=i.defaultQueryOptions(t);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,a),a._optimisticResults=s?"isRestoring":"optimistic",x1(a),p1(a,r),m1(r);const o=!i.getQueryCache().get(a.queryHash),[l]=m.useState(()=>new e(i,a)),u=l.getOptimisticResult(a),d=!s&&t.subscribed!==!1;if(m.useSyncExternalStore(m.useCallback(v=>{const y=d?l.subscribe(Nt.batchCalls(v)):rn;return l.updateResult(),y},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),m.useEffect(()=>{l.setOptions(a)},[a,l]),mg(a,u))throw Nh(a,l,r);if(g1({result:u,errorResetBoundary:r,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw u.error;if((b=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||b.call(p,a,u),a.experimental_prefetchInRender&&!_a&&y1(u,s)){const v=o?Nh(a,l,r):(x=i.getQueryCache().get(a.queryHash))==null?void 0:x.promise;v==null||v.catch(rn).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?u:l.trackResult(u)}function on(t,e){return PA(t,ey)}function RA(t,e){const n=er(),[s]=m.useState(()=>new bA(n,t));m.useEffect(()=>{s.setOptions(t)},[s,t]);const r=m.useSyncExternalStore(m.useCallback(a=>s.subscribe(Nt.batchCalls(a)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=m.useCallback((a,o)=>{s.mutate(a,o).catch(rn)},[s]);if(r.error&&s1(s.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),v1=(...t)=>t.filter((e,n,s)=>!!e&&s.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var OA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=m.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:a,...o},l)=>m.createElement("svg",{ref:l,...OA,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:v1("lucide",r),...o},[...a.map(([u,d])=>m.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=(t,e)=>{const n=m.forwardRef(({className:s,...r},i)=>m.createElement(TA,{ref:i,iconNode:e,className:v1(`lucide-${AA(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=Ve("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=Ve("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=Ve("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=Ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=Ve("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=Ve("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=Ve("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Ve("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=Ve("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=Ve("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=Ve("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=Ve("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=Ve("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=Ve("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=Ve("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=Ve("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=Ve("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=Ve("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=Ve("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=Ve("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=Ve("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=Ve("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k1=Ve("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S1=Ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=Ve("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=Ve("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=Ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=Ve("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=Ve("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=Ve("UserRoundX",[["path",{d:"M2 21a8 8 0 0 1 11.873-7",key:"74fkxq"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m17 17 5 5",key:"p7ous7"}],["path",{d:"m22 17-5 5",key:"gqnmv0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hd=Ve("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=Ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function j1(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=j1(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function C1(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=j1(t))&&(s&&(s+=" "),s+=e);return s}const ry="-",GA=t=>{const e=QA(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:a=>{const o=a.split(ry);return o[0]===""&&o.length!==1&&o.shift(),N1(o,e)||YA(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&s[a]?[...l,...s[a]]:l}}},N1=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?N1(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const i=t.join(ry);return(a=e.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},$b=/^\[(.+)\]$/,YA=t=>{if($b.test(t)){const e=$b.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},QA=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return JA(Object.entries(t.classGroups),n).forEach(([i,a])=>{gg(a,s,i,e)}),s},gg=(t,e,n,s)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?e:Fb(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(XA(r)){gg(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([i,a])=>{gg(a,Fb(e,i),n,s)})})},Fb=(t,e)=>{let n=t;return e.split(ry).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},XA=t=>t.isThemeGetter,JA=(t,e)=>e?t.map(([n,s])=>{const r=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,o])=>[e+a,o])):i);return[n,r]}):t,ZA=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const r=(i,a)=>{n.set(i,a),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=s.get(i))!==void 0)return r(i,a),a},set(i,a){n.has(i)?n.set(i,a):r(i,a)}}},E1="!",eO=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,r=e[0],i=e.length,a=o=>{const l=[];let u=0,d=0,h;for(let v=0;v<o.length;v++){let y=o[v];if(u===0){if(y===r&&(s||o.slice(v,v+i)===e)){l.push(o.slice(d,v)),d=v+i;continue}if(y==="/"){h=v;continue}}y==="["?u++:y==="]"&&u--}const f=l.length===0?o:o.substring(d),p=f.startsWith(E1),b=p?f.substring(1):f,x=h&&h>d?h-d:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:b,maybePostfixModifierPosition:x}};return n?o=>n({className:o,parseClassName:a}):a},tO=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},nO=t=>({cache:ZA(t.cacheSize),parseClassName:eO(t),...GA(t)}),sO=/\s+/,rO=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,i=[],a=t.trim().split(sO);let o="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=n(u);let b=!!p,x=s(b?f.substring(0,p):f);if(!x){if(!b){o=u+(o.length>0?" "+o:o);continue}if(x=s(f),!x){o=u+(o.length>0?" "+o:o);continue}b=!1}const v=tO(d).join(":"),y=h?v+E1:v,g=y+x;if(i.includes(g))continue;i.push(g);const w=r(x,b);for(let _=0;_<w.length;++_){const k=w[_];i.push(y+k)}o=u+(o.length>0?" "+o:o)}return o};function iO(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=P1(e))&&(s&&(s+=" "),s+=n);return s}const P1=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=P1(t[s]))&&(n&&(n+=" "),n+=e);return n};function aO(t,...e){let n,s,r,i=a;function a(l){const u=e.reduce((d,h)=>h(d),t());return n=nO(u),s=n.cache.get,r=n.cache.set,i=o,o(l)}function o(l){const u=s(l);if(u)return u;const d=rO(l,n);return r(l,d),d}return function(){return i(iO.apply(null,arguments))}}const ut=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},R1=/^\[(?:([a-z-]+):)?(.+)\]$/i,oO=/^\d+\/\d+$/,lO=new Set(["px","full","screen"]),cO=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,uO=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,dO=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,hO=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fO=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,nr=t=>jo(t)||lO.has(t)||oO.test(t),Mr=t=>cl(t,"length",wO),jo=t=>!!t&&!Number.isNaN(Number(t)),pp=t=>cl(t,"number",jo),Cl=t=>!!t&&Number.isInteger(Number(t)),pO=t=>t.endsWith("%")&&jo(t.slice(0,-1)),Ie=t=>R1.test(t),Ir=t=>cO.test(t),mO=new Set(["length","size","percentage"]),gO=t=>cl(t,mO,A1),xO=t=>cl(t,"position",A1),yO=new Set(["image","url"]),vO=t=>cl(t,yO,kO),bO=t=>cl(t,"",_O),Nl=()=>!0,cl=(t,e,n)=>{const s=R1.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},wO=t=>uO.test(t)&&!dO.test(t),A1=()=>!1,_O=t=>hO.test(t),kO=t=>fO.test(t),SO=()=>{const t=ut("colors"),e=ut("spacing"),n=ut("blur"),s=ut("brightness"),r=ut("borderColor"),i=ut("borderRadius"),a=ut("borderSpacing"),o=ut("borderWidth"),l=ut("contrast"),u=ut("grayscale"),d=ut("hueRotate"),h=ut("invert"),f=ut("gap"),p=ut("gradientColorStops"),b=ut("gradientColorStopPositions"),x=ut("inset"),v=ut("margin"),y=ut("opacity"),g=ut("padding"),w=ut("saturate"),_=ut("scale"),k=ut("sepia"),S=ut("skew"),j=ut("space"),N=ut("translate"),T=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",Ie,e],M=()=>[Ie,e],I=()=>["",nr,Mr],H=()=>["auto",jo,Ie],L=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],D=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],E=()=>["start","end","center","between","around","evenly","stretch"],C=()=>["","0",Ie],F=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[jo,Ie];return{cacheSize:500,separator:":",theme:{colors:[Nl],spacing:[nr,Mr],blur:["none","",Ir,Ie],brightness:K(),borderColor:[t],borderRadius:["none","","full",Ir,Ie],borderSpacing:M(),borderWidth:I(),contrast:K(),grayscale:C(),hueRotate:K(),invert:C(),gap:M(),gradientColorStops:[t],gradientColorStopPositions:[pO,Mr],inset:z(),margin:z(),opacity:K(),padding:M(),saturate:K(),scale:K(),sepia:C(),skew:K(),space:M(),translate:M()},classGroups:{aspect:[{aspect:["auto","square","video",Ie]}],container:["container"],columns:[{columns:[Ir]}],"break-after":[{"break-after":F()}],"break-before":[{"break-before":F()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...L(),Ie]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Cl,Ie]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ie]}],grow:[{grow:C()}],shrink:[{shrink:C()}],order:[{order:["first","last","none",Cl,Ie]}],"grid-cols":[{"grid-cols":[Nl]}],"col-start-end":[{col:["auto",{span:["full",Cl,Ie]},Ie]}],"col-start":[{"col-start":H()}],"col-end":[{"col-end":H()}],"grid-rows":[{"grid-rows":[Nl]}],"row-start-end":[{row:["auto",{span:[Cl,Ie]},Ie]}],"row-start":[{"row-start":H()}],"row-end":[{"row-end":H()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ie]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ie]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...E()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...E(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...E(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ie,e]}],"min-w":[{"min-w":[Ie,e,"min","max","fit"]}],"max-w":[{"max-w":[Ie,e,"none","full","min","max","fit","prose",{screen:[Ir]},Ir]}],h:[{h:[Ie,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ie,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ie,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ie,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ir,Mr]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",pp]}],"font-family":[{font:[Nl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ie]}],"line-clamp":[{"line-clamp":["none",jo,pp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",nr,Ie]}],"list-image":[{"list-image":["none",Ie]}],"list-style-type":[{list:["none","disc","decimal",Ie]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...D(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",nr,Mr]}],"underline-offset":[{"underline-offset":["auto",nr,Ie]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ie]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ie]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...L(),xO]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gO]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},vO]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...D(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:D()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...D()]}],"outline-offset":[{"outline-offset":[nr,Ie]}],"outline-w":[{outline:[nr,Mr]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[nr,Mr]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ir,bO]}],"shadow-color":[{shadow:[Nl]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ir,Ie]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ie]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",Ie]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ie]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[Cl,Ie]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ie]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ie]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ie]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[nr,Mr,pp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},jO=aO(SO);function ve(...t){return jO(C1(t))}function Xt(t){return t.split(/\n|,/).map(e=>e.trim()).filter(Boolean)}function xg(t){if(!t)return{module:"",service:"",action:""};const[e,n,s]=t.split(":");return{module:(e==null?void 0:e.trim())||"",service:(n==null?void 0:n.trim())||"",action:(s==null?void 0:s.trim())||""}}function zb({module:t,service:e,action:n}){return!t||!e||!n?"":`${t}:${e}:${n}`}function Co(t,e,n=`${e}s`){return t?`${t} ${t===1?e:n} selected`:`No ${n} selected`}function Vd(t,e={}){return{...e,...t||{}}}function lt({className:t,...e}){return c.jsx("div",{className:ve("mmg-card rounded-2xl bg-white/70 dark:bg-white/5 backdrop-blur-xs shadow-soft","ring-1 ring-black/5 dark:ring-white/10",t),...e})}function Et({className:t,...e}){return c.jsx("div",{className:ve("p-5 pb-3",t),...e})}function At({className:t,...e}){return c.jsx("h3",{className:ve("text-base font-semibold",t),...e})}function Pt({className:t,...e}){return c.jsx("div",{className:ve("p-5 pt-0",t),...e})}function Bb(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Aa(...t){return e=>{let n=!1;const s=t.map(r=>{const i=Bb(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():Bb(t[r],null)}}}}function Ln(...t){return m.useCallback(Aa(...t),t)}var CO=Symbol.for("react.lazy"),Eh=Xh[" use ".trim().toString()];function NO(t){return typeof t=="object"&&t!==null&&"then"in t}function O1(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===CO&&"_payload"in t&&NO(t._payload)}function EO(t){const e=RO(t),n=m.forwardRef((s,r)=>{let{children:i,...a}=s;O1(i)&&typeof Eh=="function"&&(i=Eh(i._payload));const o=m.Children.toArray(i),l=o.find(OO);if(l){const u=l.props.children,d=o.map(h=>h===l?m.Children.count(u)>1?m.Children.only(null):m.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...a,ref:r,children:m.isValidElement(u)?m.cloneElement(u,void 0,d):null})}return c.jsx(e,{...a,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}var PO=EO("Slot");function RO(t){const e=m.forwardRef((n,s)=>{let{children:r,...i}=n;if(O1(r)&&typeof Eh=="function"&&(r=Eh(r._payload)),m.isValidElement(r)){const a=MO(r),o=TO(i,r.props);return r.type!==m.Fragment&&(o.ref=s?Aa(s,a):a),m.cloneElement(r,o)}return m.Children.count(r)>1?m.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var AO=Symbol("radix.slottable");function OO(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===AO}function TO(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...o)=>{const l=i(...o);return r(...o),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function MO(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const Ub=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Wb=C1,IO=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return Wb(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:i}=e,a=Object.keys(r).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=Ub(d)||Ub(h);return r[u][f]}),o=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(b=>{let[x,v]=b;return Array.isArray(v)?v.includes({...i,...o}[x]):{...i,...o}[x]===v})?[...u,h,f]:u},[]);return Wb(t,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},DO=IO("inline-flex items-center justify-center whitespace-nowrap rounded-xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black/10 dark:focus-visible:ring-white/15 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"mmg-btn-primary bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90 shadow-soft",secondary:"bg-black/5 text-black hover:bg-black/8 dark:bg-white/10 dark:text-white dark:hover:bg-white/15 shadow-soft",ghost:"bg-transparent hover:bg-black/5 text-black dark:text-white dark:hover:bg-white/10 shadow-soft"},size:{default:"h-10 px-4",sm:"h-9 px-3",lg:"h-11 px-5",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Z=zt.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...r},i)=>{const a=s?PO:"button";return c.jsx(a,{className:ve(DO({variant:e,size:n,className:t})),ref:i,...r})});Z.displayName="Button";function De({text:t="Loading",className:e=""}){return c.jsxs("span",{className:["inline-flex items-center gap-2",e].filter(Boolean).join(" "),children:[c.jsx("span",{children:t}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function T1({size:t=128}){return c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("img",{src:"/logo.svg",width:t,height:t,alt:"",className:"shrink-0 filter invert dark:invert-0"}),c.jsx("span",{className:"mmg-brand-gold font-semibold text-lg leading-none tracking-tight hidden sm:inline-flex",children:"Nova"})]})}var Gs=function(){return Gs=Object.assign||function(e){for(var n,s=1,r=arguments.length;s<r;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Gs.apply(this,arguments)};function ul(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function LO(t,e,n,s){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(d){try{u(s.next(d))}catch(h){a(h)}}function l(d){try{u(s.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):r(d.value).then(o,l)}u((s=s.apply(t,e||[])).next())})}function $O(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}const FO=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class iy extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class zO extends iy{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Hb extends iy{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Vb extends iy{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var yg;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(yg||(yg={}));class BO{constructor(e,{headers:n={},customFetch:s,region:r=yg.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=FO(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return LO(this,arguments,void 0,function*(n,s={}){var r;let i,a;try{const{headers:o,method:l,body:u,signal:d,timeout:h}=s;let f={},{region:p}=s;p||(p=this.region);const b=new URL(`${this.url}/${n}`);p&&p!=="any"&&(f["x-region"]=p,b.searchParams.set("forceFunctionRegion",p));let x;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",x=u):typeof u=="string"?(f["Content-Type"]="text/plain",x=u):typeof FormData<"u"&&u instanceof FormData?x=u:(f["Content-Type"]="application/json",x=JSON.stringify(u)):x=u;let v=d;h&&(a=new AbortController,i=setTimeout(()=>a.abort(),h),d?(v=a.signal,d.addEventListener("abort",()=>a.abort())):v=a.signal);const y=yield this.fetch(b.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:x,signal:v}).catch(k=>{throw new zO(k)}),g=y.headers.get("x-relay-error");if(g&&g==="true")throw new Hb(y);if(!y.ok)throw new Vb(y);let w=((r=y.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),_;return w==="application/json"?_=yield y.json():w==="application/octet-stream"||w==="application/pdf"?_=yield y.blob():w==="text/event-stream"?_=y:w==="multipart/form-data"?_=yield y.formData():_=yield y.text(),{data:_,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof Vb||o instanceof Hb?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var UO=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},WO=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let a=null,o=null,l=null,u=i.status,d=i.statusText;if(i.ok){var h,f;if(n.method!=="HEAD"){var p;const y=await i.text();y===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((p=n.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?o=y:o=JSON.parse(y))}const x=(h=n.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),v=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");x&&v&&v.length>1&&(l=parseInt(v[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,d="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var b;const x=await i.text();try{a=JSON.parse(x),Array.isArray(a)&&i.status===404&&(o=[],a=null,u=200,d="OK")}catch{i.status===404&&x===""?(u=204,d="No Content"):a={message:x}}if(a&&n.isMaybeSingle&&(!(a==null||(b=a.details)===null||b===void 0)&&b.includes("0 rows"))&&(a=null,u=200,d="OK"),a&&n.shouldThrowOnError)throw new UO(a)}return{error:a,data:o,count:l,status:u,statusText:d}});return this.shouldThrowOnError||(r=r.catch(i=>{var a;let o="";const l=i==null?void 0:i.cause;if(l){var u,d,h,f;const b=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",x=(d=l==null?void 0:l.code)!==null&&d!==void 0?d:"";o=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,o+=`

Caused by: ${(f=l==null?void 0:l.name)!==null&&f!==void 0?f:"Error"}: ${b}`,x&&(o+=` (${x})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var p;o=(p=i==null?void 0:i.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},HO=class extends WO{select(t){let e=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:r=s}={}){const i=r?`${r}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:r=!1,format:i="text"}={}){var a;const o=[t?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const qb=new RegExp("[,()]");var to=class extends HO{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&qb.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&qb.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${r}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},VO=class{constructor(t,{headers:e={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=s}select(t,e){const{head:n=!1,count:s}=e??{},r=n?"HEAD":"GET";let i=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new to({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var s;const r="POST";if(e&&this.headers.append("Prefer",`count=${e}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((a,o)=>a.concat(Object.keys(o)),[]);if(i.length>0){const a=[...new Set(i)].map(o=>`"${o}"`);this.url.searchParams.set("columns",a.join(","))}}return new to({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}={}){var i;const a="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(o.length>0){const l=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new to({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var n;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new to({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new to({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},qO=class M1{constructor(e,{headers:n={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new VO(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new M1(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:r=!1,count:i}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let u;s||r?(o=s?"HEAD":"GET",Object.entries(n).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{l.searchParams.append(h,f)})):(o="POST",u=n);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new to({method:o,url:l,headers:d,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};class KO{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const GO="2.88.0",YO=`realtime-js/${GO}`,I1="1.0.0",QO="2.0.0",Kb=I1,vg=1e4,XO=1e3,JO=100;var zr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(zr||(zr={}));var $t;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})($t||($t={}));var Cs;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Cs||(Cs={}));var bg;(function(t){t.websocket="websocket"})(bg||(bg={}));var Gi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Gi||(Gi={}));class ZO{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},a=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,n,s){var r,i;const a=e.topic,o=(r=e.ref)!==null&&r!==void 0?r:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+u.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let b=new DataView(p),x=0;b.setUint8(x++,this.KINDS.userBroadcastPush),b.setUint8(x++,l.length),b.setUint8(x++,o.length),b.setUint8(x++,a.length),b.setUint8(x++,u.length),b.setUint8(x++,h.length),b.setUint8(x++,n),Array.from(l,y=>b.setUint8(x++,y.charCodeAt(0))),Array.from(o,y=>b.setUint8(x++,y.charCodeAt(0))),Array.from(a,y=>b.setUint8(x++,y.charCodeAt(0))),Array.from(u,y=>b.setUint8(x++,y.charCodeAt(0))),Array.from(h,y=>b.setUint8(x++,y.charCodeAt(0)));var v=new Uint8Array(p.byteLength+s.byteLength);return v.set(new Uint8Array(p),0),v.set(new Uint8Array(s),p.byteLength),v.buffer}decode(e,n){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return n(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,i,a,o,l]=s;return n({join_ref:r,ref:i,topic:a,event:o,payload:l})}return n({})}_binaryDecode(e){const n=new DataView(e),s=n.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,r)}}_decodeUserBroadcast(e,n,s){const r=n.getUint8(1),i=n.getUint8(2),a=n.getUint8(3),o=n.getUint8(4);let l=this.HEADER_LENGTH+4;const u=s.decode(e.slice(l,l+r));l=l+r;const d=s.decode(e.slice(l,l+i));l=l+i;const h=s.decode(e.slice(l,l+a));l=l+a;const f=e.slice(l,e.byteLength),p=o===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,b={type:this.BROADCAST_EVENT,event:d,payload:p};return a>0&&(b.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>n.includes(s)))}}class D1{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var at;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(at||(at={}));const Gb=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=eT(a,t,e,r),i),{}):{}},eT=(t,e,n,s)=>{const r=e.find(o=>o.name===t),i=r==null?void 0:r.type,a=n[t];return i&&!s.includes(i)?L1(i,a):wg(a)},L1=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return rT(e,n)}switch(t){case at.bool:return tT(e);case at.float4:case at.float8:case at.int2:case at.int4:case at.int8:case at.numeric:case at.oid:return nT(e);case at.json:case at.jsonb:return sT(e);case at.timestamp:return iT(e);case at.abstime:case at.date:case at.daterange:case at.int4range:case at.int8range:case at.money:case at.reltime:case at.text:case at.time:case at.timestamptz:case at.timetz:case at.tsrange:case at.tstzrange:return wg(e);default:return wg(e)}},wg=t=>t,tT=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},nT=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},sT=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},rT=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const a=t.slice(1,n);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>L1(e,o))}return t},iT=t=>typeof t=="string"?t.replace(" ","T"):t,$1=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class mp{constructor(e,n,s={},r=vg){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Yb;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Yb||(Yb={}));class ic{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ic.syncState(this.state,r,i,a),this.pendingDiffs.forEach(l=>{this.state=ic.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ic.syncDiff(this.state,r,i,a),o())}),this.onJoin((r,i,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:a})}),this.onLeave((r,i,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const i=this.cloneDeep(e),a=this.transformState(n),o={},l={};return this.map(i,(u,d)=>{a[u]||(l[u]=d)}),this.map(a,(u,d)=>{const h=i[u];if(h){const f=d.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),b=d.filter(v=>p.indexOf(v.presence_ref)<0),x=h.filter(v=>f.indexOf(v.presence_ref)<0);b.length>0&&(o[u]=b),x.length>0&&(l[u]=x)}else o[u]=d}),this.syncDiff(i,{joins:o,leaves:l},s,r)}static syncDiff(e,n,s,r){const{joins:i,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(o,l)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),d.length>0){const h=e[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[o].unshift(...f)}s(o,d,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=u,r(o,u,l),u.length===0&&delete e[o]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qb;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Qb||(Qb={}));var ac;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ac||(ac={}));var cr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(cr||(cr={}));class xo{constructor(e,n={config:{}},s){var r,i;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=$t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new mp(this,Cs.join,this.params,this.timeout),this.rejoinTimer=new D1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=$t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=$t.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=$t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=$t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=$t.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Cs.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new ic(this),this.broadcastEndpointURL=$1(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==$t.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,u=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&r!==void 0?r:[],d=!!this.bindings[ac.PRESENCE]&&this.bindings[ac.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(cr.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(cr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(cr.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,v=(b=x==null?void 0:x.length)!==null&&b!==void 0?b:0,y=[];for(let g=0;g<v;g++){const w=x[g],{filter:{event:_,schema:k,table:S,filter:j}}=w,N=p&&p[g];if(N&&N.event===_&&xo.isFilterValueEqual(N.schema,k)&&xo.isFilterValueEqual(N.table,S)&&xo.isFilterValueEqual(N.filter,j))y.push(Object.assign(Object.assign({},w),{id:N.id}));else{this.unsubscribe(),this.state=$t.errored,e==null||e(cr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(cr.SUBSCRIBED);return}}).receive("error",p=>{this.state=$t.errored,e==null||e(cr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(cr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===$t.joined&&e===ac.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var r;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const u=await o.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=$t.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Cs.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new mp(this,Cs.leave,{},e),s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=$t.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(i),a}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new mp(this,e,n,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>JO){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:d}=Cs;if(s&&[o,l,u,d].indexOf(a)>=0&&s!==this._joinRef())return;let f=this._onMessage(a,n,s);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var b,x,v;return((b=p.filter)===null||b===void 0?void 0:b.event)==="*"||((v=(x=p.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===a}).map(p=>p.callback(f,s)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var b,x,v,y,g,w;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const _=p.id,k=(b=p.filter)===null||b===void 0?void 0:b.event;return _&&((x=n.ids)===null||x===void 0?void 0:x.includes(_))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const _=(g=(y=p==null?void 0:p.filter)===null||y===void 0?void 0:y.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return _==="*"||_===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const b=f.data,{schema:x,table:v,commit_timestamp:y,type:g,errors:w}=b;f=Object.assign(Object.assign({},{schema:x,table:v,commit_timestamp:y,eventType:g,new:{},old:{},errors:w}),this._getPayloadRecords(b))}p.callback(f,s)})}_isClosed(){return this.state===$t.closed}_isJoined(){return this.state===$t.joined}_isJoining(){return this.state===$t.joining}_isLeaving(){return this.state===$t.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),i={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&xo.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Cs.close,{},e)}_onError(e){this._on(Cs.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=$t.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Gb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Gb(e.columns,e.old_record)),n}}const gp=()=>{},Ju={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},aT=[1e3,2e3,5e3,1e4],oT=1e4,lT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class cT{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=vg,this.transport=null,this.heartbeatIntervalMs=Ju.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gp,this.ref=0,this.reconnectTimer=null,this.vsn=Kb,this.logger=gp,this.conn=null,this.sendBuffer=[],this.serializer=new ZO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((s=n==null?void 0:n.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${bg.websocket}`,this.httpEndpoint=$1(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=KO.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case zr.connecting:return Gi.Connecting;case zr.open:return Gi.Open;case zr.closing:return Gi.Closing;default:return Gi.Closed}}isConnected(){return this.connectionState()===Gi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new xo(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:s,payload:r,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${n} ${s} (${i})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(XO,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ju.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:i,ref:a}=n,o=a?`(${a})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${r} ${o}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(r,i,a)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===zr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===zr.open||this.conn.readyState===zr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Cs.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([lT],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,s=!1;if(e)n=e,s=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),n=this.accessTokenValue}else n=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:YO};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(Cs.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new D1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ju.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,r,i,a,o,l,u,d,h,f,p;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:vg,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:Ju.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:gp,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:Kb,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:b=>aT[b-1]||oT,this.vsn){case I1:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(b,x)=>x(JSON.stringify(b)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(b,x)=>x(JSON.parse(b));break;case QO:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Ac=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function uT(t,e,n){const s=new URL(e,t);if(n)for(const[r,i]of Object.entries(n))i!==void 0&&s.searchParams.set(r,i);return s.toString()}async function dT(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function hT(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:s,query:r,body:i,headers:a}){const o=uT(t.baseUrl,s,r),l=await dT(t.auth),u=await e(o,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...l,...a},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const p=h?f:void 0,b=p==null?void 0:p.error;throw new Ac((b==null?void 0:b.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:b==null?void 0:b.type,icebergCode:b==null?void 0:b.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function Zu(t){return t.join("")}var fT=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Zu(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Zu(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Zu(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Zu(t.namespace)}`}),!0}catch(e){if(e instanceof Ac&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Ac&&n.status===409)return;throw n}}};function Ua(t){return t.join("")}var pT=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ua(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ua(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ua(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ua(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ua(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ua(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Ac&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Ac&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},mT=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=hT({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new fT(this.client,e),this.tableOps=new pT(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},mf=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function bt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var gT=class extends mf{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},_g=class extends mf{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const ay=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),xT=()=>Response,kg=t=>{if(Array.isArray(t))return t.map(n=>kg(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=kg(s)}),e},yT=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},vT=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Oc(t){"@babel/helpers - typeof";return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oc(t)}function bT(t,e){if(Oc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Oc(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wT(t){var e=bT(t,"string");return Oc(e)=="symbol"?e:e+""}function _T(t,e,n){return(e=wT(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Ae(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Xb(Object(n),!0).forEach(function(s){_T(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xb(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const xp=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},kT=async(t,e,n)=>{t instanceof await xT()&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const r=t.status||500,i=(s==null?void 0:s.statusCode)||r+"";e(new gT(xp(s),r,i))}).catch(s=>{e(new _g(xp(s),s))}):e(new _g(xp(t),t))},ST=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?r:(yT(s)?(r.headers=Ae({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),Ae(Ae({},r),n))};async function du(t,e,n,s,r,i){return new Promise((a,o)=>{t(n,ST(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>kT(l,o,s))})}async function Tc(t,e,n,s){return du(t,"GET",e,n,s)}async function _s(t,e,n,s,r){return du(t,"POST",e,s,r,n)}async function Sg(t,e,n,s,r){return du(t,"PUT",e,s,r,n)}async function jT(t,e,n,s){return du(t,"HEAD",e,Ae(Ae({},n),{},{noResolveJson:!0}),s)}async function oy(t,e,n,s,r){return du(t,"DELETE",e,s,r,n)}var CT=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(bt(e))return{data:null,error:e};throw e}}};let F1;F1=Symbol.toStringTag;var NT=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[F1]="BlobDownloadBuilder",this.promise=null}asStream(){return new CT(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(bt(e))return{data:null,error:e};throw e}}};const ET={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var PT=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=ay(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,s){var r=this;try{let i;const a=Ae(Ae({},Jb),s);let o=Ae(Ae({},r.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",r.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),l&&!i.has("metadata")&&i.append("metadata",r.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=r.toBase64(r.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),s!=null&&s.headers&&(o=Ae(Ae({},o),s.headers));const u=r._removeEmptyFolders(e),d=r._getFinalPath(u),h=await(t=="PUT"?Sg:_s)(r.fetch,`${r.url}/object/${d}`,i,Ae({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(r.shouldThrowOnError)throw i;if(bt(i))return{data:null,error:i};throw i}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,s){var r=this;const i=r._removeEmptyFolders(t),a=r._getFinalPath(i),o=new URL(r.url+`/object/upload/sign/${a}`);o.searchParams.set("token",e);try{let l;const u=Ae({upsert:Jb.upsert},s),d=Ae(Ae({},r.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await Sg(r.fetch,o.toString(),l,{headers:d})).Key},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(bt(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var n=this;try{let s=n._getFinalPath(t);const r=Ae({},n.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const i=await _s(n.fetch,`${n.url}/object/upload/sign/${s}`,{},{headers:r}),a=new URL(n.url+i.url),o=a.searchParams.get("token");if(!o)throw new mf("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var s=this;try{return{data:await _s(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers}),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(bt(r))return{data:null,error:r};throw r}}async copy(t,e,n){var s=this;try{return{data:{path:(await _s(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers})).Key},error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(bt(r))return{data:null,error:r};throw r}}async createSignedUrl(t,e,n){var s=this;try{let r=s._getFinalPath(t),i=await _s(s.fetch,`${s.url}/object/sign/${r}`,Ae({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:s.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(bt(r))return{data:null,error:r};throw r}}async createSignedUrls(t,e,n){var s=this;try{const r=await _s(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:r.map(a=>Ae(Ae({},a),{},{signedUrl:a.signedURL?encodeURI(`${s.url}${a.signedURL}${i}`):null})),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(bt(r))return{data:null,error:r};throw r}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),r=s?`?${s}`:"",i=this._getFinalPath(t),a=()=>Tc(this.fetch,`${this.url}/${n}/${i}${r}`,{headers:this.headers,noResolveJson:!0});return new NT(a,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:kg(await Tc(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await jT(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(bt(s)&&s instanceof _g){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});a!==""&&s.push(a);let o=s.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${o}`)}}}async remove(t){var e=this;try{return{data:await oy(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}async list(t,e,n){var s=this;try{const r=Ae(Ae(Ae({},ET),e),{},{prefix:t||""});return{data:await _s(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},n),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(bt(r))return{data:null,error:r};throw r}}async listV2(t,e){var n=this;try{const s=Ae({},t);return{data:await _s(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,s,{headers:n.headers},e),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const z1="2.88.0",B1={"X-Client-Info":`storage-js/${z1}`};var RT=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1;const r=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Ae(Ae({},B1),e),this.fetch=ay(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await Tc(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await Tc(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await _s(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var n=this;try{return{data:await Sg(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await _s(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await oy(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},AT=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ae(Ae({},B1),e),this.fetch=ay(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await _s(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const s=n.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Tc(e.fetch,r,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await oy(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bt(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!vT(t))throw new mf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new mT({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(n,{get(r,i){const a=r[i];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(r,o),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const ly={"X-Client-Info":`storage-js/${z1}`,"Content-Type":"application/json"};var U1=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Kn(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var yp=class extends U1{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},OT=class extends U1{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const cy=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),TT=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Zb=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),MT=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const s=t.status||500,r=t;if(typeof r.json=="function")r.json().then(i=>{const a=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new yp(Zb(i),s,a))}).catch(()=>{const i=s+"";e(new yp(r.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new yp(r.statusText||`HTTP ${s} error`,s,i))}}else e(new OT(Zb(t),t))},IT=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(TT(s)?(r.headers=Ae({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,Ae(Ae({},r),n)):r};async function DT(t,e,n,s,r,i){return new Promise((a,o)=>{t(n,IT(e,s,r,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>MT(l,o,s))})}async function Gn(t,e,n,s,r){return DT(t,"POST",e,s,r,n)}var LT=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ae(Ae({},ly),e),this.fetch=cy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await Gn(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Kn(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await Gn(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Kn(s))return{data:null,error:s};throw s}}},$T=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ae(Ae({},ly),e),this.fetch=cy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Gn(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Gn(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Gn(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}},FT=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ae(Ae({},ly),e),this.fetch=cy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Gn(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Kn(n))return{data:null,error:n};throw n}}},zT=class extends FT{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new BT(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},BT=class extends LT{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,Ae(Ae({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,Ae(Ae({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new UT(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},UT=class extends $T{constructor(t,e,n,s,r){super(t,e,r),this.vectorBucketName=n,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,Ae(Ae({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,Ae(Ae({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,Ae(Ae({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,Ae(Ae({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,Ae(Ae({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},WT=class extends RT{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new PT(this.url,this.headers,t,this.fetch)}get vectors(){return new zT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new AT(this.url+"/iceberg",this.headers,this.fetch)}};const W1="2.88.0",no=30*1e3,jg=3,vp=jg*no,HT="http://localhost:9999",VT="supabase.auth.token",qT={"X-Client-Info":`gotrue-js/${W1}`},Cg="X-Supabase-Api-Version",H1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},KT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,GT=10*60*1e3;class Mc extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function ke(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class YT extends Mc{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function QT(t){return ke(t)&&t.name==="AuthApiError"}class Yi extends Mc{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Rr extends Mc{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class Un extends Rr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function XT(t){return ke(t)&&t.name==="AuthSessionMissingError"}class Wa extends Rr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ed extends Rr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class td extends Rr{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function JT(t){return ke(t)&&t.name==="AuthImplicitGrantRedirectError"}class e0 extends Rr{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ZT extends Rr{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ng extends Rr{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function bp(t){return ke(t)&&t.name==="AuthRetryableFetchError"}class t0 extends Rr{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class Eg extends Rr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ph="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),n0=` 	
\r=`.split(""),eM=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<n0.length;e+=1)t[n0[e].charCodeAt(0)]=-2;for(let e=0;e<Ph.length;e+=1)t[Ph[e].charCodeAt(0)]=e;return t})();function s0(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ph[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ph[s]),e.queuedBits-=6}}function V1(t,e,n){const s=eM[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function r0(t){const e=[],n=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=a=>{sM(a,s,n)};for(let a=0;a<t.length;a+=1)V1(t.charCodeAt(a),r,i);return e.join("")}function tM(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function nM(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}tM(s,e)}}function sM(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function No(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)V1(t.charCodeAt(r),n,s);return new Uint8Array(e)}function rM(t){const e=[];return nM(t,n=>e.push(n)),new Uint8Array(e)}function ea(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>s0(r,n,s)),s0(null,n,s),e.join("")}function iM(t){return Math.round(Date.now()/1e3)+t}function aM(){return Symbol("auth-callback")}const Yt=()=>typeof window<"u"&&typeof document<"u",$i={tested:!1,writable:!1},q1=()=>{if(!Yt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if($i.tested)return $i.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),$i.tested=!0,$i.writable=!0}catch{$i.tested=!0,$i.writable=!1}return $i.writable};function oM(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const K1=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),lM=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",so=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Fi=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Gt=async(t,e)=>{await t.removeItem(e)};class gf{constructor(){this.promise=new gf.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}gf.promiseConstructor=Promise;function wp(t){const e=t.split(".");if(e.length!==3)throw new Eg("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!KT.test(e[s]))throw new Eg("JWT not in base64url format");return{header:JSON.parse(r0(e[0])),payload:JSON.parse(r0(e[1])),signature:No(e[2]),raw:{header:e[0],payload:e[1]}}}async function cM(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function uM(t,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){r(a);return}}})()})}function dM(t){return("0"+t.toString(16)).substr(-2)}function hM(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let i=0;i<56;i++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,dM).join("")}async function fM(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function pM(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await fM(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ha(t,e,n=!1){const s=hM();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await so(t,`${e}-code-verifier`,r);const i=await pM(s);return[i,s===i?"plain":"s256"]}const mM=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gM(t){const e=t.headers.get(Cg);if(!e||!e.match(mM))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function xM(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function yM(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vM=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Va(t){if(!vM.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _p(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function bM(t,e){return new Proxy(t,{get:(n,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,r)}})}function i0(t){return JSON.parse(JSON.stringify(t))}const Vi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),wM=[502,503,504];async function a0(t){var e;if(!lM(t))throw new Ng(Vi(t),0);if(wM.includes(t.status))throw new Ng(Vi(t),t.status);let n;try{n=await t.json()}catch(i){throw new Yi(Vi(i),i)}let s;const r=gM(t);if(r&&r.getTime()>=H1["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new t0(Vi(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Un}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new t0(Vi(n),t.status,n.weak_password.reasons);throw new YT(Vi(n),t.status||500,s)}const _M=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function Re(t,e,n,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[Cg]||(i[Cg]=H1["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await kM(t,e,n+o,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function kM(t,e,n,s,r,i){const a=_M(e,s,r,i);let o;try{o=await t(n,Object.assign({},a))}catch(l){throw console.error(l),new Ng(Vi(l),0)}if(o.ok||await a0(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await a0(l)}}function bs(t){var e;let n=null;CM(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=iM(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function o0(t){const e=bs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Wr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function SM(t){return{data:t,error:null}}function jM(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i}=t,a=ul(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function l0(t){return t}function CM(t){return t.access_token&&t.refresh_token&&t.expires_in}const kp=["global","local","others"];class NM{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=K1(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=kp[0]){if(kp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${kp.join(", ")}`);try{return await Re(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ke(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await Re(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Wr})}catch(s){if(ke(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=ul(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await Re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:jM,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ke(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Wr})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,i,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await Re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:l0});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(b=>{const x=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(b.split(";")[1].split("=")[1]);u[`${v}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(ke(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Va(e);try{return await Re(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Wr})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Va(e);try{return await Re(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Wr})}catch(s){if(ke(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){Va(e);try{return await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Wr})}catch(s){if(ke(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Va(e.userId);try{const{data:n,error:s}=await Re(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Va(e.userId),Va(e.id);try{return{data:await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,r,i,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await Re(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:l0});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(b=>{const x=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(b.split(";")[1].split("=")[1]);u[`${v}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(ke(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await Re(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await Re(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Re(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}}function c0(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const qa={debug:!!(globalThis&&q1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class G1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class EM extends G1{}async function PM(t,e,n){qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),qa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new EM(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(qa.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function RM(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Y1(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function AM(t){return parseInt(t,16)}function OM(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function TM(t){var e;const{chainId:n,domain:s,expirationTime:r,issuedAt:i=new Date,nonce:a,notBefore:o,requestId:l,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=Y1(t.address),b=d?`${d}://${s}`:s,x=t.statement?`${t.statement}
`:"",v=`${b} wants you to sign in with your Ethereum account:
${p}

${x}`;let y=`URI: ${h}
Version: ${f}
Chain ID: ${n}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(r&&(y+=`
Expiration Time: ${r.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),u){let g=`
Resources:`;for(const w of u){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);g+=`
- ${w}`}y+=g}return`${v}
${y}`}class Tt extends Error{constructor({message:e,code:n,cause:s,name:r}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=r??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class Rh extends Tt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function MM({error:t,options:e}){var n,s,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Tt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Tt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Tt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Tt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Tt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Tt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Tt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Tt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(Q1(a)){if(i.rp.id!==a)return new Tt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Tt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Tt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function IM({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Tt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Tt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Q1(s)){if(n.rpId!==s)return new Tt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Tt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class DM{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const LM=new DM;function $M(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,r=ul(t,["challenge","user","excludeCredentials"]),i=No(e).buffer,a=Object.assign(Object.assign({},n),{id:No(n.id).buffer}),o=Object.assign(Object.assign({},r),{challenge:i,user:a});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const u=s[l];o.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:No(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function FM(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=ul(t,["challenge","allowCredentials"]),r=No(e).buffer,i=Object.assign(Object.assign({},s),{challenge:r});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const o=n[a];i.allowCredentials[a]=Object.assign(Object.assign({},o),{id:No(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function zM(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:ea(new Uint8Array(t.response.attestationObject)),clientDataJSON:ea(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function BM(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ea(new Uint8Array(r.authenticatorData)),clientDataJSON:ea(new Uint8Array(r.clientDataJSON)),signature:ea(new Uint8Array(r.signature)),userHandle:r.userHandle?ea(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Q1(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function u0(){var t,e;return!!(Yt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function UM(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Rh("Browser returned unexpected credential type",e)}:{data:null,error:new Rh("Empty credential response",e)}}catch(e){return{data:null,error:MM({error:e,options:t})}}}async function WM(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Rh("Browser returned unexpected credential type",e)}:{data:null,error:new Rh("Empty credential response",e)}}catch(e){return{data:null,error:IM({error:e,options:t})}}}const HM={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},VM={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ah(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const i in r){const a=r[i];if(a!==void 0)if(Array.isArray(a))s[i]=a;else if(n(a))s[i]=a;else if(e(a)){const o=s[i];e(o)?s[i]=Ah(o,a):s[i]=Ah(a)}else s[i]=a}return s}function qM(t,e){return Ah(HM,t,e||{})}function KM(t,e){return Ah(VM,t,e||{})}class GM{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:r},i){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!a)return{data:null,error:o};const l=r??LM.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=qM(a.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:h}=await UM({publicKey:u,signal:l});return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=KM(a.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:h}=await WM(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(a){return ke(a)?{data:null,error:a}:{data:null,error:new Yi("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Mc("rpId is required for WebAuthn authentication")};try{if(!u0())return{data:null,error:new Yi("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:r},{request:i});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:s,credential_response:l.credential_response}})}catch(a){return ke(a)?{data:null,error:a}:{data:null,error:new Yi("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Mc("rpId is required for WebAuthn registration")};try{if(!u0())return{data:null,error:new Yi("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:l,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:r},{create:i});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(a){return ke(a)?{data:null,error:a}:{data:null,error:new Yi("Unexpected error in register",a)}}}}RM();const YM={url:HT,storageKey:VT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function d0(t,e,n){return await n()}const Ka={};class Ic{get jwks(){var e,n;return(n=(e=Ka[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Ka[this.storageKey]=Object.assign(Object.assign({},Ka[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Ka[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ka[this.storageKey]=Object.assign(Object.assign({},Ka[this.storageKey]),{cachedAt:e})}constructor(e){var n,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},YM),e);if(this.storageKey=i.storageKey,this.instanceID=(n=Ic.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Ic.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Yt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new NM({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=K1(i.fetch),this.lock=i.lock||d0,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&Yt()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=PM:this.lock=d0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new GM(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:q1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=c0(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=c0(this.memoryStorage)),Yt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${W1}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(Yt()&&(n=oM(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),Yt()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(n,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),JT(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ke(n)?this._returnResult({error:n}):this._returnResult({error:new Yi("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const i=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:bs}),{data:a,error:o}=i;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(ke(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,s,r;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,b=null;this.flowType==="pkce"&&([p,b]=await Ha(this.storage,this.storageKey)),i=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:b},xform:bs})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:bs})}else throw new ed("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return await Gt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(await Gt(this.storage,`${this.storageKey}-code-verifier`),ke(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:a,options:o}=e;n=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:o0})}else if("phone"in e){const{phone:i,password:a,options:o}=e;n=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:o0})}else throw new ed("You must provide either an email or phone number and a password");const{data:s,error:r}=n;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const i=new Wa;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,r,i,a,o,l,u,d,h,f;let p,b;if("message"in e)p=e.message,b=e.signature;else{const{chain:x,wallet:v,statement:y,options:g}=e;let w;if(Yt())if(typeof v=="object")w=v;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")w=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=v}const _=new URL((n=g==null?void 0:g.url)!==null&&n!==void 0?n:window.location.href),k=await w.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=Y1(k[0]);let j=(s=g==null?void 0:g.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!j){const T=await w.request({method:"eth_chainId"});j=AM(T)}const N={domain:_.host,address:S,statement:y,uri:_.href,version:"1",chainId:j,nonce:(r=g==null?void 0:g.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(a=(i=g==null?void 0:g.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=g==null?void 0:g.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=g==null?void 0:g.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=g==null?void 0:g.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=g==null?void 0:g.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=TM(N),b=await w.request({method:"personal_sign",params:[OM(p),S]})}try{const{data:x,error:v}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:b},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:bs});if(v)throw v;if(!x||!x.session||!x.user){const y=new Wa;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:v})}catch(x){if(ke(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(e){var n,s,r,i,a,o,l,u,d,h,f,p;let b,x;if("message"in e)b=e.message,x=e.signature;else{const{chain:v,wallet:y,statement:g,options:w}=e;let _;if(Yt())if(typeof y=="object")_=y;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))_=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=y}const k=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in _&&_.signIn){const S=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),g?{statement:g}:null));let j;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")j=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)j=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)b=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),x=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${k.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(r=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const S=await _.signMessage(new TextEncoder().encode(b),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=S}}try{const{data:v,error:y}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:ea(x)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:bs});if(y)throw y;if(!v||!v.session||!v.user){const g=new Wa;return this._returnResult({data:{user:null,session:null},error:g})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:y})}catch(v){if(ke(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(e){const n=await Fi(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ZT;const{data:i,error:a}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:bs});if(await Gt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const o=new Wa;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:a})}catch(i){if(await Gt(this.storage,`${this.storageKey}-code-verifier`),ke(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:i,nonce:a}=e,o=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:bs}),{data:l,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Wa;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,r,i,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Ha(this.storage,this.storageKey));const{error:h}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:d}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new ed("You must provide either an email or phone number.")}catch(o){if(await Gt(this.storage,`${this.storageKey}-code-verifier`),ke(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var n,s;try{let r,i;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await Re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:bs});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(r){if(ke(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var n,s,r,i,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Ha(this.storage,this.storageKey));const u=await Re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:SM});return!((i=u.data)===null||i===void 0)&&i.url&&Yt()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(await Gt(this.storage,`${this.storageKey}-code-verifier`),ke(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new Un;const{error:r}=await Re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(ke(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:a}=await Re(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:a,error:o}=await Re(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new ed("You must provide either an email or phone number and a type")}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Fi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<vp:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await Fi(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=_p()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=bM(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Wr}):await this._useSession(async n=>{var s,r,i;const{data:a,error:o}=n;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Un}:await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:Wr})})}catch(n){if(ke(n))return XT(n)&&(await this._removeSession(),await Gt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new Un;const a=r.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Ha(this.storage,this.storageKey));const{data:u,error:d}=await Re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Wr});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(s){if(await Gt(this.storage,`${this.storageKey}-code-verifier`),ke(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Un;const n=Date.now()/1e3;let s=n,r=!0,i=null;const{payload:a}=wp(e.access_token);if(a.exp&&(s=a.exp,r=s<=n),r){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(ke(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:a,error:o}=n;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Un;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(ke(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Yt())throw new td("No browser detected.");if(e.error||e.error_description||e.error_code)throw new td(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new e0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new td("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new e0("No code detected.");const{data:g,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!i||!o||!a||!u)throw new td("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=no&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const b=f-h;d-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,f,d):d-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,f,d);const{data:x,error:v}=await this._getUser(i);if(v)throw v;const y={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(s){if(ke(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Fi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({error:i});const a=(s=r.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(QT(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await Gt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=aM(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:i},error:a}=n;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Ha(this.storage,this.storageKey,!0));try{return await Re(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await Gt(this.storage,`${this.storageKey}-code-verifier`),ke(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:r}=await this._useSession(async i=>{var a,o,l,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Re(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(r)throw r;return Yt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(ke(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:r,data:{session:i}}=n;if(r)throw r;const{options:a,provider:o,token:l,access_token:u,nonce:d}=e,h=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:o,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:bs}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Wa}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(r){if(await Gt(this.storage,`${this.storageKey}-code-verifier`),ke(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:a}=n;if(a)throw a;return await Re(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await uM(async r=>(r>0&&await cM(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await Re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:bs})),(r,i)=>{const a=200*Math.pow(2,r);return i&&bp(i)&&Date.now()+a-s<no})}catch(s){if(this._debug(n,"error",s),ke(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Yt()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Fi(this.storage,this.storageKey);if(r&&this.userStorage){let a=await Fi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:r.user},await so(this.userStorage,this.storageKey+"-user",a)),r.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:_p()}else if(r&&!r.user&&!r.user){const a=await Fi(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(r.user=a.user,await Gt(this.storage,this.storageKey+"-user"),await so(this.storage,this.storageKey,r)):r.user=_p()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const i=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<vp;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${vp}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),bp(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(r.access_token);!o&&(a!=null&&a.user)?(r.user=a.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new Un;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new gf;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Un;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(r,"error",i),ke(i)){const a={data:null,error:i};return bp(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Gt(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await so(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const i=i0(r);await so(this.storage,this.storageKey,i)}else{const r=i0(n);await so(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Gt(this.storage,this.storageKey),await Gt(this.storage,this.storageKey+"-code-verifier"),await Gt(this.storage,this.storageKey+"-user"),this.userStorage&&await Gt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Yt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),no);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/no);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${no}ms, refresh threshold is ${jg} ticks`),r<=jg&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof G1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Yt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ha(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;return i?this._returnResult({data:null,error:i}):await Re(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:a}=n;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await Re(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&l.type==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?zM(e.webauthn.credential_response):BM(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const a=await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:$M(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:FM(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=wp(s.access_token);let a=null;i.aal&&(a=i.aal);let o=a;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(o="aal2");const u=i.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?await Re(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Un})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new Un});const a=await Re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&Yt()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new Un});const a=await Re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&Yt()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;return s?this._returnResult({data:null,error:s}):n?await Re(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new Un})})}catch(e){if(ke(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?(await Re(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Un})})}catch(n){if(ke(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(o=>o.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+GT>r)return s;const{data:i,error:a}=await Re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:p,error:b}=await this.getSession();if(b||!p.session)return this._returnResult({data:null,error:b});s=p.session.access_token}const{header:r,payload:i,signature:a,raw:{header:o,payload:l}}=wp(s);n!=null&&n.allowExpired||xM(i.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:r,signature:a},error:null}}const d=yM(r.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,a,rM(`${o}.${l}`)))throw new Eg("Invalid JWT signature");return{data:{claims:i,header:r,signature:a},error:null}}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}}Ic.nextInstanceID={};const QM=Ic,XM="2.88.0";let Bl="";typeof Deno<"u"?Bl="deno":typeof document<"u"?Bl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bl="react-native":Bl="node";const JM={"X-Client-Info":`supabase-js-${Bl}/${XM}`},ZM={headers:JM},eI={schema:"public"},tI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nI={};function Dc(t){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dc(t)}function sI(t,e){if(Dc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Dc(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rI(t){var e=sI(t,"string");return Dc(e)=="symbol"?e:e+""}function iI(t,e,n){return(e=rI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function jt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?h0(Object(n),!0).forEach(function(s){iI(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h0(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const aI=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),oI=()=>Headers,lI=(t,e,n)=>{const s=aI(n),r=oI();return async(i,a)=>{var o;const l=(o=await e())!==null&&o!==void 0?o:t;let u=new r(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(i,jt(jt({},a),{},{headers:u}))}};function cI(t){return t.endsWith("/")?t:t+"/"}function uI(t,e){var n,s;const{db:r,auth:i,realtime:a,global:o}=t,{db:l,auth:u,realtime:d,global:h}=e,f={db:jt(jt({},l),r),auth:jt(jt({},u),i),realtime:jt(jt({},d),a),storage:{},global:jt(jt(jt({},h),o),{},{headers:jt(jt({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(s=o==null?void 0:o.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function dI(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(cI(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var hI=class extends QM{constructor(t){super(t)}},fI=class{constructor(t,e,n){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const i=dI(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const a=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:eI,realtime:nI,auth:jt(jt({},tI),{},{storageKey:a}),global:ZM},l=uI(n??{},o);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=l.global.headers)!==null&&r!==void 0?r:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=lI(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(jt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new qO(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new WT(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new BO(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:i,flowType:a,lock:o,debug:l,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hI({url:this.authUrl.href,headers:jt(jt({},f),d),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,flowType:a,lock:o,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new cT(this.realtimeUrl.href,jt(jt({},t),{},{params:jt(jt({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const pI=(t,e,n)=>new fI(t,e,n);function mI(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}mI()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Oa={SUPABASE_URL:window.SUPABASE_URL||void 0||"",SUPABASE_ANON_KEY:window.SUPABASE_ANON_KEY||void 0||"",API_BASE_URL:window.API_BASE_URL||void 0||""};let nd=null;function X1(){if(nd)return nd;const{SUPABASE_URL:t,SUPABASE_ANON_KEY:e}=Oa;return!t||!e?null:(nd=pI(t,e),nd)}const uy="authToken";function xf(){return localStorage.getItem(uy)}function Ul(t){t&&localStorage.setItem(uy,t)}function Eo(){localStorage.removeItem(uy)}async function J1(){var r;const t=xf();if(t)return t;const e=X1();if(!e)return null;const{data:n}=await e.auth.getSession(),s=((r=n==null?void 0:n.session)==null?void 0:r.access_token)||null;return s&&Ul(s),s}async function Oe(t,e={}){const{baseUrl:n,...s}=e,r=`${n??Oa.API_BASE_URL}${t}`,i=new Headers(s.headers||{});!(s.body instanceof FormData)&&!i.has("Content-Type")&&i.set("Content-Type","application/json");const o=await J1();o&&!i.has("Authorization")&&i.set("Authorization",`Bearer ${o}`);const l=await fetch(r,{...s,headers:i});if(l.status===401)return Eo(),window.dispatchEvent(new CustomEvent("auth:logout")),null;if(!l.ok){const d=await l.json().catch(()=>({detail:"Request failed"})),h=new Error(d.detail||d.error||`Request failed: ${l.status}`);throw h.status=l.status,h.data=d,h}return l.status===204?null:(l.headers.get("content-type")||"").includes("application/json")?l.json():l}async function Z1(t,e={}){const{baseUrl:n,...s}=e,r=`${n??Oa.API_BASE_URL}${t}`,i=new Headers(s.headers||{}),a=await J1();a&&!i.has("Authorization")&&i.set("Authorization",`Bearer ${a}`);const o=await fetch(r,{...s,headers:i});if(o.status===401)return Eo(),window.dispatchEvent(new CustomEvent("auth:logout")),null;if(!o.ok){const l=await o.json().catch(()=>({detail:"Request failed"})),u=new Error(l.detail||l.error||`Request failed: ${o.status}`);throw u.status=o.status,u.data=l,u}return o.blob()}const ej=m.createContext(null),Sp={system_admin:["admin","hos","sales_person"],sales_manager:["hos","sales_person"],sales_user:["sales_person"],coordinator:["coordinator"],finance:["finance"],viewer:["viewer"]},gI={"admin@mmg.com":{password:"admin123",id:"dev-admin-1",name:"Sales Admin",email:"admin@mmg.com",roles:["admin","hos","sales_person"]},"hos@mmg.com":{password:"hos123",id:"dev-hos-1",name:"Head of Sales",email:"hos@mmg.com",roles:["hos","sales_person"]},"sales@mmg.com":{password:"sales123",id:"dev-sales-1",name:"Sales Person",email:"sales@mmg.com",roles:["sales_person"]}};function jp(t){return Array.from(new Set((t||[]).filter(Boolean).map(e=>String(e).toLowerCase())))}function f0(t=[]){return t.map(e=>String(e||"").replaceAll(".",":"))}function xI(t){return(t||"sales_user").toLowerCase()}function p0(t,e){var n,s,r,i,a,o,l,u,d;return((n=t==null?void 0:t.user_metadata)==null?void 0:n.full_name)||((s=t==null?void 0:t.user_metadata)==null?void 0:s.name)||((a=(i=(r=t==null?void 0:t.identities)==null?void 0:r[0])==null?void 0:i.identity_data)==null?void 0:a.full_name)||((u=(l=(o=t==null?void 0:t.identities)==null?void 0:o[0])==null?void 0:l.identity_data)==null?void 0:u.name)||((d=t==null?void 0:t.email)==null?void 0:d.split("@")[0])||e||"User"}function qd(t,e){const n=(t==null?void 0:t.permissions)||[];if(!n.length)return!1;const s=u=>String(u||"").trim().replaceAll(".",":"),r=n.map(s),i=s(e);if(r.includes("*:*:*"))return!0;const[a,o,l]=i.split(":");return r.some(u=>{const[d,h,f]=u.split(":");return u===i?!0:(d==="*"||d===a)&&(h==="*"||h===o)&&(f==="*"||f===l||f==="manage")})}function hu(t){var e,n,s;return((e=t==null?void 0:t.roles)==null?void 0:e.includes("admin"))||((s=(n=t==null?void 0:t.profile)==null?void 0:n.toLowerCase)==null?void 0:s.call(n))==="system_admin"||qd(t,"*:*:*")||qd(t,"core:*:*")||qd(t,"core:system:admin")}function yI({children:t}){const e=X1(),n=!e&&window.location.hostname==="localhost",[s,r]=m.useState(null),[i,a]=m.useState(()=>{const g=localStorage.getItem("mmg_user")||localStorage.getItem("userData");return g?JSON.parse(g):null}),[o,l]=m.useState(!1),[u,d]=m.useState(null);m.useEffect(()=>{const g=window.location.hash;if(!g||!g.includes("error="))return;const w=new URLSearchParams(g.substring(1)),_=w.get("error"),k=w.get("error_code"),S=w.get("error_description");if(_){let j=S?decodeURIComponent(S.replace(/\+/g," ")):"Authentication failed";k==="otp_expired"?j="Email link has expired. Please sign up again to receive a new confirmation email.":k==="access_denied"&&(j="Access denied. The link may have expired or already been used."),setTimeout(()=>alert(j),300),window.history.replaceState(null,"",window.location.pathname+window.location.search)}},[]),m.useEffect(()=>{let g=null;async function w(){try{if(!e){const S=localStorage.getItem("mmg_user")||localStorage.getItem("userData");S&&a(JSON.parse(S)),l(!0);return}const{data:_}=await e.auth.getSession(),k=(_==null?void 0:_.session)||null;r(k||null),k||(Eo(),a(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData")),k!=null&&k.access_token&&Ul(k.access_token),k!=null&&k.access_token&&await h(k.access_token,k.user),g=e.auth.onAuthStateChange(async(S,j)=>{r(j||null),j!=null&&j.access_token?(Ul(j.access_token),u||await h(j.access_token,j.user)):(Eo(),a(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"))}).data.subscription,l(!0)}catch{l(!0)}}return w(),()=>{var _;return(_=g==null?void 0:g.unsubscribe)==null?void 0:_.call(g)}},[e,u]),m.useEffect(()=>{const g=()=>{d(null),v()};return window.addEventListener("auth:logout",g),()=>window.removeEventListener("auth:logout",g)},[]);async function h(g,w=null){var _,k,S,j;try{const N=await Oe("/api/base/auth/me",{headers:{Authorization:`Bearer ${g}`}});if(!N)return null;const T=xI((N==null?void 0:N.profile_name)||(N==null?void 0:N.profile)||(N==null?void 0:N.profileName)),A=Sp[T]||["sales_person"],z=(N==null?void 0:N.roles)||(N==null?void 0:N.rbac_roles)||(N==null?void 0:N.user_roles)||[],M={id:(N==null?void 0:N.id)||(w==null?void 0:w.id),email:(N==null?void 0:N.email)||(w==null?void 0:w.email),name:(N==null?void 0:N.name)||p0(w,T),profile:T,profile_name:T,roles:jp([...A,...z]),permissions:f0((N==null?void 0:N.permissions)||[]),raw:N};return a(M),localStorage.setItem("mmg_user",JSON.stringify(M)),localStorage.setItem("userData",JSON.stringify(M)),d(null),M}catch(N){if((N==null?void 0:N.status)===403&&((_=N==null?void 0:N.data)!=null&&_.requiresLogout)){const T=(w==null?void 0:w.email)||(i==null?void 0:i.email)||"";return((k=N==null?void 0:N.data)==null?void 0:k.code)==="USER_PENDING_APPROVAL"?(d({pending:!0,email:T,message:((S=N==null?void 0:N.data)==null?void 0:S.error)||"Your account is pending administrator approval."}),null):(await v(),null)}if(w){const T=((j=w.user_metadata)==null?void 0:j.profile)||"sales_user",A=Sp[T]||["sales_person"],z={id:w.id,email:w.email,name:p0(w,T),profile:T,profile_name:T,roles:jp(A),permissions:[],raw:w};return a(z),localStorage.setItem("mmg_user",JSON.stringify(z)),localStorage.setItem("userData",JSON.stringify(z)),d(null),z}return null}}async function f(){return s!=null&&s.access_token?s.access_token:localStorage.getItem("authToken")}async function p({email:g,password:w}){var S;if(d(null),!e){if(!n)throw new Error("Supabase not configured");const j=gI[g.toLowerCase()];if(!j||j.password!==w)throw new Error("Invalid email or password");const N=j.profile||((S=j.roles)!=null&&S.includes("admin")?"system_admin":"sales_user"),T=jp(j.roles||Sp[N]||["sales_person"]),A={id:j.id,email:j.email,name:j.name,profile:N,profile_name:N,roles:T,permissions:f0(j.permissions||[]),raw:j},z=`dev-token-${Date.now()}`;return Ul(z),a(A),localStorage.setItem("mmg_user",JSON.stringify(A)),localStorage.setItem("userData",JSON.stringify(A)),A}const{data:_,error:k}=await e.auth.signInWithPassword({email:g,password:w});if(k)throw k;return Ul(_.session.access_token),await h(_.session.access_token,_.session.user),_}async function b(){if(!e)throw new Error("Supabase not configured. Please contact your administrator.");const g=vI(),{data:w,error:_}=await e.auth.signInWithOAuth({provider:"azure",options:{scopes:"email profile openid",redirectTo:g}});if(_)throw _;return w}async function x({token:g,email:w,password:_,fullName:k}){var T;if(!e)throw new Error("Supabase not configured");const S=await Oe("/api/base/auth/validate-invite",{method:"POST",body:JSON.stringify({token:g,email:w})}),{data:j,error:N}=await e.auth.signUp({email:w,password:_,options:{data:{full_name:k,profile:(S==null?void 0:S.profile_name)||"sales_user"}}});if(N)throw N;return await Oe("/api/base/auth/consume-invite",{method:"POST",body:JSON.stringify({token:g,email:w,supabase_user_id:(T=j==null?void 0:j.user)==null?void 0:T.id,profile_name:S==null?void 0:S.profile_name,name:k})}),j}async function v(){try{e&&await e.auth.signOut()}finally{Eo(),r(null),a(null),d(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"),sessionStorage.removeItem("msSsoPending")}}const y=m.useMemo(()=>({authReady:o,user:i,session:s,pendingAccess:u,getAccessToken:f,signInWithPassword:p,signInWithMicrosoft:b,signUpWithInvite:x,refreshProfile:h,logout:v}),[o,i,s,u]);return c.jsx(ej.Provider,{value:y,children:t})}function jr(){const t=m.useContext(ej);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function vI(){const t=`${window.location.protocol}//${window.location.host}`,e=window.SUPABASE_REDIRECT_URL||void 0||"";return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?`${t}/auth/callback`:`${(e||t).replace(/\/$/,"")}/auth/callback`}function bI(){const{signInWithMicrosoft:t}=jr(),e=cu(),n=ll(),s=m.useMemo(()=>{var h;return((h=n.state)==null?void 0:h.from)||"/app/chat"},[n.state]),[r,i]=m.useState(""),[a,o]=m.useState(!1),{user:l,authReady:u}=jr();m.useEffect(()=>{u&&l&&e(s,{replace:!0})},[u,l,s,e]);async function d(){if(!a){i("");try{o(!0),sessionStorage.setItem("postAuthRedirect",s||"/app/chat"),await new Promise(h=>requestAnimationFrame(h)),await t()}catch(h){i((h==null?void 0:h.message)||"SSO failed"),o(!1)}}}return c.jsxs("div",{className:"min-h-screen px-4 py-8 flex items-center justify-center",children:[c.jsx("div",{className:"mmg-particle one"}),c.jsx("div",{className:"mmg-particle two"}),c.jsx("div",{className:"mmg-particle three"}),c.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 lg:grid-cols-[420px_1fr] gap-6 items-stretch",children:[c.jsxs(lt,{className:"self-center",children:[c.jsxs(Et,{className:"text-center",children:[c.jsx("div",{className:"flex items-center justify-center mb-5",children:c.jsx(T1,{size:96})}),c.jsx("p",{className:"text-sm text-black/60 dark:text-white/65",children:"Sign in to continue to your workspace"})]}),c.jsx(Pt,{children:c.jsxs("div",{className:"space-y-3",children:[r?c.jsx("div",{className:"text-sm text-red-700 rounded-2xl px-4 py-2 bg-black/5 dark:bg-white/10",children:r}):null,c.jsx(Z,{variant:"secondary",size:"lg",className:"w-full justify-center gap-2",onClick:d,disabled:a,children:a?c.jsx(De,{text:"Signing you in"}):c.jsxs(c.Fragment,{children:[c.jsx(DA,{size:18}),"Sign in with Microsoft"]})})]})})]}),c.jsx("div",{className:"rounded-3xl min-h-[240px] lg:min-h-[520px]","aria-hidden":"true"})]})]})}function tj({email:t,message:e,onSignOut:n}){return c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsxs("div",{className:"w-full max-w-[520px] space-y-4 rounded-2xl bg-white/60 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 p-6 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:"Access Pending"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:e||"Your account is pending administrator approval."}),t?c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:["Signed in as ",c.jsx("strong",{children:t})]}):null,c.jsx("div",{className:"flex justify-center pt-2",children:c.jsx(Z,{variant:"secondary",onClick:n,children:"Sign Out"})})]})})}function wI(){const t=cu(),{authReady:e,session:n,user:s,pendingAccess:r,logout:i}=jr();return m.useEffect(()=>{if(e&&!n){t("/login",{replace:!0});return}if(e&&n&&s){const a=sessionStorage.getItem("postAuthRedirect")||"/app/chat";sessionStorage.removeItem("postAuthRedirect"),t(a,{replace:!0})}},[e,n,s,t]),e&&r?c.jsx(tj,{email:r.email,message:r.message,onSignOut:i}):c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(De,{text:"Loading"})})})}function nj(){const{theme:t,setTheme:e}=YR(),n=t==="dark";return c.jsx(Z,{variant:"ghost",size:"icon","aria-label":"Toggle theme",onClick:()=>e(n?"light":"dark"),title:"Toggle theme",className:"rounded-2xl",children:n?c.jsx(VA,{size:18}):c.jsx(zA,{size:18})})}function Be(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function fu(t,e=[]){let n=[];function s(i,a){const o=m.createContext(a),l=n.length;n=[...n,a];const u=h=>{var y;const{scope:f,children:p,...b}=h,x=((y=f==null?void 0:f[t])==null?void 0:y[l])||o,v=m.useMemo(()=>b,Object.values(b));return c.jsx(x.Provider,{value:v,children:p})};u.displayName=i+"Provider";function d(h,f){var x;const p=((x=f==null?void 0:f[t])==null?void 0:x[l])||o,b=m.useContext(p);if(b)return b;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const r=()=>{const i=n.map(a=>m.createContext(a));return function(o){const l=(o==null?void 0:o[t])||i;return m.useMemo(()=>({[`__scope${t}`]:{...o,[t]:l}}),[o,l])}};return r.scopeName=t,[s,_I(r,...e)]}function _I(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const a=s.reduce((o,{useScope:l,scopeName:u})=>{const h=l(i)[`__scope${u}`];return{...o,...h}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}var ki=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},kI=Xh[" useInsertionEffect ".trim().toString()]||ki;function sj({prop:t,defaultProp:e,onChange:n=()=>{},caller:s}){const[r,i,a]=SI({defaultProp:e,onChange:n}),o=t!==void 0,l=o?t:r;{const d=m.useRef(t!==void 0);m.useEffect(()=>{const h=d.current;h!==o&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=o},[o,s])}const u=m.useCallback(d=>{var h;if(o){const f=jI(d)?d(t):d;f!==t&&((h=a.current)==null||h.call(a,f))}else i(d)},[o,t,i,a]);return[l,u]}function SI({defaultProp:t,onChange:e}){const[n,s]=m.useState(t),r=m.useRef(n),i=m.useRef(e);return kI(()=>{i.current=e},[e]),m.useEffect(()=>{var a;r.current!==n&&((a=i.current)==null||a.call(i,n),r.current=n)},[n,r]),[n,s,i]}function jI(t){return typeof t=="function"}function CI(t){const e=NI(t),n=m.forwardRef((s,r)=>{const{children:i,...a}=s,o=m.Children.toArray(i),l=o.find(PI);if(l){const u=l.props.children,d=o.map(h=>h===l?m.Children.count(u)>1?m.Children.only(null):m.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...a,ref:r,children:m.isValidElement(u)?m.cloneElement(u,void 0,d):null})}return c.jsx(e,{...a,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function NI(t){const e=m.forwardRef((n,s)=>{const{children:r,...i}=n;if(m.isValidElement(r)){const a=AI(r),o=RI(i,r.props);return r.type!==m.Fragment&&(o.ref=s?Aa(s,a):a),m.cloneElement(r,o)}return m.Children.count(r)>1?m.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var EI=Symbol("radix.slottable");function PI(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===EI}function RI(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...o)=>{const l=i(...o);return r(...o),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function AI(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var OI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],bn=OI.reduce((t,e)=>{const n=CI(`Primitive.${e}`),s=m.forwardRef((r,i)=>{const{asChild:a,...o}=r,l=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...o,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function rj(t,e){t&&au.flushSync(()=>t.dispatchEvent(e))}function m0(t){const e=TI(t),n=m.forwardRef((s,r)=>{const{children:i,...a}=s,o=m.Children.toArray(i),l=o.find(II);if(l){const u=l.props.children,d=o.map(h=>h===l?m.Children.count(u)>1?m.Children.only(null):m.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...a,ref:r,children:m.isValidElement(u)?m.cloneElement(u,void 0,d):null})}return c.jsx(e,{...a,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function TI(t){const e=m.forwardRef((n,s)=>{const{children:r,...i}=n;if(m.isValidElement(r)){const a=LI(r),o=DI(i,r.props);return r.type!==m.Fragment&&(o.ref=s?Aa(s,a):a),m.cloneElement(r,o)}return m.Children.count(r)>1?m.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var MI=Symbol("radix.slottable");function II(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===MI}function DI(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...o)=>{const l=i(...o);return r(...o),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function LI(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function ij(t){const e=t+"CollectionProvider",[n,s]=fu(e),[r,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=x=>{const{scope:v,children:y}=x,g=zt.useRef(null),w=zt.useRef(new Map).current;return c.jsx(r,{scope:v,itemMap:w,collectionRef:g,children:y})};a.displayName=e;const o=t+"CollectionSlot",l=m0(o),u=zt.forwardRef((x,v)=>{const{scope:y,children:g}=x,w=i(o,y),_=Ln(v,w.collectionRef);return c.jsx(l,{ref:_,children:g})});u.displayName=o;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=m0(d),p=zt.forwardRef((x,v)=>{const{scope:y,children:g,...w}=x,_=zt.useRef(null),k=Ln(v,_),S=i(d,y);return zt.useEffect(()=>(S.itemMap.set(_,{ref:_,...w}),()=>void S.itemMap.delete(_))),c.jsx(f,{[h]:"",ref:k,children:g})});p.displayName=d;function b(x){const v=i(t+"CollectionConsumer",x);return zt.useCallback(()=>{const g=v.collectionRef.current;if(!g)return[];const w=Array.from(g.querySelectorAll(`[${h}]`));return Array.from(v.itemMap.values()).sort((S,j)=>w.indexOf(S.ref.current)-w.indexOf(j.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:u,ItemSlot:p},b,s]}var $I=m.createContext(void 0);function aj(t){const e=m.useContext($I);return t||e||"ltr"}function Cr(t){const e=m.useRef(t);return m.useEffect(()=>{e.current=t}),m.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function FI(t,e=globalThis==null?void 0:globalThis.document){const n=Cr(t);m.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var zI="DismissableLayer",Pg="dismissableLayer.update",BI="dismissableLayer.pointerDownOutside",UI="dismissableLayer.focusOutside",g0,oj=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),lj=m.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=t,u=m.useContext(oj),[d,h]=m.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=m.useState({}),b=Ln(e,j=>h(j)),x=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=x.indexOf(v),g=d?x.indexOf(d):-1,w=u.layersWithOutsidePointerEventsDisabled.size>0,_=g>=y,k=VI(j=>{const N=j.target,T=[...u.branches].some(A=>A.contains(N));!_||T||(r==null||r(j),a==null||a(j),j.defaultPrevented||o==null||o())},f),S=qI(j=>{const N=j.target;[...u.branches].some(A=>A.contains(N))||(i==null||i(j),a==null||a(j),j.defaultPrevented||o==null||o())},f);return FI(j=>{g===u.layers.size-1&&(s==null||s(j),!j.defaultPrevented&&o&&(j.preventDefault(),o()))},f),m.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(g0=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),x0(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=g0)}},[d,f,n,u]),m.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),x0())},[d,u]),m.useEffect(()=>{const j=()=>p({});return document.addEventListener(Pg,j),()=>document.removeEventListener(Pg,j)},[]),c.jsx(bn.div,{...l,ref:b,style:{pointerEvents:w?_?"auto":"none":void 0,...t.style},onFocusCapture:Be(t.onFocusCapture,S.onFocusCapture),onBlurCapture:Be(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:Be(t.onPointerDownCapture,k.onPointerDownCapture)})});lj.displayName=zI;var WI="DismissableLayerBranch",HI=m.forwardRef((t,e)=>{const n=m.useContext(oj),s=m.useRef(null),r=Ln(e,s);return m.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),c.jsx(bn.div,{...t,ref:r})});HI.displayName=WI;function VI(t,e=globalThis==null?void 0:globalThis.document){const n=Cr(t),s=m.useRef(!1),r=m.useRef(()=>{});return m.useEffect(()=>{const i=o=>{if(o.target&&!s.current){let l=function(){cj(BI,n,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);s.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function qI(t,e=globalThis==null?void 0:globalThis.document){const n=Cr(t),s=m.useRef(!1);return m.useEffect(()=>{const r=i=>{i.target&&!s.current&&cj(UI,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function x0(){const t=new CustomEvent(Pg);document.dispatchEvent(t)}function cj(t,e,n,{discrete:s}){const r=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?rj(r,i):r.dispatchEvent(i)}var Cp=0;function KI(){m.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??y0()),document.body.insertAdjacentElement("beforeend",t[1]??y0()),Cp++,()=>{Cp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Cp--}},[])}function y0(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Np="focusScope.autoFocusOnMount",Ep="focusScope.autoFocusOnUnmount",v0={bubbles:!1,cancelable:!0},GI="FocusScope",uj=m.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:i,...a}=t,[o,l]=m.useState(null),u=Cr(r),d=Cr(i),h=m.useRef(null),f=Ln(e,x=>l(x)),p=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(s){let x=function(w){if(p.paused||!o)return;const _=w.target;o.contains(_)?h.current=_:Lr(h.current,{select:!0})},v=function(w){if(p.paused||!o)return;const _=w.relatedTarget;_!==null&&(o.contains(_)||Lr(h.current,{select:!0}))},y=function(w){if(document.activeElement===document.body)for(const k of w)k.removedNodes.length>0&&Lr(o)};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const g=new MutationObserver(y);return o&&g.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),g.disconnect()}}},[s,o,p.paused]),m.useEffect(()=>{if(o){w0.add(p);const x=document.activeElement;if(!o.contains(x)){const y=new CustomEvent(Np,v0);o.addEventListener(Np,u),o.dispatchEvent(y),y.defaultPrevented||(YI(eD(dj(o)),{select:!0}),document.activeElement===x&&Lr(o))}return()=>{o.removeEventListener(Np,u),setTimeout(()=>{const y=new CustomEvent(Ep,v0);o.addEventListener(Ep,d),o.dispatchEvent(y),y.defaultPrevented||Lr(x??document.body,{select:!0}),o.removeEventListener(Ep,d),w0.remove(p)},0)}}},[o,u,d,p]);const b=m.useCallback(x=>{if(!n&&!s||p.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,y=document.activeElement;if(v&&y){const g=x.currentTarget,[w,_]=QI(g);w&&_?!x.shiftKey&&y===_?(x.preventDefault(),n&&Lr(w,{select:!0})):x.shiftKey&&y===w&&(x.preventDefault(),n&&Lr(_,{select:!0})):y===g&&x.preventDefault()}},[n,s,p.paused]);return c.jsx(bn.div,{tabIndex:-1,...a,ref:f,onKeyDown:b})});uj.displayName=GI;function YI(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(Lr(s,{select:e}),document.activeElement!==n)return}function QI(t){const e=dj(t),n=b0(e,t),s=b0(e.reverse(),t);return[n,s]}function dj(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function b0(t,e){for(const n of t)if(!XI(n,{upTo:e}))return n}function XI(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function JI(t){return t instanceof HTMLInputElement&&"select"in t}function Lr(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&JI(t)&&e&&t.select()}}var w0=ZI();function ZI(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=_0(t,e),t.unshift(e)},remove(e){var n;t=_0(t,e),(n=t[0])==null||n.resume()}}}function _0(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function eD(t){return t.filter(e=>e.tagName!=="A")}var tD=Xh[" useId ".trim().toString()]||(()=>{}),nD=0;function Rg(t){const[e,n]=m.useState(tD());return ki(()=>{n(s=>s??String(nD++))},[t]),e?`radix-${e}`:""}const sD=["top","right","bottom","left"],Si=Math.min,qn=Math.max,Oh=Math.round,sd=Math.floor,Js=t=>({x:t,y:t}),rD={left:"right",right:"left",bottom:"top",top:"bottom"},iD={start:"end",end:"start"};function Ag(t,e,n){return qn(t,Si(e,n))}function Nr(t,e){return typeof t=="function"?t(e):t}function Er(t){return t.split("-")[0]}function dl(t){return t.split("-")[1]}function dy(t){return t==="x"?"y":"x"}function hy(t){return t==="y"?"height":"width"}const aD=new Set(["top","bottom"]);function Ys(t){return aD.has(Er(t))?"y":"x"}function fy(t){return dy(Ys(t))}function oD(t,e,n){n===void 0&&(n=!1);const s=dl(t),r=fy(t),i=hy(r);let a=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=Th(a)),[a,Th(a)]}function lD(t){const e=Th(t);return[Og(t),e,Og(e)]}function Og(t){return t.replace(/start|end/g,e=>iD[e])}const k0=["left","right"],S0=["right","left"],cD=["top","bottom"],uD=["bottom","top"];function dD(t,e,n){switch(t){case"top":case"bottom":return n?e?S0:k0:e?k0:S0;case"left":case"right":return e?cD:uD;default:return[]}}function hD(t,e,n,s){const r=dl(t);let i=dD(Er(t),n==="start",s);return r&&(i=i.map(a=>a+"-"+r),e&&(i=i.concat(i.map(Og)))),i}function Th(t){return t.replace(/left|right|bottom|top/g,e=>rD[e])}function fD(t){return{top:0,right:0,bottom:0,left:0,...t}}function hj(t){return typeof t!="number"?fD(t):{top:t,right:t,bottom:t,left:t}}function Mh(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function j0(t,e,n){let{reference:s,floating:r}=t;const i=Ys(e),a=fy(e),o=hy(a),l=Er(e),u=i==="y",d=s.x+s.width/2-r.width/2,h=s.y+s.height/2-r.height/2,f=s[o]/2-r[o]/2;let p;switch(l){case"top":p={x:d,y:s.y-r.height};break;case"bottom":p={x:d,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:h};break;case"left":p={x:s.x-r.width,y:h};break;default:p={x:s.x,y:s.y}}switch(dl(e)){case"start":p[a]-=f*(n&&u?-1:1);break;case"end":p[a]+=f*(n&&u?-1:1);break}return p}const pD=async(t,e,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let u=await a.getElementRects({reference:t,floating:e,strategy:r}),{x:d,y:h}=j0(u,s,l),f=s,p={},b=0;for(let x=0;x<o.length;x++){const{name:v,fn:y}=o[x],{x:g,y:w,data:_,reset:k}=await y({x:d,y:h,initialPlacement:s,placement:f,strategy:r,middlewareData:p,rects:u,platform:a,elements:{reference:t,floating:e}});d=g??d,h=w??h,p={...p,[v]:{...p[v],..._}},k&&b<=50&&(b++,typeof k=="object"&&(k.placement&&(f=k.placement),k.rects&&(u=k.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:r}):k.rects),{x:d,y:h}=j0(u,f,l)),x=-1)}return{x:d,y:h,placement:f,strategy:r,middlewareData:p}};async function Lc(t,e){var n;e===void 0&&(e={});const{x:s,y:r,platform:i,rects:a,elements:o,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=Nr(e,t),b=hj(p),v=o[f?h==="floating"?"reference":"floating":h],y=Mh(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:u,rootBoundary:d,strategy:l})),g=h==="floating"?{x:s,y:r,width:a.floating.width,height:a.floating.height}:a.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),_=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},k=Mh(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:g,offsetParent:w,strategy:l}):g);return{top:(y.top-k.top+b.top)/_.y,bottom:(k.bottom-y.bottom+b.bottom)/_.y,left:(y.left-k.left+b.left)/_.x,right:(k.right-y.right+b.right)/_.x}}const mD=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:r,rects:i,platform:a,elements:o,middlewareData:l}=e,{element:u,padding:d=0}=Nr(t,e)||{};if(u==null)return{};const h=hj(d),f={x:n,y:s},p=fy(r),b=hy(p),x=await a.getDimensions(u),v=p==="y",y=v?"top":"left",g=v?"bottom":"right",w=v?"clientHeight":"clientWidth",_=i.reference[b]+i.reference[p]-f[p]-i.floating[b],k=f[p]-i.reference[p],S=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let j=S?S[w]:0;(!j||!await(a.isElement==null?void 0:a.isElement(S)))&&(j=o.floating[w]||i.floating[b]);const N=_/2-k/2,T=j/2-x[b]/2-1,A=Si(h[y],T),z=Si(h[g],T),M=A,I=j-x[b]-z,H=j/2-x[b]/2+N,L=Ag(M,H,I),D=!l.arrow&&dl(r)!=null&&H!==L&&i.reference[b]/2-(H<M?A:z)-x[b]/2<0,G=D?H<M?H-M:H-I:0;return{[p]:f[p]+G,data:{[p]:L,centerOffset:H-L-G,...D&&{alignmentOffset:G}},reset:D}}}),gD=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:r,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:x=!0,...v}=Nr(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const y=Er(r),g=Ys(o),w=Er(o)===o,_=await(l.isRTL==null?void 0:l.isRTL(u.floating)),k=f||(w||!x?[Th(o)]:lD(o)),S=b!=="none";!f&&S&&k.push(...hD(o,x,b,_));const j=[o,...k],N=await Lc(e,v),T=[];let A=((s=i.flip)==null?void 0:s.overflows)||[];if(d&&T.push(N[y]),h){const H=oD(r,a,_);T.push(N[H[0]],N[H[1]])}if(A=[...A,{placement:r,overflows:T}],!T.every(H=>H<=0)){var z,M;const H=(((z=i.flip)==null?void 0:z.index)||0)+1,L=j[H];if(L&&(!(h==="alignment"?g!==Ys(L):!1)||A.every(E=>Ys(E.placement)===g?E.overflows[0]>0:!0)))return{data:{index:H,overflows:A},reset:{placement:L}};let D=(M=A.filter(G=>G.overflows[0]<=0).sort((G,E)=>G.overflows[1]-E.overflows[1])[0])==null?void 0:M.placement;if(!D)switch(p){case"bestFit":{var I;const G=(I=A.filter(E=>{if(S){const C=Ys(E.placement);return C===g||C==="y"}return!0}).map(E=>[E.placement,E.overflows.filter(C=>C>0).reduce((C,F)=>C+F,0)]).sort((E,C)=>E[1]-C[1])[0])==null?void 0:I[0];G&&(D=G);break}case"initialPlacement":D=o;break}if(r!==D)return{reset:{placement:D}}}return{}}}};function C0(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function N0(t){return sD.some(e=>t[e]>=0)}const xD=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...r}=Nr(t,e);switch(s){case"referenceHidden":{const i=await Lc(e,{...r,elementContext:"reference"}),a=C0(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:N0(a)}}}case"escaped":{const i=await Lc(e,{...r,altBoundary:!0}),a=C0(i,n.floating);return{data:{escapedOffsets:a,escaped:N0(a)}}}default:return{}}}}},fj=new Set(["left","top"]);async function yD(t,e){const{placement:n,platform:s,elements:r}=t,i=await(s.isRTL==null?void 0:s.isRTL(r.floating)),a=Er(n),o=dl(n),l=Ys(n)==="y",u=fj.has(a)?-1:1,d=i&&l?-1:1,h=Nr(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:b}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&typeof b=="number"&&(p=o==="end"?b*-1:b),l?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const vD=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:r,y:i,placement:a,middlewareData:o}=e,l=await yD(e,t);return a===((n=o.offset)==null?void 0:n.placement)&&(s=o.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:i+l.y,data:{...l,placement:a}}}}},bD=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:r}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x:y,y:g}=v;return{x:y,y:g}}},...l}=Nr(t,e),u={x:n,y:s},d=await Lc(e,l),h=Ys(Er(r)),f=dy(h);let p=u[f],b=u[h];if(i){const v=f==="y"?"top":"left",y=f==="y"?"bottom":"right",g=p+d[v],w=p-d[y];p=Ag(g,p,w)}if(a){const v=h==="y"?"top":"left",y=h==="y"?"bottom":"right",g=b+d[v],w=b-d[y];b=Ag(g,b,w)}const x=o.fn({...e,[f]:p,[h]:b});return{...x,data:{x:x.x-n,y:x.y-s,enabled:{[f]:i,[h]:a}}}}}},wD=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:r,rects:i,middlewareData:a}=e,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=Nr(t,e),d={x:n,y:s},h=Ys(r),f=dy(h);let p=d[f],b=d[h];const x=Nr(o,e),v=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(l){const w=f==="y"?"height":"width",_=i.reference[f]-i.floating[w]+v.mainAxis,k=i.reference[f]+i.reference[w]-v.mainAxis;p<_?p=_:p>k&&(p=k)}if(u){var y,g;const w=f==="y"?"width":"height",_=fj.has(Er(r)),k=i.reference[h]-i.floating[w]+(_&&((y=a.offset)==null?void 0:y[h])||0)+(_?0:v.crossAxis),S=i.reference[h]+i.reference[w]+(_?0:((g=a.offset)==null?void 0:g[h])||0)-(_?v.crossAxis:0);b<k?b=k:b>S&&(b=S)}return{[f]:p,[h]:b}}}},_D=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:r,rects:i,platform:a,elements:o}=e,{apply:l=()=>{},...u}=Nr(t,e),d=await Lc(e,u),h=Er(r),f=dl(r),p=Ys(r)==="y",{width:b,height:x}=i.floating;let v,y;h==="top"||h==="bottom"?(v=h,y=f===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(y=h,v=f==="end"?"top":"bottom");const g=x-d.top-d.bottom,w=b-d.left-d.right,_=Si(x-d[v],g),k=Si(b-d[y],w),S=!e.middlewareData.shift;let j=_,N=k;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(N=w),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(j=g),S&&!f){const A=qn(d.left,0),z=qn(d.right,0),M=qn(d.top,0),I=qn(d.bottom,0);p?N=b-2*(A!==0||z!==0?A+z:qn(d.left,d.right)):j=x-2*(M!==0||I!==0?M+I:qn(d.top,d.bottom))}await l({...e,availableWidth:N,availableHeight:j});const T=await a.getDimensions(o.floating);return b!==T.width||x!==T.height?{reset:{rects:!0}}:{}}}};function yf(){return typeof window<"u"}function hl(t){return pj(t)?(t.nodeName||"").toLowerCase():"#document"}function Xn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function tr(t){var e;return(e=(pj(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function pj(t){return yf()?t instanceof Node||t instanceof Xn(t).Node:!1}function As(t){return yf()?t instanceof Element||t instanceof Xn(t).Element:!1}function Zs(t){return yf()?t instanceof HTMLElement||t instanceof Xn(t).HTMLElement:!1}function E0(t){return!yf()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Xn(t).ShadowRoot}const kD=new Set(["inline","contents"]);function pu(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=Os(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!kD.has(r)}const SD=new Set(["table","td","th"]);function jD(t){return SD.has(hl(t))}const CD=[":popover-open",":modal"];function vf(t){return CD.some(e=>{try{return t.matches(e)}catch{return!1}})}const ND=["transform","translate","scale","rotate","perspective"],ED=["transform","translate","scale","rotate","perspective","filter"],PD=["paint","layout","strict","content"];function py(t){const e=my(),n=As(t)?Os(t):t;return ND.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||ED.some(s=>(n.willChange||"").includes(s))||PD.some(s=>(n.contain||"").includes(s))}function RD(t){let e=ji(t);for(;Zs(e)&&!nl(e);){if(py(e))return e;if(vf(e))return null;e=ji(e)}return null}function my(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const AD=new Set(["html","body","#document"]);function nl(t){return AD.has(hl(t))}function Os(t){return Xn(t).getComputedStyle(t)}function bf(t){return As(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ji(t){if(hl(t)==="html")return t;const e=t.assignedSlot||t.parentNode||E0(t)&&t.host||tr(t);return E0(e)?e.host:e}function mj(t){const e=ji(t);return nl(e)?t.ownerDocument?t.ownerDocument.body:t.body:Zs(e)&&pu(e)?e:mj(e)}function $c(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=mj(t),i=r===((s=t.ownerDocument)==null?void 0:s.body),a=Xn(r);if(i){const o=Tg(a);return e.concat(a,a.visualViewport||[],pu(r)?r:[],o&&n?$c(o):[])}return e.concat(r,$c(r,[],n))}function Tg(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function gj(t){const e=Os(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=Zs(t),i=r?t.offsetWidth:n,a=r?t.offsetHeight:s,o=Oh(n)!==i||Oh(s)!==a;return o&&(n=i,s=a),{width:n,height:s,$:o}}function gy(t){return As(t)?t:t.contextElement}function Po(t){const e=gy(t);if(!Zs(e))return Js(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:i}=gj(e);let a=(i?Oh(n.width):n.width)/s,o=(i?Oh(n.height):n.height)/r;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const OD=Js(0);function xj(t){const e=Xn(t);return!my()||!e.visualViewport?OD:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function TD(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Xn(t)?!1:e}function ja(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=gy(t);let a=Js(1);e&&(s?As(s)&&(a=Po(s)):a=Po(t));const o=TD(i,n,s)?xj(i):Js(0);let l=(r.left+o.x)/a.x,u=(r.top+o.y)/a.y,d=r.width/a.x,h=r.height/a.y;if(i){const f=Xn(i),p=s&&As(s)?Xn(s):s;let b=f,x=Tg(b);for(;x&&s&&p!==b;){const v=Po(x),y=x.getBoundingClientRect(),g=Os(x),w=y.left+(x.clientLeft+parseFloat(g.paddingLeft))*v.x,_=y.top+(x.clientTop+parseFloat(g.paddingTop))*v.y;l*=v.x,u*=v.y,d*=v.x,h*=v.y,l+=w,u+=_,b=Xn(x),x=Tg(b)}}return Mh({width:d,height:h,x:l,y:u})}function wf(t,e){const n=bf(t).scrollLeft;return e?e.left+n:ja(tr(t)).left+n}function yj(t,e){const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-wf(t,n),r=n.top+e.scrollTop;return{x:s,y:r}}function MD(t){let{elements:e,rect:n,offsetParent:s,strategy:r}=t;const i=r==="fixed",a=tr(s),o=e?vf(e.floating):!1;if(s===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},u=Js(1);const d=Js(0),h=Zs(s);if((h||!h&&!i)&&((hl(s)!=="body"||pu(a))&&(l=bf(s)),Zs(s))){const p=ja(s);u=Po(s),d.x=p.x+s.clientLeft,d.y=p.y+s.clientTop}const f=a&&!h&&!i?yj(a,l):Js(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-l.scrollTop*u.y+d.y+f.y}}function ID(t){return Array.from(t.getClientRects())}function DD(t){const e=tr(t),n=bf(t),s=t.ownerDocument.body,r=qn(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=qn(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let a=-n.scrollLeft+wf(t);const o=-n.scrollTop;return Os(s).direction==="rtl"&&(a+=qn(e.clientWidth,s.clientWidth)-r),{width:r,height:i,x:a,y:o}}const P0=25;function LD(t,e){const n=Xn(t),s=tr(t),r=n.visualViewport;let i=s.clientWidth,a=s.clientHeight,o=0,l=0;if(r){i=r.width,a=r.height;const d=my();(!d||d&&e==="fixed")&&(o=r.offsetLeft,l=r.offsetTop)}const u=wf(s);if(u<=0){const d=s.ownerDocument,h=d.body,f=getComputedStyle(h),p=d.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,b=Math.abs(s.clientWidth-h.clientWidth-p);b<=P0&&(i-=b)}else u<=P0&&(i+=u);return{width:i,height:a,x:o,y:l}}const $D=new Set(["absolute","fixed"]);function FD(t,e){const n=ja(t,!0,e==="fixed"),s=n.top+t.clientTop,r=n.left+t.clientLeft,i=Zs(t)?Po(t):Js(1),a=t.clientWidth*i.x,o=t.clientHeight*i.y,l=r*i.x,u=s*i.y;return{width:a,height:o,x:l,y:u}}function R0(t,e,n){let s;if(e==="viewport")s=LD(t,n);else if(e==="document")s=DD(tr(t));else if(As(e))s=FD(e,n);else{const r=xj(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return Mh(s)}function vj(t,e){const n=ji(t);return n===e||!As(n)||nl(n)?!1:Os(n).position==="fixed"||vj(n,e)}function zD(t,e){const n=e.get(t);if(n)return n;let s=$c(t,[],!1).filter(o=>As(o)&&hl(o)!=="body"),r=null;const i=Os(t).position==="fixed";let a=i?ji(t):t;for(;As(a)&&!nl(a);){const o=Os(a),l=py(a);!l&&o.position==="fixed"&&(r=null),(i?!l&&!r:!l&&o.position==="static"&&!!r&&$D.has(r.position)||pu(a)&&!l&&vj(t,a))?s=s.filter(d=>d!==a):r=o,a=ji(a)}return e.set(t,s),s}function BD(t){let{element:e,boundary:n,rootBoundary:s,strategy:r}=t;const a=[...n==="clippingAncestors"?vf(e)?[]:zD(e,this._c):[].concat(n),s],o=a[0],l=a.reduce((u,d)=>{const h=R0(e,d,r);return u.top=qn(h.top,u.top),u.right=Si(h.right,u.right),u.bottom=Si(h.bottom,u.bottom),u.left=qn(h.left,u.left),u},R0(e,o,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function UD(t){const{width:e,height:n}=gj(t);return{width:e,height:n}}function WD(t,e,n){const s=Zs(e),r=tr(e),i=n==="fixed",a=ja(t,!0,i,e);let o={scrollLeft:0,scrollTop:0};const l=Js(0);function u(){l.x=wf(r)}if(s||!s&&!i)if((hl(e)!=="body"||pu(r))&&(o=bf(e)),s){const p=ja(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else r&&u();i&&!s&&r&&u();const d=r&&!s&&!i?yj(r,o):Js(0),h=a.left+o.scrollLeft-l.x-d.x,f=a.top+o.scrollTop-l.y-d.y;return{x:h,y:f,width:a.width,height:a.height}}function Pp(t){return Os(t).position==="static"}function A0(t,e){if(!Zs(t)||Os(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return tr(t)===n&&(n=n.ownerDocument.body),n}function bj(t,e){const n=Xn(t);if(vf(t))return n;if(!Zs(t)){let r=ji(t);for(;r&&!nl(r);){if(As(r)&&!Pp(r))return r;r=ji(r)}return n}let s=A0(t,e);for(;s&&jD(s)&&Pp(s);)s=A0(s,e);return s&&nl(s)&&Pp(s)&&!py(s)?n:s||RD(t)||n}const HD=async function(t){const e=this.getOffsetParent||bj,n=this.getDimensions,s=await n(t.floating);return{reference:WD(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function VD(t){return Os(t).direction==="rtl"}const qD={convertOffsetParentRelativeRectToViewportRelativeRect:MD,getDocumentElement:tr,getClippingRect:BD,getOffsetParent:bj,getElementRects:HD,getClientRects:ID,getDimensions:UD,getScale:Po,isElement:As,isRTL:VD};function wj(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function KD(t,e){let n=null,s;const r=tr(t);function i(){var o;clearTimeout(s),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:p}=u;if(o||e(),!f||!p)return;const b=sd(h),x=sd(r.clientWidth-(d+f)),v=sd(r.clientHeight-(h+p)),y=sd(d),w={rootMargin:-b+"px "+-x+"px "+-v+"px "+-y+"px",threshold:qn(0,Si(1,l))||1};let _=!0;function k(S){const j=S[0].intersectionRatio;if(j!==l){if(!_)return a();j?a(!1,j):s=setTimeout(()=>{a(!1,1e-7)},1e3)}j===1&&!wj(u,t.getBoundingClientRect())&&a(),_=!1}try{n=new IntersectionObserver(k,{...w,root:r.ownerDocument})}catch{n=new IntersectionObserver(k,w)}n.observe(t)}return a(!0),i}function GD(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,u=gy(t),d=r||i?[...u?$c(u):[],...$c(e)]:[];d.forEach(y=>{r&&y.addEventListener("scroll",n,{passive:!0}),i&&y.addEventListener("resize",n)});const h=u&&o?KD(u,n):null;let f=-1,p=null;a&&(p=new ResizeObserver(y=>{let[g]=y;g&&g.target===u&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(e)})),n()}),u&&!l&&p.observe(u),p.observe(e));let b,x=l?ja(t):null;l&&v();function v(){const y=ja(t);x&&!wj(x,y)&&n(),x=y,b=requestAnimationFrame(v)}return n(),()=>{var y;d.forEach(g=>{r&&g.removeEventListener("scroll",n),i&&g.removeEventListener("resize",n)}),h==null||h(),(y=p)==null||y.disconnect(),p=null,l&&cancelAnimationFrame(b)}}const YD=vD,QD=bD,XD=gD,JD=_D,ZD=xD,O0=mD,e5=wD,t5=(t,e,n)=>{const s=new Map,r={platform:qD,...n},i={...r.platform,_c:s};return pD(t,e,{...r,platform:i})};var n5=typeof document<"u",s5=function(){},Kd=n5?m.useLayoutEffect:s5;function Ih(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!Ih(t[s],e[s]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){const i=r[s];if(!(i==="_owner"&&t.$$typeof)&&!Ih(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function _j(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function T0(t,e){const n=_j(t);return Math.round(e*n)/n}function Rp(t){const e=m.useRef(t);return Kd(()=>{e.current=t}),e}function r5(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:u}=t,[d,h]=m.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=m.useState(s);Ih(f,s)||p(s);const[b,x]=m.useState(null),[v,y]=m.useState(null),g=m.useCallback(E=>{E!==S.current&&(S.current=E,x(E))},[]),w=m.useCallback(E=>{E!==j.current&&(j.current=E,y(E))},[]),_=i||b,k=a||v,S=m.useRef(null),j=m.useRef(null),N=m.useRef(d),T=l!=null,A=Rp(l),z=Rp(r),M=Rp(u),I=m.useCallback(()=>{if(!S.current||!j.current)return;const E={placement:e,strategy:n,middleware:f};z.current&&(E.platform=z.current),t5(S.current,j.current,E).then(C=>{const F={...C,isPositioned:M.current!==!1};H.current&&!Ih(N.current,F)&&(N.current=F,au.flushSync(()=>{h(F)}))})},[f,e,n,z,M]);Kd(()=>{u===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,h(E=>({...E,isPositioned:!1})))},[u]);const H=m.useRef(!1);Kd(()=>(H.current=!0,()=>{H.current=!1}),[]),Kd(()=>{if(_&&(S.current=_),k&&(j.current=k),_&&k){if(A.current)return A.current(_,k,I);I()}},[_,k,I,A,T]);const L=m.useMemo(()=>({reference:S,floating:j,setReference:g,setFloating:w}),[g,w]),D=m.useMemo(()=>({reference:_,floating:k}),[_,k]),G=m.useMemo(()=>{const E={position:n,left:0,top:0};if(!D.floating)return E;const C=T0(D.floating,d.x),F=T0(D.floating,d.y);return o?{...E,transform:"translate("+C+"px, "+F+"px)",..._j(D.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:C,top:F}},[n,o,D.floating,d.x,d.y]);return m.useMemo(()=>({...d,update:I,refs:L,elements:D,floatingStyles:G}),[d,I,L,D,G])}const i5=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:r}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?O0({element:s.current,padding:r}).fn(n):{}:s?O0({element:s,padding:r}).fn(n):{}}}},a5=(t,e)=>({...YD(t),options:[t,e]}),o5=(t,e)=>({...QD(t),options:[t,e]}),l5=(t,e)=>({...e5(t),options:[t,e]}),c5=(t,e)=>({...XD(t),options:[t,e]}),u5=(t,e)=>({...JD(t),options:[t,e]}),d5=(t,e)=>({...ZD(t),options:[t,e]}),h5=(t,e)=>({...i5(t),options:[t,e]});var f5="Arrow",kj=m.forwardRef((t,e)=>{const{children:n,width:s=10,height:r=5,...i}=t;return c.jsx(bn.svg,{...i,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});kj.displayName=f5;var p5=kj;function m5(t){const[e,n]=m.useState(void 0);return ki(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;a=u.inlineSize,o=u.blockSize}else a=t.offsetWidth,o=t.offsetHeight;n({width:a,height:o})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var xy="Popper",[Sj,jj]=fu(xy),[g5,Cj]=Sj(xy),Nj=t=>{const{__scopePopper:e,children:n}=t,[s,r]=m.useState(null);return c.jsx(g5,{scope:e,anchor:s,onAnchorChange:r,children:n})};Nj.displayName=xy;var Ej="PopperAnchor",Pj=m.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...r}=t,i=Cj(Ej,n),a=m.useRef(null),o=Ln(e,a),l=m.useRef(null);return m.useEffect(()=>{const u=l.current;l.current=(s==null?void 0:s.current)||a.current,u!==l.current&&i.onAnchorChange(l.current)}),s?null:c.jsx(bn.div,{...r,ref:o})});Pj.displayName=Ej;var yy="PopperContent",[x5,y5]=Sj(yy),Rj=m.forwardRef((t,e)=>{var ae,Ce,Le,st,be,he;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:b,...x}=t,v=Cj(yy,n),[y,g]=m.useState(null),w=Ln(e,Ke=>g(Ke)),[_,k]=m.useState(null),S=m5(_),j=(S==null?void 0:S.width)??0,N=(S==null?void 0:S.height)??0,T=s+(i!=="center"?"-"+i:""),A=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},z=Array.isArray(u)?u:[u],M=z.length>0,I={padding:A,boundary:z.filter(b5),altBoundary:M},{refs:H,floatingStyles:L,placement:D,isPositioned:G,middlewareData:E}=r5({strategy:"fixed",placement:T,whileElementsMounted:(...Ke)=>GD(...Ke,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[a5({mainAxis:r+N,alignmentAxis:a}),l&&o5({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?l5():void 0,...I}),l&&c5({...I}),u5({...I,apply:({elements:Ke,rects:ee,availableWidth:de,availableHeight:le})=>{const{width:Y,height:Q}=ee.reference,oe=Ke.floating.style;oe.setProperty("--radix-popper-available-width",`${de}px`),oe.setProperty("--radix-popper-available-height",`${le}px`),oe.setProperty("--radix-popper-anchor-width",`${Y}px`),oe.setProperty("--radix-popper-anchor-height",`${Q}px`)}}),_&&h5({element:_,padding:o}),w5({arrowWidth:j,arrowHeight:N}),f&&d5({strategy:"referenceHidden",...I})]}),[C,F]=Tj(D),K=Cr(b);ki(()=>{G&&(K==null||K())},[G,K]);const U=(ae=E.arrow)==null?void 0:ae.x,ie=(Ce=E.arrow)==null?void 0:Ce.y,V=((Le=E.arrow)==null?void 0:Le.centerOffset)!==0,[O,q]=m.useState();return ki(()=>{y&&q(window.getComputedStyle(y).zIndex)},[y]),c.jsx("div",{ref:H.setFloating,"data-radix-popper-content-wrapper":"",style:{...L,transform:G?L.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:O,"--radix-popper-transform-origin":[(st=E.transformOrigin)==null?void 0:st.x,(be=E.transformOrigin)==null?void 0:be.y].join(" "),...((he=E.hide)==null?void 0:he.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:c.jsx(x5,{scope:n,placedSide:C,onArrowChange:k,arrowX:U,arrowY:ie,shouldHideArrow:V,children:c.jsx(bn.div,{"data-side":C,"data-align":F,...x,ref:w,style:{...x.style,animation:G?void 0:"none"}})})})});Rj.displayName=yy;var Aj="PopperArrow",v5={top:"bottom",right:"left",bottom:"top",left:"right"},Oj=m.forwardRef(function(e,n){const{__scopePopper:s,...r}=e,i=y5(Aj,s),a=v5[i.placedSide];return c.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:c.jsx(p5,{...r,ref:n,style:{...r.style,display:"block"}})})});Oj.displayName=Aj;function b5(t){return t!==null}var w5=t=>({name:"transformOrigin",options:t,fn(e){var v,y,g;const{placement:n,rects:s,middlewareData:r}=e,a=((v=r.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:t.arrowWidth,l=a?0:t.arrowHeight,[u,d]=Tj(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((y=r.arrow)==null?void 0:y.x)??0)+o/2,p=(((g=r.arrow)==null?void 0:g.y)??0)+l/2;let b="",x="";return u==="bottom"?(b=a?h:`${f}px`,x=`${-l}px`):u==="top"?(b=a?h:`${f}px`,x=`${s.floating.height+l}px`):u==="right"?(b=`${-l}px`,x=a?h:`${p}px`):u==="left"&&(b=`${s.floating.width+l}px`,x=a?h:`${p}px`),{data:{x:b,y:x}}}});function Tj(t){const[e,n="center"]=t.split("-");return[e,n]}var _5=Nj,k5=Pj,S5=Rj,j5=Oj,C5="Portal",Mj=m.forwardRef((t,e)=>{var o;const{container:n,...s}=t,[r,i]=m.useState(!1);ki(()=>i(!0),[]);const a=n||r&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?YP.createPortal(c.jsx(bn.div,{...s,ref:e}),a):null});Mj.displayName=C5;function N5(t,e){return m.useReducer((n,s)=>e[n][s]??n,t)}var mu=t=>{const{present:e,children:n}=t,s=E5(e),r=typeof n=="function"?n({present:s.isPresent}):m.Children.only(n),i=Ln(s.ref,P5(r));return typeof n=="function"||s.isPresent?m.cloneElement(r,{ref:i}):null};mu.displayName="Presence";function E5(t){const[e,n]=m.useState(),s=m.useRef(null),r=m.useRef(t),i=m.useRef("none"),a=t?"mounted":"unmounted",[o,l]=N5(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const u=rd(s.current);i.current=o==="mounted"?u:"none"},[o]),ki(()=>{const u=s.current,d=r.current;if(d!==t){const f=i.current,p=rd(u);t?l("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),ki(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=p=>{const x=rd(s.current).includes(CSS.escape(p.animationName));if(p.target===e&&x&&(l("ANIMATION_END"),!r.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(i.current=rd(s.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:m.useCallback(u=>{s.current=u?getComputedStyle(u):null,n(u)},[])}}function rd(t){return(t==null?void 0:t.animationName)||"none"}function P5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Ap="rovingFocusGroup.onEntryFocus",R5={bubbles:!1,cancelable:!0},gu="RovingFocusGroup",[Mg,Ij,A5]=ij(gu),[O5,Dj]=fu(gu,[A5]),[T5,M5]=O5(gu),Lj=m.forwardRef((t,e)=>c.jsx(Mg.Provider,{scope:t.__scopeRovingFocusGroup,children:c.jsx(Mg.Slot,{scope:t.__scopeRovingFocusGroup,children:c.jsx(I5,{...t,ref:e})})}));Lj.displayName=gu;var I5=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:r=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=m.useRef(null),p=Ln(e,f),b=aj(i),[x,v]=sj({prop:a,defaultProp:o??null,onChange:l,caller:gu}),[y,g]=m.useState(!1),w=Cr(u),_=Ij(n),k=m.useRef(!1),[S,j]=m.useState(0);return m.useEffect(()=>{const N=f.current;if(N)return N.addEventListener(Ap,w),()=>N.removeEventListener(Ap,w)},[w]),c.jsx(T5,{scope:n,orientation:s,dir:b,loop:r,currentTabStopId:x,onItemFocus:m.useCallback(N=>v(N),[v]),onItemShiftTab:m.useCallback(()=>g(!0),[]),onFocusableItemAdd:m.useCallback(()=>j(N=>N+1),[]),onFocusableItemRemove:m.useCallback(()=>j(N=>N-1),[]),children:c.jsx(bn.div,{tabIndex:y||S===0?-1:0,"data-orientation":s,...h,ref:p,style:{outline:"none",...t.style},onMouseDown:Be(t.onMouseDown,()=>{k.current=!0}),onFocus:Be(t.onFocus,N=>{const T=!k.current;if(N.target===N.currentTarget&&T&&!y){const A=new CustomEvent(Ap,R5);if(N.currentTarget.dispatchEvent(A),!A.defaultPrevented){const z=_().filter(D=>D.focusable),M=z.find(D=>D.active),I=z.find(D=>D.id===x),L=[M,I,...z].filter(Boolean).map(D=>D.ref.current);zj(L,d)}}k.current=!1}),onBlur:Be(t.onBlur,()=>g(!1))})})}),$j="RovingFocusGroupItem",Fj=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:r=!1,tabStopId:i,children:a,...o}=t,l=Rg(),u=i||l,d=M5($j,n),h=d.currentTabStopId===u,f=Ij(n),{onFocusableItemAdd:p,onFocusableItemRemove:b,currentTabStopId:x}=d;return m.useEffect(()=>{if(s)return p(),()=>b()},[s,p,b]),c.jsx(Mg.ItemSlot,{scope:n,id:u,focusable:s,active:r,children:c.jsx(bn.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...o,ref:e,onMouseDown:Be(t.onMouseDown,v=>{s?d.onItemFocus(u):v.preventDefault()}),onFocus:Be(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:Be(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){d.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const y=$5(v,d.orientation,d.dir);if(y!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let w=f().filter(_=>_.focusable).map(_=>_.ref.current);if(y==="last")w.reverse();else if(y==="prev"||y==="next"){y==="prev"&&w.reverse();const _=w.indexOf(v.currentTarget);w=d.loop?F5(w,_+1):w.slice(_+1)}setTimeout(()=>zj(w))}}),children:typeof a=="function"?a({isCurrentTabStop:h,hasTabStop:x!=null}):a})})});Fj.displayName=$j;var D5={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function L5(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function $5(t,e,n){const s=L5(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return D5[s]}function zj(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function F5(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var z5=Lj,B5=Fj;function U5(t){const e=W5(t),n=m.forwardRef((s,r)=>{const{children:i,...a}=s,o=m.Children.toArray(i),l=o.find(V5);if(l){const u=l.props.children,d=o.map(h=>h===l?m.Children.count(u)>1?m.Children.only(null):m.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...a,ref:r,children:m.isValidElement(u)?m.cloneElement(u,void 0,d):null})}return c.jsx(e,{...a,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function W5(t){const e=m.forwardRef((n,s)=>{const{children:r,...i}=n;if(m.isValidElement(r)){const a=K5(r),o=q5(i,r.props);return r.type!==m.Fragment&&(o.ref=s?Aa(s,a):a),m.cloneElement(r,o)}return m.Children.count(r)>1?m.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var H5=Symbol("radix.slottable");function V5(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===H5}function q5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...o)=>{const l=i(...o);return r(...o),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function K5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var G5=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ga=new WeakMap,id=new WeakMap,ad={},Op=0,Bj=function(t){return t&&(t.host||Bj(t.parentNode))},Y5=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=Bj(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},Q5=function(t,e,n,s){var r=Y5(e,Array.isArray(t)?t:[t]);ad[n]||(ad[n]=new WeakMap);var i=ad[n],a=[],o=new Set,l=new Set(r),u=function(h){!h||o.has(h)||(o.add(h),u(h.parentNode))};r.forEach(u);var d=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(o.has(f))d(f);else try{var p=f.getAttribute(s),b=p!==null&&p!=="false",x=(Ga.get(f)||0)+1,v=(i.get(f)||0)+1;Ga.set(f,x),i.set(f,v),a.push(f),x===1&&b&&id.set(f,!0),v===1&&f.setAttribute(n,"true"),b||f.setAttribute(s,"true")}catch(y){console.error("aria-hidden: cannot operate on ",f,y)}})};return d(e),o.clear(),Op++,function(){a.forEach(function(h){var f=Ga.get(h)-1,p=i.get(h)-1;Ga.set(h,f),i.set(h,p),f||(id.has(h)||h.removeAttribute(s),id.delete(h)),p||h.removeAttribute(n)}),Op--,Op||(Ga=new WeakMap,Ga=new WeakMap,id=new WeakMap,ad={})}},X5=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=G5(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),Q5(s,r,n,"aria-hidden")):function(){return null}},Gd="right-scroll-bar-position",Yd="width-before-scroll-bar",J5="with-scroll-bars-hidden",Z5="--removed-body-scroll-bar-size";function Tp(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function eL(t,e){var n=m.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var r=n.value;r!==s&&(n.value=s,n.callback(s,r))}}}})[0];return n.callback=e,n.facade}var tL=typeof window<"u"?m.useLayoutEffect:m.useEffect,M0=new WeakMap;function nL(t,e){var n=eL(null,function(s){return t.forEach(function(r){return Tp(r,s)})});return tL(function(){var s=M0.get(n);if(s){var r=new Set(s),i=new Set(t),a=n.current;r.forEach(function(o){i.has(o)||Tp(o,null)}),i.forEach(function(o){r.has(o)||Tp(o,a)})}M0.set(n,t)},[t]),n}function sL(t){return t}function rL(t,e){e===void 0&&(e=sL);var n=[],s=!1,r={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var a=e(i,s);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(s=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){s=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var d=a;a=[],d.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(d){a.push(d),u()},filter:function(d){return a=a.filter(d),n}}}};return r}function iL(t){t===void 0&&(t={});var e=rL(null);return e.options=Gs({async:!0,ssr:!1},t),e}var Uj=function(t){var e=t.sideCar,n=ul(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return m.createElement(s,Gs({},n))};Uj.isSideCarExport=!0;function aL(t,e){return t.useMedium(e),Uj}var Wj=iL(),Mp=function(){},_f=m.forwardRef(function(t,e){var n=m.useRef(null),s=m.useState({onScrollCapture:Mp,onWheelCapture:Mp,onTouchMoveCapture:Mp}),r=s[0],i=s[1],a=t.forwardProps,o=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,p=t.noRelative,b=t.noIsolation,x=t.inert,v=t.allowPinchZoom,y=t.as,g=y===void 0?"div":y,w=t.gapMode,_=ul(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=f,S=nL([n,e]),j=Gs(Gs({},_),r);return m.createElement(m.Fragment,null,d&&m.createElement(k,{sideCar:Wj,removeScrollBar:u,shards:h,noRelative:p,noIsolation:b,inert:x,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:w}),a?m.cloneElement(m.Children.only(o),Gs(Gs({},j),{ref:S})):m.createElement(g,Gs({},j,{className:l,ref:S}),o))});_f.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_f.classNames={fullWidth:Yd,zeroRight:Gd};var oL=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function lL(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=oL();return e&&t.setAttribute("nonce",e),t}function cL(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function uL(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var dL=function(){var t=0,e=null;return{add:function(n){t==0&&(e=lL())&&(cL(e,n),uL(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},hL=function(){var t=dL();return function(e,n){m.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},Hj=function(){var t=hL(),e=function(n){var s=n.styles,r=n.dynamic;return t(s,r),null};return e},fL={left:0,top:0,right:0,gap:0},Ip=function(t){return parseInt(t||"",10)||0},pL=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[Ip(n),Ip(s),Ip(r)]},mL=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return fL;var e=pL(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},gL=Hj(),Ro="data-scroll-locked",xL=function(t,e,n,s){var r=t.left,i=t.top,a=t.right,o=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(J5,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(o,"px ").concat(s,`;
  }
  body[`).concat(Ro,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Gd,` {
    right: `).concat(o,"px ").concat(s,`;
  }
  
  .`).concat(Yd,` {
    margin-right: `).concat(o,"px ").concat(s,`;
  }
  
  .`).concat(Gd," .").concat(Gd,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Yd," .").concat(Yd,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Ro,`] {
    `).concat(Z5,": ").concat(o,`px;
  }
`)},I0=function(){var t=parseInt(document.body.getAttribute(Ro)||"0",10);return isFinite(t)?t:0},yL=function(){m.useEffect(function(){return document.body.setAttribute(Ro,(I0()+1).toString()),function(){var t=I0()-1;t<=0?document.body.removeAttribute(Ro):document.body.setAttribute(Ro,t.toString())}},[])},vL=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,r=s===void 0?"margin":s;yL();var i=m.useMemo(function(){return mL(r)},[r]);return m.createElement(gL,{styles:xL(i,!e,r,n?"":"!important")})},Ig=!1;if(typeof window<"u")try{var od=Object.defineProperty({},"passive",{get:function(){return Ig=!0,!0}});window.addEventListener("test",od,od),window.removeEventListener("test",od,od)}catch{Ig=!1}var Ya=Ig?{passive:!1}:!1,bL=function(t){return t.tagName==="TEXTAREA"},Vj=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!bL(t)&&n[e]==="visible")},wL=function(t){return Vj(t,"overflowY")},_L=function(t){return Vj(t,"overflowX")},D0=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var r=qj(t,s);if(r){var i=Kj(t,s),a=i[1],o=i[2];if(a>o)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},kL=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},SL=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},qj=function(t,e){return t==="v"?wL(e):_L(e)},Kj=function(t,e){return t==="v"?kL(e):SL(e)},jL=function(t,e){return t==="h"&&e==="rtl"?-1:1},CL=function(t,e,n,s,r){var i=jL(t,window.getComputedStyle(e).direction),a=i*s,o=n.target,l=e.contains(o),u=!1,d=a>0,h=0,f=0;do{if(!o)break;var p=Kj(t,o),b=p[0],x=p[1],v=p[2],y=x-v-i*b;(b||y)&&qj(t,o)&&(h+=y,f+=b);var g=o.parentNode;o=g&&g.nodeType===Node.DOCUMENT_FRAGMENT_NODE?g.host:g}while(!l&&o!==document.body||l&&(e.contains(o)||e===o));return(d&&Math.abs(h)<1||!d&&Math.abs(f)<1)&&(u=!0),u},ld=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},L0=function(t){return[t.deltaX,t.deltaY]},$0=function(t){return t&&"current"in t?t.current:t},NL=function(t,e){return t[0]===e[0]&&t[1]===e[1]},EL=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},PL=0,Qa=[];function RL(t){var e=m.useRef([]),n=m.useRef([0,0]),s=m.useRef(),r=m.useState(PL++)[0],i=m.useState(Hj)[0],a=m.useRef(t);m.useEffect(function(){a.current=t},[t]),m.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var x=$O([t.lockRef.current],(t.shards||[]).map($0),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var o=m.useCallback(function(x,v){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!a.current.allowPinchZoom;var y=ld(x),g=n.current,w="deltaX"in x?x.deltaX:g[0]-y[0],_="deltaY"in x?x.deltaY:g[1]-y[1],k,S=x.target,j=Math.abs(w)>Math.abs(_)?"h":"v";if("touches"in x&&j==="h"&&S.type==="range")return!1;var N=window.getSelection(),T=N&&N.anchorNode,A=T?T===S||T.contains(S):!1;if(A)return!1;var z=D0(j,S);if(!z)return!0;if(z?k=j:(k=j==="v"?"h":"v",z=D0(j,S)),!z)return!1;if(!s.current&&"changedTouches"in x&&(w||_)&&(s.current=k),!k)return!0;var M=s.current||k;return CL(M,v,x,M==="h"?w:_)},[]),l=m.useCallback(function(x){var v=x;if(!(!Qa.length||Qa[Qa.length-1]!==i)){var y="deltaY"in v?L0(v):ld(v),g=e.current.filter(function(k){return k.name===v.type&&(k.target===v.target||v.target===k.shadowParent)&&NL(k.delta,y)})[0];if(g&&g.should){v.cancelable&&v.preventDefault();return}if(!g){var w=(a.current.shards||[]).map($0).filter(Boolean).filter(function(k){return k.contains(v.target)}),_=w.length>0?o(v,w[0]):!a.current.noIsolation;_&&v.cancelable&&v.preventDefault()}}},[]),u=m.useCallback(function(x,v,y,g){var w={name:x,delta:v,target:y,should:g,shadowParent:AL(y)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(_){return _!==w})},1)},[]),d=m.useCallback(function(x){n.current=ld(x),s.current=void 0},[]),h=m.useCallback(function(x){u(x.type,L0(x),x.target,o(x,t.lockRef.current))},[]),f=m.useCallback(function(x){u(x.type,ld(x),x.target,o(x,t.lockRef.current))},[]);m.useEffect(function(){return Qa.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Ya),document.addEventListener("touchmove",l,Ya),document.addEventListener("touchstart",d,Ya),function(){Qa=Qa.filter(function(x){return x!==i}),document.removeEventListener("wheel",l,Ya),document.removeEventListener("touchmove",l,Ya),document.removeEventListener("touchstart",d,Ya)}},[]);var p=t.removeScrollBar,b=t.inert;return m.createElement(m.Fragment,null,b?m.createElement(i,{styles:EL(r)}):null,p?m.createElement(vL,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function AL(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const OL=aL(Wj,RL);var Gj=m.forwardRef(function(t,e){return m.createElement(_f,Gs({},t,{ref:e,sideCar:OL}))});Gj.classNames=_f.classNames;var Dg=["Enter"," "],TL=["ArrowDown","PageUp","Home"],Yj=["ArrowUp","PageDown","End"],ML=[...TL,...Yj],IL={ltr:[...Dg,"ArrowRight"],rtl:[...Dg,"ArrowLeft"]},DL={ltr:["ArrowLeft"],rtl:["ArrowRight"]},xu="Menu",[Fc,LL,$L]=ij(xu),[Ta,Qj]=fu(xu,[$L,jj,Dj]),kf=jj(),Xj=Dj(),[FL,Ma]=Ta(xu),[zL,yu]=Ta(xu),Jj=t=>{const{__scopeMenu:e,open:n=!1,children:s,dir:r,onOpenChange:i,modal:a=!0}=t,o=kf(e),[l,u]=m.useState(null),d=m.useRef(!1),h=Cr(i),f=aj(r);return m.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),c.jsx(_5,{...o,children:c.jsx(FL,{scope:e,open:n,onOpenChange:h,content:l,onContentChange:u,children:c.jsx(zL,{scope:e,onClose:m.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:a,children:s})})})};Jj.displayName=xu;var BL="MenuAnchor",vy=m.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=kf(n);return c.jsx(k5,{...r,...s,ref:e})});vy.displayName=BL;var by="MenuPortal",[UL,Zj]=Ta(by,{forceMount:void 0}),eC=t=>{const{__scopeMenu:e,forceMount:n,children:s,container:r}=t,i=Ma(by,e);return c.jsx(UL,{scope:e,forceMount:n,children:c.jsx(mu,{present:n||i.open,children:c.jsx(Mj,{asChild:!0,container:r,children:s})})})};eC.displayName=by;var ds="MenuContent",[WL,wy]=Ta(ds),tC=m.forwardRef((t,e)=>{const n=Zj(ds,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Ma(ds,t.__scopeMenu),a=yu(ds,t.__scopeMenu);return c.jsx(Fc.Provider,{scope:t.__scopeMenu,children:c.jsx(mu,{present:s||i.open,children:c.jsx(Fc.Slot,{scope:t.__scopeMenu,children:a.modal?c.jsx(HL,{...r,ref:e}):c.jsx(VL,{...r,ref:e})})})})}),HL=m.forwardRef((t,e)=>{const n=Ma(ds,t.__scopeMenu),s=m.useRef(null),r=Ln(e,s);return m.useEffect(()=>{const i=s.current;if(i)return X5(i)},[]),c.jsx(_y,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Be(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),VL=m.forwardRef((t,e)=>{const n=Ma(ds,t.__scopeMenu);return c.jsx(_y,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),qL=U5("MenuContent.ScrollLock"),_y=m.forwardRef((t,e)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:b,...x}=t,v=Ma(ds,n),y=yu(ds,n),g=kf(n),w=Xj(n),_=LL(n),[k,S]=m.useState(null),j=m.useRef(null),N=Ln(e,j,v.onContentChange),T=m.useRef(0),A=m.useRef(""),z=m.useRef(0),M=m.useRef(null),I=m.useRef("right"),H=m.useRef(0),L=b?Gj:m.Fragment,D=b?{as:qL,allowPinchZoom:!0}:void 0,G=C=>{var ae,Ce;const F=A.current+C,K=_().filter(Le=>!Le.disabled),U=document.activeElement,ie=(ae=K.find(Le=>Le.ref.current===U))==null?void 0:ae.textValue,V=K.map(Le=>Le.textValue),O=r$(V,F,ie),q=(Ce=K.find(Le=>Le.textValue===O))==null?void 0:Ce.ref.current;(function Le(st){A.current=st,window.clearTimeout(T.current),st!==""&&(T.current=window.setTimeout(()=>Le(""),1e3))})(F),q&&setTimeout(()=>q.focus())};m.useEffect(()=>()=>window.clearTimeout(T.current),[]),KI();const E=m.useCallback(C=>{var K,U;return I.current===((K=M.current)==null?void 0:K.side)&&a$(C,(U=M.current)==null?void 0:U.area)},[]);return c.jsx(WL,{scope:n,searchRef:A,onItemEnter:m.useCallback(C=>{E(C)&&C.preventDefault()},[E]),onItemLeave:m.useCallback(C=>{var F;E(C)||((F=j.current)==null||F.focus(),S(null))},[E]),onTriggerLeave:m.useCallback(C=>{E(C)&&C.preventDefault()},[E]),pointerGraceTimerRef:z,onPointerGraceIntentChange:m.useCallback(C=>{M.current=C},[]),children:c.jsx(L,{...D,children:c.jsx(uj,{asChild:!0,trapped:r,onMountAutoFocus:Be(i,C=>{var F;C.preventDefault(),(F=j.current)==null||F.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:c.jsx(lj,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:c.jsx(z5,{asChild:!0,...w,dir:y.dir,orientation:"vertical",loop:s,currentTabStopId:k,onCurrentTabStopIdChange:S,onEntryFocus:Be(l,C=>{y.isUsingKeyboardRef.current||C.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(S5,{role:"menu","aria-orientation":"vertical","data-state":xC(v.open),"data-radix-menu-content":"",dir:y.dir,...g,...x,ref:N,style:{outline:"none",...x.style},onKeyDown:Be(x.onKeyDown,C=>{const K=C.target.closest("[data-radix-menu-content]")===C.currentTarget,U=C.ctrlKey||C.altKey||C.metaKey,ie=C.key.length===1;K&&(C.key==="Tab"&&C.preventDefault(),!U&&ie&&G(C.key));const V=j.current;if(C.target!==V||!ML.includes(C.key))return;C.preventDefault();const q=_().filter(ae=>!ae.disabled).map(ae=>ae.ref.current);Yj.includes(C.key)&&q.reverse(),n$(q)}),onBlur:Be(t.onBlur,C=>{C.currentTarget.contains(C.target)||(window.clearTimeout(T.current),A.current="")}),onPointerMove:Be(t.onPointerMove,zc(C=>{const F=C.target,K=H.current!==C.clientX;if(C.currentTarget.contains(F)&&K){const U=C.clientX>H.current?"right":"left";I.current=U,H.current=C.clientX}}))})})})})})})});tC.displayName=ds;var KL="MenuGroup",ky=m.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(bn.div,{role:"group",...s,ref:e})});ky.displayName=KL;var GL="MenuLabel",nC=m.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(bn.div,{...s,ref:e})});nC.displayName=GL;var Dh="MenuItem",F0="menu.itemSelect",Sf=m.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:s,...r}=t,i=m.useRef(null),a=yu(Dh,t.__scopeMenu),o=wy(Dh,t.__scopeMenu),l=Ln(e,i),u=m.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(F0,{bubbles:!0,cancelable:!0});h.addEventListener(F0,p=>s==null?void 0:s(p),{once:!0}),rj(h,f),f.defaultPrevented?u.current=!1:a.onClose()}};return c.jsx(sC,{...r,ref:l,disabled:n,onClick:Be(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:Be(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:Be(t.onKeyDown,h=>{const f=o.searchRef.current!=="";n||f&&h.key===" "||Dg.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Sf.displayName=Dh;var sC=m.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:s=!1,textValue:r,...i}=t,a=wy(Dh,n),o=Xj(n),l=m.useRef(null),u=Ln(e,l),[d,h]=m.useState(!1),[f,p]=m.useState("");return m.useEffect(()=>{const b=l.current;b&&p((b.textContent??"").trim())},[i.children]),c.jsx(Fc.ItemSlot,{scope:n,disabled:s,textValue:r??f,children:c.jsx(B5,{asChild:!0,...o,focusable:!s,children:c.jsx(bn.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:u,onPointerMove:Be(t.onPointerMove,zc(b=>{s?a.onItemLeave(b):(a.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Be(t.onPointerLeave,zc(b=>a.onItemLeave(b))),onFocus:Be(t.onFocus,()=>h(!0)),onBlur:Be(t.onBlur,()=>h(!1))})})})}),YL="MenuCheckboxItem",rC=m.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:s,...r}=t;return c.jsx(cC,{scope:t.__scopeMenu,checked:n,children:c.jsx(Sf,{role:"menuitemcheckbox","aria-checked":Lh(n)?"mixed":n,...r,ref:e,"data-state":jy(n),onSelect:Be(r.onSelect,()=>s==null?void 0:s(Lh(n)?!0:!n),{checkForDefaultPrevented:!1})})})});rC.displayName=YL;var iC="MenuRadioGroup",[QL,XL]=Ta(iC,{value:void 0,onValueChange:()=>{}}),aC=m.forwardRef((t,e)=>{const{value:n,onValueChange:s,...r}=t,i=Cr(s);return c.jsx(QL,{scope:t.__scopeMenu,value:n,onValueChange:i,children:c.jsx(ky,{...r,ref:e})})});aC.displayName=iC;var oC="MenuRadioItem",lC=m.forwardRef((t,e)=>{const{value:n,...s}=t,r=XL(oC,t.__scopeMenu),i=n===r.value;return c.jsx(cC,{scope:t.__scopeMenu,checked:i,children:c.jsx(Sf,{role:"menuitemradio","aria-checked":i,...s,ref:e,"data-state":jy(i),onSelect:Be(s.onSelect,()=>{var a;return(a=r.onValueChange)==null?void 0:a.call(r,n)},{checkForDefaultPrevented:!1})})})});lC.displayName=oC;var Sy="MenuItemIndicator",[cC,JL]=Ta(Sy,{checked:!1}),uC=m.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:s,...r}=t,i=JL(Sy,n);return c.jsx(mu,{present:s||Lh(i.checked)||i.checked===!0,children:c.jsx(bn.span,{...r,ref:e,"data-state":jy(i.checked)})})});uC.displayName=Sy;var ZL="MenuSeparator",dC=m.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(bn.div,{role:"separator","aria-orientation":"horizontal",...s,ref:e})});dC.displayName=ZL;var e$="MenuArrow",hC=m.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=kf(n);return c.jsx(j5,{...r,...s,ref:e})});hC.displayName=e$;var t$="MenuSub",[u8,fC]=Ta(t$),Wl="MenuSubTrigger",pC=m.forwardRef((t,e)=>{const n=Ma(Wl,t.__scopeMenu),s=yu(Wl,t.__scopeMenu),r=fC(Wl,t.__scopeMenu),i=wy(Wl,t.__scopeMenu),a=m.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,u={__scopeMenu:t.__scopeMenu},d=m.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return m.useEffect(()=>d,[d]),m.useEffect(()=>{const h=o.current;return()=>{window.clearTimeout(h),l(null)}},[o,l]),c.jsx(vy,{asChild:!0,...u,children:c.jsx(sC,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":xC(n.open),...t,ref:Aa(e,r.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Be(t.onPointerMove,zc(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:Be(t.onPointerLeave,zc(h=>{var p,b;d();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const x=(b=n.content)==null?void 0:b.dataset.side,v=x==="right",y=v?-5:5,g=f[v?"left":"right"],w=f[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+y,y:h.clientY},{x:g,y:f.top},{x:w,y:f.top},{x:w,y:f.bottom},{x:g,y:f.bottom}],side:x}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Be(t.onKeyDown,h=>{var p;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||IL[s.dir].includes(h.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),h.preventDefault())})})})});pC.displayName=Wl;var mC="MenuSubContent",gC=m.forwardRef((t,e)=>{const n=Zj(ds,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Ma(ds,t.__scopeMenu),a=yu(ds,t.__scopeMenu),o=fC(mC,t.__scopeMenu),l=m.useRef(null),u=Ln(e,l);return c.jsx(Fc.Provider,{scope:t.__scopeMenu,children:c.jsx(mu,{present:s||i.open,children:c.jsx(Fc.Slot,{scope:t.__scopeMenu,children:c.jsx(_y,{id:o.contentId,"aria-labelledby":o.triggerId,...r,ref:u,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;a.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:Be(t.onFocusOutside,d=>{d.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Be(t.onEscapeKeyDown,d=>{a.onClose(),d.preventDefault()}),onKeyDown:Be(t.onKeyDown,d=>{var p;const h=d.currentTarget.contains(d.target),f=DL[a.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(p=o.trigger)==null||p.focus(),d.preventDefault())})})})})})});gC.displayName=mC;function xC(t){return t?"open":"closed"}function Lh(t){return t==="indeterminate"}function jy(t){return Lh(t)?"indeterminate":t?"checked":"unchecked"}function n$(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function s$(t,e){return t.map((n,s)=>t[(e+s)%t.length])}function r$(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let a=s$(t,Math.max(i,0));r.length===1&&(a=a.filter(u=>u!==n));const l=a.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function i$(t,e){const{x:n,y:s}=t;let r=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const o=e[i],l=e[a],u=o.x,d=o.y,h=l.x,f=l.y;d>s!=f>s&&n<(h-u)*(s-d)/(f-d)+u&&(r=!r)}return r}function a$(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return i$(n,e)}function zc(t){return e=>e.pointerType==="mouse"?t(e):void 0}var o$=Jj,l$=vy,c$=eC,u$=tC,d$=ky,h$=nC,f$=Sf,p$=rC,m$=aC,g$=lC,x$=uC,y$=dC,v$=hC,b$=pC,w$=gC,jf="DropdownMenu",[_$]=fu(jf,[Qj]),wn=Qj(),[k$,yC]=_$(jf),vC=t=>{const{__scopeDropdownMenu:e,children:n,dir:s,open:r,defaultOpen:i,onOpenChange:a,modal:o=!0}=t,l=wn(e),u=m.useRef(null),[d,h]=sj({prop:r,defaultProp:i??!1,onChange:a,caller:jf});return c.jsx(k$,{scope:e,triggerId:Rg(),triggerRef:u,contentId:Rg(),open:d,onOpenChange:h,onOpenToggle:m.useCallback(()=>h(f=>!f),[h]),modal:o,children:c.jsx(o$,{...l,open:d,onOpenChange:h,dir:s,modal:o,children:n})})};vC.displayName=jf;var bC="DropdownMenuTrigger",wC=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...r}=t,i=yC(bC,n),a=wn(n);return c.jsx(l$,{asChild:!0,...a,children:c.jsx(bn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...r,ref:Aa(e,i.triggerRef),onPointerDown:Be(t.onPointerDown,o=>{!s&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Be(t.onKeyDown,o=>{s||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});wC.displayName=bC;var S$="DropdownMenuPortal",_C=t=>{const{__scopeDropdownMenu:e,...n}=t,s=wn(e);return c.jsx(c$,{...s,...n})};_C.displayName=S$;var kC="DropdownMenuContent",SC=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=yC(kC,n),i=wn(n),a=m.useRef(!1);return c.jsx(u$,{id:r.contentId,"aria-labelledby":r.triggerId,...i,...s,ref:e,onCloseAutoFocus:Be(t.onCloseAutoFocus,o=>{var l;a.current||(l=r.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Be(t.onInteractOutside,o=>{const l=o.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;(!r.modal||d)&&(a.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});SC.displayName=kC;var j$="DropdownMenuGroup",C$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(d$,{...r,...s,ref:e})});C$.displayName=j$;var N$="DropdownMenuLabel",jC=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(h$,{...r,...s,ref:e})});jC.displayName=N$;var E$="DropdownMenuItem",CC=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(f$,{...r,...s,ref:e})});CC.displayName=E$;var P$="DropdownMenuCheckboxItem",R$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(p$,{...r,...s,ref:e})});R$.displayName=P$;var A$="DropdownMenuRadioGroup",O$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(m$,{...r,...s,ref:e})});O$.displayName=A$;var T$="DropdownMenuRadioItem",M$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(g$,{...r,...s,ref:e})});M$.displayName=T$;var I$="DropdownMenuItemIndicator",D$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(x$,{...r,...s,ref:e})});D$.displayName=I$;var L$="DropdownMenuSeparator",NC=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(y$,{...r,...s,ref:e})});NC.displayName=L$;var $$="DropdownMenuArrow",F$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(v$,{...r,...s,ref:e})});F$.displayName=$$;var z$="DropdownMenuSubTrigger",B$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(b$,{...r,...s,ref:e})});B$.displayName=z$;var U$="DropdownMenuSubContent",W$=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=wn(n);return c.jsx(w$,{...r,...s,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});W$.displayName=U$;var H$=vC,V$=wC,q$=_C,K$=SC,G$=jC,Y$=CC,Q$=NC;const Cf=H$,Nf=V$,vu=zt.forwardRef(({className:t,sideOffset:e=8,...n},s)=>c.jsx(q$,{children:c.jsx(K$,{ref:s,sideOffset:e,className:ve("z-[90] min-w-[220px] overflow-hidden rounded-2xl p-1","bg-white/75 dark:bg-black/40 backdrop-blur-md shadow-soft2","ring-1 ring-black/5 dark:ring-white/10",t),...n})}));vu.displayName="DropdownMenuContent";const EC=zt.forwardRef(({className:t,...e},n)=>c.jsx(G$,{ref:n,className:ve("px-3 py-2 text-xs text-black/60 dark:text-white/60",t),...e}));EC.displayName="DropdownMenuLabel";const $h=zt.forwardRef(({className:t,...e},n)=>c.jsx(Q$,{ref:n,className:ve("my-1 h-px bg-black/5 dark:bg-white/10",t),...e}));$h.displayName="DropdownMenuSeparator";const Bc=zt.forwardRef(({className:t,inset:e,...n},s)=>c.jsx(Y$,{ref:s,className:ve("relative flex cursor-default select-none items-center gap-2 rounded-xl px-3 py-2 text-sm outline-none","text-black/90 dark:text-white/90","focus:bg-black/5 dark:focus:bg-white/10",e&&"pl-8",t),...n}));Bc.displayName="DropdownMenuItem";function ln({className:t,variant:e="secondary",...n}){return c.jsx(Z,{variant:e,size:"icon",className:ve("rounded-xl h-8 w-8",t),...n})}function Jn({open:t,onClose:e,title:n,children:s,maxWidth:r="520px"}){if(!t)return null;const i=c.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm px-4 py-6 overflow-y-auto",children:c.jsx("div",{className:"w-full",style:{maxWidth:r},children:c.jsxs("div",{className:"rounded-2xl bg-white/90 dark:bg-neutral-900/95 shadow-2xl ring-1 ring-black/10 dark:ring-white/10 max-h-[85vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-black/5 dark:border-white/10",children:[c.jsx("div",{className:"text-sm font-semibold",children:n}),c.jsx("button",{className:"text-black/60 dark:text-white/60 hover:opacity-100 opacity-70",onClick:e,children:""})]}),c.jsx("div",{className:"p-4 overflow-y-auto",children:s})]})})});return typeof document>"u"?i:au.createPortal(i,document.body)}function bu({open:t,onClose:e,onConfirm:n,message:s}){return t?c.jsx(Jn,{open:t,onClose:e,title:"Confirm",maxWidth:"420px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-black/70 dark:text-white/70",children:s||"Are you sure?"}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(Z,{className:"rounded-2xl",onClick:n,children:"Confirm"})]})]})}):null}const PC=m.createContext(null);function Cy(){const t=m.useContext(PC);if(!t)throw new Error("useNotifications must be used inside NotificationsProvider");return t}function X$({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function J$(){const t=cu(),{notifications:e,unreadCount:n,clearAll:s,dismissNotification:r,markRead:i,formatTime:a}=Cy(),[o,l]=m.useState(null),u=m.useMemo(()=>e.slice(0,6),[e]);return c.jsxs(c.Fragment,{children:[c.jsxs(Cf,{children:[c.jsx(Nf,{asChild:!0,children:c.jsxs("button",{className:"relative flex h-9 w-9 items-center justify-center rounded-2xl bg-black/5 dark:bg-white/10 text-black/80 dark:text-white/80 shadow-soft","aria-label":"Notifications",children:[c.jsx(MA,{size:18}),n?c.jsx("span",{className:"absolute -right-1 -top-1 min-w-[18px] rounded-full bg-rose-500 px-1 text-[11px] font-semibold leading-4 text-white",children:n>99?"99+":n}):null]})}),c.jsxs(vu,{align:"end",className:"w-[320px] p-0 bg-white/90 dark:bg-neutral-900/85",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold",children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:e.length?`${e.length} total`:"No alerts"})]}),c.jsx(Z,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:s,disabled:!e.length,children:"Clear all"})]}),c.jsx($h,{}),c.jsx("div",{className:"max-h-[320px] overflow-y-auto p-2 space-y-2",children:u.length?u.map(d=>c.jsx("div",{className:ve("rounded-xl px-3 py-2 ring-1 transition-colors",d.read?"bg-white/50 dark:bg-white/5 ring-black/5 dark:ring-white/10":"bg-black/5 dark:bg-white/10 ring-black/10 dark:ring-white/20"),children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:d.title||"Notification"}),d.message?c.jsx("div",{className:"mt-0.5 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:d.message}):null,d.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:a(d.created_at)}):null]}),c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx(ln,{variant:"ghost",className:"h-7 w-7",onClick:()=>r(d.id),"aria-label":"Dismiss notification",children:c.jsx(sy,{size:14})}),c.jsx(ln,{variant:"ghost",className:"h-7 w-7",onClick:()=>{i(d.id),l(d)},"aria-label":"View notification",children:c.jsx(w1,{size:14})})]})]})},d.id)):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 p-4 text-xs text-black/50 dark:text-white/60 text-center",children:"You're all caught up."})}),c.jsx($h,{}),c.jsx("div",{className:"px-3 py-2",children:c.jsx(Z,{variant:"secondary",className:"w-full rounded-2xl",onClick:()=>t("/app/notifications"),children:"View all notifications"})})]})]}),c.jsx(Jn,{open:!!o,onClose:()=>l(null),title:(o==null?void 0:o.title)||"Notification",maxWidth:"520px",children:c.jsx(X$,{notification:o})})]})}function yt({className:t,...e}){return c.jsx("div",{className:ve("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 shadow-soft",t),...e})}function Z$(){const{toasts:t,dismissToast:e,formatTime:n}=Cy();return t.length?c.jsx("div",{className:"fixed right-6 top-24 z-50 flex w-[320px] flex-col gap-2",children:t.map(s=>{const r=s.notification;return c.jsx(yt,{className:"p-3 bg-white dark:bg-neutral-900 shadow-soft ring-1 ring-black/10 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:r.title||"Notification"}),r.message?c.jsx("div",{className:"mt-1 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:r.message}):null,r.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:n(r.created_at)}):null]}),c.jsx("button",{type:"button",className:"rounded-full p-1 text-black/50 hover:text-black/80 dark:text-white/50 dark:hover:text-white/80",onClick:()=>e(s.id),"aria-label":"Dismiss notification",children:c.jsx(sy,{size:14})})]})},s.id)})}):null}async function eF(){return Oe("/api/modules/accessible",{method:"GET"})}async function tF(){return Oe("/api/sales/chat/history")}async function nF({conversationId:t,message:e,fileIds:n,onEvent:s,onChunk:r,onDone:i,onError:a,signal:o}){try{const l=xf(),u=Oa.API_BASE_URL||"",d=await fetch(`${u}/api/sales/chat/stream`,{method:"POST",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}},body:JSON.stringify({message:e,conversation_id:t,...n!=null&&n.length?{file_ids:n}:{}}),signal:o});if(d.status===401){Eo(),window.dispatchEvent(new CustomEvent("auth:logout")),a==null||a(new Error("Unauthorized"));return}if(!d.ok){const x=await d.json().catch(()=>({}));throw new Error(x.detail||`API error: ${d.status}`)}const h=d.body.getReader(),f=new TextDecoder;let p="",b=!1;for(;;){const{done:x,value:v}=await h.read();if(x)break;p+=f.decode(v,{stream:!0});const y=p.split(`
`);p=y.pop()||"";for(const g of y){const w=g.trim();if(!w.startsWith("data:"))continue;const _=w.replace(/^data:\s?/,"");if(!_||_==="[DONE]"){b=!0,i==null||i();continue}try{const k=JSON.parse(_);s==null||s(k),!s&&r&&(k.type==="chunk"||k.type==="content")&&r(k)}catch{const k={content:_};s==null||s(k),s||r==null||r(k)}}}b||i==null||i()}catch(l){throw a==null||a(l),l}}async function sF(t){const e=new FormData;return e.append("file",t),Oe("/api/sales/files/upload",{method:"POST",body:e})}function rF(t){const e=Oa.API_BASE_URL||"";return t!=null&&t.preview_url?t.preview_url:t!=null&&t.file_url?t.file_url.startsWith("http")?t.file_url:t.file_url.startsWith("/api/files/")?`${e}/api/sales/files/${t.file_url.replace("/api/files/","")}`:`${e}${t.file_url}`:t!=null&&t.url?t.url.startsWith("http")?t.url:`${e}${t.url}`:t!=null&&t.file_id?`${e}/api/sales/files/${t.file_id}/${encodeURIComponent(t.filename||"file")}`:null}async function z0(t,{timeOfDay:e,side:n,venueType:s}={}){const r=new URLSearchParams;e&&r.set("time_of_day",e),n&&r.set("side",n),s&&r.set("venue_type",s);const i=Array.isArray(t)?t[0]:t;return i?Oe(`/api/sales/mockup/templates/${encodeURIComponent(i)}?${r.toString()}`):[]}async function iF(t){return Oe("/api/sales/mockup/save-frame",{method:"POST",body:t})}async function aF(t,e){return Oe(`/api/sales/mockup/photo/${t}?photo_filename=${encodeURIComponent(e)}`,{method:"DELETE"})}async function oF(t){return Z1("/api/sales/mockup/test-preview",{method:"POST",body:t})}async function lF(t){return Oe("/api/sales/mockup/generate",{method:"POST",body:t})}async function cF(){return Oe("/api/sales/mockup/history")}async function RC(t,e,{timeOfDay:n,side:s,company:r}={}){if(!t||!e)return null;const i=new URLSearchParams;i.set("photo_filename",e),n&&i.set("time_of_day",n),s&&i.set("side",s),r&&i.set("company",r);const a=`/api/sales/mockup/photo/${t}?${i.toString()}`;return Z1(a)}async function uF(t,e,{timeOfDay:n,side:s,company:r}={}){const i=await RC(t,e,{timeOfDay:n,side:s,company:r});return i?URL.createObjectURL(i):""}async function dF(){return Oe("/api/sales/mockup/eligibility/setup")}async function hF(){return Oe("/api/sales/mockup/eligibility/generate")}async function AC({service:t,displayType:e}={}){const n=new URLSearchParams;t&&n.set("service",t),e&&n.set("display_type",e);const s=n.toString();return Oe(`/api/sales/locations${s?`?${s}`:""}`)}async function fF(t){return t?Oe(`/api/sales/locations/${encodeURIComponent(t)}`):null}async function pF(t){return Oe("/api/sales/proposals",{method:"POST",body:JSON.stringify(t)})}async function mF(){return Oe("/api/sales/proposals/history")}async function gF({limit:t=100,offset:e=0}={}){return Oe("/api/rbac/users")}async function xF(t){return Oe(`/api/rbac/user/${t}`)}async function yF(t){return Oe(`/api/rbac/users/${t}/permissions`)}async function vF(t){return Oe("/api/admin/users",{method:"POST",body:JSON.stringify(t)})}async function bF(t,e){return Oe(`/api/admin/users/${t}`,{method:"PATCH",body:JSON.stringify(e)})}async function wF(t){return Oe(`/api/rbac/users/${encodeURIComponent(t)}/deactivate`,{method:"POST"})}async function _F(t){return Oe(`/api/rbac/users/${encodeURIComponent(t)}/reactivate`,{method:"POST"})}async function kF(){return Oe("/api/rbac/profiles")}async function SF(t){return Oe("/api/rbac/profiles",{method:"POST",body:JSON.stringify(t)})}async function jF(t,e){return Oe(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function CF(t){return Oe(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"DELETE"})}async function B0(t,e){return Oe(`/api/admin/users/${t}/permissions`,{method:"PUT",body:JSON.stringify({permissions:e})})}async function NF(){return await Oe("/api/rbac/permissions")}async function Dp(t,e){return Oe("/api/dev/permissions/add",{method:"POST",body:JSON.stringify({name:t,description:e})})}async function U0(t){return Oe(`/api/dev/permissions/${encodeURIComponent(t)}`,{method:"DELETE"})}async function EF(){return Oe("/api/dev/companies")}async function PF(t){return Oe("/api/dev/companies/add",{method:"POST",body:JSON.stringify(t)})}async function RF(t,e){return Oe(`/api/admin/company/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function AF(t){return Oe(`/api/dev/companies/${encodeURIComponent(t)}`,{method:"DELETE"})}async function OF(){return Oe("/api/rbac/permission-sets")}async function TF(t){return Oe("/api/rbac/permission-sets",{method:"POST",body:JSON.stringify(t)})}async function MF(t,e){return Oe(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function IF(t){return Oe(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"DELETE"})}const Ny="mmg-notifications",wu="/api/notifications";function DF(t,e){if(!t)return e;try{return JSON.parse(t)}catch{return e}}function xi(){if(typeof window>"u")return[];const t=window.localStorage.getItem(Ny),e=DF(t,[]);return Array.isArray(e)?e:[]}function Ef(t){typeof window>"u"||window.localStorage.setItem(Ny,JSON.stringify(t))}function W0(t){const e=new Date().toISOString();return{id:(t==null?void 0:t.id)||(typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`ntf_${Date.now()}_${Math.random().toString(16).slice(2,8)}`),title:(t==null?void 0:t.title)||"Notification",message:(t==null?void 0:t.message)||"",created_at:(t==null?void 0:t.created_at)||e,read:!!(t!=null&&t.read),level:(t==null?void 0:t.level)||"info",meta:(t==null?void 0:t.meta)||{}}}function LF(t){return Array.isArray(t)?t:Array.isArray(t==null?void 0:t.notifications)?t.notifications:Array.isArray(t==null?void 0:t.data)?t.data:[]}function $F(){return Oe(wu).then(t=>LF(t)).catch(()=>xi())}function FF(t){return Oe(wu,{method:"POST",body:JSON.stringify(t||{})}).then(e=>(e==null?void 0:e.notification)||(e==null?void 0:e.data)||e||W0(t)).catch(()=>{const e=xi(),n=W0(t),s=[n,...e];return Ef(s),n})}function zF(){return Oe(wu,{method:"DELETE"}).then(()=>[]).catch(()=>(Ef([]),[]))}function BF(t){return t?Oe(`${wu}/${encodeURIComponent(t)}`,{method:"DELETE"}).then(()=>xi()).catch(()=>{const e=xi().filter(n=>n.id!==t);return Ef(e),e}):Promise.resolve(xi())}function UF(t){return t?Oe(`${wu}/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify({read:!0})}).then(()=>xi()).catch(()=>{const e=xi().map(n=>n.id===t?{...n,read:!0}:n);return Ef(e),e}):Promise.resolve(xi())}const WF=Ny;function ps(t){if(!t||t==="NA")return null;if(t.includes("T")){const i=new Date(t);if(!Number.isNaN(i.getTime()))return i}const e=t.split(" "),n=e[0],s=e[1],r=n.split("-");if(r.length===3){const i=Number(r[0]),a=Number(r[1])-1,o=Number(r[2]);if(Number.isNaN(i)||Number.isNaN(a)||Number.isNaN(o))return null;if(s){const u=s.split(":"),d=Number(u[0]||0),h=Number(u[1]||0),f=Number(u[2]||0),p=new Date(o,a,i,d,h,f);return Number.isNaN(p.getTime())?null:p}const l=new Date(o,a,i);return l.setHours(0,0,0,0),Number.isNaN(l.getTime())?null:l}return null}function OC(t){var n;if(!((n=t==null?void 0:t.lifecycle)!=null&&n.length))return"";const e=t.lifecycle[t.lifecycle.length-1];return((e==null?void 0:e.stage)||"").toLowerCase()}function TC(t){const e={};return t.forEach(n=>{const s=n.videographer||n.Videographer||"Unassigned";e[s]||(e[s]=[]),e[s].push(n)}),e}function Hr(t){const e={pending:0,rejected:0,returned:0,submitted:0,accepted:0};return t.forEach(n=>{(n.versions||[]).forEach(s=>{const r=OC(s);r==="pending"||r==="critique"?e.pending+=1:r==="rejected"||r==="editing"?e.rejected+=1:r==="returned"?e.returned+=1:r==="submitted"||r==="submitted to sales"?e.submitted+=1:(r==="accepted"||r==="done")&&(e.accepted+=1)})}),e}function MC(t){const e=t.length,n=t.filter(o=>{const l=o.videographer||o.Videographer||"Unassigned";return l&&l!=="Unassigned"&&o.status!=="Not assigned yet"}).length;let s=0;t.forEach(o=>{s+=(o.versions||[]).length});const r=Hr(t),i=r.accepted+r.submitted+r.rejected+r.returned,a=i>0?Math.round((r.accepted+r.submitted)/i*100):0;return{total:e,assigned:n,uploads:s,pending:r.pending,rejected:r.rejected,returned:r.returned,submitted_to_sales:r.submitted,accepted_videos:r.accepted,accepted_pct:a}}function IC(t){const e=t.filter(n=>n.status==="Accepted"||n.status==="Done").length;return{completed:e,not_completed:t.length-e}}function HF(t){let e=0,n=0,s=0,r=0,i=0;t.forEach(d=>{(d.versions||[]).forEach(h=>{const f=h.lifecycle||[];if(f.length<2)return;let p=null;for(const y of f){const g=(y.stage||"").toLowerCase();if(g==="pending"||g==="critique"){p=ps(y.at);break}}let b=null,x=null;for(const y of f){const g=(y.stage||"").toLowerCase();if(g==="rejected"||g==="editing"||g==="accepted"||g==="submitted"||g==="submitted to sales"){b=ps(y.at),x=g;break}}if(!p||!b||!x)return;s+=1;const v=Math.round((b-p)/(1e3*60*60));if(e+=v,n+=1,x==="accepted"||x==="submitted"||x==="submitted to sales"){let y=!1,g=!1;f.forEach(w=>{const _=(w.stage||"").toLowerCase();(_==="accepted"||_==="done")&&(y=!0),_==="returned"&&(g=!0)}),y&&(r+=1),g&&(i+=1)}})});const a=n>0?Math.round(e/n):0,o=a>0?`${a} hrs`:"0 hrs",l=r+i,u=l>0?Math.round(r/l*100):0;return{avg_response_display:o,handled:s,accepted:r,handled_percent:u}}function DC(t){const e=TC(t),n={},s=new Date;return s.setHours(0,0,0,0),Object.entries(e).forEach(([r,i])=>{let a=0,o=0,l=0,u=0;i.forEach(p=>{(p.status==="Accepted"||p.status==="Done")&&(a+=1),o+=(p.versions||[]).length;const b=ps(p.filming_deadline||p.filming_date||"");b&&b<=s&&(u+=1);const x=ps(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(l+=1)});const d=Hr(i),h=d.accepted+d.submitted+d.rejected+d.returned,f=h>0?Math.round((d.accepted+d.submitted)/h*100):0;n[r]={total:i.length,started:u,late:l,completed:a,uploads:o,accepted_pct:f}}),n}function Uc(t,e){const n=[];return t.forEach(s=>{(s.versions||[]).forEach(r=>{const i=OC(r);(i==="submitted to sales"?"submitted":i)===e&&n.push({task:s,version:r,stage:i})})}),n}function Lp(t,e){const n=[];return t.forEach(s=>{const r=[];(s.versions||[]).forEach(i=>{(i.lifecycle||[]).forEach(a=>{const o=(a.stage||"").toLowerCase();(e==="hod"&&(o==="rejected"||o==="editing")||e==="hos"&&o==="returned")&&r.push({version:i.version,event:a,stage:o})})}),r.length&&n.push({...s,rejectionEvents:r,rejectionCount:r.length})}),n}function LC(t){const e=Uc(t,"pending"),n=[];return e.forEach(({task:s,version:r})=>{let i=null;(r.lifecycle||[]).forEach(o=>{const l=(o.stage||"").toLowerCase();(l==="pending"||l==="critique")&&(i=ps(o.at))});const a=i?Math.round((Date.now()-i.getTime())/(1e3*60*60)):null;n.push({task:s,version:r,uploadTime:i,waitingHours:a})}),{count:n.length,reviews:n}}function $C(t){const e=[];return t.forEach(n=>{(n.versions||[]).forEach(s=>{let r=null,i=null,a=null,o=null,l=null;if((s.lifecycle||[]).forEach(u=>{const d=(u.stage||"").toLowerCase();!r&&(d==="pending"||d==="critique")&&(r=ps(u.at)),!i&&(d==="rejected"||d==="editing"||d==="accepted"||d==="submitted"||d==="submitted to sales")&&(i=ps(u.at),a=d,o=u.rejection_class||null,l=u.rejection_comments||null)}),r&&i&&a){const u=Math.round((i-r)/36e5);e.push({task:n,version:s,responseHours:u,uploadTime:r,reviewTime:i,decision:a,rejectionClass:o,comments:l})}})}),e}function FC(t){const e=MC(t),n=IC(t),s=new Date;s.setHours(0,0,0,0);let r=0,i=0,a=0,o=0,l=0,u=0;t.forEach(p=>{const b=ps(p.filming_deadline||p.filming_date||"");b&&b<=s&&(r+=1);const x=ps(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(i+=1),(p.status==="Accepted"||p.status==="Done")&&(o+=1,a+=(p.versions||[]).length),(p.versions||[]).forEach(v=>{(v.lifecycle||[]).forEach(y=>{const g=(y.stage||"").toLowerCase();(g==="rejected"||g==="editing")&&(l+=1),g==="returned"&&(u+=1)})})});const d=o>0?(a/o).toFixed(2):"0",h=Uc(t,"pending"),f=Uc(t,"submitted");return{summary:e,pie:n,tasksStarted:r,lateTasks:i,pendingHOD:h.length,pendingHOS:f.length,rejectionsByHOD:l,rejectionsByHOS:u,uploadRatio:d}}function $p(t){const e=ps(t.submission_date||"");if(!e)return!1;const n=new Date;return n.setHours(0,0,0,0),e<n&&t.status!=="Accepted"&&t.status!=="Done"}const Ls=[{task_number:2217,brand:"City Brand Launch",filming_deadline:"17-02-2025",submission_date:"20-02-2025",status:"Critique",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"18-02-2025 10:00:00"}]}]},{task_number:2216,brand:"Mall LED Loop",filming_deadline:"16-02-2025",submission_date:"19-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"17-02-2025 09:00:00"},{stage:"submitted to sales",at:"18-02-2025 11:30:00"}]}]},{task_number:2215,brand:"Festival Teaser",filming_deadline:"15-02-2025",submission_date:"18-02-2025",status:"Returned",videographer:"Alyssa Reed",location:"Abu Dhabi",versions:[{version:1,lifecycle:[{stage:"pending",at:"15-02-2025 10:00:00"},{stage:"submitted",at:"16-02-2025 12:00:00"},{stage:"returned",at:"17-02-2025 15:30:00",rejection_class:"Lighting",rejection_comments:"Exposure too dark",rejected_by:"Head of Sales"}]}]},{task_number:2214,brand:"Luxury Auto Montage",filming_deadline:"14-02-2025",submission_date:"17-02-2025",status:"Editing",videographer:"Noah Chen",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"14-02-2025 09:30:00"},{stage:"rejected",at:"15-02-2025 12:10:00",rejection_class:"Artwork Color",rejection_comments:"Incorrect color profile",rejected_by:"Reviewer"}]}]},{task_number:2213,brand:"Airport Arrival Hero",filming_deadline:"12-02-2025",submission_date:"15-02-2025",status:"Accepted",videographer:"Noah Chen",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"12-02-2025 10:00:00"},{stage:"submitted to sales",at:"13-02-2025 15:00:00"},{stage:"accepted",at:"14-02-2025 12:00:00"}]}]},{task_number:2212,brand:"Retail Weekend Promo",filming_deadline:"10-02-2025",submission_date:"13-02-2025",status:"Done",videographer:"Ravi Sharma",location:"Ajman",versions:[{version:1,lifecycle:[{stage:"pending",at:"10-02-2025 10:00:00"},{stage:"submitted",at:"11-02-2025 14:00:00"},{stage:"done",at:"12-02-2025 10:00:00"}]}]},{task_number:2211,brand:"Harbor Night Loop",filming_deadline:"18-02-2025",submission_date:"21-02-2025",status:"Editing",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"16-02-2025 11:00:00"},{stage:"editing",at:"17-02-2025 13:00:00",rejection_class:"Environment Too Dark",rejection_comments:"Please brighten the surrounding scene",rejected_by:"Reviewer"}]}]},{task_number:2210,brand:"City Center Countdown",filming_deadline:"22-02-2025",submission_date:"25-02-2025",status:"Assigned to Alyssa",videographer:"Alyssa Reed",location:"Dubai",versions:[]},{task_number:2209,brand:"Expo Walkthrough",filming_deadline:"24-02-2025",submission_date:"27-02-2025",status:"Not assigned yet",videographer:"Unassigned",location:"Abu Dhabi",versions:[]},{task_number:2208,brand:"Weekend Highlights",filming_deadline:"13-02-2025",submission_date:"16-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"13-02-2025 09:00:00"},{stage:"rejected",at:"14-02-2025 10:30:00",rejection_class:"Lighting",rejection_comments:"Flicker in the panel",rejected_by:"Reviewer"}]},{version:2,lifecycle:[{stage:"pending",at:"15-02-2025 12:15:00"},{stage:"submitted",at:"16-02-2025 14:40:00"}]}]}],VF={session_id:"vc-session-01",messages:[{id:"vc-msg-1",role:"assistant",content:"Good morning. Upload a cut or describe the request, and I will log the critique, checklist, and next steps.",timestamp:"2025-02-18T08:40:12+04:00"}],message_count:1,last_updated:"2025-02-18T08:40:12+04:00"},qF=[{workflow_id:"workflow-2217",task_number:2217,folder_name:"City Brand Launch",status:"pending_reviewer",created_at:"2025-02-18T09:10:00+04:00",reviewer_approved:!1,hos_approved:!1}];function Ts(t){return new Promise(e=>setTimeout(e,t))}function KF(t,e){const n=[];let s=0;for(;s<t.length;)n.push(t.slice(s,s+e)),s+=e;return n}function Ey(t,e){const n=(t||"").trim();return[`${n?`Thanks for the details on "${n}".`:"Thanks for the upload."} ${e?"I reviewed the file and captured the critique highlights below:":"Here is a quick critique outline to confirm before I log the request:"}`,"","- Narrative clarity: tighten the opening 3 seconds.","- Visual hierarchy: spotlight the primary CTA earlier.","- Audio mix: reduce music by about 3dB under VO.","- Export: keep 1080x1920, 29.97fps.","","Reply with any edits or confirm if I should submit to the reviewer."].join(`
`)}function GF(t){return[{action_id:"approve_reviewer",label:"Approve",workflow_id:t,variant:"secondary"},{action_id:"reject_reviewer",label:"Reject",workflow_id:t,variant:"ghost"}]}function YF(t){let e=!1;return t&&(t.aborted?e=!0:t.addEventListener("abort",()=>{e=!0},{once:!0})),()=>e}function QF(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function XF(){const t=MC(Ls),e=IC(Ls),n=HF(Ls),s=DC(Ls),r=TC(Ls),i=FC(Ls),a=Hr(Ls),o=LC(Ls),l=$C(Ls);return{mode:"month",period:"2025-02",tasks:Ls,summary:t,pie:e,reviewer:n,summary_videographers:s,videographers:r,quick_stats:i,status_counts:a,pending_reviews:o,response_times:l}}async function JF({mode:t,period:e}={}){return await Ts(240),{...XF(),mode:t||"month",period:e||"2025-02"}}async function ZF(){return await Ts(200),VF}async function e3({file:t,message:e,sessionId:n}){await Ts(200);const s=n||`vc-session-${Date.now()}`,r=`vc-file-${Date.now()}`;return QF(t)?{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",type:"video",message:"Video received. Which task number is this for?",session_id:s}:{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",file_url:URL.createObjectURL(t),type:"image",response:Ey(e,!0),session_id:s,timestamp:new Date().toISOString()}}async function t3({file:t}){return await Ts(200),{file_id:`vc-asset-${Date.now()}`,filename:(t==null?void 0:t.name)||"attachment",file_url:URL.createObjectURL(t)}}async function n3({file:t,taskNumber:e}){return await Ts(260),{success:!0,file_id:`vc-video-${Date.now()}`,workflow_id:`workflow-${Date.now()}`,version:1,message:`Video uploaded successfully (v1) for task #${e}`}}async function s3({command:t,args:e,sessionId:n}){await Ts(200);const s=n||`vc-session-${Date.now()}`,r=(t||"").toLowerCase(),i=(e||"").trim();return r?r==="help"?{success:!0,command:r,response:`**Video Critique Commands**

- /log or /design - Start a new design request
- /recent - Export recent task data
- /edit <task_number> - Edit an existing task
- /delete <task_number> - Delete a task

You can also paste briefs or upload images/videos.`,session_id:s}:r==="log"||r==="design"?{success:!0,command:r,response:Ey(i||"I want to log a design request",!1),session_id:s}:r==="edit"?{success:!0,command:r,response:i?"Editing task "+i+". Which fields should I update?":"Please provide a task number: /edit <task_number>",session_id:s}:r==="delete"?{success:!0,command:r,response:i?"Delete request queued for task "+i+". Confirm to proceed.":"Please provide a task number: /delete <task_number>",session_id:s}:r==="recent"?{success:!0,command:r,response:"Preparing the latest export. I will send the download link shortly.",session_id:s}:{success:!1,command:r,error:"Unknown command: /"+r+". Use /help for available commands.",session_id:s}:{success:!1,command:"",error:"Unknown command: /. Use /help for available commands.",session_id:s}}async function r3({actionId:t,workflowId:e}){return await Ts(200),t==="reject_reviewer"||t==="return_hos"?{success:!0,message:"Please provide rejection details.",requires_form:!0,form_type:t==="return_hos"?"return":"rejection",workflow_id:e}:{success:!0,message:`Action ${t} applied for ${e}.`}}async function i3({formType:t,workflowId:e}){return await Ts(200),{success:!0,message:`${t} submitted for ${e}.`}}async function a3(t){return await Ts(120),t==="return"?{title:"Return for Revision",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be revised..."}]}:{title:"Reject Video",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be fixed..."}]}}function o3(t){return t!=null&&t.preview_url?t.preview_url:t!=null&&t.file_url?t.file_url:t!=null&&t.url?t.url:null}async function l3({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:a}){const o=YF(a);try{const l=t||`vc-session-${Date.now()}`;if(o()||(await Ts(180),o()))return;const u=Ey(e,!1),d=KF(u,48);for(const h of d){if(o())return;s==null||s({type:"delta",content:h}),await Ts(90)}if(o())return;s==null||s({type:"text_done",content:u}),n!=null&&n.length&&(s==null||s({type:"files",files:n.map((h,f)=>({file_id:h,filename:f===0?"Brief.pdf":`Attachment-${f+1}.pdf`,file_url:`https://example.com/mock-${h}.pdf`}))})),(e||"").toLowerCase().includes("approval")&&(s==null||s({type:"actions",actions:GF(qF[0].workflow_id)})),s==null||s({type:"done",session_id:l}),r==null||r()}catch(l){throw s==null||s({type:"error",message:(l==null?void 0:l.message)||"Stream failed"}),i==null||i(l),l}}async function c3(t){return JF(t)}async function u3(){return ZF()}async function d3({file:t,message:e,sessionId:n}){return e3({file:t,message:e,sessionId:n})}async function h3({file:t}){return t3({file:t})}async function H0({file:t,taskNumber:e}){return n3({file:t,taskNumber:e})}async function f3({command:t,args:e,sessionId:n}){return s3({command:t,args:e,sessionId:n})}async function p3({actionId:t,workflowId:e}){return r3({actionId:t,workflowId:e})}async function m3({formType:t,workflowId:e,category:n,reason:s}){return i3({formType:t,workflowId:e})}async function g3(t){return a3(t)}function x3(t){return o3(t)}async function y3({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:a}){return l3({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:a})}const v3={chat:{to:"/app/chat",label:"AI Chat Assistant",icon:FA},video_critique:{to:"/app/video-critique",label:"Video Critique",icon:Hd},mockup:{to:"/app/mockup",label:"Mockup Assistant",icon:LA},proposals:{to:"/app/proposals",label:"Proposal Assistant",icon:UA},admin:{to:"/app/admin",label:"Admin",icon:HA},asset_management:{to:"/app/asset-management",label:"Asset Management",icon:BA},settings:{to:"/app/settings",label:"Settings",icon:S1}},b3=["chat","mockup","proposals","video_critique","admin","asset_management","settings"];function w3(t){return t.includes("/app/video-critique")?"Video Critique":t.includes("/app/chat")?"AI Chat Assistant":t.includes("/app/mockup")?"Mockup Assistant":t.includes("/app/proposals")?"Proposal Assistant":t.includes("/app/notifications")?"Notifications":t.includes("/app/admin")?"Admin Panel":t.includes("/app/asset-management")?"Asset Management":t.includes("/app/settings")?"Settings":"Workspace"}function _3(t){const e=[{name:"sales",tools:["chat","video_critique","mockup","proposals"],sort_order:1}];return hu(t)&&e.push({name:"core",tools:["admin"],sort_order:100}),e}function k3(t,e){var o;const s=[...((o=t==null?void 0:t.modules)!=null&&o.length?t.modules:_3(e))||[]].sort((l,u)=>(l.sort_order||0)-(u.sort_order||0)),r=new Set;s.forEach(l=>{(l.tools||[]).forEach(u=>{r.add(u==="ai_costs"?"costs":u)})}),r.has("chat")&&r.add("video_critique"),hu(e)&&(r.add("admin"),r.add("asset_management")),r.add("settings");const i=[],a=new Set;return b3.forEach(l=>{if(!r.has(l))return;const u=v3[l];u&&!a.has(u.to)&&(a.add(u.to),i.push(u))}),i}function S3(){const{user:t,logout:e}=jr(),n=ll(),s=cu(),[r,i]=m.useState(!1),[a,o]=m.useState(!1),l=on({queryKey:["modules","accessible"],queryFn:eF}),u=m.useMemo(()=>((t==null?void 0:t.name)||"User").split(" ").slice(0,2).map(f=>f[0]).join("").toUpperCase(),[t]),d=m.useMemo(()=>k3(l.data,t),[l.data,t]);return c.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[c.jsx("header",{className:"sticky top-0 z-40",children:c.jsx("div",{className:"w-full px-6 lg:px-10",children:c.jsx("div",{className:"mmg-header-card mt-4 rounded-2xl bg-white/65 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 gap-3",children:[c.jsxs("div",{className:"flex items-end gap-3",children:[c.jsx(T1,{size:64}),c.jsx("div",{className:"hidden sm:block text-sm leading-none text-black/50 dark:text-white/60 relative -top-px",children:"|"}),c.jsx("div",{className:"hidden sm:block text-sm font-medium leading-none text-black/70 dark:text-white/70",children:w3(n.pathname)})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-2xl lg:hidden",onClick:()=>o(!0),title:"Open sidebar","aria-label":"Open sidebar",children:c.jsx(fp,{size:18})}),c.jsx(J$,{}),c.jsx(nj,{}),c.jsxs(Cf,{children:[c.jsx(Nf,{asChild:!0,children:c.jsxs("button",{className:"flex items-center gap-2 rounded-2xl px-2.5 py-1.5 hover:bg-black/5 dark:hover:bg-white/10 transition-colors","aria-label":"User menu",children:[c.jsx("div",{className:"h-9 w-9 rounded-2xl bg-black/5 dark:bg-white/10 flex items-center justify-center shadow-soft",children:c.jsx("span",{className:"text-xs font-semibold",children:u})}),c.jsxs("div",{className:"hidden sm:flex flex-col items-start leading-tight",children:[c.jsx("span",{className:"mmg-brand-gold text-sm font-medium",children:t==null?void 0:t.name}),c.jsx("span",{className:"text-xs text-black/50 dark:text-white/60",children:t==null?void 0:t.email})]})]})}),c.jsxs(vu,{align:"end",children:[c.jsx(EC,{children:c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("span",{className:"truncate",children:t==null?void 0:t.email}),c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:((t==null?void 0:t.roles)||[]).join(" | ")})]})}),c.jsx($h,{}),c.jsxs(Bc,{onSelect:()=>s("/app/settings"),children:[c.jsx(S1,{size:16}),"Settings"]}),c.jsxs(Bc,{onSelect:()=>{e(),s("/")},children:[c.jsx($A,{size:16}),"Logout"]})]})]})]})]})})})}),c.jsx(Z$,{}),c.jsx("div",{className:"w-full px-6 lg:px-10 pb-4 flex-1 flex overflow-hidden min-w-0",children:c.jsxs("div",{className:ve("mt-4 grid grid-cols-1 gap-4 lg:grid-cols-[280px_1fr] flex-1 min-h-0 min-w-0","transition-[grid-template-columns] duration-500",r&&"lg:grid-cols-[64px_1fr] 2xl:grid-cols-[72px_1fr]"),children:[c.jsxs("aside",{className:ve("hidden lg:block rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10","overflow-hidden"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:ve("text-s ms-3 font-semibold tracking-wide text-black/50 dark:text-white/60",r&&"hidden lg:block lg:sr-only"),children:"Tools"}),c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>i(h=>!h),title:"Toggle sidebar","aria-label":"Toggle sidebar",children:c.jsx(fp,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-2",children:d.map(h=>{const f=n.pathname===h.to||n.pathname.startsWith(`${h.to}/`),p=h.icon;return c.jsxs("button",{onClick:()=>s(h.to),className:ve("mmg-nav-btn w-full flex items-center gap-3 rounded-2xl p-2 text-sm transition-colors mb-1.5 shadow-soft",f?"mmg-nav-btn-active":"","text-base",r&&"lg:justify-center lg:gap-0"),children:[c.jsx("span",{className:"mmg-nav-icon h-8 w-8 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(p,{size:22})}),c.jsx("span",{className:ve("min-w-0 truncate",r&&"hidden"),children:h.label})]},h.to)})}),c.jsx("div",{className:"px-3 pb-3 pt-1",children:c.jsx("div",{className:ve("h-px bg-black/5 dark:bg-white/10",r&&"lg:mx-auto lg:w-10")})})]}),c.jsx("main",{className:"min-h-0 min-w-0 h-full",children:c.jsx(BR,{})})]})}),c.jsxs("div",{className:ve("fixed inset-0 z-50 lg:hidden",a?"pointer-events-auto":"pointer-events-none"),children:[c.jsx("div",{className:ve("absolute inset-0 bg-black/40 transition-opacity",a?"opacity-100":"opacity-0"),onClick:()=>o(!1)}),c.jsxs("aside",{className:ve("absolute inset-y-0 left-0 w-72 max-w-full rounded-r-2xl bg-white/90 dark:bg-neutral-900/95","backdrop-blur-xl shadow-2xl ring-1 ring-black/10 dark:ring-white/10","transition-transform duration-200",a?"translate-x-0":"-translate-x-full"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:"text-sm font-semibold tracking-wide text-black/60 dark:text-white/70",children:"Tools"}),c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>o(!1),title:"Close sidebar","aria-label":"Close sidebar",children:c.jsx(fp,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-3",children:d.map(h=>{const f=n.pathname===h.to||n.pathname.startsWith(`${h.to}/`),p=h.icon;return c.jsxs("button",{onClick:()=>{s(h.to),o(!1)},className:ve("mmg-nav-btn w-full flex items-center gap-2.5 rounded-2xl p-2.5 text-sm transition-colors mb-1.5 shadow-soft",f?"mmg-nav-btn-active":"","text-sm"),children:[c.jsx("span",{className:"mmg-nav-icon h-9 w-9 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(p,{size:20})}),c.jsx("span",{className:"min-w-0 truncate",children:h.label})]},h.to)})})]})]})]})}function j3(){const[t,e]=m.useState(null),[n,s]=m.useState([]),[r,i]=m.useState(""),[a,o]=m.useState(null),[l,u]=m.useState(!1),[d,h]=m.useState(!1),f=m.useRef(null),p=m.useRef(null),b=m.useRef(null),x=m.useRef(null),v=m.useRef(!0),y=on({queryKey:["chat","history"],queryFn:tF,enabled:!0}),g=m.useMemo(()=>(r.trim().length>0||!!a)&&!l,[r,a,l]);m.useEffect(()=>{var S;if(d||y.isLoading)return;const k=y.data;if(k&&((S=k.messages)!=null&&S.length||k.session_id||k.conversation_id)){e(k.session_id||k.conversation_id||null);const j=(k.messages||[]).map(P3);s(j.length?j:[V0()])}else s([V0()]);h(!0)},[y.data,y.isLoading,d]),m.useEffect(()=>{const k=p.current;if(!k)return;const S=()=>{const N=k.scrollHeight-k.scrollTop-k.clientHeight<=120;v.current=N};return S(),k.addEventListener("scroll",S,{passive:!0}),()=>k.removeEventListener("scroll",S)},[]);const w=zt.useCallback((k="smooth",S=!1)=>{var j;!S&&!v.current||(j=b.current)==null||j.scrollIntoView({behavior:k,block:"end"})},[]);m.useEffect(()=>{const k=l?"auto":"smooth";requestAnimationFrame(()=>w(k))},[n,l,w]),m.useEffect(()=>{d&&requestAnimationFrame(()=>w("auto",!0))},[d,w]),m.useEffect(()=>()=>{var k,S;return(S=(k=x.current)==null?void 0:k.abort)==null?void 0:S.call(k)},[]);async function _(){var M,I;if(!g)return;const k=r.trim(),S=k||(a?`Please process this file: ${a.name}`:""),j=crypto.randomUUID(),N=a?[{file_id:`local-${Date.now()}`,filename:a.name,preview_url:URL.createObjectURL(a)}]:[],T={id:j,role:"user",content:k,files:N,status:null},A=crypto.randomUUID(),z={id:A,role:"assistant",content:"",files:[],status:"Thinking..."};s(H=>[...H,T,z]),i(""),o(null),v.current=!0,requestAnimationFrame(()=>w("auto",!0));try{u(!0),(I=(M=x.current)==null?void 0:M.abort)==null||I.call(M);const H=new AbortController;x.current=H;let L=[],D="",G=null,E=!1;if(a){const C=await sF(a);if(!(C!=null&&C.file_id))throw new Error("Upload failed");L=[C.file_id];const F={file_id:C.file_id,filename:a.name,file_url:C.file_url||C.url||""};s(K=>K.map(U=>{var ie,V,O,q;return U.id===j?{...U,files:[{...F,preview_url:((V=(ie=U.files)==null?void 0:ie[0])==null?void 0:V.preview_url)||((q=(O=U.files)==null?void 0:O[0])==null?void 0:q.url)||""}]}:U}))}await nF({conversationId:t,message:S,fileIds:L,signal:H.signal,onEvent:C=>{var U,ie;const F=((U=C==null?void 0:C.result)==null?void 0:U.pdf_filename)||(C==null?void 0:C.pdf_filename),K=V=>!V||!F||V.pdf_filename?V:{...V,pdf_filename:F};if(F&&s(V=>V.map(O=>O.id===A&&!O.pdf_filename?{...O,pdf_filename:F}:O)),C!=null&&C.conversation_id&&e(V=>V||C.conversation_id),C!=null&&C.error){s(V=>V.map(O=>O.id===A?{...O,status:null,content:`Error: ${C.error}`}:O));return}if((C==null?void 0:C.type)==="status"){s(V=>V.map(O=>O.id===A?{...O,status:C.content||"Processing..."}:O)),C.message_id&&(G=C.message_id);return}if((C==null?void 0:C.type)==="delete"){C.message_id&&C.message_id===G&&(D="",G=null,s(V=>V.map(O=>O.id===A?{...O,status:"Thinking...",content:""}:O)));return}if((C==null?void 0:C.type)==="tool_call"){const V=((ie=C.tool)==null?void 0:ie.name)||"processing";s(O=>O.map(q=>q.id===A?{...q,status:`Processing ${V}...`}:q));return}if(((C==null?void 0:C.type)==="chunk"||(C==null?void 0:C.type)==="content")&&C.content){C.message_id&&C.message_id!==G&&(G=C.message_id),D=C.type==="content"?C.content:D+C.content,s(V=>V.map(O=>O.id===A?{...O,status:null,content:D}:O));return}if(C!=null&&C.content&&!C.type){D+=C.content,s(V=>V.map(O=>O.id===A?{...O,status:null,content:D}:O));return}if((C==null?void 0:C.type)==="files"&&C.files){if(E=!0,s(V=>V.map(O=>O.id===A?{...O,files:[...O.files||[],...C.files.map(K)]}:O)),!D){const V=C.files.find(O=>O.comment);V!=null&&V.comment&&(D=V.comment,s(O=>O.map(q=>q.id===A?{...q,status:null,content:D}:q)))}return}if((C==null?void 0:C.type)==="file"&&(C.file||C.url)){const V=K(C.file||C);E=!0,s(O=>O.map(q=>q.id===A?{...q,files:[...q.files||[],V]}:q)),!D&&V.comment&&(D=V.comment,s(O=>O.map(q=>q.id===A?{...q,status:null,content:D}:q)));return}if(C!=null&&C.files){E=!0,s(V=>V.map(O=>O.id===A?{...O,files:[...O.files||[],...C.files.map(K)]}:O));return}typeof C=="string"&&C.trim()&&(D+=C,s(V=>V.map(O=>O.id===A?{...O,status:null,content:D}:O)))},onDone:()=>{!D&&!E&&s(C=>C.map(F=>F.id===A?{...F,status:null,content:"I'm ready to help. What would you like to do?"}:F))}})}catch(H){s(L=>L.map(D=>D.id===A?{...D,status:null,content:(H==null?void 0:H.message)||"Failed to get response"}:D))}finally{u(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(lt,{className:"p-4 overflow-hidden flex-1 min-h-0",children:c.jsx("div",{ref:p,className:"h-full overflow-y-auto px-2",children:c.jsxs("div",{className:"space-y-3",children:[!d&&y.isLoading?c.jsx(De,{text:"Loading conversation",className:"text-sm text-black/60 dark:text-white/65"}):null,n.map(k=>c.jsx(C3,{msg:k,onMediaLoad:()=>w("auto")},k.id)),c.jsx("div",{ref:b})]})})}),c.jsxs(lt,{className:"p-3",children:[a?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:a.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>o(null),children:""})]}):null,c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:f,type:"file",className:"hidden",onChange:k=>{var S;return o(((S=k.target.files)==null?void 0:S[0])||null)},accept:"image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var k;return(k=f.current)==null?void 0:k.click()},children:c.jsx(_1,{size:18})}),c.jsx(N3,{value:r,onChange:i,placeholder:"Type your message...",onEnter:_}),c.jsx(Z,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!g,onClick:_,children:c.jsx(k1,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"AI can make mistakes. Verify important information."})]})]})}function C3({msg:t,onMediaLoad:e}){var l;const n=t.role==="user",s=m.useMemo(()=>I3(t.content||""),[t.content]),r=m.useMemo(()=>Lg(t.status||""),[t.status]),i=m.useMemo(()=>!t.status&&R3(t.content||""),[t.status,t.content]),a=m.useMemo(()=>Lg(t.content||""),[t.content]),o=m.useRef(new Map);return c.jsx("div",{className:n?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",n?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[t.status||i?c.jsx(E3,{text:r||a}):c.jsx("div",{dangerouslySetInnerHTML:{__html:s}}),(l=t.files)!=null&&l.length?c.jsx("div",{className:"mt-2 space-y-1",children:t.files.map((u,d)=>{const h=rF(u);if(!h)return null;const f=u.pdf_filename||t.pdf_filename,p=T3(f?{...u}:u,h,o.current),b=Hl(p),x=["jpg","jpeg","png","gif","webp","bmp"].includes(b),v=!n,y=b==="pdf";return x?c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:v?c.jsxs(c.Fragment,{children:[c.jsx("a",{href:h,target:"_blank",rel:"noopener noreferrer",className:"block overflow-hidden rounded-lg",children:c.jsx("img",{src:h,alt:p,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:h,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(_i,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(Z,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:g=>{g.preventDefault(),cd(h,p)},onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),cd(h,p))},className:"inline-flex items-center",children:[c.jsx(Sa,{size:14,className:"mr-1"}),"Download"]})})]})]}):c.jsx("div",{className:"overflow-hidden rounded-lg",children:c.jsx("img",{src:h,alt:p,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})})},u.file_id||h||d):c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:y?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(ny,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:b?b.toUpperCase():"FILE"})}),v?c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:p}):null]}),v?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:h,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(_i,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(Z,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:g=>{g.preventDefault(),cd(h,p)},onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),cd(h,p))},className:"inline-flex items-center",children:[c.jsx(Sa,{size:14,className:"mr-1"}),"Download"]})})]}):null]})},u.file_id||h||d)})}):null]})})}function N3({value:t,onChange:e,placeholder:n,onEnter:s,disabled:r}){const i=m.useRef(null);m.useEffect(()=>{const o=i.current;if(!o)return;o.style.height="0px";const u=22*5+16;o.style.height=Math.min(o.scrollHeight,u)+"px"},[t]);function a(o){o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),s==null||s())}return c.jsx("textarea",{ref:i,rows:1,value:t,disabled:r,onChange:o=>e(o.target.value),onKeyDown:a,placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function E3({text:t}){return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:t||"Thinking"}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function P3(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||t.sender||"assistant",content:t.content||t.message||"",files:t.files||t.attachments||[],status:null}}function Lg(t){return t?String(t).replace(/[]/g,"").replace(/[_*`]/g,"").replace(/\.+$/,"").replace(/\s+/g," ").trim():""}function R3(t){const e=Lg(t);return e?!!(e==="Thinking"||e.startsWith("Processing")||e.startsWith("Building Proposal")):!1}function Hl(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length<=1?"":n.pop().toLowerCase()}function A3(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function O3(t){if(!t)return!0;const e=t.trim().toLowerCase();if(!e||e==="file"||e==="download")return!0;const n=e.replace(/\.[^.]+$/,"");return!!(n==="tmp"||n==="temp"||/^[a-f0-9-]{16,}$/.test(n)||/^file[-_]?\d+$/.test(n)||/^(tmp|temp)/.test(n)||/^upload[-_]?.+$/.test(n))}function T3(t,e,n){const s=(t==null?void 0:t.filename)||"",r=s||(t==null?void 0:t.filename)||(t==null?void 0:t.title)||"",i=A3(e);t!=null&&t.file_id||t!=null&&t.id;let a=r||i||"";const o=Hl(a)||Hl(i)||Hl(e);if(s){const l=Hl(a)||"pdf";return a.toLowerCase().endsWith(`.${l}`)||(a=`${a}.${l}`),a}return O3(a)?o==="pdf"?a="Proposal.pdf":o?a=`Attachment.${o}`:a="Attachment":o&&!a.toLowerCase().endsWith(`.${o}`)&&(a=`${a}.${o}`),a||(o?`Attachment.${o}`:"Attachment")}async function cd(t,e){try{const n=xf(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=e,document.body.appendChild(a),a.click(),a.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{const n=document.createElement("a");n.href=t,n.download=e,n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),n.remove()}}function V0(){return{id:crypto.randomUUID(),role:"assistant",content:`Good ${M3()}, how can I help?`,files:[],status:null}}function M3(){const t=new Date().getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function $g(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function El(t){return t?$g(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">[Image: $1]</a>').replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/___(.+?)___/g,"<strong><em>$1</em></strong>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(?!INLINE_CODE_|CODE_BLOCK_)(.+?)__/g,"<strong>$1</strong>").replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>").replace(new RegExp("(?<!\\w)_(?!_)(.+?)(?<!_)_(?!\\w)","g"),"<em>$1</em>").replace(/~~(.+?)~~/g,"<del>$1</del>").replace(/==(.+?)==/g,'<mark class="chat-highlight">$1</mark>'):""}function I3(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(d,h,f)=>{const p=e.length;return e.push({lang:h||"",code:f.trim()}),`__CODE_BLOCK_${p}__`});const s=[];n=n.replace(/`([^`]+)`/g,(d,h)=>{const f=s.length;return s.push(h),`__INLINE_CODE_${f}__`});const r=n.split(`
`);let i=[],a=!1,o=!1,l=!1;for(let d=0;d<r.length;d++){let h=r[d];const f=h.match(/^__CODE_BLOCK_(\d+)__$/);if(f){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l&&(i.push("</blockquote>"),l=!1);const y=e[parseInt(f[1])],g=y.lang?` class="language-${y.lang}"`:"";i.push(`<pre class="chat-code-block"><code${g}>${$g(y.code)}</code></pre>`);continue}const p=h.match(/^(#{1,6})\s+(.*)$/);if(p){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l&&(i.push("</blockquote>"),l=!1);const y=p[1].length,g=El(p[2]);i.push(`<h${y} class="chat-header chat-h${y}">${g}</h${y}>`);continue}if(/^[-*_]{3,}\s*$/.test(h)){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l&&(i.push("</blockquote>"),l=!1),i.push('<hr class="chat-hr">');continue}const b=h.match(/^>\s*(.*)$/);if(b){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l||(i.push('<blockquote class="chat-blockquote">'),l=!0),i.push(El(b[1])+"<br>");continue}else l&&(i.push("</blockquote>"),l=!1);const x=h.match(/^(\s*)([-*])\s+(.*)$/);if(x){o&&(i.push("</ol>"),o=!1),a||(i.push('<ul class="chat-list">'),a=!0);const y=El(x[3]);i.push(`<li>${y}</li>`);continue}else a&&(i.push("</ul>"),a=!1);const v=h.match(/^(\s*)(\d+)\.\s+(.*)$/);if(v){a&&(i.push("</ul>"),a=!1),o||(i.push('<ol class="chat-numbered-list">'),o=!0);const y=El(v[3]);i.push(`<li>${y}</li>`);continue}else o&&(i.push("</ol>"),o=!1);if(h.trim()===""){i.push("<br>");continue}i.push(El(h)),d<r.length-1&&i.push("<br>")}a&&i.push("</ul>"),o&&i.push("</ol>"),l&&i.push("</blockquote>");let u=i.join("");return s.forEach((d,h)=>{u=u.replace(`__INLINE_CODE_${h}__`,`<code class="chat-inline-code">${$g(d)}</code>`)}),u}function xe({label:t,children:e,className:n,labelClassName:s,withGap:r=!0}){return c.jsxs("label",{className:ve("block",r&&"space-y-1",n),children:[c.jsx("div",{className:ve("text-xs font-semibold text-black/60 dark:text-white/65",s),children:t}),e]})}function qe({value:t="",options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,className:i,contentClassName:a,useNativeSelect:o=!1}){const l=m.useMemo(()=>e.find(u=>u.value===t),[e,t]);return o?c.jsxs("select",{className:ve("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","disabled:opacity-60 disabled:cursor-not-allowed",i),value:t,onChange:u=>n==null?void 0:n(u.target.value),disabled:r,children:[s?c.jsx("option",{value:"",disabled:!0,children:s}):null,e.map(u=>c.jsx("option",{value:u.value,disabled:u.disabled,children:u.label},u.value))]}):r?c.jsxs("button",{type:"button",disabled:!0,className:ve("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:ve("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(An,{size:16,className:"text-black/50 dark:text-white/60"})]}):c.jsxs(Cf,{children:[c.jsx(Nf,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:ve("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:ve("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(An,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx(vu,{align:"start",className:ve("min-w-[220px]",a),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(u=>{const d=u.value===t;return c.jsx(Bc,{disabled:u.disabled,onSelect:()=>{u.disabled||n==null||n(u.value)},className:ve("cursor-pointer gap-0 py-1",d&&"bg-black/5 dark:bg-white/10 font-semibold"),children:c.jsx("span",{className:"min-w-0 truncate",children:u.label})},u.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]})}function D3({locations:t,timeOfDay:e,side:n,templateOptions:s,getTemplateKey:r,defaultFrameConfig:i,templateKey:a,setTemplateKey:o,venueType:l,timeOfDayDisabled:u,locationOptions:d}){const[h,f]=m.useState(""),p=a??h,b=o??f,[x,v]=m.useState(null),[y,g]=m.useState(i),[w,_]=m.useState(""),[k,S]=m.useState(null),[j,N]=m.useState([]),[T,A]=m.useState(!1),[z,M]=m.useState(""),I=zt.useRef([]),H=m.useMemo(()=>{const C=new Map;return s.forEach(F=>{C.set(r(F),F)}),C},[r,s]),L=m.useMemo(()=>{const C=new Map;return(d||[]).forEach(F=>{const K=(F==null?void 0:F.location_key)??(F==null?void 0:F.key)??(F==null?void 0:F.id)??(F==null?void 0:F.value)??F;if(!K)return;const U=(F==null?void 0:F.display_name)??(F==null?void 0:F.name)??(F==null?void 0:F.label)??K;C.set(String(K),U)}),C},[d]),D=m.useMemo(()=>t.length?t.map(C=>L.get(String(C))||C).filter(Boolean).join(", "):"",[L,t]),G=t.length&&(k||w.trim())&&!T;m.useEffect(()=>{if(!p){v(null),g(i);return}const C=H.get(p);if(!C){v(null),g(i);return}v(C),g(Vd(C.config,i))},[i,p,H]),m.useEffect(()=>{p&&b("")},[n,e,t,l,u]),m.useEffect(()=>{I.current=j},[j]),m.useEffect(()=>()=>{G0(I.current)},[]);async function E(){if(G){M("");try{A(!0);const C=new FormData,F=u?"all":e;C.append("location_key",t[0]||""),C.append("location_keys",JSON.stringify(t)),C.append("venue_type",l),x?(C.append("time_of_day",x.time_of_day||F||"all"),C.append("side",x.side||n||"all"),C.append("specific_photo",x.photo),C.append("frame_config",JSON.stringify(y))):(C.append("time_of_day",F||"all"),C.append("side",n||"all")),w.trim()?C.append("ai_prompt",w.trim()):k&&C.append("creative",k);const K=await lF(C),U=await F3(K,D),ie={id:crypto.randomUUID(),location:D,images:U};N(V=>{const O=[ie,...V];if(O.length>3){const q=O.pop();G0([q])}return O})}catch(C){M((C==null?void 0:C.message)||"Unable to generate mockup.")}finally{A(!1)}}}return{templateKey:p,setTemplateKey:b,aiPrompt:w,setAiPrompt:_,creativeFile:k,setCreativeFile:S,lastResults:j,generating:T,generateError:z,setGenerateError:M,onGenerate:E,canGenerate:G}}function L3(t){const e=D3(t);return c.jsx($3,{...t,...e})}function $3({locations:t,setLocations:e,venueType:n,setVenueType:s,setTemplateKey:r,locationOptions:i,locationsQuery:a,timeOfDay:o,setTimeOfDay:l,timeOfDayDisabled:u,sideDisabled:d,side:h,setSide:f,timeOfDayOptions:p,sideOptions:b,venueTypeOptions:x,templateKey:v,templateOptions:y,templatesQuery:g,templateThumbs:w,getTemplateKey:_,creativeFile:k,setCreativeFile:S,creativeDragActive:j,handleCreativeDragOver:N,handleCreativeDragLeave:T,handleCreativeDrop:A,aiPrompt:z,setAiPrompt:M,generateError:I,setGenerateError:H,generating:L,onGenerate:D,canGenerate:G,lastResults:E,useNativeSelects:C}){const F=m.useMemo(()=>i.map(U=>{const ie=(U==null?void 0:U.key)??(U==null?void 0:U.id)??(U==null?void 0:U.value)??U,V=(U==null?void 0:U.name)??(U==null?void 0:U.label)??ie;return{value:ie,label:V}}),[i]);function K(){e([]),s("all"),l("all"),f("all"),r(""),S(null),M(""),H("")}return c.jsxs(lt,{className:"h-full flex flex-col",children:[c.jsx(Et,{children:c.jsx(At,{children:"Mockup Generator"})}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[c.jsxs(xe,{label:"Location",children:[c.jsx(qe,{value:t[0]||"",options:F,placeholder:"Select a location",onChange:U=>{e(U?[U]:[]),r("")},useNativeSelect:C}),a.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(De,{text:"Loading locations"})}):null]}),c.jsx(xe,{label:"Venue Type",children:c.jsx(qe,{value:n,options:x,onChange:U=>s(U),useNativeSelect:C})}),!u&&c.jsx(xe,{label:"Time of Day",children:c.jsx(qe,{value:o,options:p,onChange:U=>l(U),useNativeSelect:C})}),!d&&c.jsx(xe,{label:"Billboard Side",children:c.jsx(qe,{value:h,options:b,onChange:U=>f(U),useNativeSelect:C})})]}),t.length?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Templates (optional)"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Select a template or keep random."})]}),v?c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>r(""),children:"Use random"}):null]}),g.isLoading?c.jsx(De,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!g.isLoading&&!y.length?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:y.map(U=>{const ie=_(U),V=ie===v,O=w[ie];return c.jsxs("div",{className:ve("rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-left text-sm transition flex flex-col",V?"border-2":"hover:bg-black/5 dark:hover:bg-white/10"),style:V?{borderColor:"rgb(var(--brand-accent) / 0.6)",boxShadow:"0 0 0 1px rgb(var(--brand-accent) / 0.25)"}:void 0,children:[c.jsxs("button",{type:"button",onClick:()=>r(ie),className:"text-left flex flex-col flex-1",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:O?c.jsx("img",{src:O,alt:U.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(De,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-1",children:[c.jsx("div",{className:"font-semibold truncate",children:U.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[U.time_of_day,"/",U.side," - ",U.frame_count," frame",U.frame_count>1?"s":""]})]})]}),c.jsx("div",{className:"pt-2",children:O?c.jsx(Z,{variant:"secondary",size:"sm",className:"w-full rounded-xl",asChild:!0,children:c.jsxs("a",{href:O,target:"_blank",rel:"noreferrer",children:[c.jsx(_i,{size:16,className:"mr-2"}),"Open"]})}):c.jsx(Z,{variant:"secondary",size:"sm",className:"w-full rounded-xl",disabled:!0,children:"Open"})})]},ie)})})]}):null,c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Upload Creative/Ad Image",children:k?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${j?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:N,onDragLeave:T,onDrop:A,children:[c.jsx("div",{className:"truncate",children:k.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>S(null),children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${j?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:N,onDragLeave:T,onDrop:A,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:U=>{var ie;return S(((ie=U.target.files)==null?void 0:ie[0])||null)}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP, GIF up to 10MB"})]})}),c.jsx(xe,{label:"Or use AI prompt",children:c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px]",value:z,onChange:U=>M(U.target.value),placeholder:"Describe what you want to generate..."})})]}),I?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:I}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Z,{className:"rounded-2xl",onClick:D,disabled:!G,children:L?c.jsx(De,{text:"Generating Mockup"}):"Generate Mockup"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl",onClick:K,disabled:L,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4",children:[!E.length&&!L?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,L?c.jsx(De,{text:"Processing mockup",className:"text-sm text-black/60 dark:text-white/65"}):null,E.length?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Mockups"}),E.map(U=>{var ie;return c.jsxs("div",{className:"space-y-3",children:[U.location?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:U.location}):null,(ie=U.images)!=null&&ie.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:U.images.map((V,O)=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("a",{href:V.url,target:"_blank",rel:"noopener noreferrer",className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:V.url,alt:V.label||"Generated mockup",className:"w-full h-40 object-cover",loading:"lazy"})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:V.url,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(_i,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(Z,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:q=>{q.preventDefault(),Y0(V.url,V.filename)},onKeyDown:q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),Y0(V.url,V.filename))},className:"inline-flex items-center",children:[c.jsx(Sa,{size:14,className:"mr-1"}),"Download"]})})]})]},`${U.id}-img-${O}`))}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No images returned yet."})]},U.id)})]}):null]})]})]})}function q0(t){return typeof Blob<"u"&&t instanceof Blob}async function F3(t,e){if(!t)return[];if(t instanceof Response){const i=await t.blob();return i?[Fp(i,e,1)]:[]}if(q0(t))return[Fp(t,e,1)];const n=t,s=(n==null?void 0:n.images)||(n==null?void 0:n.image_urls)||(n==null?void 0:n.urls)||(n==null?void 0:n.results)||(n==null?void 0:n.files)||(n==null?void 0:n.data)||null,r=Array.isArray(s)?s:n!=null&&n.url?[n.url]:[];return r.length?r.map((i,a)=>{if(typeof i=="string")return K0(i,e,a+1);if(q0(i))return Fp(i,e,a+1);const o=(i==null?void 0:i.url)||(i==null?void 0:i.image_url)||(i==null?void 0:i.file_url)||"";return K0(o,e,a+1)}):[]}function Fp(t,e,n){const s=URL.createObjectURL(t),r=Fg(s,e,n);return{url:s,filename:r}}function K0(t,e,n){return t?{url:t,filename:Fg(t,e,n)}:{url:"",filename:Fg("",e,n)}}function Fg(t,e,n){const s=z3(t);if(s)return s;const r=(e||"result").toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),i=n?`_${n}`:"";return`mockup_${r||"result"}${i}.jpg`}function z3(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function G0(t){(Array.isArray(t)?t:[]).forEach(n=>{((n==null?void 0:n.images)||[]).forEach(s=>{var r;(r=s==null?void 0:s.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(s.url)})})}async function Y0(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e||"download",document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function B3(t,e,n){return t.length?t.length<=n?t.join(", "):`${t.slice(0,n).join(", ")} +${t.length-n}`:e}function U3({value:t=[],options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,maxLabelCount:i=2,className:a,contentClassName:o}){const l=m.useMemo(()=>new Set(t),[t]),u=m.useMemo(()=>e.filter(f=>l.has(f.value)).map(f=>f.label),[e,l]);function d(f){r||n&&(l.has(f)?n(t.filter(p=>p!==f)):n([...t,f]))}const h=B3(u,s,i);return c.jsxs("div",{className:"space-y-2",children:[c.jsxs(Cf,{children:[c.jsx(Nf,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:ve("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",a),children:[c.jsx("span",{className:ve("truncate",!u.length&&"text-black/50 dark:text-white/55"),children:h}),c.jsx(An,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx(vu,{align:"start",className:ve("min-w-[220px]",o),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(f=>{const p=l.has(f.value);return c.jsxs(Bc,{onSelect:b=>{b.preventDefault(),d(f.value)},className:"cursor-pointer py-1",children:[c.jsx("span",{className:ve("h-4 w-4 rounded-full flex items-center justify-center transition-colors",p?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:10,className:p?"opacity-100":"opacity-0"})}),c.jsx("span",{className:"min-w-0 truncate",children:f.label})]},f.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]}),u.length?c.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(f=>c.jsx("span",{className:"text-[11px] rounded-md bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/70 px-2",children:f},f))}):null]})}function W3({locations:t,setLocations:e,venueType:n,setVenueType:s,setTemplateKey:r,locationOptions:i,locationsQuery:a,timeOfDay:o,setTimeOfDay:l,timeOfDayDisabled:u,sideDisabled:d,side:h,setSide:f,timeOfDayOptions:p,sideOptions:b,venueTypeOptions:x,editingTemplate:v,editingTemplateLoading:y,stopEditTemplate:g,templatesOpen:w,setTemplatesOpen:_,templateOptions:k,templatesQuery:S,templateThumbs:j,getTemplateKey:N,startEditTemplate:T,deleteTemplate:A,setupPhoto:z,setSetupPhoto:M,handleSetupPhoto:I,handleSetupDragOver:H,handleSetupDragLeave:L,handleSetupDrop:D,setupDragActive:G,handleSetupPhotoClear:E,framesJson:C,setFramesJson:F,setFramesJsonDirty:K,applyFramesJsonToCanvas:U,buildFramesPayload:ie,setupImageReady:V,greenscreenOpen:O,setGreenscreenOpen:q,greenscreenColor:ae,setGreenscreenColor:Ce,colorTolerance:Le,setColorTolerance:st,RangeField:be,handleGreenscreenDetect:he,canDetectGreenscreen:Ke,hasActiveFrame:ee,frameSettingsOpen:de,setFrameSettingsOpen:le,setupFrameConfig:Y,handleSetupFrameConfigChange:Q,FrameConfigControls:oe,previewOpen:X,setPreviewOpen:$,testPreviewMode:ce,setTestPreviewMode:me,testPreviewImgRef:je,testPreviewUrlRef:$e,previewImgRef:ue,drawPreview:re,activeTestCreativeFile:_e,updateTestCreativeForActive:Ge,generateTestPreview:mt,testPreviewing:Lt,activeFrameIndex:_n,canvasRef:Of,canvasWidth:Tf,canvasHeight:Ai,handleCanvasPointerDown:Da,handleCanvasPointerMove:La,handleCanvasPointerUp:Oi,handleCanvasWheel:ku,setupHint:Su,handleZoomOut:gt,handleZoomIn:et,handleFitToScreen:gs,zoomPercent:xs,pixelUpscale:$n,setPixelUpscale:ju,setupError:Ti,setupMessage:$a,addFrame:Fn,resetCurrentFrame:Ye,saveSetup:tt,setupSaving:Mi,clearAllFrames:tn,currentPoints:un,frameCount:Fa,useNativeSelects:Ar}){return c.jsxs(lt,{className:"h-full flex flex-col",children:[c.jsx(Et,{children:c.jsx(At,{children:"Mockup Setup"})}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[c.jsxs(xe,{label:"Location",children:[c.jsx(U3,{value:t,onChange:ge=>{e(ge),r("")},options:i.map(ge=>{const Kt=(ge==null?void 0:ge.key)??(ge==null?void 0:ge.id)??(ge==null?void 0:ge.value)??ge,Or=(ge==null?void 0:ge.name)??(ge==null?void 0:ge.label)??Kt;return{value:Kt,label:Or}}),placeholder:"Select locations"}),a.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(De,{text:"Loading locations"})}):null]}),c.jsx(xe,{label:"Venue Type",children:c.jsx(qe,{value:n,options:x,placeholder:"Select venue type",onChange:ge=>s(ge),useNativeSelect:Ar})}),!u&&c.jsx(xe,{label:"Time of Day",children:c.jsx(qe,{value:o,options:p,placeholder:"Select time of day",onChange:ge=>l(ge),useNativeSelect:Ar})}),!d&&c.jsx(xe,{label:"Billboard Side",children:c.jsx(qe,{value:h,options:b,placeholder:"Select side",onChange:ge=>f(ge),useNativeSelect:Ar})})]}),v?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/50 dark:bg-white/5 px-4 py-3 flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:"Editing template:"})," ",v.photo," (",v.time_of_day,"/",v.side,")"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[y?c.jsx(De,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"}):null,c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:g,children:"Stop editing"})]})]}):null,v?null:c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>_(ge=>!ge),"aria-expanded":w,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Existing templates"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:t.length?`${k.length} template${k.length===1?"":"s"}`:"Select at least one location to load templates."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:w?"Hide":"Show"}),c.jsx(An,{size:16,className:ve("transition-transform",w&&"rotate-180")})]})]}),w?c.jsxs("div",{className:"mt-3 space-y-2",children:[S.isLoading?c.jsx(De,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!S.isLoading&&(!k.length||!t.length)?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:k.map(ge=>{const Kt=N(ge);return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:j[Kt]?c.jsx("img",{src:j[Kt],alt:ge.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(De,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-2",children:[c.jsx("div",{className:"font-semibold truncate",children:ge.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[ge.time_of_day,"/",ge.side," - ",ge.frame_count," frame",ge.frame_count>1?"s":""]}),null]})]},Kt)})})]}):null]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Upload Billboard Photo",children:z?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${G?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:H,onDragLeave:L,onDrop:D,children:[c.jsx("div",{className:"truncate",children:z.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:E,children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${G?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:H,onDragLeave:L,onDrop:D,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp",onChange:ge=>{var Or;const Kt=(Or=ge.target.files)==null?void 0:Or[0];Kt&&(M(Kt),I(Kt))}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP up to 20MB"})]})}),c.jsxs(xe,{label:"Frames Data",children:[c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px] font-mono",value:C,onChange:ge=>{F(ge.target.value),K(!0)},placeholder:'[{"points":[0,0,0,0],"config":{"brightness":100}}]'}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-black/50 dark:text-white/60",children:[c.jsx("span",{children:"Auto-filled from canvas. Edit to override."}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"text-xs underline",onClick:U,children:"Apply to canvas"}),c.jsx("button",{type:"button",className:"text-xs underline",onClick:()=>{K(!1);const ge=ie();F(ge.length?JSON.stringify(ge,null,2):"[]")},children:"Sync from canvas"})]})]})]})]}),V?c.jsxs(c.Fragment,{children:[c.jsxs(yt,{className:"bg-white/50 dark:bg-white/5 p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>q(ge=>!ge),"aria-expanded":O,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Green Screen Detection"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Detect billboard frame using chroma key."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:O?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",O&&"rotate-180")})]})]}),O?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"color",value:ae,onChange:ge=>Ce(ge.target.value.toUpperCase()),className:"h-10 w-16 rounded-lg border border-black/10 dark:border-white/20"}),c.jsx("input",{type:"text",value:ae,onChange:ge=>Ce(ge.target.value.toUpperCase()),className:"flex-1 rounded-xl bg-white/70 dark:bg-white/10 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none font-mono"})]}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Tip: Shift+click to pick a color. Shift+drag or middle mouse pans."}),c.jsx(be,{label:"Color Tolerance",value:Le,min:10,max:100,onChange:ge=>st(ge),helper:"Lower is stricter, higher is more forgiving."}),c.jsx(Z,{className:"rounded-2xl w-full",onClick:he,disabled:!Ke,children:"Detect Green Screen Now"})]}):null]}),ee?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>le(ge=>!ge),"aria-expanded":de,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Current Frame Settings"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Adjust the current frame appearance."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:de?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",de&&"rotate-180")})]})]}),de?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsx(oe,{config:Y,onChange:Q}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Settings apply to the current frame only."})]}):null]}):null,ee?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>$(ge=>!ge),"aria-expanded":X,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Test Preview Mode"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Preview creative on the current frame before saving."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:X?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",X&&"rotate-180")})]})]}),X?c.jsxs("div",{className:"mt-3 space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3 text-sm",children:[c.jsx("input",{type:"checkbox",checked:ce,onChange:ge=>{me(ge.target.checked),ge.target.checked||(je.current=null,$e.current="",re())}}),c.jsx("span",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Enable preview"})]}),ce?c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-semibold text-blue-900 dark:text-blue-100",children:"Upload Test Creative"}),c.jsx("input",{type:"file",accept:"image/*",onChange:ge=>{var Kt;return Ge(((Kt=ge.target.files)==null?void 0:Kt[0])||null)},className:"w-full text-sm"}),_e?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Selected: ",_e.name]}):null,c.jsx(Z,{className:"rounded-2xl w-full",onClick:mt,disabled:!_e||!z||!ee||Lt,children:Lt?c.jsx(De,{text:"Generating"}):"Generate Test Preview"}),_n>=0?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Preview applies to frame ",_n+1,"."]}):null]}):null]}):null]}):null]}):null]}),V?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-2",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Z,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:gt,disabled:!ue.current,children:"-"}),c.jsx(Z,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:et,disabled:!ue.current,children:"+"}),c.jsx(Z,{variant:"ghost",size:"sm",onClick:gs,disabled:!ue.current,children:"Fit"}),c.jsxs("span",{className:"text-xs text-black/60 dark:text-white/60",children:[xs,"%"]})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-black/70 dark:text-white/70",children:[c.jsx("input",{type:"checkbox",checked:$n,onChange:ge=>ju(ge.target.checked)}),"Pixel Upscale"]})]}),c.jsx("canvas",{ref:Of,width:Tf,height:Ai,className:"w-full h-auto rounded-xl border border-black/10 dark:border-white/10 bg-white",onPointerDown:Da,onPointerMove:La,onPointerUp:Oi,onPointerLeave:Oi,onWheel:ku,style:{touchAction:"none"}}),c.jsx("div",{className:"text-xs text-black/60 dark:text-white/60",children:Su})]}):c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-black/5 dark:bg-white/10 px-4 py-3 text-sm text-black/60 dark:text-white/65",children:"Upload a billboard photo or pick an existing template to enable the canvas tools."})]}),Ti?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:Ti}):null,$a?c.jsx("div",{className:"rounded-xl bg-green-50/70 text-green-700 px-4 py-2 text-sm dark:bg-green-500/10 dark:text-green-200",children:$a}):null,c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Z,{className:"rounded-2xl",onClick:Fn,disabled:un.length!==4,children:"Add Frame"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl",onClick:Ye,children:"Reset Current Frame"}),c.jsx(Z,{className:"rounded-2xl",onClick:tt,disabled:Mi||!t.length||!z,children:Mi?c.jsx(De,{text:"Saving"}):v?"Save Changes":"Save All Frames"}),c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:()=>tn(!1),children:"Clear All Frames"})]}),Fa?c.jsxs("div",{className:"rounded-xl bg-blue-50/70 text-blue-900 px-3 py-2 text-sm dark:bg-blue-500/10 dark:text-blue-100",children:["Frames configured: ",Fa]}):null]})]})}function H3({enabled:t}){const e=on({queryKey:["mockup","history"],queryFn:cF,enabled:t}),n=m.useMemo(()=>{var s,r,i;return Array.isArray(e.data)?e.data:(s=e.data)!=null&&s.history?e.data.history:(r=e.data)!=null&&r.mockups?e.data.mockups:(i=e.data)!=null&&i.items?e.data.items:e.data||[]},[e.data]);return{historyQuery:e,historyItems:n}}function V3(t){const e=H3(t);return c.jsx(q3,{...e})}function q3({historyQuery:t,historyItems:e}){return c.jsxs(lt,{className:"h-full flex flex-col",children:[c.jsx(Et,{children:c.jsx(At,{children:"History"})}),c.jsx(Pt,{className:"flex-1 min-h-0 overflow-y-auto",children:t.isLoading?c.jsx(De,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):t.isError?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Unable to load history right now."}):c.jsxs("div",{className:"space-y-2",children:[(e||[]).map((n,s)=>{const r=n.image_url||n.mockup_url||n.result_url||n.file_url||n.url||n.image||"",i=n.location_name||n.location||n.location_key||n.location_id||"Mockup",a=n.time_of_day||n.timeOfDay||"",o=n.side||n.billboard_side||"",l=n.created_at||n.generated_at||n.date_generated||"",u=["mockup",i,a||"all",o||"all"].filter(Boolean).join("_");return c.jsxs(yt,{className:"p-3 space-y-2",children:[r?c.jsx("div",{className:"overflow-hidden rounded-xl border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:r,alt:i,className:"w-full h-40 object-cover",loading:"lazy"})}):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 px-3 py-6 text-sm text-black/60 dark:text-white/65 text-center",children:"Preview not available"}),c.jsx("div",{className:"text-base font-semibold",children:i}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[l?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Generated"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:new Date(l).toLocaleString()})]}):null,a?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Time of Day"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:a})]}):null,o?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Side"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:o})]}):null]}),r?c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:"Open"})}),c.jsx(Z,{asChild:!0,size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsx("a",{href:r,download:u,children:"Download"})})]}):null]},n.id||n.file_id||r||s)}),e!=null&&e.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No mockups yet."})]})})]})}const zC=[{value:"all",label:"All (Default)"},{value:"day",label:"Day"},{value:"night",label:"Night"}],K3=zC.filter(t=>t.value!=="all"),BC=[{value:"all",label:"All (Default)"},{value:"gold",label:"Gold"},{value:"silver",label:"Silver"},{value:"single_side",label:"Single Side"}],G3=BC.filter(t=>t.value!=="all"),UC=[{value:"all",label:"All (Default)"},{value:"outdoor",label:"Outdoor"},{value:"indoor",label:"Indoor"}],Y3=UC.filter(t=>t.value!=="all"),Q0=!1,ud=1200,dd=800,Q3=.5,X3=4,X0=.1,J3=4,qi={brightness:100,contrast:100,saturation:100,depthMultiplier:15,lightDirection:"top",imageBlur:0,edgeBlur:1,overlayOpacity:0,shadowIntensity:0,lightingAdjustment:0,colorTemperature:0,vignette:0,edgeSmoother:3,sharpening:0},WC=[{value:"top-left",label:"Top Left",glyph:""},{value:"top",label:"Top",glyph:""},{value:"top-right",label:"Top Right",glyph:""},{value:"left",label:"Left",glyph:""},{value:"center",label:"Center",glyph:""},{value:"right",label:"Right",glyph:""},{value:"bottom-left",label:"Bottom Left",glyph:""},{value:"bottom",label:"Bottom",glyph:""},{value:"bottom-right",label:"Bottom Right",glyph:""}],Z3=WC.reduce((t,e)=>(t[e.value]=e.label,t),{});function ez(t,e,n){const s=(t-e)/(n-e)*100;return`linear-gradient(to right, rgb(var(--brand-accent, 102 126 234)) ${s}%, rgba(0, 0, 0, 0.1) ${s}%)`}function tz(){const t=er(),{user:e}=jr(),n=qd(e,"sales:mockups:setup"),[s,r]=m.useState("generate"),[i,a]=m.useState([]),[o,l]=m.useState("all"),[u,d]=m.useState("all"),[h,f]=m.useState("all"),[p,b]=m.useState(""),x=i[0]||"",v=o==="indoor",y=v,g=v,w=y?"all":u;m.useEffect(()=>{o==="indoor"&&(u&&d(""),h&&f(""))},[o]);const _=m.useRef(s),[k,S]=m.useState(null),[j,N]=m.useState(!1),[T,A]=m.useState(""),[z,M]=m.useState(""),[I,H]=m.useState("[]"),[L,D]=m.useState(!1),[G,E]=m.useState({}),[C,F]=m.useState(null),[K,U]=m.useState(!1),[ie,V]=m.useState(!1),[O,q]=m.useState(!1),[ae,Ce]=m.useState("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),[Le,st]=m.useState(qi),[be,he]=m.useState("#1CFF1C"),[Ke,ee]=m.useState(40),[de,le]=m.useState([]),[Y,Q]=m.useState(0),[oe,X]=m.useState(1),[$,ce]=m.useState(!1),[me,je]=m.useState(-1),[$e,ue]=m.useState(!1),[re,_e]=m.useState(!0),[Ge,mt]=m.useState(!0),[Lt,_n]=m.useState(!0),[Of,Tf]=m.useState(!0),[Ai,Da]=m.useState(!1),[La,Oi]=m.useState({}),[ku,Su]=m.useState(!1),gt=m.useRef(null),et=m.useRef(null),gs=m.useRef(null),xs=m.useRef(""),$n=m.useRef(new Map),ju=m.useRef({}),Ti=m.useRef({}),$a=m.useRef([]),Fn=m.useRef(!1),Ye=m.useRef([]),tt=m.useRef([]),Mi=m.useRef(-1),tn=m.useRef({zoom:1,panX:0,panY:0}),un=m.useRef({isDrawing:!1,isDraggingCorner:!1,isDraggingFrame:!1,dragFrameIndex:-1,dragPointIndex:-1,startX:0,startY:0,isPanning:!1,shiftPanPending:!1,hasPanned:!1,panStartX:0,panStartY:0,panOriginX:0,panOriginY:0}),Fa=m.useRef({pointers:new Map,isPinching:!1,startDistance:0,startZoom:1,startPanX:0,startPanY:0,startCenterX:0,startCenterY:0}),Ar=m.useRef({drawX:0,drawY:0,drawW:0,drawH:0,scale:1,imgNaturalW:0,imgNaturalH:0}),ge=on({queryKey:["mockup","eligibility","setup"],queryFn:dF,enabled:s==="setup"}),Kt=on({queryKey:["mockup","eligibility","generate"],queryFn:hF,enabled:s==="generate"}),Or=on({queryKey:["mockup","templates",x,w,h,o],queryFn:()=>z0(x,{timeOfDay:w,side:h,venueType:o}),enabled:s==="generate"&&!!x}),gl=EA({queries:s==="setup"?i.map(P=>({queryKey:["mockup","templates",P,w,h,o],queryFn:()=>z0(P,{timeOfDay:w,side:h,venueType:o}),enabled:!!P,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:!1,staleTime:1/0})):[]}),Mf=m.useMemo(()=>{var B;return{data:gl.flatMap((W,ne)=>{const J=W.data,ye=Array.isArray(J)?J:(J==null?void 0:J.templates)||[],we=i[ne];return ye.map(Ne=>({...Ne,storage_key:Ne.storage_key||we}))}),isLoading:gl.some(W=>W.isLoading),isFetching:gl.some(W=>W.isFetching),error:((B=gl.find(W=>W.error))==null?void 0:B.error)||null}},[i,gl]);m.useEffect(()=>()=>{$n.current.forEach(P=>{P!=null&&P.url&&URL.revokeObjectURL(P.url)}),$n.current.clear(),xs.current&&URL.revokeObjectURL(xs.current)},[]),m.useEffect(()=>{ju.current=La},[La]),m.useEffect(()=>{Ti.current=G},[G]);const AN=m.useMemo(()=>{const P=ge.data;return Array.isArray(P)?P:(P==null?void 0:P.locations)||[]},[ge.data]),ON=m.useMemo(()=>{const P=Kt.data;return Array.isArray(P)?P:(P==null?void 0:P.locations)||[]},[Kt.data]),Hy=s==="setup"?AN:ON,Vy=s==="setup"?ge:Kt,qy=m.useMemo(()=>{const P=Or.data;return Array.isArray(P)?P:(P==null?void 0:P.templates)||[]},[Or.data]),Ky=m.useMemo(()=>{const P=Mf.data;return Array.isArray(P)?P:(P==null?void 0:P.templates)||[]},[Mf.data]),Cu=s==="setup"?Ky:qy,Gy=m.useMemo(()=>Cu.map(P=>sr(P)).join("|"),[Cu,sr]);m.useEffect(()=>{$a.current=Cu},[Cu]);const TN=s==="history";m.useEffect(()=>{_.current!==s&&(_.current==="setup"&&C&&Xy(),a([]),s==="setup"?(l(""),d(""),f("")):(l("all"),d("all"),f("all")),b("")),_.current=s},[C,s]),m.useEffect(()=>{o==="indoor"&&u&&d("")},[u,o]),m.useEffect(()=>{E(P=>{const B=new Set($a.current.map(J=>sr(J))),W={};let ne=!1;return Object.entries(P).forEach(([J,ye])=>{B.has(J)?W[J]=ye:ye&&(ne=!0,URL.revokeObjectURL(ye))}),ne?W:P})},[Gy,sr]),m.useEffect(()=>{let P=!0;const B=$a.current;if(!x||!B.length)return()=>{};const W=B.filter(ne=>!Ti.current[sr(ne)]);return W.length?((async()=>{const ne=await Promise.all(W.map(async ye=>{const we=sr(ye);let Ne="";try{Ne=await uF(ye.storage_key||x,ye.photo,{timeOfDay:ye.time_of_day||w,side:ye.side||h,company:ye.company})}catch{Ne=""}return{key:we,url:Ne}}));if(!P){ne.forEach(({url:ye})=>{ye&&URL.revokeObjectURL(ye)});return}const J={};ne.forEach(({key:ye,url:we})=>{we&&!Ti.current[ye]?J[ye]=we:we&&URL.revokeObjectURL(we)}),Object.keys(J).length>0&&E(ye=>({...ye,...J}))})(),()=>{P=!1}):()=>{}},[x,Gy,w,h,sr]),m.useEffect(()=>()=>{Object.values(Ti.current).forEach(P=>{P&&URL.revokeObjectURL(P)})},[]);const MN=!!et.current,IN=de.length===4||me>=0,ys=me>=0?`frame-${me}`:de.length===4?"current":null,Yy=ys?La[ys]:null,DN=Math.round(oe*100);m.useEffect(()=>{if(!ys){gs.current=null,xs.current="";return}const P=$n.current.get(ys);gs.current=(P==null?void 0:P.img)||null,xs.current=(P==null?void 0:P.url)||"",Ai&&nt()},[ys,La,Ai]),m.useEffect(()=>{et.current&&xl(),nt()},[Ai]),m.useEffect(()=>{nt()},[$]),m.useEffect(()=>{$e&&et.current&&nt()},[$e]),m.useEffect(()=>{if(L)return;const P=za();H(P.length?JSON.stringify(P,null,2):"[]")},[de,Y,Le,L]);async function LN(){if(A(""),M(""),!i.length){M("Select at least one location first");return}if(!k){M("Upload a billboard photo first");return}let P=za();if(I.trim())try{P=JSON.parse(I)}catch(B){M((B==null?void 0:B.message)||"Frames JSON is invalid");return}if(!Array.isArray(P)||!P.length){M("Add at least one frame before saving");return}try{N(!0);const B=new FormData;B.append("location_key",x),B.append("location_keys",JSON.stringify(i)),B.append("venue_type",o),B.append("time_of_day",w||"all"),B.append("side",h||"all"),B.append("frames_data",JSON.stringify(P)),B.append("photo",k),await iF(B),A("Saved frames successfully"),iv(!0),F(null),U(!1),S(null),et.current=null,ue(!1),t.invalidateQueries({queryKey:["mockup","templates"]}),nt()}catch(B){M((B==null?void 0:B.message)||"Failed to save template")}finally{N(!1)}}async function $N(P){if(x)try{await aF(x,P),t.invalidateQueries({queryKey:["mockup","templates"]})}catch(B){M((B==null?void 0:B.message)||"Failed to delete template")}}function Qy(P,{resetFrames:B=!0}={}){et.current=P,ue(!0);const W=GN(P.naturalWidth,P.naturalHeight);Ar.current={drawX:W.x,drawY:W.y,drawW:W.w,drawH:W.h,scale:W.scale,imgNaturalW:P.naturalWidth,imgNaturalH:P.naturalHeight},Lf(!1),B&&(Ye.current=[],tt.current=[],ns(),Fn.current=!1,sE(),Nu(),zn(),Di(),H("[]"),D(!1)),xl(),nt()}function FN(P,B){return new Promise((W,ne)=>{const J=new Image;J.onload=()=>{Qy(J,B),W()},J.onerror=()=>ne(new Error("Failed to load image")),J.src=P})}function zN(P,B){return new Promise((W,ne)=>{const J=new FileReader;J.onload=ye=>{const we=new Image;we.onload=()=>{Qy(we,B),W()},we.onerror=()=>ne(new Error("Failed to load image")),we.src=ye.target.result},J.onerror=()=>ne(new Error("Failed to read image")),J.readAsDataURL(P)})}function If(P){return P?Array.isArray(P)&&P.length===4&&Array.isArray(P[0])?P:Array.isArray(P)&&P.length>=8&&typeof P[0]=="number"?[[P[0],P[1]],[P[2],P[3]],[P[4],P[5]],[P[6],P[7]]]:null:null}function BN(P){if(!P)return[];let B=P.frames||P.frames_data||P.framesData||P.frame_data||P.frame_points;if(typeof B=="string")try{B=JSON.parse(B)}catch{B=[]}return Array.isArray(B)?B.map(W=>{const ne=If((W==null?void 0:W.points)||(W==null?void 0:W.frame_points)||W)||If(W==null?void 0:W.points);if(!ne)return null;let J=(W==null?void 0:W.config)||(P==null?void 0:P.config);if(typeof J=="string")try{J=JSON.parse(J)}catch{J=null}const ye=Vd(J,qi);return{points:ne,config:ye,source:"existing"}}).filter(Boolean):[]}async function UN(P){if(!(!x||!(P!=null&&P.photo))){F(P),U(!0),M(""),A(""),S(null);try{P.time_of_day&&P.time_of_day!=="all"?d(P.time_of_day):d(""),P.side&&P.side!=="all"?f(P.side):f("");const B=await RC(P.storage_key||x,P.photo,{timeOfDay:P.time_of_day||w,side:P.side||h,company:P.company});if(!B)throw new Error("Failed to load template image");const W=URL.createObjectURL(B);try{await FN(W,{resetFrames:!1})}finally{URL.revokeObjectURL(W)}const ne=BN(P);tt.current=ne,Ye.current=[],ns(),Fn.current=!1,zn(),Di(),H(ne.length?JSON.stringify(za(),null,2):"[]"),D(!1),nt();const J=new File([B],P.photo,{type:B.type||"image/jpeg"});S(J)}catch(B){M((B==null?void 0:B.message)||"Failed to load template for editing")}finally{U(!1)}}}function Xy(){F(null),U(!1),A(""),M(""),d(""),f(""),S(null),et.current=null,ue(!1),Ye.current=[],tt.current=[],ns(),Fn.current=!1,zn(),Di(),H("[]"),D(!1),xl(),nt()}function Df(P){const B=gt.current;if(!B)return null;const W=B.getBoundingClientRect(),ne=B.width/W.width,J=B.height/W.height;return{x:(P.clientX-W.left)*ne,y:(P.clientY-W.top)*J}}function Jy(P){return Math.min(X3,Math.max(Q3,P))}function Ii(){const{drawX:P,drawY:B,drawW:W,drawH:ne,scale:J}=Ar.current,{zoom:ye,panX:we,panY:Ne}=tn.current;return{drawX:P+we,drawY:B+Ne,drawW:W*ye,drawH:ne*ye,scale:J*ye}}function Lf(P=!0){tn.current={zoom:1,panX:0,panY:0},X(1),P&&nt()}function Zy(){const P=gt.current;return P?{x:P.width/2,y:P.height/2}:{x:ud/2,y:dd/2}}function ev(P,B,W){const{drawX:ne,drawY:J,scale:ye}=Ar.current,{zoom:we,panX:Ne,panY:it}=tn.current,Qe=Jy(P),Se=ye*we,Te=ye*Qe;if(!Se||!Te)return;const Me=(B-(ne+Ne))/Se,vt=(W-(J+it))/Se,ct=B-ne-Me*Te,kn=W-J-vt*Te;tn.current={zoom:Qe,panX:ct,panY:kn},X(Qe),nt()}function WN(P,B){if(!et.current)return;const{drawX:W,drawY:ne,drawW:J,drawH:ye,scale:we}=Ii();if(P<W||B<ne||P>W+J||B>ne+ye)return;const Ne=Math.floor((P-W)/we),it=Math.floor((B-ne)/we),Qe=document.createElement("canvas");Qe.width=et.current.naturalWidth,Qe.height=et.current.naturalHeight;const Se=Qe.getContext("2d");Se.drawImage(et.current,0,0);const Te=Se.getImageData(Ne,it,1,1),[Me,vt,ct]=Te.data,kn=`#${[Me,vt,ct].map(Is=>Is.toString(16).padStart(2,"0")).join("").toUpperCase()}`;he(kn)}function HN(P){}function VN(){if(!et.current)return;const P=Zy();ev(tn.current.zoom+X0,P.x,P.y)}function qN(){if(!et.current)return;const P=Zy();ev(tn.current.zoom-X0,P.x,P.y)}function KN(){et.current&&Lf()}function GN(P,B){const W=Math.min(ud/P,dd/B),ne=Math.round(P*W),J=Math.round(B*W),ye=Math.round((ud-ne)/2),we=Math.round((dd-J)/2);return{x:ye,y:we,w:ne,h:J,scale:W}}function YN(){const P=gt.current;if(!P)return;const B=P.getContext("2d");B.clearRect(0,0,P.width,P.height),B.fillStyle="#f8f9fa",B.fillRect(0,0,P.width,P.height)}function nt(){const P=gt.current;if(!P)return;const B=P.getContext("2d");YN();const W=et.current;if(!W)return;const{drawX:ne,drawY:J,drawW:ye,drawH:we,scale:Ne}=Ii();if(B.imageSmoothingEnabled=!$,$||(B.imageSmoothingQuality="high"),Ai&&gs.current){B.drawImage(gs.current,ne,J,ye,we);return}B.drawImage(W,ne,J,ye,we),tt.current.forEach((Se,Te)=>{const Me=Se.points,vt=Mi.current===Te,ct=1;B.fillStyle="rgba(128, 128, 128, 0.3)",B.strokeStyle=vt?"#667eea":"#333",B.lineWidth=ct,B.setLineDash([8,4]),B.lineCap="butt",B.lineJoin="miter",B.beginPath(),Me.forEach((kn,Is)=>{const Li=ne+kn[0]*Ne,Bn=J+kn[1]*Ne;Is===0?B.moveTo(Li,Bn):B.lineTo(Li,Bn)}),B.closePath(),B.fill(),B.stroke(),B.setLineDash([]),Me.forEach(kn=>{const Is=ne+kn[0]*Ne,Li=J+kn[1]*Ne,Bn=4;B.fillStyle=vt?"#667eea":"#333",B.fillRect(Is-Bn/2,Li-Bn/2,Bn,Bn)})});const Qe=Ye.current;Qe.length>0&&(B.fillStyle="rgba(128, 128, 128, 0.3)",B.strokeStyle="#667eea",B.lineWidth=1,B.setLineDash([8,4]),B.lineCap="butt",B.lineJoin="miter",B.beginPath(),Qe.forEach((Te,Me)=>{const vt=ne+Te[0]*Ne,ct=J+Te[1]*Ne;Me===0?B.moveTo(vt,ct):B.lineTo(vt,ct)}),Qe.length===4&&(B.closePath(),B.fill()),B.stroke(),B.setLineDash([]),Qe.forEach(Te=>{const Me=ne+Te[0]*Ne,vt=J+Te[1]*Ne;B.fillStyle="#667eea",B.fillRect(Me-4/2,vt-4/2,4,4)}))}function zn(){le([...Ye.current])}function Di(){Q(tt.current.length)}function ns(){Mi.current=-1,je(-1)}function QN(){if(me>=0){const P=tt.current[me];return P?{key:`frame-${me}`,points:P.points,config:P.config}:null}return Ye.current.length===4?{key:"current",points:Ye.current,config:Le}:null}function XN(){$n.current.forEach(P=>{P!=null&&P.url&&URL.revokeObjectURL(P.url)}),$n.current.clear(),xs.current&&URL.revokeObjectURL(xs.current),xs.current="",gs.current=null}function Nu(){XN(),Da(!1),Oi({})}function JN(P){ys&&Oi(B=>{const W={...B};return P?W[ys]=P:delete W[ys],W})}function Eu(P){Ye.current=[],zn(),Mi.current=P,je(P);const B=tt.current[P];B!=null&&B.config&&st(Vd(B.config,qi)),_n(!0),D(!1);const W=za();H(W.length?JSON.stringify(W,null,2):"[]")}function ZN(P,B){st(W=>{const ne={...W,[P]:B},J=Mi.current;return J>=0&&tt.current[J]&&(tt.current[J].config=ne),ne})}function tv(P,B,W){const{drawX:ne,drawY:J,scale:ye}=Ii(),we=(P-ne)/ye,Ne=(B-J)/ye;let it=!1;for(let Qe=0,Se=W.length-1;Qe<W.length;Se=Qe++){const Te=W[Qe][0],Me=W[Qe][1],vt=W[Se][0],ct=W[Se][1];Me>Ne!=ct>Ne&&we<(vt-Te)*(Ne-Me)/(ct-Me)+Te&&(it=!it)}return it}function nv(P,B){if(Ye.current.length===4&&tv(P,B,Ye.current))return-1;for(let W=tt.current.length-1;W>=0;W-=1)if(tv(P,B,tt.current[W].points))return W;return null}function sv(P,B){const{drawX:ne,drawY:J,scale:ye}=Ii();if(Ye.current.length>0)for(let we=0;we<Ye.current.length;we+=1){const Ne=ne+Ye.current[we][0]*ye,it=J+Ye.current[we][1]*ye;if(Math.hypot(P-Ne,B-it)<15)return{frame:-1,point:we}}for(let we=0;we<tt.current.length;we+=1){const Ne=tt.current[we].points;for(let it=0;it<Ne.length;it+=1){const Qe=ne+Ne[it][0]*ye,Se=J+Ne[it][1]*ye;if(Math.hypot(P-Qe,B-Se)<15)return{frame:we,point:it}}}return null}function xl(){if(!et.current){Ce("Select one or more locations, upload a billboard photo, then click four corners to define the frame.");return}Ce("Click and drag to draw a box. Use +/Fit to zoom; Shift+drag or middle mouse pans; pinch to zoom.")}function rv(P){P&&zN(P,{resetFrames:!0}).catch(B=>{M((B==null?void 0:B.message)||"Failed to load image")})}function eE(P){if(s!=="setup"||!et.current)return;const B=Df(P);if(!B)return;const{x:W,y:ne}=B,J=un.current;if(P.pointerType==="touch"){const Me=Fa.current;if(Me.pointers.set(P.pointerId,{x:W,y:ne}),Me.pointers.size===2){const[vt,ct]=Array.from(Me.pointers.values()),kn=(vt.x+ct.x)/2,Is=(vt.y+ct.y)/2;Me.isPinching=!0,Me.startDistance=Math.hypot(vt.x-ct.x,vt.y-ct.y),Me.startZoom=tn.current.zoom,Me.startPanX=tn.current.panX,Me.startPanY=tn.current.panY,Me.startCenterX=kn,Me.startCenterY=Is,J.isDrawing=!1,J.isDraggingCorner=!1,J.isDraggingFrame=!1,J.isPanning=!1,gt.current&&(gt.current.style.cursor="grabbing");return}}if(P.button===1||P.shiftKey){P.preventDefault(),J.isPanning=!0,J.shiftPanPending=P.shiftKey&&P.button===0,J.hasPanned=!1,J.panStartX=W,J.panStartY=ne,J.panOriginX=tn.current.panX,J.panOriginY=tn.current.panY,gt.current&&(gt.current.style.cursor="grabbing");return}J.shiftPanPending=!1,J.hasPanned=!1;const{drawX:we,drawY:Ne,drawW:it,drawH:Qe}=Ii(),Se=sv(W,ne);if(Se){un.current.isDraggingCorner=!0,un.current.dragFrameIndex=Se.frame,un.current.dragPointIndex=Se.point,Se.frame>=0?Eu(Se.frame):(ns(),_n(!0)),nt();return}const Te=nv(W,ne);if(Te!==null){un.current.isDraggingFrame=!0,un.current.dragFrameIndex=Te,un.current.startX=W,un.current.startY=ne,Te>=0?Eu(Te):(ns(),_n(!0)),gt.current&&(gt.current.style.cursor="move"),nt();return}W<we||ne<Ne||W>we+it||ne>Ne+Qe||(Fn.current=!1,un.current.isDrawing=!0,un.current.startX=W,un.current.startY=ne,ns())}function tE(P){if(s!=="setup"||!et.current)return;const B=Df(P);if(!B)return;const{x:W,y:ne}=B,J=un.current;if(P.pointerType==="touch"){const Se=Fa.current;if(Se.pointers.has(P.pointerId)&&Se.pointers.set(P.pointerId,{x:W,y:ne}),Se.isPinching&&Se.pointers.size>=2){const[Te,Me]=Array.from(Se.pointers.values()),vt=(Te.x+Me.x)/2,ct=(Te.y+Me.y)/2,kn=Math.hypot(Te.x-Me.x,Te.y-Me.y),{drawX:Is,drawY:Li,scale:Bn}=Ar.current,$f=Se.startZoom;if(Se.startDistance>0&&Bn){const Pu=Jy($f*(kn/Se.startDistance)),xE=(Se.startCenterX-(Is+Se.startPanX))/(Bn*$f),yE=(Se.startCenterY-(Li+Se.startPanY))/(Bn*$f),vE=vt-Is-xE*Bn*Pu,bE=ct-Li-yE*Bn*Pu;tn.current={zoom:Pu,panX:vE,panY:bE},X(Pu),nt()}return}}if(J.isPanning){P.preventDefault();const Se=W-J.panStartX,Te=ne-J.panStartY;if(J.shiftPanPending&&!J.hasPanned){if(Math.hypot(Se,Te)<J3)return;J.hasPanned=!0}tn.current.panX=J.panOriginX+Se,tn.current.panY=J.panOriginY+Te,nt();return}const{drawX:ye,drawY:we,scale:Ne}=Ii();if(J.isDraggingCorner){const Se=(W-ye)/Ne,Te=(ne-we)/Ne;J.dragFrameIndex===-1?Ye.current[J.dragPointIndex]=[Math.round(Se),Math.round(Te)]:tt.current[J.dragFrameIndex].points[J.dragPointIndex]=[Math.round(Se),Math.round(Te)],nt();return}if(J.isDraggingFrame){const Se=(W-J.startX)/Ne,Te=(ne-J.startY)/Ne;J.dragFrameIndex===-1?Ye.current=Ye.current.map(Me=>[Math.round(Me[0]+Se),Math.round(Me[1]+Te)]):tt.current[J.dragFrameIndex].points=tt.current[J.dragFrameIndex].points.map(Me=>[Math.round(Me[0]+Se),Math.round(Me[1]+Te)]),J.startX=W,J.startY=ne,nt();return}if(J.isDrawing){nt();const Se=gt.current.getContext("2d");Se.fillStyle="rgba(128, 128, 128, 0.3)";const Te=W-J.startX,Me=ne-J.startY;Se.fillRect(J.startX,J.startY,Te,Me),Se.strokeStyle="#667eea",Se.lineWidth=1,Se.setLineDash([8,4]),Se.lineCap="butt",Se.lineJoin="miter",Se.strokeRect(J.startX,J.startY,Te,Me),Se.setLineDash([]);return}const it=sv(W,ne),Qe=nv(W,ne);gt.current&&(it?gt.current.style.cursor="pointer":Qe!==null?gt.current.style.cursor="move":gt.current.style.cursor="crosshair")}function nE(P){if(s!=="setup"||!et.current)return;const B=Df(P),W=un.current;if(P.pointerType==="touch"){const ct=Fa.current;if(ct.pointers.has(P.pointerId)&&ct.pointers.delete(P.pointerId),ct.isPinching&&ct.pointers.size<2&&(ct.isPinching=!1),ct.isPinching)return}if(W.isPanning){W.isPanning=!1,gt.current&&(gt.current.style.cursor="crosshair"),W.shiftPanPending&&!W.hasPanned&&Ge&&B&&WN(B.x,B.y),W.shiftPanPending=!1,W.hasPanned=!1;return}if(W.isDraggingCorner){W.isDraggingCorner=!1,W.dragFrameIndex=-1,W.dragPointIndex=-1,gt.current&&(gt.current.style.cursor="crosshair"),zn(),nt();return}if(W.isDraggingFrame){W.isDraggingFrame=!1,W.dragFrameIndex=-1,gt.current&&(gt.current.style.cursor="crosshair"),zn(),nt();return}if(!W.isDrawing||!B)return;const{x:ne,y:J}=B,{drawX:ye,drawY:we,scale:Ne}=Ii(),it=W.startX,Qe=W.startY,Se=(Math.min(it,ne)-ye)/Ne,Te=(Math.min(Qe,J)-we)/Ne,Me=(Math.max(it,ne)-ye)/Ne,vt=(Math.max(Qe,J)-we)/Ne;Ye.current=[[Math.round(Se),Math.round(Te)],[Math.round(Me),Math.round(Te)],[Math.round(Me),Math.round(vt)],[Math.round(Se),Math.round(vt)]],W.isDrawing=!1,zn(),ns(),_n(!0),Ce("Frame drawn. Drag corners to adjust, or drag inside to move. Click Add Frame to save."),nt()}function sE(){st(qi)}function rE(){if(Ye.current.length!==4){M("Select 4 corner points first");return}const P={...Le},B=Fn.current?"greenscreen":"manual";tt.current.push({points:[...Ye.current],config:P,source:B});const W="current";Ye.current=[];const ne=tt.current.length-1;Eu(ne),Fn.current=!1,zn(),Di(),Ce(`Frame ${tt.current.length} added. Draw another box or save when done.`);const J=$n.current.get(W);J&&($n.current.set(`frame-${ne}`,J),$n.current.delete(W));const ye=ju.current[W];ye&&Oi(we=>{const Ne={...we};return Ne[`frame-${ne}`]=ye,delete Ne[W],Ne}),Da(!1),gs.current=null,nt()}function iE(){Ye.current=[],ns(),Fn.current=!1,zn(),$n.current.delete("current"),Oi(P=>{if(!P.current)return P;const B={...P};return delete B.current,B}),Da(!1),gs.current=null,tt.current.length?Ce(`Frames saved: ${tt.current.length}. Draw another box or save all frames.`):xl(),nt()}function iv(P=!1){!P&&!window.confirm("Clear all frames? This will reset your work.")||(tt.current=[],Ye.current=[],ns(),Fn.current=!1,Nu(),zn(),Di(),H("[]"),D(!1),xl(),nt())}function za(){const P=[...tt.current];return Ye.current.length===4&&P.push({points:[...Ye.current],config:{...Le}}),P.map(B=>({points:B.points.map(W=>[W[0],W[1]]),config:B.config}))}function aE(P){if(!P.trim())return[];let B=[];try{B=JSON.parse(P)}catch(W){throw new Error((W==null?void 0:W.message)||"Frames JSON is invalid")}if(!Array.isArray(B))throw new Error("Frames JSON must be an array of frames.");return B.map((W,ne)=>{const J=If((W==null?void 0:W.points)||(W==null?void 0:W.frame_points)||W);if(!J||J.length!==4)throw new Error(`Frame ${ne+1} must include 4 points.`);const ye=J.map(Ne=>{const it=Number(Ne[0]),Qe=Number(Ne[1]);if(!Number.isFinite(it)||!Number.isFinite(Qe))throw new Error(`Frame ${ne+1} has invalid point values.`);return[it,Qe]});let we=W==null?void 0:W.config;if(typeof we=="string")try{we=JSON.parse(we)}catch{we=null}return{points:ye,config:Vd(we,qi),source:"json"}})}function oE(){M("");try{const P=aE(I);tt.current=P,Ye.current=[],Fn.current=!1,Nu(),P.length?Eu(0):ns(),zn(),Di(),D(!1),H(P.length?JSON.stringify(za(),null,2):"[]"),nt()}catch(P){M((P==null?void 0:P.message)||"Frames JSON is invalid")}}function lE(){if(!et.current)return;const P=document.createElement("canvas");P.width=et.current.width,P.height=et.current.height;const B=P.getContext("2d");B.drawImage(et.current,0,0);const W=B.getImageData(0,0,et.current.width,et.current.height),ne=rz(W,{color:be,tolerance:Ke,depthMultiplier:Le.depthMultiplier,existingFrames:tt.current});ne?(Ye.current=ne,ns(),Fn.current=!0,zn(),_n(!0),Ce("Green screen detected. Adjust points or click Add Frame to save."),nt()):Ce("No green screen detected. Adjust tolerance or draw frame manually.")}async function cE(){const P=QN();if(!k||!P||!ys){M("Upload a photo and select or draw a frame first.");return}const B=Yy;if(!B){M("Upload a test creative for the active frame first.");return}if(!ku){M(""),Su(!0);try{const W=new FormData;W.append("billboard_photo",k),W.append("creative",B),W.append("frame_points",JSON.stringify(P.points)),W.append("config",JSON.stringify(P.config)),W.append("time_of_day",u||"day");const ne=await oF(W),J=$n.current.get(ys);J!=null&&J.url&&URL.revokeObjectURL(J.url);const ye=URL.createObjectURL(ne),we=new Image;we.onload=()=>{$n.current.set(ys,{url:ye,img:we}),xs.current=ye,gs.current=we,nt()},we.src=ye}catch(W){M((W==null?void 0:W.message)||"Failed to generate preview")}finally{Su(!1)}}}function uE(){S(null),et.current=null,Ye.current=[],tt.current=[],ns(),Fn.current=!1,ue(!1),Nu(),Lf(!1),zn(),Di(),H("[]"),D(!1),Ce("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),nt()}function dE(P){P.preventDefault(),V(!0)}function hE(P){P.preventDefault(),V(!1)}function fE(P){var W,ne;P.preventDefault(),V(!1);const B=(ne=(W=P.dataTransfer)==null?void 0:W.files)==null?void 0:ne[0];B&&(S(B),rv(B))}function pE(P){P.preventDefault(),q(!0)}function mE(P){P.preventDefault(),q(!1)}function gE(P){var W,ne;P.preventDefault(),q(!1);const B=(ne=(W=P.dataTransfer)==null?void 0:W.files)==null?void 0:ne[0];B&&setCreativeFile(B)}return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Z,{variant:s==="generate"?"default":"ghost",onClick:()=>r("generate"),className:"rounded-2xl",children:"Generate"}),n?c.jsx(Z,{variant:s==="setup"?"default":"ghost",onClick:()=>r("setup"),className:"rounded-2xl",children:"Setup"}):null,c.jsx(Z,{variant:s==="history"?"default":"ghost",onClick:()=>r("history"),className:"rounded-2xl",children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:s==="generate"?"h-full":"hidden","aria-hidden":s!=="generate",children:c.jsx(L3,{locations:i,setLocations:a,venueType:o,setVenueType:l,templateKey:p,setTemplateKey:b,locationOptions:Hy,locationsQuery:Vy,timeOfDay:u,setTimeOfDay:d,timeOfDayDisabled:y,sideDisabled:g,side:h,setSide:f,timeOfDayOptions:zC,sideOptions:BC,venueTypeOptions:UC,templateOptions:qy,templatesQuery:Or,templateThumbs:G,getTemplateKey:sr,defaultFrameConfig:qi,creativeDragActive:O,handleCreativeDragOver:pE,handleCreativeDragLeave:mE,handleCreativeDrop:gE,useNativeSelects:Q0})}),s==="setup"?c.jsx("div",{className:"h-full",children:c.jsx(W3,{locations:i,setLocations:a,venueType:o,setVenueType:l,setTemplateKey:b,locationOptions:Hy,locationsQuery:Vy,timeOfDay:u,setTimeOfDay:d,timeOfDayDisabled:y,sideDisabled:g,side:h,setSide:f,timeOfDayOptions:K3,sideOptions:G3,venueTypeOptions:Y3,editingTemplate:C,editingTemplateLoading:K,stopEditTemplate:Xy,templatesOpen:re,setTemplatesOpen:_e,templateOptions:Ky,templatesQuery:Mf,templateThumbs:G,getTemplateKey:sr,startEditTemplate:UN,deleteTemplate:$N,setupPhoto:k,setSetupPhoto:S,handleSetupPhoto:rv,handleSetupDragOver:dE,handleSetupDragLeave:hE,handleSetupDrop:fE,setupDragActive:ie,handleSetupPhotoClear:uE,framesJson:I,setFramesJson:H,setFramesJsonDirty:D,applyFramesJsonToCanvas:oE,buildFramesPayload:za,setupImageReady:$e,greenscreenOpen:Ge,setGreenscreenOpen:mt,greenscreenColor:be,setGreenscreenColor:he,colorTolerance:Ke,setColorTolerance:ee,RangeField:jn,handleGreenscreenDetect:lE,canDetectGreenscreen:MN,hasActiveFrame:IN,frameSettingsOpen:Lt,setFrameSettingsOpen:_n,setupFrameConfig:Le,handleSetupFrameConfigChange:ZN,FrameConfigControls:nz,previewOpen:Of,setPreviewOpen:Tf,testPreviewMode:Ai,setTestPreviewMode:Da,testPreviewImgRef:gs,testPreviewUrlRef:xs,previewImgRef:et,drawPreview:nt,activeTestCreativeFile:Yy,updateTestCreativeForActive:JN,generateTestPreview:cE,testPreviewing:ku,activeFrameIndex:me,canvasRef:gt,canvasWidth:ud,canvasHeight:dd,handleCanvasPointerDown:eE,handleCanvasPointerMove:tE,handleCanvasPointerUp:nE,handleCanvasWheel:HN,setupHint:ae,handleZoomOut:qN,handleZoomIn:VN,handleFitToScreen:KN,zoomPercent:DN,pixelUpscale:$,setPixelUpscale:ce,setupError:z,setupMessage:T,addFrame:rE,resetCurrentFrame:iE,saveSetup:LN,setupSaving:j,clearAllFrames:iv,currentPoints:de,frameCount:Y,useNativeSelects:Q0})}):null,c.jsx("div",{className:s==="history"?"h-full":"hidden","aria-hidden":s!=="history",children:c.jsx(V3,{enabled:TN})})]})]})})}function nz({config:t,onChange:e}){return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(jn,{label:"Brightness",value:t.brightness,min:50,max:200,suffix:"%",onChange:n=>e("brightness",n)}),c.jsx(jn,{label:"Contrast",value:t.contrast,min:50,max:200,suffix:"%",onChange:n=>e("contrast",n)}),c.jsx(jn,{label:"Saturation",value:t.saturation,min:0,max:200,suffix:"%",onChange:n=>e("saturation",n)}),c.jsx(jn,{label:"Image Blur",value:t.imageBlur,min:0,max:20,onChange:n=>e("imageBlur",n),helper:"Blur entire creative (0 = off)."}),c.jsx(jn,{label:"Edge Blur",value:t.edgeBlur,min:1,max:20,suffix:"px",onChange:n=>e("edgeBlur",n),helper:"Edge blur amount (1 = off)."}),c.jsx(jn,{label:"Overlay Opacity",value:t.overlayOpacity,min:0,max:50,suffix:"%",onChange:n=>e("overlayOpacity",n),helper:"Billboard overlay strength."}),c.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(sz,{value:t.lightDirection,onChange:n=>e("lightDirection",n)}),c.jsx(jn,{label:"Depth Perception",value:t.depthMultiplier,min:5,max:30,suffix:"x",onChange:n=>e("depthMultiplier",n),helper:"Perspective compensation."})]}),c.jsx(jn,{label:"Shadow Intensity",value:t.shadowIntensity,min:0,max:100,suffix:"%",onChange:n=>e("shadowIntensity",n),helper:"Edge darkening."}),c.jsx(jn,{label:"Lighting Match",value:t.lightingAdjustment,min:-50,max:50,suffix:"%",onChange:n=>e("lightingAdjustment",n),helper:"Brightness matching."}),c.jsx(jn,{label:"Color Temperature",value:t.colorTemperature,min:-50,max:50,onChange:n=>e("colorTemperature",n),helper:"Warm/cool shift."}),c.jsx(jn,{label:"Vignette",value:t.vignette,min:0,max:100,suffix:"%",onChange:n=>e("vignette",n),helper:"Corner darkening."}),c.jsx(jn,{label:"Edge Smoother",value:t.edgeSmoother,min:1,max:20,suffix:"x",onChange:n=>e("edgeSmoother",n),helper:"Higher = softer edges."}),c.jsx(jn,{label:"Sharpening",value:t.sharpening,min:0,max:100,suffix:"%",onChange:n=>e("sharpening",n),helper:"Unsharp mask strength (0 = off)."})]})}function sz({value:t,onChange:e}){return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:["Light Direction: ",Z3[t]||"Top"]}),c.jsx("div",{className:"grid grid-cols-3 gap-2 w-[150px]",children:WC.map(n=>c.jsx("button",{type:"button",onClick:()=>e(n.value),className:`rounded-lg border px-2 py-2 text-sm font-semibold ${t===n.value?"border-black/40 dark:border-white/50 bg-black/5 dark:bg-white/15 text-black dark:text-white":"border-black/10 dark:border-white/20 bg-white/80 dark:bg-black/40 text-black/70 dark:text-white/80"}`,title:n.label,children:n.glyph},n.value))})]})}function jn({label:t,value:e,min:n,max:s,step:r=1,suffix:i="",helper:a,onChange:o}){return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:[t,": ",e,i]}),c.jsx("input",{type:"range",min:n,max:s,step:r,value:e,onChange:l=>o(Number(l.target.value)),style:{background:ez(e,n,s)},className:"w-full accent-black"}),a?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:a}):null]})}function sr(t){return`${t.storage_key||""}::${t.photo}::${t.time_of_day||"all"}::${t.side||"all"}`}function rz(t,{color:e,tolerance:n,depthMultiplier:s,existingFrames:r}){const i=t.data,a=t.width,o=t.height,l=parseInt(e.slice(1,3),16),u=parseInt(e.slice(3,5),16),d=parseInt(e.slice(5,7),16),h=n,f=new Uint8Array(a*o);r.forEach(I=>{const H=I.points;for(let L=0;L<o;L+=1)for(let D=0;D<a;D+=1)iz(D,L,H)&&(f[L*a+D]=1)});const p=new Uint8Array(a*o);let b=0;for(let I=0;I<o;I+=1)for(let H=0;H<a;H+=1){const L=I*a+H;if(f[L]===1)continue;const D=L*4,G=i[D],E=i[D+1],C=i[D+2];Math.sqrt((G-l)**2+(E-u)**2+(C-d)**2)<=h&&(p[L]=255,b+=1)}if(b<1e3)return null;const x=new Uint8Array(a*o),v=3;for(let I=0;I<o;I+=1)for(let H=0;H<a;H+=1){const L=I*a+H;let D=!1;for(let G=-v;G<=v;G+=1){for(let E=-v;E<=v;E+=1){const C=I+G,F=H+E;if(C>=0&&C<o&&F>=0&&F<a&&p[C*a+F]===255){D=!0;break}}if(D)break}x[L]=D?255:0}const y=[];for(let I=1;I<o-1;I+=1)for(let H=1;H<a-1;H+=1){const L=I*a+H;x[L]===0&&(x[L-1]===255||x[L+1]===255||x[L-a]===255||x[L+a]===255||x[L-a-1]===255||x[L-a+1]===255||x[L+a-1]===255||x[L+a+1]===255)&&y.push([H,I])}if(y.length<4)return null;let g=y[0],w=y[0],_=y[0],k=y[0];y.forEach(I=>{const[H,L]=I;H+L<g[0]+g[1]&&(g=I),H-L>w[0]-w[1]&&(w=I),H+L>_[0]+_[1]&&(_=I),H-L<k[0]-k[1]&&(k=I)});const S=Math.abs(w[0]-g[0]),j=Math.abs(_[0]-k[0]),N=Math.abs(k[1]-g[1]),T=Math.abs(_[1]-w[1]),A=S/j,z=N/T,M=s||qi.depthMultiplier;if(A>1.1){const I=Math.floor((A-1)*M);k=[k[0],Math.min(o-1,k[1]+I)],_=[_[0],Math.min(o-1,_[1]+I)]}else if(A<.9){const I=Math.floor((1/A-1)*M);g=[g[0],Math.max(0,g[1]-I)],w=[w[0],Math.max(0,w[1]-I)]}if(z>1.1){const I=Math.floor((z-1)*M);w=[Math.min(a-1,w[0]+I),w[1]],_=[Math.min(a-1,_[0]+I),_[1]]}else if(z<.9){const I=Math.floor((1/z-1)*M);g=[Math.max(0,g[0]-I),g[1]],k=[Math.max(0,k[0]-I),k[1]]}return[g,w,_,k]}function iz(t,e,n){let s=!1;for(let r=0,i=n.length-1;r<n.length;i=r++){const a=n[r][0],o=n[r][1],l=n[i][0],u=n[i][1];o>e!=u>e&&t<(l-a)*(e-o)/(u-o)+a&&(s=!s)}return s}function az(t){if(!t)return"";const e=String(t).trim();if(!e)return"";if(e.includes("/"))return e;const n=e.split("-");if(n.length===3){const[s,r,i]=n;if(s&&r&&i)return`${i}/${r}/${s}`}return e}function J0(t){const e=Number.parseInt(t,10),n=Number.isFinite(e)&&e>0?e:1;return`${n} ${n===1?"Week":"Weeks"}`}function hd(t,e){const n=e;if(t==null||t==="")return`${n} 0`;const s=typeof t=="string"?t.trim():t;if(typeof s=="string"&&s.toUpperCase().startsWith(n))return s;const r=typeof s=="number"?s:Number.parseFloat(String(s).replace(/,/g,""));return Number.isFinite(r)?`${n} ${r.toLocaleString()}`:`${n} 0`}function Z0(t){if(t==null)return 0;const e=Number.parseFloat(String(t).replace(/[^\d.-]/g,""));return Number.isFinite(e)?e:0}function oz(){const t=er(),[e,n]=m.useState(""),s=()=>({id:crypto.randomUUID(),startDate:"",duration:"",netRate:""}),r=()=>({id:crypto.randomUUID(),location:"",spots:"1",productionFee:"",periods:[s()]}),[i,a]=m.useState(()=>[r()]),[o,l]=m.useState("separate"),[u,d]=m.useState(""),[h,f]=m.useState("AED"),[p,b]=m.useState("100% upfront"),[x,v]=m.useState([]),[y,g]=m.useState({}),w=on({queryKey:["locations","proposals"],queryFn:()=>AC({service:"proposals"})}),_=m.useMemo(()=>{const L=w.data;return Array.isArray(L)?L:(L==null?void 0:L.locations)||(L==null?void 0:L.data)||[]},[w.data]),k=m.useMemo(()=>Array.from(new Set(i.map(L=>L.location).filter(Boolean))),[i]);m.useEffect(()=>{if(!k.length)return;const L=k.filter(G=>!y[G]);if(!L.length)return;let D=!0;return(async()=>{const G=await Promise.all(L.map(async E=>{try{const C=await fF(E);return[E,C]}catch{return[E,null]}}));D&&g(E=>{const C={...E};return G.forEach(([F,K])=>{K&&(C[F]=K)}),C})})(),()=>{D=!1}},[k,y]);const S=RA({mutationFn:L=>pF(L),onSuccess:()=>{t.invalidateQueries({queryKey:["proposals","history"]})}});function j(L,D,G){a(E=>E.map(C=>C.id===L?{...C,[D]:G}:C))}function N(L,D,G,E){a(C=>C.map(F=>F.id!==L?F:{...F,periods:F.periods.map(K=>K.id===D?{...K,[G]:E}:K)}))}function T(){a(L=>[...L,r()])}function A(L){a(D=>D.length>1?D.filter(G=>G.id!==L):D)}function z(L){a(D=>D.map(G=>G.id===L?{...G,periods:[...G.periods,s()]}:G))}function M(L,D){a(G=>G.map(E=>E.id!==L||E.periods.length<=1?E:{...E,periods:E.periods.filter(C=>C.id!==D)}))}function I(){const L=h||"AED",D=hd(u,L),G=i.filter(U=>U.location),E=G.map(U=>{const ie=U.periods.filter(Y=>Y.startDate||Y.duration||Y.netRate),V=o==="combined"?[ie[0]||U.periods[0]]:ie,O=V.map(Y=>az((Y==null?void 0:Y.startDate)||"")),q=V.map(Y=>J0(Y==null?void 0:Y.duration)),ae=V.map(Y=>hd(Y==null?void 0:Y.netRate,L)),Ce=Number.parseInt(U.spots,10),Le=Number.isFinite(Ce)&&Ce>0?Ce:1,st=y[U.location]||{},be=st.location||st,he=(be.display_type||be.displayType||"").toLowerCase()==="static",Ke=be.upload_fee??be.uploadFee??0,ee=be.production_fee??be.productionFee??0,de=U.productionFee,le={location:U.location||"",upload_fee:hd(Ke,L),spots:Le};return he&&(le.production_fee=hd(de!==""&&de!==null&&de!==void 0?de:ee,L)),o==="combined"?(le.start_date=O[0]||"",le.duration=q[0]||J0(1)):(le.start_dates=O,le.durations=q,le.net_rates=ae),le}),C=G.map(U=>{const ie=_.find(V=>(V.location_key||V.key||V.id)===U.location);return(ie==null?void 0:ie.display_name)||(ie==null?void 0:ie.name)||(ie==null?void 0:ie.label)||U.location}).filter(Boolean).join(", "),F={proposals:E,client_name:e,proposal_type:o,payment_terms:p||"100% upfront",currency:L};o==="combined"&&(F.combined_net_rate=D);const K={client:e,packageType:o,items:E.map(U=>({location:U.location,netRatesValue:Array.isArray(U.net_rates)?U.net_rates.map(Z0):[]})),combinedNetRateValue:o==="combined"?Z0(D):0,locationsLabel:C,currency:L,paymentTerms:p||"100% upfront"};S.mutate(F,{onSuccess:U=>{v(ie=>[{data:U,meta:K},...ie].slice(0,3))}})}function H(){n(""),a([r()]),l("separate"),d(""),f("AED"),b("100% upfront")}return{client:e,setClient:n,items:i,updateItem:j,addItem:T,removeItem:A,addPeriod:z,removePeriod:M,updatePeriod:N,packageType:o,setPackageType:l,combinedNetRate:u,setCombinedNetRate:d,currency:h,setCurrency:f,paymentTerms:p,setPaymentTerms:b,lastResults:x,locationsQuery:w,locationOptions:_,generateMutation:S,handleGenerate:I,resetForm:H}}function lz(){const t=oz();return c.jsx(cz,{...t})}function cz({client:t,setClient:e,items:n,updateItem:s,addItem:r,removeItem:i,addPeriod:a,removePeriod:o,updatePeriod:l,packageType:u,setPackageType:d,combinedNetRate:h,setCombinedNetRate:f,currency:p,setCurrency:b,paymentTerms:x,setPaymentTerms:v,lastResults:y,locationsQuery:g,locationOptions:w,generateMutation:_,handleGenerate:k,resetForm:S}){var M;const j=Array.isArray(y)?y:[],N=_.isPending,T=m.useMemo(()=>{const I=w.map(H=>{const L=H.location_key||H.key||H.id||"",D=H.display_name||H.name||H.label||L||"";return{value:L,label:D}}).filter(H=>H.value);return[{value:"",label:"Select a location"},...I]},[w]),A=m.useMemo(()=>[{value:"separate",label:"Separate"},{value:"combined",label:"Combined"}],[]),z=m.useMemo(()=>[{value:"AED",label:"AED"},{value:"EUR",label:"EUR"},{value:"USD",label:"USD"},{value:"GBP",label:"GBP"}],[]);return c.jsxs(lt,{className:"h-full flex flex-col",children:[c.jsx(Et,{className:"flex flex-row items-center justify-between",children:c.jsx(At,{children:"Generate Proposal"})}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Client",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:t,onChange:I=>e(I.target.value),placeholder:"Client name"})}),c.jsx(xe,{label:"Package Type",children:c.jsx(qe,{value:u,options:A,onChange:d})})]}),u==="combined"?c.jsx(xe,{label:"Combined Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:h,onChange:I=>f(I.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Locations"}),g.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(De,{text:"Loading locations"})}):null]}),c.jsx(Z,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:r,children:"Add Location"})]}),c.jsx("div",{className:"space-y-3",children:n.map(I=>{var D,G;const H=w.find(E=>(E.location_key||E.key||E.id)===I.location),L=((H==null?void 0:H.display_type)||"").toLowerCase()==="static";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[u==="combined"?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1.4fr_0.6fr_0.9fr_0.7fr_auto] gap-2 items-end",children:[c.jsx(xe,{label:"Location",children:c.jsx(qe,{value:I.location,options:T,onChange:E=>s(I.id,"location",E)})}),c.jsx(xe,{label:"Spots",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:I.spots,onChange:E=>s(I.id,"spots",E.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(xe,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((D=I.periods[0])==null?void 0:D.startDate)||"",onChange:E=>{var C;return l(I.id,(C=I.periods[0])==null?void 0:C.id,"startDate",E.target.value)},type:"date"})}),c.jsx(xe,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((G=I.periods[0])==null?void 0:G.duration)||"",onChange:E=>{var C;return l(I.id,(C=I.periods[0])==null?void 0:C.id,"duration",E.target.value)},type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(I.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ma,{size:16})})]}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 items-end",children:[c.jsx(xe,{label:"Location",children:c.jsx(qe,{value:I.location,options:T,onChange:E=>s(I.id,"location",E)})}),c.jsxs("div",{className:"flex items-end justify-between gap-2",children:[c.jsx(xe,{label:"Spots",className:"flex-1",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:I.spots,onChange:E=>s(I.id,"spots",E.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(I.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ma,{size:16})})]})]}),L?c.jsx(xe,{label:"Production Fee",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:I.productionFee,onChange:E=>s(I.id,"productionFee",E.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,u!=="combined"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/60",children:"Line Items"}),c.jsx(Z,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>a(I.id),children:"Add Line Item"})]}),c.jsx("div",{className:"space-y-2",children:I.periods.map(E=>c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_1fr_1fr_auto] gap-2 items-end",children:[c.jsx(xe,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.startDate,onChange:C=>l(I.id,E.id,"startDate",C.target.value),type:"date"})}),c.jsx(xe,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.duration,onChange:C=>l(I.id,E.id,"duration",C.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(xe,{label:"Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.netRate,onChange:C=>l(I.id,E.id,"netRate",C.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}),c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>o(I.id,E.id),disabled:I.periods.length===1,title:"Remove dates",children:c.jsx(ma,{size:16})})]},E.id))})]}):null]},I.id)})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Currency",children:c.jsx(qe,{value:p,options:z,onChange:b})}),c.jsx(xe,{label:"Payment Terms",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:x,onChange:I=>v(I.target.value),placeholder:"Payment terms"})})]}),_.isError?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:((M=_.error)==null?void 0:M.message)||"Generation failed"}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Z,{className:"rounded-2xl",onClick:k,disabled:N,children:N?c.jsx(De,{text:"Generating Proposal"}):"Generate Proposal"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl",onClick:S,disabled:N,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 space-y-3",children:[!j.length&&!N?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,N?c.jsx(De,{text:"Processing proposal",className:"text-sm text-black/60 dark:text-white/65"}):null,j.length?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Proposals"}),c.jsx("div",{className:"space-y-4",children:j.map((I,H)=>{const L=(I==null?void 0:I.data)||null,D=(I==null?void 0:I.meta)||null,G=[];L!=null&&L.pptx_url&&G.push({url:L.pptx_url,type:"pptx"}),L!=null&&L.pdf_url&&G.push({url:L.pdf_url,type:"pdf"});const E=(L==null?void 0:L.locations)||(D==null?void 0:D.locationsLabel)||"",C=(D==null?void 0:D.packageType)==="combined"?D==null?void 0:D.combinedNetRateValue:((D==null?void 0:D.items)||[]).reduce((K,U)=>{const ie=Array.isArray(U.netRatesValue)?U.netRatesValue:[];return K+ie.reduce((V,O)=>V+(O||0),0)},0),F=Number.isFinite(C)?`${(D==null?void 0:D.currency)||"AED"} ${Number(C).toLocaleString()}`:"";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Client"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(D==null?void 0:D.client)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Package"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(D==null?void 0:D.packageType)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 sm:col-span-2",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Locations"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:E})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Total Amount"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:F})]})]}),G.length?c.jsx("div",{className:"space-y-2",children:G.map(K=>{const U=uz(K.url),ie=dz(U),V=K.type==="pdf"?"proposal.pdf":"proposal.pptx",O=ie||V,q=K.type==="pdf";return c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:q?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(ny,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:"PPTX"})}),c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:O})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:U,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(_i,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(Z,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:ae=>{ae.preventDefault(),ew(U,O)},onKeyDown:ae=>{(ae.key==="Enter"||ae.key===" ")&&(ae.preventDefault(),ew(U,O))},className:"inline-flex items-center",children:[c.jsx(Sa,{size:14,className:"mr-1"}),"Download"]})})]})]})},`${K.type}-${K.url}`)})}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No files returned yet."})]},`proposal-output-${H}`)})})]}):null]})]})]})}function uz(t){return t?t.startsWith("http")?t:`${Oa.API_BASE_URL}${t}`:""}function dz(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function ew(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function Ia({className:t,placeholder:e="Search...",...n}){return c.jsx("input",{type:"text",placeholder:e,className:ve("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",t),...n})}function hz(){const{user:t}=jr(),[e,n]=m.useState({}),[s,r]=m.useState(!1),i=on({queryKey:["proposals","history"],queryFn:mF}),a=m.useMemo(()=>{var h;return Array.isArray(i.data)?i.data:(h=i.data)!=null&&h.proposals?i.data.proposals:i.data||[]},[i.data]),o=m.useMemo(()=>hu(t),[t]),l=m.useMemo(()=>{const h=a||[];if(o)return h;const f=(t==null?void 0:t.id)||(t==null?void 0:t.user_id)||(t==null?void 0:t.email)||"";return f?h.filter(p=>(p.submitted_by||p.user_id||"")===f):h},[a,o,t==null?void 0:t.id,t==null?void 0:t.user_id,t==null?void 0:t.email]),u=m.useMemo(()=>{const h=new Set;return(l||[]).forEach(f=>{const p=f.submitted_by||f.user_id;p&&h.add(p)}),Array.from(h)},[l]),d=m.useMemo(()=>u.filter(h=>!e[h]),[u,e]);return m.useEffect(()=>{if(!d.length)return;r(!0);let h=!0;return(async()=>{const f=await Promise.all(d.map(async p=>{var b,x;try{const v=await xF(p),y=(v==null?void 0:v.name)||((b=v==null?void 0:v.user)==null?void 0:b.name)||((x=v==null?void 0:v.profile)==null?void 0:x.name)||p;return[p,y]}catch{return[p,p]}}));h&&(n(p=>{const b={...p};return f.forEach(([x,v])=>{b[x]||(b[x]=v)}),b}),r(!1))})(),()=>{h=!1}},[d]),m.useEffect(()=>{d.length||r(!1)},[d.length]),{historyQuery:i,userNamesLoading:s,visibleProposals:l,userNameById:e}}function fz(){const t=hz();return c.jsx(pz,{...t})}function pz({historyQuery:t,userNamesLoading:e,visibleProposals:n,userNameById:s}){const[r,i]=m.useState(""),[a,o]=m.useState(""),[l,u]=m.useState(""),d=m.useMemo(()=>(n||[]).map((v,y)=>{var A;const g=v.client_name||v.client||"Proposal",w=v.submitted_by||v.user_id||"",_=w?s[w]||w:"",k=v.date_generated||v.created_at,S=v.package_type||"",j=v.locations||((A=v.proposal_data)==null?void 0:A.locations_text)||v.location||"",N=v.total_amount||(v.total_amount_value!=null?`${v.currency||""} ${Number(v.total_amount_value).toLocaleString()}`:""),T=[];return v.pptx_url&&T.push({url:v.pptx_url,type:"pptx"}),v.pdf_url&&T.push({url:v.pdf_url,type:"pdf"}),!T.length&&v.file_url&&T.push({url:v.file_url,type:"pdf"}),{id:v.id||v.file_url||y,clientName:g,userName:_,generatedAt:k,packageType:S,locationText:j,totalAmount:N,fileEntries:T}}),[n,s]),h=m.useMemo(()=>{const v=new Set;return d.forEach(y=>{y.packageType&&y.packageType!==""&&v.add(y.packageType)}),Array.from(v)},[d]),f=m.useMemo(()=>{const v=new Set;return d.forEach(y=>{!y.locationText||y.locationText===""||y.locationText.split(",").forEach(g=>{const w=g.trim();w&&v.add(w)})}),Array.from(v)},[d]),p=m.useMemo(()=>[{value:"",label:"All packages"},...h.map(v=>({value:v,label:v}))],[h]),b=m.useMemo(()=>[{value:"",label:"All locations"},...f.map(v=>({value:v,label:v}))],[f]),x=m.useMemo(()=>{const v=l.trim().toLowerCase();return d.filter(y=>!(r&&y.packageType!==r||a&&!(y.locationText||"").split(",").map(w=>w.trim()).filter(Boolean).includes(a)||v&&!`${y.clientName} ${y.locationText}`.toLowerCase().includes(v)))},[d,r,a,l]);return c.jsxs(lt,{className:"h-full flex flex-col",children:[c.jsx(Et,{className:"space-y-2",children:c.jsx(At,{children:"History"})}),c.jsx(Pt,{className:"flex-1 min-h-0 flex flex-col",children:t.isLoading||e?c.jsx(De,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):n!=null&&n.length?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Ia,{value:l,onChange:v=>u(v.target.value),className:"w-full sm:w-[260px]",placeholder:"Search..."}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(qe,{value:r,options:p,onChange:i,className:"sm:w-[200px]"}),c.jsx(qe,{value:a,options:b,onChange:o,className:"sm:w-[220px]"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full min-w-0 overflow-hidden",children:c.jsx("div",{className:"h-full w-full min-w-0 overflow-auto",children:c.jsxs("table",{className:"min-w-[760px] w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Client"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Locations"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Amount"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"User"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Generated"}),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:(x||[]).map(v=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[c.jsx("td",{className:"px-4 py-3 font-semibold",children:v.clientName}),c.jsx("td",{className:"px-4 py-3",children:v.locationText}),c.jsx("td",{className:"px-4 py-3",children:v.totalAmount}),c.jsx("td",{className:"px-4 py-3",children:v.userName}),c.jsx("td",{className:"px-4 py-3",children:v.generatedAt?new Date(v.generatedAt).toLocaleString():""}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:v.fileEntries.length?c.jsx("div",{className:"flex flex-col gap-2",children:v.fileEntries.map(y=>{const g=mz(y.url),w=gz(g),_=y.type==="pdf"?"proposal.pdf":"proposal.pptx",k=w||_;return c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wide text-black/50 dark:text-white/60",children:y.type}),c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(_i,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(Z,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:S=>{S.preventDefault(),tw(g,k)},onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&(S.preventDefault(),tw(g,k))},className:"inline-flex items-center",children:[c.jsx(Sa,{size:14,className:"mr-1"}),"Download"]})})]},`${y.type}-${y.url}`)})}):c.jsx("span",{className:"text-xs text-black/50 dark:text-white/55",children:""})})]},v.id))})]})})}),x.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No matching proposals."})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No proposals yet."})})]})}function mz(t){return t?t.startsWith("http")?t:`${Oa.API_BASE_URL}${t}`:""}function gz(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function tw(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function xz(){const[t,e]=m.useState("generate");return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Z,{variant:t==="generate"?"default":"ghost",onClick:()=>e("generate"),className:"rounded-2xl",children:"Generate"}),c.jsx(Z,{variant:t==="history"?"default":"ghost",onClick:()=>e("history"),className:"rounded-2xl",children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="generate"?"h-full":"hidden","aria-hidden":t!=="generate",children:c.jsx(lz,{})}),c.jsx("div",{className:t==="history"?"h-full":"hidden","aria-hidden":t!=="history",children:c.jsx(fz,{})})]})]})})}function HC(t){return t?typeof t=="string"?t:t.name||t.id||t.value||"":""}function VC(t){return t?typeof t=="string"?t:t.name||t.value||t.permission||"":""}function zp(t,e){if(!t||!e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function yz(t){const e=new Map;return(t||[]).forEach(n=>{const s=HC(n);if(!s)return;const r=(n.permissions||n.permission_list||n.permissionList||[]).map(VC).filter(Boolean);e.set(s,new Set(r))}),e}function vz(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permission_sets||n.permissionSets||n.permission_set_names||[]).map(HC).filter(Boolean);e.set(s,new Set(r))}),e}function bz(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permissions||[]).map(VC).filter(Boolean);e.set(s,new Set(r))}),e}function wz({q:t,setQ:e,openNewUserModal:n,usersQuery:s,users:r,user:i,selectUser:a,setConfirmDelete:o,companyLookup:l,userCompanyFilter:u,setUserCompanyFilter:d,userProfileFilter:h,setUserProfileFilter:f,companyFilterOptions:p,profileFilterOptions:b}){const x=m.useMemo(()=>[{value:"",label:"All companies"},...p.map(g=>({...g}))],[p]),v=m.useMemo(()=>[{value:"",label:"All profiles"},...b.map(g=>({...g}))],[b]),y=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(At,{children:"Users"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(Ia,{value:t,onChange:g=>e(g.target.value),className:"w-full sm:w-[220px]"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:n,children:"Add user"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(qe,{value:u,options:x,onChange:d}),c.jsx(qe,{value:h,options:v,onChange:f})]})]});return c.jsxs(lt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Et,{className:"hidden md:block space-y-2",children:y}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:y}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(De,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(g=>{var A,z,M,I;const w=Array.isArray(g.profiles)?g.profiles.map(H=>(H==null?void 0:H.display_name)||(H==null?void 0:H.name)||H).filter(Boolean):[((A=g.profiles)==null?void 0:A.display_name)||((z=g.profiles)==null?void 0:z.name)||g.profile||g.profile_name].filter(Boolean),_=w.length?w.length>2?`${w[0]}, +${w.length-1}`:w.join(", "):"",k=!!(g.id&&(i!=null&&i.id)&&g.id===i.id||g.user_id&&(i!=null&&i.user_id)&&g.user_id===i.user_id||g.email&&(i!=null&&i.email)&&g.email===i.email),S=g.is_active??g.isActive??g.active,j=typeof S=="boolean",N=j?S:!0,T=N?"Deactivate":"Reactivate";return c.jsxs(yt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("div",{className:"text-base font-semibold",children:g.name||""}),j&&!N?c.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-semibold text-red-700 dark:bg-red-500/20 dark:text-red-200",children:"Inactive"}):null]}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:g.email})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ln,{onClick:()=>a(g),title:"Edit user","aria-label":"Edit user",children:c.jsx(uu,{size:16})}),c.jsx(ln,{variant:"ghost",onClick:()=>o({open:!0,type:"user",payload:{id:g.id||g.user_id,isActive:N},label:`${T} user "${g.email}"?`}),disabled:k,title:k?"You cannot deactivate yourself":`${T} user`,"aria-label":`${T} user`,className:N?void 0:"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300",children:N?c.jsx(KA,{size:16}):c.jsx(qA,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Profiles: ",c.jsx("span",{className:"font-semibold",children:_})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Company:"," ",c.jsx("span",{className:"font-semibold",children:((M=g.company)==null?void 0:M.name)||l.get(((I=g.company)==null?void 0:I.code)||g.company_code||g.company_id)||""})]})]},g.id||g.user_id||g.email)})})})]})]})}function _z({q:t,setQ:e,usersQuery:n,users:s,user:r,companyLookup:i,userCompanyFilter:a,setUserCompanyFilter:o,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h,companyList:f,profileOptions:p,profileValues:b,permissionSetList:x,permissionSetValues:v,permissionList:y,permissionsQuery:g,page:w}){const{selectedUser:_,setSelectedUser:k,userForm:S,setUserForm:j,userModalOpen:N,setUserModalOpen:T,userModalLoading:A,setUserModalLoading:z,userModalMode:M,setUserModalMode:I,userProfilesOpen:H,setUserProfilesOpen:L,userPermissionSetsOpen:D,setUserPermissionSetsOpen:G,userPermissionsOpen:E,setUserPermissionsOpen:C,savingUser:F,setPermissionsMessage:K,selectUser:U,openNewUserModal:ie,saveUser:V,deleteUser:O,selectedUserProfiles:q,selectedUserPermissionSets:ae,selectedUserPermissions:Ce,selectedUserPermissionSet:Le,customUserPermissions:st,toggleUserPermission:be,selectAllUserPermissions:he,clearUserPermissions:Ke,toggleUserProfile:ee,selectAllUserProfiles:de,clearUserProfiles:le,toggleUserPermissionSet:Y,selectAllUserPermissionSets:Q,clearUserPermissionSets:oe}=kz({permissionList:y,profileValues:b,permissionSetValues:v,profileOptions:p,permissionSetList:x}),[X,$]=m.useState({open:!1,type:"",payload:null,label:""}),ce=!!(_&&(_.id&&(r!=null&&r.id)&&_.id===(r==null?void 0:r.id)||_.user_id&&(r!=null&&r.user_id)&&_.user_id===(r==null?void 0:r.user_id)||_.email&&(r!=null&&r.email)&&_.email===(r==null?void 0:r.email)));m.useEffect(()=>{k(null)},[w,k]);async function me(){if(!(!X.open||!X.payload))try{const je=X.payload,$e=(je==null?void 0:je.id)??je;if(!$e||r!=null&&r.id&&$e===r.id||r!=null&&r.user_id&&$e===r.user_id)return;await O(je)}finally{$({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(wz,{q:t,setQ:e,openNewUserModal:ie,usersQuery:n,users:s,user:r,selectUser:U,setConfirmDelete:$,companyLookup:i,userCompanyFilter:a,setUserCompanyFilter:o,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h}),c.jsx(Sz,{open:N,onClose:()=>{T(!1),k(null),K(""),z(!1),I("edit"),L(!1),G(!1),C(!1)},userModalLoading:A,userModalMode:M,selectedUser:_,userForm:S,setUserForm:j,companyList:f,profileOptions:p,profileValues:b,userProfilesOpen:H,setUserProfilesOpen:L,selectAllUserProfiles:de,clearUserProfiles:le,selectedUserProfiles:q,toggleUserProfile:ee,permissionSetList:x,permissionSetValues:v,userPermissionSetsOpen:D,setUserPermissionSetsOpen:G,selectAllUserPermissionSets:Q,clearUserPermissionSets:oe,selectedUserPermissionSets:ae,toggleUserPermissionSet:Y,userPermissionsOpen:E,setUserPermissionsOpen:C,selectedUserPermissions:Ce,permissionList:y,permissionsQuery:g,selectedUserPermissionSet:Le,toggleUserPermission:be,selectAllUserPermissions:he,clearUserPermissions:Ke,customUserPermissions:st,isSelfUser:ce,setConfirmDelete:$,saveUser:V,savingUser:F}),c.jsx(bu,{open:X.open,message:X.label,onClose:()=>$({open:!1,type:"",payload:null,label:""}),onConfirm:me})]})}function kz({permissionList:t,profileValues:e,permissionSetValues:n,profileOptions:s,permissionSetList:r}){const i=er(),[a,o]=m.useState(null),[l,u]=m.useState({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),[d,h]=m.useState(!1),[f,p]=m.useState(!1),[b,x]=m.useState("edit"),[v,y]=m.useState(!1),[g,w]=m.useState(!1),[_,k]=m.useState(!1),[S,j]=m.useState(!1),[N,T]=m.useState(""),A=m.useMemo(()=>new Set(l.profiles||[]),[l.profiles]),z=m.useMemo(()=>new Set(l.permissionSets||[]),[l.permissionSets]),M=m.useMemo(()=>Xt(l.permissionsText),[l.permissionsText]),I=m.useMemo(()=>new Set(M),[M]),H=m.useMemo(()=>{if(!t.length)return M;const ee=new Set(t);return M.filter(de=>!ee.has(de))},[t,M]),L=m.useMemo(()=>yz(r),[r]),D=m.useMemo(()=>vz(s),[s]),G=m.useMemo(()=>bz(s),[s]);function E(ee,de,le){return(ee||[]).filter(Y=>{const Q=de.get(Y);return Q?zp(Q,le):!0})}function C(ee,de,le){const Y=new Set(le||[]);return(ee||[]).filter(Q=>{const oe=G.get(Q),X=D.get(Q);if(!oe&&!X)return!0;if(X&&!zp(X,Y))return!1;const $=new Set;return oe&&oe.forEach(ce=>$.add(ce)),X&&X.forEach(ce=>{const me=L.get(ce);me&&me.forEach(je=>$.add(je))}),zp($,de)})}function F(ee,de){const le=new Set(ee.profiles||[]),Y=new Set(ee.permissionSets||[]),Q=new Set(Xt(ee.permissionsText));return le.forEach(oe=>{const X=D.get(oe);X&&X.forEach(ce=>Y.add(ce));const $=G.get(oe);$&&$.forEach(ce=>Q.add(ce)),X&&X.forEach(ce=>{const me=L.get(ce);me&&me.forEach(je=>Q.add(je))})}),{...ee,permissionSets:Array.from(Y),permissionsText:Array.from(Q).join(`
`)}}async function K(ee){var Q,oe;o(ee),T(""),x("edit"),h(!0),p(!0),y(!1),w(!1),k(!1);const de=Array.isArray(ee.profiles)?ee.profiles.map(X=>(X==null?void 0:X.name)||(X==null?void 0:X.id)||X).filter(Boolean):[((Q=ee.profiles)==null?void 0:Q.name)||ee.profile||ee.profile_name].filter(Boolean),le=(ee.permission_sets||ee.permissionSets||ee.permission_set_names||[]).map(X=>typeof X=="string"?X:(X==null?void 0:X.name)||(X==null?void 0:X.id)).filter(Boolean);u({name:ee.name||"",email:ee.email||"",profiles:de,permissionSets:le,company:((oe=ee.company)==null?void 0:oe.code)||ee.company_code||ee.company_id||"",is_active:ee.is_active!==!1,permissionsText:""});const Y=ee.id||ee.user_id;if(Y)try{const X=await yF(Y),$=(X==null?void 0:X.permissions)??X,ce=Array.isArray($)?$.map(me=>typeof me=="string"?me:me==null?void 0:me.name).filter(Boolean):[];u(me=>F({...me,permissionsText:ce.join(`
`)}))}catch{}p(!1)}function U(){o(null),T(""),x("add"),p(!1),y(!1),w(!1),k(!1),u({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),h(!0)}async function ie(){var Q,oe;if(b==="edit"&&!a)return;j(!0),T("");const ee=(a==null?void 0:a.id)||(a==null?void 0:a.user_id);if(b==="edit"&&!ee){j(!1),T("Missing user id");return}const de=Xt(l.permissionsText),le=l.profiles||[],Y={name:l.name,is_active:!!l.is_active,profile_names:le,profile_name:le[0]||null,permission_sets:l.permissionSets||[],company_code:l.company||null,...b==="add"?{email:l.email}:{}};try{if(b==="add"){const X=await vF(Y),$=(X==null?void 0:X.id)||(X==null?void 0:X.user_id)||((Q=X==null?void 0:X.user)==null?void 0:Q.id)||((oe=X==null?void 0:X.user)==null?void 0:oe.user_id);$!=null&&await B0($,de),T("User created")}else await bF(ee,Y),await B0(ee,de),T("User updated");i.invalidateQueries({queryKey:["admin","users"]}),h(!1),o(null)}catch(X){T((X==null?void 0:X.message)||"Failed to save user")}finally{j(!1)}}async function V(ee){const de=(ee==null?void 0:ee.id)??ee;if(de)try{const le=(ee==null?void 0:ee.isActive)??(ee==null?void 0:ee.is_active);(typeof le=="boolean"?le:!0)?await wF(de):await _F(de),i.invalidateQueries({queryKey:["admin","users"]}),h(!1),o(null)}catch{}}function O(ee){u(de=>{const le=new Set(Xt(de.permissionsText)),Y=le.has(ee);Y?le.delete(ee):le.add(ee);let Q=de.permissionSets||[],oe=de.profiles||[];return Y&&(Q=E(Q,L,le),oe=C(oe,le,Q)),{...de,permissionsText:Array.from(le).join(`
`),permissionSets:Q,profiles:oe}})}function q(){const ee=new Set([...M,...t]);u(de=>({...de,permissionsText:Array.from(ee).join(`
`)}))}function ae(){u(ee=>({...ee,permissionsText:"",permissionSets:[],profiles:[]}))}function Ce(ee){u(de=>{const le=new Set(de.profiles||[]),Y=new Set(de.permissionSets||[]),Q=new Set(Xt(de.permissionsText));if(le.has(ee)){le.delete(ee);const ce=E(Array.from(Y),L,Q),me=C(Array.from(le),Q,ce);return{...de,profiles:me,permissionSets:ce,permissionsText:Array.from(Q).join(`
`)}}le.add(ee);const X=D.get(ee);X&&X.forEach(ce=>Y.add(ce));const $=G.get(ee);return $&&$.forEach(ce=>Q.add(ce)),X&&X.forEach(ce=>{const me=L.get(ce);me&&me.forEach(je=>Q.add(je))}),{...de,profiles:Array.from(le),permissionSets:Array.from(Y),permissionsText:Array.from(Q).join(`
`)}})}function Le(){u(ee=>{const de=new Set([...ee.profiles||[],...e]),le=new Set(ee.permissionSets||[]),Y=new Set(Xt(ee.permissionsText));return de.forEach(Q=>{const oe=D.get(Q);oe&&oe.forEach($=>le.add($));const X=G.get(Q);X&&X.forEach($=>Y.add($)),oe&&oe.forEach($=>{const ce=L.get($);ce&&ce.forEach(me=>Y.add(me))})}),{...ee,profiles:Array.from(de),permissionSets:Array.from(le),permissionsText:Array.from(Y).join(`
`)}})}function st(){u(ee=>({...ee,profiles:[]}))}function be(ee){u(de=>{const le=new Set(de.permissionSets||[]),Y=new Set(Xt(de.permissionsText));if(le.has(ee)){le.delete(ee);const X=C(de.profiles||[],Y,Array.from(le));return{...de,permissionSets:Array.from(le),profiles:X,permissionsText:Array.from(Y).join(`
`)}}le.add(ee);const oe=L.get(ee);return oe&&oe.forEach(X=>Y.add(X)),{...de,permissionSets:Array.from(le),permissionsText:Array.from(Y).join(`
`)}})}function he(){u(ee=>{const de=new Set([...ee.permissionSets||[],...n]),le=new Set(Xt(ee.permissionsText));return de.forEach(Y=>{const Q=L.get(Y);Q&&Q.forEach(oe=>le.add(oe))}),{...ee,permissionSets:Array.from(de),permissionsText:Array.from(le).join(`
`)}})}function Ke(){u(ee=>{const de=new Set(Xt(ee.permissionsText)),le=C(ee.profiles||[],de,[]);return{...ee,permissionSets:[],profiles:le,permissionsText:Array.from(de).join(`
`)}})}return{selectedUser:a,setSelectedUser:o,userForm:l,setUserForm:u,userModalOpen:d,setUserModalOpen:h,userModalLoading:f,setUserModalLoading:p,userModalMode:b,setUserModalMode:x,userProfilesOpen:v,setUserProfilesOpen:y,userPermissionSetsOpen:g,setUserPermissionSetsOpen:w,userPermissionsOpen:_,setUserPermissionsOpen:k,savingUser:S,permissionsMessage:N,setPermissionsMessage:T,selectUser:K,openNewUserModal:U,saveUser:ie,selectedUserProfiles:A,selectedUserPermissionSets:z,selectedUserPermissions:M,selectedUserPermissionSet:I,customUserPermissions:H,toggleUserPermission:O,selectAllUserPermissions:q,clearUserPermissions:ae,toggleUserProfile:Ce,selectAllUserProfiles:Le,clearUserProfiles:st,toggleUserPermissionSet:be,selectAllUserPermissionSets:he,clearUserPermissionSets:Ke,deleteUser:V}}function Sz({open:t,onClose:e,userModalLoading:n,userModalMode:s,selectedUser:r,userForm:i,setUserForm:a,companyList:o,profileOptions:l,profileValues:u,userProfilesOpen:d,setUserProfilesOpen:h,selectAllUserProfiles:f,clearUserProfiles:p,selectedUserProfiles:b,toggleUserProfile:x,permissionSetList:v,permissionSetValues:y,userPermissionSetsOpen:g,setUserPermissionSetsOpen:w,selectAllUserPermissionSets:_,clearUserPermissionSets:k,selectedUserPermissionSets:S,toggleUserPermissionSet:j,userPermissionsOpen:N,setUserPermissionsOpen:T,selectedUserPermissions:A,permissionList:z,permissionsQuery:M,selectedUserPermissionSet:I,toggleUserPermission:H,selectAllUserPermissions:L,clearUserPermissions:D,customUserPermissions:G,isSelfUser:E,setConfirmDelete:C,saveUser:F,savingUser:K}){const U=m.useMemo(()=>{const V=o.map(O=>{const q=O.code||O.id||"";return{value:q,label:O.name||O.code||q||""}}).filter(O=>O.value);return[{value:"",label:"Select company"},...V]},[o]),ie=m.useMemo(()=>[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],[]);return c.jsx(Jn,{open:t,onClose:e,title:s==="add"?"Add user":"Edit user",maxWidth:"560px",children:n?c.jsx(De,{text:"Loading user",className:"text-sm text-black/60 dark:text-white/65"}):s==="add"||r?c.jsxs("div",{className:"space-y-3",children:[s==="edit"?c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/55",children:["Editing ",r==null?void 0:r.email]}):null,c.jsx(xe,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.name,onChange:V=>a(O=>({...O,name:V.target.value}))})}),c.jsx(xe,{label:"Email",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.email,onChange:V=>a(O=>({...O,email:V.target.value})),type:"email",disabled:s==="edit"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Company",children:c.jsx(qe,{value:i.company||"",options:U,onChange:V=>a(O=>({...O,company:V}))})}),c.jsx(xe,{label:"Status",children:c.jsx(qe,{value:i.is_active?"active":"inactive",options:ie,onChange:V=>a(O=>({...O,is_active:V==="active"}))})})]}),c.jsx(xe,{label:"Profiles",children:c.jsxs(yt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>h(V=>!V),"aria-expanded":d,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Profiles"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Co(i.profiles.length,"profile")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:d?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",d&&"rotate-180")})]})]}),d?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!u.length,children:"Select all"}),c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!i.profiles.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[l.map(V=>{const O=V.name||V.id;if(!O)return null;const q=b.has(O);return c.jsxs("button",{type:"button",onClick:()=>x(O),className:ve("mmg-profile-option flex items-center justify-between gap-3 rounded-xl px-3 py-2 text-sm ring-1 transition-colors",q?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:V.display_name||V.name||O}),c.jsx("span",{className:ve("h-6 w-6 rounded-full flex items-center justify-center transition-colors",q?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:q?"opacity-100":"opacity-0"})})]},O)}),l.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No profiles available."})]})]}):null]})}),c.jsx(xe,{label:"Permission Sets",children:c.jsxs(yt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>w(V=>!V),"aria-expanded":g,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Co(i.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:g?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",g&&"rotate-180")})]})]}),g?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:_,disabled:!y.length,children:"Select all"}),c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:k,disabled:!i.permissionSets.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[v.map(V=>{const O=V.name||V.id;if(!O)return null;const q=S.has(O);return c.jsxs("button",{type:"button",onClick:()=>j(O),className:ve("flex items-center justify-between gap-3 rounded-xl px-3 py-2 text-sm ring-1 transition-colors",q?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:V.display_name||V.name||O}),c.jsx("span",{className:ve("h-6 w-6 rounded-full flex items-center justify-center transition-colors",q?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:q?"opacity-100":"opacity-0"})})]},O)}),v.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]})]}):null]})}),c.jsx(xe,{label:"Permissions",children:c.jsxs(yt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>T(V=>!V),"aria-expanded":N,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Co(A.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:N?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",N&&"rotate-180")})]})]}),N?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:L,disabled:!z.length,children:"Select all"}),c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:D,disabled:!A.length,children:"Clear"})]})}),M.isLoading?c.jsx(De,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):z.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:z.map(V=>{const O=I.has(V);return c.jsxs("button",{type:"button",onClick:()=>H(V),className:ve("flex items-center justify-between gap-3 rounded-xl px-3 py-2 text-sm ring-1 transition-colors",O?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:V}),c.jsx("span",{className:ve("h-6 w-6 rounded-full flex items-center justify-center transition-colors",O?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:O?"opacity-100":"opacity-0"})})]},V)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),G.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:G.map(V=>c.jsxs("button",{type:"button",onClick:()=>H(V),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:V}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},V))})]}):null]}):null]})}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[s==="edit"?c.jsx(Z,{variant:"ghost",className:ve("rounded-2xl",typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"&&!((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))?"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300":"text-red-600 hover:text-red-700 dark:text-red-300"),onClick:()=>C({open:!0,type:"user",payload:{id:(r==null?void 0:r.id)||(r==null?void 0:r.user_id),isActive:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active):!0},label:`${typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"} user "${r==null?void 0:r.email}"?`}),disabled:E,children:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(Z,{className:"rounded-2xl",onClick:F,disabled:K,children:K?c.jsx(De,{text:"Saving"}):"Save"})]})]})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Select a user to edit."})})}function jz({companySearch:t,setCompanySearch:e,openCompanyModal:n,companiesQuery:s,filteredCompanyList:r,companyLookup:i,setConfirmDelete:a}){const o=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(At,{children:"Companies"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(Ia,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add company"})]})]});return c.jsxs(lt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Et,{className:"hidden md:block space-y-2",children:o}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:o}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(De,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(yt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.name||l.code}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.code||""})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ln,{onClick:()=>n(l),title:"Edit company","aria-label":"Edit company",children:c.jsx(uu,{size:16})}),c.jsx(ln,{variant:"ghost",onClick:()=>a({open:!0,type:"company",payload:l.code||l.id,label:`Delete company "${l.name||l.code}"?`}),title:"Delete company","aria-label":"Delete company",children:c.jsx(ma,{size:16})})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[l.country?c.jsx("span",{children:l.country}):null,l.currency?c.jsxs("span",{children:[" ",l.currency]}):null,l.timezone?c.jsxs("span",{children:[" ",l.timezone]}):null]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[c.jsxs("span",{children:["Parent: ",i.get(l.parent_id)||""]}),c.jsxs("span",{children:[" ",l.isgroup?"Group":"Company"]}),c.jsxs("span",{children:[" ",l.is_active===!1?"Inactive":"Active"]})]})]},l.code||l.id)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching companies.":"No companies available."})]})})]})]})}function Cz({companySearch:t,setCompanySearch:e,companiesQuery:n,filteredCompanyList:s,companyLookup:r,companyList:i}){const{companyForm:a,setCompanyForm:o,editingCompany:l,setEditingCompany:u,companyModalOpen:d,setCompanyModalOpen:h,savingCompany:f,openCompanyModal:p,saveCompany:b,deleteCompany:x}=Nz(),[v,y]=m.useState({open:!1,type:"",payload:null,label:""});async function g(){if(!(!v.open||!v.payload))try{await x(v.payload)}finally{y({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(jz,{companySearch:t,setCompanySearch:e,openCompanyModal:p,companiesQuery:n,filteredCompanyList:s,companyLookup:r,setConfirmDelete:y}),c.jsx(Ez,{open:d,onClose:()=>{h(!1),u(null),o({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})},editingCompany:l,companyForm:a,setCompanyForm:o,companyList:i,setConfirmDelete:y,saveCompany:b,savingCompany:f}),c.jsx(bu,{open:v.open,message:v.label,onClose:()=>y({open:!1,type:"",payload:null,label:""}),onConfirm:g})]})}function Nz(){const t=er(),[e,n]=m.useState({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0}),[s,r]=m.useState(null),[i,a]=m.useState(!1),[o,l]=m.useState(!1);function u(f){f?(r(f.code||f.id),n({code:f.code||"",name:f.name||"",parent_id:f.parent_id??"",country:f.country??"",currency:f.currency??"",timezone:f.timezone??"",isgroup:!!f.isgroup,is_active:f.is_active!==!1})):(r(null),n({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})),a(!0)}async function d(){if(!e.code.trim()||!e.name.trim())return;l(!0);const f={code:e.code.trim(),name:e.name.trim(),parent_id:e.parent_id||null,country:e.country||null,currency:e.currency||null,timezone:e.timezone||null,isgroup:!!e.isgroup,is_active:!!e.is_active};try{s?await RF(s,f):await PF(f),t.invalidateQueries({queryKey:["admin","companies"]}),a(!1),r(null)}catch{}finally{l(!1)}}async function h(f){if(f)try{await AF(f),t.invalidateQueries({queryKey:["admin","companies"]}),a(!1),r(null)}catch{}}return{companyForm:e,setCompanyForm:n,editingCompany:s,setEditingCompany:r,companyModalOpen:i,setCompanyModalOpen:a,savingCompany:o,openCompanyModal:u,saveCompany:d,deleteCompany:h}}function Ez({open:t,onClose:e,editingCompany:n,companyForm:s,setCompanyForm:r,companyList:i,setConfirmDelete:a,saveCompany:o,savingCompany:l}){const u=[{value:"",label:"None"},...i.filter(f=>(f.code||f.id)!==s.code).map(f=>{const p=f.code||f.id||"";return{value:p,label:f.name||f.code||p||""}}).filter(f=>f.value)],d=[{value:"company",label:"Company"},{value:"group",label:"Group"}],h=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return c.jsx(Jn,{open:t,onClose:e,title:n?`Edit company: ${s.name||s.code}`:"Add company",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Code",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.code,onChange:f=>r(p=>({...p,code:f.target.value})),placeholder:"MMG-001",disabled:!!n})}),c.jsx(xe,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:f=>r(p=>({...p,name:f.target.value})),placeholder:"MMG Global"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Parent company",children:c.jsx(qe,{value:s.parent_id||"",options:u,onChange:f=>r(p=>({...p,parent_id:f}))})}),c.jsx(xe,{label:"Country",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.country,onChange:f=>r(p=>({...p,country:f.target.value})),placeholder:"US"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Currency",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.currency,onChange:f=>r(p=>({...p,currency:f.target.value})),placeholder:"USD"})}),c.jsx(xe,{label:"Timezone",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.timezone,onChange:f=>r(p=>({...p,timezone:f.target.value})),placeholder:"America/New_York"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Type",children:c.jsx(qe,{value:s.isgroup?"group":"company",options:d,onChange:f=>r(p=>({...p,isgroup:f==="group"}))})}),c.jsx(xe,{label:"Status",children:c.jsx(qe,{value:s.is_active?"active":"inactive",options:h,onChange:f=>r(p=>({...p,is_active:f==="active"}))})})]}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(Z,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>a({open:!0,type:"company",payload:n,label:`Delete company "${s.name||s.code}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(Z,{className:"rounded-2xl",onClick:o,disabled:l,children:l?c.jsx(De,{text:"Saving"}):"Save"})]})]})]})})}function Pz({profileSearch:t,setProfileSearch:e,openProfileModal:n,filteredProfileOptions:s,duplicateProfile:r,setConfirmDelete:i}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(At,{children:"Profiles"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(Ia,{value:t,onChange:o=>e(o.target.value),className:"w-full sm:w-[220px]"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add profile"})]})]});return c.jsxs(lt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Et,{className:"hidden md:block space-y-2",children:a}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsxs("div",{className:"space-y-4 p-5 pt-1",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.map(o=>c.jsxs(yt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:o.display_name||o.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:o.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ln,{onClick:()=>r(o),title:"Duplicate profile","aria-label":"Duplicate profile",children:c.jsx(b1,{size:16})}),o.is_system?c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:"System"}):c.jsxs(c.Fragment,{children:[c.jsx(ln,{onClick:()=>n(o),title:"Edit profile","aria-label":"Edit profile",children:c.jsx(uu,{size:16})}),c.jsx(ln,{variant:"ghost",onClick:()=>i({open:!0,type:"profile",payload:o.id||o.name,label:`Delete profile "${o.display_name||o.name}"?`}),title:"Delete profile","aria-label":"Delete profile",children:c.jsx(ma,{size:16})})]})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(o.permissions||[]).length," permission",(o.permissions||[]).length===1?"":"s"]}),o.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:o.description}):null]},o.id||o.name))}),s.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching profiles.":"No profiles available."})]})]})]})}function Rz({profileSearch:t,setProfileSearch:e,filteredProfileOptions:n,permissionList:s,permissionSetValues:r,permissionSetList:i,permissionSetsQuery:a,permissionsQuery:o}){const{profileForm:l,setProfileForm:u,editingProfile:d,setEditingProfile:h,profileModalOpen:f,setProfileModalOpen:p,profileIsSystem:b,setProfileIsSystem:x,profilePermissionSetsOpen:v,setProfilePermissionSetsOpen:y,profilePermissionsOpen:g,setProfilePermissionsOpen:w,savingProfile:_,openProfileModal:k,duplicateProfile:S,saveProfile:j,deleteProfile:N,selectedProfilePermissions:T,selectedProfilePermissionSet:A,selectedProfilePermissionSets:z,customProfilePermissions:M,toggleProfilePermission:I,selectAllProfilePermissions:H,clearProfilePermissions:L,toggleProfilePermissionSet:D,selectAllProfilePermissionSets:G,clearProfilePermissionSets:E}=Az({permissionList:s,permissionSetValues:r,permissionSetList:i}),[C,F]=m.useState({open:!1,type:"",payload:null,label:""});async function K(){if(!(!C.open||!C.payload))try{await N(C.payload)}finally{F({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(Pz,{profileSearch:t,setProfileSearch:e,openProfileModal:k,filteredProfileOptions:n,duplicateProfile:S,setConfirmDelete:F}),c.jsx(Oz,{open:f,onClose:()=>{p(!1),h(null),u({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),x(!1),y(!1),w(!1)},editingProfile:d,profileForm:l,setProfileForm:u,profileIsSystem:b,profilePermissionSetsOpen:v,setProfilePermissionSetsOpen:y,profilePermissionsOpen:g,setProfilePermissionsOpen:w,permissionSetValues:r,permissionSetsQuery:a,permissionSetList:i,selectedProfilePermissionSets:z,toggleProfilePermissionSet:D,selectAllProfilePermissionSets:G,clearProfilePermissionSets:E,selectedProfilePermissions:T,permissionList:s,permissionsQuery:o,selectedProfilePermissionSet:A,toggleProfilePermission:I,selectAllProfilePermissions:H,clearProfilePermissions:L,customProfilePermissions:M,setConfirmDelete:F,saveProfile:j,savingProfile:_}),c.jsx(bu,{open:C.open,message:C.label,onClose:()=>F({open:!1,type:"",payload:null,label:""}),onConfirm:K})]})}function Az({permissionList:t,permissionSetValues:e,permissionSetList:n}){const s=er(),[r,i]=m.useState({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),[a,o]=m.useState(null),[l,u]=m.useState(!1),[d,h]=m.useState(!1),[f,p]=m.useState(!1),[b,x]=m.useState(!1),[v,y]=m.useState(!1),g=m.useMemo(()=>Xt(r.permissionsText),[r.permissionsText]),w=m.useMemo(()=>new Set(g),[g]),_=m.useMemo(()=>new Set(r.permissionSets||[]),[r.permissionSets]),k=m.useMemo(()=>{if(!t.length)return g;const E=new Set(t);return g.filter(C=>!E.has(C))},[t,g]),S=m.useMemo(()=>{const E=new Map;return(n||[]).forEach(C=>{const F=C.name||C.id;if(!F)return;const K=(C.permissions||C.permission_list||C.permissionList||[]).map(U=>typeof U=="string"?U:(U==null?void 0:U.name)||(U==null?void 0:U.value)||(U==null?void 0:U.permission)).filter(Boolean);E.set(F,new Set(K))}),E},[n]);function j(E,C){return(E||[]).filter(F=>{const K=S.get(F);if(!K)return!0;for(const U of K)if(!C.has(U))return!1;return!0})}function N(E){h(!!(E!=null&&E.is_system)),!(E!=null&&E.is_system)&&(p(!1),x(!1),E?(o(E.id||E.name),i({name:E.name,display_name:E.display_name||E.name,description:E.description||"",permissionsText:(E.permissions||[]).map(C=>typeof C=="string"?C:C==null?void 0:C.name).filter(Boolean).join(`
`),permissionSets:(E.permission_sets||E.permissionSets||E.permission_set_names||[]).map(C=>typeof C=="string"?C:(C==null?void 0:C.name)||(C==null?void 0:C.id)).filter(Boolean)})):(o(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!0))}function T(E){if(!E)return;const C=E.name||E.display_name||"profile",F=E.display_name||E.name||C;h(!1),o(null),p(!1),x(!1),i({name:`${C}_new`,display_name:`${F}_new`,description:E.description||"",permissionsText:(E.permissions||[]).map(K=>typeof K=="string"?K:K==null?void 0:K.name).filter(Boolean).join(`
`),permissionSets:(E.permission_sets||E.permissionSets||E.permission_set_names||[]).map(K=>typeof K=="string"?K:(K==null?void 0:K.name)||(K==null?void 0:K.id)).filter(Boolean)}),u(!0)}async function A(){if(r.name.trim()){y(!0);try{const E={name:r.name.trim(),display_name:r.display_name||r.name,description:r.description,permissions:Xt(r.permissionsText),permission_sets:r.permissionSets||[]};a?await jF(a,E):await SF(E),s.invalidateQueries({queryKey:["admin","profiles"]}),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),o(null),u(!1)}catch{}finally{y(!1)}}}async function z(E){try{await CF(E),s.invalidateQueries({queryKey:["admin","profiles"]}),a===E&&(o(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!1)}catch{}}function M(E){i(C=>{const F=new Set(Xt(C.permissionsText)),K=F.has(E);K?F.delete(E):F.add(E);let U=C.permissionSets||[];return K&&(U=j(U,F)),{...C,permissionsText:Array.from(F).join(`
`),permissionSets:U}})}function I(){const E=new Set([...g,...t]);i(C=>({...C,permissionsText:Array.from(E).join(`
`)}))}function H(){i(E=>({...E,permissionsText:""}))}function L(E){i(C=>{const F=new Set(C.permissionSets||[]),K=new Set(Xt(C.permissionsText));if(F.has(E))return F.delete(E),{...C,permissionSets:Array.from(F),permissionsText:Array.from(K).join(`
`)};F.add(E);const ie=S.get(E);return ie&&ie.forEach(V=>K.add(V)),{...C,permissionSets:Array.from(F),permissionsText:Array.from(K).join(`
`)}})}function D(){i(E=>{const C=new Set([...E.permissionSets||[],...e]),F=new Set(Xt(E.permissionsText));return C.forEach(K=>{const U=S.get(K);U&&U.forEach(ie=>F.add(ie))}),{...E,permissionSets:Array.from(C),permissionsText:Array.from(F).join(`
`)}})}function G(){i(E=>({...E,permissionSets:[]}))}return{profileForm:r,setProfileForm:i,editingProfile:a,setEditingProfile:o,profileModalOpen:l,setProfileModalOpen:u,profileIsSystem:d,setProfileIsSystem:h,profilePermissionSetsOpen:f,setProfilePermissionSetsOpen:p,profilePermissionsOpen:b,setProfilePermissionsOpen:x,savingProfile:v,openProfileModal:N,duplicateProfile:T,saveProfile:A,deleteProfile:z,selectedProfilePermissions:g,selectedProfilePermissionSet:w,selectedProfilePermissionSets:_,customProfilePermissions:k,toggleProfilePermission:M,selectAllProfilePermissions:I,clearProfilePermissions:H,toggleProfilePermissionSet:L,selectAllProfilePermissionSets:D,clearProfilePermissionSets:G}}function Oz({open:t,onClose:e,editingProfile:n,profileForm:s,setProfileForm:r,profileIsSystem:i,profilePermissionSetsOpen:a,setProfilePermissionSetsOpen:o,profilePermissionsOpen:l,setProfilePermissionsOpen:u,permissionSetValues:d,permissionSetsQuery:h,permissionSetList:f,selectedProfilePermissionSets:p,toggleProfilePermissionSet:b,selectAllProfilePermissionSets:x,clearProfilePermissionSets:v,selectedProfilePermissions:y,permissionList:g,permissionsQuery:w,selectedProfilePermissionSet:_,toggleProfilePermission:k,selectAllProfilePermissions:S,clearProfilePermissions:j,customProfilePermissions:N,setConfirmDelete:T,saveProfile:A,savingProfile:z}){return c.jsx(Jn,{open:t,onClose:e,title:n?`Edit profile: ${n}`:"Add profile",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:M=>r(I=>({...I,name:M.target.value})),placeholder:"system_admin",disabled:!!n})}),c.jsx(xe,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:M=>r(I=>({...I,display_name:M.target.value})),placeholder:"System Admin"})})]}),c.jsx(xe,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:M=>r(I=>({...I,description:M.target.value})),placeholder:"What this profile can do"})}),c.jsx(xe,{label:"Permission Sets",children:c.jsxs(yt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>o(M=>!M),"aria-expanded":a,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Co(s.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:a?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",a&&"rotate-180")})]})]}),a?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:x,disabled:!d.length,children:"Select all"}),c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:v,disabled:!s.permissionSets.length,children:"Clear"})]})}),h.isLoading?c.jsx(De,{text:"Loading permission sets",className:"text-sm text-black/60 dark:text-white/65"}):f.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:f.map(M=>{const I=M.name||M.id;if(!I)return null;const H=p.has(I);return c.jsxs("button",{type:"button",onClick:()=>b(I),className:ve("flex items-center justify-between gap-3 rounded-xl px-3 py-2 text-sm ring-1 transition-colors",H?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate text-sm font-medium",children:M.display_name||M.name||I}),c.jsx("span",{className:ve("h-6 w-6 rounded-full flex items-center justify-center transition-colors",H?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:H?"opacity-100":"opacity-0"})})]},I)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]}):null]})}),c.jsx(xe,{label:"Permissions",children:c.jsxs(yt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>u(M=>!M),"aria-expanded":l,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Co(y.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:l?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",l&&"rotate-180")})]})]}),l?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:S,disabled:!g.length,children:"Select all"}),c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:j,disabled:!y.length,children:"Clear"})]})}),w.isLoading?c.jsx(De,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):g.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[110px] overflow-y-auto p-1",children:g.map(M=>{const I=_.has(M);return c.jsxs("button",{type:"button",onClick:()=>k(M),className:ve("flex items-center justify-between gap-3 rounded-xl px-3 py-2 text-sm ring-1 transition-colors",I?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:M}),c.jsx("span",{className:ve("h-6 w-6 rounded-full flex items-center justify-center transition-colors",I?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:I?"opacity-100":"opacity-0"})})]},M)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),N.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:N.map(M=>c.jsxs("button",{type:"button",onClick:()=>k(M),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:M}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},M))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(Z,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>T({open:!0,type:"profile",payload:n,label:`Delete profile "${s.display_name||s.name}"?`}),disabled:i,children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(Z,{className:"rounded-2xl",onClick:A,disabled:z||i,children:z?c.jsx(De,{text:"Saving"}):"Save"})]})]})]})})}function Tz({permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:n,permissionSetsQuery:s,filteredPermissionSetList:r,duplicatePermissionSet:i,setConfirmDelete:a}){const o=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(At,{children:"Permission Sets"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(Ia,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add permission set"})]})]});return c.jsxs(lt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Et,{className:"hidden md:block space-y-2",children:o}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:o}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(De,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(yt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.display_name||l.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ln,{onClick:()=>i(l),title:"Duplicate permission set","aria-label":"Duplicate permission set",children:c.jsx(b1,{size:16})}),c.jsx(ln,{onClick:()=>n(l),title:"Edit permission set","aria-label":"Edit permission set",children:c.jsx(uu,{size:16})}),c.jsx(ln,{variant:"ghost",onClick:()=>a({open:!0,type:"permission-set",payload:l.name,label:`Delete permission set "${l.display_name||l.name}"?`}),title:"Delete permission set","aria-label":"Delete permission set",children:c.jsx(ma,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(l.permissions||[]).length," permission",(l.permissions||[]).length===1?"":"s"]}),l.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:l.description}):null]},l.name)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permission sets.":"No permission sets available."})]})})]})]})}function Mz({permissionSetSearch:t,setPermissionSetSearch:e,permissionSetsQuery:n,filteredPermissionSetList:s,permissionList:r,permissionsQuery:i}){const{permissionSetForm:a,setPermissionSetForm:o,editingPermissionSet:l,setEditingPermissionSet:u,permissionSetModalOpen:d,setPermissionSetModalOpen:h,savingPermissionSet:f,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:b,openPermissionSetModal:x,duplicatePermissionSet:v,savePermissionSet:y,deletePermissionSet:g,selectedPermissionSetPermissions:w,selectedPermissionSetPermissionSet:_,customPermissionSetPermissions:k,togglePermissionSetPermission:S,selectAllPermissionSetPermissions:j,clearPermissionSetPermissions:N}=Iz({permissionList:r}),[T,A]=m.useState({open:!1,type:"",payload:null,label:""});async function z(){if(!(!T.open||!T.payload))try{await g(T.payload)}finally{A({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(Tz,{permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:x,permissionSetsQuery:n,filteredPermissionSetList:s,duplicatePermissionSet:v,setConfirmDelete:A}),c.jsx(Dz,{open:d,onClose:()=>{h(!1),u(null),o({name:"",display_name:"",description:"",permissionsText:""}),b(!1)},editingPermissionSet:l,permissionSetForm:a,setPermissionSetForm:o,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:b,selectedPermissionSetPermissions:w,permissionList:r,permissionsQuery:i,selectedPermissionSetPermissionSet:_,togglePermissionSetPermission:S,selectAllPermissionSetPermissions:j,clearPermissionSetPermissions:N,customPermissionSetPermissions:k,setConfirmDelete:A,savePermissionSet:y,savingPermissionSet:f}),c.jsx(bu,{open:T.open,message:T.label,onClose:()=>A({open:!1,type:"",payload:null,label:""}),onConfirm:z})]})}function Iz({permissionList:t}){const e=er(),[n,s]=m.useState({name:"",display_name:"",description:"",permissionsText:""}),[r,i]=m.useState(null),[a,o]=m.useState(!1),[l,u]=m.useState(!1),[d,h]=m.useState(!1),f=m.useMemo(()=>Xt(n.permissionsText),[n.permissionsText]),p=m.useMemo(()=>new Set(f),[f]),b=m.useMemo(()=>{if(!t.length)return f;const S=new Set(t);return f.filter(j=>!S.has(j))},[t,f]);function x(S){h(!1),S?(i(S.name),s({name:S.name||"",display_name:S.display_name||S.name||"",description:S.description||"",permissionsText:(S.permissions||[]).map(j=>typeof j=="string"?j:j==null?void 0:j.name).filter(Boolean).join(`
`)})):(i(null),s({name:"",display_name:"",description:"",permissionsText:""})),o(!0)}function v(S){if(!S)return;const j=S.name||S.display_name||"permission_set",N=S.display_name||S.name||j;i(null),h(!1),s({name:`${j}_new`,display_name:`${N}_new`,description:S.description||"",permissionsText:(S.permissions||[]).map(T=>typeof T=="string"?T:T==null?void 0:T.name).filter(Boolean).join(`
`)}),o(!0)}async function y(){if(!n.name.trim())return;u(!0);const S={name:n.name.trim(),display_name:n.display_name||n.name.trim(),description:n.description,permissions:Xt(n.permissionsText)};try{r?await MF(r,S):await TF(S),e.invalidateQueries({queryKey:["admin","permission-sets"]}),o(!1),i(null)}catch{}finally{u(!1)}}async function g(S){if(S)try{await IF(S),e.invalidateQueries({queryKey:["admin","permission-sets"]}),o(!1),i(null)}catch{}}function w(S){s(j=>{const N=new Set(Xt(j.permissionsText));return N.has(S)?N.delete(S):N.add(S),{...j,permissionsText:Array.from(N).join(`
`)}})}function _(){const S=new Set([...f,...t]);s(j=>({...j,permissionsText:Array.from(S).join(`
`)}))}function k(){s(S=>({...S,permissionsText:""}))}return{permissionSetForm:n,setPermissionSetForm:s,editingPermissionSet:r,setEditingPermissionSet:i,permissionSetModalOpen:a,setPermissionSetModalOpen:o,savingPermissionSet:l,permissionSetPermissionsOpen:d,setPermissionSetPermissionsOpen:h,openPermissionSetModal:x,duplicatePermissionSet:v,savePermissionSet:y,deletePermissionSet:g,selectedPermissionSetPermissions:f,selectedPermissionSetPermissionSet:p,customPermissionSetPermissions:b,togglePermissionSetPermission:w,selectAllPermissionSetPermissions:_,clearPermissionSetPermissions:k}}function Dz({open:t,onClose:e,editingPermissionSet:n,permissionSetForm:s,setPermissionSetForm:r,permissionSetPermissionsOpen:i,setPermissionSetPermissionsOpen:a,selectedPermissionSetPermissions:o,permissionList:l,permissionsQuery:u,selectedPermissionSetPermissionSet:d,togglePermissionSetPermission:h,selectAllPermissionSetPermissions:f,clearPermissionSetPermissions:p,customPermissionSetPermissions:b,setConfirmDelete:x,savePermissionSet:v,savingPermissionSet:y}){return c.jsx(Jn,{open:t,onClose:e,title:n?`Edit permission set: ${n}`:"Add permission set",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:g=>r(w=>({...w,name:g.target.value})),placeholder:"sales_ops",disabled:!!n})}),c.jsx(xe,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:g=>r(w=>({...w,display_name:g.target.value})),placeholder:"Sales Ops"})})]}),c.jsx(xe,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:g=>r(w=>({...w,description:g.target.value})),placeholder:"What this permission set grants"})}),c.jsx(xe,{label:"Permissions",children:c.jsxs(yt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>a(g=>!g),"aria-expanded":i,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Co(o.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:i?"Hide":"Edit"}),c.jsx(An,{size:16,className:ve("transition-transform",i&&"rotate-180")})]})]}),i?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!l.length,children:"Select all"}),c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!o.length,children:"Clear"})]})}),u.isLoading?c.jsx(De,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:l.map(g=>{const w=d.has(g);return c.jsxs("button",{type:"button",onClick:()=>h(g),className:ve("flex items-center justify-between gap-3 rounded-xl px-3 py-2 text-sm ring-1 transition-colors",w?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:g}),c.jsx("span",{className:ve("h-6 w-6 rounded-full flex items-center justify-center transition-colors",w?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:w?"opacity-100":"opacity-0"})})]},g)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),b.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:b.map(g=>c.jsxs("button",{type:"button",onClick:()=>h(g),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:g}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},g))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(Z,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>x({open:!0,type:"permission-set",payload:n,label:`Delete permission set "${s.display_name||s.name}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(Z,{className:"rounded-2xl",onClick:v,disabled:y,children:y?c.jsx(De,{text:"Saving"}):"Save"})]})]})]})})}function Lz({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:a,permissionActionFilter:o,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:b,mergedPermissionDescriptions:x,setConfirmDelete:v}){const y=[{value:"",label:"All modules"},...u.map(k=>({value:k,label:k}))],g=[{value:"",label:"All services"},...d.map(k=>({value:k,label:k}))],w=[{value:"",label:"All permissions"},...h.map(k=>({value:k,label:k}))],_=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(At,{children:"Permissions"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(Ia,{value:t,onChange:k=>e(k.target.value),className:"w-full sm:w-[220px]"}),c.jsx(Z,{className:"rounded-2xl self-start sm:self-auto",variant:"secondary",onClick:()=>n("add",""),children:"Add permission"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[c.jsx(qe,{value:s,options:y,onChange:r}),c.jsx(qe,{value:i,options:g,onChange:a}),c.jsx(qe,{value:o,options:w,onChange:l,className:"col-span-2 sm:col-span-1"})]})]});return c.jsxs(lt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Et,{className:"hidden md:block space-y-2",children:_}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:_}),c.jsx("div",{className:"space-y-3 p-5 pt-1",children:f.isLoading?c.jsx(De,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):p.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:p.map(k=>{const S=b(k),j=x[k];return c.jsxs(yt,{className:"p-3",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Module"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:S.module})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Service"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:S.service})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Permission"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:S.action})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ln,{onClick:()=>n("edit",k),title:"Edit permission","aria-label":"Edit permission",children:c.jsx(uu,{size:16})}),c.jsx(ln,{variant:"ghost",onClick:()=>v({open:!0,type:"permission",payload:k,label:`Delete permission "${k}"?`}),title:"Delete permission","aria-label":"Delete permission",children:c.jsx(ma,{size:16})})]})]}),j?c.jsxs("div",{className:"mt-2 flex items-baseline gap-1 text-sm min-w-0",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Description"}),c.jsx("span",{className:"text-black/60 dark:text-white/65 truncate",children:j})]}):null]},k)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permissions.":"No permissions available."})})]})]})}function $z({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:a,permissionActionFilter:o,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:b,mergedPermissionDescriptions:x,permissionTree:v,updateLocalPermissionDescription:y}){const{permissionModal:g,setPermissionModal:w,permissionModalError:_,savingPermission:k,openPermissionModal:S,updatePermissionModalField:j,savePermissionModal:N,deletePermissionFromModal:T,setPermissionModalError:A}=Fz({mergedPermissionDescriptions:x,updateLocalPermissionDescription:y}),[z,M]=m.useState({open:!1,type:"",payload:null,label:""}),I=g.module?v.servicesByModule[g.module]||[]:v.allServices,H=g.module&&g.service?v.actionsByService[`${g.module}:${g.service}`]||[]:v.allActions;async function L(){if(!(!z.open||!z.payload))try{await T(z.payload)}finally{M({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(Lz,{permissionSearch:t,setPermissionSearch:e,openPermissionModal:n||S,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:a,permissionActionFilter:o,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:b,mergedPermissionDescriptions:x,setConfirmDelete:M}),c.jsx(zz,{open:g.open,onClose:()=>{w({open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""}),A("")},permissionModal:g,permissionModuleOptions:u,permissionServiceOptions:I,permissionActionOptions:H,updatePermissionModalField:j,permissionModalError:_,savePermissionModal:N,savingPermission:k}),c.jsx(bu,{open:z.open,message:z.label,onClose:()=>M({open:!1,type:"",payload:null,label:""}),onConfirm:L})]})}const fd={open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""};function Fz({mergedPermissionDescriptions:t,updateLocalPermissionDescription:e}){const n=er(),[s,r]=m.useState(fd),[i,a]=m.useState(""),[o,l]=m.useState(!1);function u(p="add",b=""){const x=xg(b),v=b&&t[b]||"";a(""),r({open:!0,mode:p,value:b,original:b,module:x.module,service:x.service,action:x.action,description:v,originalDescription:v})}function d(p,b){r(x=>{const v={...x,[p]:b};return{...v,value:zb(v)}}),a("")}async function h(){var b;const p=zb(s);if(!p){a("Select module, service, and permission.");return}l(!0);try{const x=((b=s.description)==null?void 0:b.trim())||"";if(s.mode==="add")await Dp(p,x),e(p,x);else if(p!==s.original)await Dp(p,x),await U0(s.original),e(s.original,""),e(p,x);else if(x!==s.originalDescription)await Dp(p,x),e(p,x);else{r({...fd});return}n.invalidateQueries({queryKey:["admin","permissions"]}),r({...fd})}catch{}finally{l(!1)}}async function f(p){const b=p||s.original||s.value;if(b){l(!0);try{await U0(b),e(b,""),n.invalidateQueries({queryKey:["admin","permissions"]}),r({...fd})}catch{}finally{l(!1)}}}return{permissionModal:s,setPermissionModal:r,permissionModalError:i,savingPermission:o,openPermissionModal:u,updatePermissionModalField:d,savePermissionModal:h,deletePermissionFromModal:f,setPermissionModalError:a}}function zz({open:t,onClose:e,permissionModal:n,permissionModuleOptions:s,permissionServiceOptions:r,permissionActionOptions:i,updatePermissionModalField:a,permissionModalError:o,savePermissionModal:l,savingPermission:u}){return c.jsx(Jn,{open:t,onClose:e,title:n.mode==="edit"?"Edit permission":"Add permission",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx(xe,{label:"Permission",children:c.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr_auto_1fr] items-center gap-2",children:[c.jsxs("div",{children:[c.jsx("input",{list:"permission-module-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.module,onChange:d=>a("module",d.target.value),placeholder:"module"}),c.jsx("datalist",{id:"permission-module-options",children:s.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-service-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.service,onChange:d=>a("service",d.target.value),placeholder:"service"}),c.jsx("datalist",{id:"permission-service-options",children:r.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-action-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.action,onChange:d=>a("action",d.target.value),placeholder:"permission"}),c.jsx("datalist",{id:"permission-action-options",children:i.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]})]})}),c.jsx(xe,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.description,onChange:d=>a("description",d.target.value),placeholder:"Short description"})}),o?c.jsx("div",{className:"text-xs text-red-600 dark:text-red-300",children:o}):null,c.jsx("div",{className:"flex justify-end",children:c.jsx(Z,{className:"rounded-2xl",onClick:l,disabled:u,children:u?c.jsx(De,{text:"Saving"}):n.mode==="edit"?"Update Permission":"Add Permission"})})]})})}const Bp=20;function Bz(){const{user:t}=jr(),[e,n]=m.useState("users"),[s,r]=m.useState(""),[i,a]=m.useState(0),[o,l]=m.useState(""),[u,d]=m.useState(""),[h,f]=m.useState(""),[p,b]=m.useState(""),[x,v]=m.useState(""),[y,g]=m.useState(""),[w,_]=m.useState(""),[k,S]=m.useState(""),[j,N]=m.useState("");if(!hu(t))return c.jsxs(lt,{children:[c.jsx(Et,{children:c.jsx(At,{children:"Restricted"})}),c.jsx(Pt,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to the admin panel."})]});const T=on({queryKey:["admin","users",i],queryFn:()=>gF({limit:Bp,offset:i*Bp})}),A=on({queryKey:["admin","profiles"],queryFn:kF}),z=on({queryKey:["admin","permissions"],queryFn:NF}),M=on({queryKey:["admin","companies"],queryFn:EF}),I=on({queryKey:["admin","permission-sets"],queryFn:OF}),H=m.useMemo(()=>{var oe;const Y=((oe=T.data)==null?void 0:oe.users)||T.data||[],Q=s.trim().toLowerCase();return Y.filter(X=>{var je,$e,ue,re,_e;const $=Array.isArray(X.profiles)?X.profiles.map(Ge=>(Ge==null?void 0:Ge.display_name)||(Ge==null?void 0:Ge.name)||Ge).filter(Boolean).join(" "):((je=X.profiles)==null?void 0:je.display_name)||(($e=X.profiles)==null?void 0:$e.name)||X.profile||X.profile_name||"",ce=`${X.email||""} ${X.name||""} ${$}`.toLowerCase();if(Q&&!ce.includes(Q))return!1;const me=((ue=X.company)==null?void 0:ue.code)||X.company_code||X.company_id||"";return!(x&&me!==x||y&&!(Array.isArray(X.profiles)?X.profiles.map(mt=>(mt==null?void 0:mt.name)||(mt==null?void 0:mt.display_name)||mt).filter(Boolean):[((re=X.profiles)==null?void 0:re.name)||((_e=X.profiles)==null?void 0:_e.display_name)||X.profile||X.profile_name].filter(Boolean)).includes(y))})},[T.data,s,x,y]);m.useMemo(()=>{var Q;return(((Q=T.data)==null?void 0:Q.users)||T.data||[]).length===Bp},[T.data]),m.useEffect(()=>{S(""),N("")},[w]),m.useEffect(()=>{N("")},[k]);const L=m.useMemo(()=>{var Q;const Y=((Q=A.data)==null?void 0:Q.profiles)??A.data;return Array.isArray(Y)?Y:[]},[A.data]),D=m.useMemo(()=>{var re;const Y=((re=z.data)==null?void 0:re.permissions)??z.data,Q=new Map,oe={},X=(_e,Ge,mt)=>{if(!_e||!Ge||!mt)return;Q.has(_e)||Q.set(_e,new Map);const Lt=Q.get(_e);Lt.has(Ge)||Lt.set(Ge,new Set),Lt.get(Ge).add(mt)};Array.isArray(Y)?Y.forEach(_e=>{const Ge=typeof _e=="string"?_e:_e==null?void 0:_e.name,mt=typeof _e=="string"?"":(_e==null?void 0:_e.description)||"";if(Ge&&mt&&(oe[Ge]=mt),!Ge)return;const Lt=Ge.split(":");Lt.length>=3&&X(Lt[0],Lt[1],Lt[2])}):Y&&typeof Y=="object"&&Object.entries(Y).forEach(([_e,Ge])=>{!Ge||typeof Ge!="object"||Object.entries(Ge).forEach(([mt,Lt])=>{Array.isArray(Lt)&&Lt.forEach(_n=>X(_e,mt,_n))})});const $=Array.from(Q.keys()).sort(),ce={},me={},je=[],$e=new Set,ue=new Set;return $.forEach(_e=>{const Ge=Array.from(Q.get(_e).keys()).sort();ce[_e]=Ge,Ge.forEach(mt=>{$e.add(mt);const Lt=Array.from(Q.get(_e).get(mt)).sort();me[`${_e}:${mt}`]=Lt,Lt.forEach(_n=>{ue.add(_n),je.push(`${_e}:${mt}:${_n}`)})})}),{modules:$,servicesByModule:ce,actionsByService:me,flat:je,allServices:Array.from($e).sort(),allActions:Array.from(ue).sort(),descriptions:oe}},[z.data]),G=m.useMemo(()=>D.flat,[D]),E=D.descriptions||{},[C,F]=m.useState({}),K=m.useMemo(()=>({...E||{},...C}),[E,C]),U=m.useCallback((Y,Q)=>{if(!Y)return;const oe=(Q==null?void 0:Q.trim())||"";F(X=>{const $={...X};return oe?$[Y]=oe:delete $[Y],$})},[]),ie=D.modules,V=w?D.servicesByModule[w]||[]:D.allServices,O=w&&k?D.actionsByService[`${w}:${k}`]||[]:D.allActions,q=m.useMemo(()=>{var Q;const Y=((Q=M.data)==null?void 0:Q.companies)??M.data;return Array.isArray(Y)?Y:[]},[M.data]),ae=m.useMemo(()=>{var Q,oe;const Y=((Q=I.data)==null?void 0:Q.permission_sets)??((oe=I.data)==null?void 0:oe.permissionSets)??I.data;return Array.isArray(Y)?Y.map(X=>typeof X=="string"?{name:X}:X):[]},[I.data]),Ce=m.useMemo(()=>{const Y=u.trim().toLowerCase();return Y?q.filter(Q=>`${Q.name||""} ${Q.code||""} ${Q.country||""} ${Q.currency||""} ${Q.timezone||""}`.toLowerCase().includes(Y)):q},[q,u]),Le=m.useMemo(()=>{const Y=o.trim().toLowerCase();return Y?L.filter(Q=>`${Q.display_name||""} ${Q.name||""} ${Q.description||""}`.toLowerCase().includes(Y)):L},[L,o]),st=m.useMemo(()=>{const Y=h.trim().toLowerCase();return Y?ae.filter(Q=>`${Q.display_name||""} ${Q.name||""} ${Q.description||""}`.toLowerCase().includes(Y)):ae},[ae,h]),be=m.useMemo(()=>{const Y=p.trim().toLowerCase();let Q=G;return(w||k||j)&&(Q=Q.filter(oe=>{const X=xg(oe);return!(w&&X.module!==w||k&&X.service!==k||j&&X.action!==j)})),Y?Q.filter(oe=>{const X=K[oe]||"";return`${oe} ${X}`.toLowerCase().includes(Y)}):Q},[G,p,K,w,k,j]),he=m.useMemo(()=>q.map(Y=>({value:Y.code||Y.id||"",label:Y.name||Y.code||Y.id||""})).filter(Y=>Y.value),[q]),Ke=m.useMemo(()=>L.map(Y=>({value:Y.name||Y.display_name||"",label:Y.display_name||Y.name||""})).filter(Y=>Y.value),[L]),ee=m.useMemo(()=>ae.map(Y=>Y.name||Y.id).filter(Boolean),[ae]),de=m.useMemo(()=>L.map(Y=>Y.name||Y.id).filter(Boolean),[L]),le=m.useMemo(()=>{const Y=new Map;return q.forEach(Q=>{const oe=Q.code||Q.id;oe&&Y.set(oe,Q.name||Q.code||oe)}),Y},[q]);return c.jsxs("div",{className:"flex h-full min-h-0 flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto",children:[c.jsx(Z,{variant:e==="users"?"default":"ghost",onClick:()=>n("users"),className:"rounded-2xl shrink-0",children:"Users"}),c.jsx(Z,{variant:e==="companies"?"default":"ghost",onClick:()=>n("companies"),className:"rounded-2xl shrink-0",children:"Companies"}),c.jsx(Z,{variant:e==="profiles"?"default":"ghost",onClick:()=>n("profiles"),className:"rounded-2xl shrink-0",children:"Profiles"}),c.jsx(Z,{variant:e==="permission-sets"?"default":"ghost",onClick:()=>n("permission-sets"),className:"rounded-2xl shrink-0",children:"Permission Sets"}),c.jsx(Z,{variant:e==="permissions"?"default":"ghost",onClick:()=>n("permissions"),className:"rounded-2xl shrink-0",children:"Permissions"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:e==="users"?"h-full":"hidden","aria-hidden":e!=="users",children:c.jsx(_z,{q:s,setQ:r,usersQuery:T,users:H,user:t,companyLookup:le,userCompanyFilter:x,setUserCompanyFilter:v,userProfileFilter:y,setUserProfileFilter:g,companyFilterOptions:he,profileFilterOptions:Ke,companyList:q,profileOptions:L,profileValues:de,permissionSetList:ae,permissionSetValues:ee,permissionList:G,permissionsQuery:z,page:i})}),c.jsx("div",{className:e==="companies"?"h-full":"hidden","aria-hidden":e!=="companies",children:c.jsx(Cz,{companySearch:u,setCompanySearch:d,companiesQuery:M,filteredCompanyList:Ce,companyLookup:le,companyList:q})}),c.jsx("div",{className:e==="profiles"?"h-full":"hidden","aria-hidden":e!=="profiles",children:c.jsx(Rz,{profileSearch:o,setProfileSearch:l,filteredProfileOptions:Le,permissionList:G,permissionSetValues:ee,permissionSetList:ae,permissionSetsQuery:I,permissionsQuery:z})}),c.jsx("div",{className:e==="permission-sets"?"h-full":"hidden","aria-hidden":e!=="permission-sets",children:c.jsx(Mz,{permissionSetSearch:h,setPermissionSetSearch:f,permissionSetsQuery:I,filteredPermissionSetList:st,permissionList:G,permissionsQuery:z})}),c.jsx("div",{className:e==="permissions"?"h-full":"hidden","aria-hidden":e!=="permissions",children:c.jsx($z,{permissionSearch:p,setPermissionSearch:b,permissionModuleFilter:w,setPermissionModuleFilter:_,permissionServiceFilter:k,setPermissionServiceFilter:S,permissionActionFilter:j,setPermissionActionFilter:N,permissionModuleOptions:ie,permissionFilterServiceOptions:V,permissionFilterActionOptions:O,permissionsQuery:z,filteredPermissionList:be,parsePermissionParts:xg,mergedPermissionDescriptions:K,permissionTree:D,updateLocalPermissionDescription:U})})]})]})}function Uz({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function Wz(){const{notifications:t,loading:e,clearAll:n,dismissNotification:s,markRead:r,formatTime:i}=Cy(),[a,o]=m.useState(null),l=m.useMemo(()=>t,[t]);return c.jsxs("div",{className:"h-full min-h-0",children:[c.jsxs(lt,{className:"h-full flex flex-col",children:[c.jsxs(Et,{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx(At,{children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:l.length?`${l.length} total`:"No alerts yet"})]}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl",onClick:n,disabled:!l.length,children:"Clear all"})]}),c.jsx(Pt,{className:"flex-1 min-h-0 overflow-y-auto pt-2",children:e?c.jsx(De,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"space-y-2",children:l.map(u=>c.jsx(yt,{className:"p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-base font-semibold text-black/85 dark:text-white/85 truncate",children:u.title||"Notification"}),u.message?c.jsx("div",{className:"mt-1 text-sm text-black/60 dark:text-white/65 leading-5 mmg-line-clamp-2",children:u.message}):null,u.created_at?c.jsx("div",{className:"mt-1 text-xs text-black/45 dark:text-white/45",children:i(u.created_at)}):null]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ln,{variant:"ghost",className:"h-8 w-8",onClick:()=>{r(u.id),o(u)},"aria-label":"View notification",children:c.jsx(w1,{size:14})}),c.jsx(ln,{variant:"ghost",className:"h-8 w-8",onClick:()=>s(u.id),"aria-label":"Close notification",children:c.jsx(sy,{size:14})})]})]})},u.id))}):c.jsx(yt,{className:"p-6 text-center text-sm text-black/60 dark:text-white/65",children:"You're all caught up."})})]}),c.jsx(Jn,{open:!!a,onClose:()=>o(null),title:(a==null?void 0:a.title)||"Notification",maxWidth:"520px",children:c.jsx(Uz,{notification:a})})]})}function Hz(){const[t,e]=m.useState(null),[n,s]=m.useState([]),[r,i]=m.useState(""),[a,o]=m.useState(null),[l,u]=m.useState(null),[d,h]=m.useState(!1),[f,p]=m.useState(!1),[b,x]=m.useState(!1),[v,y]=m.useState(null),[g,w]=m.useState({}),[_,k]=m.useState(null),[S,j]=m.useState(!1),[N,T]=m.useState(!1),A=m.useRef(null),z=m.useRef(null),M=m.useRef(null),I=m.useRef(null),H=m.useRef(!0),L=on({queryKey:["video-critique","history"],queryFn:u3,enabled:!0}),D=m.useMemo(()=>(r.trim().length>0||!!a)&&!d,[r,a,d]);m.useEffect(()=>{var q;if(f||L.isLoading)return;const O=L.data;if(O&&((q=O.messages)!=null&&q.length||O.session_id||O.conversation_id)){e(O.session_id||O.conversation_id||null);const ae=(O.messages||[]).map(Qz);s(ae.length?ae:[sw()])}else s([sw()]);p(!0)},[L.data,L.isLoading,f]),m.useEffect(()=>{const O=z.current;if(!O)return;const q=()=>{const Ce=O.scrollHeight-O.scrollTop-O.clientHeight<=120;H.current=Ce};return q(),O.addEventListener("scroll",q,{passive:!0}),()=>O.removeEventListener("scroll",q)},[]);const G=zt.useCallback((O="smooth",q=!1)=>{var ae;!q&&!H.current||(ae=M.current)==null||ae.scrollIntoView({behavior:O,block:"end"})},[]);m.useEffect(()=>{const O=d?"auto":"smooth";requestAnimationFrame(()=>G(O))},[n,d,G]),m.useEffect(()=>{f&&requestAnimationFrame(()=>G("auto",!0))},[f,G]),m.useEffect(()=>()=>{var O,q;return(q=(O=I.current)==null?void 0:O.abort)==null?void 0:q.call(O)},[]);const E=m.useMemo(()=>{var O;return(O=v==null?void 0:v.fields)!=null&&O.length?v.fields.every(q=>{if(!q.required)return!0;const ae=g==null?void 0:g[q.id];return ae!=null&&String(ae).trim()!==""}):!1},[v,g]);function C(){x(!1),y(null),w({}),k(null),j(!1),T(!1)}async function F({formType:O,workflowId:q}){x(!0),j(!0),k({formType:O,workflowId:q}),y(null),w({});try{const ae=await g3(O);y(ae);const Ce={};((ae==null?void 0:ae.fields)||[]).forEach(Le=>{Ce[Le.id]=Le.default_value||""}),w(Ce)}catch(ae){y({title:"Action",submit_text:"Submit",fields:[],error:(ae==null?void 0:ae.message)||"Failed to load form."})}finally{j(!1)}}function K(O,q={}){s(ae=>[...ae,{id:crypto.randomUUID(),role:"assistant",content:O,files:[],status:null,...q}])}async function U(O){if(!O||O.url)return;const q=O.action_id||O.id,ae=O.workflow_id||O.workflowId;if(!q||!ae){K("Missing action details. Please try again.");return}try{T(!0);const Ce=await p3({actionId:q,workflowId:ae});if(Ce!=null&&Ce.requires_form){T(!1),await F({formType:Ce.form_type||O.form_type,workflowId:Ce.workflow_id||ae});return}K((Ce==null?void 0:Ce.message)||"Action completed.")}catch(Ce){K((Ce==null?void 0:Ce.message)||"Unable to complete that action.")}finally{T(!1)}}async function ie(){if(!(!(_!=null&&_.formType)||!(_!=null&&_.workflowId))&&E){T(!0);try{const O=await m3({formType:_.formType,workflowId:_.workflowId,category:g.category,reason:g.reason});C(),K((O==null?void 0:O.message)||"Form submitted.")}catch(O){K((O==null?void 0:O.message)||"Unable to submit the form."),T(!1)}}}async function V(){var ee,de;if(!D)return;const O=r.trim(),q=a,ae=!!l&&!q,Ce=O||(q?`Please review this file: ${q.name}`:"");q&&l&&u(null);const Le=crypto.randomUUID(),st=q?[{file_id:`local-${Date.now()}`,filename:q.name,preview_url:URL.createObjectURL(q)}]:[],be={id:Le,role:"user",content:O,files:st,status:null},he=crypto.randomUUID(),Ke={id:he,role:"assistant",content:"",files:[],status:ae?null:"Reviewing..."};s(le=>[...le,be,Ke]),i(""),o(null),H.current=!0,requestAnimationFrame(()=>G("auto",!0));try{let le=[];if(ae){const $=nw(O);if(!$){s(me=>me.map(je=>je.id===he?{...je,status:null,content:"Please provide a task number to upload this video."}:je));return}h(!0);const ce=await H0({file:l,taskNumber:$});s(me=>me.map(je=>je.id===he?{...je,status:null,content:(ce==null?void 0:ce.message)||"Video uploaded."}:je)),u(null);return}if(q&&Gz(q)){const $=nw(O);if($){h(!0);const ce=await H0({file:q,taskNumber:$});s(me=>me.map(je=>je.id===he?{...je,status:null,content:(ce==null?void 0:ce.message)||"Video uploaded."}:je));return}u(q),s(ce=>ce.map(me=>me.id===he?{...me,status:null,content:"Video received. Which task number is this for?"}:me));return}if(q&&Yz(q)){h(!0);const $=await d3({file:q,message:O||void 0,sessionId:t});if($!=null&&$.session_id&&e(ce=>ce||$.session_id),$!=null&&$.file_id){const ce={file_id:$.file_id,filename:q.name,file_url:$.file_url||$.url||""};s(me=>me.map(je=>{var $e,ue,re,_e;return je.id===Le?{...je,files:[{...ce,preview_url:((ue=($e=je.files)==null?void 0:$e[0])==null?void 0:ue.preview_url)||((_e=(re=je.files)==null?void 0:re[0])==null?void 0:_e.url)||""}]}:je}))}s(ce=>ce.map(me=>me.id===he?{...me,status:null,content:($==null?void 0:$.response)||($==null?void 0:$.message)||"File received."}:me));return}if(q){h(!0);const $=await h3({file:q});if(!($!=null&&$.file_id))throw new Error("Upload failed");le=[$.file_id];const ce={file_id:$.file_id,filename:q.name,file_url:$.file_url||$.url||""};s(me=>me.map(je=>{var $e,ue,re,_e;return je.id===Le?{...je,files:[{...ce,preview_url:((ue=($e=je.files)==null?void 0:$e[0])==null?void 0:ue.preview_url)||((_e=(re=je.files)==null?void 0:re[0])==null?void 0:_e.url)||""}]}:je}))}if(!q&&O.startsWith("/")){h(!0);const ce=O.replace(/^\/+/,"").split(/\\s+/),me=ce.shift()||"",je=ce.join(" "),$e=await f3({command:me,args:je,sessionId:t});$e!=null&&$e.session_id&&e(ue=>ue||$e.session_id),s(ue=>ue.map(re=>re.id===he?{...re,status:null,content:($e==null?void 0:$e.response)||($e==null?void 0:$e.error)||"Command failed."}:re));return}h(!0),(de=(ee=I.current)==null?void 0:ee.abort)==null||de.call(ee);const Y=new AbortController;I.current=Y;let Q="",oe=null,X=!1;await y3({sessionId:t,message:Ce,fileIds:le,signal:Y.signal,onEvent:$=>{var je,$e;if(($!=null&&$.session_id||$!=null&&$.conversation_id)&&e(ue=>ue||$.session_id||$.conversation_id),($==null?void 0:$.type)==="error"||$!=null&&$.error){const ue=($==null?void 0:$.message)||($==null?void 0:$.error)||"Stream error";s(re=>re.map(_e=>_e.id===he?{..._e,status:null,content:`Error: ${ue}`}:_e));return}if(($==null?void 0:$.type)==="status"){s(ue=>ue.map(re=>re.id===he?{...re,status:$.content||"Processing..."}:re)),$.message_id&&(oe=$.message_id);return}if(($==null?void 0:$.type)==="delete"){$.message_id&&$.message_id===oe&&(Q="",oe=null,s(ue=>ue.map(re=>re.id===he?{...re,status:"Reviewing...",content:""}:re)));return}if(($==null?void 0:$.type)==="tool_call"){const ue=$.name||((je=$.tool)==null?void 0:je.name)||"processing";s(re=>re.map(_e=>_e.id===he?{..._e,status:`Processing ${ue}...`}:_e));return}const ce=(($e=$==null?void 0:$.result)==null?void 0:$e.pdf_filename)||($==null?void 0:$.pdf_filename),me=ue=>!ue||!ce||ue.pdf_filename?ue:{...ue,pdf_filename:ce};if(ce&&s(ue=>ue.map(re=>re.id===he&&!re.pdf_filename?{...re,pdf_filename:ce}:re)),($==null?void 0:$.type)==="delta"&&$.content){Q+=$.content,s(ue=>ue.map(re=>re.id===he?{...re,status:null,content:Q}:re));return}if(($==null?void 0:$.type)==="text_done"){Q=$.content||Q,s(ue=>ue.map(re=>re.id===he?{...re,status:null,content:Q}:re));return}if((($==null?void 0:$.type)==="chunk"||($==null?void 0:$.type)==="content")&&$.content){$.message_id&&$.message_id!==oe&&(oe=$.message_id),Q=$.type==="content"?$.content:Q+$.content,s(ue=>ue.map(re=>re.id===he?{...re,status:null,content:Q}:re));return}if($!=null&&$.content&&!$.type){Q+=$.content,s(ue=>ue.map(re=>re.id===he?{...re,status:null,content:Q}:re));return}if(($==null?void 0:$.type)==="actions"&&$.actions){s(ue=>ue.map(re=>re.id===he?{...re,actions:$.actions}:re));return}if($!=null&&$.actions){s(ue=>ue.map(re=>re.id===he?{...re,actions:$.actions}:re));return}if(($==null?void 0:$.type)==="files"&&$.files){if(X=!0,s(ue=>ue.map(re=>re.id===he?{...re,files:[...re.files||[],...$.files.map(me)]}:re)),!Q){const ue=$.files.find(re=>re.comment);ue!=null&&ue.comment&&(Q=ue.comment,s(re=>re.map(_e=>_e.id===he?{..._e,status:null,content:Q}:_e)))}return}if(($==null?void 0:$.type)==="file"&&($.file||$.url)){const ue=me($.file||$);X=!0,s(re=>re.map(_e=>_e.id===he?{..._e,files:[..._e.files||[],ue]}:_e)),!Q&&ue.comment&&(Q=ue.comment,s(re=>re.map(_e=>_e.id===he?{..._e,status:null,content:Q}:_e)));return}if($!=null&&$.files){X=!0,s(ue=>ue.map(re=>re.id===he?{...re,files:[...re.files||[],...$.files.map(me)]}:re));return}typeof $=="string"&&$.trim()&&(Q+=$,s(ue=>ue.map(re=>re.id===he?{...re,status:null,content:Q}:re)))},onDone:()=>{!Q&&!X&&s($=>$.map(ce=>ce.id===he?{...ce,status:null,content:"Ready for the next request when you are."}:ce))}})}catch(le){s(Y=>Y.map(Q=>Q.id===he?{...Q,status:null,content:(le==null?void 0:le.message)||"Failed to get response"}:Q))}finally{h(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(lt,{className:"p-4 overflow-hidden flex-1 min-h-0",children:c.jsx("div",{ref:z,className:"h-full overflow-y-auto px-2",children:c.jsxs("div",{className:"space-y-3",children:[!f&&L.isLoading?c.jsx(De,{text:"Loading conversation",className:"text-sm text-black/60 dark:text-white/65"}):null,n.map(O=>c.jsx(Vz,{msg:O,onMediaLoad:()=>G("auto"),onAction:U,actionsDisabled:N},O.id)),c.jsx("div",{ref:M})]})})}),c.jsxs(lt,{className:"p-3",children:[l&&!a?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsxs("div",{className:"truncate",children:["Awaiting task number for ",l.name]}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>u(null),children:"x"})]}):null,a?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:a.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>o(null),children:"x"})]}):null,c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:A,type:"file",className:"hidden",onChange:O=>{var q;return o(((q=O.target.files)==null?void 0:q[0])||null)},accept:"video/*,image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(Z,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var O;return(O=A.current)==null?void 0:O.click()},children:c.jsx(_1,{size:18})}),c.jsx(qz,{value:r,onChange:i,placeholder:"Describe the video request...",onEnter:V}),c.jsx(Z,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!D,onClick:V,children:c.jsx(k1,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"Share a brief, a link, or upload a cut for review."})]}),c.jsx(Jn,{open:b,onClose:C,title:(v==null?void 0:v.title)||"Action",maxWidth:"520px",children:S?c.jsx(De,{text:"Loading form",className:"text-sm text-black/60 dark:text-white/65"}):v!=null&&v.error?c.jsx("div",{className:"text-sm text-red-600 dark:text-red-300",children:v.error}):c.jsxs("div",{className:"space-y-3",children:[((v==null?void 0:v.fields)||[]).map(O=>{if(O.type==="select"){const q=[{value:"",label:O.placeholder||"Select..."},...O.options||[]];return c.jsx(xe,{label:O.label,children:c.jsx(qe,{value:g[O.id]||"",options:q,onChange:ae=>w(Ce=>({...Ce,[O.id]:ae}))})},O.id)}return O.type==="textarea"?c.jsx(xe,{label:O.label,children:c.jsx("textarea",{rows:3,placeholder:O.placeholder||"",className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g[O.id]||"",onChange:q=>w(ae=>({...ae,[O.id]:q.target.value}))})},O.id):c.jsx(xe,{label:O.label,children:c.jsx("input",{type:"text",placeholder:O.placeholder||"",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g[O.id]||"",onChange:q=>w(ae=>({...ae,[O.id]:q.target.value}))})},O.id)}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:C,children:"Cancel"}),c.jsx(Z,{className:"rounded-2xl",onClick:ie,disabled:!E||N||S,children:(v==null?void 0:v.submit_text)||"Submit"})]})]})})]})}function Vz({msg:t,onMediaLoad:e,onAction:n,actionsDisabled:s}){var h;const r=t.role==="user",i=m.useMemo(()=>n4(t.content||""),[t.content]),a=m.useMemo(()=>zg(t.status||""),[t.status]),o=m.useMemo(()=>!t.status&&Xz(t.content||""),[t.status,t.content]),l=m.useMemo(()=>zg(t.content||""),[t.content]),u=m.useRef(new Map),d=t.actions||t.buttons||[];return c.jsx("div",{className:r?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",r?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[t.status||o?c.jsx(Kz,{text:a||l}):c.jsx("div",{dangerouslySetInnerHTML:{__html:i}}),(h=t.files)!=null&&h.length?c.jsx("div",{className:"mt-2 space-y-1",children:t.files.map((f,p)=>{const b=x3(f);if(!b)return null;const x=f.pdf_filename||t.pdf_filename,v=e4(x?{...f,pdf_filename:x}:f,b,u.current),y=Vl(v),g=["jpg","jpeg","png","gif","webp","bmp"].includes(y),w=!r,_=y==="pdf";return g?c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:w?c.jsxs(c.Fragment,{children:[c.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"block overflow-hidden rounded-lg",children:c.jsx("img",{src:b,alt:v,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(_i,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(Z,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:k=>{k.preventDefault(),pd(b,v)},onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),pd(b,v))},className:"inline-flex items-center",children:[c.jsx(Sa,{size:14,className:"mr-1"}),"Download"]})})]})]}):c.jsx("div",{className:"overflow-hidden rounded-lg",children:c.jsx("img",{src:b,alt:v,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})})},f.file_id||b||p):c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:_?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(ny,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:y?y.toUpperCase():"FILE"})}),w?c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:v}):null]}),w?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Z,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(_i,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(Z,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:k=>{k.preventDefault(),pd(b,v)},onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),pd(b,v))},className:"inline-flex items-center",children:[c.jsx(Sa,{size:14,className:"mr-1"}),"Download"]})})]}):null]})},f.file_id||b||p)})}):null,d.length?c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.map((f,p)=>{const b=f.action_id||f.id||`${f.label}-${p}`,x=f.variant||"secondary";return f.url?c.jsx(Z,{asChild:!0,size:"sm",variant:x,className:"rounded-xl",disabled:s,children:c.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",children:f.label||"Open"})},b):c.jsx(Z,{size:"sm",variant:x,className:"rounded-xl",onClick:()=>n==null?void 0:n(f),disabled:s,children:f.label||"Action"},b)})}):null]})})}function qz({value:t,onChange:e,placeholder:n,onEnter:s,disabled:r}){const i=m.useRef(null);m.useEffect(()=>{const o=i.current;if(!o)return;o.style.height="0px";const u=22*5+16;o.style.height=Math.min(o.scrollHeight,u)+"px"},[t]);function a(o){o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),s==null||s())}return c.jsx("textarea",{ref:i,rows:1,value:t,disabled:r,onChange:o=>e(o.target.value),onKeyDown:a,placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function Kz({text:t}){return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:t||"Reviewing"}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function nw(t){if(!t)return null;const e=String(t).match(/\b(\d{1,6})\b/);return e?Number(e[1]):null}function Gz(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function Yz(t){if(!t)return!1;if(t.type&&t.type.startsWith("image/"))return!0;const e=t.name||"";return/\.(png|jpe?g|gif|webp|bmp)$/i.test(e)}function Qz(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||t.sender||"assistant",content:t.content||t.message||"",files:t.files||t.attachments||[],actions:t.actions||t.buttons||[],pdf_filename:t.pdf_filename||t.pdfFilename,status:null}}function zg(t){return t?String(t).replace(/[_*`]/g,"").replace(/\.+$/,"").replace(/\s+/g," ").trim():""}function Xz(t){const e=zg(t);return e?!!(e==="Reviewing"||e.startsWith("Processing")||e.startsWith("Analyzing")):!1}function Vl(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length<=1?"":n.pop().toLowerCase()}function Jz(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function Zz(t){if(!t)return!0;const e=t.trim().toLowerCase();if(!e||e==="file"||e==="download")return!0;const n=e.replace(/\.[^.]+$/,"");return!!(n==="tmp"||n==="temp"||/^[a-f0-9-]{16,}$/.test(n)||/^file[-_]?\d+$/.test(n)||/^(tmp|temp)/.test(n)||/^upload[-_]?.+$/.test(n))}function e4(t,e,n){const s=(t==null?void 0:t.pdf_filename)||"",r=s||(t==null?void 0:t.filename)||(t==null?void 0:t.title)||"",i=Jz(e),a=(t==null?void 0:t.file_id)||(t==null?void 0:t.id)||e||r;let o=r||i||"";const l=Vl(o)||Vl(i)||Vl(e);if(s){const u=Vl(o)||"pdf";return o.toLowerCase().endsWith(`.${u}`)||(o=`${o}.${u}`),a&&n&&n.set(a,o),o}return Zz(o)?l==="pdf"?o="Review.pdf":l?o=`Attachment.${l}`:o="Attachment":l&&!o.toLowerCase().endsWith(`.${l}`)&&(o=`${o}.${l}`),a&&n&&n.set(a,o),o||(l?`Attachment.${l}`:"Attachment")}async function pd(t,e){try{const n=xf(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=e,document.body.appendChild(a),a.click(),a.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{const n=document.createElement("a");n.href=t,n.download=e,n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),n.remove()}}function sw(){return{id:crypto.randomUUID(),role:"assistant",content:`Good ${t4()}, ready for a video critique?`,files:[],status:null}}function t4(){const t=new Date().getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function Bg(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Pl(t){return t?Bg(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">[Image: $1]</a>').replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/___(.+?)___/g,"<strong><em>$1</em></strong>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(?!INLINE_CODE_|CODE_BLOCK_)(.+?)__/g,"<strong>$1</strong>").replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>").replace(new RegExp("(?<!\\w)_(?!_)(.+?)(?<!_)_(?!\\w)","g"),"<em>$1</em>").replace(/~~(.+?)~~/g,"<del>$1</del>").replace(/==(.+?)==/g,'<mark class="chat-highlight">$1</mark>'):""}function n4(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(d,h,f)=>{const p=e.length;return e.push({lang:h||"",code:f.trim()}),`__CODE_BLOCK_${p}__`});const s=[];n=n.replace(/`([^`]+)`/g,(d,h)=>{const f=s.length;return s.push(h),`__INLINE_CODE_${f}__`});const r=n.split(`
`);let i=[],a=!1,o=!1,l=!1;for(let d=0;d<r.length;d++){let h=r[d];const f=h.match(/^__CODE_BLOCK_(\d+)__$/);if(f){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l&&(i.push("</blockquote>"),l=!1);const y=e[parseInt(f[1],10)],g=y.lang?` class="language-${y.lang}"`:"";i.push(`<pre class="chat-code-block"><code${g}>${Bg(y.code)}</code></pre>`);continue}const p=h.match(/^(#{1,6})\s+(.*)$/);if(p){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l&&(i.push("</blockquote>"),l=!1);const y=p[1].length,g=Pl(p[2]);i.push(`<h${y} class="chat-header chat-h${y}">${g}</h${y}>`);continue}if(/^[-*_]{3,}\s*$/.test(h)){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l&&(i.push("</blockquote>"),l=!1),i.push('<hr class="chat-hr">');continue}const b=h.match(/^>\s*(.*)$/);if(b){a&&(i.push("</ul>"),a=!1),o&&(i.push("</ol>"),o=!1),l||(i.push('<blockquote class="chat-blockquote">'),l=!0),i.push(Pl(b[1])+"<br>");continue}else l&&(i.push("</blockquote>"),l=!1);const x=h.match(/^(\s*)([-*])\s+(.*)$/);if(x){o&&(i.push("</ol>"),o=!1),a||(i.push('<ul class="chat-list">'),a=!0);const y=Pl(x[3]);i.push(`<li>${y}</li>`);continue}else a&&(i.push("</ul>"),a=!1);const v=h.match(/^(\s*)(\d+)\.\s+(.*)$/);if(v){a&&(i.push("</ul>"),a=!1),o||(i.push('<ol class="chat-numbered-list">'),o=!0);const y=Pl(v[3]);i.push(`<li>${y}</li>`);continue}else o&&(i.push("</ol>"),o=!1);if(h.trim()===""){i.push("<br>");continue}i.push(Pl(h)),d<r.length-1&&i.push("<br>")}a&&i.push("</ul>"),o&&i.push("</ol>"),l&&i.push("</blockquote>");let u=i.join("");return s.forEach((d,h)=>{u=u.replace(`__INLINE_CODE_${h}__`,`<code class="chat-inline-code">${Bg(d)}</code>`)}),u}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function _u(t){return t+.5|0}const ri=(t,e,n)=>Math.max(Math.min(t,n),e);function ql(t){return ri(_u(t*2.55),0,255)}function yi(t){return ri(_u(t*255),0,255)}function dr(t){return ri(_u(t/2.55)/100,0,1)}function rw(t){return ri(_u(t*100),0,100)}const ss={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Ug=[..."0123456789ABCDEF"],s4=t=>Ug[t&15],r4=t=>Ug[(t&240)>>4]+Ug[t&15],md=t=>(t&240)>>4===(t&15),i4=t=>md(t.r)&&md(t.g)&&md(t.b)&&md(t.a);function a4(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&ss[t[1]]*17,g:255&ss[t[2]]*17,b:255&ss[t[3]]*17,a:e===5?ss[t[4]]*17:255}:(e===7||e===9)&&(n={r:ss[t[1]]<<4|ss[t[2]],g:ss[t[3]]<<4|ss[t[4]],b:ss[t[5]]<<4|ss[t[6]],a:e===9?ss[t[7]]<<4|ss[t[8]]:255})),n}const o4=(t,e)=>t<255?e(t):"";function l4(t){var e=i4(t)?s4:r4;return t?"#"+e(t.r)+e(t.g)+e(t.b)+o4(t.a,e):void 0}const c4=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function qC(t,e,n){const s=e*Math.min(n,1-n),r=(i,a=(i+t/30)%12)=>n-s*Math.max(Math.min(a-3,9-a,1),-1);return[r(0),r(8),r(4)]}function u4(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function d4(t,e,n){const s=qC(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function h4(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function Py(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),a=Math.min(n,s,r),o=(i+a)/2;let l,u,d;return i!==a&&(d=i-a,u=o>.5?d/(2-i-a):d/(i+a),l=h4(n,s,r,d,i),l=l*60+.5),[l|0,u||0,o]}function Ry(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(yi)}function Ay(t,e,n){return Ry(qC,t,e,n)}function f4(t,e,n){return Ry(d4,t,e,n)}function p4(t,e,n){return Ry(u4,t,e,n)}function KC(t){return(t%360+360)%360}function m4(t){const e=c4.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?ql(+e[5]):yi(+e[5]));const r=KC(+e[2]),i=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?s=f4(r,i,a):e[1]==="hsv"?s=p4(r,i,a):s=Ay(r,i,a),{r:s[0],g:s[1],b:s[2],a:n}}function g4(t,e){var n=Py(t);n[0]=KC(n[0]+e),n=Ay(n),t.r=n[0],t.g=n[1],t.b=n[2]}function x4(t){if(!t)return;const e=Py(t),n=e[0],s=rw(e[1]),r=rw(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${dr(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const iw={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},aw={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function y4(){const t={},e=Object.keys(aw),n=Object.keys(iw);let s,r,i,a,o;for(s=0;s<e.length;s++){for(a=o=e[s],r=0;r<n.length;r++)i=n[r],o=o.replace(i,iw[i]);i=parseInt(aw[a],16),t[o]=[i>>16&255,i>>8&255,i&255]}return t}let gd;function v4(t){gd||(gd=y4(),gd.transparent=[0,0,0,0]);const e=gd[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const b4=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function w4(t){const e=b4.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const a=+e[7];n=e[8]?ql(a):ri(a*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?ql(s):ri(s,0,255)),r=255&(e[4]?ql(r):ri(r,0,255)),i=255&(e[6]?ql(i):ri(i,0,255)),{r:s,g:r,b:i,a:n}}}function _4(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${dr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Up=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Xa=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function k4(t,e,n){const s=Xa(dr(t.r)),r=Xa(dr(t.g)),i=Xa(dr(t.b));return{r:yi(Up(s+n*(Xa(dr(e.r))-s))),g:yi(Up(r+n*(Xa(dr(e.g))-r))),b:yi(Up(i+n*(Xa(dr(e.b))-i))),a:t.a+n*(e.a-t.a)}}function xd(t,e,n){if(t){let s=Py(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Ay(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function GC(t,e){return t&&Object.assign(e||{},t)}function ow(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=yi(t[3]))):(e=GC(t,{r:0,g:0,b:0,a:1}),e.a=yi(e.a)),e}function S4(t){return t.charAt(0)==="r"?w4(t):m4(t)}class Wc{constructor(e){if(e instanceof Wc)return e;const n=typeof e;let s;n==="object"?s=ow(e):n==="string"&&(s=a4(e)||v4(e)||S4(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=GC(this._rgb);return e&&(e.a=dr(e.a)),e}set rgb(e){this._rgb=ow(e)}rgbString(){return this._valid?_4(this._rgb):void 0}hexString(){return this._valid?l4(this._rgb):void 0}hslString(){return this._valid?x4(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const a=n===i?.5:n,o=2*a-1,l=s.a-r.a,u=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;i=1-u,s.r=255&u*s.r+i*r.r+.5,s.g=255&u*s.g+i*r.g+.5,s.b=255&u*s.b+i*r.b+.5,s.a=a*s.a+(1-a)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=k4(this._rgb,e._rgb,n)),this}clone(){return new Wc(this.rgb)}alpha(e){return this._rgb.a=yi(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=_u(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return xd(this._rgb,2,e),this}darken(e){return xd(this._rgb,2,-e),this}saturate(e){return xd(this._rgb,1,e),this}desaturate(e){return xd(this._rgb,1,-e),this}rotate(e){return g4(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function rr(){}const j4=(()=>{let t=0;return()=>t++})();function rt(t){return t==null}function Vt(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function He(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ms(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function $s(t,e){return ms(t)?t:e}function Ue(t,e){return typeof t>"u"?e:t}const C4=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,YC=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function ht(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Je(t,e,n,s){let r,i,a;if(Vt(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(He(t))for(a=Object.keys(t),i=a.length,r=0;r<i;r++)e.call(n,t[a[r]],a[r])}function Fh(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function zh(t){if(Vt(t))return t.map(zh);if(He(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=zh(t[n[r]]);return e}return t}function QC(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function N4(t,e,n,s){if(!QC(t))return;const r=e[t],i=n[t];He(r)&&He(i)?Hc(r,i,s):e[t]=zh(i)}function Hc(t,e,n){const s=Vt(e)?e:[e],r=s.length;if(!He(t))return t;n=n||{};const i=n.merger||N4;let a;for(let o=0;o<r;++o){if(a=s[o],!He(a))continue;const l=Object.keys(a);for(let u=0,d=l.length;u<d;++u)i(l[u],t,a,n)}return t}function oc(t,e){return Hc(t,e,{merger:E4})}function E4(t,e,n){if(!QC(t))return;const s=e[t],r=n[t];He(s)&&He(r)?oc(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=zh(r))}const lw={"":t=>t,x:t=>t.x,y:t=>t.y};function P4(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function R4(t){const e=P4(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function Ca(t,e){return(lw[e]||(lw[e]=R4(e)))(t)}function Oy(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Vc=t=>typeof t<"u",Ci=t=>typeof t=="function",cw=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function A4(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const ft=Math.PI,It=2*ft,Bh=Number.POSITIVE_INFINITY,O4=ft/180,Ut=ft/2,zi=ft/4,uw=ft*2/3,XC=Math.log10,vi=Math.sign;function Qd(t,e,n){return Math.abs(t-e)<n}function dw(t){const e=Math.round(t);t=Qd(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(XC(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function T4(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function M4(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Uh(t){return!M4(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function I4(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function D4(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function yr(t){return t*(ft/180)}function L4(t){return t*(180/ft)}function hw(t){if(!ms(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function JC(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*ft&&(i+=It),{angle:i,distance:r}}function $4(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Us(t){return(t%It+It)%It}function Wh(t,e,n,s){const r=Us(t),i=Us(e),a=Us(n),o=Us(i-r),l=Us(a-r),u=Us(r-i),d=Us(r-a);return r===i||r===a||s&&i===a||o>l&&u<d}function On(t,e,n){return Math.max(e,Math.min(n,t))}function F4(t){return On(t,-32768,32767)}function ta(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function Ty(t,e,n){n=n||(a=>t[a]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Wg=(t,e,n,s)=>Ty(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),z4=(t,e,n)=>Ty(t,n,s=>t[s][e]>=n);function B4(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const ZC=["push","pop","shift","splice","unshift"];function U4(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),ZC.forEach(n=>{const s="_onData"+Oy(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const a=r.apply(this,i);return t._chartjs.listeners.forEach(o=>{typeof o[s]=="function"&&o[s](...i)}),a}})})}function fw(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(ZC.forEach(i=>{delete t[i]}),delete t._chartjs)}function eN(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const tN=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function nN(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,tN.call(window,()=>{s=!1,t.apply(e,n)}))}}function W4(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const sN=t=>t==="start"?"left":t==="end"?"right":"center",Wn=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,H4=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,yd=t=>t===0||t===1,pw=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*It/n)),mw=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*It/n)+1,lc={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Ut)+1,easeOutSine:t=>Math.sin(t*Ut),easeInOutSine:t=>-.5*(Math.cos(ft*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>yd(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>yd(t)?t:pw(t,.075,.3),easeOutElastic:t=>yd(t)?t:mw(t,.075,.3),easeInOutElastic(t){return yd(t)?t:t<.5?.5*pw(t*2,.1125,.45):.5+.5*mw(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-lc.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?lc.easeInBounce(t*2)*.5:lc.easeOutBounce(t*2-1)*.5+.5};function rN(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function gw(t){return rN(t)?t:new Wc(t)}function Wp(t){return rN(t)?t:new Wc(t).saturate(.5).darken(.1).hexString()}const V4=["x","y","borderWidth","radius","tension"],q4=["color","borderColor","backgroundColor"];function K4(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:q4},numbers:{type:"number",properties:V4}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function G4(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const xw=new Map;function Y4(t,e){e=e||{};const n=t+JSON.stringify(e);let s=xw.get(n);return s||(s=new Intl.NumberFormat(t,e),xw.set(n,s)),s}function My(t,e,n){return Y4(e,n).format(t)}const Q4={values(t){return Vt(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),i=X4(t,n)}const a=XC(Math.abs(i)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),My(t,s,l)}};function X4(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var iN={formatters:Q4};function J4(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:iN.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Na=Object.create(null),Hg=Object.create(null);function cc(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function Hp(t,e,n){return typeof e=="string"?Hc(cc(t,e),n):Hc(cc(t,""),e)}class Z4{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Wp(r.backgroundColor),this.hoverBorderColor=(s,r)=>Wp(r.borderColor),this.hoverColor=(s,r)=>Wp(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Hp(this,e,n)}get(e){return cc(this,e)}describe(e,n){return Hp(Hg,e,n)}override(e,n){return Hp(Na,e,n)}route(e,n,s,r){const i=cc(this,e),a=cc(this,s),o="_"+n;Object.defineProperties(i,{[o]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[o],u=a[r];return He(l)?Object.assign({},u,l):Ue(l,u)},set(l){this[o]=l}}})}apply(e){e.forEach(n=>n(this))}}var Ot=new Z4({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[K4,G4,J4]);function e6(t){return!t||rt(t.size)||rt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function yw(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function Bi(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function vw(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function bw(t,e,n,s){aN(t,e,n,s,null)}function aN(t,e,n,s,r){let i,a,o,l,u,d,h,f;const p=e.pointStyle,b=e.rotation,x=e.radius;let v=(b||0)*O4;if(p&&typeof p=="object"&&(i=p.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(v),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(x)||x<=0)){switch(t.beginPath(),p){default:r?t.ellipse(n,s,r/2,x,0,0,It):t.arc(n,s,x,0,It),t.closePath();break;case"triangle":d=r?r/2:x,t.moveTo(n+Math.sin(v)*d,s-Math.cos(v)*x),v+=uw,t.lineTo(n+Math.sin(v)*d,s-Math.cos(v)*x),v+=uw,t.lineTo(n+Math.sin(v)*d,s-Math.cos(v)*x),t.closePath();break;case"rectRounded":u=x*.516,l=x-u,a=Math.cos(v+zi)*l,h=Math.cos(v+zi)*(r?r/2-u:l),o=Math.sin(v+zi)*l,f=Math.sin(v+zi)*(r?r/2-u:l),t.arc(n-h,s-o,u,v-ft,v-Ut),t.arc(n+f,s-a,u,v-Ut,v),t.arc(n+h,s+o,u,v,v+Ut),t.arc(n-f,s+a,u,v+Ut,v+ft),t.closePath();break;case"rect":if(!b){l=Math.SQRT1_2*x,d=r?r/2:l,t.rect(n-d,s-l,2*d,2*l);break}v+=zi;case"rectRot":h=Math.cos(v)*(r?r/2:x),a=Math.cos(v)*x,o=Math.sin(v)*x,f=Math.sin(v)*(r?r/2:x),t.moveTo(n-h,s-o),t.lineTo(n+f,s-a),t.lineTo(n+h,s+o),t.lineTo(n-f,s+a),t.closePath();break;case"crossRot":v+=zi;case"cross":h=Math.cos(v)*(r?r/2:x),a=Math.cos(v)*x,o=Math.sin(v)*x,f=Math.sin(v)*(r?r/2:x),t.moveTo(n-h,s-o),t.lineTo(n+h,s+o),t.moveTo(n+f,s-a),t.lineTo(n-f,s+a);break;case"star":h=Math.cos(v)*(r?r/2:x),a=Math.cos(v)*x,o=Math.sin(v)*x,f=Math.sin(v)*(r?r/2:x),t.moveTo(n-h,s-o),t.lineTo(n+h,s+o),t.moveTo(n+f,s-a),t.lineTo(n-f,s+a),v+=zi,h=Math.cos(v)*(r?r/2:x),a=Math.cos(v)*x,o=Math.sin(v)*x,f=Math.sin(v)*(r?r/2:x),t.moveTo(n-h,s-o),t.lineTo(n+h,s+o),t.moveTo(n+f,s-a),t.lineTo(n-f,s+a);break;case"line":a=r?r/2:Math.cos(v)*x,o=Math.sin(v)*x,t.moveTo(n-a,s-o),t.lineTo(n+a,s+o);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(v)*(r?r/2:x),s+Math.sin(v)*x);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function oN(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Iy(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Dy(t){t.restore()}function t6(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),rt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function n6(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),a=e-i.actualBoundingBoxLeft,o=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,d=r.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(a,d),t.lineTo(o,d),t.stroke()}}function s6(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Hh(t,e,n,s,r,i={}){const a=Vt(e)?e:[e],o=i.strokeWidth>0&&i.strokeColor!=="";let l,u;for(t.save(),t.font=r.string,t6(t,i),l=0;l<a.length;++l)u=a[l],i.backdrop&&s6(t,i.backdrop),o&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),rt(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(u,n,s,i.maxWidth)),t.fillText(u,n,s,i.maxWidth),n6(t,n,s,u,i),s+=Number(r.lineHeight);t.restore()}function Vh(t,e){const{x:n,y:s,w:r,h:i,radius:a}=e;t.arc(n+a.topLeft,s+a.topLeft,a.topLeft,1.5*ft,ft,!0),t.lineTo(n,s+i-a.bottomLeft),t.arc(n+a.bottomLeft,s+i-a.bottomLeft,a.bottomLeft,ft,Ut,!0),t.lineTo(n+r-a.bottomRight,s+i),t.arc(n+r-a.bottomRight,s+i-a.bottomRight,a.bottomRight,Ut,0,!0),t.lineTo(n+r,s+a.topRight),t.arc(n+r-a.topRight,s+a.topRight,a.topRight,0,-Ut,!0),t.lineTo(n+a.topLeft,s)}const r6=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,i6=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function a6(t,e){const n=(""+t).match(r6);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const o6=t=>+t||0;function Ly(t,e){const n={},s=He(e),r=s?Object.keys(e):e,i=He(t)?s?a=>Ue(t[a],t[e[a]]):a=>t[a]:()=>t;for(const a of r)n[a]=o6(i(a));return n}function lN(t){return Ly(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ao(t){return Ly(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Ms(t){const e=lN(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Tn(t,e){t=t||{},e=e||Ot.font;let n=Ue(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Ue(t.style,e.style);s&&!(""+s).match(i6)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:Ue(t.family,e.family),lineHeight:a6(Ue(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:Ue(t.weight,e.weight),string:""};return r.string=e6(r),r}function vd(t,e,n,s){let r,i,a;for(r=0,i=t.length;r<i;++r)if(a=t[r],a!==void 0&&a!==void 0)return a}function l6(t,e,n){const{min:s,max:r}=t,i=YC(e,(r-s)/2),a=(o,l)=>n&&o===0?0:o+l;return{min:a(s,-Math.abs(i)),max:a(r,i)}}function fl(t,e){return Object.assign(Object.create(t),e)}function $y(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=hN("_fallback",t));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:o=>$y([o,...t],e,i,s)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete t[0][l],!0},get(o,l){return uN(o,l,()=>g6(l,e,t,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(o,l){return _w(o).includes(l)},ownKeys(o){return _w(o)},set(o,l,u){const d=o._storage||(o._storage=r());return o[l]=d[l]=u,delete o._keys,!0}})}function sl(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:cN(t,s),setContext:i=>sl(t,i,n,s),override:i=>sl(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,a){return delete i[a],delete t[a],!0},get(i,a,o){return uN(i,a,()=>u6(i,a,o))},getOwnPropertyDescriptor(i,a){return i._descriptors.allKeys?Reflect.has(t,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,a)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,a){return Reflect.has(t,a)},ownKeys(){return Reflect.ownKeys(t)},set(i,a,o){return t[a]=o,delete i[a],!0}})}function cN(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Ci(n)?n:()=>n,isIndexable:Ci(s)?s:()=>s}}const c6=(t,e)=>t?t+Oy(e):e,Fy=(t,e)=>He(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function uN(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function u6(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:a}=t;let o=s[e];return Ci(o)&&a.isScriptable(e)&&(o=d6(e,o,t,n)),Vt(o)&&o.length&&(o=h6(e,o,t,a.isIndexable)),Fy(e,o)&&(o=sl(o,r,i&&i[e],a)),o}function d6(t,e,n,s){const{_proxy:r,_context:i,_subProxy:a,_stack:o}=n;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let l=e(i,a||s);return o.delete(t),Fy(t,l)&&(l=zy(r._scopes,r,t,l)),l}function h6(t,e,n,s){const{_proxy:r,_context:i,_subProxy:a,_descriptors:o}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(He(e[0])){const l=e,u=r._scopes.filter(d=>d!==l);e=[];for(const d of l){const h=zy(u,r,t,d);e.push(sl(h,i,a&&a[t],o))}}return e}function dN(t,e,n){return Ci(t)?t(e,n):t}const f6=(t,e)=>t===!0?e:typeof t=="string"?Ca(e,t):void 0;function p6(t,e,n,s,r){for(const i of e){const a=f6(n,i);if(a){t.add(a);const o=dN(a._fallback,n,r);if(typeof o<"u"&&o!==n&&o!==s)return o}else if(a===!1&&typeof s<"u"&&n!==s)return null}return!1}function zy(t,e,n,s){const r=e._rootScopes,i=dN(e._fallback,n,s),a=[...t,...r],o=new Set;o.add(s);let l=ww(o,a,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=ww(o,a,i,l,s),l===null)?!1:$y(Array.from(o),[""],r,i,()=>m6(e,n,s))}function ww(t,e,n,s,r){for(;n;)n=p6(t,e,n,s,r);return n}function m6(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return Vt(r)&&He(n)?n:r||{}}function g6(t,e,n,s){let r;for(const i of e)if(r=hN(c6(i,t),n),typeof r<"u")return Fy(t,r)?zy(n,s,t,r):r}function hN(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function _w(t){let e=t._keys;return e||(e=t._keys=x6(t._scopes)),e}function x6(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function By(){return typeof window<"u"&&typeof document<"u"}function Uy(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function qh(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Pf=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function y6(t,e){return Pf(t).getPropertyValue(e)}const v6=["top","right","bottom","left"];function ga(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=v6[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const b6=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function w6(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let a=!1,o,l;if(b6(r,i,t.target))o=r,l=i;else{const u=e.getBoundingClientRect();o=s.clientX-u.left,l=s.clientY-u.top,a=!0}return{x:o,y:l,box:a}}function Ki(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=Pf(n),i=r.boxSizing==="border-box",a=ga(r,"padding"),o=ga(r,"border","width"),{x:l,y:u,box:d}=w6(t,n),h=a.left+(d&&o.left),f=a.top+(d&&o.top);let{width:p,height:b}=e;return i&&(p-=a.width+o.width,b-=a.height+o.height),{x:Math.round((l-h)/p*n.width/s),y:Math.round((u-f)/b*n.height/s)}}function _6(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&Uy(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const a=i.getBoundingClientRect(),o=Pf(i),l=ga(o,"border","width"),u=ga(o,"padding");e=a.width-u.width-l.width,n=a.height-u.height-l.height,s=qh(o.maxWidth,i,"clientWidth"),r=qh(o.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||Bh,maxHeight:r||Bh}}const ii=t=>Math.round(t*10)/10;function k6(t,e,n,s){const r=Pf(t),i=ga(r,"margin"),a=qh(r.maxWidth,t,"clientWidth")||Bh,o=qh(r.maxHeight,t,"clientHeight")||Bh,l=_6(t,e,n);let{width:u,height:d}=l;if(r.boxSizing==="content-box"){const f=ga(r,"border","width"),p=ga(r,"padding");u-=p.width+f.width,d-=p.height+f.height}return u=Math.max(0,u-i.width),d=Math.max(0,s?u/s:d-i.height),u=ii(Math.min(u,a,l.maxWidth)),d=ii(Math.min(d,o,l.maxHeight)),u&&!d&&(d=ii(u/2)),(e!==void 0||n!==void 0)&&s&&l.height&&d>l.height&&(d=l.height,u=ii(Math.floor(d*s))),{width:u,height:d}}function kw(t,e,n){const s=e||1,r=ii(t.height*s),i=ii(t.width*s);t.height=ii(t.height),t.width=ii(t.width);const a=t.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||a.height!==r||a.width!==i?(t.currentDevicePixelRatio=s,a.height=r,a.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const S6=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};By()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function Sw(t,e){const n=y6(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const j6=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},C6=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Oo(t,e,n){return t?j6(e,n):C6()}function fN(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function pN(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function bd(t,e,n){return t.options.clip?t[n]:e[n]}function N6(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:bd(n,e,"left"),right:bd(n,e,"right"),top:bd(s,e,"top"),bottom:bd(s,e,"bottom")}:e}function E6(t,e){const n=e._clip;if(n.disabled)return!1;const s=N6(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class P6{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],a=n.duration;i.forEach(o=>o({chart:e,initial:n.initial,numSteps:a,currentStep:Math.min(s-n.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=tN.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let a=i.length-1,o=!1,l;for(;a>=0;--a)l=i[a],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),o=!0):(i[a]=i[i.length-1],i.pop());o&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ar=new P6;const jw="transparent",R6={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=gw(t||jw),r=s.valid&&gw(e||jw);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class A6{constructor(e,n,s,r){const i=n[s];r=vd([e.to,r,i,e.from]);const a=vd([e.from,i,r]);this._active=!0,this._fn=e.fn||R6[e.type||typeof a],this._easing=lc[e.easing]||lc.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,a=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=vd([e.to,n,r,e.from]),this._from=vd([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,a=this._loop,o=this._to;let l;if(this._active=i!==o&&(a||n<s),!this._active){this._target[r]=o,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,o,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class mN{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!He(e))return;const n=Object.keys(Ot.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!He(i))return;const a={};for(const o of n)a[o]=i[o];(Vt(i.properties)&&i.properties||[r]).forEach(o=>{(o===r||!s.has(o))&&s.set(o,a)})})}_animateOptions(e,n){const s=n.options,r=T6(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&O6(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),a=Object.keys(n),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const u=a[l];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,n));continue}const d=n[u];let h=i[u];const f=s.get(u);if(h)if(f&&h.active()){h.update(f,d,o);continue}else h.cancel();if(!f||!f.duration){e[u]=d;continue}i[u]=h=new A6(f,e,u,d),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return ar.add(this._chart,s),!0}}function O6(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function T6(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Cw(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function M6(t,e,n){if(n===!1)return!1;const s=Cw(t,n),r=Cw(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function I6(t){let e,n,s,r;return He(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function gN(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function Nw(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let a,o,l,u;if(e===null)return;let d=!1;for(a=0,o=r.length;a<o;++a){if(l=+r[a],l===n){if(d=!0,s.all)continue;break}u=t.values[l],ms(u)&&(i||e===0||vi(e)===vi(u))&&(e+=u)}return!d&&!s.all?0:e}function D6(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",a=Object.keys(t),o=new Array(a.length);let l,u,d;for(l=0,u=a.length;l<u;++l)d=a[l],o[l]={[r]:d,[i]:t[d]};return o}function Vp(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function L6(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function $6(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function F6(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function Ew(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function Pw(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:a,index:o}=s,l=i.axis,u=a.axis,d=L6(i,a,s),h=e.length;let f;for(let p=0;p<h;++p){const b=e[p],{[l]:x,[u]:v}=b,y=b._stacks||(b._stacks={});f=y[u]=F6(r,d,x),f[o]=v,f._top=Ew(f,a,!0,s.type),f._bottom=Ew(f,a,!1,s.type);const g=f._visualValues||(f._visualValues={});g[o]=v}}function qp(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function z6(t,e){return fl(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function B6(t,e,n){return fl(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Rl(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const Kp=t=>t==="reset"||t==="none",Rw=(t,e)=>e?t:Object.assign({},t),U6=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:gN(n,!0),values:null};class To{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Vp(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Rl(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,f,p,b)=>h==="x"?f:h==="r"?b:p,i=n.xAxisID=Ue(s.xAxisID,qp(e,"x")),a=n.yAxisID=Ue(s.yAxisID,qp(e,"y")),o=n.rAxisID=Ue(s.rAxisID,qp(e,"r")),l=n.indexAxis,u=n.iAxisID=r(l,i,a,o),d=n.vAxisID=r(l,a,i,o);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(a),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&fw(this._data,this),e._stacked&&Rl(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(He(n)){const r=this._cachedMeta;this._data=D6(n,r)}else if(s!==n){if(s){fw(s,this);const r=this._cachedMeta;Rl(r),r._parsed=[]}n&&Object.isExtensible(n)&&U4(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=Vp(n.vScale,n),n.stack!==s.stack&&(r=!0,Rl(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(Pw(this,n._parsed),n._stacked=Vp(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:a}=s,o=i.axis;let l=e===0&&n===r.length?!0:s._sorted,u=e>0&&s._parsed[e-1],d,h,f;if(this._parsing===!1)s._parsed=r,s._sorted=!0,f=r;else{Vt(r[e])?f=this.parseArrayData(s,r,e,n):He(r[e])?f=this.parseObjectData(s,r,e,n):f=this.parsePrimitiveData(s,r,e,n);const p=()=>h[o]===null||u&&h[o]<u[o];for(d=0;d<n;++d)s._parsed[d+e]=h=f[d],l&&(p()&&(l=!1),u=h);s._sorted=l}a&&Pw(this,f)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:a}=e,o=i.axis,l=a.axis,u=i.getLabels(),d=i===a,h=new Array(r);let f,p,b;for(f=0,p=r;f<p;++f)b=f+s,h[f]={[o]:d||i.parse(u[b],b),[l]:a.parse(n[b],b)};return h}parseArrayData(e,n,s,r){const{xScale:i,yScale:a}=e,o=new Array(r);let l,u,d,h;for(l=0,u=r;l<u;++l)d=l+s,h=n[d],o[l]={x:i.parse(h[0],d),y:a.parse(h[1],d)};return o}parseObjectData(e,n,s,r){const{xScale:i,yScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,u=new Array(r);let d,h,f,p;for(d=0,h=r;d<h;++d)f=d+s,p=n[f],u[d]={x:i.parse(Ca(p,o),f),y:a.parse(Ca(p,l),f)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,a=n[e.axis],o={keys:gN(r,!0),values:n._stacks[e.axis]._visualValues};return Nw(o,a,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let a=i===null?NaN:i;const o=r&&s._stacks[n.axis];r&&o&&(r.values=o,a=Nw(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,a=r.length,o=this._getOtherScale(e),l=U6(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=$6(o);let f,p;function b(){p=r[f];const x=p[o.axis];return!ms(p[e.axis])||d>x||h<x}for(f=0;f<a&&!(!b()&&(this.updateRangeFromParsed(u,e,p,l),i));++f);if(i){for(f=a-1;f>=0;--f)if(!b()){this.updateRangeFromParsed(u,e,p,l);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,a;for(r=0,i=n.length;r<i;++r)a=n[r][e.axis],ms(a)&&s.push(a);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=I6(Ue(this.options.clip,M6(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||r.length-o,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(e,i,o,l),d=o;d<o+l;++d){const h=r[d];h.hidden||(h.active&&u?a.push(h):h.draw(e,i))}for(d=0;d<a.length;++d)a[d].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];i=a.$context||(a.$context=B6(this.getContext(),e,a)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=z6(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,a=e+"-"+n,o=i[a],l=this.enableOptionSharing&&Vc(s);if(o)return Rw(o,l);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],f=u.getOptionScopes(this.getDataset(),d),p=Object.keys(Ot.elements[e]),b=()=>this.getContext(s,r,n),x=u.resolveNamedOptions(f,p,b,h);return x.$shared&&(x.$shared=l,i[a]=Object.freeze(Rw(x,l))),x}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,a=`animation-${n}`,o=i[a];if(o)return o;let l;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,n),f=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(f,this.getContext(e,s,n))}const u=new mN(r,l&&l.animations);return l&&l._cacheable&&(i[a]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Kp(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),a=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:a}}updateElement(e,n,s,r){Kp(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!Kp(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[o,l,u]of this._syncList)this[o](l,u);this._syncList=[];const r=s.length,i=n.length,a=Math.min(i,r);a&&this.parse(0,a),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,a=e+n;let o;const l=u=>{for(u.length+=n,o=u.length-1;o>=a;o--)u[o]=u[o-n]};for(l(i),o=e;o<a;++o)i[o]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Rl(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ee(To,"defaults",{}),Ee(To,"datasetElementType",null),Ee(To,"dataElementType",null);function W6(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=eN(s.sort((r,i)=>r-i))}return t._cache.$bar}function H6(t){const e=t.iScale,n=W6(e,t.type);let s=e._length,r,i,a,o;const l=()=>{a===32767||a===-32768||(Vc(o)&&(s=Math.min(s,Math.abs(a-o)||s)),o=a)};for(r=0,i=n.length;r<i;++r)a=e.getPixelForValue(n[r]),l();for(o=void 0,r=0,i=e.ticks.length;r<i;++r)a=e.getPixelForTick(r),l();return s}function V6(t,e,n,s){const r=n.barThickness;let i,a;return rt(r)?(i=e.min*n.categoryPercentage,a=n.barPercentage):(i=r*s,a=1),{chunk:i/s,ratio:a,start:e.pixels[t]-i/2}}function q6(t,e,n,s){const r=e.pixels,i=r[t];let a=t>0?r[t-1]:null,o=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;a===null&&(a=i-(o===null?e.end-e.start:o-i)),o===null&&(o=i+i-a);const u=i-(i-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/s,ratio:n.barPercentage,start:u}}function K6(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),a=Math.min(r,i),o=Math.max(r,i);let l=a,u=o;Math.abs(a)>Math.abs(o)&&(l=o,u=a),e[n.axis]=u,e._custom={barStart:l,barEnd:u,start:r,end:i,min:a,max:o}}function xN(t,e,n,s){return Vt(t)?K6(t,e,n,s):e[n.axis]=n.parse(t,s),e}function Aw(t,e,n,s){const r=t.iScale,i=t.vScale,a=r.getLabels(),o=r===i,l=[];let u,d,h,f;for(u=n,d=n+s;u<d;++u)f=e[u],h={},h[r.axis]=o||r.parse(a[u],u),l.push(xN(f,h,i,u));return l}function Gp(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function G6(t,e,n){return t!==0?vi(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function Y6(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function Q6(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:u,bottom:d}=Y6(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(i[Ow(d,a,o,l)]=!0,r=u)),i[Ow(r,a,o,l)]=!0,t.borderSkipped=i}function Ow(t,e,n,s){return s?(t=X6(t,e,n),t=Tw(t,n,e)):t=Tw(t,e,n),t}function X6(t,e,n){return t===e?n:t===n?e:t}function Tw(t,e,n){return t==="start"?e:t==="end"?n:t}function J6(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class Xd extends To{parsePrimitiveData(e,n,s,r){return Aw(e,n,s,r)}parseArrayData(e,n,s,r){return Aw(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,u=i.axis==="x"?o:l,d=a.axis==="x"?o:l,h=[];let f,p,b,x;for(f=s,p=s+r;f<p;++f)x=n[f],b={},b[i.axis]=i.parse(Ca(x,u),f),h.push(xN(Ca(x,d),b,a,f));return h}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),a=i._custom,o=Gp(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),u=o.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(n,r);for(let p=n;p<n+s;p++){const b=this.getParsed(p),x=i||rt(b[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),v=this._calculateBarIndexPixels(p,d),y=(b._stacks||{})[o.axis],g={horizontal:u,base:x.base,enableBorderRadius:!y||Gp(b._custom)||a===y._top||a===y._bottom,x:u?x.head:v.center,y:u?v.center:x.head,height:u?v.size:Math.abs(x.size),width:u?Math.abs(x.size):v.size};f&&(g.options=h||this.resolveDataElementOptions(p,e[p].active?"active":r));const w=g.options||e[p].options;Q6(g,w,y,a),J6(g,w,d.ratio),this.updateElement(e[p],p,g,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=s.options.stacked,a=[],o=this._cachedMeta.controller.getParsed(n),l=o&&o[s.axis],u=d=>{const h=d._parsed.find(p=>p[s.axis]===l),f=h&&h[d.vScale.axis];if(rt(f)||isNaN(f))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((i===!1||a.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&a.push(d.stack),d.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[Ue(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,a;for(i=0,a=n.data.length;i<a;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const o=e.barThickness;return{min:o||H6(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:a}}=this,o=i||0,l=this.getParsed(e),u=l._custom,d=Gp(u);let h=l[n.axis],f=0,p=s?this.applyStack(n,l,s):h,b,x;p!==h&&(f=p-h,p=h),d&&(h=u.barStart,p=u.barEnd-u.barStart,h!==0&&vi(h)!==vi(u.barEnd)&&(f=0),f+=h);const v=!rt(i)&&!d?i:f;let y=n.getPixelForValue(v);if(this.chart.getDataVisibility(e)?b=n.getPixelForValue(f+p):b=y,x=b-y,Math.abs(x)<a){x=G6(x,n,o)*a,h===o&&(y-=x/2);const g=n.getPixelForDecimal(0),w=n.getPixelForDecimal(1),_=Math.min(g,w),k=Math.max(g,w);y=Math.max(Math.min(y,k),_),b=y+x,s&&!d&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(b)-n.getValueForPixel(y))}if(y===n.getPixelForValue(o)){const g=vi(x)*n.getLineWidthForValue(o)/2;y+=g,x-=g}return{size:x,base:y,head:b,center:b+x/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,a=Ue(r.maxBarThickness,1/0);let o,l;const u=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(e):n.stackCount,h=r.barThickness==="flex"?q6(e,n,r,d*u):V6(e,n,r,d*u),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(Ue(f,this.getFirstScaleIdForIndexAxis())),b=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+p;o=h.start+h.chunk*b+h.chunk/2,l=Math.min(a,h.chunk*h.ratio)}else o=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(a,n.min*n.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}Ee(Xd,"id","bar"),Ee(Xd,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ee(Xd,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function Z6(t,e,n){let s=1,r=1,i=0,a=0;if(e<It){const o=t,l=o+e,u=Math.cos(o),d=Math.sin(o),h=Math.cos(l),f=Math.sin(l),p=(w,_,k)=>Wh(w,o,l,!0)?1:Math.max(_,_*n,k,k*n),b=(w,_,k)=>Wh(w,o,l,!0)?-1:Math.min(_,_*n,k,k*n),x=p(0,u,h),v=p(Ut,d,f),y=b(ft,u,h),g=b(ft+Ut,d,f);s=(x-y)/2,r=(v-g)/2,i=-(x+y)/2,a=-(v+g)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:a}}class yo extends To{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(He(s[e])){const{key:l="value"}=this._parsing;i=u=>+Ca(s[u],l)}let a,o;for(a=e,o=e+n;a<o;++a)r._parsed[a]=i(a)}}_getRotation(){return yr(this.options.rotation-90)}_getCircumference(){return yr(this.options.circumference)}_getRotationExtents(){let e=It,n=-It;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),a=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+a)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,a=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,o=Math.max((Math.min(s.width,s.height)-a)/2,0),l=Math.min(C4(this.options.cutout,o),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:b,offsetY:x}=Z6(h,d,l),v=(s.width-a)/f,y=(s.height-a)/p,g=Math.max(Math.min(v,y)/2,0),w=YC(this.options.radius,g),_=Math.max(w*l,0),k=(w-_)/this._getVisibleDatasetWeightTotal();this.offsetX=b*w,this.offsetY=x*w,r.total=this.calculateTotal(),this.outerRadius=w-k*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-k*u,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/It)}updateElements(e,n,s,r){const i=r==="reset",a=this.chart,o=a.chartArea,u=a.options.animation,d=(o.left+o.right)/2,h=(o.top+o.bottom)/2,f=i&&u.animateScale,p=f?0:this.innerRadius,b=f?0:this.outerRadius,{sharedOptions:x,includeOptions:v}=this._getSharedOptions(n,r);let y=this._getRotation(),g;for(g=0;g<n;++g)y+=this._circumference(g,i);for(g=n;g<n+s;++g){const w=this._circumference(g,i),_=e[g],k={x:d+this.offsetX,y:h+this.offsetY,startAngle:y,endAngle:y+w,circumference:w,outerRadius:b,innerRadius:p};v&&(k.options=x||this.resolveDataElementOptions(g,_.active?"active":r)),y+=w,this.updateElement(_,g,k,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?It*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=My(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,a,o,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){a=s.getDatasetMeta(r),e=a.data,o=a.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=o.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(Ue(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Ee(yo,"id","doughnut"),Ee(yo,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Ee(yo,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Ee(yo,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:a,borderRadius:o}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((l,u)=>{const h=e.getDatasetMeta(0).controller.getStyle(u);return{text:l,fillStyle:h.backgroundColor,fontColor:i,hidden:!e.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:s,borderRadius:a&&(o||h.borderRadius),index:u}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class Vg extends yo{}Ee(Vg,"id","pie"),Ee(Vg,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Ui(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Wy{constructor(e){Ee(this,"options");this.options=e||{}}static override(e){Object.assign(Wy.prototype,e)}init(){}formats(){return Ui()}parse(){return Ui()}format(){return Ui()}add(){return Ui()}diff(){return Ui()}startOf(){return Ui()}endOf(){return Ui()}}var eB={_date:Wy};function tB(t,e,n,s){const{controller:r,data:i,_sorted:a}=t,o=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&i.length){const u=o._reversePixels?z4:Wg;if(s){if(r._sharedOptions){const d=i[0],h=typeof d.getRange=="function"&&d.getRange(e);if(h){const f=u(i,e,n-h),p=u(i,e,n+h);return{lo:f.lo,hi:p.hi}}}}else{const d=u(i,e,n);if(l){const{vScale:h}=r._cachedMeta,{_parsed:f}=t,p=f.slice(0,d.lo+1).reverse().findIndex(x=>!rt(x[h.axis]));d.lo-=Math.max(0,p);const b=f.slice(d.hi).findIndex(x=>!rt(x[h.axis]));d.hi+=Math.max(0,b)}return d}}return{lo:0,hi:i.length-1}}function Rf(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),a=n[e];for(let o=0,l=i.length;o<l;++o){const{index:u,data:d}=i[o],{lo:h,hi:f}=tB(i[o],e,a,r);for(let p=h;p<=f;++p){const b=d[p];b.skip||s(b,u,p)}}}function nB(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,a=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(a,2))}}function Yp(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||Rf(t,n,e,function(o,l,u){!r&&!oN(o,t.chartArea,0)||o.inRange(e.x,e.y,s)&&i.push({element:o,datasetIndex:l,index:u})},!0),i}function sB(t,e,n,s){let r=[];function i(a,o,l){const{startAngle:u,endAngle:d}=a.getProps(["startAngle","endAngle"],s),{angle:h}=JC(a,{x:e.x,y:e.y});Wh(h,u,d)&&r.push({element:a,datasetIndex:o,index:l})}return Rf(t,n,e,i),r}function rB(t,e,n,s,r,i){let a=[];const o=nB(n);let l=Number.POSITIVE_INFINITY;function u(d,h,f){const p=d.inRange(e.x,e.y,r);if(s&&!p)return;const b=d.getCenterPoint(r);if(!(!!i||t.isPointInArea(b))&&!p)return;const v=o(e,b);v<l?(a=[{element:d,datasetIndex:h,index:f}],l=v):v===l&&a.push({element:d,datasetIndex:h,index:f})}return Rf(t,n,e,u),a}function Qp(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?sB(t,e,n,r):rB(t,e,n,s,r,i)}function Mw(t,e,n,s,r){const i=[],a=n==="x"?"inXRange":"inYRange";let o=!1;return Rf(t,n,e,(l,u,d)=>{l[a]&&l[a](e[n],r)&&(i.push({element:l,datasetIndex:u,index:d}),o=o||l.inRange(e.x,e.y,r))}),s&&!o?[]:i}var iB={modes:{index(t,e,n,s){const r=Ki(e,t),i=n.axis||"x",a=n.includeInvisible||!1,o=n.intersect?Yp(t,r,i,s,a):Qp(t,r,i,!1,s,a),l=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const d=o[0].index,h=u.data[d];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:d})}),l):[]},dataset(t,e,n,s){const r=Ki(e,t),i=n.axis||"xy",a=n.includeInvisible||!1;let o=n.intersect?Yp(t,r,i,s,a):Qp(t,r,i,!1,s,a);if(o.length>0){const l=o[0].datasetIndex,u=t.getDatasetMeta(l).data;o=[];for(let d=0;d<u.length;++d)o.push({element:u[d],datasetIndex:l,index:d})}return o},point(t,e,n,s){const r=Ki(e,t),i=n.axis||"xy",a=n.includeInvisible||!1;return Yp(t,r,i,s,a)},nearest(t,e,n,s){const r=Ki(e,t),i=n.axis||"xy",a=n.includeInvisible||!1;return Qp(t,r,i,n.intersect,s,a)},x(t,e,n,s){const r=Ki(e,t);return Mw(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Ki(e,t);return Mw(t,r,"y",n.intersect,s)}}};const yN=["left","top","right","bottom"];function Al(t,e){return t.filter(n=>n.pos===e)}function Iw(t,e){return t.filter(n=>yN.indexOf(n.pos)===-1&&n.box.axis===e)}function Ol(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function aB(t){const e=[];let n,s,r,i,a,o;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:a,stackWeight:o=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&i+a,stackWeight:o});return e}function oB(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!yN.includes(r))continue;const a=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=i}return e}function lB(t,e){const n=oB(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,a,o;for(i=0,a=t.length;i<a;++i){o=t[i];const{fullSize:l}=o.box,u=n[o.stack],d=u&&o.stackWeight/u.weight;o.horizontal?(o.width=d?d*s:l&&e.availableWidth,o.height=r):(o.width=s,o.height=d?d*r:l&&e.availableHeight)}return n}function cB(t){const e=aB(t),n=Ol(e.filter(u=>u.box.fullSize),!0),s=Ol(Al(e,"left"),!0),r=Ol(Al(e,"right")),i=Ol(Al(e,"top"),!0),a=Ol(Al(e,"bottom")),o=Iw(e,"x"),l=Iw(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(a).concat(o),chartArea:Al(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(a).concat(o)}}function Dw(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function vN(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function uB(t,e,n,s){const{pos:r,box:i}=n,a=t.maxPadding;if(!He(r)){n.size&&(t[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,t[r]+=n.size}i.getPadding&&vN(a,i.getPadding());const o=Math.max(0,e.outerWidth-Dw(a,t,"left","right")),l=Math.max(0,e.outerHeight-Dw(a,t,"top","bottom")),u=o!==t.w,d=l!==t.h;return t.w=o,t.h=l,n.horizontal?{same:u,other:d}:{same:d,other:u}}function dB(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function hB(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(a=>{i[a]=Math.max(e[a],n[a])}),i}return s(t?["left","right"]:["top","bottom"])}function Kl(t,e,n,s){const r=[];let i,a,o,l,u,d;for(i=0,a=t.length,u=0;i<a;++i){o=t[i],l=o.box,l.update(o.width||e.w,o.height||e.h,hB(o.horizontal,e));const{same:h,other:f}=uB(e,n,o,s);u|=h&&r.length,d=d||f,l.fullSize||r.push(o)}return u&&Kl(r,e,n,s)||d}function wd(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function Lw(t,e,n,s){const r=n.padding;let{x:i,y:a}=e;for(const o of t){const l=o.box,u=s[o.stack]||{placed:0,weight:1},d=o.stackWeight/u.weight||1;if(o.horizontal){const h=e.w*d,f=u.size||l.height;Vc(u.start)&&(a=u.start),l.fullSize?wd(l,r.left,a,n.outerWidth-r.right-r.left,f):wd(l,e.left+u.placed,a,h,f),u.start=a,u.placed+=h,a=l.bottom}else{const h=e.h*d,f=u.size||l.width;Vc(u.start)&&(i=u.start),l.fullSize?wd(l,i,r.top,f,n.outerHeight-r.bottom-r.top):wd(l,i,e.top+u.placed,f,h),u.start=i,u.placed+=h,i=l.right}}e.x=i,e.y=a}var ai={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=Ms(t.options.layout.padding),i=Math.max(e-r.width,0),a=Math.max(n-r.height,0),o=cB(t.boxes),l=o.vertical,u=o.horizontal;Je(t.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const d=l.reduce((x,v)=>v.box.options&&v.box.options.display===!1?x:x+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:a,vBoxMaxWidth:i/2/d,hBoxMaxHeight:a/2}),f=Object.assign({},r);vN(f,Ms(s));const p=Object.assign({maxPadding:f,w:i,h:a,x:r.left,y:r.top},r),b=lB(l.concat(u),h);Kl(o.fullSize,p,h,b),Kl(l,p,h,b),Kl(u,p,h,b)&&Kl(l,p,h,b),dB(p),Lw(o.leftAndTop,p,h,b),p.x+=p.w,p.y+=p.h,Lw(o.rightAndBottom,p,h,b),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Je(o.chartArea,x=>{const v=x.box;Object.assign(v,t.chartArea),v.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class bN{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class fB extends bN{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Jd="$chartjs",pB={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},$w=t=>t===null||t==="";function mB(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Jd]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",$w(r)){const i=Sw(t,"width");i!==void 0&&(t.width=i)}if($w(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=Sw(t,"height");i!==void 0&&(t.height=i)}return t}const wN=S6?{passive:!0}:!1;function gB(t,e,n){t&&t.addEventListener(e,n,wN)}function xB(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,wN)}function yB(t,e){const n=pB[t.type]||t.type,{x:s,y:r}=Ki(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function Kh(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function vB(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let a=!1;for(const o of i)a=a||Kh(o.addedNodes,s),a=a&&!Kh(o.removedNodes,s);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function bB(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let a=!1;for(const o of i)a=a||Kh(o.removedNodes,s),a=a&&!Kh(o.addedNodes,s);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const qc=new Map;let Fw=0;function _N(){const t=window.devicePixelRatio;t!==Fw&&(Fw=t,qc.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function wB(t,e){qc.size||window.addEventListener("resize",_N),qc.set(t,e)}function _B(t){qc.delete(t),qc.size||window.removeEventListener("resize",_N)}function kB(t,e,n){const s=t.canvas,r=s&&Uy(s);if(!r)return;const i=nN((o,l)=>{const u=r.clientWidth;n(o,l),u<r.clientWidth&&n()},window),a=new ResizeObserver(o=>{const l=o[0],u=l.contentRect.width,d=l.contentRect.height;u===0&&d===0||i(u,d)});return a.observe(r),wB(t,i),a}function Xp(t,e,n){n&&n.disconnect(),e==="resize"&&_B(t)}function SB(t,e,n){const s=t.canvas,r=nN(i=>{t.ctx!==null&&n(yB(i,t))},t);return gB(s,e,r),r}class jB extends bN{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(mB(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Jd])return!1;const s=n[Jd].initial;["height","width"].forEach(i=>{const a=s[i];rt(a)?n.removeAttribute(i):n.setAttribute(i,a)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[Jd],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),a={attach:vB,detach:bB,resize:kB}[n]||SB;r[n]=a(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Xp,detach:Xp,resize:Xp}[n]||xB)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return k6(e,n,s,r)}isAttached(e){const n=e&&Uy(e);return!!(n&&n.isConnected)}}function CB(t){return!By()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?fB:jB}var Pd;let pl=(Pd=class{constructor(){Ee(this,"x");Ee(this,"y");Ee(this,"active",!1);Ee(this,"options");Ee(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return Uh(this.x)&&Uh(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},Ee(Pd,"defaults",{}),Ee(Pd,"defaultRoutes"),Pd);function NB(t,e){const n=t.options.ticks,s=EB(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?RB(e):[],a=i.length,o=i[0],l=i[a-1],u=[];if(a>r)return AB(e,u,i,a/r),u;const d=PB(i,e,r);if(a>0){let h,f;const p=a>1?Math.round((l-o)/(a-1)):null;for(_d(e,u,d,rt(p)?0:o-p,o),h=0,f=a-1;h<f;h++)_d(e,u,d,i[h],i[h+1]);return _d(e,u,d,l,rt(p)?e.length:l+p),u}return _d(e,u,d),u}function EB(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function PB(t,e,n){const s=OB(t),r=e.length/n;if(!s)return Math.max(r,1);const i=T4(s);for(let a=0,o=i.length-1;a<o;a++){const l=i[a];if(l>r)return l}return Math.max(r,1)}function RB(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function AB(t,e,n,s){let r=0,i=n[0],a;for(s=Math.ceil(s),a=0;a<t.length;a++)a===i&&(e.push(t[a]),r++,i=n[r*s])}function _d(t,e,n,s,r){const i=Ue(s,0),a=Math.min(Ue(r,t.length),t.length);let o=0,l,u,d;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),d=i;d<0;)o++,d=Math.round(i+o*n);for(u=Math.max(i,0);u<a;u++)u===d&&(e.push(t[u]),o++,d=Math.round(i+o*n))}function OB(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const TB=t=>t==="left"?"right":t==="right"?"left":t,zw=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Bw=(t,e)=>Math.min(e||t,t);function Uw(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function MB(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,a=t._endPixel,o=1e-6;let l=t.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(l-i,a-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(r-1))/2,l+=r<e?u:-u,l<i-o||l>a+o)))return l}function IB(t,e){Je(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function Tl(t){return t.drawTicks?t.tickLength:0}function Ww(t,e){if(!t.display)return 0;const n=Tn(t.font,e),s=Ms(t.padding);return(Vt(t.text)?t.text.length:1)*n.lineHeight+s.height}function DB(t,e){return fl(t,{scale:e,type:"scale"})}function LB(t,e,n){return fl(t,{tick:n,index:e,type:"tick"})}function $B(t,e,n){let s=sN(t);return(n&&e!=="right"||!n&&e==="right")&&(s=TB(s)),s}function FB(t,e,n,s){const{top:r,left:i,bottom:a,right:o,chart:l}=t,{chartArea:u,scales:d}=l;let h=0,f,p,b;const x=a-r,v=o-i;if(t.isHorizontal()){if(p=Wn(s,i,o),He(n)){const y=Object.keys(n)[0],g=n[y];b=d[y].getPixelForValue(g)+x-e}else n==="center"?b=(u.bottom+u.top)/2+x-e:b=zw(t,n,e);f=o-i}else{if(He(n)){const y=Object.keys(n)[0],g=n[y];p=d[y].getPixelForValue(g)-v+e}else n==="center"?p=(u.left+u.right)/2-v+e:p=zw(t,n,e);b=Wn(s,a,r),h=n==="left"?-Ut:Ut}return{titleX:p,titleY:b,maxWidth:f,rotation:h}}class ml extends pl{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=$s(e,Number.POSITIVE_INFINITY),n=$s(n,Number.NEGATIVE_INFINITY),s=$s(s,Number.POSITIVE_INFINITY),r=$s(r,Number.NEGATIVE_INFINITY),{min:$s(e,s),max:$s(n,r),minDefined:ms(e),maxDefined:ms(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),a;if(r&&i)return{min:n,max:s};const o=this.getMatchingVisibleMetas();for(let l=0,u=o.length;l<u;++l)a=o[l].controller.getMinMax(this,e),r||(n=Math.min(n,a.min)),i||(s=Math.max(s,a.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:$s(n,$s(s,n)),max:$s(s,$s(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ht(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=l6(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?Uw(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=NB(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ht(this.options.afterUpdate,[this])}beforeSetDimensions(){ht(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ht(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),ht(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ht(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=ht(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){ht(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ht(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Bw(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let a=r,o,l,u;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,f=d.highest.height,p=On(this.chart.width-h,0,this.maxWidth);o=e.offset?this.maxWidth/s:p/(s-1),h+6>o&&(o=p/(s-(e.offset?.5:1)),l=this.maxHeight-Tl(e.grid)-n.padding-Ww(e.title,this.chart.options.font),u=Math.sqrt(h*h+f*f),a=L4(Math.min(Math.asin(On((d.highest.height+6)/o,-1,1)),Math.asin(On(l/u,-1,1))-Math.asin(On(f/u,-1,1)))),a=Math.max(r,Math.min(i,a))),this.labelRotation=a}afterCalculateLabelRotation(){ht(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ht(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=Ww(r,n.options.font);if(o?(e.width=this.maxWidth,e.height=Tl(i)+l):(e.height=this.maxHeight,e.width=Tl(i)+l),s.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:f}=this._getLabelSizes(),p=s.padding*2,b=yr(this.labelRotation),x=Math.cos(b),v=Math.sin(b);if(o){const y=s.mirror?0:v*h.width+x*f.height;e.height=Math.min(this.maxHeight,e.height+y+p)}else{const y=s.mirror?0:x*h.width+v*f.height;e.width=Math.min(this.maxWidth,e.width+y+p)}this._calculatePadding(u,d,v,x)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:a},position:o}=this.options,l=this.labelRotation!==0,u=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;l?u?(f=r*e.width,p=s*n.height):(f=s*e.height,p=r*n.width):i==="start"?p=n.width:i==="end"?f=e.width:i!=="inner"&&(f=e.width/2,p=n.width/2),this.paddingLeft=Math.max((f-d+a)*this.width/(this.width-d),0),this.paddingRight=Math.max((p-h+a)*this.width/(this.width-h),0)}else{let d=n.height/2,h=e.height/2;i==="start"?(d=0,h=e.height):i==="end"&&(d=n.height,h=0),this.paddingTop=d+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ht(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)rt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=Uw(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,a=[],o=[],l=Math.floor(n/Bw(n,s));let u=0,d=0,h,f,p,b,x,v,y,g,w,_,k;for(h=0;h<n;h+=l){if(b=e[h].label,x=this._resolveTickFontOptions(h),r.font=v=x.string,y=i[v]=i[v]||{data:{},gc:[]},g=x.lineHeight,w=_=0,!rt(b)&&!Vt(b))w=yw(r,y.data,y.gc,w,b),_=g;else if(Vt(b))for(f=0,p=b.length;f<p;++f)k=b[f],!rt(k)&&!Vt(k)&&(w=yw(r,y.data,y.gc,w,k),_+=g);a.push(w),o.push(_),u=Math.max(w,u),d=Math.max(_,d)}IB(i,n);const S=a.indexOf(u),j=o.indexOf(d),N=T=>({width:a[T]||0,height:o[T]||0});return{first:N(0),last:N(n-1),widest:N(S),highest:N(j),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return F4(this._alignToPixels?Bi(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=LB(this.getContext(),e,s))}return this.$context||(this.$context=DB(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=yr(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),a=e.autoSkipPadding||0,o=i?i.widest.width+a:0,l=i?i.highest.height+a:0;return this.isHorizontal()?l*s>o*r?o/s:l/r:l*r<o*s?l/s:o/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:a,border:o}=r,l=i.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=Tl(i),p=[],b=o.setContext(this.getContext()),x=b.display?b.width:0,v=x/2,y=function(D){return Bi(s,D,x)};let g,w,_,k,S,j,N,T,A,z,M,I;if(a==="top")g=y(this.bottom),j=this.bottom-f,T=g-v,z=y(e.top)+v,I=e.bottom;else if(a==="bottom")g=y(this.top),z=e.top,I=y(e.bottom)-v,j=g+v,T=this.top+f;else if(a==="left")g=y(this.right),S=this.right-f,N=g-v,A=y(e.left)+v,M=e.right;else if(a==="right")g=y(this.left),A=e.left,M=y(e.right)-v,S=g+v,N=this.left+f;else if(n==="x"){if(a==="center")g=y((e.top+e.bottom)/2+.5);else if(He(a)){const D=Object.keys(a)[0],G=a[D];g=y(this.chart.scales[D].getPixelForValue(G))}z=e.top,I=e.bottom,j=g+v,T=j+f}else if(n==="y"){if(a==="center")g=y((e.left+e.right)/2);else if(He(a)){const D=Object.keys(a)[0],G=a[D];g=y(this.chart.scales[D].getPixelForValue(G))}S=g-v,N=S-f,A=e.left,M=e.right}const H=Ue(r.ticks.maxTicksLimit,h),L=Math.max(1,Math.ceil(h/H));for(w=0;w<h;w+=L){const D=this.getContext(w),G=i.setContext(D),E=o.setContext(D),C=G.lineWidth,F=G.color,K=E.dash||[],U=E.dashOffset,ie=G.tickWidth,V=G.tickColor,O=G.tickBorderDash||[],q=G.tickBorderDashOffset;_=MB(this,w,l),_!==void 0&&(k=Bi(s,_,C),u?S=N=A=M=k:j=T=z=I=k,p.push({tx1:S,ty1:j,tx2:N,ty2:T,x1:A,y1:z,x2:M,y2:I,width:C,color:F,borderDash:K,borderDashOffset:U,tickWidth:ie,tickColor:V,tickBorderDash:O,tickBorderDashOffset:q}))}return this._ticksLength=h,this._borderValue=g,p}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:u,padding:d,mirror:h}=i,f=Tl(s.grid),p=f+d,b=h?-d:p,x=-yr(this.labelRotation),v=[];let y,g,w,_,k,S,j,N,T,A,z,M,I="middle";if(r==="top")S=this.bottom-b,j=this._getXAxisLabelAlignment();else if(r==="bottom")S=this.top+b,j=this._getXAxisLabelAlignment();else if(r==="left"){const L=this._getYAxisLabelAlignment(f);j=L.textAlign,k=L.x}else if(r==="right"){const L=this._getYAxisLabelAlignment(f);j=L.textAlign,k=L.x}else if(n==="x"){if(r==="center")S=(e.top+e.bottom)/2+p;else if(He(r)){const L=Object.keys(r)[0],D=r[L];S=this.chart.scales[L].getPixelForValue(D)+p}j=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")k=(e.left+e.right)/2-p;else if(He(r)){const L=Object.keys(r)[0],D=r[L];k=this.chart.scales[L].getPixelForValue(D)}j=this._getYAxisLabelAlignment(f).textAlign}n==="y"&&(l==="start"?I="top":l==="end"&&(I="bottom"));const H=this._getLabelSizes();for(y=0,g=o.length;y<g;++y){w=o[y],_=w.label;const L=i.setContext(this.getContext(y));N=this.getPixelForTick(y)+i.labelOffset,T=this._resolveTickFontOptions(y),A=T.lineHeight,z=Vt(_)?_.length:1;const D=z/2,G=L.color,E=L.textStrokeColor,C=L.textStrokeWidth;let F=j;a?(k=N,j==="inner"&&(y===g-1?F=this.options.reverse?"left":"right":y===0?F=this.options.reverse?"right":"left":F="center"),r==="top"?u==="near"||x!==0?M=-z*A+A/2:u==="center"?M=-H.highest.height/2-D*A+A:M=-H.highest.height+A/2:u==="near"||x!==0?M=A/2:u==="center"?M=H.highest.height/2-D*A:M=H.highest.height-z*A,h&&(M*=-1),x!==0&&!L.showLabelBackdrop&&(k+=A/2*Math.sin(x))):(S=N,M=(1-z)*A/2);let K;if(L.showLabelBackdrop){const U=Ms(L.backdropPadding),ie=H.heights[y],V=H.widths[y];let O=M-U.top,q=0-U.left;switch(I){case"middle":O-=ie/2;break;case"bottom":O-=ie;break}switch(j){case"center":q-=V/2;break;case"right":q-=V;break;case"inner":y===g-1?q-=V:y>0&&(q-=V/2);break}K={left:q,top:O,width:V+U.width,height:ie+U.height,color:L.backdropColor}}v.push({label:_,font:T,textOffset:M,options:{rotation:x,color:G,strokeColor:E,strokeWidth:C,textAlign:F,textBaseline:I,translation:[k,S],backdrop:K}})}return v}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-yr(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,a=this._getLabelSizes(),o=e+i,l=a.widest.width;let u,d;return n==="left"?r?(d=this.right+i,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d+=l)):(d=this.right-o,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+i,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d-=l)):(d=this.left+o,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:a}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,a),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,a;const o=(l,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(i=0,a=r.length;i<a;++i){const l=r[i];n.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),a=s.display?i.width:0;if(!a)return;const o=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,d,h,f;this.isHorizontal()?(u=Bi(e,this.left,a)-a/2,d=Bi(e,this.right,o)+o/2,h=f=l):(h=Bi(e,this.top,a)-a/2,f=Bi(e,this.bottom,o)+o/2,u=d=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,h),n.lineTo(d,f),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&Iy(s,r);const i=this.getLabelItems(e);for(const a of i){const o=a.options,l=a.font,u=a.label,d=a.textOffset;Hh(s,u,0,d,l,o)}r&&Dy(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=Tn(s.font),a=Ms(s.padding),o=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||He(n)?(l+=a.bottom,Vt(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=a.top;const{titleX:u,titleY:d,maxWidth:h,rotation:f}=FB(this,l,n,o);Hh(e,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:f,textAlign:$B(o,n,r),textBaseline:"middle",translation:[u,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Ue(e.grid&&e.grid.z,-1),r=Ue(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==ml.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,a;for(i=0,a=n.length;i<a;++i){const o=n[i];o[s]===this.id&&(!e||o.type===e)&&r.push(o)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Tn(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class kd{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;UB(n)&&(s=this.register(n));const r=this.items,i=e.id,a=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,zB(e,a,s),this.override&&Ot.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in Ot[r]&&(delete Ot[r][s],this.override&&delete Na[s])}}function zB(t,e,n){const s=Hc(Object.create(null),[n?Ot.get(n):{},Ot.get(e),t.defaults]);Ot.set(e,s),t.defaultRoutes&&BB(e,t.defaultRoutes),t.descriptors&&Ot.describe(e,t.descriptors)}function BB(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),a=e[n].split("."),o=a.pop(),l=a.join(".");Ot.route(i,r,l,o)})}function UB(t){return"id"in t&&"defaults"in t}class WB{constructor(){this.controllers=new kd(To,"datasets",!0),this.elements=new kd(pl,"elements"),this.plugins=new kd(Object,"plugins"),this.scales=new kd(ml,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):Je(r,a=>{const o=s||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,n,s){const r=Oy(e);ht(s["before"+r],[],s),n[e](s),ht(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var Bs=new WB;class HB{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=r?this._descriptors(e).filter(r):this._descriptors(e),a=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),a}_notify(e,n,s,r){r=r||{};for(const i of e){const a=i.plugin,o=a[s],l=[n,r,i.options];if(ht(o,l,a)===!1&&r.cancelable)return!1}return!0}invalidate(){rt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=Ue(s.options&&s.options.plugins,{}),i=VB(s);return r===!1&&!n?[]:KB(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,a)=>i.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function VB(t){const e={},n=[],s=Object.keys(Bs.plugins.items);for(let i=0;i<s.length;i++)n.push(Bs.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const a=r[i];n.indexOf(a)===-1&&(n.push(a),e[a.id]=!0)}return{plugins:n,localIds:e}}function qB(t,e){return!e&&t===!1?null:t===!0?{}:t}function KB(t,{plugins:e,localIds:n},s,r){const i=[],a=t.getContext();for(const o of e){const l=o.id,u=qB(s[l],r);u!==null&&i.push({plugin:o,options:GB(t.config,{plugin:o,local:n[l]},u,a)})}return i}function GB(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),a=t.getOptionScopes(s,i);return n&&e.defaults&&a.push(e.defaults),t.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function qg(t,e){const n=Ot.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function YB(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function QB(t,e){return t===e?"_index_":"_value_"}function Hw(t){if(t==="x"||t==="y"||t==="r")return t}function XB(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Kg(t,...e){if(Hw(t))return t;for(const n of e){const s=n.axis||XB(n.position)||t.length>1&&Hw(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Vw(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function JB(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return Vw(t,"x",n[0])||Vw(t,"y",n[0])}return{}}function ZB(t,e){const n=Na[t.type]||{scales:{}},s=e.scales||{},r=qg(t.type,e),i=Object.create(null);return Object.keys(s).forEach(a=>{const o=s[a];if(!He(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=Kg(a,o,JB(a,t),Ot.scales[o.type]),u=QB(l,r),d=n.scales||{};i[a]=oc(Object.create(null),[{axis:l},o,d[l],d[u]])}),t.data.datasets.forEach(a=>{const o=a.type||t.type,l=a.indexAxis||qg(o,e),d=(Na[o]||{}).scales||{};Object.keys(d).forEach(h=>{const f=YB(h,l),p=a[f+"AxisID"]||f;i[p]=i[p]||Object.create(null),oc(i[p],[{axis:f},s[p],d[h]])})}),Object.keys(i).forEach(a=>{const o=i[a];oc(o,[Ot.scales[o.type],Ot.scale])}),i}function kN(t){const e=t.options||(t.options={});e.plugins=Ue(e.plugins,{}),e.scales=ZB(t,e)}function SN(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function eU(t){return t=t||{},t.data=SN(t.data),kN(t),t}const qw=new Map,jN=new Set;function Sd(t,e){let n=qw.get(t);return n||(n=e(),qw.set(t,n),jN.add(n)),n}const Ml=(t,e,n)=>{const s=Ca(e,n);s!==void 0&&t.add(s)};class tU{constructor(e){this._config=eU(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=SN(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),kN(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Sd(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Sd(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Sd(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Sd(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,a=this._cachedScopes(e,s),o=a.get(n);if(o)return o;const l=new Set;n.forEach(d=>{e&&(l.add(e),d.forEach(h=>Ml(l,e,h))),d.forEach(h=>Ml(l,r,h)),d.forEach(h=>Ml(l,Na[i]||{},h)),d.forEach(h=>Ml(l,Ot,h)),d.forEach(h=>Ml(l,Hg,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),jN.has(n)&&a.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,Na[n]||{},Ot.datasets[n]||{},{type:n},Ot,Hg]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:a,subPrefixes:o}=Kw(this._resolverCache,e,r);let l=a;if(sU(a,n)){i.$shared=!1,s=Ci(s)?s():s;const u=this.createResolver(e,s,o);l=sl(a,s,u)}for(const u of n)i[u]=l[u];return i}createResolver(e,n,s=[""],r){const{resolver:i}=Kw(this._resolverCache,e,s);return He(n)?sl(i,n,void 0,r):i}}function Kw(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:$y(e,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},s.set(r,i)),i}const nU=t=>He(t)&&Object.getOwnPropertyNames(t).some(e=>Ci(t[e]));function sU(t,e){const{isScriptable:n,isIndexable:s}=cN(t);for(const r of e){const i=n(r),a=s(r),o=(a||i)&&t[r];if(i&&(Ci(o)||nU(o))||a&&Vt(o))return!0}return!1}var rU="4.5.1";const iU=["top","bottom","left","right","chartArea"];function Gw(t,e){return t==="top"||t==="bottom"||iU.indexOf(t)===-1&&e==="x"}function Yw(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function Qw(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),ht(n&&n.onComplete,[t],e)}function aU(t){const e=t.chart,n=e.options.animation;ht(n&&n.onProgress,[t],e)}function CN(t){return By()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Zd={},Xw=t=>{const e=CN(t);return Object.values(Zd).filter(n=>n.canvas===e).pop()};function oU(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const a=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=a)}}}function lU(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}class qs{static register(...e){Bs.add(...e),Jw()}static unregister(...e){Bs.remove(...e),Jw()}constructor(e,n){const s=this.config=new tU(n),r=CN(e),i=Xw(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const a=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||CB(r)),this.platform.updateConfig(s);const o=this.platform.acquireContext(r,a.aspectRatio),l=o&&o.canvas,u=l&&l.height,d=l&&l.width;if(this.id=j4(),this.ctx=o,this.canvas=l,this.width=d,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new HB,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=W4(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],Zd[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}ar.listen(this,"complete",Qw),ar.listen(this,"progress",aU),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return rt(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Bs}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():kw(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return vw(this.canvas,this.ctx),this}stop(){return ar.stop(this),this}resize(e,n){ar.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,e,n,i),o=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,kw(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),ht(s.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Je(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((a,o)=>(a[o]=!1,a),{});let i=[];n&&(i=i.concat(Object.keys(n).map(a=>{const o=n[a],l=Kg(a,o),u=l==="r",d=l==="x";return{options:o,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),Je(i,a=>{const o=a.options,l=o.id,u=Kg(l,o),d=Ue(o.type,a.dtype);(o.position===void 0||Gw(o.position,u)!==Gw(a.dposition))&&(o.position=a.dposition),r[l]=!0;let h=null;if(l in s&&s[l].type===d)h=s[l];else{const f=Bs.getScale(d);h=new f({id:l,type:d,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(o,e)}),Je(r,(a,o)=>{a||delete s[o]}),Je(s,a=>{ai.configure(this,a,a.options),ai.addBox(this,a)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(Yw("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let a=this.getDatasetMeta(s);const o=i.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(s),a=this.getDatasetMeta(s)),a.type=o,a.indexAxis=i.indexAxis||qg(o,this.options),a.order=i.order||0,a.index=s,a.label=""+i.label,a.visible=this.isDatasetVisible(s),a.controller)a.controller.updateIndex(s),a.controller.linkScales();else{const l=Bs.getController(o),{datasetElementType:u,dataElementType:d}=Ot.datasets[o];Object.assign(l,{dataElementType:Bs.getElement(d),datasetElementType:u&&Bs.getElement(u)}),a.controller=new l(this,s),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){Je(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),f=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(f),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=s.layout.autoPadding?a:0,this._updateLayout(a),r||Je(i,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Yw("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Je(this.scales,e=>{ai.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!cw(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const a=s==="_removeElements"?-i:i;oU(e,r,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(a=>a[0]===i).map((a,o)=>o+","+a.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!cw(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ai.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Je(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Ci(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ar.has(this)?this.attached&&!ar.running(this)&&ar.start(this):(this.draw(),Qw({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const a=n[r];(!e||a.visible)&&s.push(a)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=E6(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&Iy(n,r),e.controller.draw(),r&&Dy(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return oN(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=iB.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=fl(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),a=i.controller._resolveAnimations(void 0,r);Vc(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),a.update(i,{visible:s}),this.update(o=>o.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),ar.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),vw(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Zd[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,a)=>{n.addEventListener(this,i,a),e[i]=a},r=(i,a,o)=>{i.offsetX=a,i.offsetY=o,this._eventHandler(i)};Je(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,u)=>{n.addEventListener(this,l,u),e[l]=u},r=(l,u)=>{e[l]&&(n.removeEventListener(this,l,u),delete e[l])},i=(l,u)=>{this.canvas&&this.resize(l,u)};let a;const o=()=>{r("attach",o),this.attached=!0,this.resize(),s("resize",i),s("detach",a)};a=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",o)},n.isAttached(this.canvas)?o():a()}unbindEvents(){Je(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Je(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,a,o,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),o=0,l=e.length;o<l;++o){a=e[o];const u=a&&this.getDatasetMeta(a.datasetIndex).controller;u&&u[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:a})=>{const o=this.getDatasetMeta(i);if(!o)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:o.data[a],index:a}});!Fh(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,u)=>l.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),a=i(n,e),o=s?e:i(e,n);a.length&&this.updateHoverStyle(a,r.mode,!1),o.length&&r.mode&&this.updateHoverStyle(o,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,a=n,o=this._getActiveElements(e,r,s,a),l=A4(e),u=lU(e,this._lastEvent,s,l);s&&(this._lastEvent=null,ht(i.onHover,[e,o,this],this),l&&ht(i.onClick,[e,o,this],this));const d=!Fh(o,r);return(d||n)&&(this._active=o,this._updateHoverStyles(o,r,n)),this._lastEvent=u,d}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}Ee(qs,"defaults",Ot),Ee(qs,"instances",Zd),Ee(qs,"overrides",Na),Ee(qs,"registry",Bs),Ee(qs,"version",rU),Ee(qs,"getChart",Xw);function Jw(){return Je(qs.instances,t=>t._plugins.invalidate())}function cU(t,e,n){const{startAngle:s,x:r,y:i,outerRadius:a,innerRadius:o,options:l}=e,{borderWidth:u,borderJoinStyle:d}=l,h=Math.min(u/a,Us(s-n));if(t.beginPath(),t.arc(r,i,a-u/2,s+h/2,n-h/2),o>0){const f=Math.min(u/o,Us(s-n));t.arc(r,i,o+u/2,n-f/2,s+f/2,!0)}else{const f=Math.min(u/2,a*Us(s-n));if(d==="round")t.arc(r,i,f,n-ft/2,s+ft/2,!0);else if(d==="bevel"){const p=2*f*f,b=-p*Math.cos(n+ft/2)+r,x=-p*Math.sin(n+ft/2)+i,v=p*Math.cos(s+ft/2)+r,y=p*Math.sin(s+ft/2)+i;t.lineTo(b,x),t.lineTo(v,y)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function uU(t,e,n){const{startAngle:s,pixelMargin:r,x:i,y:a,outerRadius:o,innerRadius:l}=e;let u=r/o;t.beginPath(),t.arc(i,a,o,s-u,n+u),l>r?(u=r/l,t.arc(i,a,l,n+u,s-u,!0)):t.arc(i,a,r,n+Ut,s-Ut),t.closePath(),t.clip()}function dU(t){return Ly(t,["outerStart","outerEnd","innerStart","innerEnd"])}function hU(t,e,n,s){const r=dU(t.options.borderRadius),i=(n-e)/2,a=Math.min(i,s*e/2),o=l=>{const u=(n-Math.min(i,l))*s/2;return On(l,0,Math.min(i,u))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:On(r.innerStart,0,a),innerEnd:On(r.innerEnd,0,a)}}function Ja(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function Gh(t,e,n,s,r,i){const{x:a,y:o,startAngle:l,pixelMargin:u,innerRadius:d}=e,h=Math.max(e.outerRadius+s+n-u,0),f=d>0?d+s+n+u:0;let p=0;const b=r-l;if(s){const L=d>0?d-s:0,D=h>0?h-s:0,G=(L+D)/2,E=G!==0?b*G/(G+s):b;p=(b-E)/2}const x=Math.max(.001,b*h-n/ft)/h,v=(b-x)/2,y=l+v+p,g=r-v-p,{outerStart:w,outerEnd:_,innerStart:k,innerEnd:S}=hU(e,f,h,g-y),j=h-w,N=h-_,T=y+w/j,A=g-_/N,z=f+k,M=f+S,I=y+k/z,H=g-S/M;if(t.beginPath(),i){const L=(T+A)/2;if(t.arc(a,o,h,T,L),t.arc(a,o,h,L,A),_>0){const C=Ja(N,A,a,o);t.arc(C.x,C.y,_,A,g+Ut)}const D=Ja(M,g,a,o);if(t.lineTo(D.x,D.y),S>0){const C=Ja(M,H,a,o);t.arc(C.x,C.y,S,g+Ut,H+Math.PI)}const G=(g-S/f+(y+k/f))/2;if(t.arc(a,o,f,g-S/f,G,!0),t.arc(a,o,f,G,y+k/f,!0),k>0){const C=Ja(z,I,a,o);t.arc(C.x,C.y,k,I+Math.PI,y-Ut)}const E=Ja(j,y,a,o);if(t.lineTo(E.x,E.y),w>0){const C=Ja(j,T,a,o);t.arc(C.x,C.y,w,y-Ut,T)}}else{t.moveTo(a,o);const L=Math.cos(T)*h+a,D=Math.sin(T)*h+o;t.lineTo(L,D);const G=Math.cos(A)*h+a,E=Math.sin(A)*h+o;t.lineTo(G,E)}t.closePath()}function fU(t,e,n,s,r){const{fullCircles:i,startAngle:a,circumference:o}=e;let l=e.endAngle;if(i){Gh(t,e,n,s,l,r);for(let u=0;u<i;++u)t.fill();isNaN(o)||(l=a+(o%It||It))}return Gh(t,e,n,s,l,r),t.fill(),l}function pU(t,e,n,s,r){const{fullCircles:i,startAngle:a,circumference:o,options:l}=e,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:f,borderRadius:p}=l,b=l.borderAlign==="inner";if(!u)return;t.setLineDash(h||[]),t.lineDashOffset=f,b?(t.lineWidth=u*2,t.lineJoin=d||"round"):(t.lineWidth=u,t.lineJoin=d||"bevel");let x=e.endAngle;if(i){Gh(t,e,n,s,x,r);for(let v=0;v<i;++v)t.stroke();isNaN(o)||(x=a+(o%It||It))}b&&uU(t,e,x),l.selfJoin&&x-a>=ft&&p===0&&d!=="miter"&&cU(t,e,x),i||(Gh(t,e,n,s,x,r),t.stroke())}class Gl extends pl{constructor(n){super();Ee(this,"circumference");Ee(this,"endAngle");Ee(this,"fullCircles");Ee(this,"innerRadius");Ee(this,"outerRadius");Ee(this,"pixelMargin");Ee(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:a,distance:o}=JC(i,{x:n,y:s}),{startAngle:l,endAngle:u,innerRadius:d,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),p=(this.options.spacing+this.options.borderWidth)/2,b=Ue(f,u-l),x=Wh(a,l,u)&&l!==u,v=b>=It||x,y=ta(o,d+p,h+p);return v&&y}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:u,spacing:d}=this.options,h=(i+a)/2,f=(o+l+d+u)/2;return{x:s+Math.cos(h)*f,y:r+Math.sin(h)*f}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,a=(s.spacing||0)/2,o=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>It?Math.floor(r/It):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const u=1-Math.sin(Math.min(ft,r||0)),d=i*u;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,fU(n,this,d,a,o),pU(n,this,d,a,o),n.restore()}}Ee(Gl,"id","arc"),Ee(Gl,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Ee(Gl,"defaultRoutes",{backgroundColor:"backgroundColor"}),Ee(Gl,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function NN(t,e){const{x:n,y:s,base:r,width:i,height:a}=t.getProps(["x","y","base","width","height"],e);let o,l,u,d,h;return t.horizontal?(h=a/2,o=Math.min(n,r),l=Math.max(n,r),u=s-h,d=s+h):(h=i/2,o=n-h,l=n+h,u=Math.min(s,r),d=Math.max(s,r)),{left:o,top:u,right:l,bottom:d}}function oi(t,e,n,s){return t?0:On(e,n,s)}function mU(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=lN(s);return{t:oi(r.top,i.top,0,n),r:oi(r.right,i.right,0,e),b:oi(r.bottom,i.bottom,0,n),l:oi(r.left,i.left,0,e)}}function gU(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=Ao(r),a=Math.min(e,n),o=t.borderSkipped,l=s||He(r);return{topLeft:oi(!l||o.top||o.left,i.topLeft,0,a),topRight:oi(!l||o.top||o.right,i.topRight,0,a),bottomLeft:oi(!l||o.bottom||o.left,i.bottomLeft,0,a),bottomRight:oi(!l||o.bottom||o.right,i.bottomRight,0,a)}}function xU(t){const e=NN(t),n=e.right-e.left,s=e.bottom-e.top,r=mU(t,n/2,s/2),i=gU(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function Jp(t,e,n,s){const r=e===null,i=n===null,o=t&&!(r&&i)&&NN(t,s);return o&&(r||ta(e,o.left,o.right))&&(i||ta(n,o.top,o.bottom))}function yU(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function vU(t,e){t.rect(e.x,e.y,e.w,e.h)}function Zp(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,a=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+a,radius:t.radius}}class eh extends pl{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:a}=xU(this),o=yU(a.radius)?Vh:vU;e.save(),(a.w!==i.w||a.h!==i.h)&&(e.beginPath(),o(e,Zp(a,n,i)),e.clip(),o(e,Zp(i,-n,a)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),o(e,Zp(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Jp(this,e,n,s)}inXRange(e,n){return Jp(this,e,null,n)}inYRange(e,n){return Jp(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Ee(eh,"id","bar"),Ee(eh,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ee(eh,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Zw=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},bU=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class e_ extends pl{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=ht(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=Tn(s.font),i=r.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=Zw(s,i);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(a,i,o,l)+10):(d=this.maxHeight,u=this._fitCols(a,r,o,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+o;let h=e;i.textAlign="left",i.textBaseline="middle";let f=-1,p=-d;return this.legendItems.forEach((b,x)=>{const v=s+n/2+i.measureText(b.text).width;(x===0||u[u.length-1]+v+2*o>a)&&(h+=d,u[u.length-(x>0?0:1)]=0,p+=d,f++),l[x]={left:0,top:p,row:f,width:v,height:r},u[u.length-1]+=v+o}),h}_fitCols(e,n,s,r){const{ctx:i,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],d=a-e;let h=o,f=0,p=0,b=0,x=0;return this.legendItems.forEach((v,y)=>{const{itemWidth:g,itemHeight:w}=wU(s,n,i,v,r);y>0&&p+w+2*o>d&&(h+=f+o,u.push({width:f,height:p}),b+=f+o,x++,f=p=0),l[y]={left:b,top:p,col:x,width:g,height:w},f=Math.max(f,g),p+=w+o}),h+=f,u.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,a=Oo(i,this.left,this.width);if(this.isHorizontal()){let o=0,l=Wn(s,this.left+r,this.right-this.lineWidths[o]);for(const u of n)o!==u.row&&(o=u.row,l=Wn(s,this.left+r,this.right-this.lineWidths[o])),u.top+=this.top+e+r,u.left=a.leftForLtr(a.x(l),u.width),l+=u.width+r}else{let o=0,l=Wn(s,this.top+e+r,this.bottom-this.columnSizes[o].height);for(const u of n)u.col!==o&&(o=u.col,l=Wn(s,this.top+e+r,this.bottom-this.columnSizes[o].height)),u.top=l,u.left+=this.left+r,u.left=a.leftForLtr(a.x(u.left),u.width),l+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Iy(e,this),this._draw(),Dy(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:a}=e,o=Ot.color,l=Oo(e.rtl,this.left,this.width),u=Tn(a.font),{padding:d}=a,h=u.size,f=h/2;let p;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:b,boxHeight:x,itemHeight:v}=Zw(a,h),y=function(S,j,N){if(isNaN(b)||b<=0||isNaN(x)||x<0)return;r.save();const T=Ue(N.lineWidth,1);if(r.fillStyle=Ue(N.fillStyle,o),r.lineCap=Ue(N.lineCap,"butt"),r.lineDashOffset=Ue(N.lineDashOffset,0),r.lineJoin=Ue(N.lineJoin,"miter"),r.lineWidth=T,r.strokeStyle=Ue(N.strokeStyle,o),r.setLineDash(Ue(N.lineDash,[])),a.usePointStyle){const A={radius:x*Math.SQRT2/2,pointStyle:N.pointStyle,rotation:N.rotation,borderWidth:T},z=l.xPlus(S,b/2),M=j+f;aN(r,A,z,M,a.pointStyleWidth&&b)}else{const A=j+Math.max((h-x)/2,0),z=l.leftForLtr(S,b),M=Ao(N.borderRadius);r.beginPath(),Object.values(M).some(I=>I!==0)?Vh(r,{x:z,y:A,w:b,h:x,radius:M}):r.rect(z,A,b,x),r.fill(),T!==0&&r.stroke()}r.restore()},g=function(S,j,N){Hh(r,N.text,S,j+v/2,u,{strikethrough:N.hidden,textAlign:l.textAlign(N.textAlign)})},w=this.isHorizontal(),_=this._computeTitleHeight();w?p={x:Wn(i,this.left+d,this.right-s[0]),y:this.top+d+_,line:0}:p={x:this.left+d,y:Wn(i,this.top+_+d,this.bottom-n[0].height),line:0},fN(this.ctx,e.textDirection);const k=v+d;this.legendItems.forEach((S,j)=>{r.strokeStyle=S.fontColor,r.fillStyle=S.fontColor;const N=r.measureText(S.text).width,T=l.textAlign(S.textAlign||(S.textAlign=a.textAlign)),A=b+f+N;let z=p.x,M=p.y;l.setWidth(this.width),w?j>0&&z+A+d>this.right&&(M=p.y+=k,p.line++,z=p.x=Wn(i,this.left+d,this.right-s[p.line])):j>0&&M+k>this.bottom&&(z=p.x=z+n[p.line].width+d,p.line++,M=p.y=Wn(i,this.top+_+d,this.bottom-n[p.line].height));const I=l.x(z);if(y(I,M,S),z=H4(T,z+b+f,w?z+A:this.right,e.rtl),g(l.x(z),M,S),w)p.x+=A+d;else if(typeof S.text!="string"){const H=u.lineHeight;p.y+=EN(S,H)+d}else p.y+=k}),pN(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=Tn(n.font),r=Ms(n.padding);if(!n.display)return;const i=Oo(e.rtl,this.left,this.width),a=this.ctx,o=n.position,l=s.size/2,u=r.top+l;let d,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),d=this.top+u,h=Wn(e.align,h,this.right-f);else{const b=this.columnSizes.reduce((x,v)=>Math.max(x,v.height),0);d=u+Wn(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const p=Wn(o,h,h+f);a.textAlign=i.textAlign(sN(o)),a.textBaseline="middle",a.strokeStyle=n.color,a.fillStyle=n.color,a.font=s.string,Hh(a,n.text,p,d,s)}_computeTitleHeight(){const e=this.options.title,n=Tn(e.font),s=Ms(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(ta(e,this.left,this.right)&&ta(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],ta(e,r.left,r.left+r.width)&&ta(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!SU(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=bU(r,s);r&&!i&&ht(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&ht(n.onHover,[e,s,this],this)}else s&&ht(n.onClick,[e,s,this],this)}}function wU(t,e,n,s,r){const i=_U(s,t,e,n),a=kU(r,s,e.lineHeight);return{itemWidth:i,itemHeight:a}}function _U(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,a)=>i.length>a.length?i:a)),e+n.size/2+s.measureText(r).width}function kU(t,e,n){let s=t;return typeof e.text!="string"&&(s=EN(e,n)),s}function EN(t,e){const n=t.text?t.text.length:0;return e*n}function SU(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var jU={id:"legend",_element:e_,start(t,e,n){const s=t.legend=new e_({ctx:t.ctx,options:n,chart:t});ai.configure(t,s,n),ai.addBox(t,s)},stop(t){ai.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;ai.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:a,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(n?0:void 0),d=Ms(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:a&&(o||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const Yl={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const o=t[e].element;if(o&&o.hasValue()){const l=o.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((o,l)=>o+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,a,o;for(i=0,a=t.length;i<a;++i){const l=t[i].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),d=$4(e,u);d<r&&(r=d,o=l)}}if(o){const l=o.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function Fs(t,e){return e&&(Vt(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function or(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function CU(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:a,value:o}=i.getLabelAndValue(r);return{chart:t,label:a,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:o,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function t_(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:a,boxHeight:o}=e,l=Tn(e.bodyFont),u=Tn(e.titleFont),d=Tn(e.footerFont),h=i.length,f=r.length,p=s.length,b=Ms(e.padding);let x=b.height,v=0,y=s.reduce((_,k)=>_+k.before.length+k.lines.length+k.after.length,0);if(y+=t.beforeBody.length+t.afterBody.length,h&&(x+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),y){const _=e.displayColors?Math.max(o,l.lineHeight):l.lineHeight;x+=p*_+(y-p)*l.lineHeight+(y-1)*e.bodySpacing}f&&(x+=e.footerMarginTop+f*d.lineHeight+(f-1)*e.footerSpacing);let g=0;const w=function(_){v=Math.max(v,n.measureText(_).width+g)};return n.save(),n.font=u.string,Je(t.title,w),n.font=l.string,Je(t.beforeBody.concat(t.afterBody),w),g=e.displayColors?a+2+e.boxPadding:0,Je(s,_=>{Je(_.before,w),Je(_.lines,w),Je(_.after,w)}),g=0,n.font=d.string,Je(t.footer,w),n.restore(),v+=b.width,{width:v,height:x}}function NU(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function EU(t,e,n,s){const{x:r,width:i}=s,a=n.caretSize+n.caretPadding;if(t==="left"&&r+i+a>e.width||t==="right"&&r-i-a<0)return!0}function PU(t,e,n,s){const{x:r,width:i}=n,{width:a,chartArea:{left:o,right:l}}=t;let u="center";return s==="center"?u=r<=(o+l)/2?"left":"right":r<=i/2?u="left":r>=a-i/2&&(u="right"),EU(u,t,e,n)&&(u="center"),u}function n_(t,e,n){const s=n.yAlign||e.yAlign||NU(t,n);return{xAlign:n.xAlign||e.xAlign||PU(t,e,n,s),yAlign:s}}function RU(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function AU(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function s_(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:a}=t,{xAlign:o,yAlign:l}=n,u=r+i,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Ao(a);let b=RU(e,o);const x=AU(e,l,u);return l==="center"?o==="left"?b+=u:o==="right"&&(b-=u):o==="left"?b-=Math.max(d,f)+r:o==="right"&&(b+=Math.max(h,p)+r),{x:On(b,0,s.width-e.width),y:On(x,0,s.height-e.height)}}function jd(t,e,n){const s=Ms(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function r_(t){return Fs([],or(t))}function OU(t,e,n){return fl(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function i_(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const PN={beforeTitle:rr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:rr,beforeBody:rr,beforeLabel:rr,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return rt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:rr,afterBody:rr,beforeFooter:rr,footer:rr,afterFooter:rr};function Sn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?PN[e].call(n,s):r}class Gg extends pl{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new mN(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=OU(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=Sn(s,"beforeTitle",this,e),i=Sn(s,"title",this,e),a=Sn(s,"afterTitle",this,e);let o=[];return o=Fs(o,or(r)),o=Fs(o,or(i)),o=Fs(o,or(a)),o}getBeforeBody(e,n){return r_(Sn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return Je(e,i=>{const a={before:[],lines:[],after:[]},o=i_(s,i);Fs(a.before,or(Sn(o,"beforeLabel",this,i))),Fs(a.lines,Sn(o,"label",this,i)),Fs(a.after,or(Sn(o,"afterLabel",this,i))),r.push(a)}),r}getAfterBody(e,n){return r_(Sn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=Sn(s,"beforeFooter",this,e),i=Sn(s,"footer",this,e),a=Sn(s,"afterFooter",this,e);let o=[];return o=Fs(o,or(r)),o=Fs(o,or(i)),o=Fs(o,or(a)),o}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],a=[];let o=[],l,u;for(l=0,u=n.length;l<u;++l)o.push(CU(this.chart,n[l]));return e.filter&&(o=o.filter((d,h,f)=>e.filter(d,h,f,s))),e.itemSort&&(o=o.sort((d,h)=>e.itemSort(d,h,s))),Je(o,d=>{const h=i_(e.callbacks,d);r.push(Sn(h,"labelColor",this,d)),i.push(Sn(h,"labelPointStyle",this,d)),a.push(Sn(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=a,this.dataPoints=o,o}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,a=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const o=Yl[s.position].call(this,r,this._eventPosition);a=this._createItems(s),this.title=this.getTitle(a,s),this.beforeBody=this.getBeforeBody(a,s),this.body=this.getBody(a,s),this.afterBody=this.getAfterBody(a,s),this.footer=this.getFooter(a,s);const l=this._size=t_(this,s),u=Object.assign({},o,l),d=n_(this.chart,s,u),h=s_(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:a,cornerRadius:o}=s,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:h}=Ao(o),{x:f,y:p}=e,{width:b,height:x}=n;let v,y,g,w,_,k;return i==="center"?(_=p+x/2,r==="left"?(v=f,y=v-a,w=_+a,k=_-a):(v=f+b,y=v+a,w=_-a,k=_+a),g=v):(r==="left"?y=f+Math.max(l,d)+a:r==="right"?y=f+b-Math.max(u,h)-a:y=this.caretX,i==="top"?(w=p,_=w-a,v=y-a,g=y+a):(w=p+x,_=w+a,v=y+a,g=y-a),k=w),{x1:v,x2:y,x3:g,y1:w,y2:_,y3:k}}drawTitle(e,n,s){const r=this.title,i=r.length;let a,o,l;if(i){const u=Oo(s.rtl,this.x,this.width);for(e.x=jd(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",a=Tn(s.titleFont),o=s.titleSpacing,n.fillStyle=s.titleColor,n.font=a.string,l=0;l<i;++l)n.fillText(r[l],u.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,l+1===i&&(e.y+=s.titleMarginBottom-o)}}_drawColorBox(e,n,s,r,i){const a=this.labelColors[s],o=this.labelPointStyles[s],{boxHeight:l,boxWidth:u}=i,d=Tn(i.bodyFont),h=jd(this,"left",i),f=r.x(h),p=l<d.lineHeight?(d.lineHeight-l)/2:0,b=n.y+p;if(i.usePointStyle){const x={radius:Math.min(u,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},v=r.leftForLtr(f,u)+u/2,y=b+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,bw(e,x,v,y),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,bw(e,x,v,y)}else{e.lineWidth=He(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const x=r.leftForLtr(f,u),v=r.leftForLtr(r.xPlus(f,1),u-2),y=Ao(a.borderRadius);Object.values(y).some(g=>g!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,Vh(e,{x,y:b,w:u,h:l,radius:y}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),Vh(e,{x:v,y:b+1,w:u-2,h:l-2,radius:y}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(x,b,u,l),e.strokeRect(x,b,u,l),e.fillStyle=a.backgroundColor,e.fillRect(v,b+1,u-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:u,boxPadding:d}=s,h=Tn(s.bodyFont);let f=h.lineHeight,p=0;const b=Oo(s.rtl,this.x,this.width),x=function(N){n.fillText(N,b.x(e.x+p),e.y+f/2),e.y+=f+i},v=b.textAlign(a);let y,g,w,_,k,S,j;for(n.textAlign=a,n.textBaseline="middle",n.font=h.string,e.x=jd(this,v,s),n.fillStyle=s.bodyColor,Je(this.beforeBody,x),p=o&&v!=="right"?a==="center"?u/2+d:u+2+d:0,_=0,S=r.length;_<S;++_){for(y=r[_],g=this.labelTextColors[_],n.fillStyle=g,Je(y.before,x),w=y.lines,o&&w.length&&(this._drawColorBox(n,e,_,b,s),f=Math.max(h.lineHeight,l)),k=0,j=w.length;k<j;++k)x(w[k]),f=h.lineHeight;Je(y.after,x)}p=0,f=h.lineHeight,Je(this.afterBody,x),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let a,o;if(i){const l=Oo(s.rtl,this.x,this.width);for(e.x=jd(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",a=Tn(s.footerFont),n.fillStyle=s.footerColor,n.font=a.string,o=0;o<i;++o)n.fillText(r[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:a}=this,{x:o,y:l}=e,{width:u,height:d}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:b}=Ao(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(o+h,l),a==="top"&&this.drawCaret(e,n,s,r),n.lineTo(o+u-f,l),n.quadraticCurveTo(o+u,l,o+u,l+f),a==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(o+u,l+d-b),n.quadraticCurveTo(o+u,l+d,o+u-b,l+d),a==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(o+p,l+d),n.quadraticCurveTo(o,l+d,o,l+d-p),a==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(o,l+h),n.quadraticCurveTo(o,l,o+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const a=Yl[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=t_(this,e),l=Object.assign({},a,this._size),u=n_(n,e,l),d=s_(e,l,u,n);(r._to!==d.x||i._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const a=Ms(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),fN(e,n.textDirection),i.y+=a.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),pN(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:o,index:l})=>{const u=this.chart.getDatasetMeta(o);if(!u)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:u.data[l],index:l}}),i=!Fh(s,r),a=this._positionChanged(r,n);(i||a)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],a=this._getActiveElements(e,i,n,s),o=this._positionChanged(a,e),l=n||!Fh(a,i)||o;return l&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&a.reverse(),a}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,a=Yl[i.position].call(this,e,n);return a!==!1&&(s!==a.x||r!==a.y)}}Ee(Gg,"positioners",Yl);var TU={id:"tooltip",_element:Gg,positioners:Yl,afterInit(t,e,n){n&&(t.tooltip=new Gg({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:PN},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const MU=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function IU(t,e,n,s){const r=t.indexOf(e);if(r===-1)return MU(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const DU=(t,e)=>t===null?null:On(Math.round(t),0,e);function a_(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Yg extends ml{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(rt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:IU(s,e,Ue(n,e),this._addedLabels),DU(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let a=e;a<=n;a++)r.push({value:a});return r}getLabelForValue(e){return a_.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Ee(Yg,"id","category"),Ee(Yg,"defaults",{ticks:{callback:a_}});function LU(t,e){const n=[],{bounds:r,step:i,min:a,max:o,precision:l,count:u,maxTicks:d,maxDigits:h,includeBounds:f}=t,p=i||1,b=d-1,{min:x,max:v}=e,y=!rt(a),g=!rt(o),w=!rt(u),_=(v-x)/(h+1);let k=dw((v-x)/b/p)*p,S,j,N,T;if(k<1e-14&&!y&&!g)return[{value:x},{value:v}];T=Math.ceil(v/k)-Math.floor(x/k),T>b&&(k=dw(T*k/b/p)*p),rt(l)||(S=Math.pow(10,l),k=Math.ceil(k*S)/S),r==="ticks"?(j=Math.floor(x/k)*k,N=Math.ceil(v/k)*k):(j=x,N=v),y&&g&&i&&I4((o-a)/i,k/1e3)?(T=Math.round(Math.min((o-a)/k,d)),k=(o-a)/T,j=a,N=o):w?(j=y?a:j,N=g?o:N,T=u-1,k=(N-j)/T):(T=(N-j)/k,Qd(T,Math.round(T),k/1e3)?T=Math.round(T):T=Math.ceil(T));const A=Math.max(hw(k),hw(j));S=Math.pow(10,rt(l)?A:l),j=Math.round(j*S)/S,N=Math.round(N*S)/S;let z=0;for(y&&(f&&j!==a?(n.push({value:a}),j<a&&z++,Qd(Math.round((j+z*k)*S)/S,a,o_(a,_,t))&&z++):j<a&&z++);z<T;++z){const M=Math.round((j+z*k)*S)/S;if(g&&M>o)break;n.push({value:M})}return g&&f&&N!==o?n.length&&Qd(n[n.length-1].value,o,o_(o,_,t))?n[n.length-1].value=o:n.push({value:o}):(!g||N===o)&&n.push({value:N}),n}function o_(t,e,{horizontal:n,minRotation:s}){const r=yr(s),i=(n?Math.sin(r):Math.cos(r))||.001,a=.75*e*(""+t).length;return Math.min(e/i,a)}class $U extends ml{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return rt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const a=l=>r=n?r:l,o=l=>i=s?i:l;if(e){const l=vi(r),u=vi(i);l<0&&u<0?o(0):l>0&&u>0&&a(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);o(i+l),e||a(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,a=LU(r,i);return e.bounds==="ticks"&&D4(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return My(e,this.chart.options.locale,this.options.ticks.format)}}class Qg extends $U{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ms(e)?e:0,this.max=ms(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=yr(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Ee(Qg,"id","linear"),Ee(Qg,"defaults",{ticks:{callback:iN.formatters.numeric}});const Af={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Pn=Object.keys(Af);function l_(t,e){return t-e}function c_(t,e){if(rt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let a=e;return typeof s=="function"&&(a=s(a)),ms(a)||(a=typeof s=="string"?n.parse(a,s):n.parse(a)),a===null?null:(r&&(a=r==="week"&&(Uh(i)||i===!0)?n.startOf(a,"isoWeek",i):n.startOf(a,r)),+a)}function u_(t,e,n,s){const r=Pn.length;for(let i=Pn.indexOf(t);i<r-1;++i){const a=Af[Pn[i]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-e)/(o*a.size))<=s)return Pn[i]}return Pn[r-1]}function FU(t,e,n,s,r){for(let i=Pn.length-1;i>=Pn.indexOf(n);i--){const a=Pn[i];if(Af[a].common&&t._adapter.diff(r,s,a)>=e-1)return a}return Pn[n?Pn.indexOf(n):0]}function zU(t){for(let e=Pn.indexOf(t)+1,n=Pn.length;e<n;++e)if(Af[Pn[e]].common)return Pn[e]}function d_(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=Ty(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function BU(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),a=e[e.length-1].value;let o,l;for(o=i;o<=a;o=+r.add(o,1,s))l=n[o],l>=0&&(e[l].major=!0);return e}function h_(t,e,n){const s=[],r={},i=e.length;let a,o;for(a=0;a<i;++a)o=e[a],r[o]=a,s.push({value:o,major:!1});return i===0||!n?s:BU(t,s,r,n)}class Yh extends ml{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new eB._date(e.adapters.date);r.init(n),oc(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:c_(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:a,maxDefined:o}=this.getUserBounds();function l(u){!a&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!o&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!a||!o)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=ms(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=ms(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,a=this.max,o=B4(r,i,a);return this._unit=n.unit||(s.autoSkip?u_(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):FU(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:zU(this._unit),this.initOffsets(r),e.reverse&&o.reverse(),h_(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;n=On(n,0,a),s=On(s,0,a),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,a=i.unit||u_(i.minUnit,n,s,this._getLabelCapacity(n)),o=Ue(r.ticks.stepSize,1),l=a==="week"?i.isoWeekday:!1,u=Uh(l)||l===!0,d={};let h=n,f,p;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":a),e.diff(s,n,a)>1e5*o)throw new Error(n+" and "+s+" are too far apart with stepSize of "+o+" "+a);const b=r.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,o,a),p++)d_(d,f,b);return(f===s||r.bounds==="ticks"||p===1)&&d_(d,f,b),Object.keys(d).sort(l_).map(x=>+x)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,a=n||r[i];return this._adapter.format(e,a)}_tickFormatFunction(e,n,s,r){const i=this.options,a=i.ticks.callback;if(a)return ht(a,[e,n,s],this);const o=i.time.displayFormats,l=this._unit,u=this._majorUnit,d=l&&o[l],h=u&&o[u],f=s[n],p=u&&h&&f&&f.major;return this._adapter.format(e,r||(p?h:d))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=yr(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),a=Math.sin(r),o=this._resolveTickFontOptions(0).size;return{w:s*i+o*a,h:s*a+o*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,h_(this,[e],this._majorUnit),r),a=this._getLabelSize(i),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(c_(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return eN(e.sort(l_))}}Ee(Yh,"id","time"),Ee(Yh,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Cd(t,e,n){let s=0,r=t.length-1,i,a,o,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Wg(t,"pos",e)),{pos:i,time:o}=t[s],{pos:a,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Wg(t,"time",e)),{time:i,pos:o}=t[s],{time:a,pos:l}=t[r]);const u=a-i;return u?o+(l-o)*(e-i)/u:o}class f_ extends Yh{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Cd(n,this.min),this._tableRange=Cd(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let a,o,l,u,d;for(a=0,o=e.length;a<o;++a)u=e[a],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(a=0,o=r.length;a<o;++a)d=r[a+1],l=r[a-1],u=r[a],Math.round((d+l)/2)!==u&&i.push({time:u,pos:a/(o-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Cd(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Cd(this._table,s*this._tableRange+this._minPos,!0)}}Ee(f_,"id","timeseries"),Ee(f_,"defaults",Yh.defaults);qs.register(Gl,eh,Yg,yo,Vg,Xd,jU,Qg,TU);const mn={pending:"rgba(234, 179, 8, 0.7)",rejected:"rgba(239, 68, 68, 0.7)",returned:"rgba(249, 115, 22, 0.7)",submitted:"rgba(59, 130, 246, 0.7)",accepted:"rgba(34, 197, 94, 0.7)"},UU=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}];function WU(t){const e=t-4,n=t+1,s=[];for(let r=e;r<=n;r+=1)s.push(r);return s}function dn({icon:t,label:e,value:n,helper:s,accentClass:r,onClick:i}){const a=!!i;return c.jsxs(yt,{className:`p-4 ${a?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:i,role:a?"button":void 0,tabIndex:a?0:void 0,onKeyDown:a?o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),i==null||i())}:void 0,children:[c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("div",{className:`h-10 w-10 rounded-xl flex items-center justify-center ${r}`,children:c.jsx(t,{size:18})}),c.jsx("div",{className:"text-2xl font-semibold",children:n})]}),c.jsx("div",{className:"mt-2 text-xs text-black/55 dark:text-white/60",children:e}),s?c.jsx("div",{className:"text-xs text-black/45 dark:text-white/55",children:s}):null]})}function Za({title:t,children:e}){return c.jsxs(lt,{className:"h-full",children:[c.jsx(Et,{children:c.jsx(At,{children:t})}),c.jsx(Pt,{children:c.jsx("div",{className:"h-[260px]",children:e})})]})}function RN({title:t,subtitle:e,children:n,defaultOpen:s=!1}){const[r,i]=m.useState(s);return c.jsxs(yt,{className:"p-3",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>i(a=>!a),"aria-expanded":r,children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:t}),e?c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:e}):null]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:r?"Hide":"View"}),c.jsx(An,{size:16,className:`transition-transform ${r?"rotate-180":""}`})]})]}),r?c.jsx("div",{className:"mt-3 space-y-2 text-xs text-black/60 dark:text-white/65",children:n}):null]})}function eo({type:t,data:e,options:n}){const s=zt.useRef(null);return zt.useEffect(()=>{if(!s.current)return;const r=qs.getChart(s.current);r&&r.destroy();const i=new qs(s.current,{type:t,data:e,options:n});return()=>i.destroy()},[e,n,t]),c.jsx("canvas",{ref:s})}function HU(t){const e=Number(t)||0;return e>=80?"bg-emerald-500/80":e>=60?"bg-amber-500/80":"bg-rose-500/80"}function p_(t){if(!t)return"--";const e=ps(t);return e?e.toLocaleDateString():t}function VU({mode:t,period:e}){if(!e)return"Current period";if(t==="month"){const[n,s]=e.split("-");return new Date(Number(n),Number(s)-1,1).toLocaleString(void 0,{month:"long",year:"numeric"})}if(t==="year")return e;if(t==="range"){const[n,s]=e.split(",");return`${n} to ${s}`}return e}function m_(t){return{labels:["Pending","Rejected","Returned","Submitted","Accepted"],datasets:[{data:[t.pending,t.rejected,t.returned,t.submitted,t.accepted],backgroundColor:[mn.pending,mn.rejected,mn.returned,mn.submitted,mn.accepted],borderWidth:0}]}}function Nd(t){const e={Pending:0,Rejected:0,Returned:0,"Submitted to Sales":0,Accepted:0};return t.forEach(n=>{const s=n.status||"";s.includes("Pending")||s==="Critique"||s==="Raw"?e.Pending+=1:s==="Rejected"||s==="Editing"?e.Rejected+=1:s==="Returned"?e.Returned+=1:s==="Submitted to Sales"?e["Submitted to Sales"]+=1:(s==="Accepted"||s==="Done")&&(e.Accepted+=1)}),e}function Il(t){return t.length?c.jsx("div",{className:"space-y-3",children:t.map(e=>c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:["#",e.task_number," - ",e.brand]}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[e.status," - ",e.videographer||"Unassigned"]})]}),c.jsxs("div",{className:"text-right text-xs text-black/50 dark:text-white/60",children:[c.jsxs("div",{children:["Film: ",p_(e.filming_deadline)]}),c.jsxs("div",{children:["Due: ",p_(e.submission_date)]})]})]})},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No tasks found."})}function Ed(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:(e.versions||[]).map(n=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsx("div",{className:"mt-1 text-black/50 dark:text-white/60",children:(n.lifecycle||[]).map(s=>`${s.stage} (${s.at||""})`).join(" -> ")})]},n.version))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No versions found."})}function em(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:e.rejectionEvents.map((n,s)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsxs("div",{className:"text-black/50 dark:text-white/60",children:[n.event.rejection_class||"Unclassified"," - ",n.event.rejection_comments||"No notes"]})]},`${e.task_number}-${s}`))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection events."})}function qU(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No pending reviews."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,versions:[]}),n[r].versions.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(RN,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.versions.map(s=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Waiting: ",s.waitingHours??"--"," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]})]},`${n.task.task_number}-${s.version.version}`))},n.task.task_number))})}function KU(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No response data."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,responses:[]}),n[r].responses.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(RN,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.responses.map((s,r)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Decision: ",s.decision]}),c.jsxs("div",{children:["Response: ",s.responseHours," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]}),c.jsxs("div",{children:["Reviewed: ",s.reviewTime?s.reviewTime.toLocaleString():"--"]}),s.rejectionClass?c.jsxs("div",{children:["Class: ",s.rejectionClass]}):null,s.comments?c.jsxs("div",{children:["Notes: ",s.comments]}):null]},`${n.task.task_number}-${r}`))},n.task.task_number))})}function GU(){const t=new Date,e=t.getFullYear(),[n,s]=m.useState("month"),[r,i]=m.useState(e),[a,o]=m.useState(t.getMonth()+1),[l,u]=m.useState(""),[d,h]=m.useState(""),[f,p]=m.useState(!1),[b,x]=m.useState(null),[v,y]=m.useState(null),g=WU(e),w=m.useMemo(()=>g.map(be=>({value:be,label:String(be)})),[g]),_=m.useMemo(()=>[{value:"month",label:"Month"},{value:"year",label:"Year"},{value:"range",label:"Range"}],[]),k=m.useMemo(()=>n==="month"?`${r}-${String(a).padStart(2,"0")}`:n==="year"?`${r}`:n==="range"&&l&&d?`${l},${d}`:"",[n,l,d,a,r]),S=on({queryKey:["video-critique","dashboard",n,k],queryFn:()=>c3({mode:n,period:k})}),j=S.data||{},N=j.tasks||[],T=j.summary||{},A=j.pie||{},z=j.reviewer||{},M=j.summary_videographers&&Object.keys(j.summary_videographers).length?j.summary_videographers:DC(N),I=j.videographers||{},H=m.useMemo(()=>FC(N),[N]),L=m.useMemo(()=>Hr(N),[N]),D=m.useMemo(()=>LC(N),[N]),G=m.useMemo(()=>$C(N),[N]),E=m.useMemo(()=>({labels:["Completed","Not Completed"],datasets:[{data:[A.completed||0,A.not_completed||0],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}),[A.completed,A.not_completed]),C=m.useMemo(()=>{const be=H.tasksStarted||0,he=A.completed||0,Ke=Math.max(be-he,0);return{labels:["Completed","Not Completed"],datasets:[{data:[he,Ke],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}},[H.tasksStarted,A.completed]),F=m.useMemo(()=>m_(L),[L]),K=m.useMemo(()=>Object.entries(M).sort((be,he)=>he[1].total-be[1].total),[M]),U=!!b,ie=!!v,V=v?M[v]:null,O=v?I[v]||[]:[],q=m.useMemo(()=>Uc(N,"pending"),[N]),ae=m.useMemo(()=>Uc(N,"submitted"),[N]),Ce=m.useMemo(()=>Lp(N,"hod"),[N]),Le=m.useMemo(()=>Lp(N,"hos"),[N]),st=m.useMemo(()=>{const be={};let he=0,Ke=0;N.forEach(Q=>{(Q.versions||[]).forEach(oe=>{const X=oe.lifecycle||[];if(!X.length)return;const $=X[X.length-1],ce=(($==null?void 0:$.stage)||"").toLowerCase();(ce==="accepted"||ce==="done")&&(he+=1),(ce==="rejected"||ce==="editing"||ce==="returned")&&(Ke+=1),X.forEach(me=>{const je=(me.stage||"").toLowerCase();if(je==="rejected"||je==="editing"||je==="returned"){const $e=me.rejection_class||"Unclassified";be[$e]=(be[$e]||0)+1}})})});const ee=he+Ke,de=ee?(he/ee*100).toFixed(1):"0",le=ee?(Ke/ee*100).toFixed(1):"0",Y=Object.entries(be).sort((Q,oe)=>oe[1]-Q[1]);return{acceptedPct:de,rejectedPct:le,classes:Y,totalRejections:Ke}},[N]);return S.isLoading?c.jsxs(lt,{children:[c.jsx(Et,{children:c.jsx(At,{children:"Video Critique Dashboard"})}),c.jsx(Pt,{children:c.jsx(De,{text:"Loading dashboard",className:"text-sm text-black/60 dark:text-white/65"})})]}):c.jsxs("div",{className:"flex flex-col gap-4 min-h-0 pb-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-1",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Video Critique Dashboard"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:VU({mode:n,period:k})})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(qe,{value:n,options:_,onChange:s,className:"sm:w-[200px]"}),n==="month"?c.jsxs(c.Fragment,{children:[c.jsx(qe,{value:a,options:UU,onChange:o,className:"sm:w-[200px]"}),c.jsx(qe,{value:r,options:w,onChange:i,className:"sm:w-[200px]"})]}):null,n==="year"?c.jsx(qe,{value:r,options:w,onChange:i,className:"sm:w-[200px]"}):null,n==="range"?c.jsxs(Z,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!0),children:[c.jsx(IA,{size:16,className:"mr-2"}),"Pick Range"]}):null,c.jsxs(Z,{variant:"ghost",className:"rounded-2xl",onClick:()=>S.refetch(),children:[c.jsx(WA,{size:16,className:"mr-2"}),"Refresh"]})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(dn,{icon:Hd,label:"Total Tasks",value:T.total||0,helper:"Tasks created",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("total_created")}),c.jsx(dn,{icon:Yu,label:"Assigned",value:T.assigned||0,helper:"Assigned to videographers",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("total_assigned")}),c.jsx(dn,{icon:Qu,label:"Tasks Started",value:H.tasksStarted||0,helper:"Filming date passed",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("total_started")}),c.jsx(dn,{icon:Xu,label:"Late Tasks",value:H.lateTasks||0,helper:"Submission overdue",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("total_late")}),c.jsx(dn,{icon:Hd,label:"Uploads",value:T.uploads||0,helper:"Total versions",accentClass:"bg-purple-500/10 text-purple-700 dark:text-purple-200",onClick:()=>x("upload_ratio")}),c.jsx(dn,{icon:Yu,label:"Completed",value:A.completed||0,helper:"Accepted or done",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("completed")})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(dn,{icon:Qu,label:"Pending HOD",value:H.pendingHOD||0,helper:"Versions in critique",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("pending_hod")}),c.jsx(dn,{icon:Qu,label:"Pending HOS",value:H.pendingHOS||0,helper:"Submitted to sales",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("pending_hos")}),c.jsx(dn,{icon:Xu,label:"Rejected by HOD",value:H.rejectionsByHOD||0,helper:"Editing / rejected",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("rejected_hod")}),c.jsx(dn,{icon:Xu,label:"Rejected by HOS",value:H.rejectionsByHOS||0,helper:"Returned",accentClass:"bg-orange-500/10 text-orange-700 dark:text-orange-200",onClick:()=>x("rejected_hos")}),c.jsx(dn,{icon:Hd,label:"Upload Ratio",value:H.uploadRatio||"0",helper:"Avg versions/task",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("upload_ratio")}),c.jsx(dn,{icon:Yu,label:"Acceptance Rate",value:`${T.accepted_pct||0}%`,helper:"Accepted vs reviewed",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("acceptance_rate")})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsx(Za,{title:"Completion Overview",children:c.jsx(eo,{type:"doughnut",data:E,options:{maintainAspectRatio:!1}})}),c.jsx(Za,{title:"Started vs Completed",children:c.jsx(eo,{type:"doughnut",data:C,options:{maintainAspectRatio:!1}})}),c.jsx(Za,{title:"Status Distribution",children:c.jsx(eo,{type:"bar",data:F,options:{maintainAspectRatio:!1,indexAxis:"y",scales:{x:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}},y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}}}}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsxs(lt,{children:[c.jsx(Et,{children:c.jsx(At,{children:"Reviewer Performance"})}),c.jsx(Pt,{children:c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Avg response time"}),c.jsx("span",{className:"font-semibold",children:z.avg_response_display||"0 hrs"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Handled"}),c.jsx("span",{className:"font-semibold",children:z.handled||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Accepted by HOS"}),c.jsx("span",{className:"font-semibold",children:z.accepted||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Success rate"}),c.jsxs("span",{className:"font-semibold",children:[z.handled_percent||0,"%"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Pending reviews"}),c.jsx("span",{className:"font-semibold",children:D.count||0})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(Z,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("response_time"),children:"View response times"}),c.jsx(Z,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("pending_reviews"),children:"View pending reviews"})]})]})})]}),c.jsxs(lt,{className:"lg:col-span-2",children:[c.jsx(Et,{children:c.jsx(At,{children:"Videographers"})}),c.jsx(Pt,{children:K.length?c.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:K.map(([be,he])=>c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>y(be),children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:be}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[he.total," tasks"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-lg font-semibold",children:[he.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]})]}),c.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-black/60 dark:text-white/60",children:[c.jsxs("div",{children:["Started: ",he.started]}),c.jsxs("div",{children:["Late: ",he.late]}),c.jsxs("div",{children:["Completed: ",he.completed]}),c.jsxs("div",{children:["Uploads: ",he.uploads]})]}),c.jsx("div",{className:"mt-3 h-2 rounded-full bg-black/10 dark:bg-white/10 overflow-hidden",children:c.jsx("div",{className:`h-full ${HU(he.accepted_pct)}`,style:{width:`${he.accepted_pct}%`}})})]},be))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No videographer data."})})]})]}),c.jsxs(Jn,{open:U,onClose:()=>x(null),title:"Details",maxWidth:"820px",children:[b==="total_created"?Il(N):null,b==="total_assigned"?Il(N.filter(be=>be.status!=="Not assigned yet")):null,b==="total_started"?Il(N.filter(be=>{const he=ps(be.filming_deadline||"");if(!he)return!1;const Ke=new Date;return Ke.setHours(0,0,0,0),he<=Ke})):null,b==="total_late"?Il(N.filter($p)):null,b==="completed"?Il(N.filter(be=>be.status==="Accepted"||be.status==="Done")):null,b==="pending_hod"?Ed(q.map(be=>({...be.task,versions:[be.version]}))):null,b==="pending_hos"?Ed(ae.map(be=>({...be.task,versions:[be.version]}))):null,b==="rejected_hod"?em(Ce):null,b==="rejected_hos"?em(Le):null,b==="upload_ratio"?Ed(N.filter(be=>{var he;return(he=be.versions)==null?void 0:he.length})):null,b==="acceptance_rate"?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(yt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-emerald-600",children:[st.acceptedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]}),c.jsxs(yt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-red-600",children:[st.rejectedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Rejection"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/70 dark:text-white/70 mb-2",children:"Rejection classes"}),st.classes.length?c.jsx("div",{className:"space-y-2",children:st.classes.map(([be,he])=>c.jsx("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:be}),c.jsx("span",{children:he})]})},be))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection data."})]})]}):null,b==="response_time"?KU(G):null,b==="pending_reviews"?qU(D.reviews||[]):null]}),c.jsx(Jn,{open:ie,onClose:()=>y(null),title:v?`${v} Details`:"Videographer",maxWidth:"980px",children:v&&V?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(yt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold",children:[V.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance rate"})]}),c.jsxs(yt,{className:"p-4 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:V.late}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Late tasks"})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[c.jsx(dn,{icon:Qu,label:"Pending",value:Hr(O).pending,accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200"}),c.jsx(dn,{icon:Xu,label:"Rejected",value:Hr(O).rejected,accentClass:"bg-red-500/10 text-red-700 dark:text-red-200"}),c.jsx(dn,{icon:Yu,label:"Accepted",value:Hr(O).accepted,accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200"})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(Za,{title:"Version Distribution",children:c.jsx(eo,{type:"bar",data:m_(Hr(O)),options:{maintainAspectRatio:!1,indexAxis:"y"}})}),c.jsx(Za,{title:"All Tasks Status",children:c.jsx(eo,{type:"pie",data:{labels:Object.keys(Nd(O)),datasets:[{data:Object.values(Nd(O)),backgroundColor:[mn.pending,mn.rejected,mn.returned,mn.submitted,mn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(Za,{title:"Overdue Tasks",children:c.jsx(eo,{type:"pie",data:{labels:Object.keys(Nd(O.filter($p))),datasets:[{data:Object.values(Nd(O.filter($p))),backgroundColor:[mn.pending,mn.rejected,mn.returned,mn.submitted,mn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})}),c.jsxs(lt,{children:[c.jsx(Et,{children:c.jsx(At,{children:"Failure Analysis"})}),c.jsx(Pt,{children:em(Lp(O,"hod"))})]})]}),c.jsxs(lt,{children:[c.jsx(Et,{children:c.jsx(At,{children:"Version History"})}),c.jsx(Pt,{children:Ed(O)})]})]}):null}),c.jsx(Jn,{open:f,onClose:()=>p(!1),title:"Select date range",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Start date"}),c.jsx("input",{type:"date",value:l,onChange:be=>u(be.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"End date"}),c.jsx("input",{type:"date",value:d,onChange:be=>h(be.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!1),children:"Cancel"}),c.jsx(Z,{className:"rounded-2xl",onClick:()=>p(!1),children:"Apply"})]})]})})]})}function YU(){const[t,e]=m.useState("chat");return c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Z,{variant:t==="chat"?"default":"ghost",className:"rounded-2xl",onClick:()=>e("chat"),children:"Chat"}),c.jsx(Z,{variant:t==="dashboard"?"default":"ghost",className:"rounded-2xl",onClick:()=>e("dashboard"),children:"Dashboard"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="chat"?"h-full":"hidden","aria-hidden":t!=="chat",children:c.jsx(Hz,{})}),c.jsx("div",{className:t==="dashboard"?"h-full overflow-y-auto px-2 py-1":"hidden","aria-hidden":t!=="dashboard",children:c.jsx(GU,{})})]})]})}function QU(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function g_(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function x_(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function XU({locations:t,locationsQuery:e}){var w;const[n,s]=m.useState(null),[r,i]=m.useState(""),[a,o]=m.useState(""),[l,u]=m.useState(""),[d,h]=m.useState(""),f=m.useMemo(()=>{const _=Array.isArray(t)?t:[],k=new Set;return _.forEach(S=>{const j=(S==null?void 0:S.display_type)||"";j&&k.add(j)}),[{value:"",label:"All display types"},...Array.from(k).sort().map(S=>({value:S,label:S}))]},[t]),p=m.useMemo(()=>{const _=Array.isArray(t)?t:[],k=new Set;return _.forEach(S=>{const j=(S==null?void 0:S.company_schema)||"";j&&k.add(j)}),[{value:"",label:"All companies"},...Array.from(k).sort().map(S=>({value:S,label:S}))]},[t]),b=m.useMemo(()=>{const _=Array.isArray(t)?t:[],k=new Set;return _.forEach(S=>{const j=(S==null?void 0:S.series)||"";j&&k.add(j)}),[{value:"",label:"All series"},...Array.from(k).sort().map(S=>({value:S,label:S}))]},[t]),x=m.useMemo(()=>{const _=Array.isArray(t)?t:[],k=r.trim().toLowerCase();return _.filter(j=>!(a&&((j==null?void 0:j.display_type)||"")!==a||l&&((j==null?void 0:j.company_schema)||"")!==l||d&&((j==null?void 0:j.series)||"")!==d||k&&!QU(j).includes(k))).map((j,N)=>({id:(j==null?void 0:j.location_key)||`location-${N}`,raw:j}))},[t,a,l,d,r]),v=m.useMemo(()=>{const _=Array.isArray(t)?t:[],k=new Set;_.forEach(N=>{Object.keys(N||{}).forEach(T=>k.add(T))});const S=["display_name","location_key","display_type","company_schema","series","city","area","upload_fee","height","width","number_of_faces","spot_duration","loop_duration","sov_percent","eligible_for_proposals","eligible_for_mockups"],j=Array.from(k).filter(N=>!S.includes(N)).sort();return[...S.filter(N=>k.has(N)),...j]},[t]),y=m.useMemo(()=>n?Object.entries(n):[],[n]),g=n||null;return c.jsxs(c.Fragment,{children:[c.jsxs(lt,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Et,{className:"space-y-1",children:[c.jsx(At,{children:"Locations"}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[x.length," location",x.length===1?"":"s"]})]}),c.jsxs(Pt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-4",children:[c.jsx(Ia,{value:r,onChange:_=>i(_.target.value),className:"w-full",placeholder:"Search locations..."}),c.jsx(qe,{value:a,options:f,onChange:o,className:"w-full"}),c.jsx(qe,{value:l,options:p,onChange:u,className:"w-full"}),c.jsx(qe,{value:d,options:b,onChange:h,className:"w-full"})]}),e.isLoading?c.jsx(De,{text:"Loading locations",className:"text-sm text-black/60 dark:text-white/65"}):e.isError?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:((w=e.error)==null?void 0:w.message)||"Failed to load locations."}):x.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsxs("tr",{children:[v.map(_=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:g_(_)},_)),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:x.map(_=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[v.map(k=>{var j;const S=x_((j=_.raw)==null?void 0:j[k]);return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:S},`${_.id}-${k}`)}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:c.jsx(Z,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>s(_.raw),children:"Edit"})})]},_.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No locations found."})]})]}),c.jsx(Jn,{open:!!n,onClose:()=>s(null),title:"Edit location",maxWidth:"560px",children:g?c.jsxs("div",{className:"space-y-3",children:[c.jsx(xe,{label:"Location Key",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g.location_key||"",disabled:!0,readOnly:!0})}),c.jsx(xe,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g.display_name||"",disabled:!0,readOnly:!0})}),c.jsx(xe,{label:"Display Type",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g.display_type||"",disabled:!0,readOnly:!0})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(xe,{label:"Company",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g.company_schema||"",disabled:!0,readOnly:!0})}),c.jsx(xe,{label:"Series",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g.series||"",disabled:!0,readOnly:!0})}),c.jsx(xe,{label:"City",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g.city||"",disabled:!0,readOnly:!0})}),c.jsx(xe,{label:"Area",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:g.area||"",disabled:!0,readOnly:!0})})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(Z,{variant:"ghost",className:"rounded-2xl",onClick:()=>s(null),children:"Close"}),c.jsx(Z,{className:"rounded-2xl",disabled:!0,children:"Save"})]}),c.jsxs("div",{className:"pt-2",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60 mb-2",children:"All fields"}),c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 divide-y divide-black/5 dark:divide-white/10",children:y.map(([_,k])=>c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 px-3 py-2 text-sm",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/45 dark:text-white/55 md:w-56",children:g_(_)}),c.jsx("div",{className:"text-black/80 dark:text-white/85 break-all",children:x_(k)})]},_))})]})]}):null})]})}const JU=[{key:"locations",label:"Locations",disabled:!1},{key:"network",label:"Network",disabled:!0},{key:"package",label:"Package",disabled:!0},{key:"assets",label:"Assets",disabled:!0}];function ZU(){const{user:t}=jr(),[e,n]=m.useState("locations");if(!hu(t))return c.jsxs(lt,{children:[c.jsx(Et,{children:c.jsx(At,{children:"Restricted"})}),c.jsx(Pt,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to asset management."})]});const s=on({queryKey:["asset-management","locations"],queryFn:()=>AC()}),r=m.useMemo(()=>{const i=s.data;return Array.isArray(i)?i:(i==null?void 0:i.locations)||[]},[s.data]);return c.jsxs("div",{className:"flex h-full min-h-0 min-w-0 flex-col gap-4",children:[c.jsx("div",{className:"flex items-center gap-2 overflow-x-auto",children:JU.map(i=>c.jsx(Z,{variant:e===i.key?"default":"ghost",onClick:()=>n(i.key),className:"rounded-2xl shrink-0",disabled:i.disabled,title:i.disabled?"Coming soon":void 0,children:i.label},i.key))}),c.jsx("div",{className:"flex-1 min-h-0 min-w-0",children:e==="locations"?c.jsx("div",{className:"h-full",children:c.jsx(XU,{locations:r,locationsQuery:s})}):null})]})}function e8({children:t}){const{user:e,authReady:n,session:s,pendingAccess:r,logout:i}=jr(),a=ll();return n?r?c.jsx(tj,{email:r.email,message:r.message,onSignOut:i}):s&&!e?c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(De,{text:"Finalizing sign-in"})})}):e?t:c.jsx(Ud,{to:"/login",replace:!0,state:{from:a.pathname}}):c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(De,{text:"Loading"})})})}function t8(){const t="mmg-brand-theme",[e,n]=m.useState("none");m.useEffect(()=>{if(typeof window>"u")return;const i=window.localStorage.getItem(t)||"none";n(i),i==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",i)},[]);const s=r=>{n(r),typeof window<"u"&&window.localStorage.setItem(t,r),r==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",r)};return c.jsx("div",{className:"h-full min-h-0",children:c.jsxs(lt,{className:"h-full",children:[c.jsx(Et,{children:c.jsx(At,{children:"Settings"})}),c.jsxs(Pt,{className:"text-sm text-black/60 dark:text-white/65 space-y-4",children:[c.jsxs(yt,{className:"flex items-center justify-between p-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle dark / light mode"})]}),c.jsx(nj,{})]}),c.jsxs(yt,{className:"space-y-3 p-4",children:[c.jsx("div",{className:"flex items-center justify-between gap-4",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Color theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Choose a color palette that layers on top of light / dark mode."})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2",children:[c.jsx("button",{type:"button",onClick:()=>s("none"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="none"?"border-black/60 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:c.jsx("span",{className:"font-medium",children:"System default"})}),c.jsxs("button",{type:"button",onClick:()=>s("blue"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="blue"?"border-blue-500/80 bg-blue-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Blue"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#007AFF]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("green"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="green"?"border-emerald-500/80 bg-emerald-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Green"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#0F806B]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("orange"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="orange"?"border-orange-500/80 bg-orange-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Orange"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#FF7900]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("gold"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="gold"?"border-amber-500/80 bg-amber-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Gold"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#CA9E2C]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("brand"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="brand"?"border-black/70 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Brand Theme"}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#000000]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#007AFF]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#CA9E2C]"})]})]})]})]})]})]})})}function n8(){return c.jsxs(WR,{children:[c.jsx(hn,{path:"/",element:c.jsx(Ud,{to:"/login",replace:!0})}),c.jsx(hn,{path:"/login",element:c.jsx(bI,{})}),c.jsx(hn,{path:"/auth/callback",element:c.jsx(wI,{})}),c.jsxs(hn,{path:"/app",element:c.jsx(e8,{children:c.jsx(S3,{})}),children:[c.jsx(hn,{index:!0,element:c.jsx(Ud,{to:"chat",replace:!0})}),c.jsx(hn,{path:"chat",element:c.jsx(j3,{})}),c.jsx(hn,{path:"video-critique",element:c.jsx(YU,{})}),c.jsx(hn,{path:"mockup",element:c.jsx(tz,{})}),c.jsx(hn,{path:"proposals",element:c.jsx(xz,{})}),c.jsx(hn,{path:"notifications",element:c.jsx(Wz,{})}),c.jsx(hn,{path:"admin",element:c.jsx(Bz,{})}),c.jsx(hn,{path:"asset-management",element:c.jsx(ZU,{})}),c.jsx(hn,{path:"settings",element:c.jsx(t8,{})})]}),c.jsx(hn,{path:"*",element:c.jsx(Ud,{to:"/login",replace:!0})})]})}function s8(){if(!(typeof window>"u"))try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=e.createOscillator(),s=e.createGain();n.type="sine",n.frequency.value=740,s.gain.value=.15,n.connect(s),s.connect(e.destination),n.start(),s.gain.exponentialRampToValueAtTime(.001,e.currentTime+.25),n.stop(e.currentTime+.3),n.onended=()=>{e.close()}}catch{}}function r8(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?"":e.toLocaleString()}function i8({children:t}){const[e,n]=m.useState([]),[s,r]=m.useState(!0),[i,a]=m.useState([]),o=m.useRef(new Set),l=m.useRef(!1),u=m.useRef(new Map),d=m.useCallback(async()=>{r(!0);const w=await $F();n(Array.isArray(w)?w:[]),r(!1)},[]),h=m.useCallback(async()=>{await zF(),n([])},[]),f=m.useCallback(async w=>{w&&(await BF(w),n(_=>_.filter(k=>k.id!==w)))},[]),p=m.useCallback(async w=>{w&&(await UF(w),n(_=>_.map(k=>k.id===w?{...k,read:!0}:k)))},[]),b=m.useCallback(async w=>{const _=await FF(w);return n(k=>[_,...k]),_},[]),x=m.useCallback(w=>{a(k=>k.filter(S=>S.id!==w));const _=u.current.get(w);_&&(clearTimeout(_),u.current.delete(w))},[]),v=m.useCallback(w=>{if(!(w!=null&&w.id))return;a(k=>[...k,{id:w.id,notification:w}]);const _=setTimeout(()=>x(w.id),4200);u.current.set(w.id,_)},[x]);m.useEffect(()=>{d()},[d]),m.useEffect(()=>{if(!l.current){e.forEach(_=>o.current.add(_.id)),l.current=!0;return}const w=e.filter(_=>_.id&&!o.current.has(_.id));w.length&&(s8(),w.forEach(_=>{o.current.add(_.id),v(_)}))},[e,v]),m.useEffect(()=>{if(typeof window>"u")return;const w=_=>{_.key===WF&&d()};return window.addEventListener("storage",w),()=>window.removeEventListener("storage",w)},[d]),m.useEffect(()=>{if(!(typeof window>"u"))return window.mmgNotify=w=>b(w),window.mmgNotifications={add:w=>b(w),clear:h,dismiss:f,markRead:p},()=>{delete window.mmgNotify,delete window.mmgNotifications}},[b,h,f,p]);const y=m.useMemo(()=>e.filter(w=>!w.read).length,[e]),g=m.useMemo(()=>({notifications:e,loading:s,unreadCount:y,toasts:i,addNotification:b,clearAll:h,dismissNotification:f,markRead:p,dismissToast:x,formatTime:r8}),[e,s,y,i,b,h,f,p,x]);return c.jsx(PC.Provider,{value:g,children:t})}const a8="mmg-brand-theme";if(typeof window<"u"){const t=window.localStorage.getItem(a8);t&&t!=="none"?document.body.setAttribute("data-brand-theme",t):document.body.removeAttribute("data-brand-theme"),window.addEventListener("wheel",e=>{const n=e.target;n instanceof HTMLInputElement&&n.type==="number"&&n===document.activeElement&&e.preventDefault()},{passive:!1})}const o8=new SA({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});tm.createRoot(document.getElementById("root")).render(c.jsx(zt.StrictMode,{children:c.jsx(QR,{attribute:"class",defaultTheme:"light",enableSystem:!1,children:c.jsx(jA,{client:o8,children:c.jsx(yI,{children:c.jsx(i8,{children:c.jsx(qR,{children:c.jsx(n8,{})})})})})})}));
