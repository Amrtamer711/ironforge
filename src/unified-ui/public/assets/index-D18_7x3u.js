var NP=Object.defineProperty;var cb=t=>{throw TypeError(t)};var EP=(t,e,n)=>e in t?NP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $e=(t,e,n)=>EP(t,typeof e!="symbol"?e+"":e,n),xm=(t,e,n)=>e.has(t)||cb("Cannot "+n);var I=(t,e,n)=>(xm(t,e,"read from private field"),n?n.call(t):e.get(t)),Se=(t,e,n)=>e.has(t)?cb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),fe=(t,e,n,s)=>(xm(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n),Fe=(t,e,n)=>(xm(t,e,"access private method"),n);var Qd=(t,e,n,s)=>({set _(r){fe(t,e,r,n)},get _(){return I(t,e,s)}});function TP(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function s1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r1={exports:{}},Sp={},i1={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xd=Symbol.for("react.element"),PP=Symbol.for("react.portal"),RP=Symbol.for("react.fragment"),AP=Symbol.for("react.strict_mode"),OP=Symbol.for("react.profiler"),IP=Symbol.for("react.provider"),MP=Symbol.for("react.context"),DP=Symbol.for("react.forward_ref"),LP=Symbol.for("react.suspense"),$P=Symbol.for("react.memo"),FP=Symbol.for("react.lazy"),ub=Symbol.iterator;function zP(t){return t===null||typeof t!="object"?null:(t=ub&&t[ub]||t["@@iterator"],typeof t=="function"?t:null)}var o1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},a1=Object.assign,l1={};function rc(t,e,n){this.props=t,this.context=e,this.refs=l1,this.updater=n||o1}rc.prototype.isReactComponent={};rc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function c1(){}c1.prototype=rc.prototype;function Hy(t,e,n){this.props=t,this.context=e,this.refs=l1,this.updater=n||o1}var Wy=Hy.prototype=new c1;Wy.constructor=Hy;a1(Wy,rc.prototype);Wy.isPureReactComponent=!0;var db=Array.isArray,u1=Object.prototype.hasOwnProperty,Vy={current:null},d1={key:!0,ref:!0,__self:!0,__source:!0};function h1(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)u1.call(e,s)&&!d1.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:xd,type:t,key:i,ref:o,props:r,_owner:Vy.current}}function BP(t,e){return{$$typeof:xd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qy(t){return typeof t=="object"&&t!==null&&t.$$typeof===xd}function UP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hb=/\/+/g;function ym(t,e){return typeof t=="object"&&t!==null&&t.key!=null?UP(""+t.key):e.toString(36)}function Zh(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case xd:case PP:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+ym(o,0):s,db(r)?(n="",t!=null&&(n=t.replace(hb,"$&/")+"/"),Zh(r,e,n,"",function(u){return u})):r!=null&&(qy(r)&&(r=BP(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(hb,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",db(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+ym(i,a);o+=Zh(i,e,n,l,r)}else if(l=zP(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+ym(i,a++),o+=Zh(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Xd(t,e,n){if(t==null)return t;var s=[],r=0;return Zh(t,s,"","",function(i){return e.call(n,i,r++)}),s}function HP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Un={current:null},ef={transition:null},WP={ReactCurrentDispatcher:Un,ReactCurrentBatchConfig:ef,ReactCurrentOwner:Vy};function f1(){throw Error("act(...) is not supported in production builds of React.")}Je.Children={map:Xd,forEach:function(t,e,n){Xd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Xd(t,function(){e++}),e},toArray:function(t){return Xd(t,function(e){return e})||[]},only:function(t){if(!qy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Je.Component=rc;Je.Fragment=RP;Je.Profiler=OP;Je.PureComponent=Hy;Je.StrictMode=AP;Je.Suspense=LP;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WP;Je.act=f1;Je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=a1({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Vy.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)u1.call(e,l)&&!d1.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:xd,type:t.type,key:r,ref:i,props:s,_owner:o}};Je.createContext=function(t){return t={$$typeof:MP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:IP,_context:t},t.Consumer=t};Je.createElement=h1;Je.createFactory=function(t){var e=h1.bind(null,t);return e.type=t,e};Je.createRef=function(){return{current:null}};Je.forwardRef=function(t){return{$$typeof:DP,render:t}};Je.isValidElement=qy;Je.lazy=function(t){return{$$typeof:FP,_payload:{_status:-1,_result:t},_init:HP}};Je.memo=function(t,e){return{$$typeof:$P,type:t,compare:e===void 0?null:e}};Je.startTransition=function(t){var e=ef.transition;ef.transition={};try{t()}finally{ef.transition=e}};Je.unstable_act=f1;Je.useCallback=function(t,e){return Un.current.useCallback(t,e)};Je.useContext=function(t){return Un.current.useContext(t)};Je.useDebugValue=function(){};Je.useDeferredValue=function(t){return Un.current.useDeferredValue(t)};Je.useEffect=function(t,e){return Un.current.useEffect(t,e)};Je.useId=function(){return Un.current.useId()};Je.useImperativeHandle=function(t,e,n){return Un.current.useImperativeHandle(t,e,n)};Je.useInsertionEffect=function(t,e){return Un.current.useInsertionEffect(t,e)};Je.useLayoutEffect=function(t,e){return Un.current.useLayoutEffect(t,e)};Je.useMemo=function(t,e){return Un.current.useMemo(t,e)};Je.useReducer=function(t,e,n){return Un.current.useReducer(t,e,n)};Je.useRef=function(t){return Un.current.useRef(t)};Je.useState=function(t){return Un.current.useState(t)};Je.useSyncExternalStore=function(t,e,n){return Un.current.useSyncExternalStore(t,e,n)};Je.useTransition=function(){return Un.current.useTransition()};Je.version="18.3.1";i1.exports=Je;var v=i1.exports;const ge=s1(v),jp=TP({__proto__:null,default:ge},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VP=v,qP=Symbol.for("react.element"),KP=Symbol.for("react.fragment"),GP=Object.prototype.hasOwnProperty,YP=VP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QP={key:!0,ref:!0,__self:!0,__source:!0};function p1(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)GP.call(e,s)&&!QP.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:qP,type:t,key:i,ref:o,props:r,_owner:YP.current}}Sp.Fragment=KP;Sp.jsx=p1;Sp.jsxs=p1;r1.exports=Sp;var c=r1.exports,zg={},m1={exports:{}},Ts={},g1={exports:{}},x1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(E,P){var A=E.length;E.push(P);e:for(;0<A;){var F=A-1>>>1,z=E[F];if(0<r(z,P))E[F]=P,E[A]=z,A=F;else break e}}function n(E){return E.length===0?null:E[0]}function s(E){if(E.length===0)return null;var P=E[0],A=E.pop();if(A!==P){E[0]=A;e:for(var F=0,z=E.length,G=z>>>1;F<G;){var q=2*(F+1)-1,B=E[q],Q=q+1,pe=E[Q];if(0>r(B,A))Q<z&&0>r(pe,B)?(E[F]=pe,E[Q]=A,F=Q):(E[F]=B,E[q]=A,F=q);else if(Q<z&&0>r(pe,A))E[F]=pe,E[Q]=A,F=Q;else break e}}return P}function r(E,P){var A=E.sortIndex-P.sortIndex;return A!==0?A:E.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,h=null,f=3,p=!1,b=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(E){for(var P=n(u);P!==null;){if(P.callback===null)s(u);else if(P.startTime<=E)s(u),P.sortIndex=P.expirationTime,e(l,P);else break;P=n(u)}}function k(E){if(x=!1,w(E),!b)if(n(l)!==null)b=!0,U(_);else{var P=n(u);P!==null&&W(k,P.startTime-E)}}function _(E,P){b=!1,x&&(x=!1,g(j),j=-1),p=!0;var A=f;try{for(w(P),h=n(l);h!==null&&(!(h.expirationTime>P)||E&&!M());){var F=h.callback;if(typeof F=="function"){h.callback=null,f=h.priorityLevel;var z=F(h.expirationTime<=P);P=t.unstable_now(),typeof z=="function"?h.callback=z:h===n(l)&&s(l),w(P)}else s(l);h=n(l)}if(h!==null)var G=!0;else{var q=n(u);q!==null&&W(k,q.startTime-P),G=!1}return G}finally{h=null,f=A,p=!1}}var C=!1,S=null,j=-1,N=5,R=-1;function M(){return!(t.unstable_now()-R<N)}function O(){if(S!==null){var E=t.unstable_now();R=E;var P=!0;try{P=S(!0,E)}finally{P?D():(C=!1,S=null)}}else C=!1}var D;if(typeof m=="function")D=function(){m(O)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,L=$.port2;$.port1.onmessage=O,D=function(){L.postMessage(null)}}else D=function(){y(O,0)};function U(E){S=E,C||(C=!0,D())}function W(E,P){j=y(function(){E(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(E){E.callback=null},t.unstable_continueExecution=function(){b||p||(b=!0,U(_))},t.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<E?Math.floor(1e3/E):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(E){switch(f){case 1:case 2:case 3:var P=3;break;default:P=f}var A=f;f=P;try{return E()}finally{f=A}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(E,P){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var A=f;f=E;try{return P()}finally{f=A}},t.unstable_scheduleCallback=function(E,P,A){var F=t.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?F+A:F):A=F,E){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=A+z,E={id:d++,callback:P,priorityLevel:E,startTime:A,expirationTime:z,sortIndex:-1},A>F?(E.sortIndex=A,e(u,E),n(l)===null&&E===n(u)&&(x?(g(j),j=-1):x=!0,W(k,A-F))):(E.sortIndex=z,e(l,E),b||p||(b=!0,U(_))),E},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(E){var P=f;return function(){var A=f;f=P;try{return E.apply(this,arguments)}finally{f=A}}}})(x1);g1.exports=x1;var XP=g1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JP=v,Es=XP;function ue(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y1=new Set,yu={};function Sa(t,e){Yl(t,e),Yl(t+"Capture",e)}function Yl(t,e){for(yu[t]=e,t=0;t<e.length;t++)y1.add(e[t])}var di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bg=Object.prototype.hasOwnProperty,ZP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fb={},pb={};function eR(t){return Bg.call(pb,t)?!0:Bg.call(fb,t)?!1:ZP.test(t)?pb[t]=!0:(fb[t]=!0,!1)}function tR(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nR(t,e,n,s){if(e===null||typeof e>"u"||tR(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hn(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Sn[t]=new Hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Sn[e]=new Hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Sn[t]=new Hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Sn[t]=new Hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Sn[t]=new Hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Sn[t]=new Hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Sn[t]=new Hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Sn[t]=new Hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Sn[t]=new Hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ky=/[\-:]([a-z])/g;function Gy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ky,Gy);Sn[e]=new Hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ky,Gy);Sn[e]=new Hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ky,Gy);Sn[e]=new Hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Sn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!1,!1)});Sn.xlinkHref=new Hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Sn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Yy(t,e,n,s){var r=Sn.hasOwnProperty(e)?Sn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nR(e,n,r,s)&&(n=null),s||r===null?eR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var vi=JP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jd=Symbol.for("react.element"),sl=Symbol.for("react.portal"),rl=Symbol.for("react.fragment"),Qy=Symbol.for("react.strict_mode"),Ug=Symbol.for("react.profiler"),v1=Symbol.for("react.provider"),b1=Symbol.for("react.context"),Xy=Symbol.for("react.forward_ref"),Hg=Symbol.for("react.suspense"),Wg=Symbol.for("react.suspense_list"),Jy=Symbol.for("react.memo"),Ni=Symbol.for("react.lazy"),w1=Symbol.for("react.offscreen"),mb=Symbol.iterator;function Cc(t){return t===null||typeof t!="object"?null:(t=mb&&t[mb]||t["@@iterator"],typeof t=="function"?t:null)}var qt=Object.assign,vm;function Wc(t){if(vm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);vm=e&&e[1]||""}return`
`+vm+t}var bm=!1;function wm(t,e){if(!t||bm)return"";bm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{bm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Wc(t):""}function sR(t){switch(t.tag){case 5:return Wc(t.type);case 16:return Wc("Lazy");case 13:return Wc("Suspense");case 19:return Wc("SuspenseList");case 0:case 2:case 15:return t=wm(t.type,!1),t;case 11:return t=wm(t.type.render,!1),t;case 1:return t=wm(t.type,!0),t;default:return""}}function Vg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case rl:return"Fragment";case sl:return"Portal";case Ug:return"Profiler";case Qy:return"StrictMode";case Hg:return"Suspense";case Wg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case b1:return(t.displayName||"Context")+".Consumer";case v1:return(t._context.displayName||"Context")+".Provider";case Xy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jy:return e=t.displayName||null,e!==null?e:Vg(t.type)||"Memo";case Ni:e=t._payload,t=t._init;try{return Vg(t(e))}catch{}}return null}function rR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vg(e);case 8:return e===Qy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function co(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function k1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function iR(t){var e=k1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zd(t){t._valueTracker||(t._valueTracker=iR(t))}function _1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=k1(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Nf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qg(t,e){var n=e.checked;return qt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function gb(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=co(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function S1(t,e){e=e.checked,e!=null&&Yy(t,"checked",e,!1)}function Kg(t,e){S1(t,e);var n=co(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Gg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Gg(t,e.type,co(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Gg(t,e,n){(e!=="number"||Nf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Vc=Array.isArray;function yl(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+co(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Yg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ue(91));return qt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function yb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ue(92));if(Vc(n)){if(1<n.length)throw Error(ue(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:co(n)}}function j1(t,e){var n=co(e.value),s=co(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function vb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function C1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?C1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var eh,N1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(eh=eh||document.createElement("div"),eh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=eh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var nu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oR=["Webkit","ms","Moz","O"];Object.keys(nu).forEach(function(t){oR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nu[e]=nu[t]})});function E1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||nu.hasOwnProperty(t)&&nu[t]?(""+e).trim():e+"px"}function T1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=E1(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var aR=qt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xg(t,e){if(e){if(aR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ue(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ue(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ue(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ue(62))}}function Jg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zg=null;function Zy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ex=null,vl=null,bl=null;function bb(t){if(t=bd(t)){if(typeof ex!="function")throw Error(ue(280));var e=t.stateNode;e&&(e=Pp(e),ex(t.stateNode,t.type,e))}}function P1(t){vl?bl?bl.push(t):bl=[t]:vl=t}function R1(){if(vl){var t=vl,e=bl;if(bl=vl=null,bb(t),e)for(t=0;t<e.length;t++)bb(e[t])}}function A1(t,e){return t(e)}function O1(){}var km=!1;function I1(t,e,n){if(km)return t(e,n);km=!0;try{return A1(t,e,n)}finally{km=!1,(vl!==null||bl!==null)&&(O1(),R1())}}function bu(t,e){var n=t.stateNode;if(n===null)return null;var s=Pp(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ue(231,e,typeof n));return n}var tx=!1;if(di)try{var Nc={};Object.defineProperty(Nc,"passive",{get:function(){tx=!0}}),window.addEventListener("test",Nc,Nc),window.removeEventListener("test",Nc,Nc)}catch{tx=!1}function lR(t,e,n,s,r,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var su=!1,Ef=null,Tf=!1,nx=null,cR={onError:function(t){su=!0,Ef=t}};function uR(t,e,n,s,r,i,o,a,l){su=!1,Ef=null,lR.apply(cR,arguments)}function dR(t,e,n,s,r,i,o,a,l){if(uR.apply(this,arguments),su){if(su){var u=Ef;su=!1,Ef=null}else throw Error(ue(198));Tf||(Tf=!0,nx=u)}}function ja(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function M1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function wb(t){if(ja(t)!==t)throw Error(ue(188))}function hR(t){var e=t.alternate;if(!e){if(e=ja(t),e===null)throw Error(ue(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return wb(r),t;if(i===s)return wb(r),e;i=i.sibling}throw Error(ue(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(ue(189))}}if(n.alternate!==s)throw Error(ue(190))}if(n.tag!==3)throw Error(ue(188));return n.stateNode.current===n?t:e}function D1(t){return t=hR(t),t!==null?L1(t):null}function L1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=L1(t);if(e!==null)return e;t=t.sibling}return null}var $1=Es.unstable_scheduleCallback,kb=Es.unstable_cancelCallback,fR=Es.unstable_shouldYield,pR=Es.unstable_requestPaint,Jt=Es.unstable_now,mR=Es.unstable_getCurrentPriorityLevel,ev=Es.unstable_ImmediatePriority,F1=Es.unstable_UserBlockingPriority,Pf=Es.unstable_NormalPriority,gR=Es.unstable_LowPriority,z1=Es.unstable_IdlePriority,Cp=null,Dr=null;function xR(t){if(Dr&&typeof Dr.onCommitFiberRoot=="function")try{Dr.onCommitFiberRoot(Cp,t,void 0,(t.current.flags&128)===128)}catch{}}var ar=Math.clz32?Math.clz32:bR,yR=Math.log,vR=Math.LN2;function bR(t){return t>>>=0,t===0?32:31-(yR(t)/vR|0)|0}var th=64,nh=4194304;function qc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Rf(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=qc(a):(i&=o,i!==0&&(s=qc(i)))}else o=n&~r,o!==0?s=qc(o):i!==0&&(s=qc(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-ar(e),r=1<<n,s|=t[n],e&=~r;return s}function wR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kR(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ar(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=wR(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function sx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function B1(){var t=th;return th<<=1,!(th&4194240)&&(th=64),t}function _m(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ar(e),t[e]=n}function _R(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-ar(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function tv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-ar(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var mt=0;function U1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var H1,nv,W1,V1,q1,rx=!1,sh=[],Xi=null,Ji=null,Zi=null,wu=new Map,ku=new Map,Pi=[],SR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _b(t,e){switch(t){case"focusin":case"focusout":Xi=null;break;case"dragenter":case"dragleave":Ji=null;break;case"mouseover":case"mouseout":Zi=null;break;case"pointerover":case"pointerout":wu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ku.delete(e.pointerId)}}function Ec(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=bd(e),e!==null&&nv(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function jR(t,e,n,s,r){switch(e){case"focusin":return Xi=Ec(Xi,t,e,n,s,r),!0;case"dragenter":return Ji=Ec(Ji,t,e,n,s,r),!0;case"mouseover":return Zi=Ec(Zi,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return wu.set(i,Ec(wu.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,ku.set(i,Ec(ku.get(i)||null,t,e,n,s,r)),!0}return!1}function K1(t){var e=Wo(t.target);if(e!==null){var n=ja(e);if(n!==null){if(e=n.tag,e===13){if(e=M1(n),e!==null){t.blockedOn=e,q1(t.priority,function(){W1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function tf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ix(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Zg=s,n.target.dispatchEvent(s),Zg=null}else return e=bd(n),e!==null&&nv(e),t.blockedOn=n,!1;e.shift()}return!0}function Sb(t,e,n){tf(t)&&n.delete(e)}function CR(){rx=!1,Xi!==null&&tf(Xi)&&(Xi=null),Ji!==null&&tf(Ji)&&(Ji=null),Zi!==null&&tf(Zi)&&(Zi=null),wu.forEach(Sb),ku.forEach(Sb)}function Tc(t,e){t.blockedOn===e&&(t.blockedOn=null,rx||(rx=!0,Es.unstable_scheduleCallback(Es.unstable_NormalPriority,CR)))}function _u(t){function e(r){return Tc(r,t)}if(0<sh.length){Tc(sh[0],t);for(var n=1;n<sh.length;n++){var s=sh[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Xi!==null&&Tc(Xi,t),Ji!==null&&Tc(Ji,t),Zi!==null&&Tc(Zi,t),wu.forEach(e),ku.forEach(e),n=0;n<Pi.length;n++)s=Pi[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Pi.length&&(n=Pi[0],n.blockedOn===null);)K1(n),n.blockedOn===null&&Pi.shift()}var wl=vi.ReactCurrentBatchConfig,Af=!0;function NR(t,e,n,s){var r=mt,i=wl.transition;wl.transition=null;try{mt=1,sv(t,e,n,s)}finally{mt=r,wl.transition=i}}function ER(t,e,n,s){var r=mt,i=wl.transition;wl.transition=null;try{mt=4,sv(t,e,n,s)}finally{mt=r,wl.transition=i}}function sv(t,e,n,s){if(Af){var r=ix(t,e,n,s);if(r===null)Om(t,e,s,Of,n),_b(t,s);else if(jR(r,t,e,n,s))s.stopPropagation();else if(_b(t,s),e&4&&-1<SR.indexOf(t)){for(;r!==null;){var i=bd(r);if(i!==null&&H1(i),i=ix(t,e,n,s),i===null&&Om(t,e,s,Of,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Om(t,e,s,null,n)}}var Of=null;function ix(t,e,n,s){if(Of=null,t=Zy(s),t=Wo(t),t!==null)if(e=ja(t),e===null)t=null;else if(n=e.tag,n===13){if(t=M1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Of=t,null}function G1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mR()){case ev:return 1;case F1:return 4;case Pf:case gR:return 16;case z1:return 536870912;default:return 16}default:return 16}}var Wi=null,rv=null,nf=null;function Y1(){if(nf)return nf;var t,e=rv,n=e.length,s,r="value"in Wi?Wi.value:Wi.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return nf=r.slice(t,1<s?1-s:void 0)}function sf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function rh(){return!0}function jb(){return!1}function Ps(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?rh:jb,this.isPropagationStopped=jb,this}return qt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=rh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=rh)},persist:function(){},isPersistent:rh}),e}var ic={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iv=Ps(ic),vd=qt({},ic,{view:0,detail:0}),TR=Ps(vd),Sm,jm,Pc,Np=qt({},vd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ov,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pc&&(Pc&&t.type==="mousemove"?(Sm=t.screenX-Pc.screenX,jm=t.screenY-Pc.screenY):jm=Sm=0,Pc=t),Sm)},movementY:function(t){return"movementY"in t?t.movementY:jm}}),Cb=Ps(Np),PR=qt({},Np,{dataTransfer:0}),RR=Ps(PR),AR=qt({},vd,{relatedTarget:0}),Cm=Ps(AR),OR=qt({},ic,{animationName:0,elapsedTime:0,pseudoElement:0}),IR=Ps(OR),MR=qt({},ic,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),DR=Ps(MR),LR=qt({},ic,{data:0}),Nb=Ps(LR),$R={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=zR[t])?!!e[t]:!1}function ov(){return BR}var UR=qt({},vd,{key:function(t){if(t.key){var e=$R[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=sf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?FR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ov,charCode:function(t){return t.type==="keypress"?sf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),HR=Ps(UR),WR=qt({},Np,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Eb=Ps(WR),VR=qt({},vd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ov}),qR=Ps(VR),KR=qt({},ic,{propertyName:0,elapsedTime:0,pseudoElement:0}),GR=Ps(KR),YR=qt({},Np,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),QR=Ps(YR),XR=[9,13,27,32],av=di&&"CompositionEvent"in window,ru=null;di&&"documentMode"in document&&(ru=document.documentMode);var JR=di&&"TextEvent"in window&&!ru,Q1=di&&(!av||ru&&8<ru&&11>=ru),Tb=" ",Pb=!1;function X1(t,e){switch(t){case"keyup":return XR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function J1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var il=!1;function ZR(t,e){switch(t){case"compositionend":return J1(e);case"keypress":return e.which!==32?null:(Pb=!0,Tb);case"textInput":return t=e.data,t===Tb&&Pb?null:t;default:return null}}function eA(t,e){if(il)return t==="compositionend"||!av&&X1(t,e)?(t=Y1(),nf=rv=Wi=null,il=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Q1&&e.locale!=="ko"?null:e.data;default:return null}}var tA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!tA[t.type]:e==="textarea"}function Z1(t,e,n,s){P1(s),e=If(e,"onChange"),0<e.length&&(n=new iv("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var iu=null,Su=null;function nA(t){uj(t,0)}function Ep(t){var e=ll(t);if(_1(e))return t}function sA(t,e){if(t==="change")return e}var ej=!1;if(di){var Nm;if(di){var Em="oninput"in document;if(!Em){var Ab=document.createElement("div");Ab.setAttribute("oninput","return;"),Em=typeof Ab.oninput=="function"}Nm=Em}else Nm=!1;ej=Nm&&(!document.documentMode||9<document.documentMode)}function Ob(){iu&&(iu.detachEvent("onpropertychange",tj),Su=iu=null)}function tj(t){if(t.propertyName==="value"&&Ep(Su)){var e=[];Z1(e,Su,t,Zy(t)),I1(nA,e)}}function rA(t,e,n){t==="focusin"?(Ob(),iu=e,Su=n,iu.attachEvent("onpropertychange",tj)):t==="focusout"&&Ob()}function iA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ep(Su)}function oA(t,e){if(t==="click")return Ep(e)}function aA(t,e){if(t==="input"||t==="change")return Ep(e)}function lA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ur=typeof Object.is=="function"?Object.is:lA;function ju(t,e){if(ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Bg.call(e,r)||!ur(t[r],e[r]))return!1}return!0}function Ib(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Mb(t,e){var n=Ib(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ib(n)}}function nj(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nj(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sj(){for(var t=window,e=Nf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Nf(t.document)}return e}function lv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function cA(t){var e=sj(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nj(n.ownerDocument.documentElement,n)){if(s!==null&&lv(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=Mb(n,i);var o=Mb(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var uA=di&&"documentMode"in document&&11>=document.documentMode,ol=null,ox=null,ou=null,ax=!1;function Db(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ax||ol==null||ol!==Nf(s)||(s=ol,"selectionStart"in s&&lv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ou&&ju(ou,s)||(ou=s,s=If(ox,"onSelect"),0<s.length&&(e=new iv("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=ol)))}function ih(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var al={animationend:ih("Animation","AnimationEnd"),animationiteration:ih("Animation","AnimationIteration"),animationstart:ih("Animation","AnimationStart"),transitionend:ih("Transition","TransitionEnd")},Tm={},rj={};di&&(rj=document.createElement("div").style,"AnimationEvent"in window||(delete al.animationend.animation,delete al.animationiteration.animation,delete al.animationstart.animation),"TransitionEvent"in window||delete al.transitionend.transition);function Tp(t){if(Tm[t])return Tm[t];if(!al[t])return t;var e=al[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rj)return Tm[t]=e[n];return t}var ij=Tp("animationend"),oj=Tp("animationiteration"),aj=Tp("animationstart"),lj=Tp("transitionend"),cj=new Map,Lb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yo(t,e){cj.set(t,e),Sa(e,[t])}for(var Pm=0;Pm<Lb.length;Pm++){var Rm=Lb[Pm],dA=Rm.toLowerCase(),hA=Rm[0].toUpperCase()+Rm.slice(1);yo(dA,"on"+hA)}yo(ij,"onAnimationEnd");yo(oj,"onAnimationIteration");yo(aj,"onAnimationStart");yo("dblclick","onDoubleClick");yo("focusin","onFocus");yo("focusout","onBlur");yo(lj,"onTransitionEnd");Yl("onMouseEnter",["mouseout","mouseover"]);Yl("onMouseLeave",["mouseout","mouseover"]);Yl("onPointerEnter",["pointerout","pointerover"]);Yl("onPointerLeave",["pointerout","pointerover"]);Sa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Sa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Sa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Sa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Sa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Sa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Kc));function $b(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,dR(s,e,void 0,t),t.currentTarget=null}function uj(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;$b(r,a,u),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;$b(r,a,u),i=l}}}if(Tf)throw t=nx,Tf=!1,nx=null,t}function Ct(t,e){var n=e[hx];n===void 0&&(n=e[hx]=new Set);var s=t+"__bubble";n.has(s)||(dj(e,t,2,!1),n.add(s))}function Am(t,e,n){var s=0;e&&(s|=4),dj(n,t,s,e)}var oh="_reactListening"+Math.random().toString(36).slice(2);function Cu(t){if(!t[oh]){t[oh]=!0,y1.forEach(function(n){n!=="selectionchange"&&(fA.has(n)||Am(n,!1,t),Am(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[oh]||(e[oh]=!0,Am("selectionchange",!1,e))}}function dj(t,e,n,s){switch(G1(e)){case 1:var r=NR;break;case 4:r=ER;break;default:r=sv}n=r.bind(null,e,n,t),r=void 0,!tx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Om(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Wo(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}I1(function(){var u=i,d=Zy(n),h=[];e:{var f=cj.get(t);if(f!==void 0){var p=iv,b=t;switch(t){case"keypress":if(sf(n)===0)break e;case"keydown":case"keyup":p=HR;break;case"focusin":b="focus",p=Cm;break;case"focusout":b="blur",p=Cm;break;case"beforeblur":case"afterblur":p=Cm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Cb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=RR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=qR;break;case ij:case oj:case aj:p=IR;break;case lj:p=GR;break;case"scroll":p=TR;break;case"wheel":p=QR;break;case"copy":case"cut":case"paste":p=DR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Eb}var x=(e&4)!==0,y=!x&&t==="scroll",g=x?f!==null?f+"Capture":null:f;x=[];for(var m=u,w;m!==null;){w=m;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,g!==null&&(k=bu(m,g),k!=null&&x.push(Nu(m,k,w)))),y)break;m=m.return}0<x.length&&(f=new p(f,b,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==Zg&&(b=n.relatedTarget||n.fromElement)&&(Wo(b)||b[hi]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(b=n.relatedTarget||n.toElement,p=u,b=b?Wo(b):null,b!==null&&(y=ja(b),b!==y||b.tag!==5&&b.tag!==6)&&(b=null)):(p=null,b=u),p!==b)){if(x=Cb,k="onMouseLeave",g="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(x=Eb,k="onPointerLeave",g="onPointerEnter",m="pointer"),y=p==null?f:ll(p),w=b==null?f:ll(b),f=new x(k,m+"leave",p,n,d),f.target=y,f.relatedTarget=w,k=null,Wo(d)===u&&(x=new x(g,m+"enter",b,n,d),x.target=w,x.relatedTarget=y,k=x),y=k,p&&b)t:{for(x=p,g=b,m=0,w=x;w;w=za(w))m++;for(w=0,k=g;k;k=za(k))w++;for(;0<m-w;)x=za(x),m--;for(;0<w-m;)g=za(g),w--;for(;m--;){if(x===g||g!==null&&x===g.alternate)break t;x=za(x),g=za(g)}x=null}else x=null;p!==null&&Fb(h,f,p,x,!1),b!==null&&y!==null&&Fb(h,y,b,x,!0)}}e:{if(f=u?ll(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var _=sA;else if(Rb(f))if(ej)_=aA;else{_=iA;var C=rA}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=oA);if(_&&(_=_(t,u))){Z1(h,_,n,d);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Gg(f,"number",f.value)}switch(C=u?ll(u):window,t){case"focusin":(Rb(C)||C.contentEditable==="true")&&(ol=C,ox=u,ou=null);break;case"focusout":ou=ox=ol=null;break;case"mousedown":ax=!0;break;case"contextmenu":case"mouseup":case"dragend":ax=!1,Db(h,n,d);break;case"selectionchange":if(uA)break;case"keydown":case"keyup":Db(h,n,d)}var S;if(av)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else il?X1(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(Q1&&n.locale!=="ko"&&(il||j!=="onCompositionStart"?j==="onCompositionEnd"&&il&&(S=Y1()):(Wi=d,rv="value"in Wi?Wi.value:Wi.textContent,il=!0)),C=If(u,j),0<C.length&&(j=new Nb(j,t,null,n,d),h.push({event:j,listeners:C}),S?j.data=S:(S=J1(n),S!==null&&(j.data=S)))),(S=JR?ZR(t,n):eA(t,n))&&(u=If(u,"onBeforeInput"),0<u.length&&(d=new Nb("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=S))}uj(h,e)})}function Nu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function If(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=bu(t,n),i!=null&&s.unshift(Nu(t,i,r)),i=bu(t,e),i!=null&&s.push(Nu(t,i,r))),t=t.return}return s}function za(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Fb(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&u!==null&&(a=u,r?(l=bu(n,i),l!=null&&o.unshift(Nu(n,l,a))):r||(l=bu(n,i),l!=null&&o.push(Nu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var pA=/\r\n?/g,mA=/\u0000|\uFFFD/g;function zb(t){return(typeof t=="string"?t:""+t).replace(pA,`
`).replace(mA,"")}function ah(t,e,n){if(e=zb(e),zb(t)!==e&&n)throw Error(ue(425))}function Mf(){}var lx=null,cx=null;function ux(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dx=typeof setTimeout=="function"?setTimeout:void 0,gA=typeof clearTimeout=="function"?clearTimeout:void 0,Bb=typeof Promise=="function"?Promise:void 0,xA=typeof queueMicrotask=="function"?queueMicrotask:typeof Bb<"u"?function(t){return Bb.resolve(null).then(t).catch(yA)}:dx;function yA(t){setTimeout(function(){throw t})}function Im(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),_u(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);_u(e)}function eo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ub(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var oc=Math.random().toString(36).slice(2),Ar="__reactFiber$"+oc,Eu="__reactProps$"+oc,hi="__reactContainer$"+oc,hx="__reactEvents$"+oc,vA="__reactListeners$"+oc,bA="__reactHandles$"+oc;function Wo(t){var e=t[Ar];if(e)return e;for(var n=t.parentNode;n;){if(e=n[hi]||n[Ar]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ub(t);t!==null;){if(n=t[Ar])return n;t=Ub(t)}return e}t=n,n=t.parentNode}return null}function bd(t){return t=t[Ar]||t[hi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ll(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ue(33))}function Pp(t){return t[Eu]||null}var fx=[],cl=-1;function vo(t){return{current:t}}function Pt(t){0>cl||(t.current=fx[cl],fx[cl]=null,cl--)}function _t(t,e){cl++,fx[cl]=t.current,t.current=e}var uo={},In=vo(uo),os=vo(!1),ha=uo;function Ql(t,e){var n=t.type.contextTypes;if(!n)return uo;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function as(t){return t=t.childContextTypes,t!=null}function Df(){Pt(os),Pt(In)}function Hb(t,e,n){if(In.current!==uo)throw Error(ue(168));_t(In,e),_t(os,n)}function hj(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(ue(108,rR(t)||"Unknown",r));return qt({},n,s)}function Lf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||uo,ha=In.current,_t(In,t),_t(os,os.current),!0}function Wb(t,e,n){var s=t.stateNode;if(!s)throw Error(ue(169));n?(t=hj(t,e,ha),s.__reactInternalMemoizedMergedChildContext=t,Pt(os),Pt(In),_t(In,t)):Pt(os),_t(os,n)}var Jr=null,Rp=!1,Mm=!1;function fj(t){Jr===null?Jr=[t]:Jr.push(t)}function wA(t){Rp=!0,fj(t)}function bo(){if(!Mm&&Jr!==null){Mm=!0;var t=0,e=mt;try{var n=Jr;for(mt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Jr=null,Rp=!1}catch(r){throw Jr!==null&&(Jr=Jr.slice(t+1)),$1(ev,bo),r}finally{mt=e,Mm=!1}}return null}var ul=[],dl=0,$f=null,Ff=0,Fs=[],zs=0,fa=null,ri=1,ii="";function Lo(t,e){ul[dl++]=Ff,ul[dl++]=$f,$f=t,Ff=e}function pj(t,e,n){Fs[zs++]=ri,Fs[zs++]=ii,Fs[zs++]=fa,fa=t;var s=ri;t=ii;var r=32-ar(s)-1;s&=~(1<<r),n+=1;var i=32-ar(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,ri=1<<32-ar(e)+r|n<<r|s,ii=i+t}else ri=1<<i|n<<r|s,ii=t}function cv(t){t.return!==null&&(Lo(t,1),pj(t,1,0))}function uv(t){for(;t===$f;)$f=ul[--dl],ul[dl]=null,Ff=ul[--dl],ul[dl]=null;for(;t===fa;)fa=Fs[--zs],Fs[zs]=null,ii=Fs[--zs],Fs[zs]=null,ri=Fs[--zs],Fs[zs]=null}var Ss=null,_s=null,Dt=!1,or=null;function mj(t,e){var n=Bs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Vb(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ss=t,_s=eo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ss=t,_s=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fa!==null?{id:ri,overflow:ii}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ss=t,_s=null,!0):!1;default:return!1}}function px(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mx(t){if(Dt){var e=_s;if(e){var n=e;if(!Vb(t,e)){if(px(t))throw Error(ue(418));e=eo(n.nextSibling);var s=Ss;e&&Vb(t,e)?mj(s,n):(t.flags=t.flags&-4097|2,Dt=!1,Ss=t)}}else{if(px(t))throw Error(ue(418));t.flags=t.flags&-4097|2,Dt=!1,Ss=t}}}function qb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ss=t}function lh(t){if(t!==Ss)return!1;if(!Dt)return qb(t),Dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ux(t.type,t.memoizedProps)),e&&(e=_s)){if(px(t))throw gj(),Error(ue(418));for(;e;)mj(t,e),e=eo(e.nextSibling)}if(qb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ue(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){_s=eo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}_s=null}}else _s=Ss?eo(t.stateNode.nextSibling):null;return!0}function gj(){for(var t=_s;t;)t=eo(t.nextSibling)}function Xl(){_s=Ss=null,Dt=!1}function dv(t){or===null?or=[t]:or.push(t)}var kA=vi.ReactCurrentBatchConfig;function Rc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ue(309));var s=n.stateNode}if(!s)throw Error(ue(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(ue(284));if(!n._owner)throw Error(ue(290,t))}return t}function ch(t,e){throw t=Object.prototype.toString.call(e),Error(ue(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Kb(t){var e=t._init;return e(t._payload)}function xj(t){function e(g,m){if(t){var w=g.deletions;w===null?(g.deletions=[m],g.flags|=16):w.push(m)}}function n(g,m){if(!t)return null;for(;m!==null;)e(g,m),m=m.sibling;return null}function s(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function r(g,m){return g=ro(g,m),g.index=0,g.sibling=null,g}function i(g,m,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<m?(g.flags|=2,m):w):(g.flags|=2,m)):(g.flags|=1048576,m)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,m,w,k){return m===null||m.tag!==6?(m=Um(w,g.mode,k),m.return=g,m):(m=r(m,w),m.return=g,m)}function l(g,m,w,k){var _=w.type;return _===rl?d(g,m,w.props.children,k,w.key):m!==null&&(m.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ni&&Kb(_)===m.type)?(k=r(m,w.props),k.ref=Rc(g,m,w),k.return=g,k):(k=df(w.type,w.key,w.props,null,g.mode,k),k.ref=Rc(g,m,w),k.return=g,k)}function u(g,m,w,k){return m===null||m.tag!==4||m.stateNode.containerInfo!==w.containerInfo||m.stateNode.implementation!==w.implementation?(m=Hm(w,g.mode,k),m.return=g,m):(m=r(m,w.children||[]),m.return=g,m)}function d(g,m,w,k,_){return m===null||m.tag!==7?(m=aa(w,g.mode,k,_),m.return=g,m):(m=r(m,w),m.return=g,m)}function h(g,m,w){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Um(""+m,g.mode,w),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Jd:return w=df(m.type,m.key,m.props,null,g.mode,w),w.ref=Rc(g,null,m),w.return=g,w;case sl:return m=Hm(m,g.mode,w),m.return=g,m;case Ni:var k=m._init;return h(g,k(m._payload),w)}if(Vc(m)||Cc(m))return m=aa(m,g.mode,w,null),m.return=g,m;ch(g,m)}return null}function f(g,m,w,k){var _=m!==null?m.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:a(g,m,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Jd:return w.key===_?l(g,m,w,k):null;case sl:return w.key===_?u(g,m,w,k):null;case Ni:return _=w._init,f(g,m,_(w._payload),k)}if(Vc(w)||Cc(w))return _!==null?null:d(g,m,w,k,null);ch(g,w)}return null}function p(g,m,w,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(w)||null,a(m,g,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Jd:return g=g.get(k.key===null?w:k.key)||null,l(m,g,k,_);case sl:return g=g.get(k.key===null?w:k.key)||null,u(m,g,k,_);case Ni:var C=k._init;return p(g,m,w,C(k._payload),_)}if(Vc(k)||Cc(k))return g=g.get(w)||null,d(m,g,k,_,null);ch(m,k)}return null}function b(g,m,w,k){for(var _=null,C=null,S=m,j=m=0,N=null;S!==null&&j<w.length;j++){S.index>j?(N=S,S=null):N=S.sibling;var R=f(g,S,w[j],k);if(R===null){S===null&&(S=N);break}t&&S&&R.alternate===null&&e(g,S),m=i(R,m,j),C===null?_=R:C.sibling=R,C=R,S=N}if(j===w.length)return n(g,S),Dt&&Lo(g,j),_;if(S===null){for(;j<w.length;j++)S=h(g,w[j],k),S!==null&&(m=i(S,m,j),C===null?_=S:C.sibling=S,C=S);return Dt&&Lo(g,j),_}for(S=s(g,S);j<w.length;j++)N=p(S,g,j,w[j],k),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?j:N.key),m=i(N,m,j),C===null?_=N:C.sibling=N,C=N);return t&&S.forEach(function(M){return e(g,M)}),Dt&&Lo(g,j),_}function x(g,m,w,k){var _=Cc(w);if(typeof _!="function")throw Error(ue(150));if(w=_.call(w),w==null)throw Error(ue(151));for(var C=_=null,S=m,j=m=0,N=null,R=w.next();S!==null&&!R.done;j++,R=w.next()){S.index>j?(N=S,S=null):N=S.sibling;var M=f(g,S,R.value,k);if(M===null){S===null&&(S=N);break}t&&S&&M.alternate===null&&e(g,S),m=i(M,m,j),C===null?_=M:C.sibling=M,C=M,S=N}if(R.done)return n(g,S),Dt&&Lo(g,j),_;if(S===null){for(;!R.done;j++,R=w.next())R=h(g,R.value,k),R!==null&&(m=i(R,m,j),C===null?_=R:C.sibling=R,C=R);return Dt&&Lo(g,j),_}for(S=s(g,S);!R.done;j++,R=w.next())R=p(S,g,j,R.value,k),R!==null&&(t&&R.alternate!==null&&S.delete(R.key===null?j:R.key),m=i(R,m,j),C===null?_=R:C.sibling=R,C=R);return t&&S.forEach(function(O){return e(g,O)}),Dt&&Lo(g,j),_}function y(g,m,w,k){if(typeof w=="object"&&w!==null&&w.type===rl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Jd:e:{for(var _=w.key,C=m;C!==null;){if(C.key===_){if(_=w.type,_===rl){if(C.tag===7){n(g,C.sibling),m=r(C,w.props.children),m.return=g,g=m;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ni&&Kb(_)===C.type){n(g,C.sibling),m=r(C,w.props),m.ref=Rc(g,C,w),m.return=g,g=m;break e}n(g,C);break}else e(g,C);C=C.sibling}w.type===rl?(m=aa(w.props.children,g.mode,k,w.key),m.return=g,g=m):(k=df(w.type,w.key,w.props,null,g.mode,k),k.ref=Rc(g,m,w),k.return=g,g=k)}return o(g);case sl:e:{for(C=w.key;m!==null;){if(m.key===C)if(m.tag===4&&m.stateNode.containerInfo===w.containerInfo&&m.stateNode.implementation===w.implementation){n(g,m.sibling),m=r(m,w.children||[]),m.return=g,g=m;break e}else{n(g,m);break}else e(g,m);m=m.sibling}m=Hm(w,g.mode,k),m.return=g,g=m}return o(g);case Ni:return C=w._init,y(g,m,C(w._payload),k)}if(Vc(w))return b(g,m,w,k);if(Cc(w))return x(g,m,w,k);ch(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,m!==null&&m.tag===6?(n(g,m.sibling),m=r(m,w),m.return=g,g=m):(n(g,m),m=Um(w,g.mode,k),m.return=g,g=m),o(g)):n(g,m)}return y}var Jl=xj(!0),yj=xj(!1),zf=vo(null),Bf=null,hl=null,hv=null;function fv(){hv=hl=Bf=null}function pv(t){var e=zf.current;Pt(zf),t._currentValue=e}function gx(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function kl(t,e){Bf=t,hv=hl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ns=!0),t.firstContext=null)}function qs(t){var e=t._currentValue;if(hv!==t)if(t={context:t,memoizedValue:e,next:null},hl===null){if(Bf===null)throw Error(ue(308));hl=t,Bf.dependencies={lanes:0,firstContext:t}}else hl=hl.next=t;return e}var Vo=null;function mv(t){Vo===null?Vo=[t]:Vo.push(t)}function vj(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,mv(e)):(n.next=r.next,r.next=n),e.interleaved=n,fi(t,s)}function fi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ei=!1;function gv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bj(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function li(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function to(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,st&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,fi(t,n)}return r=s.interleaved,r===null?(e.next=e,mv(s)):(e.next=r.next,r.next=e),s.interleaved=e,fi(t,n)}function rf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,tv(t,n)}}function Gb(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Uf(t,e,n,s){var r=t.updateQueue;Ei=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,d=u=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,x=a;switch(f=e,p=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){h=b.call(p,h,f);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,f=typeof b=="function"?b.call(p,h,f):b,f==null)break e;h=qt({},h,f);break e;case 2:Ei=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,l=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(d===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);ma|=o,t.lanes=o,t.memoizedState=h}}function Yb(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(ue(191,r));r.call(s)}}}var wd={},Lr=vo(wd),Tu=vo(wd),Pu=vo(wd);function qo(t){if(t===wd)throw Error(ue(174));return t}function xv(t,e){switch(_t(Pu,e),_t(Tu,t),_t(Lr,wd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Qg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Qg(e,t)}Pt(Lr),_t(Lr,e)}function Zl(){Pt(Lr),Pt(Tu),Pt(Pu)}function wj(t){qo(Pu.current);var e=qo(Lr.current),n=Qg(e,t.type);e!==n&&(_t(Tu,t),_t(Lr,n))}function yv(t){Tu.current===t&&(Pt(Lr),Pt(Tu))}var Ut=vo(0);function Hf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dm=[];function vv(){for(var t=0;t<Dm.length;t++)Dm[t]._workInProgressVersionPrimary=null;Dm.length=0}var of=vi.ReactCurrentDispatcher,Lm=vi.ReactCurrentBatchConfig,pa=0,Vt=null,cn=null,gn=null,Wf=!1,au=!1,Ru=0,_A=0;function Nn(){throw Error(ue(321))}function bv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ur(t[n],e[n]))return!1;return!0}function wv(t,e,n,s,r,i){if(pa=i,Vt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,of.current=t===null||t.memoizedState===null?NA:EA,t=n(s,r),au){i=0;do{if(au=!1,Ru=0,25<=i)throw Error(ue(301));i+=1,gn=cn=null,e.updateQueue=null,of.current=TA,t=n(s,r)}while(au)}if(of.current=Vf,e=cn!==null&&cn.next!==null,pa=0,gn=cn=Vt=null,Wf=!1,e)throw Error(ue(300));return t}function kv(){var t=Ru!==0;return Ru=0,t}function Sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?Vt.memoizedState=gn=t:gn=gn.next=t,gn}function Ks(){if(cn===null){var t=Vt.alternate;t=t!==null?t.memoizedState:null}else t=cn.next;var e=gn===null?Vt.memoizedState:gn.next;if(e!==null)gn=e,cn=t;else{if(t===null)throw Error(ue(310));cn=t,t={memoizedState:cn.memoizedState,baseState:cn.baseState,baseQueue:cn.baseQueue,queue:cn.queue,next:null},gn===null?Vt.memoizedState=gn=t:gn=gn.next=t}return gn}function Au(t,e){return typeof e=="function"?e(t):e}function $m(t){var e=Ks(),n=e.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=t;var s=cn,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,u=i;do{var d=u.lane;if((pa&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,Vt.lanes|=d,ma|=d}u=u.next}while(u!==null&&u!==i);l===null?o=s:l.next=a,ur(s,e.memoizedState)||(ns=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Vt.lanes|=i,ma|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Fm(t){var e=Ks(),n=e.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);ur(i,e.memoizedState)||(ns=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function kj(){}function _j(t,e){var n=Vt,s=Ks(),r=e(),i=!ur(s.memoizedState,r);if(i&&(s.memoizedState=r,ns=!0),s=s.queue,_v(Cj.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||gn!==null&&gn.memoizedState.tag&1){if(n.flags|=2048,Ou(9,jj.bind(null,n,s,r,e),void 0,null),yn===null)throw Error(ue(349));pa&30||Sj(n,e,r)}return r}function Sj(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Vt.updateQueue,e===null?(e={lastEffect:null,stores:null},Vt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function jj(t,e,n,s){e.value=n,e.getSnapshot=s,Nj(e)&&Ej(t)}function Cj(t,e,n){return n(function(){Nj(e)&&Ej(t)})}function Nj(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ur(t,n)}catch{return!0}}function Ej(t){var e=fi(t,1);e!==null&&lr(e,t,1,-1)}function Qb(t){var e=Sr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Au,lastRenderedState:t},e.queue=t,t=t.dispatch=CA.bind(null,Vt,t),[e.memoizedState,t]}function Ou(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Vt.updateQueue,e===null?(e={lastEffect:null,stores:null},Vt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function Tj(){return Ks().memoizedState}function af(t,e,n,s){var r=Sr();Vt.flags|=t,r.memoizedState=Ou(1|e,n,void 0,s===void 0?null:s)}function Ap(t,e,n,s){var r=Ks();s=s===void 0?null:s;var i=void 0;if(cn!==null){var o=cn.memoizedState;if(i=o.destroy,s!==null&&bv(s,o.deps)){r.memoizedState=Ou(e,n,i,s);return}}Vt.flags|=t,r.memoizedState=Ou(1|e,n,i,s)}function Xb(t,e){return af(8390656,8,t,e)}function _v(t,e){return Ap(2048,8,t,e)}function Pj(t,e){return Ap(4,2,t,e)}function Rj(t,e){return Ap(4,4,t,e)}function Aj(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Oj(t,e,n){return n=n!=null?n.concat([t]):null,Ap(4,4,Aj.bind(null,e,t),n)}function Sv(){}function Ij(t,e){var n=Ks();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&bv(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function Mj(t,e){var n=Ks();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&bv(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function Dj(t,e,n){return pa&21?(ur(n,e)||(n=B1(),Vt.lanes|=n,ma|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ns=!0),t.memoizedState=n)}function SA(t,e){var n=mt;mt=n!==0&&4>n?n:4,t(!0);var s=Lm.transition;Lm.transition={};try{t(!1),e()}finally{mt=n,Lm.transition=s}}function Lj(){return Ks().memoizedState}function jA(t,e,n){var s=so(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},$j(t))Fj(e,n);else if(n=vj(t,e,n,s),n!==null){var r=Bn();lr(n,t,s,r),zj(n,e,s)}}function CA(t,e,n){var s=so(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if($j(t))Fj(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,ur(a,o)){var l=e.interleaved;l===null?(r.next=r,mv(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=vj(t,e,r,s),n!==null&&(r=Bn(),lr(n,t,s,r),zj(n,e,s))}}function $j(t){var e=t.alternate;return t===Vt||e!==null&&e===Vt}function Fj(t,e){au=Wf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zj(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,tv(t,n)}}var Vf={readContext:qs,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},NA={readContext:qs,useCallback:function(t,e){return Sr().memoizedState=[t,e===void 0?null:e],t},useContext:qs,useEffect:Xb,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,af(4194308,4,Aj.bind(null,e,t),n)},useLayoutEffect:function(t,e){return af(4194308,4,t,e)},useInsertionEffect:function(t,e){return af(4,2,t,e)},useMemo:function(t,e){var n=Sr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Sr();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=jA.bind(null,Vt,t),[s.memoizedState,t]},useRef:function(t){var e=Sr();return t={current:t},e.memoizedState=t},useState:Qb,useDebugValue:Sv,useDeferredValue:function(t){return Sr().memoizedState=t},useTransition:function(){var t=Qb(!1),e=t[0];return t=SA.bind(null,t[1]),Sr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Vt,r=Sr();if(Dt){if(n===void 0)throw Error(ue(407));n=n()}else{if(n=e(),yn===null)throw Error(ue(349));pa&30||Sj(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,Xb(Cj.bind(null,s,i,t),[t]),s.flags|=2048,Ou(9,jj.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Sr(),e=yn.identifierPrefix;if(Dt){var n=ii,s=ri;n=(s&~(1<<32-ar(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ru++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=_A++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},EA={readContext:qs,useCallback:Ij,useContext:qs,useEffect:_v,useImperativeHandle:Oj,useInsertionEffect:Pj,useLayoutEffect:Rj,useMemo:Mj,useReducer:$m,useRef:Tj,useState:function(){return $m(Au)},useDebugValue:Sv,useDeferredValue:function(t){var e=Ks();return Dj(e,cn.memoizedState,t)},useTransition:function(){var t=$m(Au)[0],e=Ks().memoizedState;return[t,e]},useMutableSource:kj,useSyncExternalStore:_j,useId:Lj,unstable_isNewReconciler:!1},TA={readContext:qs,useCallback:Ij,useContext:qs,useEffect:_v,useImperativeHandle:Oj,useInsertionEffect:Pj,useLayoutEffect:Rj,useMemo:Mj,useReducer:Fm,useRef:Tj,useState:function(){return Fm(Au)},useDebugValue:Sv,useDeferredValue:function(t){var e=Ks();return cn===null?e.memoizedState=t:Dj(e,cn.memoizedState,t)},useTransition:function(){var t=Fm(Au)[0],e=Ks().memoizedState;return[t,e]},useMutableSource:kj,useSyncExternalStore:_j,useId:Lj,unstable_isNewReconciler:!1};function er(t,e){if(t&&t.defaultProps){e=qt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function xx(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:qt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Op={isMounted:function(t){return(t=t._reactInternals)?ja(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Bn(),r=so(t),i=li(s,r);i.payload=e,n!=null&&(i.callback=n),e=to(t,i,r),e!==null&&(lr(e,t,r,s),rf(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Bn(),r=so(t),i=li(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=to(t,i,r),e!==null&&(lr(e,t,r,s),rf(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bn(),s=so(t),r=li(n,s);r.tag=2,e!=null&&(r.callback=e),e=to(t,r,s),e!==null&&(lr(e,t,s,n),rf(e,t,s))}};function Jb(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!ju(n,s)||!ju(r,i):!0}function Bj(t,e,n){var s=!1,r=uo,i=e.contextType;return typeof i=="object"&&i!==null?i=qs(i):(r=as(e)?ha:In.current,s=e.contextTypes,i=(s=s!=null)?Ql(t,r):uo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Op,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function Zb(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Op.enqueueReplaceState(e,e.state,null)}function yx(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},gv(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=qs(i):(i=as(e)?ha:In.current,r.context=Ql(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(xx(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Op.enqueueReplaceState(r,r.state,null),Uf(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function ec(t,e){try{var n="",s=e;do n+=sR(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function zm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function vx(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var PA=typeof WeakMap=="function"?WeakMap:Map;function Uj(t,e,n){n=li(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Kf||(Kf=!0,Tx=s),vx(t,e)},n}function Hj(t,e,n){n=li(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){vx(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){vx(t,e),typeof s!="function"&&(no===null?no=new Set([this]):no.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ew(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new PA;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=WA.bind(null,t,e,n),e.then(t,t))}function tw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nw(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=li(-1,1),e.tag=2,to(n,e,1))),n.lanes|=1),t)}var RA=vi.ReactCurrentOwner,ns=!1;function zn(t,e,n,s){e.child=t===null?yj(e,null,n,s):Jl(e,t.child,n,s)}function sw(t,e,n,s,r){n=n.render;var i=e.ref;return kl(e,r),s=wv(t,e,n,s,i,r),n=kv(),t!==null&&!ns?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,pi(t,e,r)):(Dt&&n&&cv(e),e.flags|=1,zn(t,e,s,r),e.child)}function rw(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Av(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Wj(t,e,i,s,r)):(t=df(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ju,n(o,s)&&t.ref===e.ref)return pi(t,e,r)}return e.flags|=1,t=ro(i,s),t.ref=e.ref,t.return=e,e.child=t}function Wj(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(ju(i,s)&&t.ref===e.ref)if(ns=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(ns=!0);else return e.lanes=t.lanes,pi(t,e,r)}return bx(t,e,n,s,r)}function Vj(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(pl,ys),ys|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(pl,ys),ys|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,_t(pl,ys),ys|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,_t(pl,ys),ys|=s;return zn(t,e,r,n),e.child}function qj(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function bx(t,e,n,s,r){var i=as(n)?ha:In.current;return i=Ql(e,i),kl(e,r),n=wv(t,e,n,s,i,r),s=kv(),t!==null&&!ns?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,pi(t,e,r)):(Dt&&s&&cv(e),e.flags|=1,zn(t,e,n,r),e.child)}function iw(t,e,n,s,r){if(as(n)){var i=!0;Lf(e)}else i=!1;if(kl(e,r),e.stateNode===null)lf(t,e),Bj(e,n,s),yx(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=qs(u):(u=as(n)?ha:In.current,u=Ql(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==u)&&Zb(e,o,s,u),Ei=!1;var f=e.memoizedState;o.state=f,Uf(e,s,o,r),l=e.memoizedState,a!==s||f!==l||os.current||Ei?(typeof d=="function"&&(xx(e,n,d,s),l=e.memoizedState),(a=Ei||Jb(e,n,a,s,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,bj(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:er(e.type,a),o.props=u,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=qs(l):(l=as(n)?ha:In.current,l=Ql(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&Zb(e,o,s,l),Ei=!1,f=e.memoizedState,o.state=f,Uf(e,s,o,r);var b=e.memoizedState;a!==h||f!==b||os.current||Ei?(typeof p=="function"&&(xx(e,n,p,s),b=e.memoizedState),(u=Ei||Jb(e,n,u,s,f,b,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,b,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,b,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=b),o.props=s,o.state=b,o.context=l,s=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return wx(t,e,n,s,i,r)}function wx(t,e,n,s,r,i){qj(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&Wb(e,n,!1),pi(t,e,i);s=e.stateNode,RA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Jl(e,t.child,null,i),e.child=Jl(e,null,a,i)):zn(t,e,a,i),e.memoizedState=s.state,r&&Wb(e,n,!0),e.child}function Kj(t){var e=t.stateNode;e.pendingContext?Hb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hb(t,e.context,!1),xv(t,e.containerInfo)}function ow(t,e,n,s,r){return Xl(),dv(r),e.flags|=256,zn(t,e,n,s),e.child}var kx={dehydrated:null,treeContext:null,retryLane:0};function _x(t){return{baseLanes:t,cachePool:null,transitions:null}}function Gj(t,e,n){var s=e.pendingProps,r=Ut.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),_t(Ut,r&1),t===null)return mx(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Dp(o,s,0,null),t=aa(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=_x(n),e.memoizedState=kx,t):jv(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return AA(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=ro(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=ro(a,i):(i=aa(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?_x(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=kx,s}return i=t.child,t=i.sibling,s=ro(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function jv(t,e){return e=Dp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function uh(t,e,n,s){return s!==null&&dv(s),Jl(e,t.child,null,n),t=jv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function AA(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=zm(Error(ue(422))),uh(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Dp({mode:"visible",children:s.children},r,0,null),i=aa(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Jl(e,t.child,null,o),e.child.memoizedState=_x(o),e.memoizedState=kx,i);if(!(e.mode&1))return uh(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(ue(419)),s=zm(i,s,void 0),uh(t,e,o,s)}if(a=(o&t.childLanes)!==0,ns||a){if(s=yn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,fi(t,r),lr(s,t,r,-1))}return Rv(),s=zm(Error(ue(421))),uh(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=VA.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,_s=eo(r.nextSibling),Ss=e,Dt=!0,or=null,t!==null&&(Fs[zs++]=ri,Fs[zs++]=ii,Fs[zs++]=fa,ri=t.id,ii=t.overflow,fa=e),e=jv(e,s.children),e.flags|=4096,e)}function aw(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),gx(t.return,e,n)}function Bm(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function Yj(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(zn(t,e,s.children,n),s=Ut.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&aw(t,n,e);else if(t.tag===19)aw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(_t(Ut,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Hf(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Bm(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Hf(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Bm(e,!0,n,null,i);break;case"together":Bm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function lf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function pi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ma|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ue(153));if(e.child!==null){for(t=e.child,n=ro(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ro(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function OA(t,e,n){switch(e.tag){case 3:Kj(e),Xl();break;case 5:wj(e);break;case 1:as(e.type)&&Lf(e);break;case 4:xv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;_t(zf,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(_t(Ut,Ut.current&1),e.flags|=128,null):n&e.child.childLanes?Gj(t,e,n):(_t(Ut,Ut.current&1),t=pi(t,e,n),t!==null?t.sibling:null);_t(Ut,Ut.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return Yj(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),_t(Ut,Ut.current),s)break;return null;case 22:case 23:return e.lanes=0,Vj(t,e,n)}return pi(t,e,n)}var Qj,Sx,Xj,Jj;Qj=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Sx=function(){};Xj=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,qo(Lr.current);var i=null;switch(n){case"input":r=qg(t,r),s=qg(t,s),i=[];break;case"select":r=qt({},r,{value:void 0}),s=qt({},s,{value:void 0}),i=[];break;case"textarea":r=Yg(t,r),s=Yg(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Mf)}Xg(n,s);var o;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(yu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var l=s[u];if(a=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(yu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ct("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};Jj=function(t,e,n,s){n!==s&&(e.flags|=4)};function Ac(t,e){if(!Dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function En(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function IA(t,e,n){var s=e.pendingProps;switch(uv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return En(e),null;case 1:return as(e.type)&&Df(),En(e),null;case 3:return s=e.stateNode,Zl(),Pt(os),Pt(In),vv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(lh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,or!==null&&(Ax(or),or=null))),Sx(t,e),En(e),null;case 5:yv(e);var r=qo(Pu.current);if(n=e.type,t!==null&&e.stateNode!=null)Xj(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ue(166));return En(e),null}if(t=qo(Lr.current),lh(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Ar]=e,s[Eu]=i,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",s),Ct("close",s);break;case"iframe":case"object":case"embed":Ct("load",s);break;case"video":case"audio":for(r=0;r<Kc.length;r++)Ct(Kc[r],s);break;case"source":Ct("error",s);break;case"img":case"image":case"link":Ct("error",s),Ct("load",s);break;case"details":Ct("toggle",s);break;case"input":gb(s,i),Ct("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Ct("invalid",s);break;case"textarea":yb(s,i),Ct("invalid",s)}Xg(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&ah(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&ah(s.textContent,a,t),r=["children",""+a]):yu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ct("scroll",s)}switch(n){case"input":Zd(s),xb(s,i,!0);break;case"textarea":Zd(s),vb(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Mf)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=C1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[Ar]=e,t[Eu]=s,Qj(t,e,!1,!1),e.stateNode=t;e:{switch(o=Jg(n,s),n){case"dialog":Ct("cancel",t),Ct("close",t),r=s;break;case"iframe":case"object":case"embed":Ct("load",t),r=s;break;case"video":case"audio":for(r=0;r<Kc.length;r++)Ct(Kc[r],t);r=s;break;case"source":Ct("error",t),r=s;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),r=s;break;case"details":Ct("toggle",t),r=s;break;case"input":gb(t,s),r=qg(t,s),Ct("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=qt({},s,{value:void 0}),Ct("invalid",t);break;case"textarea":yb(t,s),r=Yg(t,s),Ct("invalid",t);break;default:r=s}Xg(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?T1(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&N1(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&vu(t,l):typeof l=="number"&&vu(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(yu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ct("scroll",t):l!=null&&Yy(t,i,l,o))}switch(n){case"input":Zd(t),xb(t,s,!1);break;case"textarea":Zd(t),vb(t);break;case"option":s.value!=null&&t.setAttribute("value",""+co(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?yl(t,!!s.multiple,i,!1):s.defaultValue!=null&&yl(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Mf)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return En(e),null;case 6:if(t&&e.stateNode!=null)Jj(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ue(166));if(n=qo(Pu.current),qo(Lr.current),lh(e)){if(s=e.stateNode,n=e.memoizedProps,s[Ar]=e,(i=s.nodeValue!==n)&&(t=Ss,t!==null))switch(t.tag){case 3:ah(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ah(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Ar]=e,e.stateNode=s}return En(e),null;case 13:if(Pt(Ut),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Dt&&_s!==null&&e.mode&1&&!(e.flags&128))gj(),Xl(),e.flags|=98560,i=!1;else if(i=lh(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(ue(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(317));i[Ar]=e}else Xl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;En(e),i=!1}else or!==null&&(Ax(or),or=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Ut.current&1?dn===0&&(dn=3):Rv())),e.updateQueue!==null&&(e.flags|=4),En(e),null);case 4:return Zl(),Sx(t,e),t===null&&Cu(e.stateNode.containerInfo),En(e),null;case 10:return pv(e.type._context),En(e),null;case 17:return as(e.type)&&Df(),En(e),null;case 19:if(Pt(Ut),i=e.memoizedState,i===null)return En(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)Ac(i,!1);else{if(dn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Hf(t),o!==null){for(e.flags|=128,Ac(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t(Ut,Ut.current&1|2),e.child}t=t.sibling}i.tail!==null&&Jt()>tc&&(e.flags|=128,s=!0,Ac(i,!1),e.lanes=4194304)}else{if(!s)if(t=Hf(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ac(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Dt)return En(e),null}else 2*Jt()-i.renderingStartTime>tc&&n!==1073741824&&(e.flags|=128,s=!0,Ac(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Jt(),e.sibling=null,n=Ut.current,_t(Ut,s?n&1|2:n&1),e):(En(e),null);case 22:case 23:return Pv(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?ys&1073741824&&(En(e),e.subtreeFlags&6&&(e.flags|=8192)):En(e),null;case 24:return null;case 25:return null}throw Error(ue(156,e.tag))}function MA(t,e){switch(uv(e),e.tag){case 1:return as(e.type)&&Df(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zl(),Pt(os),Pt(In),vv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return yv(e),null;case 13:if(Pt(Ut),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ue(340));Xl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pt(Ut),null;case 4:return Zl(),null;case 10:return pv(e.type._context),null;case 22:case 23:return Pv(),null;case 24:return null;default:return null}}var dh=!1,Pn=!1,DA=typeof WeakSet=="function"?WeakSet:Set,je=null;function fl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Qt(t,e,s)}else n.current=null}function jx(t,e,n){try{n()}catch(s){Qt(t,e,s)}}var lw=!1;function LA(t,e){if(lx=Af,t=sj(),lv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++u===r&&(a=o),f===i&&++d===s&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(cx={focusedElem:t,selectionRange:n},Af=!1,je=e;je!==null;)if(e=je,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,je=t;else for(;je!==null;){e=je;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,y=b.memoizedState,g=e.stateNode,m=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:er(e.type,x),y);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(k){Qt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,je=t;break}je=e.return}return b=lw,lw=!1,b}function lu(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&jx(e,n,i)}r=r.next}while(r!==s)}}function Ip(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Cx(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Zj(t){var e=t.alternate;e!==null&&(t.alternate=null,Zj(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ar],delete e[Eu],delete e[hx],delete e[vA],delete e[bA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function eC(t){return t.tag===5||t.tag===3||t.tag===4}function cw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||eC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Nx(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Mf));else if(s!==4&&(t=t.child,t!==null))for(Nx(t,e,n),t=t.sibling;t!==null;)Nx(t,e,n),t=t.sibling}function Ex(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Ex(t,e,n),t=t.sibling;t!==null;)Ex(t,e,n),t=t.sibling}var wn=null,rr=!1;function ki(t,e,n){for(n=n.child;n!==null;)tC(t,e,n),n=n.sibling}function tC(t,e,n){if(Dr&&typeof Dr.onCommitFiberUnmount=="function")try{Dr.onCommitFiberUnmount(Cp,n)}catch{}switch(n.tag){case 5:Pn||fl(n,e);case 6:var s=wn,r=rr;wn=null,ki(t,e,n),wn=s,rr=r,wn!==null&&(rr?(t=wn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wn.removeChild(n.stateNode));break;case 18:wn!==null&&(rr?(t=wn,n=n.stateNode,t.nodeType===8?Im(t.parentNode,n):t.nodeType===1&&Im(t,n),_u(t)):Im(wn,n.stateNode));break;case 4:s=wn,r=rr,wn=n.stateNode.containerInfo,rr=!0,ki(t,e,n),wn=s,rr=r;break;case 0:case 11:case 14:case 15:if(!Pn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&jx(n,e,o),r=r.next}while(r!==s)}ki(t,e,n);break;case 1:if(!Pn&&(fl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Qt(n,e,a)}ki(t,e,n);break;case 21:ki(t,e,n);break;case 22:n.mode&1?(Pn=(s=Pn)||n.memoizedState!==null,ki(t,e,n),Pn=s):ki(t,e,n);break;default:ki(t,e,n)}}function uw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new DA),e.forEach(function(s){var r=qA.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Js(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:wn=a.stateNode,rr=!1;break e;case 3:wn=a.stateNode.containerInfo,rr=!0;break e;case 4:wn=a.stateNode.containerInfo,rr=!0;break e}a=a.return}if(wn===null)throw Error(ue(160));tC(i,o,r),wn=null,rr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Qt(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)nC(e,t),e=e.sibling}function nC(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Js(e,t),vr(t),s&4){try{lu(3,t,t.return),Ip(3,t)}catch(x){Qt(t,t.return,x)}try{lu(5,t,t.return)}catch(x){Qt(t,t.return,x)}}break;case 1:Js(e,t),vr(t),s&512&&n!==null&&fl(n,n.return);break;case 5:if(Js(e,t),vr(t),s&512&&n!==null&&fl(n,n.return),t.flags&32){var r=t.stateNode;try{vu(r,"")}catch(x){Qt(t,t.return,x)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&S1(r,i),Jg(a,o);var u=Jg(a,i);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?T1(r,h):d==="dangerouslySetInnerHTML"?N1(r,h):d==="children"?vu(r,h):Yy(r,d,h,u)}switch(a){case"input":Kg(r,i);break;case"textarea":j1(r,i);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?yl(r,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?yl(r,!!i.multiple,i.defaultValue,!0):yl(r,!!i.multiple,i.multiple?[]:"",!1))}r[Eu]=i}catch(x){Qt(t,t.return,x)}}break;case 6:if(Js(e,t),vr(t),s&4){if(t.stateNode===null)throw Error(ue(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(x){Qt(t,t.return,x)}}break;case 3:if(Js(e,t),vr(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{_u(e.containerInfo)}catch(x){Qt(t,t.return,x)}break;case 4:Js(e,t),vr(t);break;case 13:Js(e,t),vr(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Ev=Jt())),s&4&&uw(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Pn=(u=Pn)||d,Js(e,t),Pn=u):Js(e,t),vr(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(je=t,d=t.child;d!==null;){for(h=je=d;je!==null;){switch(f=je,p=f.child,f.tag){case 0:case 11:case 14:case 15:lu(4,f,f.return);break;case 1:fl(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){Qt(s,n,x)}}break;case 5:fl(f,f.return);break;case 22:if(f.memoizedState!==null){hw(h);continue}}p!==null?(p.return=f,je=p):hw(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=E1("display",o))}catch(x){Qt(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Qt(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Js(e,t),vr(t),s&4&&uw(t);break;case 21:break;default:Js(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(eC(n)){var s=n;break e}n=n.return}throw Error(ue(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(vu(r,""),s.flags&=-33);var i=cw(t);Ex(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=cw(t);Nx(t,a,o);break;default:throw Error(ue(161))}}catch(l){Qt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function $A(t,e,n){je=t,sC(t)}function sC(t,e,n){for(var s=(t.mode&1)!==0;je!==null;){var r=je,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||dh;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Pn;a=dh;var u=Pn;if(dh=o,(Pn=l)&&!u)for(je=r;je!==null;)o=je,l=o.child,o.tag===22&&o.memoizedState!==null?fw(r):l!==null?(l.return=o,je=l):fw(r);for(;i!==null;)je=i,sC(i),i=i.sibling;je=r,dh=a,Pn=u}dw(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,je=i):dw(t)}}function dw(t){for(;je!==null;){var e=je;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Pn||Ip(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Pn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:er(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Yb(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Yb(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&_u(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}Pn||e.flags&512&&Cx(e)}catch(f){Qt(e,e.return,f)}}if(e===t){je=null;break}if(n=e.sibling,n!==null){n.return=e.return,je=n;break}je=e.return}}function hw(t){for(;je!==null;){var e=je;if(e===t){je=null;break}var n=e.sibling;if(n!==null){n.return=e.return,je=n;break}je=e.return}}function fw(t){for(;je!==null;){var e=je;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ip(4,e)}catch(l){Qt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Qt(e,r,l)}}var i=e.return;try{Cx(e)}catch(l){Qt(e,i,l)}break;case 5:var o=e.return;try{Cx(e)}catch(l){Qt(e,o,l)}}}catch(l){Qt(e,e.return,l)}if(e===t){je=null;break}var a=e.sibling;if(a!==null){a.return=e.return,je=a;break}je=e.return}}var FA=Math.ceil,qf=vi.ReactCurrentDispatcher,Cv=vi.ReactCurrentOwner,Ws=vi.ReactCurrentBatchConfig,st=0,yn=null,tn=null,_n=0,ys=0,pl=vo(0),dn=0,Iu=null,ma=0,Mp=0,Nv=0,cu=null,es=null,Ev=0,tc=1/0,Qr=null,Kf=!1,Tx=null,no=null,hh=!1,Vi=null,Gf=0,uu=0,Px=null,cf=-1,uf=0;function Bn(){return st&6?Jt():cf!==-1?cf:cf=Jt()}function so(t){return t.mode&1?st&2&&_n!==0?_n&-_n:kA.transition!==null?(uf===0&&(uf=B1()),uf):(t=mt,t!==0||(t=window.event,t=t===void 0?16:G1(t.type)),t):1}function lr(t,e,n,s){if(50<uu)throw uu=0,Px=null,Error(ue(185));yd(t,n,s),(!(st&2)||t!==yn)&&(t===yn&&(!(st&2)&&(Mp|=n),dn===4&&Ri(t,_n)),ls(t,s),n===1&&st===0&&!(e.mode&1)&&(tc=Jt()+500,Rp&&bo()))}function ls(t,e){var n=t.callbackNode;kR(t,e);var s=Rf(t,t===yn?_n:0);if(s===0)n!==null&&kb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&kb(n),e===1)t.tag===0?wA(pw.bind(null,t)):fj(pw.bind(null,t)),xA(function(){!(st&6)&&bo()}),n=null;else{switch(U1(s)){case 1:n=ev;break;case 4:n=F1;break;case 16:n=Pf;break;case 536870912:n=z1;break;default:n=Pf}n=dC(n,rC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function rC(t,e){if(cf=-1,uf=0,st&6)throw Error(ue(327));var n=t.callbackNode;if(_l()&&t.callbackNode!==n)return null;var s=Rf(t,t===yn?_n:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Yf(t,s);else{e=s;var r=st;st|=2;var i=oC();(yn!==t||_n!==e)&&(Qr=null,tc=Jt()+500,oa(t,e));do try{UA();break}catch(a){iC(t,a)}while(!0);fv(),qf.current=i,st=r,tn!==null?e=0:(yn=null,_n=0,e=dn)}if(e!==0){if(e===2&&(r=sx(t),r!==0&&(s=r,e=Rx(t,r))),e===1)throw n=Iu,oa(t,0),Ri(t,s),ls(t,Jt()),n;if(e===6)Ri(t,s);else{if(r=t.current.alternate,!(s&30)&&!zA(r)&&(e=Yf(t,s),e===2&&(i=sx(t),i!==0&&(s=i,e=Rx(t,i))),e===1))throw n=Iu,oa(t,0),Ri(t,s),ls(t,Jt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(ue(345));case 2:$o(t,es,Qr);break;case 3:if(Ri(t,s),(s&130023424)===s&&(e=Ev+500-Jt(),10<e)){if(Rf(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Bn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=dx($o.bind(null,t,es,Qr),e);break}$o(t,es,Qr);break;case 4:if(Ri(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-ar(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Jt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*FA(s/1960))-s,10<s){t.timeoutHandle=dx($o.bind(null,t,es,Qr),s);break}$o(t,es,Qr);break;case 5:$o(t,es,Qr);break;default:throw Error(ue(329))}}}return ls(t,Jt()),t.callbackNode===n?rC.bind(null,t):null}function Rx(t,e){var n=cu;return t.current.memoizedState.isDehydrated&&(oa(t,e).flags|=256),t=Yf(t,e),t!==2&&(e=es,es=n,e!==null&&Ax(e)),t}function Ax(t){es===null?es=t:es.push.apply(es,t)}function zA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!ur(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ri(t,e){for(e&=~Nv,e&=~Mp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ar(e),s=1<<n;t[n]=-1,e&=~s}}function pw(t){if(st&6)throw Error(ue(327));_l();var e=Rf(t,0);if(!(e&1))return ls(t,Jt()),null;var n=Yf(t,e);if(t.tag!==0&&n===2){var s=sx(t);s!==0&&(e=s,n=Rx(t,s))}if(n===1)throw n=Iu,oa(t,0),Ri(t,e),ls(t,Jt()),n;if(n===6)throw Error(ue(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$o(t,es,Qr),ls(t,Jt()),null}function Tv(t,e){var n=st;st|=1;try{return t(e)}finally{st=n,st===0&&(tc=Jt()+500,Rp&&bo())}}function ga(t){Vi!==null&&Vi.tag===0&&!(st&6)&&_l();var e=st;st|=1;var n=Ws.transition,s=mt;try{if(Ws.transition=null,mt=1,t)return t()}finally{mt=s,Ws.transition=n,st=e,!(st&6)&&bo()}}function Pv(){ys=pl.current,Pt(pl)}function oa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,gA(n)),tn!==null)for(n=tn.return;n!==null;){var s=n;switch(uv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Df();break;case 3:Zl(),Pt(os),Pt(In),vv();break;case 5:yv(s);break;case 4:Zl();break;case 13:Pt(Ut);break;case 19:Pt(Ut);break;case 10:pv(s.type._context);break;case 22:case 23:Pv()}n=n.return}if(yn=t,tn=t=ro(t.current,null),_n=ys=e,dn=0,Iu=null,Nv=Mp=ma=0,es=cu=null,Vo!==null){for(e=0;e<Vo.length;e++)if(n=Vo[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Vo=null}return t}function iC(t,e){do{var n=tn;try{if(fv(),of.current=Vf,Wf){for(var s=Vt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Wf=!1}if(pa=0,gn=cn=Vt=null,au=!1,Ru=0,Cv.current=null,n===null||n.return===null){dn=1,Iu=e,tn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=_n,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=tw(o);if(p!==null){p.flags&=-257,nw(p,o,a,i,e),p.mode&1&&ew(i,u,e),e=p,l=u;var b=e.updateQueue;if(b===null){var x=new Set;x.add(l),e.updateQueue=x}else b.add(l);break e}else{if(!(e&1)){ew(i,u,e),Rv();break e}l=Error(ue(426))}}else if(Dt&&a.mode&1){var y=tw(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),nw(y,o,a,i,e),dv(ec(l,a));break e}}i=l=ec(l,a),dn!==4&&(dn=2),cu===null?cu=[i]:cu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=Uj(i,l,e);Gb(i,g);break e;case 1:a=l;var m=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(no===null||!no.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=Hj(i,a,e);Gb(i,k);break e}}i=i.return}while(i!==null)}lC(n)}catch(_){e=_,tn===n&&n!==null&&(tn=n=n.return);continue}break}while(!0)}function oC(){var t=qf.current;return qf.current=Vf,t===null?Vf:t}function Rv(){(dn===0||dn===3||dn===2)&&(dn=4),yn===null||!(ma&268435455)&&!(Mp&268435455)||Ri(yn,_n)}function Yf(t,e){var n=st;st|=2;var s=oC();(yn!==t||_n!==e)&&(Qr=null,oa(t,e));do try{BA();break}catch(r){iC(t,r)}while(!0);if(fv(),st=n,qf.current=s,tn!==null)throw Error(ue(261));return yn=null,_n=0,dn}function BA(){for(;tn!==null;)aC(tn)}function UA(){for(;tn!==null&&!fR();)aC(tn)}function aC(t){var e=uC(t.alternate,t,ys);t.memoizedProps=t.pendingProps,e===null?lC(t):tn=e,Cv.current=null}function lC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=MA(n,e),n!==null){n.flags&=32767,tn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{dn=6,tn=null;return}}else if(n=IA(n,e,ys),n!==null){tn=n;return}if(e=e.sibling,e!==null){tn=e;return}tn=e=t}while(e!==null);dn===0&&(dn=5)}function $o(t,e,n){var s=mt,r=Ws.transition;try{Ws.transition=null,mt=1,HA(t,e,n,s)}finally{Ws.transition=r,mt=s}return null}function HA(t,e,n,s){do _l();while(Vi!==null);if(st&6)throw Error(ue(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ue(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(_R(t,i),t===yn&&(tn=yn=null,_n=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hh||(hh=!0,dC(Pf,function(){return _l(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ws.transition,Ws.transition=null;var o=mt;mt=1;var a=st;st|=4,Cv.current=null,LA(t,n),nC(n,t),cA(cx),Af=!!lx,cx=lx=null,t.current=n,$A(n),pR(),st=a,mt=o,Ws.transition=i}else t.current=n;if(hh&&(hh=!1,Vi=t,Gf=r),i=t.pendingLanes,i===0&&(no=null),xR(n.stateNode),ls(t,Jt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Kf)throw Kf=!1,t=Tx,Tx=null,t;return Gf&1&&t.tag!==0&&_l(),i=t.pendingLanes,i&1?t===Px?uu++:(uu=0,Px=t):uu=0,bo(),null}function _l(){if(Vi!==null){var t=U1(Gf),e=Ws.transition,n=mt;try{if(Ws.transition=null,mt=16>t?16:t,Vi===null)var s=!1;else{if(t=Vi,Vi=null,Gf=0,st&6)throw Error(ue(331));var r=st;for(st|=4,je=t.current;je!==null;){var i=je,o=i.child;if(je.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(je=u;je!==null;){var d=je;switch(d.tag){case 0:case 11:case 15:lu(8,d,i)}var h=d.child;if(h!==null)h.return=d,je=h;else for(;je!==null;){d=je;var f=d.sibling,p=d.return;if(Zj(d),d===u){je=null;break}if(f!==null){f.return=p,je=f;break}je=p}}}var b=i.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}je=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,je=o;else e:for(;je!==null;){if(i=je,i.flags&2048)switch(i.tag){case 0:case 11:case 15:lu(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,je=g;break e}je=i.return}}var m=t.current;for(je=m;je!==null;){o=je;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,je=w;else e:for(o=m;je!==null;){if(a=je,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ip(9,a)}}catch(_){Qt(a,a.return,_)}if(a===o){je=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,je=k;break e}je=a.return}}if(st=r,bo(),Dr&&typeof Dr.onPostCommitFiberRoot=="function")try{Dr.onPostCommitFiberRoot(Cp,t)}catch{}s=!0}return s}finally{mt=n,Ws.transition=e}}return!1}function mw(t,e,n){e=ec(n,e),e=Uj(t,e,1),t=to(t,e,1),e=Bn(),t!==null&&(yd(t,1,e),ls(t,e))}function Qt(t,e,n){if(t.tag===3)mw(t,t,n);else for(;e!==null;){if(e.tag===3){mw(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(no===null||!no.has(s))){t=ec(n,t),t=Hj(e,t,1),e=to(e,t,1),t=Bn(),e!==null&&(yd(e,1,t),ls(e,t));break}}e=e.return}}function WA(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Bn(),t.pingedLanes|=t.suspendedLanes&n,yn===t&&(_n&n)===n&&(dn===4||dn===3&&(_n&130023424)===_n&&500>Jt()-Ev?oa(t,0):Nv|=n),ls(t,e)}function cC(t,e){e===0&&(t.mode&1?(e=nh,nh<<=1,!(nh&130023424)&&(nh=4194304)):e=1);var n=Bn();t=fi(t,e),t!==null&&(yd(t,e,n),ls(t,n))}function VA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cC(t,n)}function qA(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ue(314))}s!==null&&s.delete(e),cC(t,n)}var uC;uC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||os.current)ns=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ns=!1,OA(t,e,n);ns=!!(t.flags&131072)}else ns=!1,Dt&&e.flags&1048576&&pj(e,Ff,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;lf(t,e),t=e.pendingProps;var r=Ql(e,In.current);kl(e,n),r=wv(null,e,s,t,r,n);var i=kv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,as(s)?(i=!0,Lf(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,gv(e),r.updater=Op,e.stateNode=r,r._reactInternals=e,yx(e,s,t,n),e=wx(null,e,s,!0,i,n)):(e.tag=0,Dt&&i&&cv(e),zn(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(lf(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=GA(s),t=er(s,t),r){case 0:e=bx(null,e,s,t,n);break e;case 1:e=iw(null,e,s,t,n);break e;case 11:e=sw(null,e,s,t,n);break e;case 14:e=rw(null,e,s,er(s.type,t),n);break e}throw Error(ue(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:er(s,r),bx(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:er(s,r),iw(t,e,s,r,n);case 3:e:{if(Kj(e),t===null)throw Error(ue(387));s=e.pendingProps,i=e.memoizedState,r=i.element,bj(t,e),Uf(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=ec(Error(ue(423)),e),e=ow(t,e,s,n,r);break e}else if(s!==r){r=ec(Error(ue(424)),e),e=ow(t,e,s,n,r);break e}else for(_s=eo(e.stateNode.containerInfo.firstChild),Ss=e,Dt=!0,or=null,n=yj(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xl(),s===r){e=pi(t,e,n);break e}zn(t,e,s,n)}e=e.child}return e;case 5:return wj(e),t===null&&mx(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,ux(s,r)?o=null:i!==null&&ux(s,i)&&(e.flags|=32),qj(t,e),zn(t,e,o,n),e.child;case 6:return t===null&&mx(e),null;case 13:return Gj(t,e,n);case 4:return xv(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Jl(e,null,s,n):zn(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:er(s,r),sw(t,e,s,r,n);case 7:return zn(t,e,e.pendingProps,n),e.child;case 8:return zn(t,e,e.pendingProps.children,n),e.child;case 12:return zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,_t(zf,s._currentValue),s._currentValue=o,i!==null)if(ur(i.value,o)){if(i.children===r.children&&!os.current){e=pi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=li(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),gx(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ue(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),gx(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}zn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,kl(e,n),r=qs(r),s=s(r),e.flags|=1,zn(t,e,s,n),e.child;case 14:return s=e.type,r=er(s,e.pendingProps),r=er(s.type,r),rw(t,e,s,r,n);case 15:return Wj(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:er(s,r),lf(t,e),e.tag=1,as(s)?(t=!0,Lf(e)):t=!1,kl(e,n),Bj(e,s,r),yx(e,s,r,n),wx(null,e,s,!0,t,n);case 19:return Yj(t,e,n);case 22:return Vj(t,e,n)}throw Error(ue(156,e.tag))};function dC(t,e){return $1(t,e)}function KA(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bs(t,e,n,s){return new KA(t,e,n,s)}function Av(t){return t=t.prototype,!(!t||!t.isReactComponent)}function GA(t){if(typeof t=="function")return Av(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xy)return 11;if(t===Jy)return 14}return 2}function ro(t,e){var n=t.alternate;return n===null?(n=Bs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function df(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")Av(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case rl:return aa(n.children,r,i,e);case Qy:o=8,r|=8;break;case Ug:return t=Bs(12,n,e,r|2),t.elementType=Ug,t.lanes=i,t;case Hg:return t=Bs(13,n,e,r),t.elementType=Hg,t.lanes=i,t;case Wg:return t=Bs(19,n,e,r),t.elementType=Wg,t.lanes=i,t;case w1:return Dp(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case v1:o=10;break e;case b1:o=9;break e;case Xy:o=11;break e;case Jy:o=14;break e;case Ni:o=16,s=null;break e}throw Error(ue(130,t==null?t:typeof t,""))}return e=Bs(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function aa(t,e,n,s){return t=Bs(7,t,s,e),t.lanes=n,t}function Dp(t,e,n,s){return t=Bs(22,t,s,e),t.elementType=w1,t.lanes=n,t.stateNode={isHidden:!1},t}function Um(t,e,n){return t=Bs(6,t,null,e),t.lanes=n,t}function Hm(t,e,n){return e=Bs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YA(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_m(0),this.expirationTimes=_m(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_m(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ov(t,e,n,s,r,i,o,a,l){return t=new YA(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Bs(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gv(i),t}function QA(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sl,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function hC(t){if(!t)return uo;t=t._reactInternals;e:{if(ja(t)!==t||t.tag!==1)throw Error(ue(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(as(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ue(171))}if(t.tag===1){var n=t.type;if(as(n))return hj(t,n,e)}return e}function fC(t,e,n,s,r,i,o,a,l){return t=Ov(n,s,!0,t,r,i,o,a,l),t.context=hC(null),n=t.current,s=Bn(),r=so(n),i=li(s,r),i.callback=e??null,to(n,i,r),t.current.lanes=r,yd(t,r,s),ls(t,s),t}function Lp(t,e,n,s){var r=e.current,i=Bn(),o=so(r);return n=hC(n),e.context===null?e.context=n:e.pendingContext=n,e=li(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=to(r,e,o),t!==null&&(lr(t,r,o,i),rf(t,r,o)),o}function Qf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Iv(t,e){gw(t,e),(t=t.alternate)&&gw(t,e)}function XA(){return null}var pC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Mv(t){this._internalRoot=t}$p.prototype.render=Mv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ue(409));Lp(t,e,null,null)};$p.prototype.unmount=Mv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ga(function(){Lp(null,t,null,null)}),e[hi]=null}};function $p(t){this._internalRoot=t}$p.prototype.unstable_scheduleHydration=function(t){if(t){var e=V1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Pi.length&&e!==0&&e<Pi[n].priority;n++);Pi.splice(n,0,t),n===0&&K1(t)}};function Dv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Fp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xw(){}function JA(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=Qf(o);i.call(u)}}var o=fC(e,s,t,0,null,!1,!1,"",xw);return t._reactRootContainer=o,t[hi]=o.current,Cu(t.nodeType===8?t.parentNode:t),ga(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var u=Qf(l);a.call(u)}}var l=Ov(t,0,!1,null,null,!1,!1,"",xw);return t._reactRootContainer=l,t[hi]=l.current,Cu(t.nodeType===8?t.parentNode:t),ga(function(){Lp(e,l,n,s)}),l}function zp(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=Qf(o);a.call(l)}}Lp(e,o,t,r)}else o=JA(n,e,t,r,s);return Qf(o)}H1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qc(e.pendingLanes);n!==0&&(tv(e,n|1),ls(e,Jt()),!(st&6)&&(tc=Jt()+500,bo()))}break;case 13:ga(function(){var s=fi(t,1);if(s!==null){var r=Bn();lr(s,t,1,r)}}),Iv(t,1)}};nv=function(t){if(t.tag===13){var e=fi(t,134217728);if(e!==null){var n=Bn();lr(e,t,134217728,n)}Iv(t,134217728)}};W1=function(t){if(t.tag===13){var e=so(t),n=fi(t,e);if(n!==null){var s=Bn();lr(n,t,e,s)}Iv(t,e)}};V1=function(){return mt};q1=function(t,e){var n=mt;try{return mt=t,e()}finally{mt=n}};ex=function(t,e,n){switch(e){case"input":if(Kg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Pp(s);if(!r)throw Error(ue(90));_1(s),Kg(s,r)}}}break;case"textarea":j1(t,n);break;case"select":e=n.value,e!=null&&yl(t,!!n.multiple,e,!1)}};A1=Tv;O1=ga;var ZA={usingClientEntryPoint:!1,Events:[bd,ll,Pp,P1,R1,Tv]},Oc={findFiberByHostInstance:Wo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eO={bundleType:Oc.bundleType,version:Oc.version,rendererPackageName:Oc.rendererPackageName,rendererConfig:Oc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=D1(t),t===null?null:t.stateNode},findFiberByHostInstance:Oc.findFiberByHostInstance||XA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fh.isDisabled&&fh.supportsFiber)try{Cp=fh.inject(eO),Dr=fh}catch{}}Ts.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZA;Ts.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dv(e))throw Error(ue(200));return QA(t,e,null,n)};Ts.createRoot=function(t,e){if(!Dv(t))throw Error(ue(299));var n=!1,s="",r=pC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Ov(t,1,!1,null,null,n,!1,s,r),t[hi]=e.current,Cu(t.nodeType===8?t.parentNode:t),new Mv(e)};Ts.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ue(188)):(t=Object.keys(t).join(","),Error(ue(268,t)));return t=D1(e),t=t===null?null:t.stateNode,t};Ts.flushSync=function(t){return ga(t)};Ts.hydrate=function(t,e,n){if(!Fp(e))throw Error(ue(200));return zp(null,t,e,!0,n)};Ts.hydrateRoot=function(t,e,n){if(!Dv(t))throw Error(ue(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=pC;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=fC(e,null,t,1,n??null,r,!1,i,o),t[hi]=e.current,Cu(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new $p(e)};Ts.render=function(t,e,n){if(!Fp(e))throw Error(ue(200));return zp(null,t,e,!1,n)};Ts.unmountComponentAtNode=function(t){if(!Fp(t))throw Error(ue(40));return t._reactRootContainer?(ga(function(){zp(null,null,t,!1,function(){t._reactRootContainer=null,t[hi]=null})}),!0):!1};Ts.unstable_batchedUpdates=Tv;Ts.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Fp(n))throw Error(ue(200));if(t==null||t._reactInternals===void 0)throw Error(ue(38));return zp(t,e,n,!1,s)};Ts.version="18.3.1-next-f1338f8080-20240426";function mC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mC)}catch(t){console.error(t)}}mC(),m1.exports=Ts;var kd=m1.exports;const gC=s1(kd);var yw=kd;zg.createRoot=yw.createRoot,zg.hydrateRoot=yw.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mu(){return Mu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Mu.apply(this,arguments)}var qi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(qi||(qi={}));const vw="popstate";function tO(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return Ox("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:xC(r)}return sO(e,n,null,t)}function rn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Lv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nO(){return Math.random().toString(36).substr(2,8)}function bw(t,e){return{usr:t.state,key:t.key,idx:e}}function Ox(t,e,n,s){return n===void 0&&(n=null),Mu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ac(e):e,{state:n,key:e&&e.key||s||nO()})}function xC(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function ac(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function sO(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=qi.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Mu({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=qi.Pop;let y=d(),g=y==null?null:y-u;u=y,l&&l({action:a,location:x.location,delta:g})}function f(y,g){a=qi.Push;let m=Ox(x.location,y,g);u=d()+1;let w=bw(m,u),k=x.createHref(m);try{o.pushState(w,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;r.location.assign(k)}i&&l&&l({action:a,location:x.location,delta:1})}function p(y,g){a=qi.Replace;let m=Ox(x.location,y,g);u=d();let w=bw(m,u),k=x.createHref(m);o.replaceState(w,"",k),i&&l&&l({action:a,location:x.location,delta:0})}function b(y){let g=r.location.origin!=="null"?r.location.origin:r.location.href,m=typeof y=="string"?y:xC(y);return m=m.replace(/ $/,"%20"),rn(g,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,g)}let x={get action(){return a},get location(){return t(r,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(vw,h),l=y,()=>{r.removeEventListener(vw,h),l=null}},createHref(y){return e(r,y)},createURL:b,encodeLocation(y){let g=b(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:p,go(y){return o.go(y)}};return x}var ww;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ww||(ww={}));function rO(t,e,n){return n===void 0&&(n="/"),iO(t,e,n)}function iO(t,e,n,s){let r=typeof e=="string"?ac(e):e,i=bC(r.pathname||"/",n);if(i==null)return null;let o=yC(t);oO(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=yO(i);a=mO(o[l],u)}return a}function yC(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(rn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=la([s,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(rn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),yC(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:fO(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of vC(i.path))r(i,o,l)}),e}function vC(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=vC(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function oO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:pO(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const aO=/^:[\w-]+$/,lO=3,cO=2,uO=1,dO=10,hO=-2,kw=t=>t==="*";function fO(t,e){let n=t.split("/"),s=n.length;return n.some(kw)&&(s+=hO),e&&(s+=cO),n.filter(r=>!kw(r)).reduce((r,i)=>r+(aO.test(i)?lO:i===""?uO:dO),s)}function pO(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function mO(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],u=a===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=gO({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),f=l.route;if(!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:la([i,h.pathname]),pathnameBase:_O(la([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=la([i,h.pathnameBase]))}return o}function gO(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=xO(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let x=a[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const b=a[h];return p&&!b?u[f]=void 0:u[f]=(b||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function xO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Lv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function yO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Lv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function bC(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const vO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bO=t=>vO.test(t);function wO(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?ac(t):t,i;if(n)if(bO(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Lv(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=_w(n.substring(1),"/"):i=_w(n,e)}else i=e;return{pathname:i,search:SO(s),hash:jO(r)}}function _w(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Wm(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function kO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wC(t,e){let n=kO(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function kC(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=ac(t):(r=Mu({},t),rn(!r.pathname||!r.pathname.includes("?"),Wm("?","pathname","search",r)),rn(!r.pathname||!r.pathname.includes("#"),Wm("#","pathname","hash",r)),rn(!r.search||!r.search.includes("#"),Wm("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;r.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=wO(r,a),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const la=t=>t.join("/").replace(/\/\/+/g,"/"),_O=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),SO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,jO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function CO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _C=["post","put","patch","delete"];new Set(_C);const NO=["get",..._C];new Set(NO);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Du(){return Du=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Du.apply(this,arguments)}const $v=v.createContext(null),EO=v.createContext(null),_d=v.createContext(null),Bp=v.createContext(null),wo=v.createContext({outlet:null,matches:[],isDataRoute:!1}),SC=v.createContext(null);function Sd(){return v.useContext(Bp)!=null}function lc(){return Sd()||rn(!1),v.useContext(Bp).location}function jC(t){v.useContext(_d).static||v.useLayoutEffect(t)}function jd(){let{isDataRoute:t}=v.useContext(wo);return t?HO():TO()}function TO(){Sd()||rn(!1);let t=v.useContext($v),{basename:e,future:n,navigator:s}=v.useContext(_d),{matches:r}=v.useContext(wo),{pathname:i}=lc(),o=JSON.stringify(wC(r,n.v7_relativeSplatPath)),a=v.useRef(!1);return jC(()=>{a.current=!0}),v.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){s.go(u);return}let h=kC(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:la([e,h.pathname])),(d.replace?s.replace:s.push)(h,d.state,d)},[e,s,o,i,t])}const PO=v.createContext(null);function RO(t){let e=v.useContext(wo).outlet;return e&&v.createElement(PO.Provider,{value:t},e)}function AO(t,e){return OO(t,e)}function OO(t,e,n,s){Sd()||rn(!1);let{navigator:r}=v.useContext(_d),{matches:i}=v.useContext(wo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=lc(),d;if(e){var h;let y=typeof e=="string"?ac(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||rn(!1),d=y}else d=u;let f=d.pathname||"/",p=f;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let b=rO(t,{pathname:p}),x=$O(b&&b.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:la([l,r.encodeLocation?r.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:la([l,r.encodeLocation?r.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,s);return e&&x?v.createElement(Bp.Provider,{value:{location:Du({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:qi.Pop}},x):x}function IO(){let t=UO(),e=CO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),n?v.createElement("pre",{style:r},n):null,null)}const MO=v.createElement(IO,null);class DO extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?v.createElement(wo.Provider,{value:this.props.routeContext},v.createElement(SC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LO(t){let{routeContext:e,match:n,children:s}=t,r=v.useContext($v);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),v.createElement(wo.Provider,{value:e},s)}function $O(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let d=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);d>=0||rn(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=n,b=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||b){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let p,b=!1,x=null,y=null;n&&(p=a&&h.route.id?a[h.route.id]:void 0,x=h.route.errorElement||MO,l&&(u<0&&f===0?(WO("route-fallback"),b=!0,y=null):u===f&&(b=!0,y=h.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),m=()=>{let w;return p?w=x:b?w=y:h.route.Component?w=v.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=d,v.createElement(LO,{match:h,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:w})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?v.createElement(DO,{location:n.location,revalidation:n.revalidation,component:x,error:p,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var CC=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(CC||{}),NC=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(NC||{});function FO(t){let e=v.useContext($v);return e||rn(!1),e}function zO(t){let e=v.useContext(EO);return e||rn(!1),e}function BO(t){let e=v.useContext(wo);return e||rn(!1),e}function EC(t){let e=BO(),n=e.matches[e.matches.length-1];return n.route.id||rn(!1),n.route.id}function UO(){var t;let e=v.useContext(SC),n=zO(),s=EC();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function HO(){let{router:t}=FO(CC.UseNavigateStable),e=EC(NC.UseNavigateStable),n=v.useRef(!1);return jC(()=>{n.current=!0}),v.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Du({fromRouteId:e},i)))},[t,e])}const Sw={};function WO(t,e,n){Sw[t]||(Sw[t]=!0)}function VO(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function hf(t){let{to:e,replace:n,state:s,relative:r}=t;Sd()||rn(!1);let{future:i,static:o}=v.useContext(_d),{matches:a}=v.useContext(wo),{pathname:l}=lc(),u=jd(),d=kC(e,wC(a,i.v7_relativeSplatPath),l,r==="path"),h=JSON.stringify(d);return v.useEffect(()=>u(JSON.parse(h),{replace:n,state:s,relative:r}),[u,h,r,n,s]),null}function qO(t){return RO(t.context)}function Dn(t){rn(!1)}function KO(t){let{basename:e="/",children:n=null,location:s,navigationType:r=qi.Pop,navigator:i,static:o=!1,future:a}=t;Sd()&&rn(!1);let l=e.replace(/^\/*/,"/"),u=v.useMemo(()=>({basename:l,navigator:i,static:o,future:Du({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=ac(s));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:b="default"}=s,x=v.useMemo(()=>{let y=bC(d,l);return y==null?null:{location:{pathname:y,search:h,hash:f,state:p,key:b},navigationType:r}},[l,d,h,f,p,b,r]);return x==null?null:v.createElement(_d.Provider,{value:u},v.createElement(Bp.Provider,{children:n,value:x}))}function GO(t){let{children:e,location:n}=t;return AO(Ix(e),n)}new Promise(()=>{});function Ix(t,e){e===void 0&&(e=[]);let n=[];return v.Children.forEach(t,(s,r)=>{if(!v.isValidElement(s))return;let i=[...e,r];if(s.type===v.Fragment){n.push.apply(n,Ix(s.props.children,i));return}s.type!==Dn&&rn(!1),!s.props.index||!s.props.children||rn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Ix(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const YO="6";try{window.__reactRouterVersion=YO}catch{}const QO="startTransition",jw=jp[QO];function XO(t){let{basename:e,children:n,future:s,window:r}=t,i=v.useRef();i.current==null&&(i.current=tO({window:r,v5Compat:!0}));let o=i.current,[a,l]=v.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},d=v.useCallback(h=>{u&&jw?jw(()=>l(h)):l(h)},[l,u]);return v.useLayoutEffect(()=>o.listen(d),[o,d]),v.useEffect(()=>VO(s),[s]),v.createElement(KO,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}var Cw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Cw||(Cw={}));var Nw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Nw||(Nw={}));var Xf=["light","dark"],Fv="(prefers-color-scheme: dark)",JO=typeof window>"u",zv=v.createContext(void 0),ZO={setTheme:t=>{},themes:[]},eI=()=>{var t;return(t=v.useContext(zv))!=null?t:ZO},tI=t=>v.useContext(zv)?t.children:v.createElement(sI,{...t}),nI=["light","dark"],sI=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:s=!0,storageKey:r="theme",themes:i=nI,defaultTheme:o=n?"system":"light",attribute:a="data-theme",value:l,children:u,nonce:d})=>{let[h,f]=v.useState(()=>Ew(r,o)),[p,b]=v.useState(()=>Ew(r)),x=l?Object.values(l):i,y=v.useCallback(k=>{let _=k;if(!_)return;k==="system"&&n&&(_=Tw());let C=l?l[_]:_,S=e?iI():null,j=document.documentElement;if(a==="class"?(j.classList.remove(...x),C&&j.classList.add(C)):C?j.setAttribute(a,C):j.removeAttribute(a),s){let N=Xf.includes(o)?o:null,R=Xf.includes(_)?_:N;j.style.colorScheme=R}S==null||S()},[]),g=v.useCallback(k=>{let _=typeof k=="function"?k(k):k;f(_);try{localStorage.setItem(r,_)}catch{}},[t]),m=v.useCallback(k=>{let _=Tw(k);b(_),h==="system"&&n&&!t&&y("system")},[h,t]);v.useEffect(()=>{let k=window.matchMedia(Fv);return k.addListener(m),m(k),()=>k.removeListener(m)},[m]),v.useEffect(()=>{let k=_=>{if(_.key!==r)return;let C=_.newValue||o;g(C)};return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[g]),v.useEffect(()=>{y(t??h)},[t,h]);let w=v.useMemo(()=>({theme:h,setTheme:g,forcedTheme:t,resolvedTheme:h==="system"?p:h,themes:n?[...i,"system"]:i,systemTheme:n?p:void 0}),[h,g,t,p,n,i]);return v.createElement(zv.Provider,{value:w},v.createElement(rI,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:s,storageKey:r,themes:i,defaultTheme:o,attribute:a,value:l,children:u,attrs:x,nonce:d}),u)},rI=v.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:s,enableColorScheme:r,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let u=i==="system",d=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(b=>`'${b}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=r?Xf.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(b,x=!1,y=!0)=>{let g=o?o[b]:b,m=x?b+"|| ''":`'${g}'`,w="";return r&&y&&!x&&Xf.includes(b)&&(w+=`d.style.colorScheme = '${b}';`),n==="class"?x||g?w+=`c.add(${m})`:w+="null":g&&(w+=`d[s](n,${m})`),w},p=t?`!function(){${d}${f(t)}}()`:s?`!function(){try{${d}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${Fv}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return v.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),Ew=(t,e)=>{if(JO)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},iI=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},Tw=t=>(t||(t=window.matchMedia(Fv)),t.matches?"dark":"light"),Ca=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},oI={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Ii,Uy,VS,aI=(VS=class{constructor(){Se(this,Ii,oI);Se(this,Uy,!1)}setTimeoutProvider(t){fe(this,Ii,t)}setTimeout(t,e){return I(this,Ii).setTimeout(t,e)}clearTimeout(t){I(this,Ii).clearTimeout(t)}setInterval(t,e){return I(this,Ii).setInterval(t,e)}clearInterval(t){I(this,Ii).clearInterval(t)}},Ii=new WeakMap,Uy=new WeakMap,VS),Ko=new aI;function lI(t){setTimeout(t,0)}var xa=typeof window>"u"||"Deno"in globalThis;function Tn(){}function cI(t,e){return typeof t=="function"?t(e):t}function Mx(t){return typeof t=="number"&&t>=0&&t!==1/0}function TC(t,e){return Math.max(t+(e||0)-Date.now(),0)}function io(t,e){return typeof t=="function"?t(e):t}function $s(t,e){return typeof t=="function"?t(e):t}function Pw(t,e){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:o,stale:a}=t;if(o){if(s){if(e.queryHash!==Bv(o,e.options))return!1}else if(!Lu(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||r&&r!==e.state.fetchStatus||i&&!i(e))}function Rw(t,e){const{exact:n,status:s,predicate:r,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(ya(e.options.mutationKey)!==ya(i))return!1}else if(!Lu(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||r&&!r(e))}function Bv(t,e){return((e==null?void 0:e.queryKeyHashFn)||ya)(t)}function ya(t){return JSON.stringify(t,(e,n)=>Dx(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Lu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Lu(t[n],e[n])):!1}var uI=Object.prototype.hasOwnProperty;function Uv(t,e){if(t===e)return t;const n=Aw(t)&&Aw(e);if(!n&&!(Dx(t)&&Dx(e)))return e;const r=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let l=0;for(let u=0;u<o;u++){const d=n?u:i[u],h=t[d],f=e[d];if(h===f){a[d]=h,(n?u<r:uI.call(t,d))&&l++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){a[d]=f;continue}const p=Uv(h,f);a[d]=p,p===h&&l++}return r===o&&l===r?t:a}function $u(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Aw(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Dx(t){if(!Ow(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Ow(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Ow(t){return Object.prototype.toString.call(t)==="[object Object]"}function dI(t){return new Promise(e=>{Ko.setTimeout(e,t)})}function Lx(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Uv(t,e):e}function hI(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function fI(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var Hv=Symbol();function PC(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Hv?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function RC(t,e){return typeof t=="function"?t(...e):!!t}var Xo,Mi,Il,qS,pI=(qS=class extends Ca{constructor(){super();Se(this,Xo);Se(this,Mi);Se(this,Il);fe(this,Il,e=>{if(!xa&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){I(this,Mi)||this.setEventListener(I(this,Il))}onUnsubscribe(){var e;this.hasListeners()||((e=I(this,Mi))==null||e.call(this),fe(this,Mi,void 0))}setEventListener(e){var n;fe(this,Il,e),(n=I(this,Mi))==null||n.call(this),fe(this,Mi,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){I(this,Xo)!==e&&(fe(this,Xo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof I(this,Xo)=="boolean"?I(this,Xo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Xo=new WeakMap,Mi=new WeakMap,Il=new WeakMap,qS),Wv=new pI;function $x(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),t(r)},n.reject=r=>{s({status:"rejected",reason:r}),e(r)},n}var mI=lI;function gI(){let t=[],e=0,n=a=>{a()},s=a=>{a()},r=mI;const i=a=>{e?t.push(a):r(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&r(()=>{s(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{r=a}}}var Xt=gI(),Ml,Di,Dl,KS,xI=(KS=class extends Ca{constructor(){super();Se(this,Ml,!0);Se(this,Di);Se(this,Dl);fe(this,Dl,e=>{if(!xa&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){I(this,Di)||this.setEventListener(I(this,Dl))}onUnsubscribe(){var e;this.hasListeners()||((e=I(this,Di))==null||e.call(this),fe(this,Di,void 0))}setEventListener(e){var n;fe(this,Dl,e),(n=I(this,Di))==null||n.call(this),fe(this,Di,e(this.setOnline.bind(this)))}setOnline(e){I(this,Ml)!==e&&(fe(this,Ml,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return I(this,Ml)}},Ml=new WeakMap,Di=new WeakMap,Dl=new WeakMap,KS),Jf=new xI;function yI(t){return Math.min(1e3*2**t,3e4)}function AC(t){return(t??"online")==="online"?Jf.isOnline():!0}var Fx=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function OC(t){let e=!1,n=0,s;const r=$x(),i=()=>r.status!=="pending",o=x=>{var y;if(!i()){const g=new Fx(x);f(g),(y=t.onCancel)==null||y.call(t,g)}},a=()=>{e=!0},l=()=>{e=!1},u=()=>Wv.isFocused()&&(t.networkMode==="always"||Jf.isOnline())&&t.canRun(),d=()=>AC(t.networkMode)&&t.canRun(),h=x=>{i()||(s==null||s(),r.resolve(x))},f=x=>{i()||(s==null||s(),r.reject(x))},p=()=>new Promise(x=>{var y;s=g=>{(i()||u())&&x(g)},(y=t.onPause)==null||y.call(t)}).then(()=>{var x;s=void 0,i()||(x=t.onContinue)==null||x.call(t)}),b=()=>{if(i())return;let x;const y=n===0?t.initialPromise:void 0;try{x=y??t.fn()}catch(g){x=Promise.reject(g)}Promise.resolve(x).then(h).catch(g=>{var C;if(i())return;const m=t.retry??(xa?0:3),w=t.retryDelay??yI,k=typeof w=="function"?w(n,g):w,_=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,g);if(e||!_){f(g);return}n++,(C=t.onFail)==null||C.call(t,n,g),dI(k).then(()=>u()?void 0:p()).then(()=>{e?f(g):b()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(s==null||s(),r),cancelRetry:a,continueRetry:l,canStart:d,start:()=>(d()?b():p().then(b),r)}}var Jo,GS,IC=(GS=class{constructor(){Se(this,Jo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Mx(this.gcTime)&&fe(this,Jo,Ko.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(xa?1/0:5*60*1e3))}clearGcTimeout(){I(this,Jo)&&(Ko.clearTimeout(I(this,Jo)),fe(this,Jo,void 0))}},Jo=new WeakMap,GS),Zo,Ll,Ds,ea,mn,cd,ta,nr,Kr,YS,vI=(YS=class extends IC{constructor(e){super();Se(this,nr);Se(this,Zo);Se(this,Ll);Se(this,Ds);Se(this,ea);Se(this,mn);Se(this,cd);Se(this,ta);fe(this,ta,!1),fe(this,cd,e.defaultOptions),this.setOptions(e.options),this.observers=[],fe(this,ea,e.client),fe(this,Ds,I(this,ea).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,fe(this,Zo,Mw(this.options)),this.state=e.state??I(this,Zo),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=I(this,mn))==null?void 0:e.promise}setOptions(e){if(this.options={...I(this,cd),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Mw(this.options);n.data!==void 0&&(this.setState(Iw(n.data,n.dataUpdatedAt)),fe(this,Zo,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&I(this,Ds).remove(this)}setData(e,n){const s=Lx(this.state.data,e,this.options);return Fe(this,nr,Kr).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){Fe(this,nr,Kr).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,r;const n=(s=I(this,mn))==null?void 0:s.promise;return(r=I(this,mn))==null||r.cancel(e),n?n.then(Tn).catch(Tn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(I(this,Zo))}isActive(){return this.observers.some(e=>$s(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Hv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>io(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!TC(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=I(this,mn))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=I(this,mn))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),I(this,Ds).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(I(this,mn)&&(I(this,ta)?I(this,mn).cancel({revert:!0}):I(this,mn).cancelRetry()),this.scheduleGc()),I(this,Ds).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Fe(this,nr,Kr).call(this,{type:"invalidate"})}async fetch(e,n){var l,u,d,h,f,p,b,x,y,g,m,w;if(this.state.fetchStatus!=="idle"&&((l=I(this,mn))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(I(this,mn))return I(this,mn).continueRetry(),I(this,mn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const k=this.observers.find(_=>_.options.queryFn);k&&this.setOptions(k.options)}const s=new AbortController,r=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(fe(this,ta,!0),s.signal)})},i=()=>{const k=PC(this.options,n),C=(()=>{const S={client:I(this,ea),queryKey:this.queryKey,meta:this.meta};return r(S),S})();return fe(this,ta,!1),this.options.persister?this.options.persister(k,C,this):k(C)},a=(()=>{const k={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:I(this,ea),state:this.state,fetchFn:i};return r(k),k})();(u=this.options.behavior)==null||u.onFetch(a,this),fe(this,Ll,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=a.fetchOptions)==null?void 0:d.meta))&&Fe(this,nr,Kr).call(this,{type:"fetch",meta:(h=a.fetchOptions)==null?void 0:h.meta}),fe(this,mn,OC({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,onCancel:k=>{k instanceof Fx&&k.revert&&this.setState({...I(this,Ll),fetchStatus:"idle"}),s.abort()},onFail:(k,_)=>{Fe(this,nr,Kr).call(this,{type:"failed",failureCount:k,error:_})},onPause:()=>{Fe(this,nr,Kr).call(this,{type:"pause"})},onContinue:()=>{Fe(this,nr,Kr).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const k=await I(this,mn).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(p=(f=I(this,Ds).config).onSuccess)==null||p.call(f,k,this),(x=(b=I(this,Ds).config).onSettled)==null||x.call(b,k,this.state.error,this),k}catch(k){if(k instanceof Fx){if(k.silent)return I(this,mn).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw Fe(this,nr,Kr).call(this,{type:"error",error:k}),(g=(y=I(this,Ds).config).onError)==null||g.call(y,k,this),(w=(m=I(this,Ds).config).onSettled)==null||w.call(m,this.state.data,k,this),k}finally{this.scheduleGc()}}},Zo=new WeakMap,Ll=new WeakMap,Ds=new WeakMap,ea=new WeakMap,mn=new WeakMap,cd=new WeakMap,ta=new WeakMap,nr=new WeakSet,Kr=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...MC(s.data,this.options),fetchMeta:e.meta??null};case"success":const r={...s,...Iw(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return fe(this,Ll,e.manual?r:void 0),r;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),Xt.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),I(this,Ds).notify({query:this,type:"updated",action:e})})},YS);function MC(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:AC(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Iw(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Mw(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Jn,Ze,ud,Ln,na,$l,ei,Li,dd,Fl,zl,sa,ra,$i,Bl,ht,Gc,zx,Bx,Ux,Hx,Wx,Vx,qx,DC,QS,Vv=(QS=class extends Ca{constructor(e,n){super();Se(this,ht);Se(this,Jn);Se(this,Ze);Se(this,ud);Se(this,Ln);Se(this,na);Se(this,$l);Se(this,ei);Se(this,Li);Se(this,dd);Se(this,Fl);Se(this,zl);Se(this,sa);Se(this,ra);Se(this,$i);Se(this,Bl,new Set);this.options=n,fe(this,Jn,e),fe(this,Li,null),fe(this,ei,$x()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(I(this,Ze).addObserver(this),Dw(I(this,Ze),this.options)?Fe(this,ht,Gc).call(this):this.updateResult(),Fe(this,ht,Hx).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Kx(I(this,Ze),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Kx(I(this,Ze),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Fe(this,ht,Wx).call(this),Fe(this,ht,Vx).call(this),I(this,Ze).removeObserver(this)}setOptions(e){const n=this.options,s=I(this,Ze);if(this.options=I(this,Jn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof $s(this.options.enabled,I(this,Ze))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Fe(this,ht,qx).call(this),I(this,Ze).setOptions(this.options),n._defaulted&&!$u(this.options,n)&&I(this,Jn).getQueryCache().notify({type:"observerOptionsUpdated",query:I(this,Ze),observer:this});const r=this.hasListeners();r&&Lw(I(this,Ze),s,this.options,n)&&Fe(this,ht,Gc).call(this),this.updateResult(),r&&(I(this,Ze)!==s||$s(this.options.enabled,I(this,Ze))!==$s(n.enabled,I(this,Ze))||io(this.options.staleTime,I(this,Ze))!==io(n.staleTime,I(this,Ze)))&&Fe(this,ht,zx).call(this);const i=Fe(this,ht,Bx).call(this);r&&(I(this,Ze)!==s||$s(this.options.enabled,I(this,Ze))!==$s(n.enabled,I(this,Ze))||i!==I(this,$i))&&Fe(this,ht,Ux).call(this,i)}getOptimisticResult(e){const n=I(this,Jn).getQueryCache().build(I(this,Jn),e),s=this.createResult(n,e);return wI(this,s)&&(fe(this,Ln,s),fe(this,$l,this.options),fe(this,na,I(this,Ze).state)),s}getCurrentResult(){return I(this,Ln)}trackResult(e,n){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),n==null||n(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&I(this,ei).status==="pending"&&I(this,ei).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){I(this,Bl).add(e)}getCurrentQuery(){return I(this,Ze)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=I(this,Jn).defaultQueryOptions(e),s=I(this,Jn).getQueryCache().build(I(this,Jn),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return Fe(this,ht,Gc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),I(this,Ln)))}createResult(e,n){var N;const s=I(this,Ze),r=this.options,i=I(this,Ln),o=I(this,na),a=I(this,$l),u=e!==s?e.state:I(this,ud),{state:d}=e;let h={...d},f=!1,p;if(n._optimisticResults){const R=this.hasListeners(),M=!R&&Dw(e,n),O=R&&Lw(e,s,n,r);(M||O)&&(h={...h,...MC(d.data,e.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:b,errorUpdatedAt:x,status:y}=h;p=h.data;let g=!1;if(n.placeholderData!==void 0&&p===void 0&&y==="pending"){let R;i!=null&&i.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData)?(R=i.data,g=!0):R=typeof n.placeholderData=="function"?n.placeholderData((N=I(this,zl))==null?void 0:N.state.data,I(this,zl)):n.placeholderData,R!==void 0&&(y="success",p=Lx(i==null?void 0:i.data,R,n),f=!0)}if(n.select&&p!==void 0&&!g)if(i&&p===(o==null?void 0:o.data)&&n.select===I(this,dd))p=I(this,Fl);else try{fe(this,dd,n.select),p=n.select(p),p=Lx(i==null?void 0:i.data,p,n),fe(this,Fl,p),fe(this,Li,null)}catch(R){fe(this,Li,R)}I(this,Li)&&(b=I(this,Li),p=I(this,Fl),x=Date.now(),y="error");const m=h.fetchStatus==="fetching",w=y==="pending",k=y==="error",_=w&&m,C=p!==void 0,j={status:y,fetchStatus:h.fetchStatus,isPending:w,isSuccess:y==="success",isError:k,isInitialLoading:_,isLoading:_,data:p,dataUpdatedAt:h.dataUpdatedAt,error:b,errorUpdatedAt:x,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:m,isRefetching:m&&!w,isLoadingError:k&&!C,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:k&&C,isStale:qv(e,n),refetch:this.refetch,promise:I(this,ei),isEnabled:$s(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const R=D=>{j.status==="error"?D.reject(j.error):j.data!==void 0&&D.resolve(j.data)},M=()=>{const D=fe(this,ei,j.promise=$x());R(D)},O=I(this,ei);switch(O.status){case"pending":e.queryHash===s.queryHash&&R(O);break;case"fulfilled":(j.status==="error"||j.data!==O.value)&&M();break;case"rejected":(j.status!=="error"||j.error!==O.reason)&&M();break}}return j}updateResult(){const e=I(this,Ln),n=this.createResult(I(this,Ze),this.options);if(fe(this,na,I(this,Ze).state),fe(this,$l,this.options),I(this,na).data!==void 0&&fe(this,zl,I(this,Ze)),$u(n,e))return;fe(this,Ln,n);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!I(this,Bl).size)return!0;const o=new Set(i??I(this,Bl));return this.options.throwOnError&&o.add("error"),Object.keys(I(this,Ln)).some(a=>{const l=a;return I(this,Ln)[l]!==e[l]&&o.has(l)})};Fe(this,ht,DC).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Fe(this,ht,Hx).call(this)}},Jn=new WeakMap,Ze=new WeakMap,ud=new WeakMap,Ln=new WeakMap,na=new WeakMap,$l=new WeakMap,ei=new WeakMap,Li=new WeakMap,dd=new WeakMap,Fl=new WeakMap,zl=new WeakMap,sa=new WeakMap,ra=new WeakMap,$i=new WeakMap,Bl=new WeakMap,ht=new WeakSet,Gc=function(e){Fe(this,ht,qx).call(this);let n=I(this,Ze).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Tn)),n},zx=function(){Fe(this,ht,Wx).call(this);const e=io(this.options.staleTime,I(this,Ze));if(xa||I(this,Ln).isStale||!Mx(e))return;const s=TC(I(this,Ln).dataUpdatedAt,e)+1;fe(this,sa,Ko.setTimeout(()=>{I(this,Ln).isStale||this.updateResult()},s))},Bx=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(I(this,Ze)):this.options.refetchInterval)??!1},Ux=function(e){Fe(this,ht,Vx).call(this),fe(this,$i,e),!(xa||$s(this.options.enabled,I(this,Ze))===!1||!Mx(I(this,$i))||I(this,$i)===0)&&fe(this,ra,Ko.setInterval(()=>{(this.options.refetchIntervalInBackground||Wv.isFocused())&&Fe(this,ht,Gc).call(this)},I(this,$i)))},Hx=function(){Fe(this,ht,zx).call(this),Fe(this,ht,Ux).call(this,Fe(this,ht,Bx).call(this))},Wx=function(){I(this,sa)&&(Ko.clearTimeout(I(this,sa)),fe(this,sa,void 0))},Vx=function(){I(this,ra)&&(Ko.clearInterval(I(this,ra)),fe(this,ra,void 0))},qx=function(){const e=I(this,Jn).getQueryCache().build(I(this,Jn),this.options);if(e===I(this,Ze))return;const n=I(this,Ze);fe(this,Ze,e),fe(this,ud,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},DC=function(e){Xt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(I(this,Ln))}),I(this,Jn).getQueryCache().notify({query:I(this,Ze),type:"observerResultsUpdated"})})},QS);function bI(t,e){return $s(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Dw(t,e){return bI(t,e)||t.state.data!==void 0&&Kx(t,e,e.refetchOnMount)}function Kx(t,e,n){if($s(e.enabled,t)!==!1&&io(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&qv(t,e)}return!1}function Lw(t,e,n,s){return(t!==e||$s(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&qv(t,n)}function qv(t,e){return $s(e.enabled,t)!==!1&&t.isStaleByTime(io(e.staleTime,t))}function wI(t,e){return!$u(t.getCurrentResult(),e)}function $w(t){return{onFetch:(e,n)=>{var d,h,f,p,b;const s=e.options,r=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((b=e.state.data)==null?void 0:b.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const u=async()=>{let x=!1;const y=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?x=!0:e.signal.addEventListener("abort",()=>{x=!0}),e.signal)})},g=PC(e.options,e.fetchOptions),m=async(w,k,_)=>{if(x)return Promise.reject();if(k==null&&w.pages.length)return Promise.resolve(w);const S=(()=>{const M={client:e.client,queryKey:e.queryKey,pageParam:k,direction:_?"backward":"forward",meta:e.options.meta};return y(M),M})(),j=await g(S),{maxPages:N}=e.options,R=_?fI:hI;return{pages:R(w.pages,j,N),pageParams:R(w.pageParams,k,N)}};if(r&&i.length){const w=r==="backward",k=w?kI:Fw,_={pages:i,pageParams:o},C=k(s,_);a=await m(_,C,w)}else{const w=t??i.length;do{const k=l===0?o[0]??s.initialPageParam:Fw(s,a);if(l>0&&k==null)break;a=await m(a,k),l++}while(l<w)}return a};e.options.persister?e.fetchFn=()=>{var x,y;return(y=(x=e.options).persister)==null?void 0:y.call(x,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function Fw(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function kI(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var hd,Nr,$n,ia,Er,ji,XS,_I=(XS=class extends IC{constructor(e){super();Se(this,Er);Se(this,hd);Se(this,Nr);Se(this,$n);Se(this,ia);fe(this,hd,e.client),this.mutationId=e.mutationId,fe(this,$n,e.mutationCache),fe(this,Nr,[]),this.state=e.state||LC(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){I(this,Nr).includes(e)||(I(this,Nr).push(e),this.clearGcTimeout(),I(this,$n).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){fe(this,Nr,I(this,Nr).filter(n=>n!==e)),this.scheduleGc(),I(this,$n).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){I(this,Nr).length||(this.state.status==="pending"?this.scheduleGc():I(this,$n).remove(this))}continue(){var e;return((e=I(this,ia))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,a,l,u,d,h,f,p,b,x,y,g,m,w,k,_,C,S,j,N;const n=()=>{Fe(this,Er,ji).call(this,{type:"continue"})},s={client:I(this,hd),meta:this.options.meta,mutationKey:this.options.mutationKey};fe(this,ia,OC({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(R,M)=>{Fe(this,Er,ji).call(this,{type:"failed",failureCount:R,error:M})},onPause:()=>{Fe(this,Er,ji).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>I(this,$n).canRun(this)}));const r=this.state.status==="pending",i=!I(this,ia).canStart();try{if(r)n();else{Fe(this,Er,ji).call(this,{type:"pending",variables:e,isPaused:i}),await((a=(o=I(this,$n).config).onMutate)==null?void 0:a.call(o,e,this,s));const M=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,e,s));M!==this.state.context&&Fe(this,Er,ji).call(this,{type:"pending",context:M,variables:e,isPaused:i})}const R=await I(this,ia).start();return await((h=(d=I(this,$n).config).onSuccess)==null?void 0:h.call(d,R,e,this.state.context,this,s)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,R,e,this.state.context,s)),await((x=(b=I(this,$n).config).onSettled)==null?void 0:x.call(b,R,null,this.state.variables,this.state.context,this,s)),await((g=(y=this.options).onSettled)==null?void 0:g.call(y,R,null,e,this.state.context,s)),Fe(this,Er,ji).call(this,{type:"success",data:R}),R}catch(R){try{throw await((w=(m=I(this,$n).config).onError)==null?void 0:w.call(m,R,e,this.state.context,this,s)),await((_=(k=this.options).onError)==null?void 0:_.call(k,R,e,this.state.context,s)),await((S=(C=I(this,$n).config).onSettled)==null?void 0:S.call(C,void 0,R,this.state.variables,this.state.context,this,s)),await((N=(j=this.options).onSettled)==null?void 0:N.call(j,void 0,R,e,this.state.context,s)),R}finally{Fe(this,Er,ji).call(this,{type:"error",error:R})}}finally{I(this,$n).runNext(this)}}},hd=new WeakMap,Nr=new WeakMap,$n=new WeakMap,ia=new WeakMap,Er=new WeakSet,ji=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Xt.batch(()=>{I(this,Nr).forEach(s=>{s.onMutationUpdate(e)}),I(this,$n).notify({mutation:this,type:"updated",action:e})})},XS);function LC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ti,sr,fd,JS,SI=(JS=class extends Ca{constructor(e={}){super();Se(this,ti);Se(this,sr);Se(this,fd);this.config=e,fe(this,ti,new Set),fe(this,sr,new Map),fe(this,fd,0)}build(e,n,s){const r=new _I({client:e,mutationCache:this,mutationId:++Qd(this,fd)._,options:e.defaultMutationOptions(n),state:s});return this.add(r),r}add(e){I(this,ti).add(e);const n=ph(e);if(typeof n=="string"){const s=I(this,sr).get(n);s?s.push(e):I(this,sr).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(I(this,ti).delete(e)){const n=ph(e);if(typeof n=="string"){const s=I(this,sr).get(n);if(s)if(s.length>1){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}else s[0]===e&&I(this,sr).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=ph(e);if(typeof n=="string"){const s=I(this,sr).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===e}else return!0}runNext(e){var s;const n=ph(e);if(typeof n=="string"){const r=(s=I(this,sr).get(n))==null?void 0:s.find(i=>i!==e&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Xt.batch(()=>{I(this,ti).forEach(e=>{this.notify({type:"removed",mutation:e})}),I(this,ti).clear(),I(this,sr).clear()})}getAll(){return Array.from(I(this,ti))}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Rw(n,s))}findAll(e={}){return this.getAll().filter(n=>Rw(e,n))}notify(e){Xt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Xt.batch(()=>Promise.all(e.map(n=>n.continue().catch(Tn))))}},ti=new WeakMap,sr=new WeakMap,fd=new WeakMap,JS);function ph(t){var e;return(e=t.options.scope)==null?void 0:e.id}var ni,Fi,Zn,si,ui,ff,Gx,ZS,jI=(ZS=class extends Ca{constructor(n,s){super();Se(this,ui);Se(this,ni);Se(this,Fi);Se(this,Zn);Se(this,si);fe(this,ni,n),this.setOptions(s),this.bindMethods(),Fe(this,ui,ff).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const s=this.options;this.options=I(this,ni).defaultMutationOptions(n),$u(this.options,s)||I(this,ni).getMutationCache().notify({type:"observerOptionsUpdated",mutation:I(this,Zn),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&ya(s.mutationKey)!==ya(this.options.mutationKey)?this.reset():((r=I(this,Zn))==null?void 0:r.state.status)==="pending"&&I(this,Zn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=I(this,Zn))==null||n.removeObserver(this)}onMutationUpdate(n){Fe(this,ui,ff).call(this),Fe(this,ui,Gx).call(this,n)}getCurrentResult(){return I(this,Fi)}reset(){var n;(n=I(this,Zn))==null||n.removeObserver(this),fe(this,Zn,void 0),Fe(this,ui,ff).call(this),Fe(this,ui,Gx).call(this)}mutate(n,s){var r;return fe(this,si,s),(r=I(this,Zn))==null||r.removeObserver(this),fe(this,Zn,I(this,ni).getMutationCache().build(I(this,ni),this.options)),I(this,Zn).addObserver(this),I(this,Zn).execute(n)}},ni=new WeakMap,Fi=new WeakMap,Zn=new WeakMap,si=new WeakMap,ui=new WeakSet,ff=function(){var s;const n=((s=I(this,Zn))==null?void 0:s.state)??LC();fe(this,Fi,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Gx=function(n){Xt.batch(()=>{var s,r,i,o,a,l,u,d;if(I(this,si)&&this.hasListeners()){const h=I(this,Fi).variables,f=I(this,Fi).context,p={client:I(this,ni),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((r=(s=I(this,si)).onSuccess)==null||r.call(s,n.data,h,f,p),(o=(i=I(this,si)).onSettled)==null||o.call(i,n.data,null,h,f,p)):(n==null?void 0:n.type)==="error"&&((l=(a=I(this,si)).onError)==null||l.call(a,n.error,h,f,p),(d=(u=I(this,si)).onSettled)==null||d.call(u,void 0,n.error,h,f,p))}this.listeners.forEach(h=>{h(I(this,Fi))})})},ZS);function zw(t,e){const n=new Set(e);return t.filter(s=>!n.has(s))}function CI(t,e,n){const s=t.slice(0);return s[e]=n,s}var Ul,xs,Hl,Wl,Ls,zi,pd,md,gd,jn,Yx,Qx,Xx,Jx,Zx,e1,NI=(e1=class extends Ca{constructor(e,n,s){super();Se(this,jn);Se(this,Ul);Se(this,xs);Se(this,Hl);Se(this,Wl);Se(this,Ls);Se(this,zi);Se(this,pd);Se(this,md);Se(this,gd,[]);fe(this,Ul,e),fe(this,Wl,s),fe(this,Hl,[]),fe(this,Ls,[]),fe(this,xs,[]),this.setQueries(n)}onSubscribe(){this.listeners.size===1&&I(this,Ls).forEach(e=>{e.subscribe(n=>{Fe(this,jn,Jx).call(this,e,n)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,I(this,Ls).forEach(e=>{e.destroy()})}setQueries(e,n){fe(this,Hl,e),fe(this,Wl,n),Xt.batch(()=>{const s=I(this,Ls),r=Fe(this,jn,Xx).call(this,I(this,Hl));fe(this,gd,r),r.forEach(h=>h.observer.setOptions(h.defaultedQueryOptions));const i=r.map(h=>h.observer),o=i.map(h=>h.getCurrentResult()),a=s.length!==i.length,l=i.some((h,f)=>h!==s[f]),u=a||l,d=u?!0:o.some((h,f)=>{const p=I(this,xs)[f];return!p||!$u(h,p)});!u&&!d||(u&&fe(this,Ls,i),fe(this,xs,o),this.hasListeners()&&(u&&(zw(s,i).forEach(h=>{h.destroy()}),zw(i,s).forEach(h=>{h.subscribe(f=>{Fe(this,jn,Jx).call(this,h,f)})})),Fe(this,jn,Zx).call(this)))})}getCurrentResult(){return I(this,xs)}getQueries(){return I(this,Ls).map(e=>e.getCurrentQuery())}getObservers(){return I(this,Ls)}getOptimisticResult(e,n){const s=Fe(this,jn,Xx).call(this,e),r=s.map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[r,i=>Fe(this,jn,Qx).call(this,i??r,n),()=>Fe(this,jn,Yx).call(this,r,s)]}},Ul=new WeakMap,xs=new WeakMap,Hl=new WeakMap,Wl=new WeakMap,Ls=new WeakMap,zi=new WeakMap,pd=new WeakMap,md=new WeakMap,gd=new WeakMap,jn=new WeakSet,Yx=function(e,n){return n.map((s,r)=>{const i=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?i:s.observer.trackResult(i,o=>{n.forEach(a=>{a.observer.trackProp(o)})})})},Qx=function(e,n){return n?((!I(this,zi)||I(this,xs)!==I(this,md)||n!==I(this,pd))&&(fe(this,pd,n),fe(this,md,I(this,xs)),fe(this,zi,Uv(I(this,zi),n(e)))),I(this,zi)):e},Xx=function(e){const n=new Map;I(this,Ls).forEach(r=>{const i=r.options.queryHash;if(!i)return;const o=n.get(i);o?o.push(r):n.set(i,[r])});const s=[];return e.forEach(r=>{var l;const i=I(this,Ul).defaultQueryOptions(r),a=((l=n.get(i.queryHash))==null?void 0:l.shift())??new Vv(I(this,Ul),i);s.push({defaultedQueryOptions:i,observer:a})}),s},Jx=function(e,n){const s=I(this,Ls).indexOf(e);s!==-1&&(fe(this,xs,CI(I(this,xs),s,n)),Fe(this,jn,Zx).call(this))},Zx=function(){var e;if(this.hasListeners()){const n=I(this,zi),s=Fe(this,jn,Yx).call(this,I(this,xs),I(this,gd)),r=Fe(this,jn,Qx).call(this,s,(e=I(this,Wl))==null?void 0:e.combine);n!==r&&Xt.batch(()=>{this.listeners.forEach(i=>{i(I(this,xs))})})}},e1),Tr,t1,EI=(t1=class extends Ca{constructor(e={}){super();Se(this,Tr);this.config=e,fe(this,Tr,new Map)}build(e,n,s){const r=n.queryKey,i=n.queryHash??Bv(r,n);let o=this.get(i);return o||(o=new vI({client:e,queryKey:r,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(o)),o}add(e){I(this,Tr).has(e.queryHash)||(I(this,Tr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=I(this,Tr).get(e.queryHash);n&&(e.destroy(),n===e&&I(this,Tr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Xt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return I(this,Tr).get(e)}getAll(){return[...I(this,Tr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Pw(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>Pw(e,s)):n}notify(e){Xt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Xt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Xt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Tr=new WeakMap,t1),Gt,Bi,Ui,Vl,ql,Hi,Kl,Gl,n1,TI=(n1=class{constructor(t={}){Se(this,Gt);Se(this,Bi);Se(this,Ui);Se(this,Vl);Se(this,ql);Se(this,Hi);Se(this,Kl);Se(this,Gl);fe(this,Gt,t.queryCache||new EI),fe(this,Bi,t.mutationCache||new SI),fe(this,Ui,t.defaultOptions||{}),fe(this,Vl,new Map),fe(this,ql,new Map),fe(this,Hi,0)}mount(){Qd(this,Hi)._++,I(this,Hi)===1&&(fe(this,Kl,Wv.subscribe(async t=>{t&&(await this.resumePausedMutations(),I(this,Gt).onFocus())})),fe(this,Gl,Jf.subscribe(async t=>{t&&(await this.resumePausedMutations(),I(this,Gt).onOnline())})))}unmount(){var t,e;Qd(this,Hi)._--,I(this,Hi)===0&&((t=I(this,Kl))==null||t.call(this),fe(this,Kl,void 0),(e=I(this,Gl))==null||e.call(this),fe(this,Gl,void 0))}isFetching(t){return I(this,Gt).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return I(this,Bi).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=I(this,Gt).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=I(this,Gt).build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(io(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return I(this,Gt).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),r=I(this,Gt).get(s.queryHash),i=r==null?void 0:r.state.data,o=cI(e,i);if(o!==void 0)return I(this,Gt).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Xt.batch(()=>I(this,Gt).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=I(this,Gt).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=I(this,Gt);Xt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=I(this,Gt);return Xt.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=Xt.batch(()=>I(this,Gt).findAll(t).map(r=>r.cancel(n)));return Promise.all(s).then(Tn).catch(Tn)}invalidateQueries(t,e={}){return Xt.batch(()=>(I(this,Gt).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=Xt.batch(()=>I(this,Gt).findAll(t).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(Tn)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Tn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=I(this,Gt).build(this,e);return n.isStaleByTime(io(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Tn).catch(Tn)}fetchInfiniteQuery(t){return t.behavior=$w(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Tn).catch(Tn)}ensureInfiniteQueryData(t){return t.behavior=$w(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Jf.isOnline()?I(this,Bi).resumePausedMutations():Promise.resolve()}getQueryCache(){return I(this,Gt)}getMutationCache(){return I(this,Bi)}getDefaultOptions(){return I(this,Ui)}setDefaultOptions(t){fe(this,Ui,t)}setQueryDefaults(t,e){I(this,Vl).set(ya(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...I(this,Vl).values()],n={};return e.forEach(s=>{Lu(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){I(this,ql).set(ya(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...I(this,ql).values()],n={};return e.forEach(s=>{Lu(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...I(this,Ui).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Bv(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Hv&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...I(this,Ui).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){I(this,Gt).clear(),I(this,Bi).clear()}},Gt=new WeakMap,Bi=new WeakMap,Ui=new WeakMap,Vl=new WeakMap,ql=new WeakMap,Hi=new WeakMap,Kl=new WeakMap,Gl=new WeakMap,n1),$C=v.createContext(void 0),gr=t=>{const e=v.useContext($C);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},PI=({client:t,children:e})=>(v.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),c.jsx($C.Provider,{value:t,children:e})),FC=v.createContext(!1),zC=()=>v.useContext(FC);FC.Provider;function RI(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var AI=v.createContext(RI()),BC=()=>v.useContext(AI),UC=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},HC=t=>{v.useEffect(()=>{t.clearReset()},[t])},WC=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:r})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(r&&t.data===void 0||RC(n,[t.error,s])),VC=t=>{if(t.suspense){const n=r=>r==="static"?r:Math.max(r??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...r)=>n(s(...r)):n(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},qC=(t,e)=>t.isLoading&&t.isFetching&&!e,ey=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Zf=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function OI({queries:t,...e},n){const s=gr(),r=zC(),i=BC(),o=v.useMemo(()=>t.map(x=>{const y=s.defaultQueryOptions(x);return y._optimisticResults=r?"isRestoring":"optimistic",y}),[t,s,r]);o.forEach(x=>{VC(x),UC(x,i)}),HC(i);const[a]=v.useState(()=>new NI(s,o,e)),[l,u,d]=a.getOptimisticResult(o,e.combine),h=!r&&e.subscribed!==!1;v.useSyncExternalStore(v.useCallback(x=>h?a.subscribe(Xt.batchCalls(x)):Tn,[a,h]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),v.useEffect(()=>{a.setQueries(o,e)},[o,e,a]);const p=l.some((x,y)=>ey(o[y],x))?l.flatMap((x,y)=>{const g=o[y];if(g){const m=new Vv(s,g);if(ey(g,x))return Zf(g,m,i);qC(x,r)&&Zf(g,m,i)}return[]}):[];if(p.length>0)throw Promise.all(p);const b=l.find((x,y)=>{const g=o[y];return g&&WC({result:x,errorResetBoundary:i,throwOnError:g.throwOnError,query:s.getQueryCache().get(g.queryHash),suspense:g.suspense})});if(b!=null&&b.error)throw b.error;return u(d())}function II(t,e,n){var h,f,p,b,x;const s=zC(),r=BC(),i=gr(),o=i.defaultQueryOptions(t);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,o),o._optimisticResults=s?"isRestoring":"optimistic",VC(o),UC(o,r),HC(r);const a=!i.getQueryCache().get(o.queryHash),[l]=v.useState(()=>new e(i,o)),u=l.getOptimisticResult(o),d=!s&&t.subscribed!==!1;if(v.useSyncExternalStore(v.useCallback(y=>{const g=d?l.subscribe(Xt.batchCalls(y)):Tn;return l.updateResult(),g},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),v.useEffect(()=>{l.setOptions(o)},[o,l]),ey(o,u))throw Zf(o,l,r);if(WC({result:u,errorResetBoundary:r,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((b=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||b.call(p,o,u),o.experimental_prefetchInRender&&!xa&&qC(u,s)){const y=a?Zf(o,l,r):(x=i.getQueryCache().get(o.queryHash))==null?void 0:x.promise;y==null||y.catch(Tn).finally(()=>{l.updateResult()})}return o.notifyOnChangeProps?u:l.trackResult(u)}function Ht(t,e){return II(t,Vv)}function KC(t,e){const n=gr(),[s]=v.useState(()=>new jI(n,t));v.useEffect(()=>{s.setOptions(t)},[s,t]);const r=v.useSyncExternalStore(v.useCallback(o=>s.subscribe(Xt.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((o,a)=>{s.mutate(o,a).catch(Tn)},[s]);if(r.error&&RC(s.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}const MI="modulepreload",DI=function(t){return"/"+t},Bw={},LI=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(l=>{if(l=DI(l),l in Bw)return;Bw[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":MI,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),GC=(...t)=>t.filter((e,n,s)=>!!e&&s.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var FI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=v.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...a},l)=>v.createElement("svg",{ref:l,...FI,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:GC("lucide",r),...a},[...o.map(([u,d])=>v.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=(t,e)=>{const n=v.forwardRef(({className:s,...r},i)=>v.createElement(zI,{ref:i,iconNode:e,className:GC(`lucide-${$I(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=it("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=it("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=it("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=it("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mh=it("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=it("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=it("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=it("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=it("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=it("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kv=it("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=it("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=it("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=it("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=it("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=it("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=it("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=it("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=it("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=it("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=it("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=it("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=it("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=it("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=it("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=it("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=it("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=it("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=it("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=it("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=it("UserRoundX",[["path",{d:"M2 21a8 8 0 0 1 11.873-7",key:"74fkxq"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m17 17 5 5",key:"p7ous7"}],["path",{d:"m22 17-5 5",key:"gqnmv0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=it("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=it("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function eN(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=eN(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function tN(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=eN(t))&&(s&&(s+=" "),s+=e);return s}const Yv="-",tM=t=>{const e=sM(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const a=o.split(Yv);return a[0]===""&&a.length!==1&&a.shift(),nN(a,e)||nM(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&s[o]?[...l,...s[o]]:l}}},nN=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?nN(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const i=t.join(Yv);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},Hw=/^\[(.+)\]$/,nM=t=>{if(Hw.test(t)){const e=Hw.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},sM=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return iM(Object.entries(t.classGroups),n).forEach(([i,o])=>{ty(o,s,i,e)}),s},ty=(t,e,n,s)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?e:Ww(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(rM(r)){ty(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([i,o])=>{ty(o,Ww(e,i),n,s)})})},Ww=(t,e)=>{let n=t;return e.split(Yv).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},rM=t=>t.isThemeGetter,iM=(t,e)=>e?t.map(([n,s])=>{const r=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,r]}):t,oM=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const r=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return r(i,o),o},set(i,o){n.has(i)?n.set(i,o):r(i,o)}}},sN="!",aM=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,r=e[0],i=e.length,o=a=>{const l=[];let u=0,d=0,h;for(let y=0;y<a.length;y++){let g=a[y];if(u===0){if(g===r&&(s||a.slice(y,y+i)===e)){l.push(a.slice(d,y)),d=y+i;continue}if(g==="/"){h=y;continue}}g==="["?u++:g==="]"&&u--}const f=l.length===0?a:a.substring(d),p=f.startsWith(sN),b=p?f.substring(1):f,x=h&&h>d?h-d:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:b,maybePostfixModifierPosition:x}};return n?a=>n({className:a,parseClassName:o}):o},lM=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},cM=t=>({cache:oM(t.cacheSize),parseClassName:aM(t),...tM(t)}),uM=/\s+/,dM=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,i=[],o=t.trim().split(uM);let a="";for(let l=o.length-1;l>=0;l-=1){const u=o[l],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=n(u);let b=!!p,x=s(b?f.substring(0,p):f);if(!x){if(!b){a=u+(a.length>0?" "+a:a);continue}if(x=s(f),!x){a=u+(a.length>0?" "+a:a);continue}b=!1}const y=lM(d).join(":"),g=h?y+sN:y,m=g+x;if(i.includes(m))continue;i.push(m);const w=r(x,b);for(let k=0;k<w.length;++k){const _=w[k];i.push(g+_)}a=u+(a.length>0?" "+a:a)}return a};function hM(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=rN(e))&&(s&&(s+=" "),s+=n);return s}const rN=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=rN(t[s]))&&(n&&(n+=" "),n+=e);return n};function fM(t,...e){let n,s,r,i=o;function o(l){const u=e.reduce((d,h)=>h(d),t());return n=cM(u),s=n.cache.get,r=n.cache.set,i=a,a(l)}function a(l){const u=s(l);if(u)return u;const d=dM(l,n);return r(l,d),d}return function(){return i(hM.apply(null,arguments))}}const jt=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},iN=/^\[(?:([a-z-]+):)?(.+)\]$/i,pM=/^\d+\/\d+$/,mM=new Set(["px","full","screen"]),gM=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xM=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,yM=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,vM=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,bM=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Vr=t=>Sl(t)||mM.has(t)||pM.test(t),_i=t=>cc(t,"length",EM),Sl=t=>!!t&&!Number.isNaN(Number(t)),qm=t=>cc(t,"number",Sl),Ic=t=>!!t&&Number.isInteger(Number(t)),wM=t=>t.endsWith("%")&&Sl(t.slice(0,-1)),Ke=t=>iN.test(t),Si=t=>gM.test(t),kM=new Set(["length","size","percentage"]),_M=t=>cc(t,kM,oN),SM=t=>cc(t,"position",oN),jM=new Set(["image","url"]),CM=t=>cc(t,jM,PM),NM=t=>cc(t,"",TM),Mc=()=>!0,cc=(t,e,n)=>{const s=iN.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},EM=t=>xM.test(t)&&!yM.test(t),oN=()=>!1,TM=t=>vM.test(t),PM=t=>bM.test(t),RM=()=>{const t=jt("colors"),e=jt("spacing"),n=jt("blur"),s=jt("brightness"),r=jt("borderColor"),i=jt("borderRadius"),o=jt("borderSpacing"),a=jt("borderWidth"),l=jt("contrast"),u=jt("grayscale"),d=jt("hueRotate"),h=jt("invert"),f=jt("gap"),p=jt("gradientColorStops"),b=jt("gradientColorStopPositions"),x=jt("inset"),y=jt("margin"),g=jt("opacity"),m=jt("padding"),w=jt("saturate"),k=jt("scale"),_=jt("sepia"),C=jt("skew"),S=jt("space"),j=jt("translate"),N=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto",Ke,e],O=()=>[Ke,e],D=()=>["",Vr,_i],$=()=>["auto",Sl,Ke],L=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],W=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],E=()=>["start","end","center","between","around","evenly","stretch"],P=()=>["","0",Ke],A=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[Sl,Ke];return{cacheSize:500,separator:":",theme:{colors:[Mc],spacing:[Vr,_i],blur:["none","",Si,Ke],brightness:F(),borderColor:[t],borderRadius:["none","","full",Si,Ke],borderSpacing:O(),borderWidth:D(),contrast:F(),grayscale:P(),hueRotate:F(),invert:P(),gap:O(),gradientColorStops:[t],gradientColorStopPositions:[wM,_i],inset:M(),margin:M(),opacity:F(),padding:O(),saturate:F(),scale:F(),sepia:P(),skew:F(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",Ke]}],container:["container"],columns:[{columns:[Si]}],"break-after":[{"break-after":A()}],"break-before":[{"break-before":A()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...L(),Ke]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ic,Ke]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ke]}],grow:[{grow:P()}],shrink:[{shrink:P()}],order:[{order:["first","last","none",Ic,Ke]}],"grid-cols":[{"grid-cols":[Mc]}],"col-start-end":[{col:["auto",{span:["full",Ic,Ke]},Ke]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[Mc]}],"row-start-end":[{row:["auto",{span:[Ic,Ke]},Ke]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ke]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ke]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...E()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...E(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...E(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[m]}],px:[{px:[m]}],py:[{py:[m]}],ps:[{ps:[m]}],pe:[{pe:[m]}],pt:[{pt:[m]}],pr:[{pr:[m]}],pb:[{pb:[m]}],pl:[{pl:[m]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ke,e]}],"min-w":[{"min-w":[Ke,e,"min","max","fit"]}],"max-w":[{"max-w":[Ke,e,"none","full","min","max","fit","prose",{screen:[Si]},Si]}],h:[{h:[Ke,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ke,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ke,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ke,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Si,_i]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",qm]}],"font-family":[{font:[Mc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ke]}],"line-clamp":[{"line-clamp":["none",Sl,qm]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Vr,Ke]}],"list-image":[{"list-image":["none",Ke]}],"list-style-type":[{list:["none","disc","decimal",Ke]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Vr,_i]}],"underline-offset":[{"underline-offset":["auto",Vr,Ke]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...L(),SM]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",_M]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},CM]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:U()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[Vr,Ke]}],"outline-w":[{outline:[Vr,_i]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Vr,_i]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Si,NM]}],"shadow-color":[{shadow:[Mc]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...W(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Si,Ke]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ke]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",Ke]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ke]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Ic,Ke]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ke]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ke]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ke]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Vr,_i,qm]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},AM=fM(RM);function Te(...t){return AM(tN(t))}function kn(t){return t.split(/\n|,/).map(e=>e.trim()).filter(Boolean)}function ny(t){if(!t)return{module:"",service:"",action:""};const[e,n,s]=t.split(":");return{module:(e==null?void 0:e.trim())||"",service:(n==null?void 0:n.trim())||"",action:(s==null?void 0:s.trim())||""}}function Vw({module:t,service:e,action:n}){return!t||!e||!n?"":`${t}:${e}:${n}`}function jl(t,e,n=`${e}s`){return t?`${t} ${t===1?e:n} selected`:`No ${n} selected`}function mf(t,e={}){return{...e,...t||{}}}function vt({className:t,...e}){return c.jsx("div",{className:Te("mmg-card rounded-2xl bg-white/70 dark:bg-white/5 backdrop-blur-xs shadow-soft","ring-1 ring-black/5 dark:ring-white/10",t),...e})}function Lt({className:t,...e}){return c.jsx("div",{className:Te("p-5 pb-3",t),...e})}function Wt({className:t,...e}){return c.jsx("h3",{className:Te("text-base font-semibold",t),...e})}function $t({className:t,...e}){return c.jsx("div",{className:Te("p-5 pt-0",t),...e})}function qw(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Na(...t){return e=>{let n=!1;const s=t.map(r=>{const i=qw(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():qw(t[r],null)}}}}function us(...t){return v.useCallback(Na(...t),t)}var OM=Symbol.for("react.lazy"),ep=jp[" use ".trim().toString()];function IM(t){return typeof t=="object"&&t!==null&&"then"in t}function aN(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===OM&&"_payload"in t&&IM(t._payload)}function MM(t){const e=LM(t),n=v.forwardRef((s,r)=>{let{children:i,...o}=s;aN(i)&&typeof ep=="function"&&(i=ep(i._payload));const a=v.Children.toArray(i),l=a.find(FM);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}var DM=MM("Slot");function LM(t){const e=v.forwardRef((n,s)=>{let{children:r,...i}=n;if(aN(r)&&typeof ep=="function"&&(r=ep(r._payload)),v.isValidElement(r)){const o=BM(r),a=zM(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Na(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var $M=Symbol("radix.slottable");function FM(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===$M}function zM(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function BM(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const Kw=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Gw=tN,UM=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return Gw(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=Kw(d)||Kw(h);return r[u][f]}),a=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(b=>{let[x,y]=b;return Array.isArray(y)?y.includes({...i,...a}[x]):{...i,...a}[x]===y})?[...u,h,f]:u},[]);return Gw(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},HM=UM("inline-flex items-center justify-center whitespace-nowrap rounded-xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black/10 dark:focus-visible:ring-white/15 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"mmg-btn-primary bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90 shadow-soft",secondary:"bg-black/5 text-black hover:bg-black/8 dark:bg-white/10 dark:text-white dark:hover:bg-white/15 shadow-soft",ghost:"bg-transparent hover:bg-black/5 text-black dark:text-white dark:hover:bg-white/10 shadow-soft"},size:{default:"h-10 px-4",sm:"h-9 px-3",lg:"h-11 px-5",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),te=ge.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...r},i)=>{const o=s?DM:"button";return c.jsx(o,{className:Te(HM({variant:e,size:n,className:t})),ref:i,...r})});te.displayName="Button";function Ye({text:t="Loading",className:e=""}){return c.jsxs("span",{className:["inline-flex items-center gap-2",e].filter(Boolean).join(" "),children:[c.jsx("span",{children:t}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function lN({size:t=128}){return c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("img",{src:"/logo.svg",width:t,height:t,alt:"",className:"shrink-0 filter invert dark:invert-0"}),c.jsx("span",{className:"mmg-brand-gold font-semibold text-lg leading-none tracking-tight hidden sm:inline-flex",children:"Nova"})]})}var Or=function(){return Or=Object.assign||function(e){for(var n,s=1,r=arguments.length;s<r;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Or.apply(this,arguments)};function uc(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function WM(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function l(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,l)}u((s=s.apply(t,e||[])).next())})}function VM(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}const qM=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Qv extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class KM extends Qv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yw extends Qv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Qw extends Qv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var sy;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(sy||(sy={}));class GM{constructor(e,{headers:n={},customFetch:s,region:r=sy.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=qM(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return WM(this,arguments,void 0,function*(n,s={}){var r;let i,o;try{const{headers:a,method:l,body:u,signal:d,timeout:h}=s;let f={},{region:p}=s;p||(p=this.region);const b=new URL(`${this.url}/${n}`);p&&p!=="any"&&(f["x-region"]=p,b.searchParams.set("forceFunctionRegion",p));let x;u&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",x=u):typeof u=="string"?(f["Content-Type"]="text/plain",x=u):typeof FormData<"u"&&u instanceof FormData?x=u:(f["Content-Type"]="application/json",x=JSON.stringify(u)):x=u;let y=d;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),d?(y=o.signal,d.addEventListener("abort",()=>o.abort())):y=o.signal);const g=yield this.fetch(b.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:x,signal:y}).catch(_=>{throw new KM(_)}),m=g.headers.get("x-relay-error");if(m&&m==="true")throw new Yw(g);if(!g.ok)throw new Qw(g);let w=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return w==="application/json"?k=yield g.json():w==="application/octet-stream"||w==="application/pdf"?k=yield g.blob():w==="text/event-stream"?k=g:w==="multipart/form-data"?k=yield g.formData():k=yield g.text(),{data:k,error:null,response:g}}catch(a){return{data:null,error:a,response:a instanceof Qw||a instanceof Yw?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var YM=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},QM=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,a=null,l=null,u=i.status,d=i.statusText;if(i.ok){var h,f;if(n.method!=="HEAD"){var p;const g=await i.text();g===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((p=n.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?a=g:a=JSON.parse(g))}const x=(h=n.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),y=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");x&&y&&y.length>1&&(l=parseInt(y[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,u=406,d="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var b;const x=await i.text();try{o=JSON.parse(x),Array.isArray(o)&&i.status===404&&(a=[],o=null,u=200,d="OK")}catch{i.status===404&&x===""?(u=204,d="No Content"):o={message:x}}if(o&&n.isMaybeSingle&&(!(o==null||(b=o.details)===null||b===void 0)&&b.includes("0 rows"))&&(o=null,u=200,d="OK"),o&&n.shouldThrowOnError)throw new YM(o)}return{error:o,data:a,count:l,status:u,statusText:d}});return this.shouldThrowOnError||(r=r.catch(i=>{var o;let a="";const l=i==null?void 0:i.cause;if(l){var u,d,h,f;const b=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",x=(d=l==null?void 0:l.code)!==null&&d!==void 0?d:"";a=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,a+=`

Caused by: ${(f=l==null?void 0:l.name)!==null&&f!==void 0?f:"Error"}: ${b}`,x&&(a+=` (${x})`),l!=null&&l.stack&&(a+=`
${l.stack}`)}else{var p;a=(p=i==null?void 0:i.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},XM=class extends QM{select(t){let e=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:r=s}={}){const i=r?`${r}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:r=!1,format:i="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Xw=new RegExp("[,()]");var el=class extends XM{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&Xw.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&Xw.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${r}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},JM=class{constructor(t,{headers:e={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=s}select(t,e){const{head:n=!1,count:s}=e??{},r=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new el({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var s;const r="POST";if(e&&this.headers.append("Prefer",`count=${e}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,a)=>o.concat(Object.keys(a)),[]);if(i.length>0){const o=[...new Set(i)].map(a=>`"${a}"`);this.url.searchParams.set("columns",o.join(","))}}return new el({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new el({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var n;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new el({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new el({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},ZM=class cN{constructor(e,{headers:n={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new JM(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new cN(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:r=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let u;s||r?(a=s?"HEAD":"GET",Object.entries(n).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{l.searchParams.append(h,f)})):(a="POST",u=n);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new el({method:a,url:l,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class eD{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const tD="2.88.0",nD=`realtime-js/${tD}`,uN="1.0.0",sD="2.0.0",Jw=uN,ry=1e4,rD=1e3,iD=100;var Ti;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ti||(Ti={}));var ln;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ln||(ln={}));var ir;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ir||(ir={}));var iy;(function(t){t.websocket="websocket"})(iy||(iy={}));var Uo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Uo||(Uo={}));class oD{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,s){var r,i;const o=e.topic,a=(r=e.ref)!==null&&r!==void 0?r:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+u.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let b=new DataView(p),x=0;b.setUint8(x++,this.KINDS.userBroadcastPush),b.setUint8(x++,l.length),b.setUint8(x++,a.length),b.setUint8(x++,o.length),b.setUint8(x++,u.length),b.setUint8(x++,h.length),b.setUint8(x++,n),Array.from(l,g=>b.setUint8(x++,g.charCodeAt(0))),Array.from(a,g=>b.setUint8(x++,g.charCodeAt(0))),Array.from(o,g=>b.setUint8(x++,g.charCodeAt(0))),Array.from(u,g=>b.setUint8(x++,g.charCodeAt(0))),Array.from(h,g=>b.setUint8(x++,g.charCodeAt(0)));var y=new Uint8Array(p.byteLength+s.byteLength);return y.set(new Uint8Array(p),0),y.set(new Uint8Array(s),p.byteLength),y.buffer}decode(e,n){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return n(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,i,o,a,l]=s;return n({join_ref:r,ref:i,topic:o,event:a,payload:l})}return n({})}_binaryDecode(e){const n=new DataView(e),s=n.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,r)}}_decodeUserBroadcast(e,n,s){const r=n.getUint8(1),i=n.getUint8(2),o=n.getUint8(3),a=n.getUint8(4);let l=this.HEADER_LENGTH+4;const u=s.decode(e.slice(l,l+r));l=l+r;const d=s.decode(e.slice(l,l+i));l=l+i;const h=s.decode(e.slice(l,l+o));l=l+o;const f=e.slice(l,e.byteLength),p=a===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,b={type:this.BROADCAST_EVENT,event:d,payload:p};return o>0&&(b.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>n.includes(s)))}}class dN{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var kt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(kt||(kt={}));const Zw=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=aD(o,t,e,r),i),{}):{}},aD=(t,e,n,s)=>{const r=e.find(a=>a.name===t),i=r==null?void 0:r.type,o=n[t];return i&&!s.includes(i)?hN(i,o):oy(o)},hN=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return dD(e,n)}switch(t){case kt.bool:return lD(e);case kt.float4:case kt.float8:case kt.int2:case kt.int4:case kt.int8:case kt.numeric:case kt.oid:return cD(e);case kt.json:case kt.jsonb:return uD(e);case kt.timestamp:return hD(e);case kt.abstime:case kt.date:case kt.daterange:case kt.int4range:case kt.int8range:case kt.money:case kt.reltime:case kt.text:case kt.time:case kt.timestamptz:case kt.timetz:case kt.tsrange:case kt.tstzrange:return oy(e);default:return oy(e)}},oy=t=>t,lD=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},cD=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},uD=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},dD=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>hN(e,a))}return t},hD=t=>typeof t=="string"?t.replace(" ","T"):t,fN=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Km{constructor(e,n,s={},r=ry){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ek;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ek||(ek={}));class du{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=du.syncState(this.state,r,i,o),this.pendingDiffs.forEach(l=>{this.state=du.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=du.syncDiff(this.state,r,i,o),a())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const i=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(i,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(y=>y.presence_ref),p=h.map(y=>y.presence_ref),b=d.filter(y=>p.indexOf(y.presence_ref)<0),x=h.filter(y=>f.indexOf(y.presence_ref)<0);b.length>0&&(a[u]=b),x.length>0&&(l[u]=x)}else a[u]=d}),this.syncDiff(i,{joins:a,leaves:l},s,r)}static syncDiff(e,n,s,r){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(a,l)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),d.length>0){const h=e[a].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...f)}s(a,d,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[a]=u,r(a,u,l),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tk;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(tk||(tk={}));var hu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(hu||(hu={}));var Xr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Xr||(Xr={}));class ml{constructor(e,n={config:{}},s){var r,i;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=ln.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Km(this,ir.join,this.params,this.timeout),this.rejoinTimer=new dN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ln.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ln.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ln.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ln.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ln.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ir.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new du(this),this.broadcastEndpointURL=fN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==ln.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,u=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&r!==void 0?r:[],d=!!this.bindings[hu.PRESENCE]&&this.bindings[hu.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Xr.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Xr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(Xr.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,y=(b=x==null?void 0:x.length)!==null&&b!==void 0?b:0,g=[];for(let m=0;m<y;m++){const w=x[m],{filter:{event:k,schema:_,table:C,filter:S}}=w,j=p&&p[m];if(j&&j.event===k&&ml.isFilterValueEqual(j.schema,_)&&ml.isFilterValueEqual(j.table,C)&&ml.isFilterValueEqual(j.filter,S))g.push(Object.assign(Object.assign({},w),{id:j.id}));else{this.unsubscribe(),this.state=ln.errored,e==null||e(Xr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Xr.SUBSCRIBED);return}}).receive("error",p=>{this.state=ln.errored,e==null||e(Xr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Xr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===ln.joined&&e===hu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var r;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const u=await a.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ln.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ir.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new Km(this,ir.leave,{},e),s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ln.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(i),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Km(this,e,n,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>iD){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:d}=ir;if(s&&[a,l,u,d].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,n,s);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var b,x,y;return((b=p.filter)===null||b===void 0?void 0:b.event)==="*"||((y=(x=p.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var b,x,y,g,m,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const k=p.id,_=(b=p.filter)===null||b===void 0?void 0:b.event;return k&&((x=n.ids)===null||x===void 0?void 0:x.includes(k))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const k=(m=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return k==="*"||k===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const b=f.data,{schema:x,table:y,commit_timestamp:g,type:m,errors:w}=b;f=Object.assign(Object.assign({},{schema:x,table:y,commit_timestamp:g,eventType:m,new:{},old:{},errors:w}),this._getPayloadRecords(b))}p.callback(f,s)})}_isClosed(){return this.state===ln.closed}_isJoined(){return this.state===ln.joined}_isJoining(){return this.state===ln.joining}_isLeaving(){return this.state===ln.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),i={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&ml.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ir.close,{},e)}_onError(e){this._on(ir.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ln.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Zw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Zw(e.columns,e.old_record)),n}}const Gm=()=>{},yh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},fD=[1e3,2e3,5e3,1e4],pD=1e4,mD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gD{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ry,this.transport=null,this.heartbeatIntervalMs=yh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Gm,this.ref=0,this.reconnectTimer=null,this.vsn=Jw,this.logger=Gm,this.conn=null,this.sendBuffer=[],this.serializer=new oD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((s=n==null?void 0:n.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${iy.websocket}`,this.httpEndpoint=fN(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=eD.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ti.connecting:return Uo.Connecting;case Ti.open:return Uo.Open;case Ti.closing:return Uo.Closing;default:return Uo.Closed}}isConnected(){return this.connectionState()===Uo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new ml(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(rD,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},yh.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:i,ref:o}=n,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${r} ${a}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(r,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ti.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ti.open||this.conn.readyState===Ti.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ir.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([mD],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,s=!1;if(e)n=e,s=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),n=this.accessTokenValue}else n=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:nD};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(ir.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new dN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},yh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,r,i,o,a,l,u,d,h,f,p;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:ry,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:yh.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Gm,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:Jw,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:b=>fD[b-1]||pD,this.vsn){case uN:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(b,x)=>x(JSON.stringify(b)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(b,x)=>x(JSON.parse(b));break;case sD:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Fu=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function xD(t,e,n){const s=new URL(e,t);if(n)for(const[r,i]of Object.entries(n))i!==void 0&&s.searchParams.set(r,i);return s.toString()}async function yD(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function vD(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:s,query:r,body:i,headers:o}){const a=xD(t.baseUrl,s,r),l=await yD(t.auth),u=await e(a,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const p=h?f:void 0,b=p==null?void 0:p.error;throw new Fu((b==null?void 0:b.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:b==null?void 0:b.type,icebergCode:b==null?void 0:b.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function vh(t){return t.join("")}var bD=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:vh(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${vh(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${vh(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${vh(t.namespace)}`}),!0}catch(e){if(e instanceof Fu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Fu&&n.status===409)return;throw n}}};function Ba(t){return t.join("")}var wD=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ba(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ba(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ba(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ba(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ba(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ba(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Fu&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Fu&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},kD=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=vD({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new bD(this.client,e),this.tableOps=new wD(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Up=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function Bt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var _D=class extends Up{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ay=class extends Up{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Xv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),SD=()=>Response,ly=t=>{if(Array.isArray(t))return t.map(n=>ly(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=ly(s)}),e},jD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},CD=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function zu(t){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zu(t)}function ND(t,e){if(zu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(zu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ED(t){var e=ND(t,"string");return zu(e)=="symbol"?e:e+""}function TD(t,e,n){return(e=ED(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Be(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nk(Object(n),!0).forEach(function(s){TD(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nk(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const Ym=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},PD=async(t,e,n)=>{t instanceof await SD()&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const r=t.status||500,i=(s==null?void 0:s.statusCode)||r+"";e(new _D(Ym(s),r,i))}).catch(s=>{e(new ay(Ym(s),s))}):e(new ay(Ym(t),t))},RD=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?r:(jD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),Be(Be({},r),n))};async function Nd(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,RD(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>PD(l,a,s))})}async function Bu(t,e,n,s){return Nd(t,"GET",e,n,s)}async function tr(t,e,n,s,r){return Nd(t,"POST",e,s,r,n)}async function cy(t,e,n,s,r){return Nd(t,"PUT",e,s,r,n)}async function AD(t,e,n,s){return Nd(t,"HEAD",e,Be(Be({},n),{},{noResolveJson:!0}),s)}async function Jv(t,e,n,s,r){return Nd(t,"DELETE",e,s,r,n)}var OD=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Bt(e))return{data:null,error:e};throw e}}};let pN;pN=Symbol.toStringTag;var ID=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[pN]="BlobDownloadBuilder",this.promise=null}asStream(){return new OD(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Bt(e))return{data:null,error:e};throw e}}};const MD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},sk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var DD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=Xv(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,s){var r=this;try{let i;const o=Be(Be({},sk),s);let a=Be(Be({},r.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",r.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",r.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=r.toBase64(r.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(a=Be(Be({},a),s.headers));const u=r._removeEmptyFolders(e),d=r._getFinalPath(u),h=await(t=="PUT"?cy:tr)(r.fetch,`${r.url}/object/${d}`,i,Be({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(r.shouldThrowOnError)throw i;if(Bt(i))return{data:null,error:i};throw i}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,s){var r=this;const i=r._removeEmptyFolders(t),o=r._getFinalPath(i),a=new URL(r.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l;const u=Be({upsert:sk.upsert},s),d=Be(Be({},r.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await cy(r.fetch,a.toString(),l,{headers:d})).Key},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(Bt(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var n=this;try{let s=n._getFinalPath(t);const r=Be({},n.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const i=await tr(n.fetch,`${n.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(n.url+i.url),a=o.searchParams.get("token");if(!a)throw new Up("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var s=this;try{return{data:await tr(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers}),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}}async copy(t,e,n){var s=this;try{return{data:{path:(await tr(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers})).Key},error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}}async createSignedUrl(t,e,n){var s=this;try{let r=s._getFinalPath(t),i=await tr(s.fetch,`${s.url}/object/sign/${r}`,Be({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:s.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}}async createSignedUrls(t,e,n){var s=this;try{const r=await tr(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:r.map(o=>Be(Be({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),r=s?`?${s}`:"",i=this._getFinalPath(t),o=()=>Bu(this.fetch,`${this.url}/${n}/${i}${r}`,{headers:this.headers,noResolveJson:!0});return new ID(o,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:ly(await Bu(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await AD(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Bt(s)&&s instanceof ay){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&s.push(o);let a=s.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${a}`)}}}async remove(t){var e=this;try{return{data:await Jv(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}async list(t,e,n){var s=this;try{const r=Be(Be(Be({},MD),e),{},{prefix:t||""});return{data:await tr(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},n),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Bt(r))return{data:null,error:r};throw r}}async listV2(t,e){var n=this;try{const s=Be({},t);return{data:await tr(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,s,{headers:n.headers},e),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const mN="2.88.0",gN={"X-Client-Info":`storage-js/${mN}`};var LD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1;const r=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Be(Be({},gN),e),this.fetch=Xv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await Bu(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await Bu(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await tr(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var n=this;try{return{data:await cy(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Bt(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await tr(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Jv(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},$D=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},gN),e),this.fetch=Xv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await tr(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const s=n.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Bu(e.fetch,r,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Jv(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Bt(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!CD(t))throw new Up("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new kD({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(n,{get(r,i){const o=r[i];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(r,a),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const Zv={"X-Client-Info":`storage-js/${mN}`,"Content-Type":"application/json"};var xN=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function bs(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Qm=class extends xN{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},FD=class extends xN{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const e0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),zD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},rk=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),BD=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const s=t.status||500,r=t;if(typeof r.json=="function")r.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new Qm(rk(i),s,o))}).catch(()=>{const i=s+"";e(new Qm(r.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new Qm(r.statusText||`HTTP ${s} error`,s,i))}}else e(new FD(rk(t),t))},UD=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(zD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,Be(Be({},r),n)):r};async function HD(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,UD(e,s,r,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>BD(l,a,s))})}async function ws(t,e,n,s,r){return HD(t,"POST",e,s,r,n)}var WD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},Zv),e),this.fetch=e0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await ws(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bs(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await ws(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(bs(s))return{data:null,error:s};throw s}}},VD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},Zv),e),this.fetch=e0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ws(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await ws(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ws(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}},qD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},Zv),e),this.fetch=e0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await ws(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await ws(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(bs(n))return{data:null,error:n};throw n}}},KD=class extends qD{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new GD(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},GD=class extends WD{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new YD(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},YD=class extends VD{constructor(t,e,n,s,r){super(t,e,r),this.vectorBucketName=n,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},QD=class extends LD{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new DD(this.url,this.headers,t,this.fetch)}get vectors(){return new KD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new $D(this.url+"/iceberg",this.headers,this.fetch)}};const yN="2.88.0",tl=30*1e3,uy=3,Xm=uy*tl,XD="http://localhost:9999",JD="supabase.auth.token",ZD={"X-Client-Info":`gotrue-js/${yN}`},dy="X-Supabase-Api-Version",vN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eL=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,tL=10*60*1e3;class Uu extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Ae(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class nL extends Uu{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function sL(t){return Ae(t)&&t.name==="AuthApiError"}class Ho extends Uu{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class bi extends Uu{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class ms extends bi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rL(t){return Ae(t)&&t.name==="AuthSessionMissingError"}class Ua extends bi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bh extends bi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class wh extends bi{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function iL(t){return Ae(t)&&t.name==="AuthImplicitGrantRedirectError"}class ik extends bi{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class oL extends bi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class hy extends bi{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Jm(t){return Ae(t)&&t.name==="AuthRetryableFetchError"}class ok extends bi{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class fy extends bi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const tp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ak=` 	
\r=`.split(""),aL=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ak.length;e+=1)t[ak[e].charCodeAt(0)]=-2;for(let e=0;e<tp.length;e+=1)t[tp[e].charCodeAt(0)]=e;return t})();function lk(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(tp[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(tp[s]),e.queuedBits-=6}}function bN(t,e,n){const s=aL[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function ck(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=o=>{uL(o,s,n)};for(let o=0;o<t.length;o+=1)bN(t.charCodeAt(o),r,i);return e.join("")}function lL(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function cL(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}lL(s,e)}}function uL(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Cl(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)bN(t.charCodeAt(r),n,s);return new Uint8Array(e)}function dL(t){const e=[];return cL(t,n=>e.push(n)),new Uint8Array(e)}function Go(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>lk(r,n,s)),lk(null,n,s),e.join("")}function hL(t){return Math.round(Date.now()/1e3)+t}function fL(){return Symbol("auth-callback")}const bn=()=>typeof window<"u"&&typeof document<"u",Ao={tested:!1,writable:!1},wN=()=>{if(!bn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ao.tested)return Ao.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ao.tested=!0,Ao.writable=!0}catch{Ao.tested=!0,Ao.writable=!1}return Ao.writable};function pL(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const kN=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),mL=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",nl=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Oo=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},vn=async(t,e)=>{await t.removeItem(e)};class Hp{constructor(){this.promise=new Hp.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Hp.promiseConstructor=Promise;function Zm(t){const e=t.split(".");if(e.length!==3)throw new fy("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!eL.test(e[s]))throw new fy("JWT not in base64url format");return{header:JSON.parse(ck(e[0])),payload:JSON.parse(ck(e[1])),signature:Cl(e[2]),raw:{header:e[0],payload:e[1]}}}async function gL(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function xL(t,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function yL(t){return("0"+t.toString(16)).substr(-2)}function vL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let i=0;i<56;i++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,yL).join("")}async function bL(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function wL(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await bL(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ha(t,e,n=!1){const s=vL();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await nl(t,`${e}-code-verifier`,r);const i=await wL(s);return[i,s===i?"plain":"s256"]}const kL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _L(t){const e=t.headers.get(dy);if(!e||!e.match(kL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function SL(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function jL(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const CL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wa(t){if(!CL.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function eg(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function NL(t,e){return new Proxy(t,{get:(n,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,r)}})}function uk(t){return JSON.parse(JSON.stringify(t))}const Fo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),EL=[502,503,504];async function dk(t){var e;if(!mL(t))throw new hy(Fo(t),0);if(EL.includes(t.status))throw new hy(Fo(t),t.status);let n;try{n=await t.json()}catch(i){throw new Ho(Fo(i),i)}let s;const r=_L(t);if(r&&r.getTime()>=vN["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new ok(Fo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new ms}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new ok(Fo(n),t.status,n.weak_password.reasons);throw new nL(Fo(n),t.status||500,s)}const TL=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function ze(t,e,n,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[dy]||(i[dy]=vN["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await PL(t,e,n+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function PL(t,e,n,s,r,i){const o=TL(e,s,r,i);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new hy(Fo(l),0)}if(a.ok||await dk(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await dk(l)}}function Zs(t){var e;let n=null;OL(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=hL(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function hk(t){const e=Zs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ai(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function RL(t){return{data:t,error:null}}function AL(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i}=t,o=uc(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function fk(t){return t}function OL(t){return t.access_token&&t.refresh_token&&t.expires_in}const tg=["global","local","others"];class IL{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=kN(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=tg[0]){if(tg.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${tg.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ae(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ai})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=uc(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:AL,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ae(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ai})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:fk});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(b=>{const x=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(b.split(";")[1].split("=")[1]);u[`${y}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Ae(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Wa(e);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ai})}catch(n){if(Ae(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Wa(e);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ai})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){Wa(e);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ai})}catch(s){if(Ae(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Wa(e.userId);try{const{data:n,error:s}=await ze(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Wa(e.userId),Wa(e.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:fk});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(b=>{const x=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(b.split(";")[1].split("=")[1]);u[`${y}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Ae(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ae(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ae(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ae(n))return{data:null,error:n};throw n}}}function pk(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Va={debug:!!(globalThis&&wN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _N extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ML extends _N{}async function DL(t,e,n){Va.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Va.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Va.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{Va.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw Va.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new ML(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Va.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function LL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function SN(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function $L(t){return parseInt(t,16)}function FL(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function zL(t){var e;const{chainId:n,domain:s,expirationTime:r,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=SN(t.address),b=d?`${d}://${s}`:s,x=t.statement?`${t.statement}
`:"",y=`${b} wants you to sign in with your Ethereum account:
${p}

${x}`;let g=`URI: ${h}
Version: ${f}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(r&&(g+=`
Expiration Time: ${r.toISOString()}`),a&&(g+=`
Not Before: ${a.toISOString()}`),l&&(g+=`
Request ID: ${l}`),u){let m=`
Resources:`;for(const w of u){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);m+=`
- ${w}`}g+=m}return`${y}
${g}`}class en extends Error{constructor({message:e,code:n,cause:s,name:r}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=r??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class np extends en{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function BL({error:t,options:e}){var n,s,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new en({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new en({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new en({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new en({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new en({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new en({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new en({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new en({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(jN(o)){if(i.rp.id!==o)return new en({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new en({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new en({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new en({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new en({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function UL({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new en({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new en({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(jN(s)){if(n.rpId!==s)return new en({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new en({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new en({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new en({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class HL{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const WL=new HL;function VL(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,r=uc(t,["challenge","user","excludeCredentials"]),i=Cl(e).buffer,o=Object.assign(Object.assign({},n),{id:Cl(n.id).buffer}),a=Object.assign(Object.assign({},r),{challenge:i,user:o});if(s&&s.length>0){a.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const u=s[l];a.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:Cl(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function qL(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=uc(t,["challenge","allowCredentials"]),r=Cl(e).buffer,i=Object.assign(Object.assign({},s),{challenge:r});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const a=n[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:Cl(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function KL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Go(new Uint8Array(t.response.attestationObject)),clientDataJSON:Go(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function GL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Go(new Uint8Array(r.authenticatorData)),clientDataJSON:Go(new Uint8Array(r.clientDataJSON)),signature:Go(new Uint8Array(r.signature)),userHandle:r.userHandle?Go(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function jN(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function mk(){var t,e;return!!(bn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function YL(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new np("Browser returned unexpected credential type",e)}:{data:null,error:new np("Empty credential response",e)}}catch(e){return{data:null,error:BL({error:e,options:t})}}}async function QL(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new np("Browser returned unexpected credential type",e)}:{data:null,error:new np("Empty credential response",e)}}catch(e){return{data:null,error:UL({error:e,options:t})}}}const XL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},JL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function sp(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const i in r){const o=r[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(n(o))s[i]=o;else if(e(o)){const a=s[i];e(a)?s[i]=sp(a,o):s[i]=sp(o)}else s[i]=o}return s}function ZL(t,e){return sp(XL,t,e||{})}function e5(t,e){return sp(JL,t,e||{})}class t5{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:r},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!o)return{data:null,error:a};const l=r??WL.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=ZL(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:h}=await YL({publicKey:u,signal:l});return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=e5(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:h}=await QL(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(o){return Ae(o)?{data:null,error:o}:{data:null,error:new Ho("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Uu("rpId is required for WebAuthn authentication")};try{if(!mk())return{data:null,error:new Ho("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:r},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:s,credential_response:l.credential_response}})}catch(o){return Ae(o)?{data:null,error:o}:{data:null,error:new Ho("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Uu("rpId is required for WebAuthn registration")};try{if(!mk())return{data:null,error:new Ho("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:a};const{data:l,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:r},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Ae(o)?{data:null,error:o}:{data:null,error:new Ho("Unexpected error in register",o)}}}}LL();const n5={url:XD,storageKey:JD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ZD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function gk(t,e,n){return await n()}const qa={};class Hu{get jwks(){var e,n;return(n=(e=qa[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){qa[this.storageKey]=Object.assign(Object.assign({},qa[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=qa[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){qa[this.storageKey]=Object.assign(Object.assign({},qa[this.storageKey]),{cachedAt:e})}constructor(e){var n,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},n5),e);if(this.storageKey=i.storageKey,this.instanceID=(n=Hu.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Hu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&bn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new IL({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=kN(i.fetch),this.lock=i.lock||gk,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&bn()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=DL:this.lock=gk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new t5(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:wN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pk(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=pk(this.memoryStorage)),bn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${yN}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(bn()&&(n=pL(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),bn()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(n,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),iL(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ae(n)?this._returnResult({error:n}):this._returnResult({error:new Ho("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Zs}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,s,r;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,b=null;this.flowType==="pkce"&&([p,b]=await Ha(this.storage,this.storageKey)),i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:b},xform:Zs})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Zs})}else throw new bh("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return await vn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(await vn(this.storage,`${this.storageKey}-code-verifier`),Ae(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:hk})}else if("phone"in e){const{phone:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:hk})}else throw new bh("You must provide either an email or phone number and a password");const{data:s,error:r}=n;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const i=new Ua;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,r,i,o,a,l,u,d,h,f;let p,b;if("message"in e)p=e.message,b=e.signature;else{const{chain:x,wallet:y,statement:g,options:m}=e;let w;if(bn())if(typeof y=="object")w=y;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")w=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const k=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=SN(_[0]);let S=(s=m==null?void 0:m.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!S){const N=await w.request({method:"eth_chainId"});S=$L(N)}const j={domain:k.host,address:C,statement:g,uri:k.href,version:"1",chainId:S,nonce:(r=m==null?void 0:m.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(i=m==null?void 0:m.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=m==null?void 0:m.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=m==null?void 0:m.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=m==null?void 0:m.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=m==null?void 0:m.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=zL(j),b=await w.request({method:"personal_sign",params:[FL(p),C]})}try{const{data:x,error:y}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:b},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Zs});if(y)throw y;if(!x||!x.session||!x.user){const g=new Ua;return this._returnResult({data:{user:null,session:null},error:g})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:y})}catch(x){if(Ae(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(e){var n,s,r,i,o,a,l,u,d,h,f,p;let b,x;if("message"in e)b=e.message,x=e.signature;else{const{chain:y,wallet:g,statement:m,options:w}=e;let k;if(bn())if(typeof g=="object")k=g;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))k=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const _=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in k&&k.signIn){const C=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),m?{statement:m}:null));let S;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")S=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)S=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)b=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),x=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${_.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(r=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const C=await k.signMessage(new TextEncoder().encode(b),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=C}}try{const{data:y,error:g}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Go(x)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Zs});if(g)throw g;if(!y||!y.session||!y.user){const m=new Ua;return this._returnResult({data:{user:null,session:null},error:m})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:g})}catch(y){if(Ae(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const n=await Oo(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{if(!s&&this.flowType==="pkce")throw new oL;const{data:i,error:o}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Zs});if(await vn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new Ua;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}catch(i){if(await vn(this.storage,`${this.storageKey}-code-verifier`),Ae(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:i,nonce:o}=e,a=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Zs}),{data:l,error:u}=a;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Ua;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,r,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Ha(this.storage,this.storageKey));const{error:h}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:d}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new bh("You must provide either an email or phone number.")}catch(a){if(await vn(this.storage,`${this.storageKey}-code-verifier`),Ae(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,s;try{let r,i;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Zs});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var n,s,r,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await Ha(this.storage,this.storageKey));const u=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:RL});return!((i=u.data)===null||i===void 0)&&i.url&&bn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(a){if(await vn(this.storage,`${this.storageKey}-code-verifier`),Ae(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new ms;const{error:r}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(Ae(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:a}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new bh("You must provide either an email or phone number and a type")}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Oo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Xm:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Oo(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=eg()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=NL(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ai}):await this._useSession(async n=>{var s,r,i;const{data:o,error:a}=n;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ms}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:Ai})})}catch(n){if(Ae(n))return rL(n)&&(await this._removeSession(),await vn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new ms;const o=r.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ha(this.storage,this.storageKey));const{data:u,error:d}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ai});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await vn(this.storage,`${this.storageKey}-code-verifier`),Ae(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ms;const n=Date.now()/1e3;let s=n,r=!0,i=null;const{payload:o}=Zm(e.access_token);if(o.exp&&(s=o.exp,r=s<=n),r){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(Ae(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new ms;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Ae(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!bn())throw new wh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new wh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new ik("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wh("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ik("No code detected.");const{data:m,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new wh("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(a);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=tl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const b=f-h;d-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,f,d):d-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,f,d);const{data:x,error:y}=await this._getUser(i);if(y)throw y;const g={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Oo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({error:i});const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(sL(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await vn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=fL(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:i},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Ha(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await vn(this.storage,`${this.storageKey}-code-verifier`),Ae(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:r}=await this._useSession(async i=>{var o,a,l,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(r)throw r;return bn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Ae(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:r,data:{session:i}}=n;if(r)throw r;const{options:o,provider:a,token:l,access_token:u,nonce:d}=e,h=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:a,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Zs}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Ua}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(r){if(await vn(this.storage,`${this.storageKey}-code-verifier`),Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)throw o;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await xL(async r=>(r>0&&await gL(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Zs})),(r,i)=>{const o=200*Math.pow(2,r);return i&&Jm(i)&&Date.now()+o-s<tl})}catch(s){if(this._debug(n,"error",s),Ae(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),bn()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Oo(this.storage,this.storageKey);if(r&&this.userStorage){let o=await Oo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await nl(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:eg()}else if(r&&!r.user&&!r.user){const o=await Oo(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(r.user=o.user,await vn(this.storage,this.storageKey+"-user"),await nl(this.storage,this.storageKey,r)):r.user=eg()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const i=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Xm;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Xm}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),Jm(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(r.access_token);!a&&(o!=null&&o.user)?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new ms;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Hp;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new ms;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(r,"error",i),Ae(i)){const o={data:null,error:i};return Jm(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await vn(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await nl(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const i=uk(r);await nl(this.storage,this.storageKey,i)}else{const r=uk(n);await nl(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await vn(this.storage,this.storageKey),await vn(this.storage,this.storageKey+"-code-verifier"),await vn(this.storage,this.storageKey+"-user"),this.userStorage&&await vn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&bn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),tl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/tl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${tl}ms, refresh threshold is ${uy} ticks`),r<=uy&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof _N)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!bn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ha(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(a.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;return i?this._returnResult({data:null,error:i}):await ze(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&l.type==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?KL(e.webauthn.credential_response):GL(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:VL(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:qL(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Zm(s.access_token);let o=null;i.aal&&(o=i.aal);let a=o;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(a="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ms})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new ms});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&bn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new ms});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&bn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;return s?this._returnResult({data:null,error:s}):n?await ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new ms})})}catch(e){if(Ae(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?(await ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ms})})}catch(n){if(Ae(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(a=>a.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+tL>r)return s;const{data:i,error:o}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:p,error:b}=await this.getSession();if(b||!p.session)return this._returnResult({data:null,error:b});s=p.session.access_token}const{header:r,payload:i,signature:o,raw:{header:a,payload:l}}=Zm(s);n!=null&&n.allowExpired||SL(i.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:r,signature:o},error:null}}const d=jL(r.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,dL(`${a}.${l}`)))throw new fy("Invalid JWT signature");return{data:{claims:i,header:r,signature:o},error:null}}catch(s){if(Ae(s))return this._returnResult({data:null,error:s});throw s}}}Hu.nextInstanceID={};const s5=Hu,r5="2.88.0";let Yc="";typeof Deno<"u"?Yc="deno":typeof document<"u"?Yc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yc="react-native":Yc="node";const i5={"X-Client-Info":`supabase-js-${Yc}/${r5}`},o5={headers:i5},a5={schema:"public"},l5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},c5={};function Wu(t){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wu(t)}function u5(t,e){if(Wu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Wu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d5(t){var e=u5(t,"string");return Wu(e)=="symbol"?e:e+""}function h5(t,e,n){return(e=d5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Yt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xk(Object(n),!0).forEach(function(s){h5(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xk(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const f5=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),p5=()=>Headers,m5=(t,e,n)=>{const s=f5(n),r=p5();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:t;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(i,Yt(Yt({},o),{},{headers:u}))}};function g5(t){return t.endsWith("/")?t:t+"/"}function x5(t,e){var n,s;const{db:r,auth:i,realtime:o,global:a}=t,{db:l,auth:u,realtime:d,global:h}=e,f={db:Yt(Yt({},l),r),auth:Yt(Yt({},u),i),realtime:Yt(Yt({},d),o),storage:{},global:Yt(Yt(Yt({},h),a),{},{headers:Yt(Yt({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(s=a==null?void 0:a.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function y5(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(g5(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var v5=class extends s5{constructor(t){super(t)}},b5=class{constructor(t,e,n){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const i=y5(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a={db:a5,realtime:c5,auth:Yt(Yt({},l5),{},{storageKey:o}),global:o5},l=x5(n??{},a);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=l.global.headers)!==null&&r!==void 0?r:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=m5(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Yt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new ZM(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new QD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new GM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new v5({url:this.authUrl.href,headers:Yt(Yt({},f),d),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,flowType:o,lock:a,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new gD(this.realtimeUrl.href,Yt(Yt({},t),{},{params:Yt(Yt({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const w5=(t,e,n)=>new b5(t,e,n);function k5(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}k5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ea={SUPABASE_URL:window.SUPABASE_URL||void 0||"",SUPABASE_ANON_KEY:window.SUPABASE_ANON_KEY||void 0||"",API_BASE_URL:window.API_BASE_URL||void 0||""};let kh=null;function t0(){if(kh)return kh;const{SUPABASE_URL:t,SUPABASE_ANON_KEY:e}=Ea;return!t||!e?null:(kh=w5(t,e),kh)}const n0="authToken";function Ed(){return localStorage.getItem(n0)}function gl(t){t&&localStorage.setItem(n0,t)}function ci(){localStorage.removeItem(n0)}const Vu=3e4;let ng=!1,_h=null;function CN(t=Vu){const e=new AbortController,n=setTimeout(()=>e.abort(),t);return{controller:e,clear:()=>clearTimeout(n)}}async function NN(){var r;const t=Ed();if(t)return t;const e=t0();if(!e)return null;const{data:n}=await e.auth.getSession(),s=((r=n==null?void 0:n.session)==null?void 0:r.access_token)||null;return s&&gl(s),s}async function EN(){return ng||(ng=!0,_h=(async()=>{var t;try{const e=t0();if(!e)return null;const{data:n,error:s}=await e.auth.refreshSession();return s||!((t=n.session)!=null&&t.access_token)?null:(gl(n.session.access_token),n.session.access_token)}catch(e){return console.error("Token refresh failed:",e),null}finally{ng=!1,_h=null}})()),_h}async function Oe(t,e={}){const{baseUrl:n,timeout:s,...r}=e,i=`${n??Ea.API_BASE_URL}${t}`,o=new Headers(r.headers||{});!(r.body instanceof FormData)&&!o.has("Content-Type")&&o.set("Content-Type","application/json");const l=await NN();l&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${l}`);const u=s!==0&&s!==!1,{controller:d,clear:h}=u?CN(s||Vu):{controller:null,clear:()=>{}};try{let f=await fetch(i,{...r,headers:o,signal:d==null?void 0:d.signal});if(f.status===401){const b=await EN();if(b){if(o.set("Authorization",`Bearer ${b}`),f=await fetch(i,{...r,headers:o,signal:d==null?void 0:d.signal}),!(f.ok||f.status!==401))return ci(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return ci(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!f.ok){const b=await f.json().catch(()=>({detail:"Request failed"})),x=new Error(b.detail||b.error||`Request failed: ${f.status}`);throw x.status=f.status,x.data=b,x}return f.status===204?null:(f.headers.get("content-type")||"").includes("application/json")?f.json():f}catch(f){if(f.name==="AbortError"){const p=new Error(`Request timed out after ${s||Vu}ms`);throw p.status=408,p.isTimeout=!0,p}throw f}finally{h()}}async function TN(t,e={}){const{baseUrl:n,timeout:s,...r}=e,i=`${n??Ea.API_BASE_URL}${t}`,o=new Headers(r.headers||{}),a=await NN();a&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${a}`);const l=s!==0&&s!==!1,{controller:u,clear:d}=l?CN(s||Vu):{controller:null,clear:()=>{}};try{let h=await fetch(i,{...r,headers:o,signal:u==null?void 0:u.signal});if(h.status===401){const f=await EN();if(f){if(o.set("Authorization",`Bearer ${f}`),h=await fetch(i,{...r,headers:o,signal:u==null?void 0:u.signal}),!(h.ok||h.status!==401))return ci(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return ci(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!h.ok){const f=await h.json().catch(()=>({detail:"Request failed"})),p=new Error(f.detail||f.error||`Request failed: ${h.status}`);throw p.status=h.status,p.data=f,p}return h.blob()}catch(h){if(h.name==="AbortError"){const f=new Error(`Request timed out after ${s||Vu}ms`);throw f.status=408,f.isTimeout=!0,f}throw h}finally{d()}}const PN=v.createContext(null),sg={system_admin:["admin","hos","sales_person"],sales_manager:["hos","sales_person"],sales_user:["sales_person"],coordinator:["coordinator"],finance:["finance"],viewer:["viewer"]},_5={"admin@mmg.com":{password:"admin123",id:"dev-admin-1",name:"Sales Admin",email:"admin@mmg.com",roles:["admin","hos","sales_person"]},"hos@mmg.com":{password:"hos123",id:"dev-hos-1",name:"Head of Sales",email:"hos@mmg.com",roles:["hos","sales_person"]},"sales@mmg.com":{password:"sales123",id:"dev-sales-1",name:"Sales Person",email:"sales@mmg.com",roles:["sales_person"]}};function rg(t){return Array.from(new Set((t||[]).filter(Boolean).map(e=>String(e).toLowerCase())))}function yk(t=[]){return t.map(e=>String(e||"").replaceAll(".",":"))}function S5(t){return(t||"sales_user").toLowerCase()}function vk(t,e){var n,s,r,i,o,a,l,u,d;return((n=t==null?void 0:t.user_metadata)==null?void 0:n.full_name)||((s=t==null?void 0:t.user_metadata)==null?void 0:s.name)||((o=(i=(r=t==null?void 0:t.identities)==null?void 0:r[0])==null?void 0:i.identity_data)==null?void 0:o.full_name)||((u=(l=(a=t==null?void 0:t.identities)==null?void 0:a[0])==null?void 0:l.identity_data)==null?void 0:u.name)||((d=t==null?void 0:t.email)==null?void 0:d.split("@")[0])||e||"User"}function gf(t,e){const n=(t==null?void 0:t.permissions)||[];if(!n.length)return!1;const s=u=>String(u||"").trim().replaceAll(".",":"),r=n.map(s),i=s(e);if(r.includes("*:*:*"))return!0;const[o,a,l]=i.split(":");return r.some(u=>{const[d,h,f]=u.split(":");return u===i?!0:(d==="*"||d===o)&&(h==="*"||h===a)&&(f==="*"||f===l||f==="manage")})}function Td(t){var e,n,s;return((e=t==null?void 0:t.roles)==null?void 0:e.includes("admin"))||((s=(n=t==null?void 0:t.profile)==null?void 0:n.toLowerCase)==null?void 0:s.call(n))==="system_admin"||gf(t,"*:*:*")||gf(t,"core:*:*")||gf(t,"core:system:admin")}function j5({children:t}){const e=t0(),n=!e&&window.location.hostname==="localhost",[s,r]=v.useState(null),[i,o]=v.useState(()=>{const m=localStorage.getItem("mmg_user")||localStorage.getItem("userData");return m?JSON.parse(m):null}),[a,l]=v.useState(!1),[u,d]=v.useState(null);v.useEffect(()=>{const m=window.location.hash;if(!m||!m.includes("error="))return;const w=new URLSearchParams(m.substring(1)),k=w.get("error"),_=w.get("error_code"),C=w.get("error_description");if(k){let S=C?decodeURIComponent(C.replace(/\+/g," ")):"Authentication failed";_==="otp_expired"?S="Email link has expired. Please sign up again to receive a new confirmation email.":_==="access_denied"&&(S="Access denied. The link may have expired or already been used."),setTimeout(()=>alert(S),300),window.history.replaceState(null,"",window.location.pathname+window.location.search)}},[]),v.useEffect(()=>{let m=null;async function w(){console.log("[Auth] init() starting");try{if(!e){console.log("[Auth] No supabase client - dev mode");const C=localStorage.getItem("mmg_user")||localStorage.getItem("userData");C&&o(JSON.parse(C)),l(!0),console.log("[Auth] Dev mode ready");return}console.log("[Auth] Getting supabase session...");const{data:k}=await e.auth.getSession(),_=(k==null?void 0:k.session)||null;console.log("[Auth] Session retrieved",{hasSession:!!_,hasToken:!!(_!=null&&_.access_token)}),r(_||null),l(!0),console.log("[Auth] authReady set to true"),_||(console.log("[Auth] No session - clearing auth"),ci(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData")),_!=null&&_.access_token&&gl(_.access_token),_!=null&&_.access_token&&(console.log("[Auth] Starting background profile refresh"),h(_.access_token,_.user).catch(console.error)),m=e.auth.onAuthStateChange(async(C,S)=>{if(console.log("[Auth] onAuthStateChange",{event:C,hasSession:!!S}),C==="INITIAL_SESSION"){console.log("[Auth] Skipping INITIAL_SESSION (already handled)");return}r(S||null),S!=null&&S.access_token?(gl(S.access_token),u||(console.log("[Auth] Auth state change - refreshing profile"),h(S.access_token,S.user).catch(console.error))):(console.log("[Auth] Auth state change - no session, clearing"),ci(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"))}).data.subscription}catch(k){console.log("[Auth] init() error",k),l(!0)}}return w(),()=>{var k;return(k=m==null?void 0:m.unsubscribe)==null?void 0:k.call(m)}},[e,u]),v.useEffect(()=>{const m=()=>{d(null),y()};return window.addEventListener("auth:logout",m),()=>window.removeEventListener("auth:logout",m)},[]);async function h(m,w=null){var k,_,C,S;console.log("[Auth] refreshProfile() starting");try{console.log("[Auth] Fetching /api/base/auth/me...");const j=await Oe("/api/base/auth/me",{headers:{Authorization:`Bearer ${m}`}});if(console.log("[Auth] /api/base/auth/me response received",{hasProfile:!!j}),!j)return console.log("[Auth] No profile returned"),null;const N=S5((j==null?void 0:j.profile_name)||(j==null?void 0:j.profile)||(j==null?void 0:j.profileName)),R=sg[N]||["sales_person"],M=(j==null?void 0:j.roles)||(j==null?void 0:j.rbac_roles)||(j==null?void 0:j.user_roles)||[],O={id:(j==null?void 0:j.id)||(w==null?void 0:w.id),email:(j==null?void 0:j.email)||(w==null?void 0:w.email),name:(j==null?void 0:j.name)||vk(w,N),profile:N,profile_name:N,roles:rg([...R,...M]),permissions:yk((j==null?void 0:j.permissions)||[]),raw:j};return console.log("[Auth] Profile loaded, setting user",{email:O.email,roles:O.roles}),o(O),localStorage.setItem("mmg_user",JSON.stringify(O)),localStorage.setItem("userData",JSON.stringify(O)),d(null),O}catch(j){if(console.log("[Auth] refreshProfile error",j),(j==null?void 0:j.status)===403&&((k=j==null?void 0:j.data)!=null&&k.requiresLogout)){const N=(w==null?void 0:w.email)||(i==null?void 0:i.email)||"";return((_=j==null?void 0:j.data)==null?void 0:_.code)==="USER_PENDING_APPROVAL"?(d({pending:!0,email:N,message:((C=j==null?void 0:j.data)==null?void 0:C.error)||"Your account is pending administrator approval."}),null):(await y(),null)}if(w){console.log("[Auth] Using fallback session user data");const N=((S=w.user_metadata)==null?void 0:S.profile)||"sales_user",R=sg[N]||["sales_person"],M={id:w.id,email:w.email,name:vk(w,N),profile:N,profile_name:N,roles:rg(R),permissions:[],raw:w};return console.log("[Auth] Fallback user set",{email:M.email}),o(M),localStorage.setItem("mmg_user",JSON.stringify(M)),localStorage.setItem("userData",JSON.stringify(M)),d(null),M}return console.log("[Auth] No fallback available, returning null"),null}}async function f(){return s!=null&&s.access_token?s.access_token:localStorage.getItem("authToken")}async function p({email:m,password:w}){var C;if(d(null),!e){if(!n)throw new Error("Supabase not configured");const S=_5[m.toLowerCase()];if(!S||S.password!==w)throw new Error("Invalid email or password");const j=S.profile||((C=S.roles)!=null&&C.includes("admin")?"system_admin":"sales_user"),N=rg(S.roles||sg[j]||["sales_person"]),R={id:S.id,email:S.email,name:S.name,profile:j,profile_name:j,roles:N,permissions:yk(S.permissions||[]),raw:S},M=`dev-token-${Date.now()}`;return gl(M),o(R),localStorage.setItem("mmg_user",JSON.stringify(R)),localStorage.setItem("userData",JSON.stringify(R)),R}const{data:k,error:_}=await e.auth.signInWithPassword({email:m,password:w});if(_)throw _;return gl(k.session.access_token),await h(k.session.access_token,k.session.user),k}async function b(){if(!e)throw new Error("Supabase not configured. Please contact your administrator.");const m=C5(),{data:w,error:k}=await e.auth.signInWithOAuth({provider:"azure",options:{scopes:"email profile openid",redirectTo:m}});if(k)throw k;return w}async function x({token:m,email:w,password:k,fullName:_}){var N;if(!e)throw new Error("Supabase not configured");const C=await Oe("/api/base/auth/validate-invite",{method:"POST",body:JSON.stringify({token:m,email:w})}),{data:S,error:j}=await e.auth.signUp({email:w,password:k,options:{data:{full_name:_,profile:(C==null?void 0:C.profile_name)||"sales_user"}}});if(j)throw j;return await Oe("/api/base/auth/consume-invite",{method:"POST",body:JSON.stringify({token:m,email:w,supabase_user_id:(N=S==null?void 0:S.user)==null?void 0:N.id,profile_name:C==null?void 0:C.profile_name,name:_})}),S}async function y(){try{e&&await e.auth.signOut()}finally{ci(),r(null),o(null),d(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"),sessionStorage.removeItem("msSsoPending")}}const g=v.useMemo(()=>({authReady:a,user:i,session:s,pendingAccess:u,getAccessToken:f,signInWithPassword:p,signInWithMicrosoft:b,signUpWithInvite:x,refreshProfile:h,logout:y}),[a,i,s,u]);return c.jsx(PN.Provider,{value:g,children:t})}function mi(){const t=v.useContext(PN);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function C5(){const t=`${window.location.protocol}//${window.location.host}`,e=window.SUPABASE_REDIRECT_URL||void 0||"";return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?`${t}/auth/callback`:`${(e||t).replace(/\/$/,"")}/auth/callback`}function N5(){const{signInWithMicrosoft:t}=mi(),e=jd(),n=lc(),s=v.useMemo(()=>{var h;return((h=n.state)==null?void 0:h.from)||"/app/chat"},[n.state]),[r,i]=v.useState(""),[o,a]=v.useState(!1),{user:l,authReady:u}=mi();v.useEffect(()=>{u&&l&&e(s,{replace:!0})},[u,l,s,e]);async function d(){if(!o){i("");try{a(!0),sessionStorage.setItem("postAuthRedirect",s||"/app/chat"),await new Promise(h=>requestAnimationFrame(h)),await t()}catch(h){i((h==null?void 0:h.message)||"SSO failed"),a(!1)}}}return c.jsxs("div",{className:"min-h-screen px-4 py-8 flex items-center justify-center",children:[c.jsx("div",{className:"mmg-particle one"}),c.jsx("div",{className:"mmg-particle two"}),c.jsx("div",{className:"mmg-particle three"}),c.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 lg:grid-cols-[420px_1fr] gap-6 items-stretch",children:[c.jsxs(vt,{className:"self-center",children:[c.jsxs(Lt,{className:"text-center",children:[c.jsx("div",{className:"flex items-center justify-center mb-5",children:c.jsx(lN,{size:96})}),c.jsx("p",{className:"text-sm text-black/60 dark:text-white/65",children:"Sign in to continue to your workspace"})]}),c.jsx($t,{children:c.jsxs("div",{className:"space-y-3",children:[r?c.jsx("div",{className:"text-sm text-red-700 rounded-2xl px-4 py-2 bg-black/5 dark:bg-white/10",children:r}):null,c.jsx(te,{variant:"secondary",size:"lg",className:"w-full justify-center gap-2",onClick:d,disabled:o,children:o?c.jsx(Ye,{text:"Signing you in"}):c.jsxs(c.Fragment,{children:[c.jsx(HI,{size:18}),"Sign in with Microsoft"]})})]})})]}),c.jsx("div",{className:"rounded-3xl min-h-[240px] lg:min-h-[520px]","aria-hidden":"true"})]})]})}function RN({email:t,message:e,onSignOut:n}){return c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsxs("div",{className:"w-full max-w-[520px] space-y-4 rounded-2xl bg-white/60 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 p-6 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:"Access Pending"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:e||"Your account is pending administrator approval."}),t?c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:["Signed in as ",c.jsx("strong",{children:t})]}):null,c.jsx("div",{className:"flex justify-center pt-2",children:c.jsx(te,{variant:"secondary",onClick:n,children:"Sign Out"})})]})})}function E5(){const t=jd(),{authReady:e,session:n,user:s,pendingAccess:r,logout:i}=mi();return v.useEffect(()=>{if(e&&!n){t("/login",{replace:!0});return}if(e&&n&&s){const o=sessionStorage.getItem("postAuthRedirect")||"/app/chat";sessionStorage.removeItem("postAuthRedirect"),t(o,{replace:!0})}},[e,n,s,t]),e&&r?c.jsx(RN,{email:r.email,message:r.message,onSignOut:i}):c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ye,{text:"Loading"})})})}function AN(){const{theme:t,setTheme:e}=eI(),n=t==="dark";return c.jsx(te,{variant:"ghost",size:"icon","aria-label":"Toggle theme",onClick:()=>e(n?"light":"dark"),title:"Toggle theme",className:"rounded-2xl",children:n?c.jsx(JI,{size:18}):c.jsx(KI,{size:18})})}function tt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Pd(t,e=[]){let n=[];function s(i,o){const a=v.createContext(o),l=n.length;n=[...n,o];const u=h=>{var g;const{scope:f,children:p,...b}=h,x=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,y=v.useMemo(()=>b,Object.values(b));return c.jsx(x.Provider,{value:y,children:p})};u.displayName=i+"Provider";function d(h,f){var x;const p=((x=f==null?void 0:f[t])==null?void 0:x[l])||a,b=v.useContext(p);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const r=()=>{const i=n.map(o=>v.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[s,T5(r,...e)]}function T5(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:u})=>{const h=l(i)[`__scope${u}`];return{...a,...h}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var fo=globalThis!=null&&globalThis.document?v.useLayoutEffect:()=>{},P5=jp[" useInsertionEffect ".trim().toString()]||fo;function ON({prop:t,defaultProp:e,onChange:n=()=>{},caller:s}){const[r,i,o]=R5({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const d=v.useRef(t!==void 0);v.useEffect(()=>{const h=d.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=a},[a,s])}const u=v.useCallback(d=>{var h;if(a){const f=A5(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[a,t,i,o]);return[l,u]}function R5({defaultProp:t,onChange:e}){const[n,s]=v.useState(t),r=v.useRef(n),i=v.useRef(e);return P5(()=>{i.current=e},[e]),v.useEffect(()=>{var o;r.current!==n&&((o=i.current)==null||o.call(i,n),r.current=n)},[n,r]),[n,s,i]}function A5(t){return typeof t=="function"}function O5(t){const e=I5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(D5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function I5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=$5(r),a=L5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Na(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var M5=Symbol("radix.slottable");function D5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===M5}function L5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function $5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var F5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wn=F5.reduce((t,e)=>{const n=O5(`Primitive.${e}`),s=v.forwardRef((r,i)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function IN(t,e){t&&kd.flushSync(()=>t.dispatchEvent(e))}function bk(t){const e=z5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(U5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function z5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=W5(r),a=H5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Na(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var B5=Symbol("radix.slottable");function U5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===B5}function H5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function W5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function MN(t){const e=t+"CollectionProvider",[n,s]=Pd(e),[r,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:y,children:g}=x,m=ge.useRef(null),w=ge.useRef(new Map).current;return c.jsx(r,{scope:y,itemMap:w,collectionRef:m,children:g})};o.displayName=e;const a=t+"CollectionSlot",l=bk(a),u=ge.forwardRef((x,y)=>{const{scope:g,children:m}=x,w=i(a,g),k=us(y,w.collectionRef);return c.jsx(l,{ref:k,children:m})});u.displayName=a;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=bk(d),p=ge.forwardRef((x,y)=>{const{scope:g,children:m,...w}=x,k=ge.useRef(null),_=us(y,k),C=i(d,g);return ge.useEffect(()=>(C.itemMap.set(k,{ref:k,...w}),()=>void C.itemMap.delete(k))),c.jsx(f,{[h]:"",ref:_,children:m})});p.displayName=d;function b(x){const y=i(t+"CollectionConsumer",x);return ge.useCallback(()=>{const m=y.collectionRef.current;if(!m)return[];const w=Array.from(m.querySelectorAll(`[${h}]`));return Array.from(y.itemMap.values()).sort((C,S)=>w.indexOf(C.ref.current)-w.indexOf(S.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:u,ItemSlot:p},b,s]}var V5=v.createContext(void 0);function DN(t){const e=v.useContext(V5);return t||e||"ltr"}function gi(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function q5(t,e=globalThis==null?void 0:globalThis.document){const n=gi(t);v.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var K5="DismissableLayer",py="dismissableLayer.update",G5="dismissableLayer.pointerDownOutside",Y5="dismissableLayer.focusOutside",wk,LN=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$N=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,u=v.useContext(LN),[d,h]=v.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=v.useState({}),b=us(e,S=>h(S)),x=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),g=x.indexOf(y),m=d?x.indexOf(d):-1,w=u.layersWithOutsidePointerEventsDisabled.size>0,k=m>=g,_=J5(S=>{const j=S.target,N=[...u.branches].some(R=>R.contains(j));!k||N||(r==null||r(S),o==null||o(S),S.defaultPrevented||a==null||a())},f),C=Z5(S=>{const j=S.target;[...u.branches].some(R=>R.contains(j))||(i==null||i(S),o==null||o(S),S.defaultPrevented||a==null||a())},f);return q5(S=>{m===u.layers.size-1&&(s==null||s(S),!S.defaultPrevented&&a&&(S.preventDefault(),a()))},f),v.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(wk=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),kk(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=wk)}},[d,f,n,u]),v.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),kk())},[d,u]),v.useEffect(()=>{const S=()=>p({});return document.addEventListener(py,S),()=>document.removeEventListener(py,S)},[]),c.jsx(Wn.div,{...l,ref:b,style:{pointerEvents:w?k?"auto":"none":void 0,...t.style},onFocusCapture:tt(t.onFocusCapture,C.onFocusCapture),onBlurCapture:tt(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:tt(t.onPointerDownCapture,_.onPointerDownCapture)})});$N.displayName=K5;var Q5="DismissableLayerBranch",X5=v.forwardRef((t,e)=>{const n=v.useContext(LN),s=v.useRef(null),r=us(e,s);return v.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),c.jsx(Wn.div,{...t,ref:r})});X5.displayName=Q5;function J5(t,e=globalThis==null?void 0:globalThis.document){const n=gi(t),s=v.useRef(!1),r=v.useRef(()=>{});return v.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){FN(G5,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function Z5(t,e=globalThis==null?void 0:globalThis.document){const n=gi(t),s=v.useRef(!1);return v.useEffect(()=>{const r=i=>{i.target&&!s.current&&FN(Y5,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function kk(){const t=new CustomEvent(py);document.dispatchEvent(t)}function FN(t,e,n,{discrete:s}){const r=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?IN(r,i):r.dispatchEvent(i)}var ig=0;function e$(){v.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??_k()),document.body.insertAdjacentElement("beforeend",t[1]??_k()),ig++,()=>{ig===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),ig--}},[])}function _k(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var og="focusScope.autoFocusOnMount",ag="focusScope.autoFocusOnUnmount",Sk={bubbles:!1,cancelable:!0},t$="FocusScope",zN=v.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:i,...o}=t,[a,l]=v.useState(null),u=gi(r),d=gi(i),h=v.useRef(null),f=us(e,x=>l(x)),p=v.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;v.useEffect(()=>{if(s){let x=function(w){if(p.paused||!a)return;const k=w.target;a.contains(k)?h.current=k:Ci(h.current,{select:!0})},y=function(w){if(p.paused||!a)return;const k=w.relatedTarget;k!==null&&(a.contains(k)||Ci(h.current,{select:!0}))},g=function(w){if(document.activeElement===document.body)for(const _ of w)_.removedNodes.length>0&&Ci(a)};document.addEventListener("focusin",x),document.addEventListener("focusout",y);const m=new MutationObserver(g);return a&&m.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",y),m.disconnect()}}},[s,a,p.paused]),v.useEffect(()=>{if(a){Ck.add(p);const x=document.activeElement;if(!a.contains(x)){const g=new CustomEvent(og,Sk);a.addEventListener(og,u),a.dispatchEvent(g),g.defaultPrevented||(n$(a$(BN(a)),{select:!0}),document.activeElement===x&&Ci(a))}return()=>{a.removeEventListener(og,u),setTimeout(()=>{const g=new CustomEvent(ag,Sk);a.addEventListener(ag,d),a.dispatchEvent(g),g.defaultPrevented||Ci(x??document.body,{select:!0}),a.removeEventListener(ag,d),Ck.remove(p)},0)}}},[a,u,d,p]);const b=v.useCallback(x=>{if(!n&&!s||p.paused)return;const y=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,g=document.activeElement;if(y&&g){const m=x.currentTarget,[w,k]=s$(m);w&&k?!x.shiftKey&&g===k?(x.preventDefault(),n&&Ci(w,{select:!0})):x.shiftKey&&g===w&&(x.preventDefault(),n&&Ci(k,{select:!0})):g===m&&x.preventDefault()}},[n,s,p.paused]);return c.jsx(Wn.div,{tabIndex:-1,...o,ref:f,onKeyDown:b})});zN.displayName=t$;function n$(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(Ci(s,{select:e}),document.activeElement!==n)return}function s$(t){const e=BN(t),n=jk(e,t),s=jk(e.reverse(),t);return[n,s]}function BN(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function jk(t,e){for(const n of t)if(!r$(n,{upTo:e}))return n}function r$(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function i$(t){return t instanceof HTMLInputElement&&"select"in t}function Ci(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&i$(t)&&e&&t.select()}}var Ck=o$();function o$(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Nk(t,e),t.unshift(e)},remove(e){var n;t=Nk(t,e),(n=t[0])==null||n.resume()}}}function Nk(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function a$(t){return t.filter(e=>e.tagName!=="A")}var l$=jp[" useId ".trim().toString()]||(()=>{}),c$=0;function my(t){const[e,n]=v.useState(l$());return fo(()=>{n(s=>s??String(c$++))},[t]),e?`radix-${e}`:""}const u$=["top","right","bottom","left"],po=Math.min,vs=Math.max,rp=Math.round,Sh=Math.floor,$r=t=>({x:t,y:t}),d$={left:"right",right:"left",bottom:"top",top:"bottom"},h$={start:"end",end:"start"};function gy(t,e,n){return vs(t,po(e,n))}function xi(t,e){return typeof t=="function"?t(e):t}function yi(t){return t.split("-")[0]}function dc(t){return t.split("-")[1]}function s0(t){return t==="x"?"y":"x"}function r0(t){return t==="y"?"height":"width"}const f$=new Set(["top","bottom"]);function Ir(t){return f$.has(yi(t))?"y":"x"}function i0(t){return s0(Ir(t))}function p$(t,e,n){n===void 0&&(n=!1);const s=dc(t),r=i0(t),i=r0(r);let o=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=ip(o)),[o,ip(o)]}function m$(t){const e=ip(t);return[xy(t),e,xy(e)]}function xy(t){return t.replace(/start|end/g,e=>h$[e])}const Ek=["left","right"],Tk=["right","left"],g$=["top","bottom"],x$=["bottom","top"];function y$(t,e,n){switch(t){case"top":case"bottom":return n?e?Tk:Ek:e?Ek:Tk;case"left":case"right":return e?g$:x$;default:return[]}}function v$(t,e,n,s){const r=dc(t);let i=y$(yi(t),n==="start",s);return r&&(i=i.map(o=>o+"-"+r),e&&(i=i.concat(i.map(xy)))),i}function ip(t){return t.replace(/left|right|bottom|top/g,e=>d$[e])}function b$(t){return{top:0,right:0,bottom:0,left:0,...t}}function UN(t){return typeof t!="number"?b$(t):{top:t,right:t,bottom:t,left:t}}function op(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function Pk(t,e,n){let{reference:s,floating:r}=t;const i=Ir(e),o=i0(e),a=r0(o),l=yi(e),u=i==="y",d=s.x+s.width/2-r.width/2,h=s.y+s.height/2-r.height/2,f=s[a]/2-r[a]/2;let p;switch(l){case"top":p={x:d,y:s.y-r.height};break;case"bottom":p={x:d,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:h};break;case"left":p={x:s.x-r.width,y:h};break;default:p={x:s.x,y:s.y}}switch(dc(e)){case"start":p[o]-=f*(n&&u?-1:1);break;case"end":p[o]+=f*(n&&u?-1:1);break}return p}const w$=async(t,e,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:d,y:h}=Pk(u,s,l),f=s,p={},b=0;for(let x=0;x<a.length;x++){const{name:y,fn:g}=a[x],{x:m,y:w,data:k,reset:_}=await g({x:d,y:h,initialPlacement:s,placement:f,strategy:r,middlewareData:p,rects:u,platform:o,elements:{reference:t,floating:e}});d=m??d,h=w??h,p={...p,[y]:{...p[y],...k}},_&&b<=50&&(b++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(u=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):_.rects),{x:d,y:h}=Pk(u,f,l)),x=-1)}return{x:d,y:h,placement:f,strategy:r,middlewareData:p}};async function qu(t,e){var n;e===void 0&&(e={});const{x:s,y:r,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=xi(e,t),b=UN(p),y=a[f?h==="floating"?"reference":"floating":h],g=op(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:u,rootBoundary:d,strategy:l})),m=h==="floating"?{x:s,y:r,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),k=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},_=op(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:m,offsetParent:w,strategy:l}):m);return{top:(g.top-_.top+b.top)/k.y,bottom:(_.bottom-g.bottom+b.bottom)/k.y,left:(g.left-_.left+b.left)/k.x,right:(_.right-g.right+b.right)/k.x}}const k$=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:r,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:d=0}=xi(t,e)||{};if(u==null)return{};const h=UN(d),f={x:n,y:s},p=i0(r),b=r0(p),x=await o.getDimensions(u),y=p==="y",g=y?"top":"left",m=y?"bottom":"right",w=y?"clientHeight":"clientWidth",k=i.reference[b]+i.reference[p]-f[p]-i.floating[b],_=f[p]-i.reference[p],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let S=C?C[w]:0;(!S||!await(o.isElement==null?void 0:o.isElement(C)))&&(S=a.floating[w]||i.floating[b]);const j=k/2-_/2,N=S/2-x[b]/2-1,R=po(h[g],N),M=po(h[m],N),O=R,D=S-x[b]-M,$=S/2-x[b]/2+j,L=gy(O,$,D),U=!l.arrow&&dc(r)!=null&&$!==L&&i.reference[b]/2-($<O?R:M)-x[b]/2<0,W=U?$<O?$-O:$-D:0;return{[p]:f[p]+W,data:{[p]:L,centerOffset:$-L-W,...U&&{alignmentOffset:W}},reset:U}}}),_$=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:r,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:x=!0,...y}=xi(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const g=yi(r),m=Ir(a),w=yi(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(u.floating)),_=f||(w||!x?[ip(a)]:m$(a)),C=b!=="none";!f&&C&&_.push(...v$(a,x,b,k));const S=[a,..._],j=await qu(e,y),N=[];let R=((s=i.flip)==null?void 0:s.overflows)||[];if(d&&N.push(j[g]),h){const $=p$(r,o,k);N.push(j[$[0]],j[$[1]])}if(R=[...R,{placement:r,overflows:N}],!N.every($=>$<=0)){var M,O;const $=(((M=i.flip)==null?void 0:M.index)||0)+1,L=S[$];if(L&&(!(h==="alignment"?m!==Ir(L):!1)||R.every(E=>Ir(E.placement)===m?E.overflows[0]>0:!0)))return{data:{index:$,overflows:R},reset:{placement:L}};let U=(O=R.filter(W=>W.overflows[0]<=0).sort((W,E)=>W.overflows[1]-E.overflows[1])[0])==null?void 0:O.placement;if(!U)switch(p){case"bestFit":{var D;const W=(D=R.filter(E=>{if(C){const P=Ir(E.placement);return P===m||P==="y"}return!0}).map(E=>[E.placement,E.overflows.filter(P=>P>0).reduce((P,A)=>P+A,0)]).sort((E,P)=>E[1]-P[1])[0])==null?void 0:D[0];W&&(U=W);break}case"initialPlacement":U=a;break}if(r!==U)return{reset:{placement:U}}}return{}}}};function Rk(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Ak(t){return u$.some(e=>t[e]>=0)}const S$=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...r}=xi(t,e);switch(s){case"referenceHidden":{const i=await qu(e,{...r,elementContext:"reference"}),o=Rk(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Ak(o)}}}case"escaped":{const i=await qu(e,{...r,altBoundary:!0}),o=Rk(i,n.floating);return{data:{escapedOffsets:o,escaped:Ak(o)}}}default:return{}}}}},HN=new Set(["left","top"]);async function j$(t,e){const{placement:n,platform:s,elements:r}=t,i=await(s.isRTL==null?void 0:s.isRTL(r.floating)),o=yi(n),a=dc(n),l=Ir(n)==="y",u=HN.has(o)?-1:1,d=i&&l?-1:1,h=xi(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:b}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof b=="number"&&(p=a==="end"?b*-1:b),l?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const C$=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:r,y:i,placement:o,middlewareData:a}=e,l=await j$(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:i+l.y,data:{...l,placement:o}}}}},N$=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:g,y:m}=y;return{x:g,y:m}}},...l}=xi(t,e),u={x:n,y:s},d=await qu(e,l),h=Ir(yi(r)),f=s0(h);let p=u[f],b=u[h];if(i){const y=f==="y"?"top":"left",g=f==="y"?"bottom":"right",m=p+d[y],w=p-d[g];p=gy(m,p,w)}if(o){const y=h==="y"?"top":"left",g=h==="y"?"bottom":"right",m=b+d[y],w=b-d[g];b=gy(m,b,w)}const x=a.fn({...e,[f]:p,[h]:b});return{...x,data:{x:x.x-n,y:x.y-s,enabled:{[f]:i,[h]:o}}}}}},E$=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:r,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=xi(t,e),d={x:n,y:s},h=Ir(r),f=s0(h);let p=d[f],b=d[h];const x=xi(a,e),y=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(l){const w=f==="y"?"height":"width",k=i.reference[f]-i.floating[w]+y.mainAxis,_=i.reference[f]+i.reference[w]-y.mainAxis;p<k?p=k:p>_&&(p=_)}if(u){var g,m;const w=f==="y"?"width":"height",k=HN.has(yi(r)),_=i.reference[h]-i.floating[w]+(k&&((g=o.offset)==null?void 0:g[h])||0)+(k?0:y.crossAxis),C=i.reference[h]+i.reference[w]+(k?0:((m=o.offset)==null?void 0:m[h])||0)-(k?y.crossAxis:0);b<_?b=_:b>C&&(b=C)}return{[f]:p,[h]:b}}}},T$=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:r,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...u}=xi(t,e),d=await qu(e,u),h=yi(r),f=dc(r),p=Ir(r)==="y",{width:b,height:x}=i.floating;let y,g;h==="top"||h==="bottom"?(y=h,g=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(g=h,y=f==="end"?"top":"bottom");const m=x-d.top-d.bottom,w=b-d.left-d.right,k=po(x-d[y],m),_=po(b-d[g],w),C=!e.middlewareData.shift;let S=k,j=_;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(j=w),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(S=m),C&&!f){const R=vs(d.left,0),M=vs(d.right,0),O=vs(d.top,0),D=vs(d.bottom,0);p?j=b-2*(R!==0||M!==0?R+M:vs(d.left,d.right)):S=x-2*(O!==0||D!==0?O+D:vs(d.top,d.bottom))}await l({...e,availableWidth:j,availableHeight:S});const N=await o.getDimensions(a.floating);return b!==N.width||x!==N.height?{reset:{rects:!0}}:{}}}};function Wp(){return typeof window<"u"}function hc(t){return WN(t)?(t.nodeName||"").toLowerCase():"#document"}function js(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function zr(t){var e;return(e=(WN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function WN(t){return Wp()?t instanceof Node||t instanceof js(t).Node:!1}function dr(t){return Wp()?t instanceof Element||t instanceof js(t).Element:!1}function Fr(t){return Wp()?t instanceof HTMLElement||t instanceof js(t).HTMLElement:!1}function Ok(t){return!Wp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof js(t).ShadowRoot}const P$=new Set(["inline","contents"]);function Rd(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=hr(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!P$.has(r)}const R$=new Set(["table","td","th"]);function A$(t){return R$.has(hc(t))}const O$=[":popover-open",":modal"];function Vp(t){return O$.some(e=>{try{return t.matches(e)}catch{return!1}})}const I$=["transform","translate","scale","rotate","perspective"],M$=["transform","translate","scale","rotate","perspective","filter"],D$=["paint","layout","strict","content"];function o0(t){const e=a0(),n=dr(t)?hr(t):t;return I$.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||M$.some(s=>(n.willChange||"").includes(s))||D$.some(s=>(n.contain||"").includes(s))}function L$(t){let e=mo(t);for(;Fr(e)&&!nc(e);){if(o0(e))return e;if(Vp(e))return null;e=mo(e)}return null}function a0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const $$=new Set(["html","body","#document"]);function nc(t){return $$.has(hc(t))}function hr(t){return js(t).getComputedStyle(t)}function qp(t){return dr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function mo(t){if(hc(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Ok(t)&&t.host||zr(t);return Ok(e)?e.host:e}function VN(t){const e=mo(t);return nc(e)?t.ownerDocument?t.ownerDocument.body:t.body:Fr(e)&&Rd(e)?e:VN(e)}function Ku(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=VN(t),i=r===((s=t.ownerDocument)==null?void 0:s.body),o=js(r);if(i){const a=yy(o);return e.concat(o,o.visualViewport||[],Rd(r)?r:[],a&&n?Ku(a):[])}return e.concat(r,Ku(r,[],n))}function yy(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function qN(t){const e=hr(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=Fr(t),i=r?t.offsetWidth:n,o=r?t.offsetHeight:s,a=rp(n)!==i||rp(s)!==o;return a&&(n=i,s=o),{width:n,height:s,$:a}}function l0(t){return dr(t)?t:t.contextElement}function Nl(t){const e=l0(t);if(!Fr(e))return $r(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:i}=qN(e);let o=(i?rp(n.width):n.width)/s,a=(i?rp(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const F$=$r(0);function KN(t){const e=js(t);return!a0()||!e.visualViewport?F$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function z$(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==js(t)?!1:e}function ba(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=l0(t);let o=$r(1);e&&(s?dr(s)&&(o=Nl(s)):o=Nl(t));const a=z$(i,n,s)?KN(i):$r(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,d=r.width/o.x,h=r.height/o.y;if(i){const f=js(i),p=s&&dr(s)?js(s):s;let b=f,x=yy(b);for(;x&&s&&p!==b;){const y=Nl(x),g=x.getBoundingClientRect(),m=hr(x),w=g.left+(x.clientLeft+parseFloat(m.paddingLeft))*y.x,k=g.top+(x.clientTop+parseFloat(m.paddingTop))*y.y;l*=y.x,u*=y.y,d*=y.x,h*=y.y,l+=w,u+=k,b=js(x),x=yy(b)}}return op({width:d,height:h,x:l,y:u})}function Kp(t,e){const n=qp(t).scrollLeft;return e?e.left+n:ba(zr(t)).left+n}function GN(t,e){const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-Kp(t,n),r=n.top+e.scrollTop;return{x:s,y:r}}function B$(t){let{elements:e,rect:n,offsetParent:s,strategy:r}=t;const i=r==="fixed",o=zr(s),a=e?Vp(e.floating):!1;if(s===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},u=$r(1);const d=$r(0),h=Fr(s);if((h||!h&&!i)&&((hc(s)!=="body"||Rd(o))&&(l=qp(s)),Fr(s))){const p=ba(s);u=Nl(s),d.x=p.x+s.clientLeft,d.y=p.y+s.clientTop}const f=o&&!h&&!i?GN(o,l):$r(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-l.scrollTop*u.y+d.y+f.y}}function U$(t){return Array.from(t.getClientRects())}function H$(t){const e=zr(t),n=qp(t),s=t.ownerDocument.body,r=vs(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=vs(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+Kp(t);const a=-n.scrollTop;return hr(s).direction==="rtl"&&(o+=vs(e.clientWidth,s.clientWidth)-r),{width:r,height:i,x:o,y:a}}const Ik=25;function W$(t,e){const n=js(t),s=zr(t),r=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(r){i=r.width,o=r.height;const d=a0();(!d||d&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}const u=Kp(s);if(u<=0){const d=s.ownerDocument,h=d.body,f=getComputedStyle(h),p=d.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,b=Math.abs(s.clientWidth-h.clientWidth-p);b<=Ik&&(i-=b)}else u<=Ik&&(i+=u);return{width:i,height:o,x:a,y:l}}const V$=new Set(["absolute","fixed"]);function q$(t,e){const n=ba(t,!0,e==="fixed"),s=n.top+t.clientTop,r=n.left+t.clientLeft,i=Fr(t)?Nl(t):$r(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=r*i.x,u=s*i.y;return{width:o,height:a,x:l,y:u}}function Mk(t,e,n){let s;if(e==="viewport")s=W$(t,n);else if(e==="document")s=H$(zr(t));else if(dr(e))s=q$(e,n);else{const r=KN(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return op(s)}function YN(t,e){const n=mo(t);return n===e||!dr(n)||nc(n)?!1:hr(n).position==="fixed"||YN(n,e)}function K$(t,e){const n=e.get(t);if(n)return n;let s=Ku(t,[],!1).filter(a=>dr(a)&&hc(a)!=="body"),r=null;const i=hr(t).position==="fixed";let o=i?mo(t):t;for(;dr(o)&&!nc(o);){const a=hr(o),l=o0(o);!l&&a.position==="fixed"&&(r=null),(i?!l&&!r:!l&&a.position==="static"&&!!r&&V$.has(r.position)||Rd(o)&&!l&&YN(t,o))?s=s.filter(d=>d!==o):r=a,o=mo(o)}return e.set(t,s),s}function G$(t){let{element:e,boundary:n,rootBoundary:s,strategy:r}=t;const o=[...n==="clippingAncestors"?Vp(e)?[]:K$(e,this._c):[].concat(n),s],a=o[0],l=o.reduce((u,d)=>{const h=Mk(e,d,r);return u.top=vs(h.top,u.top),u.right=po(h.right,u.right),u.bottom=po(h.bottom,u.bottom),u.left=vs(h.left,u.left),u},Mk(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Y$(t){const{width:e,height:n}=qN(t);return{width:e,height:n}}function Q$(t,e,n){const s=Fr(e),r=zr(e),i=n==="fixed",o=ba(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=$r(0);function u(){l.x=Kp(r)}if(s||!s&&!i)if((hc(e)!=="body"||Rd(r))&&(a=qp(e)),s){const p=ba(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else r&&u();i&&!s&&r&&u();const d=r&&!s&&!i?GN(r,a):$r(0),h=o.left+a.scrollLeft-l.x-d.x,f=o.top+a.scrollTop-l.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function lg(t){return hr(t).position==="static"}function Dk(t,e){if(!Fr(t)||hr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return zr(t)===n&&(n=n.ownerDocument.body),n}function QN(t,e){const n=js(t);if(Vp(t))return n;if(!Fr(t)){let r=mo(t);for(;r&&!nc(r);){if(dr(r)&&!lg(r))return r;r=mo(r)}return n}let s=Dk(t,e);for(;s&&A$(s)&&lg(s);)s=Dk(s,e);return s&&nc(s)&&lg(s)&&!o0(s)?n:s||L$(t)||n}const X$=async function(t){const e=this.getOffsetParent||QN,n=this.getDimensions,s=await n(t.floating);return{reference:Q$(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function J$(t){return hr(t).direction==="rtl"}const Z$={convertOffsetParentRelativeRectToViewportRelativeRect:B$,getDocumentElement:zr,getClippingRect:G$,getOffsetParent:QN,getElementRects:X$,getClientRects:U$,getDimensions:Y$,getScale:Nl,isElement:dr,isRTL:J$};function XN(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function eF(t,e){let n=null,s;const r=zr(t);function i(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:p}=u;if(a||e(),!f||!p)return;const b=Sh(h),x=Sh(r.clientWidth-(d+f)),y=Sh(r.clientHeight-(h+p)),g=Sh(d),w={rootMargin:-b+"px "+-x+"px "+-y+"px "+-g+"px",threshold:vs(0,po(1,l))||1};let k=!0;function _(C){const S=C[0].intersectionRatio;if(S!==l){if(!k)return o();S?o(!1,S):s=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!XN(u,t.getBoundingClientRect())&&o(),k=!1}try{n=new IntersectionObserver(_,{...w,root:r.ownerDocument})}catch{n=new IntersectionObserver(_,w)}n.observe(t)}return o(!0),i}function tF(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,u=l0(t),d=r||i?[...u?Ku(u):[],...Ku(e)]:[];d.forEach(g=>{r&&g.addEventListener("scroll",n,{passive:!0}),i&&g.addEventListener("resize",n)});const h=u&&a?eF(u,n):null;let f=-1,p=null;o&&(p=new ResizeObserver(g=>{let[m]=g;m&&m.target===u&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(e)})),n()}),u&&!l&&p.observe(u),p.observe(e));let b,x=l?ba(t):null;l&&y();function y(){const g=ba(t);x&&!XN(x,g)&&n(),x=g,b=requestAnimationFrame(y)}return n(),()=>{var g;d.forEach(m=>{r&&m.removeEventListener("scroll",n),i&&m.removeEventListener("resize",n)}),h==null||h(),(g=p)==null||g.disconnect(),p=null,l&&cancelAnimationFrame(b)}}const nF=C$,sF=N$,rF=_$,iF=T$,oF=S$,Lk=k$,aF=E$,lF=(t,e,n)=>{const s=new Map,r={platform:Z$,...n},i={...r.platform,_c:s};return w$(t,e,{...r,platform:i})};var cF=typeof document<"u",uF=function(){},xf=cF?v.useLayoutEffect:uF;function ap(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!ap(t[s],e[s]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){const i=r[s];if(!(i==="_owner"&&t.$$typeof)&&!ap(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function JN(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function $k(t,e){const n=JN(t);return Math.round(e*n)/n}function cg(t){const e=v.useRef(t);return xf(()=>{e.current=t}),e}function dF(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[d,h]=v.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=v.useState(s);ap(f,s)||p(s);const[b,x]=v.useState(null),[y,g]=v.useState(null),m=v.useCallback(E=>{E!==C.current&&(C.current=E,x(E))},[]),w=v.useCallback(E=>{E!==S.current&&(S.current=E,g(E))},[]),k=i||b,_=o||y,C=v.useRef(null),S=v.useRef(null),j=v.useRef(d),N=l!=null,R=cg(l),M=cg(r),O=cg(u),D=v.useCallback(()=>{if(!C.current||!S.current)return;const E={placement:e,strategy:n,middleware:f};M.current&&(E.platform=M.current),lF(C.current,S.current,E).then(P=>{const A={...P,isPositioned:O.current!==!1};$.current&&!ap(j.current,A)&&(j.current=A,kd.flushSync(()=>{h(A)}))})},[f,e,n,M,O]);xf(()=>{u===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,h(E=>({...E,isPositioned:!1})))},[u]);const $=v.useRef(!1);xf(()=>($.current=!0,()=>{$.current=!1}),[]),xf(()=>{if(k&&(C.current=k),_&&(S.current=_),k&&_){if(R.current)return R.current(k,_,D);D()}},[k,_,D,R,N]);const L=v.useMemo(()=>({reference:C,floating:S,setReference:m,setFloating:w}),[m,w]),U=v.useMemo(()=>({reference:k,floating:_}),[k,_]),W=v.useMemo(()=>{const E={position:n,left:0,top:0};if(!U.floating)return E;const P=$k(U.floating,d.x),A=$k(U.floating,d.y);return a?{...E,transform:"translate("+P+"px, "+A+"px)",...JN(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:P,top:A}},[n,a,U.floating,d.x,d.y]);return v.useMemo(()=>({...d,update:D,refs:L,elements:U,floatingStyles:W}),[d,D,L,U,W])}const hF=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:r}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?Lk({element:s.current,padding:r}).fn(n):{}:s?Lk({element:s,padding:r}).fn(n):{}}}},fF=(t,e)=>({...nF(t),options:[t,e]}),pF=(t,e)=>({...sF(t),options:[t,e]}),mF=(t,e)=>({...aF(t),options:[t,e]}),gF=(t,e)=>({...rF(t),options:[t,e]}),xF=(t,e)=>({...iF(t),options:[t,e]}),yF=(t,e)=>({...oF(t),options:[t,e]}),vF=(t,e)=>({...hF(t),options:[t,e]});var bF="Arrow",ZN=v.forwardRef((t,e)=>{const{children:n,width:s=10,height:r=5,...i}=t;return c.jsx(Wn.svg,{...i,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});ZN.displayName=bF;var wF=ZN;function kF(t){const[e,n]=v.useState(void 0);return fo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var c0="Popper",[eE,tE]=Pd(c0),[_F,nE]=eE(c0),sE=t=>{const{__scopePopper:e,children:n}=t,[s,r]=v.useState(null);return c.jsx(_F,{scope:e,anchor:s,onAnchorChange:r,children:n})};sE.displayName=c0;var rE="PopperAnchor",iE=v.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...r}=t,i=nE(rE,n),o=v.useRef(null),a=us(e,o),l=v.useRef(null);return v.useEffect(()=>{const u=l.current;l.current=(s==null?void 0:s.current)||o.current,u!==l.current&&i.onAnchorChange(l.current)}),s?null:c.jsx(Wn.div,{...r,ref:a})});iE.displayName=rE;var u0="PopperContent",[SF,jF]=eE(u0),oE=v.forwardRef((t,e)=>{var pe,Z,be,De,xe,me;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:b,...x}=t,y=nE(u0,n),[g,m]=v.useState(null),w=us(e,Le=>m(Le)),[k,_]=v.useState(null),C=kF(k),S=(C==null?void 0:C.width)??0,j=(C==null?void 0:C.height)??0,N=s+(i!=="center"?"-"+i:""),R=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},M=Array.isArray(u)?u:[u],O=M.length>0,D={padding:R,boundary:M.filter(NF),altBoundary:O},{refs:$,floatingStyles:L,placement:U,isPositioned:W,middlewareData:E}=dF({strategy:"fixed",placement:N,whileElementsMounted:(...Le)=>tF(...Le,{animationFrame:p==="always"}),elements:{reference:y.anchor},middleware:[fF({mainAxis:r+j,alignmentAxis:o}),l&&pF({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?mF():void 0,...D}),l&&gF({...D}),xF({...D,apply:({elements:Le,rects:Y,availableWidth:ae,availableHeight:le})=>{const{width:oe,height:re}=Y.reference,_e=Le.floating.style;_e.setProperty("--radix-popper-available-width",`${ae}px`),_e.setProperty("--radix-popper-available-height",`${le}px`),_e.setProperty("--radix-popper-anchor-width",`${oe}px`),_e.setProperty("--radix-popper-anchor-height",`${re}px`)}}),k&&vF({element:k,padding:a}),EF({arrowWidth:S,arrowHeight:j}),f&&yF({strategy:"referenceHidden",...D})]}),[P,A]=cE(U),F=gi(b);fo(()=>{W&&(F==null||F())},[W,F]);const z=(pe=E.arrow)==null?void 0:pe.x,G=(Z=E.arrow)==null?void 0:Z.y,q=((be=E.arrow)==null?void 0:be.centerOffset)!==0,[B,Q]=v.useState();return fo(()=>{g&&Q(window.getComputedStyle(g).zIndex)},[g]),c.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...L,transform:W?L.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:B,"--radix-popper-transform-origin":[(De=E.transformOrigin)==null?void 0:De.x,(xe=E.transformOrigin)==null?void 0:xe.y].join(" "),...((me=E.hide)==null?void 0:me.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:c.jsx(SF,{scope:n,placedSide:P,onArrowChange:_,arrowX:z,arrowY:G,shouldHideArrow:q,children:c.jsx(Wn.div,{"data-side":P,"data-align":A,...x,ref:w,style:{...x.style,animation:W?void 0:"none"}})})})});oE.displayName=u0;var aE="PopperArrow",CF={top:"bottom",right:"left",bottom:"top",left:"right"},lE=v.forwardRef(function(e,n){const{__scopePopper:s,...r}=e,i=jF(aE,s),o=CF[i.placedSide];return c.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:c.jsx(wF,{...r,ref:n,style:{...r.style,display:"block"}})})});lE.displayName=aE;function NF(t){return t!==null}var EF=t=>({name:"transformOrigin",options:t,fn(e){var y,g,m;const{placement:n,rects:s,middlewareData:r}=e,o=((y=r.arrow)==null?void 0:y.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,d]=cE(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((g=r.arrow)==null?void 0:g.x)??0)+a/2,p=(((m=r.arrow)==null?void 0:m.y)??0)+l/2;let b="",x="";return u==="bottom"?(b=o?h:`${f}px`,x=`${-l}px`):u==="top"?(b=o?h:`${f}px`,x=`${s.floating.height+l}px`):u==="right"?(b=`${-l}px`,x=o?h:`${p}px`):u==="left"&&(b=`${s.floating.width+l}px`,x=o?h:`${p}px`),{data:{x:b,y:x}}}});function cE(t){const[e,n="center"]=t.split("-");return[e,n]}var TF=sE,PF=iE,RF=oE,AF=lE,OF="Portal",uE=v.forwardRef((t,e)=>{var a;const{container:n,...s}=t,[r,i]=v.useState(!1);fo(()=>i(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?gC.createPortal(c.jsx(Wn.div,{...s,ref:e}),o):null});uE.displayName=OF;function IF(t,e){return v.useReducer((n,s)=>e[n][s]??n,t)}var Ad=t=>{const{present:e,children:n}=t,s=MF(e),r=typeof n=="function"?n({present:s.isPresent}):v.Children.only(n),i=us(s.ref,DF(r));return typeof n=="function"||s.isPresent?v.cloneElement(r,{ref:i}):null};Ad.displayName="Presence";function MF(t){const[e,n]=v.useState(),s=v.useRef(null),r=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=IF(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const u=jh(s.current);i.current=a==="mounted"?u:"none"},[a]),fo(()=>{const u=s.current,d=r.current;if(d!==t){const f=i.current,p=jh(u);t?l("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),fo(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=p=>{const x=jh(s.current).includes(CSS.escape(p.animationName));if(p.target===e&&x&&(l("ANIMATION_END"),!r.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},f=p=>{p.target===e&&(i.current=jh(s.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(u=>{s.current=u?getComputedStyle(u):null,n(u)},[])}}function jh(t){return(t==null?void 0:t.animationName)||"none"}function DF(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var ug="rovingFocusGroup.onEntryFocus",LF={bubbles:!1,cancelable:!0},Od="RovingFocusGroup",[vy,dE,$F]=MN(Od),[FF,hE]=Pd(Od,[$F]),[zF,BF]=FF(Od),fE=v.forwardRef((t,e)=>c.jsx(vy.Provider,{scope:t.__scopeRovingFocusGroup,children:c.jsx(vy.Slot,{scope:t.__scopeRovingFocusGroup,children:c.jsx(UF,{...t,ref:e})})}));fE.displayName=Od;var UF=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:r=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=v.useRef(null),p=us(e,f),b=DN(i),[x,y]=ON({prop:o,defaultProp:a??null,onChange:l,caller:Od}),[g,m]=v.useState(!1),w=gi(u),k=dE(n),_=v.useRef(!1),[C,S]=v.useState(0);return v.useEffect(()=>{const j=f.current;if(j)return j.addEventListener(ug,w),()=>j.removeEventListener(ug,w)},[w]),c.jsx(zF,{scope:n,orientation:s,dir:b,loop:r,currentTabStopId:x,onItemFocus:v.useCallback(j=>y(j),[y]),onItemShiftTab:v.useCallback(()=>m(!0),[]),onFocusableItemAdd:v.useCallback(()=>S(j=>j+1),[]),onFocusableItemRemove:v.useCallback(()=>S(j=>j-1),[]),children:c.jsx(Wn.div,{tabIndex:g||C===0?-1:0,"data-orientation":s,...h,ref:p,style:{outline:"none",...t.style},onMouseDown:tt(t.onMouseDown,()=>{_.current=!0}),onFocus:tt(t.onFocus,j=>{const N=!_.current;if(j.target===j.currentTarget&&N&&!g){const R=new CustomEvent(ug,LF);if(j.currentTarget.dispatchEvent(R),!R.defaultPrevented){const M=k().filter(U=>U.focusable),O=M.find(U=>U.active),D=M.find(U=>U.id===x),L=[O,D,...M].filter(Boolean).map(U=>U.ref.current);gE(L,d)}}_.current=!1}),onBlur:tt(t.onBlur,()=>m(!1))})})}),pE="RovingFocusGroupItem",mE=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:r=!1,tabStopId:i,children:o,...a}=t,l=my(),u=i||l,d=BF(pE,n),h=d.currentTabStopId===u,f=dE(n),{onFocusableItemAdd:p,onFocusableItemRemove:b,currentTabStopId:x}=d;return v.useEffect(()=>{if(s)return p(),()=>b()},[s,p,b]),c.jsx(vy.ItemSlot,{scope:n,id:u,focusable:s,active:r,children:c.jsx(Wn.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...a,ref:e,onMouseDown:tt(t.onMouseDown,y=>{s?d.onItemFocus(u):y.preventDefault()}),onFocus:tt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:tt(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){d.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const g=VF(y,d.orientation,d.dir);if(g!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=f().filter(k=>k.focusable).map(k=>k.ref.current);if(g==="last")w.reverse();else if(g==="prev"||g==="next"){g==="prev"&&w.reverse();const k=w.indexOf(y.currentTarget);w=d.loop?qF(w,k+1):w.slice(k+1)}setTimeout(()=>gE(w))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});mE.displayName=pE;var HF={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function WF(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function VF(t,e,n){const s=WF(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return HF[s]}function gE(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function qF(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var KF=fE,GF=mE;function YF(t){const e=QF(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(JF);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function QF(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=ez(r),a=ZF(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Na(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var XF=Symbol("radix.slottable");function JF(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===XF}function ZF(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function ez(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var tz=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ka=new WeakMap,Ch=new WeakMap,Nh={},dg=0,xE=function(t){return t&&(t.host||xE(t.parentNode))},nz=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=xE(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},sz=function(t,e,n,s){var r=nz(e,Array.isArray(t)?t:[t]);Nh[n]||(Nh[n]=new WeakMap);var i=Nh[n],o=[],a=new Set,l=new Set(r),u=function(h){!h||a.has(h)||(a.add(h),u(h.parentNode))};r.forEach(u);var d=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))d(f);else try{var p=f.getAttribute(s),b=p!==null&&p!=="false",x=(Ka.get(f)||0)+1,y=(i.get(f)||0)+1;Ka.set(f,x),i.set(f,y),o.push(f),x===1&&b&&Ch.set(f,!0),y===1&&f.setAttribute(n,"true"),b||f.setAttribute(s,"true")}catch(g){console.error("aria-hidden: cannot operate on ",f,g)}})};return d(e),a.clear(),dg++,function(){o.forEach(function(h){var f=Ka.get(h)-1,p=i.get(h)-1;Ka.set(h,f),i.set(h,p),f||(Ch.has(h)||h.removeAttribute(s),Ch.delete(h)),p||h.removeAttribute(n)}),dg--,dg||(Ka=new WeakMap,Ka=new WeakMap,Ch=new WeakMap,Nh={})}},rz=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=tz(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),sz(s,r,n,"aria-hidden")):function(){return null}},yf="right-scroll-bar-position",vf="width-before-scroll-bar",iz="with-scroll-bars-hidden",oz="--removed-body-scroll-bar-size";function hg(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function az(t,e){var n=v.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var r=n.value;r!==s&&(n.value=s,n.callback(s,r))}}}})[0];return n.callback=e,n.facade}var lz=typeof window<"u"?v.useLayoutEffect:v.useEffect,Fk=new WeakMap;function cz(t,e){var n=az(null,function(s){return t.forEach(function(r){return hg(r,s)})});return lz(function(){var s=Fk.get(n);if(s){var r=new Set(s),i=new Set(t),o=n.current;r.forEach(function(a){i.has(a)||hg(a,null)}),i.forEach(function(a){r.has(a)||hg(a,o)})}Fk.set(n,t)},[t]),n}function uz(t){return t}function dz(t,e){e===void 0&&(e=uz);var n=[],s=!1,r={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,s);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(s=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){s=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return r}function hz(t){t===void 0&&(t={});var e=dz(null);return e.options=Or({async:!0,ssr:!1},t),e}var yE=function(t){var e=t.sideCar,n=uc(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return v.createElement(s,Or({},n))};yE.isSideCarExport=!0;function fz(t,e){return t.useMedium(e),yE}var vE=hz(),fg=function(){},Gp=v.forwardRef(function(t,e){var n=v.useRef(null),s=v.useState({onScrollCapture:fg,onWheelCapture:fg,onTouchMoveCapture:fg}),r=s[0],i=s[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,p=t.noRelative,b=t.noIsolation,x=t.inert,y=t.allowPinchZoom,g=t.as,m=g===void 0?"div":g,w=t.gapMode,k=uc(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=f,C=cz([n,e]),S=Or(Or({},k),r);return v.createElement(v.Fragment,null,d&&v.createElement(_,{sideCar:vE,removeScrollBar:u,shards:h,noRelative:p,noIsolation:b,inert:x,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:w}),o?v.cloneElement(v.Children.only(a),Or(Or({},S),{ref:C})):v.createElement(m,Or({},S,{className:l,ref:C}),a))});Gp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Gp.classNames={fullWidth:vf,zeroRight:yf};var pz=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function mz(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=pz();return e&&t.setAttribute("nonce",e),t}function gz(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function xz(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var yz=function(){var t=0,e=null;return{add:function(n){t==0&&(e=mz())&&(gz(e,n),xz(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},vz=function(){var t=yz();return function(e,n){v.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},bE=function(){var t=vz(),e=function(n){var s=n.styles,r=n.dynamic;return t(s,r),null};return e},bz={left:0,top:0,right:0,gap:0},pg=function(t){return parseInt(t||"",10)||0},wz=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[pg(n),pg(s),pg(r)]},kz=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return bz;var e=wz(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},_z=bE(),El="data-scroll-locked",Sz=function(t,e,n,s){var r=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(iz,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(a,"px ").concat(s,`;
  }
  body[`).concat(El,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(yf,` {
    right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(vf,` {
    margin-right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(yf," .").concat(yf,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(vf," .").concat(vf,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(El,`] {
    `).concat(oz,": ").concat(a,`px;
  }
`)},zk=function(){var t=parseInt(document.body.getAttribute(El)||"0",10);return isFinite(t)?t:0},jz=function(){v.useEffect(function(){return document.body.setAttribute(El,(zk()+1).toString()),function(){var t=zk()-1;t<=0?document.body.removeAttribute(El):document.body.setAttribute(El,t.toString())}},[])},Cz=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,r=s===void 0?"margin":s;jz();var i=v.useMemo(function(){return kz(r)},[r]);return v.createElement(_z,{styles:Sz(i,!e,r,n?"":"!important")})},by=!1;if(typeof window<"u")try{var Eh=Object.defineProperty({},"passive",{get:function(){return by=!0,!0}});window.addEventListener("test",Eh,Eh),window.removeEventListener("test",Eh,Eh)}catch{by=!1}var Ga=by?{passive:!1}:!1,Nz=function(t){return t.tagName==="TEXTAREA"},wE=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Nz(t)&&n[e]==="visible")},Ez=function(t){return wE(t,"overflowY")},Tz=function(t){return wE(t,"overflowX")},Bk=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var r=kE(t,s);if(r){var i=_E(t,s),o=i[1],a=i[2];if(o>a)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},Pz=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},Rz=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},kE=function(t,e){return t==="v"?Ez(e):Tz(e)},_E=function(t,e){return t==="v"?Pz(e):Rz(e)},Az=function(t,e){return t==="h"&&e==="rtl"?-1:1},Oz=function(t,e,n,s,r){var i=Az(t,window.getComputedStyle(e).direction),o=i*s,a=n.target,l=e.contains(a),u=!1,d=o>0,h=0,f=0;do{if(!a)break;var p=_E(t,a),b=p[0],x=p[1],y=p[2],g=x-y-i*b;(b||g)&&kE(t,a)&&(h+=g,f+=b);var m=a.parentNode;a=m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE?m.host:m}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(d&&Math.abs(h)<1||!d&&Math.abs(f)<1)&&(u=!0),u},Th=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Uk=function(t){return[t.deltaX,t.deltaY]},Hk=function(t){return t&&"current"in t?t.current:t},Iz=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Mz=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Dz=0,Ya=[];function Lz(t){var e=v.useRef([]),n=v.useRef([0,0]),s=v.useRef(),r=v.useState(Dz++)[0],i=v.useState(bE)[0],o=v.useRef(t);v.useEffect(function(){o.current=t},[t]),v.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var x=VM([t.lockRef.current],(t.shards||[]).map(Hk),!0).filter(Boolean);return x.forEach(function(y){return y.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),x.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=v.useCallback(function(x,y){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var g=Th(x),m=n.current,w="deltaX"in x?x.deltaX:m[0]-g[0],k="deltaY"in x?x.deltaY:m[1]-g[1],_,C=x.target,S=Math.abs(w)>Math.abs(k)?"h":"v";if("touches"in x&&S==="h"&&C.type==="range")return!1;var j=window.getSelection(),N=j&&j.anchorNode,R=N?N===C||N.contains(C):!1;if(R)return!1;var M=Bk(S,C);if(!M)return!0;if(M?_=S:(_=S==="v"?"h":"v",M=Bk(S,C)),!M)return!1;if(!s.current&&"changedTouches"in x&&(w||k)&&(s.current=_),!_)return!0;var O=s.current||_;return Oz(O,y,x,O==="h"?w:k)},[]),l=v.useCallback(function(x){var y=x;if(!(!Ya.length||Ya[Ya.length-1]!==i)){var g="deltaY"in y?Uk(y):Th(y),m=e.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&Iz(_.delta,g)})[0];if(m&&m.should){y.cancelable&&y.preventDefault();return}if(!m){var w=(o.current.shards||[]).map(Hk).filter(Boolean).filter(function(_){return _.contains(y.target)}),k=w.length>0?a(y,w[0]):!o.current.noIsolation;k&&y.cancelable&&y.preventDefault()}}},[]),u=v.useCallback(function(x,y,g,m){var w={name:x,delta:y,target:g,should:m,shadowParent:$z(g)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(k){return k!==w})},1)},[]),d=v.useCallback(function(x){n.current=Th(x),s.current=void 0},[]),h=v.useCallback(function(x){u(x.type,Uk(x),x.target,a(x,t.lockRef.current))},[]),f=v.useCallback(function(x){u(x.type,Th(x),x.target,a(x,t.lockRef.current))},[]);v.useEffect(function(){return Ya.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Ga),document.addEventListener("touchmove",l,Ga),document.addEventListener("touchstart",d,Ga),function(){Ya=Ya.filter(function(x){return x!==i}),document.removeEventListener("wheel",l,Ga),document.removeEventListener("touchmove",l,Ga),document.removeEventListener("touchstart",d,Ga)}},[]);var p=t.removeScrollBar,b=t.inert;return v.createElement(v.Fragment,null,b?v.createElement(i,{styles:Mz(r)}):null,p?v.createElement(Cz,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function $z(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Fz=fz(vE,Lz);var SE=v.forwardRef(function(t,e){return v.createElement(Gp,Or({},t,{ref:e,sideCar:Fz}))});SE.classNames=Gp.classNames;var wy=["Enter"," "],zz=["ArrowDown","PageUp","Home"],jE=["ArrowUp","PageDown","End"],Bz=[...zz,...jE],Uz={ltr:[...wy,"ArrowRight"],rtl:[...wy,"ArrowLeft"]},Hz={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Id="Menu",[Gu,Wz,Vz]=MN(Id),[Ta,CE]=Pd(Id,[Vz,tE,hE]),Yp=tE(),NE=hE(),[qz,Pa]=Ta(Id),[Kz,Md]=Ta(Id),EE=t=>{const{__scopeMenu:e,open:n=!1,children:s,dir:r,onOpenChange:i,modal:o=!0}=t,a=Yp(e),[l,u]=v.useState(null),d=v.useRef(!1),h=gi(i),f=DN(r);return v.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),c.jsx(TF,{...a,children:c.jsx(qz,{scope:e,open:n,onOpenChange:h,content:l,onContentChange:u,children:c.jsx(Kz,{scope:e,onClose:v.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:s})})})};EE.displayName=Id;var Gz="MenuAnchor",d0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=Yp(n);return c.jsx(PF,{...r,...s,ref:e})});d0.displayName=Gz;var h0="MenuPortal",[Yz,TE]=Ta(h0,{forceMount:void 0}),PE=t=>{const{__scopeMenu:e,forceMount:n,children:s,container:r}=t,i=Pa(h0,e);return c.jsx(Yz,{scope:e,forceMount:n,children:c.jsx(Ad,{present:n||i.open,children:c.jsx(uE,{asChild:!0,container:r,children:s})})})};PE.displayName=h0;var Vs="MenuContent",[Qz,f0]=Ta(Vs),RE=v.forwardRef((t,e)=>{const n=TE(Vs,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Pa(Vs,t.__scopeMenu),o=Md(Vs,t.__scopeMenu);return c.jsx(Gu.Provider,{scope:t.__scopeMenu,children:c.jsx(Ad,{present:s||i.open,children:c.jsx(Gu.Slot,{scope:t.__scopeMenu,children:o.modal?c.jsx(Xz,{...r,ref:e}):c.jsx(Jz,{...r,ref:e})})})})}),Xz=v.forwardRef((t,e)=>{const n=Pa(Vs,t.__scopeMenu),s=v.useRef(null),r=us(e,s);return v.useEffect(()=>{const i=s.current;if(i)return rz(i)},[]),c.jsx(p0,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:tt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Jz=v.forwardRef((t,e)=>{const n=Pa(Vs,t.__scopeMenu);return c.jsx(p0,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Zz=YF("MenuContent.ScrollLock"),p0=v.forwardRef((t,e)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:b,...x}=t,y=Pa(Vs,n),g=Md(Vs,n),m=Yp(n),w=NE(n),k=Wz(n),[_,C]=v.useState(null),S=v.useRef(null),j=us(e,S,y.onContentChange),N=v.useRef(0),R=v.useRef(""),M=v.useRef(0),O=v.useRef(null),D=v.useRef("right"),$=v.useRef(0),L=b?SE:v.Fragment,U=b?{as:Zz,allowPinchZoom:!0}:void 0,W=P=>{var pe,Z;const A=R.current+P,F=k().filter(be=>!be.disabled),z=document.activeElement,G=(pe=F.find(be=>be.ref.current===z))==null?void 0:pe.textValue,q=F.map(be=>be.textValue),B=d3(q,A,G),Q=(Z=F.find(be=>be.textValue===B))==null?void 0:Z.ref.current;(function be(De){R.current=De,window.clearTimeout(N.current),De!==""&&(N.current=window.setTimeout(()=>be(""),1e3))})(A),Q&&setTimeout(()=>Q.focus())};v.useEffect(()=>()=>window.clearTimeout(N.current),[]),e$();const E=v.useCallback(P=>{var F,z;return D.current===((F=O.current)==null?void 0:F.side)&&f3(P,(z=O.current)==null?void 0:z.area)},[]);return c.jsx(Qz,{scope:n,searchRef:R,onItemEnter:v.useCallback(P=>{E(P)&&P.preventDefault()},[E]),onItemLeave:v.useCallback(P=>{var A;E(P)||((A=S.current)==null||A.focus(),C(null))},[E]),onTriggerLeave:v.useCallback(P=>{E(P)&&P.preventDefault()},[E]),pointerGraceTimerRef:M,onPointerGraceIntentChange:v.useCallback(P=>{O.current=P},[]),children:c.jsx(L,{...U,children:c.jsx(zN,{asChild:!0,trapped:r,onMountAutoFocus:tt(i,P=>{var A;P.preventDefault(),(A=S.current)==null||A.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:c.jsx($N,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:c.jsx(KF,{asChild:!0,...w,dir:g.dir,orientation:"vertical",loop:s,currentTabStopId:_,onCurrentTabStopIdChange:C,onEntryFocus:tt(l,P=>{g.isUsingKeyboardRef.current||P.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(RF,{role:"menu","aria-orientation":"vertical","data-state":KE(y.open),"data-radix-menu-content":"",dir:g.dir,...m,...x,ref:j,style:{outline:"none",...x.style},onKeyDown:tt(x.onKeyDown,P=>{const F=P.target.closest("[data-radix-menu-content]")===P.currentTarget,z=P.ctrlKey||P.altKey||P.metaKey,G=P.key.length===1;F&&(P.key==="Tab"&&P.preventDefault(),!z&&G&&W(P.key));const q=S.current;if(P.target!==q||!Bz.includes(P.key))return;P.preventDefault();const Q=k().filter(pe=>!pe.disabled).map(pe=>pe.ref.current);jE.includes(P.key)&&Q.reverse(),c3(Q)}),onBlur:tt(t.onBlur,P=>{P.currentTarget.contains(P.target)||(window.clearTimeout(N.current),R.current="")}),onPointerMove:tt(t.onPointerMove,Yu(P=>{const A=P.target,F=$.current!==P.clientX;if(P.currentTarget.contains(A)&&F){const z=P.clientX>$.current?"right":"left";D.current=z,$.current=P.clientX}}))})})})})})})});RE.displayName=Vs;var e3="MenuGroup",m0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{role:"group",...s,ref:e})});m0.displayName=e3;var t3="MenuLabel",AE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{...s,ref:e})});AE.displayName=t3;var lp="MenuItem",Wk="menu.itemSelect",Qp=v.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:s,...r}=t,i=v.useRef(null),o=Md(lp,t.__scopeMenu),a=f0(lp,t.__scopeMenu),l=us(e,i),u=v.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(Wk,{bubbles:!0,cancelable:!0});h.addEventListener(Wk,p=>s==null?void 0:s(p),{once:!0}),IN(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return c.jsx(OE,{...r,ref:l,disabled:n,onClick:tt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:tt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:tt(t.onKeyDown,h=>{const f=a.searchRef.current!=="";n||f&&h.key===" "||wy.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Qp.displayName=lp;var OE=v.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:s=!1,textValue:r,...i}=t,o=f0(lp,n),a=NE(n),l=v.useRef(null),u=us(e,l),[d,h]=v.useState(!1),[f,p]=v.useState("");return v.useEffect(()=>{const b=l.current;b&&p((b.textContent??"").trim())},[i.children]),c.jsx(Gu.ItemSlot,{scope:n,disabled:s,textValue:r??f,children:c.jsx(GF,{asChild:!0,...a,focusable:!s,children:c.jsx(Wn.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:u,onPointerMove:tt(t.onPointerMove,Yu(b=>{s?o.onItemLeave(b):(o.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:tt(t.onPointerLeave,Yu(b=>o.onItemLeave(b))),onFocus:tt(t.onFocus,()=>h(!0)),onBlur:tt(t.onBlur,()=>h(!1))})})})}),n3="MenuCheckboxItem",IE=v.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:s,...r}=t;return c.jsx(FE,{scope:t.__scopeMenu,checked:n,children:c.jsx(Qp,{role:"menuitemcheckbox","aria-checked":cp(n)?"mixed":n,...r,ref:e,"data-state":x0(n),onSelect:tt(r.onSelect,()=>s==null?void 0:s(cp(n)?!0:!n),{checkForDefaultPrevented:!1})})})});IE.displayName=n3;var ME="MenuRadioGroup",[s3,r3]=Ta(ME,{value:void 0,onValueChange:()=>{}}),DE=v.forwardRef((t,e)=>{const{value:n,onValueChange:s,...r}=t,i=gi(s);return c.jsx(s3,{scope:t.__scopeMenu,value:n,onValueChange:i,children:c.jsx(m0,{...r,ref:e})})});DE.displayName=ME;var LE="MenuRadioItem",$E=v.forwardRef((t,e)=>{const{value:n,...s}=t,r=r3(LE,t.__scopeMenu),i=n===r.value;return c.jsx(FE,{scope:t.__scopeMenu,checked:i,children:c.jsx(Qp,{role:"menuitemradio","aria-checked":i,...s,ref:e,"data-state":x0(i),onSelect:tt(s.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});$E.displayName=LE;var g0="MenuItemIndicator",[FE,i3]=Ta(g0,{checked:!1}),zE=v.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:s,...r}=t,i=i3(g0,n);return c.jsx(Ad,{present:s||cp(i.checked)||i.checked===!0,children:c.jsx(Wn.span,{...r,ref:e,"data-state":x0(i.checked)})})});zE.displayName=g0;var o3="MenuSeparator",BE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{role:"separator","aria-orientation":"horizontal",...s,ref:e})});BE.displayName=o3;var a3="MenuArrow",UE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=Yp(n);return c.jsx(AF,{...r,...s,ref:e})});UE.displayName=a3;var l3="MenuSub",[f7,HE]=Ta(l3),Qc="MenuSubTrigger",WE=v.forwardRef((t,e)=>{const n=Pa(Qc,t.__scopeMenu),s=Md(Qc,t.__scopeMenu),r=HE(Qc,t.__scopeMenu),i=f0(Qc,t.__scopeMenu),o=v.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,u={__scopeMenu:t.__scopeMenu},d=v.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return v.useEffect(()=>d,[d]),v.useEffect(()=>{const h=a.current;return()=>{window.clearTimeout(h),l(null)}},[a,l]),c.jsx(d0,{asChild:!0,...u,children:c.jsx(OE,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":KE(n.open),...t,ref:Na(e,r.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:tt(t.onPointerMove,Yu(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:tt(t.onPointerLeave,Yu(h=>{var p,b;d();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const x=(b=n.content)==null?void 0:b.dataset.side,y=x==="right",g=y?-5:5,m=f[y?"left":"right"],w=f[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+g,y:h.clientY},{x:m,y:f.top},{x:w,y:f.top},{x:w,y:f.bottom},{x:m,y:f.bottom}],side:x}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:tt(t.onKeyDown,h=>{var p;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||Uz[s.dir].includes(h.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),h.preventDefault())})})})});WE.displayName=Qc;var VE="MenuSubContent",qE=v.forwardRef((t,e)=>{const n=TE(Vs,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Pa(Vs,t.__scopeMenu),o=Md(Vs,t.__scopeMenu),a=HE(VE,t.__scopeMenu),l=v.useRef(null),u=us(e,l);return c.jsx(Gu.Provider,{scope:t.__scopeMenu,children:c.jsx(Ad,{present:s||i.open,children:c.jsx(Gu.Slot,{scope:t.__scopeMenu,children:c.jsx(p0,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:tt(t.onFocusOutside,d=>{d.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:tt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:tt(t.onKeyDown,d=>{var p;const h=d.currentTarget.contains(d.target),f=Hz[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(p=a.trigger)==null||p.focus(),d.preventDefault())})})})})})});qE.displayName=VE;function KE(t){return t?"open":"closed"}function cp(t){return t==="indeterminate"}function x0(t){return cp(t)?"indeterminate":t?"checked":"unchecked"}function c3(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function u3(t,e){return t.map((n,s)=>t[(e+s)%t.length])}function d3(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=u3(t,Math.max(i,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function h3(t,e){const{x:n,y:s}=t;let r=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],u=a.x,d=a.y,h=l.x,f=l.y;d>s!=f>s&&n<(h-u)*(s-d)/(f-d)+u&&(r=!r)}return r}function f3(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return h3(n,e)}function Yu(t){return e=>e.pointerType==="mouse"?t(e):void 0}var p3=EE,m3=d0,g3=PE,x3=RE,y3=m0,v3=AE,b3=Qp,w3=IE,k3=DE,_3=$E,S3=zE,j3=BE,C3=UE,N3=WE,E3=qE,Xp="DropdownMenu",[T3]=Pd(Xp,[CE]),Vn=CE(),[P3,GE]=T3(Xp),YE=t=>{const{__scopeDropdownMenu:e,children:n,dir:s,open:r,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=Vn(e),u=v.useRef(null),[d,h]=ON({prop:r,defaultProp:i??!1,onChange:o,caller:Xp});return c.jsx(P3,{scope:e,triggerId:my(),triggerRef:u,contentId:my(),open:d,onOpenChange:h,onOpenToggle:v.useCallback(()=>h(f=>!f),[h]),modal:a,children:c.jsx(p3,{...l,open:d,onOpenChange:h,dir:s,modal:a,children:n})})};YE.displayName=Xp;var QE="DropdownMenuTrigger",XE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...r}=t,i=GE(QE,n),o=Vn(n);return c.jsx(m3,{asChild:!0,...o,children:c.jsx(Wn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...r,ref:Na(e,i.triggerRef),onPointerDown:tt(t.onPointerDown,a=>{!s&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:tt(t.onKeyDown,a=>{s||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});XE.displayName=QE;var R3="DropdownMenuPortal",JE=t=>{const{__scopeDropdownMenu:e,...n}=t,s=Vn(e);return c.jsx(g3,{...s,...n})};JE.displayName=R3;var ZE="DropdownMenuContent",eT=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=GE(ZE,n),i=Vn(n),o=v.useRef(!1);return c.jsx(x3,{id:r.contentId,"aria-labelledby":r.triggerId,...i,...s,ref:e,onCloseAutoFocus:tt(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:tt(t.onInteractOutside,a=>{const l=a.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;(!r.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});eT.displayName=ZE;var A3="DropdownMenuGroup",O3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(y3,{...r,...s,ref:e})});O3.displayName=A3;var I3="DropdownMenuLabel",tT=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(v3,{...r,...s,ref:e})});tT.displayName=I3;var M3="DropdownMenuItem",nT=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(b3,{...r,...s,ref:e})});nT.displayName=M3;var D3="DropdownMenuCheckboxItem",L3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(w3,{...r,...s,ref:e})});L3.displayName=D3;var $3="DropdownMenuRadioGroup",F3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(k3,{...r,...s,ref:e})});F3.displayName=$3;var z3="DropdownMenuRadioItem",B3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(_3,{...r,...s,ref:e})});B3.displayName=z3;var U3="DropdownMenuItemIndicator",H3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(S3,{...r,...s,ref:e})});H3.displayName=U3;var W3="DropdownMenuSeparator",sT=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(j3,{...r,...s,ref:e})});sT.displayName=W3;var V3="DropdownMenuArrow",q3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(C3,{...r,...s,ref:e})});q3.displayName=V3;var K3="DropdownMenuSubTrigger",G3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(N3,{...r,...s,ref:e})});G3.displayName=K3;var Y3="DropdownMenuSubContent",Q3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(E3,{...r,...s,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Q3.displayName=Y3;var X3=YE,J3=XE,Z3=JE,eB=eT,tB=tT,nB=nT,sB=sT;const Jp=X3,Zp=J3,Dd=ge.forwardRef(({className:t,sideOffset:e=8,...n},s)=>c.jsx(Z3,{children:c.jsx(eB,{ref:s,sideOffset:e,className:Te("z-[90] min-w-[220px] overflow-hidden rounded-2xl p-1","bg-white/75 dark:bg-black/40 backdrop-blur-md shadow-soft2","ring-1 ring-black/5 dark:ring-white/10",t),...n})}));Dd.displayName="DropdownMenuContent";const rT=ge.forwardRef(({className:t,...e},n)=>c.jsx(tB,{ref:n,className:Te("px-3 py-2 text-xs text-black/60 dark:text-white/60",t),...e}));rT.displayName="DropdownMenuLabel";const up=ge.forwardRef(({className:t,...e},n)=>c.jsx(sB,{ref:n,className:Te("my-1 h-px bg-black/5 dark:bg-white/10",t),...e}));up.displayName="DropdownMenuSeparator";const Qu=ge.forwardRef(({className:t,inset:e,...n},s)=>c.jsx(nB,{ref:s,className:Te("relative flex cursor-default select-none items-center gap-2 rounded-xl px-3 py-2 text-sm outline-none","text-black/90 dark:text-white/90","focus:bg-black/5 dark:focus:bg-white/10",e&&"pl-8",t),...n}));Qu.displayName="DropdownMenuItem";function On({className:t,variant:e="secondary",...n}){return c.jsx(te,{variant:e,size:"icon",className:Te("rounded-xl h-8 w-8",t),...n})}function Cs({open:t,onClose:e,title:n,children:s,maxWidth:r="520px"}){if(!t)return null;const i=c.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm px-4 py-6 overflow-y-auto",children:c.jsx("div",{className:"w-full",style:{maxWidth:r},children:c.jsxs("div",{className:"rounded-2xl bg-white/90 dark:bg-neutral-900/95 shadow-2xl ring-1 ring-black/10 dark:ring-white/10 max-h-[85vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-black/5 dark:border-white/10",children:[c.jsx("div",{className:"text-sm font-semibold",children:n}),c.jsx("button",{className:"text-black/60 dark:text-white/60 hover:opacity-100 opacity-70",onClick:e,children:""})]}),c.jsx("div",{className:"p-4 overflow-y-auto",children:s})]})})});return typeof document>"u"?i:kd.createPortal(i,document.body)}function fc({open:t,onClose:e,onConfirm:n,message:s}){return t?c.jsx(Cs,{open:t,onClose:e,title:"Confirm",maxWidth:"420px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-black/70 dark:text-white/70",children:s||"Are you sure?"}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:n,children:"Confirm"})]})]})}):null}const iT=v.createContext(null);function y0(){const t=v.useContext(iT);if(!t)throw new Error("useNotifications must be used inside NotificationsProvider");return t}function rB({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function iB(){const t=jd(),{notifications:e,unreadCount:n,clearAll:s,dismissNotification:r,markRead:i,formatTime:o}=y0(),[a,l]=v.useState(null),u=v.useMemo(()=>e.slice(0,6),[e]);return c.jsxs(c.Fragment,{children:[c.jsxs(Jp,{children:[c.jsx(Zp,{asChild:!0,children:c.jsxs("button",{className:"relative flex h-9 w-9 items-center justify-center rounded-2xl bg-black/5 dark:bg-white/10 text-black/80 dark:text-white/80 shadow-soft","aria-label":"Notifications",children:[c.jsx(BI,{size:18}),n?c.jsx("span",{className:"absolute -right-1 -top-1 min-w-[18px] rounded-full bg-rose-500 px-1 text-[11px] font-semibold leading-4 text-white",children:n>99?"99+":n}):null]})}),c.jsxs(Dd,{align:"end",className:"w-[320px] p-0 bg-white/90 dark:bg-neutral-900/85",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold",children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:e.length?`${e.length} total`:"No alerts"})]}),c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:s,disabled:!e.length,children:"Clear all"})]}),c.jsx(up,{}),c.jsx("div",{className:"max-h-[320px] overflow-y-auto p-2 space-y-2",children:u.length?u.map(d=>c.jsx("div",{className:Te("rounded-xl px-3 py-2 ring-1 transition-colors",d.read?"bg-white/50 dark:bg-white/5 ring-black/5 dark:ring-white/10":"bg-black/5 dark:bg-white/10 ring-black/10 dark:ring-white/20"),children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:d.title||"Notification"}),d.message?c.jsx("div",{className:"mt-0.5 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:d.message}):null,d.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:o(d.created_at)}):null]}),c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx(On,{variant:"ghost",className:"h-7 w-7",onClick:()=>r(d.id),"aria-label":"Dismiss notification",children:c.jsx(Gv,{size:14})}),c.jsx(On,{variant:"ghost",className:"h-7 w-7",onClick:()=>{i(d.id),l(d)},"aria-label":"View notification",children:c.jsx(QC,{size:14})})]})]})},d.id)):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 p-4 text-xs text-black/50 dark:text-white/60 text-center",children:"You're all caught up."})}),c.jsx(up,{}),c.jsx("div",{className:"px-3 py-2",children:c.jsx(te,{variant:"secondary",className:"w-full rounded-2xl",onClick:()=>t("/app/notifications"),children:"View all notifications"})})]})]}),c.jsx(Cs,{open:!!a,onClose:()=>l(null),title:(a==null?void 0:a.title)||"Notification",maxWidth:"520px",children:c.jsx(rB,{notification:a})})]})}function Ft({className:t,...e}){return c.jsx("div",{className:Te("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 shadow-soft",t),...e})}function oB(){const{toasts:t,dismissToast:e,formatTime:n}=y0();return t.length?c.jsx("div",{className:"fixed right-6 top-24 z-50 flex w-[320px] flex-col gap-2",children:t.map(s=>{const r=s.notification;return c.jsx(Ft,{className:"p-3 bg-white dark:bg-neutral-900 shadow-soft ring-1 ring-black/10 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:r.title||"Notification"}),r.message?c.jsx("div",{className:"mt-1 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:r.message}):null,r.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:n(r.created_at)}):null]}),c.jsx("button",{type:"button",className:"rounded-full p-1 text-black/50 hover:text-black/80 dark:text-white/50 dark:hover:text-white/80",onClick:()=>e(s.id),"aria-label":"Dismiss notification",children:c.jsx(Gv,{size:14})})]})},s.id)})}):null}async function aB(){return Oe("/api/modules/accessible",{method:"GET"})}async function lB({limit:t,offset:e=0,newestFirst:n=!1,signal:s}={}){const r=new URLSearchParams;t!=null&&r.set("limit",t),e>0&&r.set("offset",e),n&&r.set("newest_first","true");const i=r.toString();return Oe(`/api/sales/chat/history${i?`?${i}`:""}`,{signal:s})}async function cB(t,e=[]){return Oe("/api/sales/chat/attachments/refresh",{method:"POST",body:JSON.stringify({file_ids:t,prefetch_ids:e})})}async function uB({conversationId:t,message:e,fileIds:n,onEvent:s,onChunk:r,onDone:i,onError:o,signal:a}){try{const l=Ed(),u=Ea.API_BASE_URL||"",d=await fetch(`${u}/api/sales/chat/stream`,{method:"POST",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}},body:JSON.stringify({message:e,conversation_id:t,...n!=null&&n.length?{file_ids:n}:{}}),signal:a});if(d.status===401){ci(),window.dispatchEvent(new CustomEvent("auth:logout")),o==null||o(new Error("Unauthorized"));return}if(!d.ok){const x=await d.json().catch(()=>({}));throw new Error(x.detail||`API error: ${d.status}`)}const h=d.body.getReader(),f=new TextDecoder;let p="",b=!1;for(;;){const{done:x,value:y}=await h.read();if(x)break;p+=f.decode(y,{stream:!0});const g=p.split(`
`);p=g.pop()||"";for(const m of g){const w=m.trim();if(!w.startsWith("data:"))continue;const k=w.replace(/^data:\s?/,"");if(!k||k==="[DONE]"){b=!0,i==null||i();continue}try{const _=JSON.parse(k);s==null||s(_),!s&&r&&(_.type==="chunk"||_.type==="content")&&r(_)}catch{const _={content:k};s==null||s(_),s||r==null||r(_)}}}b||i==null||i()}catch(l){throw o==null||o(l),l}}async function dB({requestId:t,eventIndex:e=0,onEvent:n,onDone:s,onError:r,onNotFound:i,signal:o}){try{const a=Ed(),u=`${Ea.API_BASE_URL||""}/api/sales/chat/resume/${t}?event_index=${e}`,d=await fetch(u,{method:"GET",headers:{...a?{Authorization:`Bearer ${a}`}:{}},signal:o});if(d.status===401)return ci(),window.dispatchEvent(new CustomEvent("auth:logout")),r==null||r(new Error("Unauthorized")),{status:"error"};if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(f.detail||`API error: ${d.status}`)}const h=d.headers.get("content-type")||"";if(h.includes("application/json")){const f=await d.json();if(f.status==="not_found")return i==null||i(),{status:"not_found"};if(f.status==="completed"){for(const p of f.events||[])n==null||n(p);return s==null||s(),{status:"completed",events:f.events}}return f}else if(h.includes("text/event-stream")){const f=d.body.getReader(),p=new TextDecoder;let b="",x=!1;for(;;){const{done:y,value:g}=await f.read();if(y)break;b+=p.decode(g,{stream:!0});const m=b.split(`
`);b=m.pop()||"";for(const w of m){const k=w.trim();if(!k.startsWith("data:"))continue;const _=k.replace(/^data:\s?/,"");if(!_||_==="[DONE]"){x=!0,s==null||s();continue}try{const C=JSON.parse(_);n==null||n(C)}catch{}}}return x||s==null||s(),{status:"streaming_completed"}}return{status:"unknown"}}catch(a){return a.name==="AbortError"?{status:"aborted"}:(r==null||r(a),{status:"error",error:a.message})}}async function hB(t){const e=new FormData;return e.append("file",t),Oe("/api/sales/files/upload",{method:"POST",body:e})}async function fB(){return Oe("/api/assets/asset-types")}async function Vk(t,{timeOfDay:e,side:n,venueType:s}={}){const r=new URLSearchParams;e&&r.set("time_of_day",e),n&&r.set("side",n),s&&r.set("venue_type",s);const i=Array.isArray(t)?t[0]:t;return i?Oe(`/api/sales/mockup/templates/${encodeURIComponent(i)}?${r.toString()}`):[]}async function pB(t){return Oe("/api/sales/mockup/save-frame",{method:"POST",body:t})}async function mB(t){return Oe("/api/sales/mockup/update-frame",{method:"PUT",body:t})}async function gB(t,e,{timeOfDay:n,side:s}={}){const r=new URLSearchParams;return r.set("photo_filename",e),n&&r.set("time_of_day",n),s&&r.set("side",s),Oe(`/api/sales/mockup/photo/${t}?${r.toString()}`,{method:"DELETE"})}async function xB({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),i&&o.set("photo_filename",i);const a=encodeURIComponent(e);return Oe(`/api/assets/mockup-frames/${t}/${a}/frame?${o.toString()}`)}async function yB({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e||!i)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),o.set("photo_filename",i);const a=encodeURIComponent(e);return Oe(`/api/assets/mockup-frames/${t}/${a}?${o.toString()}`,{method:"DELETE"})}async function vB(t){return TN("/api/sales/mockup/test-preview",{method:"POST",body:t})}async function bB(t){return Oe("/api/sales/mockup/generate",{method:"POST",body:t})}async function wB(){return Oe("/api/sales/mockup/history")}async function oT(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){if(!t||!e)return null;const o=new URLSearchParams;o.set("photo_filename",e),n&&o.set("time_of_day",n),s&&o.set("side",s),r&&o.set("company",r),i&&o.set("venue_type",i);const a=`/api/sales/mockup/photo/${t}?${o.toString()}`;return TN(a)}async function kB(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){const o=await oT(t,e,{timeOfDay:n,side:s,company:r,venueType:i});return o?URL.createObjectURL(o):""}async function _B(){return Oe("/api/sales/mockup/eligibility/setup")}async function SB(){return Oe("/api/sales/mockup/eligibility/generate")}async function jB({service:t,displayType:e}={}){const n=new URLSearchParams;t&&n.set("service",t),e&&n.set("display_type",e);const s=n.toString();return Oe(`/api/sales/locations${s?`?${s}`:""}`)}async function CB(t){return t?Oe(`/api/sales/locations/${encodeURIComponent(t)}`):null}async function NB(t){return Oe("/api/sales/proposals",{method:"POST",body:JSON.stringify(t)})}async function EB(){return Oe("/api/sales/proposals/history")}async function TB({limit:t=100,offset:e=0}={}){return Oe("/api/rbac/users")}async function PB(t){return Oe(`/api/rbac/user/${t}`)}async function RB(t){return Oe(`/api/rbac/users/${t}/permissions`)}async function AB(t){return Oe("/api/rbac/users",{method:"POST",body:JSON.stringify(t)})}async function OB(t,e){return Oe(`/api/rbac/users/${t}`,{method:"PUT",body:JSON.stringify(e)})}async function IB(t){return Oe(`/api/rbac/users/${encodeURIComponent(t)}/deactivate`,{method:"POST"})}async function MB(t){return Oe(`/api/rbac/users/${encodeURIComponent(t)}/reactivate`,{method:"POST"})}async function DB(){return Oe("/api/rbac/profiles")}async function LB(t){return Oe("/api/rbac/profiles",{method:"POST",body:JSON.stringify(t)})}async function $B(t,e){return Oe(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function FB(t){return Oe(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"DELETE"})}async function qk(t,e){return Oe(`/api/rbac/users/${t}/permissions`,{method:"PUT",body:JSON.stringify({permissions:e})})}async function zB(){return await Oe("/api/rbac/permissions")}async function mg(t,e){return Oe("/api/rbac/permissions",{method:"POST",body:JSON.stringify({name:t,description:e})})}async function Kk(t){return Oe(`/api/rbac/permissions/${encodeURIComponent(t)}`,{method:"DELETE"})}async function BB(){const t=await Oe("/api/rbac/companies");return t.companies||t}async function UB(t){return Oe("/api/assets/companies",{method:"POST",body:JSON.stringify(t)})}async function HB(t,e){return Oe(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function WB(t){return Oe(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"DELETE"})}async function VB(){return Oe("/api/rbac/permission-sets")}async function qB(t){return Oe("/api/rbac/permission-sets",{method:"POST",body:JSON.stringify(t)})}async function KB(t,e){return Oe(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function GB(t){return Oe(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"DELETE"})}async function v0(){return Oe("/api/admin/service-visibility")}async function YB(t){return Oe("/api/admin/service-visibility",{method:"PUT",body:JSON.stringify(t)})}const b0="mmg-notifications",Ld="/api/notifications";function QB(t,e){if(!t)return e;try{return JSON.parse(t)}catch{return e}}function oo(){if(typeof window>"u")return[];const t=window.localStorage.getItem(b0),e=QB(t,[]);return Array.isArray(e)?e:[]}function em(t){typeof window>"u"||window.localStorage.setItem(b0,JSON.stringify(t))}function Gk(t){const e=new Date().toISOString();return{id:(t==null?void 0:t.id)||(typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`ntf_${Date.now()}_${Math.random().toString(16).slice(2,8)}`),title:(t==null?void 0:t.title)||"Notification",message:(t==null?void 0:t.message)||"",created_at:(t==null?void 0:t.created_at)||e,read:!!(t!=null&&t.read),level:(t==null?void 0:t.level)||"info",meta:(t==null?void 0:t.meta)||{}}}function XB(t){return Array.isArray(t)?t:Array.isArray(t==null?void 0:t.notifications)?t.notifications:Array.isArray(t==null?void 0:t.data)?t.data:[]}function JB(){return Oe(Ld).then(t=>XB(t)).catch(()=>oo())}function ZB(t){return Oe(Ld,{method:"POST",body:JSON.stringify(t||{})}).then(e=>(e==null?void 0:e.notification)||(e==null?void 0:e.data)||e||Gk(t)).catch(()=>{const e=oo(),n=Gk(t),s=[n,...e];return em(s),n})}function e4(){return Oe(Ld,{method:"DELETE"}).then(()=>[]).catch(()=>(em([]),[]))}function t4(t){return t?Oe(`${Ld}/${encodeURIComponent(t)}`,{method:"DELETE"}).then(()=>oo()).catch(()=>{const e=oo().filter(n=>n.id!==t);return em(e),e}):Promise.resolve(oo())}function n4(t){return t?Oe(`${Ld}/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify({read:!0})}).then(()=>oo()).catch(()=>{const e=oo().map(n=>n.id===t?{...n,read:!0}:n);return em(e),e}):Promise.resolve(oo())}const s4=b0;function Gs(t){if(!t||t==="NA")return null;if(t.includes("T")){const i=new Date(t);if(!Number.isNaN(i.getTime()))return i}const e=t.split(" "),n=e[0],s=e[1],r=n.split("-");if(r.length===3){const i=Number(r[0]),o=Number(r[1])-1,a=Number(r[2]);if(Number.isNaN(i)||Number.isNaN(o)||Number.isNaN(a))return null;if(s){const u=s.split(":"),d=Number(u[0]||0),h=Number(u[1]||0),f=Number(u[2]||0),p=new Date(a,o,i,d,h,f);return Number.isNaN(p.getTime())?null:p}const l=new Date(a,o,i);return l.setHours(0,0,0,0),Number.isNaN(l.getTime())?null:l}return null}function aT(t){var n;if(!((n=t==null?void 0:t.lifecycle)!=null&&n.length))return"";const e=t.lifecycle[t.lifecycle.length-1];return((e==null?void 0:e.stage)||"").toLowerCase()}function lT(t){const e={};return t.forEach(n=>{const s=n.videographer||n.Videographer||"Unassigned";e[s]||(e[s]=[]),e[s].push(n)}),e}function Oi(t){const e={pending:0,rejected:0,returned:0,submitted:0,accepted:0};return t.forEach(n=>{(n.versions||[]).forEach(s=>{const r=aT(s);r==="pending"||r==="critique"?e.pending+=1:r==="rejected"||r==="editing"?e.rejected+=1:r==="returned"?e.returned+=1:r==="submitted"||r==="submitted to sales"?e.submitted+=1:(r==="accepted"||r==="done")&&(e.accepted+=1)})}),e}function cT(t){const e=t.length,n=t.filter(a=>{const l=a.videographer||a.Videographer||"Unassigned";return l&&l!=="Unassigned"&&a.status!=="Not assigned yet"}).length;let s=0;t.forEach(a=>{s+=(a.versions||[]).length});const r=Oi(t),i=r.accepted+r.submitted+r.rejected+r.returned,o=i>0?Math.round((r.accepted+r.submitted)/i*100):0;return{total:e,assigned:n,uploads:s,pending:r.pending,rejected:r.rejected,returned:r.returned,submitted_to_sales:r.submitted,accepted_videos:r.accepted,accepted_pct:o}}function uT(t){const e=t.filter(n=>n.status==="Accepted"||n.status==="Done").length;return{completed:e,not_completed:t.length-e}}function r4(t){let e=0,n=0,s=0,r=0,i=0;t.forEach(d=>{(d.versions||[]).forEach(h=>{const f=h.lifecycle||[];if(f.length<2)return;let p=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="pending"||m==="critique"){p=Gs(g.at);break}}let b=null,x=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="rejected"||m==="editing"||m==="accepted"||m==="submitted"||m==="submitted to sales"){b=Gs(g.at),x=m;break}}if(!p||!b||!x)return;s+=1;const y=Math.round((b-p)/(1e3*60*60));if(e+=y,n+=1,x==="accepted"||x==="submitted"||x==="submitted to sales"){let g=!1,m=!1;f.forEach(w=>{const k=(w.stage||"").toLowerCase();(k==="accepted"||k==="done")&&(g=!0),k==="returned"&&(m=!0)}),g&&(r+=1),m&&(i+=1)}})});const o=n>0?Math.round(e/n):0,a=o>0?`${o} hrs`:"0 hrs",l=r+i,u=l>0?Math.round(r/l*100):0;return{avg_response_display:a,handled:s,accepted:r,handled_percent:u}}function dT(t){const e=lT(t),n={},s=new Date;return s.setHours(0,0,0,0),Object.entries(e).forEach(([r,i])=>{let o=0,a=0,l=0,u=0;i.forEach(p=>{(p.status==="Accepted"||p.status==="Done")&&(o+=1),a+=(p.versions||[]).length;const b=Gs(p.filming_deadline||p.filming_date||"");b&&b<=s&&(u+=1);const x=Gs(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(l+=1)});const d=Oi(i),h=d.accepted+d.submitted+d.rejected+d.returned,f=h>0?Math.round((d.accepted+d.submitted)/h*100):0;n[r]={total:i.length,started:u,late:l,completed:o,uploads:a,accepted_pct:f}}),n}function Xu(t,e){const n=[];return t.forEach(s=>{(s.versions||[]).forEach(r=>{const i=aT(r);(i==="submitted to sales"?"submitted":i)===e&&n.push({task:s,version:r,stage:i})})}),n}function gg(t,e){const n=[];return t.forEach(s=>{const r=[];(s.versions||[]).forEach(i=>{(i.lifecycle||[]).forEach(o=>{const a=(o.stage||"").toLowerCase();(e==="hod"&&(a==="rejected"||a==="editing")||e==="hos"&&a==="returned")&&r.push({version:i.version,event:o,stage:a})})}),r.length&&n.push({...s,rejectionEvents:r,rejectionCount:r.length})}),n}function hT(t){const e=Xu(t,"pending"),n=[];return e.forEach(({task:s,version:r})=>{let i=null;(r.lifecycle||[]).forEach(a=>{const l=(a.stage||"").toLowerCase();(l==="pending"||l==="critique")&&(i=Gs(a.at))});const o=i?Math.round((Date.now()-i.getTime())/(1e3*60*60)):null;n.push({task:s,version:r,uploadTime:i,waitingHours:o})}),{count:n.length,reviews:n}}function fT(t){const e=[];return t.forEach(n=>{(n.versions||[]).forEach(s=>{let r=null,i=null,o=null,a=null,l=null;if((s.lifecycle||[]).forEach(u=>{const d=(u.stage||"").toLowerCase();!r&&(d==="pending"||d==="critique")&&(r=Gs(u.at)),!i&&(d==="rejected"||d==="editing"||d==="accepted"||d==="submitted"||d==="submitted to sales")&&(i=Gs(u.at),o=d,a=u.rejection_class||null,l=u.rejection_comments||null)}),r&&i&&o){const u=Math.round((i-r)/36e5);e.push({task:n,version:s,responseHours:u,uploadTime:r,reviewTime:i,decision:o,rejectionClass:a,comments:l})}})}),e}function pT(t){const e=cT(t),n=uT(t),s=new Date;s.setHours(0,0,0,0);let r=0,i=0,o=0,a=0,l=0,u=0;t.forEach(p=>{const b=Gs(p.filming_deadline||p.filming_date||"");b&&b<=s&&(r+=1);const x=Gs(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(i+=1),(p.status==="Accepted"||p.status==="Done")&&(a+=1,o+=(p.versions||[]).length),(p.versions||[]).forEach(y=>{(y.lifecycle||[]).forEach(g=>{const m=(g.stage||"").toLowerCase();(m==="rejected"||m==="editing")&&(l+=1),m==="returned"&&(u+=1)})})});const d=a>0?(o/a).toFixed(2):"0",h=Xu(t,"pending"),f=Xu(t,"submitted");return{summary:e,pie:n,tasksStarted:r,lateTasks:i,pendingHOD:h.length,pendingHOS:f.length,rejectionsByHOD:l,rejectionsByHOS:u,uploadRatio:d}}function xg(t){const e=Gs(t.submission_date||"");if(!e)return!1;const n=new Date;return n.setHours(0,0,0,0),e<n&&t.status!=="Accepted"&&t.status!=="Done"}const br=[{task_number:2217,brand:"City Brand Launch",filming_deadline:"17-02-2025",submission_date:"20-02-2025",status:"Critique",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"18-02-2025 10:00:00"}]}]},{task_number:2216,brand:"Mall LED Loop",filming_deadline:"16-02-2025",submission_date:"19-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"17-02-2025 09:00:00"},{stage:"submitted to sales",at:"18-02-2025 11:30:00"}]}]},{task_number:2215,brand:"Festival Teaser",filming_deadline:"15-02-2025",submission_date:"18-02-2025",status:"Returned",videographer:"Alyssa Reed",location:"Abu Dhabi",versions:[{version:1,lifecycle:[{stage:"pending",at:"15-02-2025 10:00:00"},{stage:"submitted",at:"16-02-2025 12:00:00"},{stage:"returned",at:"17-02-2025 15:30:00",rejection_class:"Lighting",rejection_comments:"Exposure too dark",rejected_by:"Head of Sales"}]}]},{task_number:2214,brand:"Luxury Auto Montage",filming_deadline:"14-02-2025",submission_date:"17-02-2025",status:"Editing",videographer:"Noah Chen",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"14-02-2025 09:30:00"},{stage:"rejected",at:"15-02-2025 12:10:00",rejection_class:"Artwork Color",rejection_comments:"Incorrect color profile",rejected_by:"Reviewer"}]}]},{task_number:2213,brand:"Airport Arrival Hero",filming_deadline:"12-02-2025",submission_date:"15-02-2025",status:"Accepted",videographer:"Noah Chen",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"12-02-2025 10:00:00"},{stage:"submitted to sales",at:"13-02-2025 15:00:00"},{stage:"accepted",at:"14-02-2025 12:00:00"}]}]},{task_number:2212,brand:"Retail Weekend Promo",filming_deadline:"10-02-2025",submission_date:"13-02-2025",status:"Done",videographer:"Ravi Sharma",location:"Ajman",versions:[{version:1,lifecycle:[{stage:"pending",at:"10-02-2025 10:00:00"},{stage:"submitted",at:"11-02-2025 14:00:00"},{stage:"done",at:"12-02-2025 10:00:00"}]}]},{task_number:2211,brand:"Harbor Night Loop",filming_deadline:"18-02-2025",submission_date:"21-02-2025",status:"Editing",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"16-02-2025 11:00:00"},{stage:"editing",at:"17-02-2025 13:00:00",rejection_class:"Environment Too Dark",rejection_comments:"Please brighten the surrounding scene",rejected_by:"Reviewer"}]}]},{task_number:2210,brand:"City Center Countdown",filming_deadline:"22-02-2025",submission_date:"25-02-2025",status:"Assigned to Alyssa",videographer:"Alyssa Reed",location:"Dubai",versions:[]},{task_number:2209,brand:"Expo Walkthrough",filming_deadline:"24-02-2025",submission_date:"27-02-2025",status:"Not assigned yet",videographer:"Unassigned",location:"Abu Dhabi",versions:[]},{task_number:2208,brand:"Weekend Highlights",filming_deadline:"13-02-2025",submission_date:"16-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"13-02-2025 09:00:00"},{stage:"rejected",at:"14-02-2025 10:30:00",rejection_class:"Lighting",rejection_comments:"Flicker in the panel",rejected_by:"Reviewer"}]},{version:2,lifecycle:[{stage:"pending",at:"15-02-2025 12:15:00"},{stage:"submitted",at:"16-02-2025 14:40:00"}]}]}],i4={session_id:"vc-session-01",messages:[{id:"vc-msg-1",role:"assistant",content:"Good morning. Upload a cut or describe the request, and I will log the critique, checklist, and next steps.",timestamp:"2025-02-18T08:40:12+04:00"}],message_count:1,last_updated:"2025-02-18T08:40:12+04:00"},o4=[{workflow_id:"workflow-2217",task_number:2217,folder_name:"City Brand Launch",status:"pending_reviewer",created_at:"2025-02-18T09:10:00+04:00",reviewer_approved:!1,hos_approved:!1}];function fr(t){return new Promise(e=>setTimeout(e,t))}function a4(t,e){const n=[];let s=0;for(;s<t.length;)n.push(t.slice(s,s+e)),s+=e;return n}function w0(t,e){const n=(t||"").trim();return[`${n?`Thanks for the details on "${n}".`:"Thanks for the upload."} ${e?"I reviewed the file and captured the critique highlights below:":"Here is a quick critique outline to confirm before I log the request:"}`,"","- Narrative clarity: tighten the opening 3 seconds.","- Visual hierarchy: spotlight the primary CTA earlier.","- Audio mix: reduce music by about 3dB under VO.","- Export: keep 1080x1920, 29.97fps.","","Reply with any edits or confirm if I should submit to the reviewer."].join(`
`)}function l4(t){return[{action_id:"approve_reviewer",label:"Approve",workflow_id:t,variant:"secondary"},{action_id:"reject_reviewer",label:"Reject",workflow_id:t,variant:"ghost"}]}function c4(t){let e=!1;return t&&(t.aborted?e=!0:t.addEventListener("abort",()=>{e=!0},{once:!0})),()=>e}function u4(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function d4(){const t=cT(br),e=uT(br),n=r4(br),s=dT(br),r=lT(br),i=pT(br),o=Oi(br),a=hT(br),l=fT(br);return{mode:"month",period:"2025-02",tasks:br,summary:t,pie:e,reviewer:n,summary_videographers:s,videographers:r,quick_stats:i,status_counts:o,pending_reviews:a,response_times:l}}async function h4({mode:t,period:e}={}){return await fr(240),{...d4(),mode:t||"month",period:e||"2025-02"}}async function f4(){return await fr(200),i4}async function p4({file:t,message:e,sessionId:n}){await fr(200);const s=n||`vc-session-${Date.now()}`,r=`vc-file-${Date.now()}`;return u4(t)?{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",type:"video",message:"Video received. Which task number is this for?",session_id:s}:{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",file_url:URL.createObjectURL(t),type:"image",response:w0(e,!0),session_id:s,timestamp:new Date().toISOString()}}async function m4({file:t}){return await fr(200),{file_id:`vc-asset-${Date.now()}`,filename:(t==null?void 0:t.name)||"attachment",file_url:URL.createObjectURL(t)}}async function g4({file:t,taskNumber:e}){return await fr(260),{success:!0,file_id:`vc-video-${Date.now()}`,workflow_id:`workflow-${Date.now()}`,version:1,message:`Video uploaded successfully (v1) for task #${e}`}}async function x4({command:t,args:e,sessionId:n}){await fr(200);const s=n||`vc-session-${Date.now()}`,r=(t||"").toLowerCase(),i=(e||"").trim();return r?r==="help"?{success:!0,command:r,response:`**Video Critique Commands**

- /log or /design - Start a new design request
- /recent - Export recent task data
- /edit <task_number> - Edit an existing task
- /delete <task_number> - Delete a task

You can also paste briefs or upload images/videos.`,session_id:s}:r==="log"||r==="design"?{success:!0,command:r,response:w0(i||"I want to log a design request",!1),session_id:s}:r==="edit"?{success:!0,command:r,response:i?"Editing task "+i+". Which fields should I update?":"Please provide a task number: /edit <task_number>",session_id:s}:r==="delete"?{success:!0,command:r,response:i?"Delete request queued for task "+i+". Confirm to proceed.":"Please provide a task number: /delete <task_number>",session_id:s}:r==="recent"?{success:!0,command:r,response:"Preparing the latest export. I will send the download link shortly.",session_id:s}:{success:!1,command:r,error:"Unknown command: /"+r+". Use /help for available commands.",session_id:s}:{success:!1,command:"",error:"Unknown command: /. Use /help for available commands.",session_id:s}}async function y4({actionId:t,workflowId:e}){return await fr(200),t==="reject_reviewer"||t==="return_hos"?{success:!0,message:"Please provide rejection details.",requires_form:!0,form_type:t==="return_hos"?"return":"rejection",workflow_id:e}:{success:!0,message:`Action ${t} applied for ${e}.`}}async function v4({formType:t,workflowId:e}){return await fr(200),{success:!0,message:`${t} submitted for ${e}.`}}async function b4(t){return await fr(120),t==="return"?{title:"Return for Revision",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be revised..."}]}:{title:"Reject Video",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be fixed..."}]}}function w4(t){return t!=null&&t.preview_url?t.preview_url:t!=null&&t.file_url?t.file_url:t!=null&&t.url?t.url:null}async function k4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){const a=c4(o);try{const l=t||`vc-session-${Date.now()}`;if(a()||(await fr(180),a()))return;const u=w0(e,!1),d=a4(u,48);for(const h of d){if(a())return;s==null||s({type:"delta",content:h}),await fr(90)}if(a())return;s==null||s({type:"text_done",content:u}),n!=null&&n.length&&(s==null||s({type:"files",files:n.map((h,f)=>({file_id:h,filename:f===0?"Brief.pdf":`Attachment-${f+1}.pdf`,file_url:`https://example.com/mock-${h}.pdf`}))})),(e||"").toLowerCase().includes("approval")&&(s==null||s({type:"actions",actions:l4(o4[0].workflow_id)})),s==null||s({type:"done",session_id:l}),r==null||r()}catch(l){throw s==null||s({type:"error",message:(l==null?void 0:l.message)||"Stream failed"}),i==null||i(l),l}}async function _4(t){return h4(t)}async function S4(){return f4()}async function j4({file:t,message:e,sessionId:n}){return p4({file:t,message:e,sessionId:n})}async function C4({file:t}){return m4({file:t})}async function Yk({file:t,taskNumber:e}){return g4({file:t,taskNumber:e})}async function N4({command:t,args:e,sessionId:n}){return x4({command:t,args:e,sessionId:n})}async function E4({actionId:t,workflowId:e}){return y4({actionId:t,workflowId:e})}async function T4({formType:t,workflowId:e,category:n,reason:s}){return v4({formType:t,workflowId:e})}async function P4(t){return b4(t)}function R4(t){return w4(t)}async function A4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){return k4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o})}function $d(t,e,n){Array.isArray(n)&&n.filter(Boolean).forEach(s=>t.append(e,s))}async function O4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;$d(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return Oe(`/api/assets/networks${s?`?${s}`:""}`)}async function I4({companies:t,networkId:e,activeOnly:n=!0}={}){const s=new URLSearchParams;$d(s,"companies",t),e!=null&&s.set("network_id",String(e)),n!==void 0&&s.set("active_only",String(n));const r=s.toString();return Oe(`/api/assets/asset-types${r?`?${r}`:""}`)}async function M4({companies:t,networkId:e,typeId:n,activeOnly:s=!0}={}){const r=new URLSearchParams;$d(r,"companies",t),e!=null&&r.set("network_id",String(e)),n!=null&&r.set("type_id",String(n)),s!==void 0&&r.set("active_only",String(s));const i=r.toString();return Oe(`/api/assets/network-assets${i?`?${i}`:""}`)}async function D4({companies:t,networkId:e,typeId:n,activeOnly:s=!0,includeEligibility:r=!1}={}){const i=new URLSearchParams;$d(i,"companies",t),e!=null&&i.set("network_id",String(e)),n!=null&&i.set("type_id",String(n)),s!==void 0&&i.set("active_only",String(s)),r!==void 0&&i.set("include_eligibility",String(r));const o=i.toString();return Oe(`/api/assets/locations${o?`?${o}`:""}`)}async function L4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;$d(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return Oe(`/api/assets/packages${s?`?${s}`:""}`)}const $4={chat:"chat",video_critique:"video_critique",mockup:["mockup_setup","mockup_generate"],proposals:"proposals",asset_management:"asset_management"},ky={chat:{to:"/app/chat",label:"AI Chat Assistant",icon:qI},video_critique:{to:"/app/video-critique",label:"Video Critique",icon:pf},mockup:{to:"/app/mockup",label:"Mockup Assistant",icon:WI},proposals:{to:"/app/proposals",label:"Proposal Assistant",icon:YI},admin:{to:"/app/admin",label:"Admin",icon:XI},asset_management:{to:"/app/asset-management",label:"Asset Management",icon:GI},settings:{to:"/app/settings",label:"Settings",icon:ZC}},F4=["chat","mockup","proposals","video_critique","admin","asset_management","settings"];function z4(t){return t.includes("/app/video-critique")?"Video Critique":t.includes("/app/chat")?"AI Chat Assistant":t.includes("/app/mockup")?"Mockup Assistant":t.includes("/app/proposals")?"Proposal Assistant":t.includes("/app/notifications")?"Notifications":t.includes("/app/admin")?"Admin Panel":t.includes("/app/asset-management")?"Asset Management":t.includes("/app/settings")?"Settings":"Workspace"}function B4(t){const e=[{name:"sales",tools:["chat","video_critique","mockup","proposals"],sort_order:1}];return Td(t)&&e.push({name:"core",tools:["admin"],sort_order:100}),e}function U4(t,e){var a;const s=[...((a=t==null?void 0:t.modules)!=null&&a.length?t.modules:B4(e))||[]].sort((l,u)=>(l.sort_order||0)-(u.sort_order||0)),r=new Set;s.forEach(l=>{(l.tools||[]).forEach(u=>{r.add(u==="ai_costs"?"costs":u)})}),r.has("chat")&&r.add("video_critique"),Td(e)&&(r.add("admin"),r.add("asset_management")),r.add("settings");const i=[],o=new Set;return F4.forEach(l=>{if(!r.has(l))return;const u=ky[l];u&&!o.has(u.to)&&(o.add(u.to),i.push(u))}),i}function H4(t,e){if(!e)return!0;const n=$4[t];return n?Array.isArray(n)?n.some(s=>e[s]!==!1):e[n]!==!1:!0}function W4(){const{user:t,logout:e}=mi(),n=lc(),s=jd(),[r,i]=v.useState(!1),[o,a]=v.useState(!1),l=Ht({queryKey:["modules","accessible"],queryFn:aB}),u=Ht({queryKey:["service-visibility"],queryFn:v0,staleTime:3e4}),d=v.useMemo(()=>((t==null?void 0:t.name)||"User").split(" ").slice(0,2).map(b=>b[0]).join("").toUpperCase(),[t]),h=v.useMemo(()=>U4(l.data,t),[l.data,t]),f=p=>{const b=u.data,x=Object.keys(ky).find(y=>ky[y].to===p.to);return H4(x,b)};return u.isLoading&&!u.data?c.jsx("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-neutral-950",children:c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-black/10 border-t-black/50 dark:border-white/10 dark:border-t-white/50"}),c.jsx("span",{className:"text-sm text-black/50 dark:text-white/50",children:"Loading..."})]})}):c.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[c.jsx("header",{className:"sticky top-0 z-40",children:c.jsx("div",{className:"w-full px-6 lg:px-10",children:c.jsx("div",{className:"mmg-header-card mt-4 rounded-2xl bg-white/65 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 gap-3",children:[c.jsxs("div",{className:"flex items-end gap-3",children:[c.jsx(lN,{size:64}),c.jsx("div",{className:"hidden sm:block text-sm leading-none text-black/50 dark:text-white/60 relative -top-px",children:"|"}),c.jsx("div",{className:"hidden sm:block text-sm font-medium leading-none text-black/70 dark:text-white/70",children:z4(n.pathname)})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl lg:hidden",onClick:()=>a(!0),title:"Open sidebar","aria-label":"Open sidebar",children:c.jsx(Vm,{size:18})}),c.jsx(iB,{}),c.jsx(AN,{}),c.jsxs(Jp,{children:[c.jsx(Zp,{asChild:!0,children:c.jsxs("button",{className:"flex items-center gap-2 rounded-2xl px-2.5 py-1.5 hover:bg-black/5 dark:hover:bg-white/10 transition-colors","aria-label":"User menu",children:[c.jsx("div",{className:"h-9 w-9 rounded-2xl bg-black/5 dark:bg-white/10 flex items-center justify-center shadow-soft",children:c.jsx("span",{className:"text-xs font-semibold",children:d})}),c.jsxs("div",{className:"hidden sm:flex flex-col items-start leading-tight",children:[c.jsx("span",{className:"mmg-brand-gold text-sm font-medium",children:t==null?void 0:t.name}),c.jsx("span",{className:"text-xs text-black/50 dark:text-white/60",children:t==null?void 0:t.email})]})]})}),c.jsxs(Dd,{align:"end",children:[c.jsx(rT,{children:c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("span",{className:"truncate",children:t==null?void 0:t.email}),c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:((t==null?void 0:t.roles)||[]).join(" | ")})]})}),c.jsx(up,{}),c.jsxs(Qu,{onSelect:()=>s("/app/settings"),children:[c.jsx(ZC,{size:16}),"Settings"]}),c.jsxs(Qu,{onSelect:()=>{e(),s("/")},children:[c.jsx(VI,{size:16}),"Logout"]})]})]})]})]})})})}),c.jsx(oB,{}),c.jsx("div",{className:"w-full px-6 lg:px-10 pb-4 flex-1 flex overflow-hidden min-w-0",children:c.jsxs("div",{className:Te("mt-4 grid grid-cols-1 gap-4 lg:grid-cols-[280px_1fr] flex-1 min-h-0 min-w-0","transition-[grid-template-columns] duration-500",r&&"lg:grid-cols-[64px_1fr] 2xl:grid-cols-[72px_1fr]"),children:[c.jsxs("aside",{className:Te("hidden lg:block rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10","overflow-hidden"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:Te("text-s ms-3 font-semibold tracking-wide text-black/50 dark:text-white/60",r&&"hidden lg:block lg:sr-only"),children:"Tools"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>i(p=>!p),title:"Toggle sidebar","aria-label":"Toggle sidebar",children:c.jsx(Vm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-2",children:h.map(p=>{const b=n.pathname===p.to||n.pathname.startsWith(`${p.to}/`),x=p.icon,y=f(p);return c.jsx("div",{className:Te("mmg-nav-item",!y&&"mmg-nav-item-hidden"),children:c.jsxs("button",{onClick:()=>s(p.to),className:Te("mmg-nav-btn w-full flex items-center gap-3 rounded-2xl p-2 text-sm transition-colors mb-1.5 shadow-soft",b?"mmg-nav-btn-active":"","text-base",r&&"lg:justify-center lg:gap-0"),tabIndex:y?0:-1,children:[c.jsx("span",{className:"mmg-nav-icon h-8 w-8 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(x,{size:22})}),c.jsx("span",{className:Te("min-w-0 truncate",r&&"hidden"),children:p.label})]})},p.to)})}),c.jsx("div",{className:"px-3 pb-3 pt-1",children:c.jsx("div",{className:Te("h-px bg-black/5 dark:bg-white/10",r&&"lg:mx-auto lg:w-10")})})]}),c.jsx("main",{className:"min-h-0 min-w-0 h-full",children:c.jsx(qO,{})})]})}),c.jsxs("div",{className:Te("fixed inset-0 z-50 lg:hidden",o?"pointer-events-auto":"pointer-events-none"),children:[c.jsx("div",{className:Te("absolute inset-0 bg-black/40 transition-opacity",o?"opacity-100":"opacity-0"),onClick:()=>a(!1)}),c.jsxs("aside",{className:Te("absolute inset-y-0 left-0 w-72 max-w-full rounded-r-2xl bg-white/90 dark:bg-neutral-900/95","backdrop-blur-xl shadow-2xl ring-1 ring-black/10 dark:ring-white/10","transition-transform duration-200",o?"translate-x-0":"-translate-x-full"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:"text-sm font-semibold tracking-wide text-black/60 dark:text-white/70",children:"Tools"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>a(!1),title:"Close sidebar","aria-label":"Close sidebar",children:c.jsx(Vm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-3",children:h.map(p=>{const b=n.pathname===p.to||n.pathname.startsWith(`${p.to}/`),x=p.icon,y=f(p);return c.jsx("div",{className:Te("mmg-nav-item",!y&&"mmg-nav-item-hidden"),children:c.jsxs("button",{onClick:()=>{s(p.to),a(!1)},className:Te("mmg-nav-btn w-full flex items-center gap-2.5 rounded-2xl p-2.5 text-sm transition-colors mb-1.5 shadow-soft",b?"mmg-nav-btn-active":"","text-sm"),tabIndex:y?0:-1,children:[c.jsx("span",{className:"mmg-nav-icon h-9 w-9 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(x,{size:20})}),c.jsx("span",{className:"min-w-0 truncate",children:p.label})]})},p.to)})})]})]})]})}const tm=0,ko=1,pc=2,mT=4;function Qk(t){return()=>t}function V4(t){t()}function gT(t,e){return n=>t(e(n))}function Xk(t,e){return()=>t(e)}function q4(t,e){return n=>t(e,n)}function k0(t){return t!==void 0}function K4(...t){return()=>{t.map(V4)}}function mc(){}function nm(t,e){return e(t),t}function G4(t,e){return e(t)}function Rt(...t){return t}function dt(t,e){return t(ko,e)}function Ge(t,e){t(tm,e)}function _0(t){t(pc)}function Mt(t){return t(mT)}function Pe(t,e){return dt(t,q4(e,tm))}function cr(t,e){const n=t(ko,s=>{n(),e(s)});return n}function Jk(t){let e,n;return s=>r=>{e=r,n&&clearTimeout(n),n=setTimeout(()=>{s(e)},t)}}function xT(t,e){return t===e}function Tt(t=xT){let e;return n=>s=>{t(e,s)||(e=s,n(s))}}function He(t){return e=>n=>{t(n)&&e(n)}}function we(t){return e=>gT(e,t)}function Pr(t){return e=>()=>{e(t)}}function ie(t,...e){const n=Y4(...e);return(s,r)=>{switch(s){case pc:_0(t);return;case ko:return dt(t,n(r))}}}function Mr(t,e){return n=>s=>{n(e=t(e,s))}}function wa(t){return e=>n=>{t>0?t--:e(n)}}function oi(t){let e=null,n;return s=>r=>{e=r,!n&&(n=setTimeout(()=>{n=void 0,s(e)},t))}}function Qe(...t){const e=new Array(t.length);let n=0,s=null;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);dt(i,l=>{const u=n;n=n|a,e[o]=l,u!==r&&n===r&&s&&(s(),s=null)})}),i=>o=>{const a=()=>{i([o].concat(e))};n===r?a():s=a}}function Y4(...t){return e=>t.reduceRight(G4,e)}function Q4(t){let e,n;const s=()=>e==null?void 0:e();return function(r,i){switch(r){case ko:return i?n===i?void 0:(s(),n=i,e=dt(t,i),e):(s(),mc);case pc:s(),n=null;return}}}function he(t){let e=t;const n=et();return(s,r)=>{switch(s){case tm:e=r;break;case ko:{r(e);break}case mT:return e}return n(s,r)}}function An(t,e){return nm(he(e),n=>Pe(t,n))}function et(){const t=[];return(e,n)=>{switch(e){case tm:t.slice().forEach(s=>{s(n)});return;case pc:t.splice(0,t.length);return;case ko:return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}}}function Ns(t){return nm(et(),e=>Pe(t,e))}function at(t,e=[],{singleton:n}={singleton:!0}){return{constructor:t,dependencies:e,id:X4(),singleton:n}}const X4=()=>Symbol();function J4(t){const e=new Map,n=({constructor:s,dependencies:r,id:i,singleton:o})=>{if(o&&e.has(i))return e.get(i);const a=s(r.map(l=>n(l)));return o&&e.set(i,a),a};return n(t)}function nn(...t){const e=et(),n=new Array(t.length);let s=0;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);dt(i,l=>{n[o]=l,s=s|a,s===r&&Ge(e,n)})}),function(i,o){switch(i){case pc:{_0(e);return}case ko:return s===r&&o(n),dt(e,o)}}}function Ue(t,e=xT){return ie(t,Tt(e))}function _y(...t){return function(e,n){switch(e){case pc:return;case ko:return K4(...t.map(s=>dt(s,n)))}}}var cs=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t))(cs||{});const Z4={0:"debug",3:"error",1:"log",2:"warn"},e6=()=>typeof globalThis>"u"?window:globalThis,_o=at(()=>{const t=he(3);return{log:he((e,n,s=1)=>{var r;const i=(r=e6().VIRTUOSO_LOG_LEVEL)!=null?r:Mt(t);s>=i&&console[Z4[s]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,n)}),logLevel:t}},[],{singleton:!0});function Ra(t,e,n){return S0(t,e,n).callbackRef}function S0(t,e,n){const s=ge.useRef(null);let r=o=>{};const i=ge.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const a=()=>{const l=o[0].target;l.offsetParent!==null&&t(l)};n?a():requestAnimationFrame(a)}):null,[t,n]);return r=o=>{o&&e?(i==null||i.observe(o),s.current=o):(s.current&&(i==null||i.unobserve(s.current)),s.current=null)},{callbackRef:r,ref:s}}function t6(t,e,n,s,r,i,o,a,l){const u=ge.useCallback(d=>{const h=n6(d.children,e,a?"offsetWidth":"offsetHeight",r);let f=d.parentElement;for(;!f.dataset.virtuosoScroller;)f=f.parentElement;const p=f.lastElementChild.dataset.viewportType==="window";let b;p&&(b=f.ownerDocument.defaultView);const x=o?a?o.scrollLeft:o.scrollTop:p?a?b.scrollX||b.document.documentElement.scrollLeft:b.scrollY||b.document.documentElement.scrollTop:a?f.scrollLeft:f.scrollTop,y=o?a?o.scrollWidth:o.scrollHeight:p?a?b.document.documentElement.scrollWidth:b.document.documentElement.scrollHeight:a?f.scrollWidth:f.scrollHeight,g=o?a?o.offsetWidth:o.offsetHeight:p?a?b.innerWidth:b.innerHeight:a?f.offsetWidth:f.offsetHeight;s({scrollHeight:y,scrollTop:Math.max(x,0),viewportHeight:g}),i==null||i(a?Zk("column-gap",getComputedStyle(d).columnGap,r):Zk("row-gap",getComputedStyle(d).rowGap,r)),h!==null&&t(h)},[t,e,r,i,o,s,a]);return S0(u,n,l)}function n6(t,e,n,s){const r=t.length;if(r===0)return null;const i=[];for(let o=0;o<r;o++){const a=t.item(o);if(a.dataset.index===void 0)continue;const l=parseInt(a.dataset.index),u=parseFloat(a.dataset.knownSize),d=e(a,n);if(d===0&&s("Zero-sized element, this should not happen",{child:a},cs.ERROR),d===u)continue;const h=i[i.length-1];i.length===0||h.size!==d||h.endIndex!==l-1?i.push({endIndex:l,size:d,startIndex:l}):i[i.length-1].endIndex++}return i}function Zk(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,cs.WARN),e==="normal"?0:parseInt(e??"0",10)}function yT(t,e,n){const s=ge.useRef(null),r=ge.useCallback(l=>{if(!(l!=null&&l.offsetParent))return;const u=l.getBoundingClientRect(),d=u.width;let h,f;if(e){const p=e.getBoundingClientRect(),b=u.top-p.top;f=p.height-Math.max(0,b),h=b+e.scrollTop}else{const p=o.current.ownerDocument.defaultView;f=p.innerHeight-Math.max(0,u.top),h=u.top+p.scrollY}s.current={offsetTop:h,visibleHeight:f,visibleWidth:d},t(s.current)},[t,e]),{callbackRef:i,ref:o}=S0(r,!0,n),a=ge.useCallback(()=>{r(o.current)},[r,o]);return ge.useEffect(()=>{var l;if(e){e.addEventListener("scroll",a);const u=new ResizeObserver(()=>{requestAnimationFrame(a)});return u.observe(e),()=>{e.removeEventListener("scroll",a),u.unobserve(e)}}else{const u=(l=o.current)==null?void 0:l.ownerDocument.defaultView;return u==null||u.addEventListener("scroll",a),u==null||u.addEventListener("resize",a),()=>{u==null||u.removeEventListener("scroll",a),u==null||u.removeEventListener("resize",a)}}},[a,e,o]),i}const qn=at(()=>{const t=et(),e=et(),n=he(0),s=et(),r=he(0),i=et(),o=et(),a=he(0),l=he(0),u=he(0),d=he(0),h=et(),f=et(),p=he(!1),b=he(!1),x=he(!1);return Pe(ie(t,we(({scrollTop:y})=>y)),e),Pe(ie(t,we(({scrollHeight:y})=>y)),o),Pe(e,r),{deviation:n,fixedFooterHeight:u,fixedHeaderHeight:l,footerHeight:d,headerHeight:a,horizontalDirection:b,scrollBy:f,scrollContainerState:t,scrollHeight:o,scrollingInProgress:p,scrollTo:h,scrollTop:e,skipAnimationFrameInResizeObserver:x,smoothScrollTargetReached:s,statefulScrollTop:r,viewportHeight:i}},[],{singleton:!0}),Ju={lvl:0};function vT(t,e){const n=t.length;if(n===0)return[];let{index:s,value:r}=e(t[0]);const i=[];for(let o=1;o<n;o++){const{index:a,value:l}=e(t[o]);i.push({end:a-1,start:s,value:r}),s=a,r=l}return i.push({end:1/0,start:s,value:r}),i}function bt(t){return t===Ju}function Zu(t,e){if(!bt(t))return e===t.k?t.v:e<t.k?Zu(t.l,e):Zu(t.r,e)}function pr(t,e,n="k"){if(bt(t))return[-1/0,void 0];if(Number(t[n])===e)return[t.k,t.v];if(Number(t[n])<e){const s=pr(t.r,e,n);return s[0]===-1/0?[t.k,t.v]:s}return pr(t.l,e,n)}function ks(t,e,n){return bt(t)?kT(e,n,1):e===t.k?un(t,{k:e,v:n}):e<t.k?e_(un(t,{l:ks(t.l,e,n)})):e_(un(t,{r:ks(t.r,e,n)}))}function Tl(){return Ju}function Pl(t,e,n){if(bt(t))return[];const s=pr(t,e)[0];return s6(jy(t,s,n))}function Sy(t,e){if(bt(t))return Ju;const{k:n,l:s,r}=t;if(e===n){if(bt(s))return r;if(bt(r))return s;{const[i,o]=wT(s);return bf(un(t,{k:i,l:bT(s),v:o}))}}else return e<n?bf(un(t,{l:Sy(s,e)})):bf(un(t,{r:Sy(r,e)}))}function Yo(t){return bt(t)?[]:[...Yo(t.l),{k:t.k,v:t.v},...Yo(t.r)]}function jy(t,e,n){if(bt(t))return[];const{k:s,l:r,r:i,v:o}=t;let a=[];return s>e&&(a=a.concat(jy(r,e,n))),s>=e&&s<=n&&a.push({k:s,v:o}),s<=n&&(a=a.concat(jy(i,e,n))),a}function bf(t){const{l:e,lvl:n,r:s}=t;if(s.lvl>=n-1&&e.lvl>=n-1)return t;if(n>s.lvl+1){if(yg(e))return _T(un(t,{lvl:n-1}));if(!bt(e)&&!bt(e.r))return un(e.r,{l:un(e,{r:e.r.l}),lvl:n,r:un(t,{l:e.r.r,lvl:n-1})});throw new Error("Unexpected empty nodes")}else{if(yg(t))return Cy(un(t,{lvl:n-1}));if(!bt(s)&&!bt(s.l)){const r=s.l,i=yg(r)?s.lvl-1:s.lvl;return un(r,{l:un(t,{lvl:n-1,r:r.l}),lvl:r.lvl+1,r:Cy(un(s,{l:r.r,lvl:i}))})}else throw new Error("Unexpected empty nodes")}}function un(t,e){return kT(e.k!==void 0?e.k:t.k,e.v!==void 0?e.v:t.v,e.lvl!==void 0?e.lvl:t.lvl,e.l!==void 0?e.l:t.l,e.r!==void 0?e.r:t.r)}function bT(t){return bt(t.r)?t.l:bf(un(t,{r:bT(t.r)}))}function yg(t){return bt(t)||t.lvl>t.r.lvl}function wT(t){return bt(t.r)?[t.k,t.v]:wT(t.r)}function kT(t,e,n,s=Ju,r=Ju){return{k:t,l:s,lvl:n,r,v:e}}function e_(t){return Cy(_T(t))}function _T(t){const{l:e}=t;return!bt(e)&&e.lvl===t.lvl?un(e,{r:un(t,{l:e.r})}):t}function Cy(t){const{lvl:e,r:n}=t;return!bt(n)&&!bt(n.r)&&n.lvl===e&&n.r.lvl===e?un(n,{l:un(t,{r:n.l}),lvl:e+1}):t}function s6(t){return vT(t,({k:e,v:n})=>({index:e,value:n}))}function ST(t,e){return!!(t&&t.startIndex===e.startIndex&&t.endIndex===e.endIndex)}function ed(t,e){return!!(t&&t[0]===e[0]&&t[1]===e[1])}const j0=at(()=>({recalcInProgress:he(!1)}),[],{singleton:!0});function jT(t,e,n){return t[dp(t,e,n)]}function dp(t,e,n,s=0){let r=t.length-1;for(;s<=r;){const i=Math.floor((s+r)/2),o=t[i],a=n(o,e);if(a===0)return i;if(a===-1){if(r-s<2)return i-1;r=i-1}else{if(r===s)return i;s=i+1}}throw new Error(`Failed binary finding record in array - ${t.join(",")}, searched for ${e}`)}function r6(t,e,n,s){const r=dp(t,e,s),i=dp(t,n,s,r);return t.slice(r,i+1)}function go(t,e){return Math.round(t.getBoundingClientRect()[e])}function sm(t){return!bt(t.groupOffsetTree)}function C0({index:t},e){return e===t?0:e<t?-1:1}function i6(){return{groupIndices:[],groupOffsetTree:Tl(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:Tl()}}function o6(t,e){let n=bt(t)?0:1/0;for(const s of e){const{endIndex:r,size:i,startIndex:o}=s;if(n=Math.min(n,o),bt(t)){t=ks(t,0,i);continue}const a=Pl(t,o-1,r+1);if(a.some(f6(s)))continue;let l=!1,u=!1;for(const{end:d,start:h,value:f}of a)l?(r>=h||i===f)&&(t=Sy(t,h)):(u=f!==i,l=!0),d>r&&r>=h&&f!==i&&(t=ks(t,r+1,f));u&&(t=ks(t,o,i))}return[t,n]}function a6(t){return typeof t.groupIndex<"u"}function l6({offset:t},e){return e===t?0:e<t?-1:1}function td(t,e,n){if(e.length===0)return 0;const{index:s,offset:r,size:i}=jT(e,t,C0),o=t-s,a=i*o+(o-1)*n+r;return a>0?a+n:a}function CT(t,e){if(!sm(e))return t;let n=0;for(;e.groupIndices[n]<=t+n;)n++;return t+n}function NT(t,e,n){if(a6(t))return e.groupIndices[t.groupIndex]+1;{const s=t.index==="LAST"?n:t.index;let r=CT(s,e);return r=Math.max(0,r,Math.min(n,r)),r}}function c6(t,e,n,s=0){return s>0&&(e=Math.max(e,jT(t,s,C0).offset)),vT(r6(t,e,n,l6),h6)}function u6(t,[e,n,s,r]){e.length>0&&s("received item sizes",e,cs.DEBUG);const i=t.sizeTree;let o=i,a=0;if(n.length>0&&bt(i)&&e.length===2){const f=e[0].size,p=e[1].size;o=n.reduce((b,x)=>ks(ks(b,x,f),x+1,p),o)}else[o,a]=o6(o,e);if(o===i)return t;const{lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h}=Ny(t.offsetTree,a,o,r);return{groupIndices:n,groupOffsetTree:n.reduce((f,p)=>ks(f,p,td(p,h,r)),Tl()),lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h,sizeTree:o}}function d6(t){return Yo(t).map(({k:e,v:n},s,r)=>{const i=r[s+1];return{endIndex:i?i.k-1:1/0,size:n,startIndex:e}})}function t_(t,e){let n=0,s=0;for(;n<t;)n+=e[s+1]-e[s]-1,s++;return s-(n===t?0:1)}function Ny(t,e,n,s){let r=t,i=0,o=0,a=0,l=0;if(e!==0){l=dp(r,e-1,C0),a=r[l].offset;const u=pr(n,e-1);i=u[0],o=u[1],r.length&&r[l].size===pr(n,e)[1]&&(l-=1),r=r.slice(0,l+1)}else r=[];for(const{start:u,value:d}of Pl(n,e,1/0)){const h=u-i,f=h*o+a+h*s;r.push({index:u,offset:f,size:d}),i=u,a=f,o=d}return{lastIndex:i,lastOffset:a,lastSize:o,offsetTree:r}}function h6(t){return{index:t.index,value:t}}function f6(t){const{endIndex:e,size:n,startIndex:s}=t;return r=>r.start===s&&(r.end===e||r.end===1/0)&&r.value===n}const p6={offsetHeight:"height",offsetWidth:"width"},Br=at(([{log:t},{recalcInProgress:e}])=>{const n=et(),s=et(),r=An(s,0),i=et(),o=et(),a=he(0),l=he([]),u=he(void 0),d=he(void 0),h=he(void 0),f=he(void 0),p=he((S,j)=>go(S,p6[j])),b=he(void 0),x=he(0),y=i6(),g=An(ie(n,Qe(l,t,x),Mr(u6,y),Tt()),y),m=An(ie(l,Tt(),Mr((S,j)=>({current:j,prev:S.current}),{current:[],prev:[]}),we(({prev:S})=>S)),[]);Pe(ie(l,He(S=>S.length>0),Qe(g,x),we(([S,j,N])=>{const R=S.reduce((M,O,D)=>ks(M,O,td(O,j.offsetTree,N)||D),Tl());return{...j,groupIndices:S,groupOffsetTree:R}})),g),Pe(ie(s,Qe(g),He(([S,{lastIndex:j}])=>S<j),we(([S,{lastIndex:j,lastSize:N}])=>[{endIndex:j,size:N,startIndex:S}])),n),Pe(u,d);const w=An(ie(u,we(S=>S===void 0)),!0);Pe(ie(d,He(S=>S!==void 0&&bt(Mt(g).sizeTree)),we(S=>{const j=Mt(h),N=Mt(l).length>0;return j?N?[{endIndex:0,size:j,startIndex:0},{endIndex:1,size:S,startIndex:1}]:[]:[{endIndex:0,size:S,startIndex:0}]})),n),Pe(ie(f,He(S=>S!==void 0&&S.length>0&&bt(Mt(g).sizeTree)),we(S=>{const j=[];let N=S[0],R=0;for(let M=1;M<S.length;M++){const O=S[M];O!==N&&(j.push({endIndex:M-1,size:N,startIndex:R}),N=O,R=M)}return j.push({endIndex:S.length-1,size:N,startIndex:R}),j})),n),Pe(ie(l,Qe(h,d),He(([,S,j])=>S!==void 0&&j!==void 0),we(([S,j,N])=>{const R=[];for(let M=0;M<S.length;M++){const O=S[M],D=S[M+1];R.push({startIndex:O,endIndex:O,size:j}),D!==void 0&&R.push({startIndex:O+1,endIndex:D-1,size:N})}return R})),n);const k=Ns(ie(n,Qe(g),Mr(({sizes:S},[j,N])=>({changed:N!==S,sizes:N}),{changed:!1,sizes:y}),we(S=>S.changed)));dt(ie(a,Mr((S,j)=>({diff:S.prev-j,prev:j}),{diff:0,prev:0}),we(S=>S.diff)),S=>{const{groupIndices:j}=Mt(g);if(S>0)Ge(e,!0),Ge(i,S+t_(S,j));else if(S<0){const N=Mt(m);N.length>0&&(S-=t_(-S,N)),Ge(o,S)}}),dt(ie(a,Qe(t)),([S,j])=>{S<0&&j("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},cs.ERROR)});const _=Ns(i);Pe(ie(i,Qe(g),we(([S,j])=>{const N=j.groupIndices.length>0,R=[],M=j.lastSize;if(N){const O=Zu(j.sizeTree,0);let D=0,$=0;for(;D<S;){const U=j.groupIndices[$],W=j.groupIndices.length===$+1?1/0:j.groupIndices[$+1]-U-1;R.push({endIndex:U,size:O,startIndex:U}),R.push({endIndex:U+1+W-1,size:M,startIndex:U+1}),$++,D+=W+1}const L=Yo(j.sizeTree);return D!==S&&L.shift(),L.reduce((U,{k:W,v:E})=>{let P=U.ranges;return U.prevSize!==0&&(P=[...U.ranges,{endIndex:W+S-1,size:U.prevSize,startIndex:U.prevIndex}]),{prevIndex:W+S,prevSize:E,ranges:P}},{prevIndex:S,prevSize:0,ranges:R}).ranges}return Yo(j.sizeTree).reduce((O,{k:D,v:$})=>({prevIndex:D+S,prevSize:$,ranges:[...O.ranges,{endIndex:D+S-1,size:O.prevSize,startIndex:O.prevIndex}]}),{prevIndex:0,prevSize:M,ranges:[]}).ranges})),n);const C=Ns(ie(o,Qe(g,x),we(([S,{offsetTree:j},N])=>{const R=-S;return td(R,j,N)})));return Pe(ie(o,Qe(g,x),we(([S,j,N])=>{if(j.groupIndices.length>0){if(bt(j.sizeTree))return j;let R=Tl();const M=Mt(m);let O=0,D=0,$=0;for(;O<-S;){$=M[D];const L=M[D+1]-$-1;D++,O+=L+1}if(R=Yo(j.sizeTree).reduce((L,{k:U,v:W})=>ks(L,Math.max(0,U+S),W),R),O!==-S){const L=Zu(j.sizeTree,$);R=ks(R,0,L);const U=pr(j.sizeTree,-S+1)[1];R=ks(R,1,U)}return{...j,sizeTree:R,...Ny(j.offsetTree,0,R,N)}}else{const R=Yo(j.sizeTree).reduce((M,{k:O,v:D})=>ks(M,Math.max(0,O+S),D),Tl());return{...j,sizeTree:R,...Ny(j.offsetTree,0,R,N)}}})),g),{beforeUnshiftWith:_,data:b,defaultItemSize:d,firstItemIndex:a,fixedItemSize:u,fixedGroupSize:h,gap:x,groupIndices:l,heightEstimates:f,itemSize:p,listRefresh:k,shiftWith:o,shiftWithOffset:C,sizeRanges:n,sizes:g,statefulTotalCount:r,totalCount:s,trackItemSizes:w,unshiftWith:i}},Rt(_o,j0),{singleton:!0});function m6(t){return t.reduce((e,n)=>(e.groupIndices.push(e.totalCount),e.totalCount+=n+1,e),{groupIndices:[],totalCount:0})}const ET=at(([{groupIndices:t,sizes:e,totalCount:n},{headerHeight:s,scrollTop:r}])=>{const i=et(),o=et(),a=Ns(ie(i,we(m6)));return Pe(ie(a,we(l=>l.totalCount)),n),Pe(ie(a,we(l=>l.groupIndices)),t),Pe(ie(nn(r,e,s),He(([l,u])=>sm(u)),we(([l,u,d])=>pr(u.groupOffsetTree,Math.max(l-d,0),"v")[0]),Tt(),we(l=>[l])),o),{groupCounts:i,topItemsIndexes:o}},Rt(Br,qn)),So=at(([{log:t}])=>{const e=he(!1),n=Ns(ie(e,He(s=>s),Tt()));return dt(e,s=>{s&&Mt(t)("props updated",{},cs.DEBUG)}),{didMount:n,propsReady:e}},Rt(_o),{singleton:!0}),g6=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function TT(t){const e=typeof t=="number"?{index:t}:t;return e.align||(e.align="start"),(!e.behavior||!g6)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const Fd=at(([{gap:t,listRefresh:e,sizes:n,totalCount:s},{fixedFooterHeight:r,fixedHeaderHeight:i,footerHeight:o,headerHeight:a,scrollingInProgress:l,scrollTo:u,smoothScrollTargetReached:d,viewportHeight:h},{log:f}])=>{const p=et(),b=et(),x=he(0);let y=null,g=null,m=null;function w(){y&&(y(),y=null),m&&(m(),m=null),g&&(clearTimeout(g),g=null),Ge(l,!1)}return Pe(ie(p,Qe(n,h,s,x,a,o,f),Qe(t,i,r),we(([[k,_,C,S,j,N,R,M],O,D,$])=>{const L=TT(k),{align:U,behavior:W,offset:E}=L,P=S-1,A=NT(L,_,P);let F=td(A,_.offsetTree,O)+N;U==="end"?(F+=D+pr(_.sizeTree,A)[1]-C+$,A===P&&(F+=R)):U==="center"?F+=(D+pr(_.sizeTree,A)[1]-C+$)/2:F-=j,E&&(F+=E);const z=G=>{w(),G?(M("retrying to scroll to",{location:k},cs.DEBUG),Ge(p,k)):(Ge(b,!0),M("list did not change, scroll successful",{},cs.DEBUG))};if(w(),W==="smooth"){let G=!1;m=dt(e,q=>{G=G||q}),y=cr(d,()=>{z(G)})}else y=cr(ie(e,x6(150)),z);return g=setTimeout(()=>{w()},1200),Ge(l,!0),M("scrolling from index to",{behavior:W,index:A,top:F},cs.DEBUG),{behavior:W,top:F}})),u),{scrollTargetReached:b,scrollToIndex:p,topListHeight:x}},Rt(Br,qn,_o),{singleton:!0});function x6(t){return e=>{const n=setTimeout(()=>{e(!1)},t);return s=>{s&&(e(!0),clearTimeout(n))}}}function N0(t,e){t==0?e():requestAnimationFrame(()=>{N0(t-1,e)})}function E0(t,e){const n=e-1;return typeof t=="number"?t:t.index==="LAST"?n:t.index}const zd=at(([{defaultItemSize:t,listRefresh:e,sizes:n},{scrollTop:s},{scrollTargetReached:r,scrollToIndex:i},{didMount:o}])=>{const a=he(!0),l=he(0),u=he(!0);return Pe(ie(o,Qe(l),He(([d,h])=>!!h),Pr(!1)),a),Pe(ie(o,Qe(l),He(([d,h])=>!!h),Pr(!1)),u),dt(ie(nn(e,o),Qe(a,n,t,u),He(([[,d],h,{sizeTree:f},p,b])=>d&&(!bt(f)||k0(p))&&!h&&!b),Qe(l)),([,d])=>{cr(r,()=>{Ge(u,!0)}),N0(4,()=>{cr(s,()=>{Ge(a,!0)}),Ge(i,d)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:l,scrolledToInitialItem:a}},Rt(Br,qn,Fd,So),{singleton:!0});function PT(t,e){return Math.abs(t-e)<1.01}const nd="up",fu="down",y6="none",v6={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},b6=0,Bd=at(([{footerHeight:t,headerHeight:e,scrollBy:n,scrollContainerState:s,scrollTop:r,viewportHeight:i}])=>{const o=he(!1),a=he(!0),l=et(),u=et(),d=he(4),h=he(b6),f=An(ie(_y(ie(Ue(r),wa(1),Pr(!0)),ie(Ue(r),wa(1),Pr(!1),Jk(100))),Tt()),!1),p=An(ie(_y(ie(n,Pr(!0)),ie(n,Pr(!1),Jk(200))),Tt()),!1);Pe(ie(nn(Ue(r),Ue(h)),we(([m,w])=>m<=w),Tt()),a),Pe(ie(a,oi(50)),u);const b=Ns(ie(nn(s,Ue(i),Ue(e),Ue(t),Ue(d)),Mr((m,[{scrollHeight:w,scrollTop:k},_,C,S,j])=>{const N=k+_-w>-j,R={scrollHeight:w,scrollTop:k,viewportHeight:_};if(N){let O,D;return k>m.state.scrollTop?(O="SCROLLED_DOWN",D=m.state.scrollTop-k):(O="SIZE_DECREASED",D=m.state.scrollTop-k||m.scrollTopDelta),{atBottom:!0,atBottomBecause:O,scrollTopDelta:D,state:R}}let M;return R.scrollHeight>m.state.scrollHeight?M="SIZE_INCREASED":_<m.state.viewportHeight?M="VIEWPORT_HEIGHT_DECREASING":k<m.state.scrollTop?M="SCROLLING_UPWARDS":M="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:M,state:R}},v6),Tt((m,w)=>m&&m.atBottom===w.atBottom))),x=An(ie(s,Mr((m,{scrollHeight:w,scrollTop:k,viewportHeight:_})=>{if(PT(m.scrollHeight,w))return{changed:!1,jump:0,scrollHeight:w,scrollTop:k};{const C=w-(k+_)<1;return m.scrollTop!==k&&C?{changed:!0,jump:m.scrollTop-k,scrollHeight:w,scrollTop:k}:{changed:!0,jump:0,scrollHeight:w,scrollTop:k}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),He(m=>m.changed),we(m=>m.jump)),0);Pe(ie(b,we(m=>m.atBottom)),o),Pe(ie(o,oi(50)),l);const y=he(fu);Pe(ie(s,we(({scrollTop:m})=>m),Tt(),Mr((m,w)=>Mt(p)?{direction:m.direction,prevScrollTop:w}:{direction:w<m.prevScrollTop?nd:fu,prevScrollTop:w},{direction:fu,prevScrollTop:0}),we(m=>m.direction)),y),Pe(ie(s,oi(50),Pr(y6)),y);const g=he(0);return Pe(ie(f,He(m=>!m),Pr(0)),g),Pe(ie(r,oi(100),Qe(f),He(([m,w])=>w),Mr(([m,w],[k])=>[w,k],[0,0]),we(([m,w])=>w-m)),g),{atBottomState:b,atBottomStateChange:l,atBottomThreshold:d,atTopStateChange:u,atTopThreshold:h,isAtBottom:o,isAtTop:a,isScrolling:f,lastJumpDueToItemResize:x,scrollDirection:y,scrollVelocity:g}},Rt(qn)),sd="top",rd="bottom",n_="none";function s_(t,e,n){return typeof t=="number"?n===nd&&e===sd||n===fu&&e===rd?t:0:n===nd?e===sd?t.main:t.reverse:e===rd?t.main:t.reverse}function r_(t,e){var n;return typeof t=="number"?t:(n=t[e])!=null?n:0}const T0=at(([{deviation:t,fixedHeaderHeight:e,headerHeight:n,scrollTop:s,viewportHeight:r}])=>{const i=et(),o=he(0),a=he(0),l=he(0),u=An(ie(nn(Ue(s),Ue(r),Ue(n),Ue(i,ed),Ue(l),Ue(o),Ue(e),Ue(t),Ue(a)),we(([d,h,f,[p,b],x,y,g,m,w])=>{const k=d-m,_=y+g,C=Math.max(f-k,0);let S=n_;const j=r_(w,sd),N=r_(w,rd);return p-=m,p+=f+g,b+=f+g,b-=m,p>d+_-j&&(S=nd),b<d-C+h+N&&(S=fu),S!==n_?[Math.max(k-f-s_(x,sd,S)-j,0),k-C-g+h+s_(x,rd,S)+N]:null}),He(d=>d!=null),Tt(ed)),[0,0]);return{increaseViewportBy:a,listBoundary:i,overscan:l,topListHeight:o,visibleRange:u}},Rt(qn),{singleton:!0});function w6(t,e,n){if(sm(e)){const s=CT(t,e);return[{index:pr(e.groupOffsetTree,s)[0],offset:0,size:0},{data:n==null?void 0:n[0],index:s,offset:0,size:0}]}return[{data:n==null?void 0:n[0],index:t,offset:0,size:0}]}const vg={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function wf(t,e,n,s,r,i){const{lastIndex:o,lastOffset:a,lastSize:l}=r;let u=0,d=0;if(t.length>0){u=t[0].offset;const x=t[t.length-1];d=x.offset+x.size}const h=n-o,f=a+h*l+(h-1)*s,p=u,b=f-d;return{bottom:d,firstItemIndex:i,items:i_(t,r,i),offsetBottom:b,offsetTop:u,top:p,topItems:i_(e,r,i),topListHeight:e.reduce((x,y)=>y.size+x,0),totalCount:n}}function RT(t,e,n,s,r,i){let o=0;if(n.groupIndices.length>0)for(const d of n.groupIndices){if(d-o>=t)break;o++}const a=t+o,l=E0(e,a),u=Array.from({length:a}).map((d,h)=>({data:i[h+l],index:h+l,offset:0,size:0}));return wf(u,[],a,r,n,s)}function i_(t,e,n){if(t.length===0)return[];if(!sm(e))return t.map(u=>({...u,index:u.index+n,originalIndex:u.index}));const s=t[0].index,r=t[t.length-1].index,i=[],o=Pl(e.groupOffsetTree,s,r);let a,l=0;for(const u of t){(!a||a.end<u.index)&&(a=o.shift(),l=e.groupIndices.indexOf(a.start));let d;u.index===a.start?d={index:l,type:"group"}:d={groupIndex:l,index:u.index-(l+1)+n},i.push({...d,data:u.data,offset:u.offset,originalIndex:u.index,size:u.size})}return i}function o_(t,e){var n;return t===void 0?0:typeof t=="number"?t:(n=t[e])!=null?n:0}const Aa=at(([{data:t,firstItemIndex:e,gap:n,sizes:s,totalCount:r},i,{listBoundary:o,topListHeight:a,visibleRange:l},{initialTopMostItemIndex:u,scrolledToInitialItem:d},{topListHeight:h},f,{didMount:p},{recalcInProgress:b}])=>{const x=he([]),y=he(0),g=et(),m=he(0);Pe(i.topItemsIndexes,x);const w=An(ie(nn(p,b,Ue(l,ed),Ue(r),Ue(s),Ue(u),d,Ue(x),Ue(e),Ue(n),Ue(m),t),He(([S,j,,N,,,,,,,,R])=>{const M=R&&R.length!==N;return S&&!j&&!M}),we(([,,[S,j],N,R,M,O,D,$,L,U,W])=>{var E,P,A,F;const z=R,{offsetTree:G,sizeTree:q}=z,B=Mt(y);if(N===0)return{...vg,totalCount:N};if(S===0&&j===0)return B===0?{...vg,totalCount:N}:RT(B,M,R,$,L,W||[]);if(bt(q))return B>0?null:wf(w6(E0(M,N),z,W),[],N,L,z,$);const Q=[];if(D.length>0){const Le=D[0],Y=D[D.length-1];let ae=0;for(const le of Pl(q,Le,Y)){const oe=le.value,re=Math.max(le.start,Le),_e=Math.min(le.end,Y);for(let se=re;se<=_e;se++)Q.push({data:W==null?void 0:W[se],index:se,offset:ae,size:oe}),ae+=oe}}if(!O)return wf([],Q,N,L,z,$);const pe=D.length>0?D[D.length-1]+1:0,Z=c6(G,S,j,pe);if(Z.length===0)return null;const be=N-1,De=nm([],Le=>{for(const Y of Z){const ae=Y.value;let le=ae.offset,oe=Y.start;const re=ae.size;if(ae.offset<S){oe+=Math.floor((S-ae.offset+L)/(re+L));const se=oe-Y.start;le+=se*re+se*L}oe<pe&&(le+=(pe-oe)*re,oe=pe);const _e=Math.min(Y.end,be);for(let se=oe;se<=_e&&!(le>=j);se++)Le.push({data:W==null?void 0:W[se],index:se,offset:le,size:re}),le+=re+L}}),xe=o_(U,sd),me=o_(U,rd);if(De.length>0&&(xe>0||me>0)){const Le=De[0],Y=De[De.length-1];if(xe>0&&Le.index>pe){const ae=Math.min(xe,Le.index-pe),le=[];let oe=Le.offset;for(let re=Le.index-1;re>=Le.index-ae;re--){const _e=(P=(E=Pl(q,re,re)[0])==null?void 0:E.value)!=null?P:Le.size;oe-=_e+L,le.unshift({data:W==null?void 0:W[re],index:re,offset:oe,size:_e})}De.unshift(...le)}if(me>0&&Y.index<be){const ae=Math.min(me,be-Y.index);let le=Y.offset+Y.size+L;for(let oe=Y.index+1;oe<=Y.index+ae;oe++){const re=(F=(A=Pl(q,oe,oe)[0])==null?void 0:A.value)!=null?F:Y.size;De.push({data:W==null?void 0:W[oe],index:oe,offset:le,size:re}),le+=re+L}}}return wf(De,Q,N,L,z,$)}),He(S=>S!==null),Tt()),vg);Pe(ie(t,He(k0),we(S=>S==null?void 0:S.length)),r),Pe(ie(w,we(S=>S.topListHeight)),h),Pe(h,a),Pe(ie(w,we(S=>[S.top,S.bottom])),o),Pe(ie(w,we(S=>S.items)),g);const k=Ns(ie(w,He(({items:S})=>S.length>0),Qe(r,t),He(([{items:S},j])=>S[S.length-1].originalIndex===j-1),we(([,S,j])=>[S-1,j]),Tt(ed),we(([S])=>S))),_=Ns(ie(w,oi(200),He(({items:S,topItems:j})=>S.length>0&&S[0].originalIndex===j.length),we(({items:S})=>S[0].index),Tt())),C=Ns(ie(w,He(({items:S})=>S.length>0),we(({items:S})=>{let j=0,N=S.length-1;for(;S[j].type==="group"&&j<N;)j++;for(;S[N].type==="group"&&N>j;)N--;return{endIndex:S[N].index,startIndex:S[j].index}}),Tt(ST)));return{endReached:k,initialItemCount:y,itemsRendered:g,listState:w,minOverscanItemCount:m,rangeChanged:C,startReached:_,topItemsIndexes:x,...f}},Rt(Br,ET,T0,zd,Fd,Bd,So,j0),{singleton:!0}),AT=at(([{fixedFooterHeight:t,fixedHeaderHeight:e,footerHeight:n,headerHeight:s},{listState:r}])=>{const i=et(),o=An(ie(nn(n,t,s,e,r),we(([a,l,u,d,h])=>a+l+u+d+h.offsetBottom+h.bottom)),0);return Pe(Ue(o),i),{totalListHeight:o,totalListHeightChanged:i}},Rt(qn,Aa),{singleton:!0}),k6=at(([{viewportHeight:t},{totalListHeight:e}])=>{const n=he(!1),s=An(ie(nn(n,t,e),He(([r])=>r),we(([,r,i])=>Math.max(0,r-i)),oi(0),Tt()),0);return{alignToBottom:n,paddingTopAddition:s}},Rt(qn,AT),{singleton:!0}),OT=at(()=>({context:he(null)})),_6=({itemBottom:t,itemTop:e,locationParams:{align:n,behavior:s,...r},viewportBottom:i,viewportTop:o})=>e<o?{...r,align:n??"start",behavior:s}:t>i?{...r,align:n??"end",behavior:s}:null,IT=at(([{gap:t,sizes:e,totalCount:n},{fixedFooterHeight:s,fixedHeaderHeight:r,headerHeight:i,scrollingInProgress:o,scrollTop:a,viewportHeight:l},{scrollToIndex:u}])=>{const d=et();return Pe(ie(d,Qe(e,l,n,i,r,s,a),Qe(t),we(([[h,f,p,b,x,y,g,m],w])=>{const{align:k,behavior:_,calculateViewLocation:C=_6,done:S,...j}=h,N=NT(h,f,b-1),R=td(N,f.offsetTree,w)+x+y,M=R+pr(f.sizeTree,N)[1],O=m+y,D=m+p-g,$=C({itemBottom:M,itemTop:R,locationParams:{align:k,behavior:_,...j},viewportBottom:D,viewportTop:O});return $?S&&cr(ie(o,He(L=>!L),wa(Mt(o)?1:2)),S):S==null||S(),$}),He(h=>h!==null)),u),{scrollIntoView:d}},Rt(Br,qn,Fd,Aa,_o),{singleton:!0});function a_(t){return t?t==="smooth"?"smooth":"auto":!1}const S6=(t,e)=>typeof t=="function"?a_(t(e)):e&&a_(t),j6=at(([{listRefresh:t,totalCount:e,fixedItemSize:n,data:s},{atBottomState:r,isAtBottom:i},{scrollToIndex:o},{scrolledToInitialItem:a},{didMount:l,propsReady:u},{log:d},{scrollingInProgress:h},{context:f},{scrollIntoView:p}])=>{const b=he(!1),x=et();let y=null;function g(_){Ge(o,{align:"end",behavior:_,index:"LAST"})}dt(ie(nn(ie(Ue(e),wa(1)),l),Qe(Ue(b),i,a,h),we(([[_,C],S,j,N,R])=>{let M=C&&N,O="auto";return M&&(O=S6(S,j||R),M=M&&!!O),{followOutputBehavior:O,shouldFollow:M,totalCount:_}}),He(({shouldFollow:_})=>_)),({followOutputBehavior:_,totalCount:C})=>{y&&(y(),y=null),Mt(n)?requestAnimationFrame(()=>{Mt(d)("following output to ",{totalCount:C},cs.DEBUG),g(_)}):y=cr(t,()=>{Mt(d)("following output to ",{totalCount:C},cs.DEBUG),g(_),y=null})});function m(_){const C=cr(r,S=>{_&&!S.atBottom&&S.notAtBottomBecause==="SIZE_INCREASED"&&!y&&(Mt(d)("scrolling to bottom due to increased size",{},cs.DEBUG),g("auto"))});setTimeout(C,100)}dt(ie(nn(Ue(b),e,u),He(([_,,C])=>_&&C),Mr(({value:_},[,C])=>({refreshed:_===C,value:C}),{refreshed:!1,value:0}),He(({refreshed:_})=>_),Qe(b,e)),([,_])=>{Mt(a)&&m(_!==!1)}),dt(x,()=>{m(Mt(b)!==!1)}),dt(nn(Ue(b),r),([_,C])=>{_&&!C.atBottom&&C.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&g("auto")});const w=he(null),k=et();return Pe(_y(ie(Ue(s),we(_=>{var C;return(C=_==null?void 0:_.length)!=null?C:0})),ie(Ue(e))),k),dt(ie(nn(ie(k,wa(1)),l),Qe(Ue(w),a,h,f),we(([[_,C],S,j,N,R])=>C&&j&&(S==null?void 0:S({context:R,totalCount:_,scrollingInProgress:N}))),He(_=>!!_),oi(0)),_=>{y&&(y(),y=null),Mt(n)?requestAnimationFrame(()=>{Mt(d)("scrolling into view",{}),Ge(p,_)}):y=cr(t,()=>{Mt(d)("scrolling into view",{}),Ge(p,_),y=null})}),{autoscrollToBottom:x,followOutput:b,scrollIntoViewOnChange:w}},Rt(Br,Bd,Fd,zd,So,_o,qn,OT,IT)),C6=at(([{data:t,firstItemIndex:e,gap:n,sizes:s},{initialTopMostItemIndex:r},{initialItemCount:i,listState:o},{didMount:a}])=>(Pe(ie(a,Qe(i),He(([,l])=>l!==0),Qe(r,s,e,n,t),we(([[,l],u,d,h,f,p=[]])=>RT(l,u,d,h,f,p))),o),{}),Rt(Br,zd,Aa,So),{singleton:!0}),N6=at(([{didMount:t},{scrollTo:e},{listState:n}])=>{const s=he(0);return dt(ie(t,Qe(s),He(([,r])=>r!==0),we(([,r])=>({top:r}))),r=>{cr(ie(n,wa(1),He(i=>i.items.length>1)),()=>{requestAnimationFrame(()=>{Ge(e,r)})})}),{initialScrollTop:s}},Rt(So,qn,Aa),{singleton:!0}),MT=at(([{scrollVelocity:t}])=>{const e=he(!1),n=et(),s=he(!1);return Pe(ie(t,Qe(s,e,n),He(([r,i])=>!!i),we(([r,i,o,a])=>{const{enter:l,exit:u}=i;if(o){if(u(r,a))return!1}else if(l(r,a))return!0;return o}),Tt()),e),dt(ie(nn(e,t,n),Qe(s)),([[r,i,o],a])=>{r&&a&&a.change&&a.change(i,o)}),{isSeeking:e,scrollSeekConfiguration:s,scrollSeekRangeChanged:n,scrollVelocity:t}},Rt(Bd),{singleton:!0}),P0=at(([{scrollContainerState:t,scrollTo:e}])=>{const n=et(),s=et(),r=et(),i=he(!1),o=he(void 0);return Pe(ie(nn(n,s),we(([{scrollHeight:a,scrollTop:l,viewportHeight:u},{offsetTop:d}])=>({scrollHeight:a,scrollTop:Math.max(0,l-d),viewportHeight:u}))),t),Pe(ie(e,Qe(s),we(([a,{offsetTop:l}])=>({...a,top:a.top+l}))),r),{customScrollParent:o,useWindowScroll:i,windowScrollContainerState:n,windowScrollTo:r,windowViewportRect:s}},Rt(qn)),E6=at(([{sizeRanges:t,sizes:e},{headerHeight:n,scrollTop:s},{initialTopMostItemIndex:r},{didMount:i},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:l}])=>{const u=et(),d=he(void 0),h=he(null),f=he(null);return Pe(a,h),Pe(l,f),dt(ie(u,Qe(e,s,o,h,f,n)),([p,b,x,y,g,m,w])=>{const k=d6(b.sizeTree);y&&g!==null&&m!==null&&(x=g.scrollTop-m.offsetTop),x-=w,p({ranges:k,scrollTop:x})}),Pe(ie(d,He(k0),we(T6)),r),Pe(ie(i,Qe(d),He(([,p])=>p!==void 0),Tt(),we(([,p])=>p.ranges)),t),{getState:u,restoreStateFrom:d}},Rt(Br,qn,zd,So,P0));function T6(t){return{align:"start",index:0,offset:t.scrollTop}}const P6=at(([{topItemsIndexes:t}])=>{const e=he(0);return Pe(ie(e,He(n=>n>=0),we(n=>Array.from({length:n}).map((s,r)=>r))),t),{topItemCount:e}},Rt(Aa));function DT(t){let e=!1,n;return()=>(e||(e=!0,n=t()),n)}const R6=DT(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),A6=at(([{deviation:t,scrollBy:e,scrollingInProgress:n,scrollTop:s},{isAtBottom:r,isScrolling:i,lastJumpDueToItemResize:o,scrollDirection:a},{listState:l},{beforeUnshiftWith:u,gap:d,shiftWithOffset:h,sizes:f},{log:p},{recalcInProgress:b}])=>{const x=Ns(ie(l,Qe(o),Mr(([,g,m,w],[{bottom:k,items:_,offsetBottom:C,totalCount:S},j])=>{const N=k+C;let R=0;return m===S&&g.length>0&&_.length>0&&(_[0].originalIndex===0&&g[0].originalIndex===0||(R=N-w,R!==0&&(R+=j))),[R,_,S,N]},[0,[],0,0]),He(([g])=>g!==0),Qe(s,a,n,r,p,b),He(([,g,m,w,,,k])=>!k&&!w&&g!==0&&m===nd),we(([[g],,,,,m])=>(m("Upward scrolling compensation",{amount:g},cs.DEBUG),g))));function y(g){g>0?(Ge(e,{behavior:"auto",top:-g}),Ge(t,0)):(Ge(t,0),Ge(e,{behavior:"auto",top:-g}))}return dt(ie(x,Qe(t,i)),([g,m,w])=>{w&&R6()?Ge(t,m-g):y(-g)}),dt(ie(nn(An(i,!1),t,b),He(([g,m,w])=>!g&&!w&&m!==0),we(([g,m])=>m),oi(1)),y),Pe(ie(h,we(g=>({top:-g}))),e),dt(ie(u,Qe(f,d),we(([g,{groupIndices:m,lastSize:w,sizeTree:k},_])=>{function C(S){return S*(w+_)}if(m.length===0)return C(g);{let S=0;const j=Zu(k,0);let N=0,R=0;for(;N<g;){N++,S+=j;let M=m.length===R+1?1/0:m[R+1]-m[R]-1;N+M>g&&(S-=j,M=g-N+1),N+=M,S+=C(M),R++}return S}})),g=>{Ge(t,g),requestAnimationFrame(()=>{Ge(e,{top:g}),requestAnimationFrame(()=>{Ge(t,0),Ge(b,!1)})})}),{deviation:t}},Rt(qn,Bd,Aa,Br,_o,j0)),O6=at(([t,e,n,s,r,i,o,a,l,u,d])=>({...t,...e,...n,...s,...r,...i,...o,...a,...l,...u,...d}),Rt(T0,C6,So,MT,AT,N6,k6,P0,IT,_o,OT)),LT=at(([{data:t,defaultItemSize:e,firstItemIndex:n,fixedItemSize:s,fixedGroupSize:r,gap:i,groupIndices:o,heightEstimates:a,itemSize:l,sizeRanges:u,sizes:d,statefulTotalCount:h,totalCount:f,trackItemSizes:p},{initialItemFinalLocationReached:b,initialTopMostItemIndex:x,scrolledToInitialItem:y},g,m,w,k,{scrollToIndex:_},C,{topItemCount:S},{groupCounts:j},N])=>{const{listState:R,minOverscanItemCount:M,topItemsIndexes:O,rangeChanged:D,...$}=k;return Pe(D,N.scrollSeekRangeChanged),Pe(ie(N.windowViewportRect,we(L=>L.visibleHeight)),g.viewportHeight),{data:t,defaultItemHeight:e,firstItemIndex:n,fixedItemHeight:s,fixedGroupHeight:r,gap:i,groupCounts:j,heightEstimates:a,initialItemFinalLocationReached:b,initialTopMostItemIndex:x,scrolledToInitialItem:y,sizeRanges:u,topItemCount:S,topItemsIndexes:O,totalCount:f,...w,groupIndices:o,itemSize:l,listState:R,minOverscanItemCount:M,scrollToIndex:_,statefulTotalCount:h,trackItemSizes:p,rangeChanged:D,...$,...N,...g,sizes:d,...m}},Rt(Br,zd,qn,E6,j6,Aa,Fd,A6,P6,ET,O6));function I6(t,e){const n={},s={};let r=0;const i=t.length;for(;r<i;)s[t[r]]=1,r+=1;for(const o in e)Object.hasOwn(s,o)||(n[o]=e[o]);return n}const Ph=typeof document<"u"?ge.useLayoutEffect:ge.useEffect;function $T(t,e,n){const s=Object.keys(e.required||{}),r=Object.keys(e.optional||{}),i=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),a=ge.createContext({});function l(y,g){y.propsReady&&Ge(y.propsReady,!1);for(const m of s){const w=y[e.required[m]];Ge(w,g[m])}for(const m of r)if(m in g){const w=y[e.optional[m]];Ge(w,g[m])}y.propsReady&&Ge(y.propsReady,!0)}function u(y){return i.reduce((g,m)=>(g[m]=w=>{const k=y[e.methods[m]];Ge(k,w)},g),{})}function d(y){return o.reduce((g,m)=>(g[m]=Q4(y[e.events[m]]),g),{})}const h=ge.forwardRef((y,g)=>{const{children:m,...w}=y,[k]=ge.useState(()=>nm(J4(t),S=>{l(S,w)})),[_]=ge.useState(Xk(d,k));Ph(()=>{for(const S of o)S in w&&dt(_[S],w[S]);return()=>{Object.values(_).map(_0)}},[w,_,k]),Ph(()=>{l(k,w)}),ge.useImperativeHandle(g,Qk(u(k)));const C=n;return c.jsx(a.Provider,{value:k,children:n?c.jsx(C,{...I6([...s,...r,...o],w),children:m}):m})}),f=y=>{const g=ge.useContext(a);return ge.useCallback(m=>{Ge(g[y],m)},[g,y])},p=y=>{const g=ge.useContext(a)[y],m=ge.useCallback(w=>dt(g,w),[g]);return ge.useSyncExternalStore(m,()=>Mt(g),()=>Mt(g))},b=y=>{const g=ge.useContext(a)[y],[m,w]=ge.useState(Xk(Mt,g));return Ph(()=>dt(g,k=>{k!==m&&w(Qk(k))}),[g,m]),m},x=ge.version.startsWith("18")?p:b;return{Component:h,useEmitter:(y,g)=>{const m=ge.useContext(a)[y];Ph(()=>dt(m,g),[g,m])},useEmitterValue:x,usePublisher:f}}const FT=ge.createContext(void 0),zT=ge.createContext(void 0),BT=typeof document<"u"?ge.useLayoutEffect:ge.useEffect;function bg(t){return"self"in t}function M6(t){return"body"in t}function UT(t,e,n,s=mc,r,i){const o=ge.useRef(null),a=ge.useRef(null),l=ge.useRef(null),u=ge.useCallback(f=>{let p,b,x;const y=f.target;if(M6(y)||bg(y)){const m=bg(y)?y:y.defaultView;x=i?m.scrollX:m.scrollY,p=i?m.document.documentElement.scrollWidth:m.document.documentElement.scrollHeight,b=i?m.innerWidth:m.innerHeight}else x=i?y.scrollLeft:y.scrollTop,p=i?y.scrollWidth:y.scrollHeight,b=i?y.offsetWidth:y.offsetHeight;const g=()=>{t({scrollHeight:p,scrollTop:Math.max(x,0),viewportHeight:b})};f.suppressFlushSync?g():gC.flushSync(g),a.current!==null&&(x===a.current||x<=0||x===p-b)&&(a.current=null,e(!0),l.current&&(clearTimeout(l.current),l.current=null))},[t,e,i]);ge.useEffect(()=>{const f=r||o.current;return s(r||o.current),u({suppressFlushSync:!0,target:f}),f.addEventListener("scroll",u,{passive:!0}),()=>{s(null),f.removeEventListener("scroll",u)}},[o,u,n,s,r]);function d(f){const p=o.current;if(!p||(i?"offsetWidth"in p&&p.offsetWidth===0:"offsetHeight"in p&&p.offsetHeight===0))return;const b=f.behavior==="smooth";let x,y,g;bg(p)?(y=Math.max(go(p.document.documentElement,i?"width":"height"),i?p.document.documentElement.scrollWidth:p.document.documentElement.scrollHeight),x=i?p.innerWidth:p.innerHeight,g=i?window.scrollX:window.scrollY):(y=p[i?"scrollWidth":"scrollHeight"],x=go(p,i?"width":"height"),g=p[i?"scrollLeft":"scrollTop"]);const m=y-x;if(f.top=Math.ceil(Math.max(Math.min(m,f.top),0)),PT(x,y)||f.top===g){t({scrollHeight:y,scrollTop:g,viewportHeight:x}),b&&e(!0);return}b?(a.current=f.top,l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{l.current=null,a.current=null,e(!0)},1e3)):a.current=null,i&&(f={behavior:f.behavior,left:f.top}),p.scrollTo(f)}function h(f){i&&(f={behavior:f.behavior,left:f.top}),o.current.scrollBy(f)}return{scrollByCallback:h,scrollerRef:o,scrollToCallback:d}}const wg="-webkit-sticky",l_="sticky",R0=DT(()=>{if(typeof document>"u")return l_;const t=document.createElement("div");return t.style.position=wg,t.style.position===wg?wg:l_});function A0(t){return t}const D6=at(()=>{const t=he(a=>`Item ${a}`),e=he(a=>`Group ${a}`),n=he({}),s=he(A0),r=he("div"),i=he(mc),o=(a,l=null)=>An(ie(n,we(u=>u[a]),Tt()),l);return{components:n,computeItemKey:s,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:e,HeaderComponent:o("Header"),HeaderFooterTag:r,ItemComponent:o("Item","div"),itemContent:t,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:i,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}}),L6=at(([t,e])=>({...t,...e}),Rt(LT,D6)),$6=({height:t})=>c.jsx("div",{style:{height:t}}),F6={overflowAnchor:"none",position:R0(),zIndex:1},HT={overflowAnchor:"none"},z6={...HT,display:"inline-block",height:"100%"},c_=ge.memo(function({showTopList:t=!1}){const e=We("listState"),n=Us("sizeRanges"),s=We("useWindowScroll"),r=We("customScrollParent"),i=Us("windowScrollContainerState"),o=Us("scrollContainerState"),a=r||s?i:o,l=We("itemContent"),u=We("context"),d=We("groupContent"),h=We("trackItemSizes"),f=We("itemSize"),p=We("log"),b=Us("gap"),x=We("horizontalDirection"),{callbackRef:y}=t6(n,f,h,t?mc:a,p,b,r,x,We("skipAnimationFrameInResizeObserver")),[g,m]=ge.useState(0);O0("deviation",$=>{g!==$&&m($)});const w=We("EmptyPlaceholder"),k=We("ScrollSeekPlaceholder")||$6,_=We("ListComponent"),C=We("ItemComponent"),S=We("GroupComponent"),j=We("computeItemKey"),N=We("isSeeking"),R=We("groupIndices").length>0,M=We("alignToBottom"),O=We("initialItemFinalLocationReached"),D=t?{}:{boxSizing:"border-box",...x?{display:"inline-block",height:"100%",marginLeft:g!==0?g:M?"auto":0,paddingLeft:e.offsetTop,paddingRight:e.offsetBottom,whiteSpace:"nowrap"}:{marginTop:g!==0?g:M?"auto":0,paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},...O?{}:{visibility:"hidden"}};return!t&&e.totalCount===0&&w?c.jsx(w,{...Rn(w,u)}):c.jsx(_,{...Rn(_,u),"data-testid":t?"virtuoso-top-item-list":"virtuoso-item-list",ref:y,style:D,children:(t?e.topItems:e.items).map($=>{const L=$.originalIndex,U=j(L+e.firstItemIndex,$.data,u);return N?v.createElement(k,{...Rn(k,u),height:$.size,index:$.index,key:U,type:$.type||"item",...$.type==="group"?{}:{groupIndex:$.groupIndex}}):$.type==="group"?v.createElement(S,{...Rn(S,u),"data-index":L,"data-item-index":$.index,"data-known-size":$.size,key:U,style:F6},d($.index,u)):v.createElement(C,{...Rn(C,u),...W6(C,$.data),"data-index":L,"data-item-group-index":$.groupIndex,"data-item-index":$.index,"data-known-size":$.size,key:U,style:x?z6:HT},R?l($.index,$.groupIndex,$.data,u):l($.index,$.data,u))})})}),B6={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},U6={outline:"none",overflowX:"auto",position:"relative"},rm=t=>({height:"100%",position:"absolute",top:0,width:"100%",...t?{display:"flex",flexDirection:"column"}:{}}),H6={position:R0(),top:0,width:"100%",zIndex:1};function Rn(t,e){if(typeof t!="string")return{context:e}}function W6(t,e){return{item:typeof t=="string"?void 0:e}}const V6=ge.memo(function(){const t=We("HeaderComponent"),e=Us("headerHeight"),n=We("HeaderFooterTag"),s=Ra(ge.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Rn(t,r)})}):null}),q6=ge.memo(function(){const t=We("FooterComponent"),e=Us("footerHeight"),n=We("HeaderFooterTag"),s=Ra(ge.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Rn(t,r)})}):null});function WT({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ge.memo(function({children:s,style:r,context:i,...o}){const a=n("scrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("scrollerRef"),h=e("horizontalDirection")||!1,{scrollByCallback:f,scrollerRef:p,scrollToCallback:b}=UT(a,u,l,d,void 0,h);return t("scrollTo",b),t("scrollBy",f),c.jsx(l,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:p,style:{...h?U6:B6,...r},tabIndex:0,...o,...Rn(l,i),children:s})})}function VT({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ge.memo(function({children:s,style:r,context:i,...o}){const a=n("windowScrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("totalListHeight"),h=e("deviation"),f=e("customScrollParent"),p=ge.useRef(null),b=e("scrollerRef"),{scrollByCallback:x,scrollerRef:y,scrollToCallback:g}=UT(a,u,l,b,f);return BT(()=>{var m;return y.current=f||((m=p.current)==null?void 0:m.ownerDocument.defaultView),()=>{y.current=null}},[y,f]),t("windowScrollTo",g),t("scrollBy",x),c.jsx(l,{ref:p,"data-virtuoso-scroller":!0,style:{position:"relative",...r,...d!==0?{height:d+h}:{}},...o,...Rn(l,i),children:s})})}const K6=({children:t})=>{const e=ge.useContext(FT),n=Us("viewportHeight"),s=Us("fixedItemHeight"),r=We("alignToBottom"),i=We("horizontalDirection"),o=ge.useMemo(()=>gT(n,l=>go(l,i?"width":"height")),[n,i]),a=Ra(o,!0,We("skipAnimationFrameInResizeObserver"));return ge.useEffect(()=>{e&&(n(e.viewportHeight),s(e.itemHeight))},[e,n,s]),c.jsx("div",{"data-viewport-type":"element",ref:a,style:rm(r),children:t})},G6=({children:t})=>{const e=ge.useContext(FT),n=Us("windowViewportRect"),s=Us("fixedItemHeight"),r=We("customScrollParent"),i=yT(n,r,We("skipAnimationFrameInResizeObserver")),o=We("alignToBottom");return ge.useEffect(()=>{e&&(s(e.itemHeight),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,n,s]),c.jsx("div",{"data-viewport-type":"window",ref:i,style:rm(o),children:t})},Y6=({children:t})=>{const e=We("TopItemListComponent")||"div",n=We("headerHeight"),s={...H6,marginTop:`${n}px`},r=We("context");return c.jsx(e,{style:s,...Rn(e,r),children:t})},Q6=ge.memo(function(t){const e=We("useWindowScroll"),n=We("topItemsIndexes").length>0,s=We("customScrollParent"),r=We("context");return c.jsxs(s||e?Z6:J6,{...t,context:r,children:[n&&c.jsx(Y6,{children:c.jsx(c_,{showTopList:!0})}),c.jsxs(s||e?G6:K6,{children:[c.jsx(V6,{}),c.jsx(c_,{}),c.jsx(q6,{})]})]})}),{Component:X6,useEmitter:O0,useEmitterValue:We,usePublisher:Us}=$T(L6,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},Q6),J6=WT({useEmitter:O0,useEmitterValue:We,usePublisher:Us}),Z6=VT({useEmitter:O0,useEmitterValue:We,usePublisher:Us}),eU=X6,tU=at(()=>{const t=he(u=>c.jsxs("td",{children:["Item $",u]})),e=he(null),n=he(u=>c.jsxs("td",{colSpan:1e3,children:["Group ",u]})),s=he(null),r=he(null),i=he({}),o=he(A0),a=he(mc),l=(u,d=null)=>An(ie(i,we(h=>h[u]),Tt()),d);return{components:i,computeItemKey:o,context:e,EmptyPlaceholder:l("EmptyPlaceholder"),FillerRow:l("FillerRow"),fixedFooterContent:r,fixedHeaderContent:s,itemContent:t,groupContent:n,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),TableBodyComponent:l("TableBody","tbody"),TableComponent:l("Table","table"),TableFooterComponent:l("TableFoot","tfoot"),TableHeadComponent:l("TableHead","thead"),TableRowComponent:l("TableRow","tr"),GroupComponent:l("Group","tr")}});Rt(LT,tU);R0();const u_={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},nU={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:d_,floor:hp,max:pu,min:kg,round:h_}=Math;function f_(t,e,n){return Array.from({length:e-t+1}).map((s,r)=>({data:n===null?null:n[r+t],index:r+t}))}function sU(t){return{...nU,items:t}}function Rh(t,e){return t&&t.width===e.width&&t.height===e.height}function rU(t,e){return t&&t.column===e.column&&t.row===e.row}const iU=at(([{increaseViewportBy:t,listBoundary:e,overscan:n,visibleRange:s},{footerHeight:r,headerHeight:i,scrollBy:o,scrollContainerState:a,scrollTo:l,scrollTop:u,smoothScrollTargetReached:d,viewportHeight:h},f,p,{didMount:b,propsReady:x},{customScrollParent:y,useWindowScroll:g,windowScrollContainerState:m,windowScrollTo:w,windowViewportRect:k},_])=>{const C=he(0),S=he(0),j=he(u_),N=he({height:0,width:0}),R=he({height:0,width:0}),M=et(),O=et(),D=he(0),$=he(null),L=he({column:0,row:0}),U=et(),W=et(),E=he(!1),P=he(0),A=he(!0),F=he(!1),z=he(!1);dt(ie(b,Qe(P),He(([Z,be])=>!!be)),()=>{Ge(A,!1)}),dt(ie(nn(b,A,R,N,P,F),He(([Z,be,De,xe,,me])=>Z&&!be&&De.height!==0&&xe.height!==0&&!me)),([,,,,Z])=>{Ge(F,!0),N0(1,()=>{Ge(M,Z)}),cr(ie(u),()=>{Ge(e,[0,0]),Ge(A,!0)})}),Pe(ie(W,He(Z=>Z!=null&&Z.scrollTop>0),Pr(0)),S),dt(ie(b,Qe(W),He(([,Z])=>Z!=null)),([,Z])=>{Z&&(Ge(N,Z.viewport),Ge(R,Z.item),Ge(L,Z.gap),Z.scrollTop>0&&(Ge(E,!0),cr(ie(u,wa(1)),be=>{Ge(E,!1)}),Ge(l,{top:Z.scrollTop})))}),Pe(ie(N,we(({height:Z})=>Z)),h),Pe(ie(nn(Ue(N,Rh),Ue(R,Rh),Ue(L,(Z,be)=>Z&&Z.column===be.column&&Z.row===be.row),Ue(u)),we(([Z,be,De,xe])=>({gap:De,item:be,scrollTop:xe,viewport:Z}))),U),Pe(ie(nn(Ue(C),s,Ue(L,rU),Ue(R,Rh),Ue(N,Rh),Ue($),Ue(S),Ue(E),Ue(A),Ue(P)),He(([,,,,,,,Z])=>!Z),we(([Z,[be,De],xe,me,Le,Y,ae,,le,oe])=>{const{column:re,row:_e}=xe,{height:se,width:V}=me,{width:ye}=Le;if(ae===0&&(Z===0||ye===0))return u_;if(V===0){const on=E0(oe,Z),Rs=on+Math.max(ae-1,0);return sU(f_(on,Rs,Y))}const Ne=qT(ye,V,re);let Re,J;le?be===0&&De===0&&ae>0?(Re=0,J=ae-1):(Re=Ne*hp((be+_e)/(se+_e)),J=Ne*d_((De+_e)/(se+_e))-1,J=kg(Z-1,pu(J,Ne-1)),Re=kg(J,pu(0,Re))):(Re=0,J=-1);const ee=f_(Re,J,Y),{bottom:ne,top:ke}=p_(Le,xe,me,ee),fn=d_(Z/Ne),xr=fn*se+(fn-1)*_e-ne;return{bottom:ne,itemHeight:se,items:ee,itemWidth:V,offsetBottom:xr,offsetTop:ke,top:ke}})),j),Pe(ie($,He(Z=>Z!==null),we(Z=>Z.length)),C),Pe(ie(nn(N,R,j,L),He(([Z,be,{items:De}])=>De.length>0&&be.height!==0&&Z.height!==0),we(([Z,be,{items:De},xe])=>{const{bottom:me,top:Le}=p_(Z,xe,be,De);return[Le,me]}),Tt(ed)),e);const G=he(!1);Pe(ie(u,Qe(G),we(([Z,be])=>be||Z!==0)),G);const q=Ns(ie(nn(j,C),He(([{items:Z}])=>Z.length>0),Qe(G),He(([[Z,be],De])=>{const xe=Z.items[Z.items.length-1].index===be-1;return(De||Z.bottom>0&&Z.itemHeight>0&&Z.offsetBottom===0&&Z.items.length===be)&&xe}),we(([[,Z]])=>Z-1),Tt())),B=Ns(ie(Ue(j),He(({items:Z})=>Z.length>0&&Z[0].index===0),Pr(0),Tt())),Q=Ns(ie(Ue(j),Qe(E),He(([{items:Z},be])=>Z.length>0&&!be),we(([{items:Z}])=>({endIndex:Z[Z.length-1].index,startIndex:Z[0].index})),Tt(ST),oi(0)));Pe(Q,p.scrollSeekRangeChanged),Pe(ie(M,Qe(N,R,C,L),we(([Z,be,De,xe,me])=>{const Le=TT(Z),{align:Y,behavior:ae,offset:le}=Le;let oe=Le.index;oe==="LAST"&&(oe=xe-1),oe=pu(0,oe,kg(xe-1,oe));let re=Ey(be,me,De,oe);return Y==="end"?re=h_(re-be.height+De.height):Y==="center"&&(re=h_(re-be.height/2+De.height/2)),le&&(re+=le),{behavior:ae,top:re}})),l);const pe=An(ie(j,we(Z=>Z.offsetBottom+Z.bottom)),0);return Pe(ie(k,we(Z=>({height:Z.visibleHeight,width:Z.visibleWidth}))),N),{customScrollParent:y,data:$,deviation:D,footerHeight:r,gap:L,headerHeight:i,increaseViewportBy:t,initialItemCount:S,itemDimensions:R,overscan:n,restoreStateFrom:W,scrollBy:o,scrollContainerState:a,scrollHeight:O,scrollTo:l,scrollToIndex:M,scrollTop:u,smoothScrollTargetReached:d,totalCount:C,useWindowScroll:g,viewportDimensions:N,windowScrollContainerState:m,windowScrollTo:w,windowViewportRect:k,...p,gridState:j,horizontalDirection:z,initialTopMostItemIndex:P,totalListHeight:pe,...f,endReached:q,propsReady:x,rangeChanged:Q,startReached:B,stateChanged:U,stateRestoreInProgress:E,..._}},Rt(T0,qn,Bd,MT,So,P0,_o));function qT(t,e,n){return pu(1,hp((t+n)/(hp(e)+n)))}function p_(t,e,n,s){const{height:r}=n;if(r===void 0||s.length===0)return{bottom:0,top:0};const i=Ey(t,e,n,s[0].index);return{bottom:Ey(t,e,n,s[s.length-1].index)+r,top:i}}function Ey(t,e,n,s){const r=qT(t.width,n.width,e.column),i=hp(s/r),o=i*n.height+pu(0,i-1)*e.row;return o>0?o+e.row:o}const oU=at(()=>{const t=he(h=>`Item ${h}`),e=he({}),n=he(null),s=he("virtuoso-grid-item"),r=he("virtuoso-grid-list"),i=he(A0),o=he("div"),a=he(mc),l=(h,f=null)=>An(ie(e,we(p=>p[h]),Tt()),f),u=he(!1),d=he(!1);return Pe(Ue(d),u),{components:e,computeItemKey:i,context:n,FooterComponent:l("Footer"),HeaderComponent:l("Header"),headerFooterTag:o,itemClassName:s,ItemComponent:l("Item","div"),itemContent:t,listClassName:r,ListComponent:l("List","div"),readyStateChanged:u,reportReadyState:d,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}}),aU=at(([t,e])=>({...t,...e}),Rt(iU,oU)),lU=ge.memo(function(){const t=It("gridState"),e=It("listClassName"),n=It("itemClassName"),s=It("itemContent"),r=It("computeItemKey"),i=It("isSeeking"),o=Hs("scrollHeight"),a=It("ItemComponent"),l=It("ListComponent"),u=It("ScrollSeekPlaceholder"),d=It("context"),h=Hs("itemDimensions"),f=Hs("gap"),p=It("log"),b=It("stateRestoreInProgress"),x=Hs("reportReadyState"),y=Ra(ge.useMemo(()=>g=>{const m=g.parentElement.parentElement.scrollHeight;o(m);const w=g.firstChild;if(w){const{height:k,width:_}=w.getBoundingClientRect();h({height:k,width:_})}f({column:m_("column-gap",getComputedStyle(g).columnGap,p),row:m_("row-gap",getComputedStyle(g).rowGap,p)})},[o,h,f,p]),!0,!1);return BT(()=>{t.itemHeight>0&&t.itemWidth>0&&x(!0)},[t]),b?null:c.jsx(l,{className:e,ref:y,...Rn(l,d),"data-testid":"virtuoso-item-list",style:{paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},children:t.items.map(g=>{const m=r(g.index,g.data,d);return i?c.jsx(u,{...Rn(u,d),height:t.itemHeight,index:g.index,width:t.itemWidth},m):v.createElement(a,{...Rn(a,d),className:n,"data-index":g.index,key:m},s(g.index,g.data,d))})})}),cU=ge.memo(function(){const t=It("HeaderComponent"),e=Hs("headerHeight"),n=It("headerFooterTag"),s=Ra(ge.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,!1),r=It("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Rn(t,r)})}):null}),uU=ge.memo(function(){const t=It("FooterComponent"),e=Hs("footerHeight"),n=It("headerFooterTag"),s=Ra(ge.useMemo(()=>i=>{e(go(i,"height"))},[e]),!0,!1),r=It("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Rn(t,r)})}):null}),dU=({children:t})=>{const e=ge.useContext(zT),n=Hs("itemDimensions"),s=Hs("viewportDimensions"),r=Ra(ge.useMemo(()=>i=>{s(i.getBoundingClientRect())},[s]),!0,!1);return ge.useEffect(()=>{e&&(s({height:e.viewportHeight,width:e.viewportWidth}),n({height:e.itemHeight,width:e.itemWidth}))},[e,s,n]),c.jsx("div",{ref:r,style:rm(!1),children:t})},hU=({children:t})=>{const e=ge.useContext(zT),n=Hs("windowViewportRect"),s=Hs("itemDimensions"),r=It("customScrollParent"),i=yT(n,r,!1);return ge.useEffect(()=>{e&&(s({height:e.itemHeight,width:e.itemWidth}),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,n,s]),c.jsx("div",{ref:i,style:rm(!1),children:t})},fU=ge.memo(function({...t}){const e=It("useWindowScroll"),n=It("customScrollParent"),s=n||e?mU:pU,r=n||e?hU:dU,i=It("context");return c.jsx(s,{...t,...Rn(s,i),children:c.jsxs(r,{children:[c.jsx(cU,{}),c.jsx(lU,{}),c.jsx(uU,{})]})})}),{useEmitter:KT,useEmitterValue:It,usePublisher:Hs}=$T(aU,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},fU),pU=WT({useEmitter:KT,useEmitterValue:It,usePublisher:Hs}),mU=VT({useEmitter:KT,useEmitterValue:It,usePublisher:Hs});function m_(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,cs.WARN),e==="normal"?0:parseInt(e??"0",10)}const _g=new Set;function gU(){const[t,e]=v.useState([]),[n,s]=v.useState(""),[r,i]=v.useState(null),[o,a]=v.useState(!0),[l,u]=v.useState(!1),[d,h]=v.useState(null),[f,p]=v.useState(!1),b=v.useRef(null),x=v.useRef(null),y=v.useRef(null),g=v.useRef(null),m=v.useRef(0);v.useEffect(()=>{console.log("[ChatPage] Mount - starting loadHistory, showing loading spinner");async function j(){var N,R;try{console.log("[ChatPage] Fetching history from API...");const M=await lB({limit:500,newestFirst:!0});if(console.log("[ChatPage] History received:",{messageCount:((N=M==null?void 0:M.messages)==null?void 0:N.length)||0}),(R=M==null?void 0:M.messages)!=null&&R.length){const O=M.messages.map(CU);e(O),h(M.session_id||null),a(!1),console.log("[ChatPage] Loading complete - hiding spinner, showing messages"),setTimeout(()=>{var $;($=y.current)==null||$.scrollToIndex({index:"LAST",behavior:"auto"})},50);const D=O.flatMap($=>$.files||[]).filter($=>$==null?void 0:$.file_id).map($=>$.file_id);D.length>0&&(console.log("[ChatPage] Loading URLs for",D.length,"attachments in background..."),cB(D).then($=>{console.log("[ChatPage] Attachment URLs loaded:",Object.keys(($==null?void 0:$.urls)||{}).length),$!=null&&$.urls&&e(L=>L.map(U=>({...U,files:(U.files||[]).map(W=>{const E=$.urls[W.file_id];if(E){const P=typeof E=="string"?E:E.full||E.url;return{...W,url:P,width:E.width||W.width,height:E.height||W.height}}return W})})))}).catch($=>{console.warn("[ChatPage] Failed to load attachment URLs:",$)}))}else console.log("[ChatPage] No history - showing greeting"),e([g_()]),a(!1),setTimeout(()=>{var O;(O=y.current)==null||O.scrollToIndex({index:"LAST",behavior:"auto"})},50)}catch(M){console.error("[ChatPage] Failed to load history:",M),e([g_()]),a(!1),setTimeout(()=>{var O;(O=y.current)==null||O.scrollToIndex({index:"LAST",behavior:"auto"})},50)}}j()},[]),v.useEffect(()=>{const j=sessionStorage.getItem("pendingChatRequest");if(j)try{const N=JSON.parse(j),{requestId:R,eventIndex:M,userMessage:O,timestamp:D,assistantMsgId:$}=N,L=5*60*1e3;if(Date.now()-D>L){console.log("[ChatPage] Pending request expired, clearing"),sessionStorage.removeItem("pendingChatRequest");return}console.log("[ChatPage] Found pending request, attempting resume:",R),p(!0);const U=crypto.randomUUID(),W=$||crypto.randomUUID(),E={id:U,role:"user",content:O,files:[],status:null},P={id:W,role:"assistant",content:"",files:[],status:"Resuming"};e(F=>[...F,E,P]),u(!0);let A="";dB({requestId:R,eventIndex:M||0,onEvent:F=>{var z;if(m.current++,F!=null&&F.conversation_id&&h(G=>G||F.conversation_id),F!=null&&F.error){e(G=>G.map(q=>q.id===W?{...q,status:null,content:`Error: ${F.error}`}:q));return}if((F==null?void 0:F.type)==="status"){e(G=>G.map(q=>q.id===W?{...q,status:F.content||"Processing"}:q));return}if((F==null?void 0:F.type)==="delete"){e(G=>G.map(q=>q.id===W?{...q,status:null}:q));return}if((F==null?void 0:F.type)==="tool_call"){const G=((z=F.tool)==null?void 0:z.name)||"processing";e(q=>q.map(B=>B.id===W?{...B,status:`Processing ${G}`}:B));return}if(((F==null?void 0:F.type)==="chunk"||(F==null?void 0:F.type)==="content")&&F.content){A=F.type==="content"?F.content:A+F.content,e(G=>G.map(q=>q.id===W?{...q,status:null,content:A}:q));return}if(F!=null&&F.content&&!F.type){A+=F.content,e(G=>G.map(q=>q.id===W?{...q,status:null,content:A}:q));return}if(((F==null?void 0:F.type)==="files"||(F==null?void 0:F.type)==="file")&&(F.files||F.file||F.file_id)){const G=F.file||{},q=F.files||(F.file?[{file_id:G.file_id,url:G.url,filename:G.filename,title:G.title}]:[{file_id:F.file_id,url:F.url,filename:F.filename,title:F.title}]),B=G.comment||F.comment||"";B&&(A=B),e(Q=>Q.map(pe=>pe.id===W?{...pe,content:B||pe.content,files:[...pe.files||[],...q]}:pe));return}},onDone:()=>{console.log("[ChatPage] Resume completed successfully"),sessionStorage.removeItem("pendingChatRequest"),e(F=>F.map(z=>{var G;return z.id===W&&!z.content&&!((G=z.files)!=null&&G.length)?{...z,status:null,content:"I'm ready to help. What would you like to do?"}:z.id===W?{...z,status:null}:z})),u(!1),p(!1)},onError:F=>{console.error("[ChatPage] Resume failed:",F),sessionStorage.removeItem("pendingChatRequest"),e(z=>z.map(G=>G.id===W?{...G,status:null,content:"Failed to resume previous request. Please try again."}:G)),u(!1),p(!1)},onNotFound:()=>{console.log("[ChatPage] Request not found on server, clearing pending state"),sessionStorage.removeItem("pendingChatRequest"),e(F=>F.filter(z=>z.id!==U&&z.id!==W)),u(!1),p(!1)}})}catch(N){console.error("[ChatPage] Error parsing pending request:",N),sessionStorage.removeItem("pendingChatRequest")}},[]);const w=v.useMemo(()=>(n.trim().length>0||!!r)&&!l,[n,r,l]),k=v.useMemo(()=>t.filter(j=>!j.is_tool_response),[t]),_=v.useCallback((j=!1)=>{var N,R;j?(N=y.current)==null||N.scrollToIndex({index:"LAST",behavior:"auto"}):(R=y.current)==null||R.scrollToIndex({index:"LAST",behavior:"smooth",align:"end"})},[]),C=v.useCallback((j,N)=>c.jsx("div",{className:"px-2 py-1.5",style:{contain:"layout"},children:c.jsx(xU,{msg:N})}),[]);async function S(){var L,U;if(!w)return;const j=n.trim(),N=j||(r?`Please process this file: ${r.name}`:""),R=crypto.randomUUID(),M={id:R,role:"user",content:j,files:r?[{filename:r.name,preview_url:URL.createObjectURL(r)}]:[],status:null},O=crypto.randomUUID(),D={id:O,role:"assistant",content:"",files:[],status:"Thinking"};e(W=>[...W,M,D]),s("");const $=r;i(null),requestAnimationFrame(()=>_(!0));try{u(!0),(U=(L=x.current)==null?void 0:L.abort)==null||U.call(L);const W=new AbortController;x.current=W;let E=[],P="";if($){const A=await hB($);if(!(A!=null&&A.file_id))throw new Error("Upload failed");E=[A.file_id],e(F=>F.map(z=>{var G,q;return z.id===R?{...z,files:[{file_id:A.file_id,filename:$.name,url:A.url,width:A.image_width,height:A.image_height,preview_url:(q=(G=z.files)==null?void 0:G[0])==null?void 0:q.preview_url}]}:z}))}g.current=null,m.current=0,await uB({conversationId:d,message:N,fileIds:E,signal:W.signal,onEvent:A=>{var F;if(!W.signal.aborted){if(m.current++,A!=null&&A.request_id&&!g.current&&(g.current=A.request_id,sessionStorage.setItem("pendingChatRequest",JSON.stringify({requestId:A.request_id,eventIndex:0,userMessage:N,assistantMsgId:O,timestamp:Date.now()}))),g.current&&m.current%5===0){const z=sessionStorage.getItem("pendingChatRequest");if(z){const G=JSON.parse(z);G.eventIndex=m.current,sessionStorage.setItem("pendingChatRequest",JSON.stringify(G))}}if(A!=null&&A.conversation_id&&h(z=>z||A.conversation_id),A!=null&&A.error){e(z=>z.map(G=>G.id===O?{...G,status:null,content:`Error: ${A.error}`}:G));return}if((A==null?void 0:A.type)==="status"){e(z=>z.map(G=>G.id===O?{...G,status:A.content||"Processing"}:G));return}if((A==null?void 0:A.type)==="delete"){e(z=>z.map(G=>G.id===O?{...G,status:null}:G));return}if((A==null?void 0:A.type)==="tool_call"){const z=((F=A.tool)==null?void 0:F.name)||"processing";e(G=>G.map(q=>q.id===O?{...q,status:`Processing ${z}`}:q));return}if(((A==null?void 0:A.type)==="chunk"||(A==null?void 0:A.type)==="content")&&A.content){P=A.type==="content"?A.content:P+A.content,e(z=>z.map(G=>G.id===O?{...G,status:null,content:P}:G));return}if(A!=null&&A.content&&!A.type){P+=A.content,e(z=>z.map(G=>G.id===O?{...G,status:null,content:P}:G));return}if(((A==null?void 0:A.type)==="files"||(A==null?void 0:A.type)==="file")&&(A.files||A.file||A.file_id)){const z=A.file||{},G=A.files||(A.file?[{file_id:z.file_id,url:z.url,filename:z.filename,title:z.title}]:[{file_id:A.file_id,url:A.url,filename:A.filename,title:A.title}]),q=z.comment||A.comment||"";q&&(P=q),e(B=>B.map(Q=>Q.id===O?{...Q,content:q||Q.content,files:[...Q.files||[],...G]}:Q));return}}},onDone:()=>{sessionStorage.removeItem("pendingChatRequest"),g.current=null,m.current=0,e(A=>A.map(F=>{var z;return F.id===O&&!F.content&&!((z=F.files)!=null&&z.length)?{...F,status:null,content:"I'm ready to help. What would you like to do?"}:F.id===O?{...F,status:null}:F}))}})}catch(W){sessionStorage.removeItem("pendingChatRequest"),g.current=null,m.current=0,e(E=>E.map(P=>P.id===O?{...P,status:null,content:(W==null?void 0:W.message)||"Failed to get response"}:P))}finally{u(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(vt,{className:"p-4 overflow-hidden flex-1 min-h-0",children:o?c.jsx("div",{className:"h-full flex items-center justify-center",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ye,{text:"Loading conversation"})})}):c.jsx(eU,{ref:y,className:"h-full scrollbar-thin",data:k,initialTopMostItemIndex:k.length-1,followOutput:"smooth",overscan:200,increaseViewportBy:{top:200,bottom:200},computeItemKey:(j,N)=>N.id,itemContent:C,skipAnimationFrameInResizeObserver:!0})}),c.jsxs(vt,{className:"p-3",children:[r&&c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:r.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>i(null),children:""})]}),c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:b,type:"file",className:"hidden",onChange:j=>{var N;return i(((N=j.target.files)==null?void 0:N[0])||null)},accept:"image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var j;return(j=b.current)==null?void 0:j.click()},children:c.jsx(XC,{size:18})}),c.jsx(SU,{value:n,onChange:s,placeholder:"Type your message...",onEnter:S}),c.jsx(te,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!w,onClick:S,children:c.jsx(JC,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"AI can make mistakes. Verify important information."})]})]})}const xU=ge.memo(function({msg:e}){var i;const n=e.role==="user",s=v.useMemo(()=>EU(e.content||""),[e.content]),r=!!e.status;return c.jsx("div",{className:n?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",n?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[r?c.jsx(jU,{text:e.status}):c.jsx("div",{dangerouslySetInnerHTML:{__html:s}}),((i=e.files)==null?void 0:i.length)>0&&c.jsx("div",{className:"mt-2 space-y-1",children:e.files.map((o,a)=>c.jsx(yU,{file:o,isUser:n},o.file_id||`file-${a}`))})]})})}),yU=ge.memo(function({file:e,isUser:n}){const s=NU(e.filename||e.url||""),r=["jpg","jpeg","png","gif","webp","bmp"].includes(s),i=e.filename||"Attachment",o=d=>d&&!d.startsWith("/api/"),a=e.preview_url||(o(e.url)?e.url:null),l=a;if(r)return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:[c.jsx(_U,{src:a,fullUrl:l,alt:i,width:e.width,height:e.height,isUser:n}),!n&&l&&o(l)&&c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"})," Open"]})}),c.jsxs(te,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>x_(l,i),children:[c.jsx(va,{size:14,className:"mr-1"})," Download"]})]})]});const u=s==="pdf";return c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:u?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Kv,{size:12})," PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:s?s.toUpperCase():"FILE"})}),!n&&c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:i})]}),!n&&l&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"})," Open"]})}),c.jsxs(te,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>x_(l,i),children:[c.jsx(va,{size:14,className:"mr-1"})," Download"]})]})]})})}),vU=400,bU=400,wU=300,kU=200,_U=ge.memo(function({src:e,fullUrl:n,alt:s,width:r,height:i,isUser:o}){const a=e&&_g.has(e),[l,u]=v.useState(a),[d,h]=v.useState(!1);v.useEffect(()=>{e&&_g.has(e)?u(!0):e&&(u(!1),h(!1))},[e]);const f=v.useCallback(()=>{e&&_g.add(e),u(!0)},[e]),p=v.useCallback(()=>{h(!0)},[]),b=v.useMemo(()=>{let y,g;if(r&&i&&r>0&&i>0){const m=r/i;m>=1?(y=Math.min(r,vU),g=Math.round(y/m)):(g=Math.min(i,bU),y=Math.round(g*m))}else y=wU,g=kU;return{width:y,height:g,minWidth:y,minHeight:g,maxWidth:y,maxHeight:g}},[r,i]);if(!e)return c.jsx("div",{className:"flex items-center justify-center bg-black/5 dark:bg-white/5 rounded-lg animate-pulse",style:b,children:c.jsx(Uw,{className:"text-black/20 dark:text-white/20",size:24})});if(d)return c.jsx("div",{className:"flex items-center justify-center bg-black/5 dark:bg-white/5 rounded-lg",style:b,children:c.jsx(Uw,{className:"text-red-400",size:24})});const x=c.jsx("div",{className:"overflow-hidden rounded-lg bg-black/5 dark:bg-white/5",style:{...b,contain:"layout"},children:c.jsx("img",{src:e,alt:s,className:`w-full h-full object-contain transition-opacity duration-150 ${l?"opacity-100":"opacity-0"}`,onLoad:f,onError:p})});return!o&&n?c.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"block",children:x}):x});function SU({value:t,onChange:e,placeholder:n,onEnter:s}){const r=v.useRef(null);return v.useEffect(()=>{const i=r.current;i&&(i.style.height="0px",i.style.height=Math.min(i.scrollHeight,132)+"px")},[t]),c.jsx("textarea",{ref:r,rows:1,value:t,onChange:i=>e(i.target.value),onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),s==null||s())},placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function jU({text:t}){const e=(t||"Thinking").replace(/\s*\.{3,}$/,"");return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:e}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function CU(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||"assistant",content:t.content||"",files:t.files||t.attachments||[],status:null,is_tool_response:!!t.is_tool_response}}function g_(){const t=new Date().getHours(),e=t>=5&&t<12?"morning":t<17?"afternoon":t<21?"evening":"night";return{id:crypto.randomUUID(),role:"assistant",content:`Good ${e}, how can I help?`,files:[],status:null}}function NU(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length>1?n.pop().toLowerCase():""}async function x_(t,e){try{const n=Ed(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{window.open(t,"_blank")}}function Ty(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function EU(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(u,d,h)=>(e.push({lang:d,code:h.trim()}),`__CODE_BLOCK_${e.length-1}__`));const s=[];n=n.replace(/`([^`]+)`/g,(u,d)=>(s.push(d),`__INLINE_CODE_${s.length-1}__`));const r=n.split(`
`),i=[];let o=!1,a=null;for(const u of r){const d=u.match(/^__CODE_BLOCK_(\d+)__$/);if(d){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const b=e[parseInt(d[1])];i.push(`<pre class="chat-code-block"><code>${Ty(b.code)}</code></pre>`);continue}const h=u.match(/^(#{1,6})\s+(.*)$/);if(h){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const b=h[1].length;i.push(`<h${b} class="chat-header">${Ah(h[2])}</h${b}>`);continue}const f=u.match(/^[-*]\s+(.*)$/);if(f){(!o||a!=="ul")&&(o&&i.push("</ol>"),i.push('<ul class="chat-list">'),o=!0,a="ul"),i.push(`<li>${Ah(f[1])}</li>`);continue}const p=u.match(/^\d+\.\s+(.*)$/);if(p){(!o||a!=="ol")&&(o&&i.push("</ul>"),i.push('<ol class="chat-numbered-list">'),o=!0,a="ol"),i.push(`<li>${Ah(p[1])}</li>`);continue}o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1),u.trim()===""?i.push("<br>"):i.push(Ah(u)+"<br>")}o&&i.push(a==="ul"?"</ul>":"</ol>");let l=i.join("");return s.forEach((u,d)=>{l=l.replace(`__INLINE_CODE_${d}__`,`<code class="chat-inline-code">${Ty(u)}</code>`)}),l}function Ah(t){return t?Ty(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>"):""}function Ce({label:t,children:e,className:n,labelClassName:s,withGap:r=!0}){return c.jsxs("label",{className:Te("block",r&&"space-y-1",n),children:[c.jsx("div",{className:Te("text-xs font-semibold text-black/60 dark:text-white/65",s),children:t}),e]})}function ot({value:t="",options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,className:i,contentClassName:o,useNativeSelect:a=!1}){const l=v.useMemo(()=>e.find(u=>u.value===t),[e,t]);return a?c.jsxs("select",{className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","disabled:opacity-60 disabled:cursor-not-allowed",i),value:t,onChange:u=>n==null?void 0:n(u.target.value),disabled:r,children:[s?c.jsx("option",{value:"",disabled:!0,children:s}):null,e.map(u=>c.jsx("option",{value:u.value,disabled:u.disabled,children:u.label},u.value))]}):r?c.jsxs("button",{type:"button",disabled:!0,className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Te("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(ss,{size:16,className:"text-black/50 dark:text-white/60"})]}):c.jsxs(Jp,{children:[c.jsx(Zp,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Te("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(ss,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx(Dd,{align:"start",className:Te("min-w-[220px]",o),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(u=>{const d=u.value===t;return c.jsx(Qu,{disabled:u.disabled,onSelect:()=>{u.disabled||n==null||n(u.value)},className:Te("cursor-pointer gap-0 py-1",d&&"bg-black/5 dark:bg-white/10 font-semibold"),children:c.jsx("span",{className:"min-w-0 truncate",children:u.label})},u.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]})}function TU({locations:t,timeOfDay:e,side:n,templateOptions:s,getTemplateKey:r,defaultFrameConfig:i,templateKey:o,setTemplateKey:a,venueType:l,timeOfDayDisabled:u,locationOptions:d}){const[h,f]=v.useState(""),p=o??h,b=a??f,[x,y]=v.useState(null),[g,m]=v.useState(i),[w,k]=v.useState(""),[_,C]=v.useState(null),[S,j]=v.useState([]),[N,R]=v.useState(!1),[M,O]=v.useState(""),D=ge.useRef([]),$=v.useMemo(()=>{const P=new Map;return s.forEach(A=>{P.set(r(A),A)}),P},[r,s]),L=v.useMemo(()=>{const P=new Map;return(d||[]).forEach(A=>{const F=(A==null?void 0:A.location_key)??(A==null?void 0:A.key)??(A==null?void 0:A.id)??(A==null?void 0:A.value)??A;if(!F)return;const z=(A==null?void 0:A.display_name)??(A==null?void 0:A.name)??(A==null?void 0:A.label)??F;P.set(String(F),z)}),P},[d]),U=v.useMemo(()=>t.length?t.map(P=>L.get(String(P))||P).filter(Boolean).join(", "):"",[L,t]),W=t.length&&(_||w.trim())&&!N;v.useEffect(()=>{if(!p){y(null),m(i);return}const P=$.get(p);if(!P){y(null),m(i);return}y(P),m(mf(P.config,i))},[i,p,$]),v.useEffect(()=>{p&&b("")},[n,e,t,l,u]),v.useEffect(()=>{D.current=S},[S]),v.useEffect(()=>()=>{b_(D.current)},[]);async function E(){if(W){O("");try{R(!0);const P=new FormData,A=u?"all":e;P.append("location_key",t[0]||""),P.append("location_keys",JSON.stringify(t)),P.append("venue_type",l),x?(P.append("time_of_day",x.time_of_day||A||"all"),P.append("side",x.side||n||"all"),P.append("specific_photo",x.photo),P.append("frame_config",JSON.stringify(g))):(P.append("time_of_day",A||"all"),P.append("side",n||"all")),w.trim()?P.append("ai_prompt",w.trim()):_&&P.append("creative",_);const F=await bB(P),z=await AU(F,U),G={id:crypto.randomUUID(),location:U,images:z};j(q=>{const B=[G,...q];if(B.length>3){const Q=B.pop();b_([Q])}return B})}catch(P){O((P==null?void 0:P.message)||"Unable to generate mockup.")}finally{R(!1)}}}return{templateKey:p,setTemplateKey:b,aiPrompt:w,setAiPrompt:k,creativeFile:_,setCreativeFile:C,lastResults:S,generating:N,generateError:M,setGenerateError:O,onGenerate:E,canGenerate:W}}function PU(t){const e=TU(t);return c.jsx(RU,{...t,...e})}function RU({locations:t,setLocations:e,venueType:n,setVenueType:s,setTemplateKey:r,locationOptions:i,locationsQuery:o,timeOfDay:a,setTimeOfDay:l,timeOfDayDisabled:u,sideDisabled:d,side:h,setSide:f,timeOfDayOptions:p,sideOptions:b,venueTypeOptions:x,templateKey:y,templateOptions:g,templatesQuery:m,templateThumbs:w,getTemplateKey:k,creativeFile:_,setCreativeFile:C,creativeDragActive:S,handleCreativeDragOver:j,handleCreativeDragLeave:N,handleCreativeDrop:R,aiPrompt:M,setAiPrompt:O,generateError:D,setGenerateError:$,generating:L,onGenerate:U,canGenerate:W,lastResults:E,useNativeSelects:P}){const A=v.useMemo(()=>i.map(z=>{const G=(z==null?void 0:z.key)??(z==null?void 0:z.id)??(z==null?void 0:z.value)??z,q=(z==null?void 0:z.name)??(z==null?void 0:z.label)??G;return{value:G,label:q}}),[i]);function F(){e([]),s("all"),l("all"),f("all"),r(""),C(null),O(""),$("")}return c.jsxs(vt,{className:"h-full flex flex-col",children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Mockup Generator"})}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[c.jsxs(Ce,{label:"Location",children:[c.jsx(ot,{value:t[0]||"",options:A,placeholder:"Select a location",onChange:z=>{e(z?[z]:[]),r("")},useNativeSelect:P}),o.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading locations"})}):null]}),c.jsx(Ce,{label:"Venue Type",children:c.jsx(ot,{value:n,options:x,onChange:z=>s(z),useNativeSelect:P})}),!u&&c.jsx(Ce,{label:"Time of Day",children:c.jsx(ot,{value:a,options:p,onChange:z=>l(z),useNativeSelect:P})}),!d&&c.jsx(Ce,{label:"Billboard Side",children:c.jsx(ot,{value:h,options:b,onChange:z=>f(z),useNativeSelect:P})})]}),t.length?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Templates (optional)"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Select a template or keep random."})]}),y?c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>r(""),children:"Use random"}):null]}),m.isLoading?c.jsx(Ye,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!m.isLoading&&!g.length?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:g.map(z=>{const G=k(z),q=G===y,B=w[G],Q=z.environment||n||"all",pe=z.time_of_day||(u?"all":a)||"all",Z=z.side||(d?"all":h)||"all";return c.jsxs("div",{className:Te("rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-left text-sm transition flex flex-col",q?"border-2":"hover:bg-black/5 dark:hover:bg-white/10"),style:q?{borderColor:"rgb(var(--brand-accent) / 0.6)",boxShadow:"0 0 0 1px rgb(var(--brand-accent) / 0.25)"}:void 0,children:[c.jsxs("button",{type:"button",onClick:()=>r(G),className:"text-left flex flex-col flex-1",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:B?c.jsx("img",{src:B,alt:z.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-1",children:[c.jsx("div",{className:"font-semibold truncate",children:z.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[Q,"/",pe,"/",Z," - ",z.frame_count," frame",z.frame_count>1?"s":""]})]})]}),c.jsx("div",{className:"pt-2",children:B?c.jsx(te,{variant:"secondary",size:"sm",className:"w-full rounded-xl",asChild:!0,children:c.jsxs("a",{href:B,target:"_blank",rel:"noreferrer",children:[c.jsx(ho,{size:16,className:"mr-2"}),"Open"]})}):c.jsx(te,{variant:"secondary",size:"sm",className:"w-full rounded-xl",disabled:!0,children:"Open"})})]},G)})})]}):null,c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Upload Creative/Ad Image",children:_?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:j,onDragLeave:N,onDrop:R,children:[c.jsx("div",{className:"truncate",children:_.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>C(null),children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:j,onDragLeave:N,onDrop:R,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:z=>{var G;return C(((G=z.target.files)==null?void 0:G[0])||null)}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP, GIF up to 10MB"})]})}),c.jsx(Ce,{label:"Or use AI prompt",children:c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px]",value:M,onChange:z=>O(z.target.value),placeholder:"Describe what you want to generate..."})})]}),D?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:D}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(te,{className:"rounded-2xl",onClick:U,disabled:!W,children:L?c.jsx(Ye,{text:"Generating Mockup"}):"Generate Mockup"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:F,disabled:L,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4",children:[!E.length&&!L?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,L?c.jsx(Ye,{text:"Processing mockup",className:"text-sm text-black/60 dark:text-white/65"}):null,E.length?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Mockups"}),E.map(z=>{var G;return c.jsxs("div",{className:"space-y-3",children:[z.location?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:z.location}):null,(G=z.images)!=null&&G.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:z.images.map((q,B)=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("a",{href:q.url,target:"_blank",rel:"noopener noreferrer",className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:q.url,alt:q.label||"Generated mockup",className:"w-full h-40 object-cover",loading:"lazy"})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:q.url,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:Q=>{Q.preventDefault(),w_(q.url,q.filename)},onKeyDown:Q=>{(Q.key==="Enter"||Q.key===" ")&&(Q.preventDefault(),w_(q.url,q.filename))},className:"inline-flex items-center",children:[c.jsx(va,{size:14,className:"mr-1"}),"Download"]})})]})]},`${z.id}-img-${B}`))}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No images returned yet."})]},z.id)})]}):null]})]})]})}function y_(t){return typeof Blob<"u"&&t instanceof Blob}async function AU(t,e){if(!t)return[];if(t instanceof Response){const i=await t.blob();return i?[Sg(i,e,1)]:[]}if(y_(t))return[Sg(t,e,1)];const n=t,s=(n==null?void 0:n.images)||(n==null?void 0:n.image_urls)||(n==null?void 0:n.urls)||(n==null?void 0:n.results)||(n==null?void 0:n.files)||(n==null?void 0:n.data)||null,r=Array.isArray(s)?s:n!=null&&n.url?[n.url]:[];return r.length?r.map((i,o)=>{if(typeof i=="string")return v_(i,e,o+1);if(y_(i))return Sg(i,e,o+1);const a=(i==null?void 0:i.url)||(i==null?void 0:i.image_url)||(i==null?void 0:i.file_url)||"";return v_(a,e,o+1)}):[]}function Sg(t,e,n){const s=URL.createObjectURL(t),r=Py(s,e,n);return{url:s,filename:r}}function v_(t,e,n){return t?{url:t,filename:Py(t,e,n)}:{url:"",filename:Py("",e,n)}}function Py(t,e,n){const s=OU(t);if(s)return s;const r=(e||"result").toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),i=n?`_${n}`:"";return`mockup_${r||"result"}${i}.jpg`}function OU(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function b_(t){(Array.isArray(t)?t:[]).forEach(n=>{((n==null?void 0:n.images)||[]).forEach(s=>{var r;(r=s==null?void 0:s.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(s.url)})})}async function w_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e||"download",document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function IU(t,e,n){return t.length?t.length<=n?t.join(", "):`${t.slice(0,n).join(", ")} +${t.length-n}`:e}function MU({value:t=[],options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,maxLabelCount:i=2,className:o,contentClassName:a}){const l=v.useMemo(()=>new Set(t),[t]),u=v.useMemo(()=>e.filter(f=>l.has(f.value)).map(f=>f.label),[e,l]);function d(f){r||n&&(l.has(f)?n(t.filter(p=>p!==f)):n([...t,f]))}const h=IU(u,s,i);return c.jsxs("div",{className:"space-y-2",children:[c.jsxs(Jp,{children:[c.jsx(Zp,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",o),children:[c.jsx("span",{className:Te("truncate",!u.length&&"text-black/50 dark:text-white/55"),children:h}),c.jsx(ss,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx(Dd,{align:"start",className:Te("min-w-[220px]",a),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(f=>{const p=l.has(f.value);return c.jsxs(Qu,{onSelect:b=>{b.preventDefault(),d(f.value)},className:"cursor-pointer py-1",children:[c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",p?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ca,{size:10,className:p?"opacity-100":"opacity-0"})}),c.jsx("span",{className:"min-w-0 truncate",children:f.label})]},f.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]}),u.length?c.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(f=>c.jsx("span",{className:"text-[11px] rounded-md bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/70 px-2",children:f},f))}):null]})}function DU({locations:t,setLocations:e,venueType:n,setVenueType:s,assetType:r,setAssetType:i,setTemplateKey:o,locationOptions:a,locationsQuery:l,assetTypeOptions:u,assetTypesQuery:d,timeOfDay:h,setTimeOfDay:f,timeOfDayDisabled:p,sideDisabled:b,side:x,setSide:y,timeOfDayOptions:g,sideOptions:m,venueTypeOptions:w,editingTemplate:k,editingTemplateLoading:_,stopEditTemplate:C,templatesOpen:S,setTemplatesOpen:j,templateOptions:N,templatesQuery:R,templateThumbs:M,getTemplateKey:O,startEditTemplate:D,deleteTemplate:$,setupPhoto:L,setSetupPhoto:U,handleSetupPhoto:W,handleSetupDragOver:E,handleSetupDragLeave:P,handleSetupDrop:A,setupDragActive:F,handleSetupPhotoClear:z,framesJson:G,setFramesJson:q,setFramesJsonDirty:B,applyFramesJsonToCanvas:Q,buildFramesPayload:pe,setupImageReady:Z,greenscreenOpen:be,setGreenscreenOpen:De,greenscreenColor:xe,setGreenscreenColor:me,greenscreenDetecting:Le,colorTolerance:Y,setColorTolerance:ae,RangeField:le,handleGreenscreenDetect:oe,canDetectGreenscreen:re,hasActiveFrame:_e,frameSettingsOpen:se,setFrameSettingsOpen:V,setupFrameConfig:ye,handleSetupFrameConfigChange:Ne,FrameConfigControls:Re,previewOpen:J,setPreviewOpen:ee,testPreviewMode:ne,setTestPreviewMode:ke,testPreviewImgRef:fn,testPreviewUrlRef:xr,previewImgRef:on,drawPreview:Rs,activeTestCreativeFile:ds,updateTestCreativeForActive:As,generateTestPreview:Ur,testPreviewing:ct,activeFrameIndex:lt,canvasRef:At,canvasWidth:pn,canvasHeight:hs,handleCanvasPointerDown:cm,handleCanvasPointerMove:um,handleCanvasPointerUp:wi,handleCanvasWheel:Oa,setupHint:Ia,handleZoomOut:Ma,handleZoomIn:Hd,handleFitToScreen:Wd,zoomPercent:Ot,pixelUpscale:ft,setPixelUpscale:Qs,setupError:Os,setupMessage:Kn,addFrame:Vd,resetCurrentFrame:Da,saveSetup:vc,setupSaving:Gn,clearAllFrames:ut,currentPoints:gt,frameCount:Co,useNativeSelects:an}){var _c,Sc,qd;const[Kt,No]=v.useState({open:!1,template:null}),[Hr,La]=v.useState(!1),bc=((_c=Kt.template)==null?void 0:_c.time_of_day)||"all",wc=((Sc=Kt.template)==null?void 0:Sc.side)||"all",$a=((qd=Kt.template)==null?void 0:qd.storage_key)||"",Eo=$a?` for ${$a}`:"",kc=Kt.template?`Delete "${Kt.template.photo}" (${bc}/${wc})${Eo}? This removes the photo and its frames.`:"Delete this template? This removes the photo and its frames.";async function dm(){if(!(!Kt.template||Hr)){La(!0);try{await $(Kt.template)}finally{La(!1),No({open:!1,template:null})}}}function hm(){Hr||No({open:!1,template:null})}return c.jsxs(c.Fragment,{children:[c.jsxs(vt,{className:"h-full flex flex-col",children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Mockup Setup"})}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[c.jsxs(Ce,{label:"Location",children:[c.jsx(MU,{value:t,onChange:de=>{e(de),o("")},options:a.map(de=>{const Cn=(de==null?void 0:de.key)??(de==null?void 0:de.id)??(de==null?void 0:de.value)??de,Wr=(de==null?void 0:de.name)??(de==null?void 0:de.label)??Cn;return{value:Cn,label:Wr}}),placeholder:"Select locations"}),l.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading locations"})}):null]}),c.jsxs(Ce,{label:"Asset Type",children:[c.jsx(ot,{value:r,options:[{value:"",label:"All asset types"},...u.map(de=>typeof de=="string"?{value:de,label:de}:{value:(de==null?void 0:de.type_key)??(de==null?void 0:de.key)??(de==null?void 0:de.id)??(de==null?void 0:de.value)??"",label:(de==null?void 0:de.name)??(de==null?void 0:de.label)??(de==null?void 0:de.type_key)??"Unknown"})],placeholder:"Select asset type",onChange:de=>i(de),useNativeSelect:an}),d!=null&&d.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading asset types"})}):null]}),c.jsx(Ce,{label:"Venue Type",children:c.jsx(ot,{value:n,options:w,placeholder:"Select venue type",onChange:de=>s(de),useNativeSelect:an})}),!p&&c.jsx(Ce,{label:"Time of Day",children:c.jsx(ot,{value:h,options:g,placeholder:"Select time of day",onChange:de=>f(de),useNativeSelect:an})}),!b&&c.jsx(Ce,{label:"Billboard Side",children:c.jsx(ot,{value:x,options:m,placeholder:"Select side",onChange:de=>y(de),useNativeSelect:an})})]}),k?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/50 dark:bg-white/5 px-4 py-3 flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:"Editing template:"})," ",k.photo," (",k.time_of_day,"/",k.side,")"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[_?c.jsx(Ye,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"}):null,c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,children:"Stop editing"})]})]}):null,k?null:c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>j(de=>!de),"aria-expanded":S,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Existing templates"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:t.length?`${N.length} template${N.length===1?"":"s"}`:"Select at least one location to load templates."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:S?"Hide":"Show"}),c.jsx(ss,{size:16,className:Te("transition-transform",S&&"rotate-180")})]})]}),S?c.jsxs("div",{className:"mt-3 space-y-2",children:[R.isLoading?c.jsx(Ye,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!R.isLoading&&(!N.length||!t.length)?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:N.map(de=>{const Cn=O(de);return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:M[Cn]?c.jsx("img",{src:M[Cn],alt:de.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-2",children:[c.jsx("div",{className:"font-semibold truncate",children:de.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[de.time_of_day,"/",de.side," - ",de.frame_count," frame",de.frame_count>1?"s":""]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>D(de),disabled:_||Hr,children:"Edit"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>No({open:!0,template:de}),disabled:Hr,children:"Delete"})]})]})]},Cn)})})]}):null]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Upload Billboard Photo",children:L?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${F?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:E,onDragLeave:P,onDrop:A,children:[c.jsx("div",{className:"truncate",children:L.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:z,children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${F?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:E,onDragLeave:P,onDrop:A,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp",onChange:de=>{var Wr;const Cn=(Wr=de.target.files)==null?void 0:Wr[0];Cn&&(U(Cn),W(Cn))}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP up to 20MB"})]})}),c.jsxs(Ce,{label:"Frames Data",children:[c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px] font-mono",value:G,onChange:de=>{q(de.target.value),B(!0)},placeholder:'[{"points":[0,0,0,0],"config":{"brightness":100}}]'}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-black/50 dark:text-white/60",children:[c.jsx("span",{children:"Auto-filled from canvas. Edit to override."}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"text-xs underline",onClick:Q,children:"Apply to canvas"}),c.jsx("button",{type:"button",className:"text-xs underline",onClick:()=>{B(!1);const de=pe();q(de.length?JSON.stringify(de,null,2):"[]")},children:"Sync from canvas"})]})]})]})]}),Z?c.jsxs(c.Fragment,{children:[c.jsxs(Ft,{className:"bg-white/50 dark:bg-white/5 p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>De(de=>!de),"aria-expanded":be,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Green Screen Detection"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Detect billboard frame using chroma key."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:be?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",be&&"rotate-180")})]})]}),be?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"color",value:xe,onChange:de=>me(de.target.value.toUpperCase()),className:"h-10 w-16 rounded-lg border border-black/10 dark:border-white/20"}),c.jsx("input",{type:"text",value:xe,onChange:de=>me(de.target.value.toUpperCase()),className:"flex-1 rounded-xl bg-white/70 dark:bg-white/10 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none font-mono"})]}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Tip: Shift+click to pick a color. Shift+drag or middle mouse pans."}),c.jsx(le,{label:"Color Tolerance",value:Y,min:10,max:100,onChange:de=>ae(de),helper:"Lower is stricter, higher is more forgiving."}),c.jsx(te,{className:"rounded-2xl w-full",onClick:oe,disabled:!re||Le,children:Le?c.jsx(Ye,{text:"Detecting"}):"Detect Green Screen Now"})]}):null]}),_e?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>V(de=>!de),"aria-expanded":se,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Current Frame Settings"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Adjust the current frame appearance."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:se?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",se&&"rotate-180")})]})]}),se?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsx(Re,{config:ye,onChange:Ne}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Settings apply to the current frame only."})]}):null]}):null,_e?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>ee(de=>!de),"aria-expanded":J,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Test Preview Mode"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Preview creative on the current frame before saving."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:J?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",J&&"rotate-180")})]})]}),J?c.jsxs("div",{className:"mt-3 space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3 text-sm",children:[c.jsx("input",{type:"checkbox",checked:ne,onChange:de=>{ke(de.target.checked),de.target.checked||(fn.current=null,xr.current="",Rs())}}),c.jsx("span",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Enable preview"})]}),ne?c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-semibold text-blue-900 dark:text-blue-100",children:"Upload Test Creative"}),c.jsx("input",{type:"file",accept:"image/*",onChange:de=>{var Cn;return As(((Cn=de.target.files)==null?void 0:Cn[0])||null)},className:"w-full text-sm"}),ds?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Selected: ",ds.name]}):null,c.jsx(te,{className:"rounded-2xl w-full",onClick:Ur,disabled:!ds||!L||!_e||ct,children:ct?c.jsx(Ye,{text:"Generating"}):"Generate Test Preview"}),lt>=0?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Preview applies to frame ",lt+1,"."]}):null]}):null]}):null]}):null]}):null]}),Z?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-2",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:Ma,disabled:!on.current,children:"-"}),c.jsx(te,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:Hd,disabled:!on.current,children:"+"}),c.jsx(te,{variant:"ghost",size:"sm",onClick:Wd,disabled:!on.current,children:"Fit"}),c.jsxs("span",{className:"text-xs text-black/60 dark:text-white/60",children:[Ot,"%"]})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-black/70 dark:text-white/70",children:[c.jsx("input",{type:"checkbox",checked:ft,onChange:de=>Qs(de.target.checked)}),"Pixel Upscale"]})]}),c.jsx("canvas",{ref:At,width:pn,height:hs,className:"w-full h-auto rounded-xl border border-black/10 dark:border-white/10 bg-white",onPointerDown:cm,onPointerMove:um,onPointerUp:wi,onPointerLeave:wi,onWheel:Oa,style:{touchAction:"none"}}),c.jsx("div",{className:"text-xs text-black/60 dark:text-white/60",children:Ia})]}):c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-black/5 dark:bg-white/10 px-4 py-3 text-sm text-black/60 dark:text-white/65",children:"Upload a billboard photo or pick an existing template to enable the canvas tools."})]}),Os?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:Os}):null,Kn?c.jsx("div",{className:"rounded-xl bg-green-50/70 text-green-700 px-4 py-2 text-sm dark:bg-green-500/10 dark:text-green-200",children:Kn}):null,c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(te,{className:"rounded-2xl",onClick:Vd,disabled:gt.length!==4,children:"Add Frame"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:Da,children:"Reset Current Frame"}),c.jsx(te,{className:"rounded-2xl",onClick:vc,disabled:Gn||!t.length||!L,children:Gn?c.jsx(Ye,{text:"Saving"}):k?"Save Changes":"Save All Frames"}),c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>ut(!1),children:"Clear All Frames"})]}),Co?c.jsxs("div",{className:"rounded-xl bg-blue-50/70 text-blue-900 px-3 py-2 text-sm dark:bg-blue-500/10 dark:text-blue-100",children:["Frames configured: ",Co]}):null]})]}),c.jsx(fc,{open:Kt.open,message:kc,onClose:hm,onConfirm:dm})]})}function LU({enabled:t}){const e=Ht({queryKey:["mockup","history"],queryFn:wB,enabled:t}),n=v.useMemo(()=>{var s,r,i;return Array.isArray(e.data)?e.data:(s=e.data)!=null&&s.history?e.data.history:(r=e.data)!=null&&r.mockups?e.data.mockups:(i=e.data)!=null&&i.items?e.data.items:e.data||[]},[e.data]);return{historyQuery:e,historyItems:n}}function $U(t){const e=LU(t);return c.jsx(FU,{...e})}function FU({historyQuery:t,historyItems:e}){return c.jsxs(vt,{className:"h-full flex flex-col",children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"History"})}),c.jsx($t,{className:"flex-1 min-h-0 overflow-y-auto",children:t.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):t.isError?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Unable to load history right now."}):c.jsxs("div",{className:"space-y-2",children:[(e||[]).map((n,s)=>{const r=n.image_url||n.mockup_url||n.result_url||n.file_url||n.url||n.image||"",i=n.location_name||n.location||n.location_key||n.location_id||"Mockup",o=n.time_of_day||n.timeOfDay||"",a=n.side||n.billboard_side||"",l=n.created_at||n.generated_at||n.date_generated||"",u=["mockup",i,o||"all",a||"all"].filter(Boolean).join("_");return c.jsxs(Ft,{className:"p-3 space-y-2",children:[r?c.jsx("div",{className:"overflow-hidden rounded-xl border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:r,alt:i,className:"w-full h-40 object-cover",loading:"lazy"})}):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 px-3 py-6 text-sm text-black/60 dark:text-white/65 text-center",children:"Preview not available"}),c.jsx("div",{className:"text-base font-semibold",children:i}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[l?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Generated"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:new Date(l).toLocaleString()})]}):null,o?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Time of Day"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:o})]}):null,a?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Side"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:a})]}):null]}),r?c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:"Open"})}),c.jsx(te,{asChild:!0,size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsx("a",{href:r,download:u,children:"Download"})})]}):null]},n.id||n.file_id||r||s)}),e!=null&&e.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No mockups yet."})]})})]})}const GT=[{value:"all",label:"All (Default)"},{value:"day",label:"Day"},{value:"night",label:"Night"}],zU=GT.filter(t=>t.value!=="all"),YT=[{value:"all",label:"All (Default)"},{value:"gold",label:"Gold"},{value:"silver",label:"Silver"},{value:"single_side",label:"Single Side"}],BU=YT.filter(t=>t.value!=="all"),QT=[{value:"all",label:"All (Default)"},{value:"outdoor",label:"Outdoor"},{value:"indoor",label:"Indoor"}],UU=QT.filter(t=>t.value!=="all"),k_=!1,Oh=1200,Ih=800,HU=.5,WU=4,__=.1,VU=4,zo={brightness:100,contrast:100,saturation:100,depthMultiplier:15,lightDirection:"top",imageBlur:0,edgeBlur:1,overlayOpacity:0,shadowIntensity:0,lightingAdjustment:0,colorTemperature:0,vignette:0,edgeSmoother:3,sharpening:0},XT=[{value:"top-left",label:"Top Left",glyph:""},{value:"top",label:"Top",glyph:""},{value:"top-right",label:"Top Right",glyph:""},{value:"left",label:"Left",glyph:""},{value:"center",label:"Center",glyph:""},{value:"right",label:"Right",glyph:""},{value:"bottom-left",label:"Bottom Left",glyph:""},{value:"bottom",label:"Bottom",glyph:""},{value:"bottom-right",label:"Bottom Right",glyph:""}],qU=XT.reduce((t,e)=>(t[e.value]=e.label,t),{});function KU(t,e,n){const s=(t-e)/(n-e)*100;return`linear-gradient(to right, rgb(var(--brand-accent, 102 126 234)) ${s}%, rgba(0, 0, 0, 0.1) ${s}%)`}function GU(){var ab,lb;const t=gr(),{user:e}=mi(),n=gf(e,"sales:mockups:setup"),s=Ht({queryKey:["service-visibility"],queryFn:v0,staleTime:3e4}),r=((ab=s.data)==null?void 0:ab.mockup_generate)!==!1,i=((lb=s.data)==null?void 0:lb.mockup_setup)!==!1,o=()=>r?"generate":i&&n?"setup":"history",[a,l]=v.useState(o);v.useEffect(()=>{a==="generate"&&!r?l(i&&n?"setup":"history"):a==="setup"&&!i&&l(r?"generate":"history")},[r,i,n,a]);const[u,d]=v.useState([]),[h,f]=v.useState("all"),[p,b]=v.useState(""),[x,y]=v.useState("all"),[g,m]=v.useState("all"),[w,k]=v.useState(""),_=u[0]||"",C=h==="indoor",S=C,j=C,N=S?"all":x;v.useEffect(()=>{h==="indoor"&&(x&&y(""),g&&m(""))},[h]);const R=v.useRef(a),[M,O]=v.useState(null),[D,$]=v.useState(!1),[L,U]=v.useState(""),[W,E]=v.useState(""),[P,A]=v.useState("[]"),[F,z]=v.useState(!1),[G,q]=v.useState({}),[B,Q]=v.useState(null),[pe,Z]=v.useState(!1),[be,De]=v.useState(!1),[xe,me]=v.useState(!1),[Le,Y]=v.useState("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),[ae,le]=v.useState(zo),[oe,re]=v.useState("#1CFF1C"),[_e,se]=v.useState(40),[V,ye]=v.useState(!1),[Ne,Re]=v.useState([]),[J,ee]=v.useState(0),[ne,ke]=v.useState(1),[fn,xr]=v.useState(!1),[on,Rs]=v.useState(-1),[ds,As]=v.useState(!1),[Ur,ct]=v.useState(!0),[lt,At]=v.useState(!0),[pn,hs]=v.useState(!0),[cm,um]=v.useState(!0),[wi,Oa]=v.useState(!1),[Ia,Ma]=v.useState({}),[Hd,Wd]=v.useState(!1),Ot=v.useRef(null),ft=v.useRef(null),Qs=v.useRef(null),Os=v.useRef(""),Kn=v.useRef(new Map),Vd=v.useRef({}),Da=v.useRef({}),vc=v.useRef([]),Gn=v.useRef(!1),ut=v.useRef([]),gt=v.useRef([]),Co=v.useRef(-1),an=v.useRef({zoom:1,panX:0,panY:0}),Kt=v.useRef({isDrawing:!1,isDraggingCorner:!1,isDraggingFrame:!1,dragFrameIndex:-1,dragPointIndex:-1,startX:0,startY:0,isPanning:!1,shiftPanPending:!1,hasPanned:!1,panStartX:0,panStartY:0,panOriginX:0,panOriginY:0}),No=v.useRef({pointers:new Map,isPinching:!1,startDistance:0,startZoom:1,startPanX:0,startPanY:0,startCenterX:0,startCenterY:0}),Hr=v.useRef({drawX:0,drawY:0,drawW:0,drawH:0,scale:1,imgNaturalW:0,imgNaturalH:0}),La=Ht({queryKey:["mockup","eligibility","setup"],queryFn:_B,enabled:a==="setup"}),bc=Ht({queryKey:["mockup","eligibility","generate"],queryFn:SB,enabled:a==="generate"}),wc=Ht({queryKey:["mockup","asset-types"],queryFn:fB,enabled:a==="setup"}),$a=Ht({queryKey:["mockup","templates",_,N,g,h],queryFn:()=>Vk(_,{timeOfDay:N,side:g,venueType:h}),enabled:a==="generate"&&!!_}),Eo=OI({queries:a==="setup"?u.map(T=>({queryKey:["mockup","templates",T,N,g,h],queryFn:()=>Vk(T,{timeOfDay:N,side:g,venueType:h}),enabled:!!T,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:!1,staleTime:1/0})):[]}),kc=v.useMemo(()=>{var K;return{data:Eo.flatMap((H,ce)=>{const X=H.data,ve=Array.isArray(X)?X:(X==null?void 0:X.templates)||[],Ee=u[ce];return ve.map(Me=>({...Me,storage_key:Me.storage_key||Ee}))}),isLoading:Eo.some(H=>H.isLoading),isFetching:Eo.some(H=>H.isFetching),error:((K=Eo.find(H=>H.error))==null?void 0:K.error)||null}},[u,Eo]);v.useEffect(()=>()=>{Kn.current.forEach(T=>{T!=null&&T.url&&URL.revokeObjectURL(T.url)}),Kn.current.clear(),Os.current&&URL.revokeObjectURL(Os.current)},[]),v.useEffect(()=>{Vd.current=Ia},[Ia]),v.useEffect(()=>{Da.current=G},[G]);const dm=v.useMemo(()=>{const T=La.data;return Array.isArray(T)?T:(T==null?void 0:T.locations)||[]},[La.data]),hm=v.useMemo(()=>{const T=bc.data;return Array.isArray(T)?T:(T==null?void 0:T.locations)||[]},[bc.data]),_c=a==="setup"?dm:hm,Sc=a==="setup"?La:bc,qd=v.useMemo(()=>{const T=wc.data;return Array.isArray(T)?T:(T==null?void 0:T.asset_types)||(T==null?void 0:T.types)||[]},[wc.data]),de=v.useMemo(()=>{const T=$a.data;return Array.isArray(T)?T:(T==null?void 0:T.templates)||[]},[$a.data]),Cn=v.useMemo(()=>{const T=kc.data;return Array.isArray(T)?T:(T==null?void 0:T.templates)||[]},[kc.data]),Wr=a==="setup"?Cn:de,Y0=v.useMemo(()=>Wr.map(T=>wr(T)).join("|"),[Wr,wr]);v.useEffect(()=>{vc.current=Wr},[Wr]);const F2=a==="history";v.useEffect(()=>{R.current!==a&&(R.current==="setup"&&B&&J0(),d([]),a==="setup"?(f(""),b(""),y(""),m("")):(f("all"),b(""),y("all"),m("all")),k("")),R.current=a},[B,a]),v.useEffect(()=>{h==="indoor"&&x&&y("")},[x,h]),v.useEffect(()=>{q(T=>{const K=new Set(vc.current.map(X=>wr(X))),H={};let ce=!1;return Object.entries(T).forEach(([X,ve])=>{K.has(X)?H[X]=ve:ve&&(ce=!0,URL.revokeObjectURL(ve))}),ce?H:T})},[Y0,wr]),v.useEffect(()=>{let T=!0;const K=vc.current;if(!_||!K.length)return()=>{};const H=K.filter(ce=>!Da.current[wr(ce)]);return H.length?((async()=>{const ce=await Promise.all(H.map(async ve=>{const Ee=wr(ve);let Me="";try{Me=await kB(ve.storage_key||_,ve.photo,{timeOfDay:ve.time_of_day||N,side:ve.side||g,company:ve.company,venueType:ve.venue_type||ve.environment||h})}catch{Me=""}return{key:Ee,url:Me}}));if(!T){ce.forEach(({url:ve})=>{ve&&URL.revokeObjectURL(ve)});return}const X={};ce.forEach(({key:ve,url:Ee})=>{Ee&&!Da.current[ve]?X[ve]=Ee:Ee&&URL.revokeObjectURL(Ee)}),Object.keys(X).length>0&&q(ve=>({...ve,...X}))})(),()=>{T=!1}):()=>{}},[_,Y0,N,g,h,wr]),v.useEffect(()=>()=>{Object.values(Da.current).forEach(T=>{T&&URL.revokeObjectURL(T)})},[]);const z2=!!ft.current,B2=Ne.length===4||on>=0,Xs=on>=0?`frame-${on}`:Ne.length===4?"current":null,Q0=Xs?Ia[Xs]:null,U2=Math.round(ne*100);v.useEffect(()=>{if(!Xs){Qs.current=null,Os.current="";return}const T=Kn.current.get(Xs);Qs.current=(T==null?void 0:T.img)||null,Os.current=(T==null?void 0:T.url)||"",wi&&xt()},[Xs,Ia,wi]),v.useEffect(()=>{ft.current&&jc(),xt()},[wi]),v.useEffect(()=>{xt()},[fn]),v.useEffect(()=>{ds&&ft.current&&xt()},[ds]),v.useEffect(()=>{if(F)return;const T=Fa();A(T.length?JSON.stringify(T,null,2):"[]")},[Ne,J,ae,F]);async function H2(){U(""),E("");const T=B?wr(B):null;if(!u.length){E("Select at least one location first");return}if(!M){E("Upload a billboard photo first");return}let K=Fa();if(P.trim())try{K=JSON.parse(P)}catch(H){E((H==null?void 0:H.message)||"Frames JSON is invalid");return}if(!Array.isArray(K)||!K.length){E("Add at least one frame before saving");return}try{$(!0);const H=new FormData;B?(H.append("location_key",B.storage_key||_),H.append("photo_filename",B.photo),H.append("venue_type",h),p&&H.append("asset_type_key",p),H.append("time_of_day",N||"all"),H.append("side",g||"all"),H.append("frames_data",JSON.stringify(K)),M&&M.name!==B.photo&&H.append("photo",M),await mB(H),U("Updated frames successfully")):(H.append("location_keys",JSON.stringify(u)),H.append("venue_type",h),p&&H.append("asset_type_key",p),H.append("time_of_day",N||"all"),H.append("side",g||"all"),H.append("frames_data",JSON.stringify(K)),H.append("photo",M),await pB(H),U("Saved frames successfully")),ob(!0),Q(null),Z(!1),O(null),ft.current=null,As(!1),T&&q(ce=>{if(!ce[T])return ce;const X={...ce},ve=X[T];return ve&&URL.revokeObjectURL(ve),delete X[T],X}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"}),xt()}catch(H){E((H==null?void 0:H.message)||"Failed to save template")}finally{$(!1)}}async function W2(T){const K=(T==null?void 0:T.storage_key)||_;if(!K||!(T!=null&&T.photo))return;const H=(T==null?void 0:T.environment)||(T==null?void 0:T.venue_type)||"outdoor",ce=T!=null&&T.time_of_day&&T.time_of_day!=="all"?T.time_of_day:"day",X=T!=null&&T.side&&T.side!=="all"?T.side:"gold";try{T!=null&&T.company?await yB({company:T.company,locationKey:K,environment:H,timeOfDay:ce,side:X,photoFilename:T.photo}):await gB(K,T.photo,{timeOfDay:T.time_of_day,side:T.side}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"})}catch(ve){E((ve==null?void 0:ve.message)||"Failed to delete template")}}function X0(T,{resetFrames:K=!0}={}){ft.current=T,As(!0);const H=eP(T.naturalWidth,T.naturalHeight);Hr.current={drawX:H.x,drawY:H.y,drawW:H.w,drawH:H.h,scale:H.scale,imgNaturalW:T.naturalWidth,imgNaturalH:T.naturalHeight},mm(!1),K&&(ut.current=[],gt.current=[],Is(),Gn.current=!1,cP(),Kd(),fs(),Po(),A("[]"),z(!1)),jc(),xt()}function V2(T,K){return new Promise((H,ce)=>{const X=new Image;X.onload=()=>{X0(X,K),H()},X.onerror=()=>ce(new Error("Failed to load image")),X.src=T})}function q2(T,K){return new Promise((H,ce)=>{const X=new FileReader;X.onload=ve=>{const Ee=new Image;Ee.onload=()=>{X0(Ee,K),H()},Ee.onerror=()=>ce(new Error("Failed to load image")),Ee.src=ve.target.result},X.onerror=()=>ce(new Error("Failed to read image")),X.readAsDataURL(T)})}function fm(T){return T?Array.isArray(T)&&T.length===4&&Array.isArray(T[0])?T:Array.isArray(T)&&T.length>=8&&typeof T[0]=="number"?[[T[0],T[1]],[T[2],T[3]],[T[4],T[5]],[T[6],T[7]]]:null:null}function K2(T){if(!T)return[];let K=T.frames||T.frames_data||T.framesData||T.frame_data||T.frame_points;if(typeof K=="string")try{K=JSON.parse(K)}catch{K=[]}return Array.isArray(K)?K.map(H=>{const ce=fm((H==null?void 0:H.points)||(H==null?void 0:H.frame_points)||H)||fm(H==null?void 0:H.points);if(!ce)return null;let X=(H==null?void 0:H.config)||(T==null?void 0:T.config);if(typeof X=="string")try{X=JSON.parse(X)}catch{X=null}const ve=mf(X,zo);return{points:ce,config:ve,source:"existing"}}).filter(Boolean):[]}async function G2(T){if(!(!_||!(T!=null&&T.photo))){Q(T),Z(!0),E(""),U(""),O(null);try{const K=T.venue_type||T.environment||"outdoor",H=T.time_of_day&&T.time_of_day!=="all"?T.time_of_day:"day",ce=T.side&&T.side!=="all"?T.side:"gold";f(K),K==="indoor"?(y(""),m("")):(T.time_of_day&&T.time_of_day!=="all"?y(T.time_of_day):y(""),T.side&&T.side!=="all"?m(T.side):m(""));const X=await oT(T.storage_key||_,T.photo,{timeOfDay:T.time_of_day||N,side:T.side||g,company:T.company,venueType:T.venue_type||T.environment||h});if(!X)throw new Error("Failed to load template image");const ve=URL.createObjectURL(X);try{await V2(ve,{resetFrames:!1})}finally{URL.revokeObjectURL(ve)}let Ee=T;if(T.company){const Xe=await xB({company:T.company,locationKey:T.storage_key||_,environment:K,timeOfDay:H,side:ce,photoFilename:T.photo});Xe!=null&&Xe.frames_data&&(Ee={...T,frames_data:Xe.frames_data,config:Xe.config??T.config,time_of_day:Xe.time_of_day||T.time_of_day,side:Xe.side||T.side,environment:Xe.environment||T.environment})}const Me=K2(Ee);gt.current=Me,ut.current=[],Is(),Gn.current=!1,fs(),Po(),A(Me.length?JSON.stringify(Fa(),null,2):"[]"),z(!1),xt();const yt=new File([X],T.photo,{type:X.type||"image/jpeg"});O(yt)}catch(K){E((K==null?void 0:K.message)||"Failed to load template for editing")}finally{Z(!1)}}}function J0(){Q(null),Z(!1),U(""),E(""),y(""),m(""),O(null),ft.current=null,As(!1),ut.current=[],gt.current=[],Is(),Gn.current=!1,fs(),Po(),A("[]"),z(!1),jc(),xt()}function pm(T){const K=Ot.current;if(!K)return null;const H=K.getBoundingClientRect(),ce=K.width/H.width,X=K.height/H.height;return{x:(T.clientX-H.left)*ce,y:(T.clientY-H.top)*X}}function Z0(T){return Math.min(WU,Math.max(HU,T))}function To(){const{drawX:T,drawY:K,drawW:H,drawH:ce,scale:X}=Hr.current,{zoom:ve,panX:Ee,panY:Me}=an.current;return{drawX:T+Ee,drawY:K+Me,drawW:H*ve,drawH:ce*ve,scale:X*ve}}function mm(T=!0){an.current={zoom:1,panX:0,panY:0},ke(1),T&&xt()}function eb(){const T=Ot.current;return T?{x:T.width/2,y:T.height/2}:{x:Oh/2,y:Ih/2}}function tb(T,K,H){const{drawX:ce,drawY:X,scale:ve}=Hr.current,{zoom:Ee,panX:Me,panY:yt}=an.current,Xe=Z0(T),Ie=ve*Ee,Ve=ve*Xe;if(!Ie||!Ve)return;const qe=(K-(ce+Me))/Ie,zt=(H-(X+yt))/Ie,St=K-ce-qe*Ve,Yn=H-X-zt*Ve;an.current={zoom:Xe,panX:St,panY:Yn},ke(Xe),xt()}function Y2(T,K){if(!ft.current)return;const{drawX:H,drawY:ce,drawW:X,drawH:ve,scale:Ee}=To();if(T<H||K<ce||T>H+X||K>ce+ve)return;const Me=Math.floor((T-H)/Ee),yt=Math.floor((K-ce)/Ee),Xe=document.createElement("canvas");Xe.width=ft.current.naturalWidth,Xe.height=ft.current.naturalHeight;const Ie=Xe.getContext("2d");Ie.drawImage(ft.current,0,0);const Ve=Ie.getImageData(Me,yt,1,1),[qe,zt,St]=Ve.data,Yn=`#${[qe,zt,St].map(yr=>yr.toString(16).padStart(2,"0")).join("").toUpperCase()}`;re(Yn)}function Q2(T){}function X2(){if(!ft.current)return;const T=eb();tb(an.current.zoom+__,T.x,T.y)}function J2(){if(!ft.current)return;const T=eb();tb(an.current.zoom-__,T.x,T.y)}function Z2(){ft.current&&mm()}function eP(T,K){const H=Math.min(Oh/T,Ih/K),ce=Math.round(T*H),X=Math.round(K*H),ve=Math.round((Oh-ce)/2),Ee=Math.round((Ih-X)/2);return{x:ve,y:Ee,w:ce,h:X,scale:H}}function tP(){const T=Ot.current;if(!T)return;const K=T.getContext("2d");K.clearRect(0,0,T.width,T.height),K.fillStyle="#f8f9fa",K.fillRect(0,0,T.width,T.height)}function xt(){const T=Ot.current;if(!T)return;const K=T.getContext("2d");tP();const H=ft.current;if(!H)return;const{drawX:ce,drawY:X,drawW:ve,drawH:Ee,scale:Me}=To();if(K.imageSmoothingEnabled=!fn,fn||(K.imageSmoothingQuality="high"),wi&&Qs.current){K.drawImage(Qs.current,ce,X,ve,Ee);return}K.drawImage(H,ce,X,ve,Ee),gt.current.forEach((Ie,Ve)=>{const qe=Ie.points,zt=Co.current===Ve,St=1;K.fillStyle="rgba(128, 128, 128, 0.3)",K.strokeStyle=zt?"#667eea":"#333",K.lineWidth=St,K.setLineDash([8,4]),K.lineCap="butt",K.lineJoin="miter",K.beginPath(),qe.forEach((Yn,yr)=>{const Ro=ce+Yn[0]*Me,ps=X+Yn[1]*Me;yr===0?K.moveTo(Ro,ps):K.lineTo(Ro,ps)}),K.closePath(),K.fill(),K.stroke(),K.setLineDash([]),qe.forEach(Yn=>{const yr=ce+Yn[0]*Me,Ro=X+Yn[1]*Me,ps=4;K.fillStyle=zt?"#667eea":"#333",K.fillRect(yr-ps/2,Ro-ps/2,ps,ps)})});const Xe=ut.current;Xe.length>0&&(K.fillStyle="rgba(128, 128, 128, 0.3)",K.strokeStyle="#667eea",K.lineWidth=1,K.setLineDash([8,4]),K.lineCap="butt",K.lineJoin="miter",K.beginPath(),Xe.forEach((Ve,qe)=>{const zt=ce+Ve[0]*Me,St=X+Ve[1]*Me;qe===0?K.moveTo(zt,St):K.lineTo(zt,St)}),Xe.length===4&&(K.closePath(),K.fill()),K.stroke(),K.setLineDash([]),Xe.forEach(Ve=>{const qe=ce+Ve[0]*Me,zt=X+Ve[1]*Me;K.fillStyle="#667eea",K.fillRect(qe-4/2,zt-4/2,4,4)}))}function fs(){Re([...ut.current])}function Po(){ee(gt.current.length)}function Is(){Co.current=-1,Rs(-1)}function nP(){if(on>=0){const T=gt.current[on];return T?{key:`frame-${on}`,points:T.points,config:T.config}:null}return ut.current.length===4?{key:"current",points:ut.current,config:ae}:null}function sP(){Kn.current.forEach(T=>{T!=null&&T.url&&URL.revokeObjectURL(T.url)}),Kn.current.clear(),Os.current&&URL.revokeObjectURL(Os.current),Os.current="",Qs.current=null}function Kd(){sP(),Oa(!1),Ma({})}function rP(T){Xs&&Ma(K=>{const H={...K};return T?H[Xs]=T:delete H[Xs],H})}function Gd(T){ut.current=[],fs(),Co.current=T,Rs(T);const K=gt.current[T];K!=null&&K.config&&le(mf(K.config,zo)),hs(!0),z(!1);const H=Fa();A(H.length?JSON.stringify(H,null,2):"[]")}function iP(T,K){le(H=>{const ce={...H,[T]:K},X=Co.current;return X>=0&&gt.current[X]&&(gt.current[X].config=ce),ce})}function nb(T,K,H){const{drawX:ce,drawY:X,scale:ve}=To(),Ee=(T-ce)/ve,Me=(K-X)/ve;let yt=!1;for(let Xe=0,Ie=H.length-1;Xe<H.length;Ie=Xe++){const Ve=H[Xe][0],qe=H[Xe][1],zt=H[Ie][0],St=H[Ie][1];qe>Me!=St>Me&&Ee<(zt-Ve)*(Me-qe)/(St-qe)+Ve&&(yt=!yt)}return yt}function sb(T,K){if(ut.current.length===4&&nb(T,K,ut.current))return-1;for(let H=gt.current.length-1;H>=0;H-=1)if(nb(T,K,gt.current[H].points))return H;return null}function rb(T,K){const{drawX:ce,drawY:X,scale:ve}=To();if(ut.current.length>0)for(let Ee=0;Ee<ut.current.length;Ee+=1){const Me=ce+ut.current[Ee][0]*ve,yt=X+ut.current[Ee][1]*ve;if(Math.hypot(T-Me,K-yt)<15)return{frame:-1,point:Ee}}for(let Ee=0;Ee<gt.current.length;Ee+=1){const Me=gt.current[Ee].points;for(let yt=0;yt<Me.length;yt+=1){const Xe=ce+Me[yt][0]*ve,Ie=X+Me[yt][1]*ve;if(Math.hypot(T-Xe,K-Ie)<15)return{frame:Ee,point:yt}}}return null}function jc(){if(!ft.current){Y("Select one or more locations, upload a billboard photo, then click four corners to define the frame.");return}Y("Click and drag to draw a box. Use +/Fit to zoom; Shift+drag or middle mouse pans; pinch to zoom.")}function ib(T){T&&q2(T,{resetFrames:!0}).catch(K=>{E((K==null?void 0:K.message)||"Failed to load image")})}function oP(T){if(a!=="setup"||!ft.current)return;const K=pm(T);if(!K)return;const{x:H,y:ce}=K,X=Kt.current;if(T.pointerType==="touch"){const qe=No.current;if(qe.pointers.set(T.pointerId,{x:H,y:ce}),qe.pointers.size===2){const[zt,St]=Array.from(qe.pointers.values()),Yn=(zt.x+St.x)/2,yr=(zt.y+St.y)/2;qe.isPinching=!0,qe.startDistance=Math.hypot(zt.x-St.x,zt.y-St.y),qe.startZoom=an.current.zoom,qe.startPanX=an.current.panX,qe.startPanY=an.current.panY,qe.startCenterX=Yn,qe.startCenterY=yr,X.isDrawing=!1,X.isDraggingCorner=!1,X.isDraggingFrame=!1,X.isPanning=!1,Ot.current&&(Ot.current.style.cursor="grabbing");return}}if(T.button===1||T.shiftKey){T.preventDefault(),X.isPanning=!0,X.shiftPanPending=T.shiftKey&&T.button===0,X.hasPanned=!1,X.panStartX=H,X.panStartY=ce,X.panOriginX=an.current.panX,X.panOriginY=an.current.panY,Ot.current&&(Ot.current.style.cursor="grabbing");return}X.shiftPanPending=!1,X.hasPanned=!1;const{drawX:Ee,drawY:Me,drawW:yt,drawH:Xe}=To(),Ie=rb(H,ce);if(Ie){Kt.current.isDraggingCorner=!0,Kt.current.dragFrameIndex=Ie.frame,Kt.current.dragPointIndex=Ie.point,Ie.frame>=0?Gd(Ie.frame):(Is(),hs(!0)),xt();return}const Ve=sb(H,ce);if(Ve!==null){Kt.current.isDraggingFrame=!0,Kt.current.dragFrameIndex=Ve,Kt.current.startX=H,Kt.current.startY=ce,Ve>=0?Gd(Ve):(Is(),hs(!0)),Ot.current&&(Ot.current.style.cursor="move"),xt();return}H<Ee||ce<Me||H>Ee+yt||ce>Me+Xe||(Gn.current=!1,Kt.current.isDrawing=!0,Kt.current.startX=H,Kt.current.startY=ce,Is())}function aP(T){if(a!=="setup"||!ft.current)return;const K=pm(T);if(!K)return;const{x:H,y:ce}=K,X=Kt.current;if(T.pointerType==="touch"){const Ie=No.current;if(Ie.pointers.has(T.pointerId)&&Ie.pointers.set(T.pointerId,{x:H,y:ce}),Ie.isPinching&&Ie.pointers.size>=2){const[Ve,qe]=Array.from(Ie.pointers.values()),zt=(Ve.x+qe.x)/2,St=(Ve.y+qe.y)/2,Yn=Math.hypot(Ve.x-qe.x,Ve.y-qe.y),{drawX:yr,drawY:Ro,scale:ps}=Hr.current,gm=Ie.startZoom;if(Ie.startDistance>0&&ps){const Yd=Z0(gm*(Yn/Ie.startDistance)),_P=(Ie.startCenterX-(yr+Ie.startPanX))/(ps*gm),SP=(Ie.startCenterY-(Ro+Ie.startPanY))/(ps*gm),jP=zt-yr-_P*ps*Yd,CP=St-Ro-SP*ps*Yd;an.current={zoom:Yd,panX:jP,panY:CP},ke(Yd),xt()}return}}if(X.isPanning){T.preventDefault();const Ie=H-X.panStartX,Ve=ce-X.panStartY;if(X.shiftPanPending&&!X.hasPanned){if(Math.hypot(Ie,Ve)<VU)return;X.hasPanned=!0}an.current.panX=X.panOriginX+Ie,an.current.panY=X.panOriginY+Ve,xt();return}const{drawX:ve,drawY:Ee,scale:Me}=To();if(X.isDraggingCorner){const Ie=(H-ve)/Me,Ve=(ce-Ee)/Me;X.dragFrameIndex===-1?ut.current[X.dragPointIndex]=[Math.round(Ie),Math.round(Ve)]:gt.current[X.dragFrameIndex].points[X.dragPointIndex]=[Math.round(Ie),Math.round(Ve)],xt();return}if(X.isDraggingFrame){const Ie=(H-X.startX)/Me,Ve=(ce-X.startY)/Me;X.dragFrameIndex===-1?ut.current=ut.current.map(qe=>[Math.round(qe[0]+Ie),Math.round(qe[1]+Ve)]):gt.current[X.dragFrameIndex].points=gt.current[X.dragFrameIndex].points.map(qe=>[Math.round(qe[0]+Ie),Math.round(qe[1]+Ve)]),X.startX=H,X.startY=ce,xt();return}if(X.isDrawing){xt();const Ie=Ot.current.getContext("2d");Ie.fillStyle="rgba(128, 128, 128, 0.3)";const Ve=H-X.startX,qe=ce-X.startY;Ie.fillRect(X.startX,X.startY,Ve,qe),Ie.strokeStyle="#667eea",Ie.lineWidth=1,Ie.setLineDash([8,4]),Ie.lineCap="butt",Ie.lineJoin="miter",Ie.strokeRect(X.startX,X.startY,Ve,qe),Ie.setLineDash([]);return}const yt=rb(H,ce),Xe=sb(H,ce);Ot.current&&(yt?Ot.current.style.cursor="pointer":Xe!==null?Ot.current.style.cursor="move":Ot.current.style.cursor="crosshair")}function lP(T){if(a!=="setup"||!ft.current)return;const K=pm(T),H=Kt.current;if(T.pointerType==="touch"){const St=No.current;if(St.pointers.has(T.pointerId)&&St.pointers.delete(T.pointerId),St.isPinching&&St.pointers.size<2&&(St.isPinching=!1),St.isPinching)return}if(H.isPanning){H.isPanning=!1,Ot.current&&(Ot.current.style.cursor="crosshair"),H.shiftPanPending&&!H.hasPanned&&lt&&K&&Y2(K.x,K.y),H.shiftPanPending=!1,H.hasPanned=!1;return}if(H.isDraggingCorner){H.isDraggingCorner=!1,H.dragFrameIndex=-1,H.dragPointIndex=-1,Ot.current&&(Ot.current.style.cursor="crosshair"),fs(),xt();return}if(H.isDraggingFrame){H.isDraggingFrame=!1,H.dragFrameIndex=-1,Ot.current&&(Ot.current.style.cursor="crosshair"),fs(),xt();return}if(!H.isDrawing||!K)return;const{x:ce,y:X}=K,{drawX:ve,drawY:Ee,scale:Me}=To(),yt=H.startX,Xe=H.startY,Ie=(Math.min(yt,ce)-ve)/Me,Ve=(Math.min(Xe,X)-Ee)/Me,qe=(Math.max(yt,ce)-ve)/Me,zt=(Math.max(Xe,X)-Ee)/Me;ut.current=[[Math.round(Ie),Math.round(Ve)],[Math.round(qe),Math.round(Ve)],[Math.round(qe),Math.round(zt)],[Math.round(Ie),Math.round(zt)]],H.isDrawing=!1,fs(),Is(),hs(!0),Y("Frame drawn. Drag corners to adjust, or drag inside to move. Click Add Frame to save."),xt()}function cP(){le(zo)}function uP(){if(ut.current.length!==4){E("Select 4 corner points first");return}const T={...ae},K=Gn.current?"greenscreen":"manual";gt.current.push({points:[...ut.current],config:T,source:K});const H="current";ut.current=[];const ce=gt.current.length-1;Gd(ce),Gn.current=!1,fs(),Po(),Y(`Frame ${gt.current.length} added. Draw another box or save when done.`);const X=Kn.current.get(H);X&&(Kn.current.set(`frame-${ce}`,X),Kn.current.delete(H));const ve=Vd.current[H];ve&&Ma(Ee=>{const Me={...Ee};return Me[`frame-${ce}`]=ve,delete Me[H],Me}),Oa(!1),Qs.current=null,xt()}function dP(){ut.current=[],Is(),Gn.current=!1,fs(),Kn.current.delete("current"),Ma(T=>{if(!T.current)return T;const K={...T};return delete K.current,K}),Oa(!1),Qs.current=null,gt.current.length?Y(`Frames saved: ${gt.current.length}. Draw another box or save all frames.`):jc(),xt()}function ob(T=!1){!T&&!window.confirm("Clear all frames? This will reset your work.")||(gt.current=[],ut.current=[],Is(),Gn.current=!1,Kd(),fs(),Po(),A("[]"),z(!1),jc(),xt())}function Fa(){const T=[...gt.current];return ut.current.length===4&&T.push({points:[...ut.current],config:{...ae}}),T.map(K=>({points:K.points.map(H=>[H[0],H[1]]),config:K.config}))}function hP(T){if(!T.trim())return[];let K=[];try{K=JSON.parse(T)}catch(H){throw new Error((H==null?void 0:H.message)||"Frames JSON is invalid")}if(!Array.isArray(K))throw new Error("Frames JSON must be an array of frames.");return K.map((H,ce)=>{const X=fm((H==null?void 0:H.points)||(H==null?void 0:H.frame_points)||H);if(!X||X.length!==4)throw new Error(`Frame ${ce+1} must include 4 points.`);const ve=X.map(Me=>{const yt=Number(Me[0]),Xe=Number(Me[1]);if(!Number.isFinite(yt)||!Number.isFinite(Xe))throw new Error(`Frame ${ce+1} has invalid point values.`);return[yt,Xe]});let Ee=H==null?void 0:H.config;if(typeof Ee=="string")try{Ee=JSON.parse(Ee)}catch{Ee=null}return{points:ve,config:mf(Ee,zo),source:"json"}})}function fP(){E("");try{const T=hP(P);gt.current=T,ut.current=[],Gn.current=!1,Kd(),T.length?Gd(0):Is(),fs(),Po(),z(!1),A(T.length?JSON.stringify(Fa(),null,2):"[]"),xt()}catch(T){E((T==null?void 0:T.message)||"Frames JSON is invalid")}}function pP(){!ft.current||V||(ye(!0),setTimeout(()=>{if(!ft.current){ye(!1);return}try{const T=document.createElement("canvas");T.width=ft.current.width,T.height=ft.current.height;const K=T.getContext("2d");K.drawImage(ft.current,0,0);const H=K.getImageData(0,0,ft.current.width,ft.current.height),ce=XU(H,{color:oe,tolerance:_e,depthMultiplier:ae.depthMultiplier,existingFrames:gt.current});ce?(ut.current=ce,Is(),Gn.current=!0,fs(),hs(!0),Y("Green screen detected. Adjust points or click Add Frame to save."),xt()):Y("No green screen detected. Adjust tolerance or draw frame manually.")}finally{ye(!1)}},0))}async function mP(){const T=nP();if(!M||!T||!Xs){E("Upload a photo and select or draw a frame first.");return}const K=Q0;if(!K){E("Upload a test creative for the active frame first.");return}if(!Hd){E(""),Wd(!0);try{const H=new FormData;H.append("billboard_photo",M),H.append("creative",K),H.append("frame_points",JSON.stringify(T.points)),H.append("config",JSON.stringify(T.config)),H.append("time_of_day",x||"day");const ce=await vB(H),X=Kn.current.get(Xs);X!=null&&X.url&&URL.revokeObjectURL(X.url);const ve=URL.createObjectURL(ce),Ee=new Image;Ee.onload=()=>{Kn.current.set(Xs,{url:ve,img:Ee}),Os.current=ve,Qs.current=Ee,xt()},Ee.src=ve}catch(H){E((H==null?void 0:H.message)||"Failed to generate preview")}finally{Wd(!1)}}}function gP(){O(null),ft.current=null,ut.current=[],gt.current=[],Is(),Gn.current=!1,As(!1),Kd(),mm(!1),fs(),Po(),A("[]"),z(!1),Y("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),xt()}function xP(T){T.preventDefault(),De(!0)}function yP(T){T.preventDefault(),De(!1)}function vP(T){var H,ce;T.preventDefault(),De(!1);const K=(ce=(H=T.dataTransfer)==null?void 0:H.files)==null?void 0:ce[0];K&&(O(K),ib(K))}function bP(T){T.preventDefault(),me(!0)}function wP(T){T.preventDefault(),me(!1)}function kP(T){var H,ce;T.preventDefault(),me(!1);const K=(ce=(H=T.dataTransfer)==null?void 0:H.files)==null?void 0:ce[0];K&&setCreativeFile(K)}return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[r&&c.jsx(te,{variant:a==="generate"?"default":"ghost",onClick:()=>l("generate"),className:"rounded-2xl",children:"Generate"}),i&&n&&c.jsx(te,{variant:a==="setup"?"default":"ghost",onClick:()=>l("setup"),className:"rounded-2xl",children:"Setup"}),c.jsx(te,{variant:a==="history"?"default":"ghost",onClick:()=>l("history"),className:"rounded-2xl",children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:a==="generate"?"h-full":"hidden","aria-hidden":a!=="generate",children:c.jsx(PU,{locations:u,setLocations:d,venueType:h,setVenueType:f,templateKey:w,setTemplateKey:k,locationOptions:_c,locationsQuery:Sc,timeOfDay:x,setTimeOfDay:y,timeOfDayDisabled:S,sideDisabled:j,side:g,setSide:m,timeOfDayOptions:GT,sideOptions:YT,venueTypeOptions:QT,templateOptions:de,templatesQuery:$a,templateThumbs:G,getTemplateKey:wr,defaultFrameConfig:zo,creativeDragActive:xe,handleCreativeDragOver:bP,handleCreativeDragLeave:wP,handleCreativeDrop:kP,useNativeSelects:k_})}),a==="setup"?c.jsx("div",{className:"h-full",children:c.jsx(DU,{locations:u,setLocations:d,venueType:h,setVenueType:f,assetType:p,setAssetType:b,setTemplateKey:k,locationOptions:_c,locationsQuery:Sc,assetTypeOptions:qd,assetTypesQuery:wc,timeOfDay:x,setTimeOfDay:y,timeOfDayDisabled:S,sideDisabled:j,side:g,setSide:m,timeOfDayOptions:zU,sideOptions:BU,venueTypeOptions:UU,editingTemplate:B,editingTemplateLoading:pe,stopEditTemplate:J0,templatesOpen:Ur,setTemplatesOpen:ct,templateOptions:Cn,templatesQuery:kc,templateThumbs:G,getTemplateKey:wr,startEditTemplate:G2,deleteTemplate:W2,setupPhoto:M,setSetupPhoto:O,handleSetupPhoto:ib,handleSetupDragOver:xP,handleSetupDragLeave:yP,handleSetupDrop:vP,setupDragActive:be,handleSetupPhotoClear:gP,framesJson:P,setFramesJson:A,setFramesJsonDirty:z,applyFramesJsonToCanvas:fP,buildFramesPayload:Fa,setupImageReady:ds,greenscreenOpen:lt,setGreenscreenOpen:At,greenscreenColor:oe,setGreenscreenColor:re,greenscreenDetecting:V,colorTolerance:_e,setColorTolerance:se,RangeField:Xn,handleGreenscreenDetect:pP,canDetectGreenscreen:z2,hasActiveFrame:B2,frameSettingsOpen:pn,setFrameSettingsOpen:hs,setupFrameConfig:ae,handleSetupFrameConfigChange:iP,FrameConfigControls:YU,previewOpen:cm,setPreviewOpen:um,testPreviewMode:wi,setTestPreviewMode:Oa,testPreviewImgRef:Qs,testPreviewUrlRef:Os,previewImgRef:ft,drawPreview:xt,activeTestCreativeFile:Q0,updateTestCreativeForActive:rP,generateTestPreview:mP,testPreviewing:Hd,activeFrameIndex:on,canvasRef:Ot,canvasWidth:Oh,canvasHeight:Ih,handleCanvasPointerDown:oP,handleCanvasPointerMove:aP,handleCanvasPointerUp:lP,handleCanvasWheel:Q2,setupHint:Le,handleZoomOut:J2,handleZoomIn:X2,handleFitToScreen:Z2,zoomPercent:U2,pixelUpscale:fn,setPixelUpscale:xr,setupError:W,setupMessage:L,addFrame:uP,resetCurrentFrame:dP,saveSetup:H2,setupSaving:D,clearAllFrames:ob,currentPoints:Ne,frameCount:J,useNativeSelects:k_})}):null,c.jsx("div",{className:a==="history"?"h-full":"hidden","aria-hidden":a!=="history",children:c.jsx($U,{enabled:F2})})]})]})})}function YU({config:t,onChange:e}){return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Xn,{label:"Brightness",value:t.brightness,min:50,max:200,suffix:"%",onChange:n=>e("brightness",n)}),c.jsx(Xn,{label:"Contrast",value:t.contrast,min:50,max:200,suffix:"%",onChange:n=>e("contrast",n)}),c.jsx(Xn,{label:"Saturation",value:t.saturation,min:0,max:200,suffix:"%",onChange:n=>e("saturation",n)}),c.jsx(Xn,{label:"Image Blur",value:t.imageBlur,min:0,max:20,onChange:n=>e("imageBlur",n),helper:"Blur entire creative (0 = off)."}),c.jsx(Xn,{label:"Edge Blur",value:t.edgeBlur,min:1,max:20,suffix:"px",onChange:n=>e("edgeBlur",n),helper:"Edge blur amount (1 = off)."}),c.jsx(Xn,{label:"Overlay Opacity",value:t.overlayOpacity,min:0,max:50,suffix:"%",onChange:n=>e("overlayOpacity",n),helper:"Billboard overlay strength."}),c.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(QU,{value:t.lightDirection,onChange:n=>e("lightDirection",n)}),c.jsx(Xn,{label:"Depth Perception",value:t.depthMultiplier,min:5,max:30,suffix:"x",onChange:n=>e("depthMultiplier",n),helper:"Perspective compensation."})]}),c.jsx(Xn,{label:"Shadow Intensity",value:t.shadowIntensity,min:0,max:100,suffix:"%",onChange:n=>e("shadowIntensity",n),helper:"Edge darkening."}),c.jsx(Xn,{label:"Lighting Match",value:t.lightingAdjustment,min:-50,max:50,suffix:"%",onChange:n=>e("lightingAdjustment",n),helper:"Brightness matching."}),c.jsx(Xn,{label:"Color Temperature",value:t.colorTemperature,min:-50,max:50,onChange:n=>e("colorTemperature",n),helper:"Warm/cool shift."}),c.jsx(Xn,{label:"Vignette",value:t.vignette,min:0,max:100,suffix:"%",onChange:n=>e("vignette",n),helper:"Corner darkening."}),c.jsx(Xn,{label:"Edge Smoother",value:t.edgeSmoother,min:1,max:20,suffix:"x",onChange:n=>e("edgeSmoother",n),helper:"Higher = softer edges."}),c.jsx(Xn,{label:"Sharpening",value:t.sharpening,min:0,max:100,suffix:"%",onChange:n=>e("sharpening",n),helper:"Unsharp mask strength (0 = off)."})]})}function QU({value:t,onChange:e}){return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:["Light Direction: ",qU[t]||"Top"]}),c.jsx("div",{className:"grid grid-cols-3 gap-2 w-[150px]",children:XT.map(n=>c.jsx("button",{type:"button",onClick:()=>e(n.value),className:`rounded-lg border px-2 py-2 text-sm font-semibold ${t===n.value?"border-black/40 dark:border-white/50 bg-black/5 dark:bg-white/15 text-black dark:text-white":"border-black/10 dark:border-white/20 bg-white/80 dark:bg-black/40 text-black/70 dark:text-white/80"}`,title:n.label,children:n.glyph},n.value))})]})}function Xn({label:t,value:e,min:n,max:s,step:r=1,suffix:i="",helper:o,onChange:a}){return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:[t,": ",e,i]}),c.jsx("input",{type:"range",min:n,max:s,step:r,value:e,onChange:l=>a(Number(l.target.value)),style:{background:KU(e,n,s)},className:"w-full accent-black"}),o?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:o}):null]})}function wr(t){return`${t.storage_key||""}::${t.photo}::${t.time_of_day||"all"}::${t.side||"all"}`}function XU(t,{color:e,tolerance:n,depthMultiplier:s,existingFrames:r}){const i=t.data,o=t.width,a=t.height,l=parseInt(e.slice(1,3),16),u=parseInt(e.slice(3,5),16),d=parseInt(e.slice(5,7),16),h=n,f=new Uint8Array(o*a);r.forEach(D=>{const $=D.points;for(let L=0;L<a;L+=1)for(let U=0;U<o;U+=1)JU(U,L,$)&&(f[L*o+U]=1)});const p=new Uint8Array(o*a);let b=0;for(let D=0;D<a;D+=1)for(let $=0;$<o;$+=1){const L=D*o+$;if(f[L]===1)continue;const U=L*4,W=i[U],E=i[U+1],P=i[U+2];Math.sqrt((W-l)**2+(E-u)**2+(P-d)**2)<=h&&(p[L]=255,b+=1)}if(b<1e3)return null;const x=new Uint8Array(o*a),y=3;for(let D=0;D<a;D+=1)for(let $=0;$<o;$+=1){const L=D*o+$;let U=!1;for(let W=-y;W<=y;W+=1){for(let E=-y;E<=y;E+=1){const P=D+W,A=$+E;if(P>=0&&P<a&&A>=0&&A<o&&p[P*o+A]===255){U=!0;break}}if(U)break}x[L]=U?255:0}const g=[];for(let D=1;D<a-1;D+=1)for(let $=1;$<o-1;$+=1){const L=D*o+$;x[L]===0&&(x[L-1]===255||x[L+1]===255||x[L-o]===255||x[L+o]===255||x[L-o-1]===255||x[L-o+1]===255||x[L+o-1]===255||x[L+o+1]===255)&&g.push([$,D])}if(g.length<4)return null;let m=g[0],w=g[0],k=g[0],_=g[0];g.forEach(D=>{const[$,L]=D;$+L<m[0]+m[1]&&(m=D),$-L>w[0]-w[1]&&(w=D),$+L>k[0]+k[1]&&(k=D),$-L<_[0]-_[1]&&(_=D)});const C=Math.abs(w[0]-m[0]),S=Math.abs(k[0]-_[0]),j=Math.abs(_[1]-m[1]),N=Math.abs(k[1]-w[1]),R=C/S,M=j/N,O=s||zo.depthMultiplier;if(R>1.1){const D=Math.floor((R-1)*O);_=[_[0],Math.min(a-1,_[1]+D)],k=[k[0],Math.min(a-1,k[1]+D)]}else if(R<.9){const D=Math.floor((1/R-1)*O);m=[m[0],Math.max(0,m[1]-D)],w=[w[0],Math.max(0,w[1]-D)]}if(M>1.1){const D=Math.floor((M-1)*O);w=[Math.min(o-1,w[0]+D),w[1]],k=[Math.min(o-1,k[0]+D),k[1]]}else if(M<.9){const D=Math.floor((1/M-1)*O);m=[Math.max(0,m[0]-D),m[1]],_=[Math.max(0,_[0]-D),_[1]]}return[m,w,k,_]}function JU(t,e,n){let s=!1;for(let r=0,i=n.length-1;r<n.length;i=r++){const o=n[r][0],a=n[r][1],l=n[i][0],u=n[i][1];a>e!=u>e&&t<(l-o)*(e-a)/(u-a)+o&&(s=!s)}return s}function ZU(t){if(!t)return"";const e=String(t).trim();if(!e)return"";if(e.includes("/"))return e;const n=e.split("-");if(n.length===3){const[s,r,i]=n;if(s&&r&&i)return`${i}/${r}/${s}`}return e}function S_(t){const e=Number.parseInt(t,10),n=Number.isFinite(e)&&e>0?e:1;return`${n} ${n===1?"Week":"Weeks"}`}function Mh(t,e){const n=e;if(t==null||t==="")return`${n} 0`;const s=typeof t=="string"?t.trim():t;if(typeof s=="string"&&s.toUpperCase().startsWith(n))return s;const r=typeof s=="number"?s:Number.parseFloat(String(s).replace(/,/g,""));return Number.isFinite(r)?`${n} ${r.toLocaleString()}`:`${n} 0`}function j_(t){if(t==null)return 0;const e=Number.parseFloat(String(t).replace(/[^\d.-]/g,""));return Number.isFinite(e)?e:0}function eH(){const t=gr(),[e,n]=v.useState(""),s=()=>({id:crypto.randomUUID(),startDate:"",duration:"",netRate:""}),r=()=>({id:crypto.randomUUID(),location:"",spots:"1",productionFee:"",periods:[s()]}),[i,o]=v.useState(()=>[r()]),[a,l]=v.useState("separate"),[u,d]=v.useState(""),[h,f]=v.useState("AED"),[p,b]=v.useState("100% upfront"),[x,y]=v.useState([]),[g,m]=v.useState({}),w=Ht({queryKey:["locations","proposals"],queryFn:()=>jB({service:"proposals"})}),k=v.useMemo(()=>{const L=w.data;return Array.isArray(L)?L:(L==null?void 0:L.locations)||(L==null?void 0:L.data)||[]},[w.data]),_=v.useMemo(()=>Array.from(new Set(i.map(L=>L.location).filter(Boolean))),[i]);v.useEffect(()=>{if(!_.length)return;const L=_.filter(W=>!g[W]);if(!L.length)return;let U=!0;return(async()=>{const W=await Promise.all(L.map(async E=>{try{const P=await CB(E);return[E,P]}catch{return[E,null]}}));U&&m(E=>{const P={...E};return W.forEach(([A,F])=>{F&&(P[A]=F)}),P})})(),()=>{U=!1}},[_,g]);const C=KC({mutationFn:L=>NB(L),onSuccess:()=>{t.invalidateQueries({queryKey:["proposals","history"]})}});function S(L,U,W){o(E=>E.map(P=>P.id===L?{...P,[U]:W}:P))}function j(L,U,W,E){o(P=>P.map(A=>A.id!==L?A:{...A,periods:A.periods.map(F=>F.id===U?{...F,[W]:E}:F)}))}function N(){o(L=>[...L,r()])}function R(L){o(U=>U.length>1?U.filter(W=>W.id!==L):U)}function M(L){o(U=>U.map(W=>W.id===L?{...W,periods:[...W.periods,s()]}:W))}function O(L,U){o(W=>W.map(E=>E.id!==L||E.periods.length<=1?E:{...E,periods:E.periods.filter(P=>P.id!==U)}))}function D(){const L=h||"AED",U=Mh(u,L),W=i.filter(z=>z.location),E=W.map(z=>{const G=z.periods.filter(oe=>oe.startDate||oe.duration||oe.netRate),q=a==="combined"?[G[0]||z.periods[0]]:G,B=q.map(oe=>ZU((oe==null?void 0:oe.startDate)||"")),Q=q.map(oe=>S_(oe==null?void 0:oe.duration)),pe=q.map(oe=>Mh(oe==null?void 0:oe.netRate,L)),Z=Number.parseInt(z.spots,10),be=Number.isFinite(Z)&&Z>0?Z:1,De=g[z.location]||{},xe=De.location||De,me=(xe.display_type||xe.displayType||"").toLowerCase()==="static",Le=xe.upload_fee??xe.uploadFee??0,Y=xe.production_fee??xe.productionFee??0,ae=z.productionFee,le={location:z.location||"",upload_fee:Mh(Le,L),spots:be};return me&&(le.production_fee=Mh(ae!==""&&ae!==null&&ae!==void 0?ae:Y,L)),a==="combined"?(le.start_date=B[0]||"",le.duration=Q[0]||S_(1)):(le.start_dates=B,le.durations=Q,le.net_rates=pe),le}),P=W.map(z=>{const G=k.find(q=>(q.location_key||q.key||q.id)===z.location);return(G==null?void 0:G.display_name)||(G==null?void 0:G.name)||(G==null?void 0:G.label)||z.location}).filter(Boolean).join(", "),A={proposals:E,client_name:e,proposal_type:a,payment_terms:p||"100% upfront",currency:L};a==="combined"&&(A.combined_net_rate=U);const F={client:e,packageType:a,items:E.map(z=>({location:z.location,netRatesValue:Array.isArray(z.net_rates)?z.net_rates.map(j_):[]})),combinedNetRateValue:a==="combined"?j_(U):0,locationsLabel:P,currency:L,paymentTerms:p||"100% upfront"};C.mutate(A,{onSuccess:z=>{y(G=>[{data:z,meta:F},...G].slice(0,3))}})}function $(){n(""),o([r()]),l("separate"),d(""),f("AED"),b("100% upfront")}return{client:e,setClient:n,items:i,updateItem:S,addItem:N,removeItem:R,addPeriod:M,removePeriod:O,updatePeriod:j,packageType:a,setPackageType:l,combinedNetRate:u,setCombinedNetRate:d,currency:h,setCurrency:f,paymentTerms:p,setPaymentTerms:b,lastResults:x,locationsQuery:w,locationOptions:k,generateMutation:C,handleGenerate:D,resetForm:$}}function tH(){const t=eH();return c.jsx(nH,{...t})}function nH({client:t,setClient:e,items:n,updateItem:s,addItem:r,removeItem:i,addPeriod:o,removePeriod:a,updatePeriod:l,packageType:u,setPackageType:d,combinedNetRate:h,setCombinedNetRate:f,currency:p,setCurrency:b,paymentTerms:x,setPaymentTerms:y,lastResults:g,locationsQuery:m,locationOptions:w,generateMutation:k,handleGenerate:_,resetForm:C}){var O;const S=Array.isArray(g)?g:[],j=k.isPending,N=v.useMemo(()=>{const D=w.map($=>{const L=$.location_key||$.key||$.id||"",U=$.display_name||$.name||$.label||L||"";return{value:L,label:U}}).filter($=>$.value);return[{value:"",label:"Select a location"},...D]},[w]),R=v.useMemo(()=>[{value:"separate",label:"Separate"},{value:"combined",label:"Combined"}],[]),M=v.useMemo(()=>[{value:"AED",label:"AED"},{value:"EUR",label:"EUR"},{value:"USD",label:"USD"},{value:"GBP",label:"GBP"}],[]);return c.jsxs(vt,{className:"h-full flex flex-col",children:[c.jsx(Lt,{className:"flex flex-row items-center justify-between",children:c.jsx(Wt,{children:"Generate Proposal"})}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Client",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:t,onChange:D=>e(D.target.value),placeholder:"Client name"})}),c.jsx(Ce,{label:"Package Type",children:c.jsx(ot,{value:u,options:R,onChange:d})})]}),u==="combined"?c.jsx(Ce,{label:"Combined Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:h,onChange:D=>f(D.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Locations"}),m.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading locations"})}):null]}),c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:r,children:"Add Location"})]}),c.jsx("div",{className:"space-y-3",children:n.map(D=>{var U,W;const $=w.find(E=>(E.location_key||E.key||E.id)===D.location),L=(($==null?void 0:$.display_type)||"").toLowerCase()==="static";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[u==="combined"?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1.4fr_0.6fr_0.9fr_0.7fr_auto] gap-2 items-end",children:[c.jsx(Ce,{label:"Location",children:c.jsx(ot,{value:D.location,options:N,onChange:E=>s(D.id,"location",E)})}),c.jsx(Ce,{label:"Spots",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:D.spots,onChange:E=>s(D.id,"spots",E.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Ce,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((U=D.periods[0])==null?void 0:U.startDate)||"",onChange:E=>{var P;return l(D.id,(P=D.periods[0])==null?void 0:P.id,"startDate",E.target.value)},type:"date"})}),c.jsx(Ce,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((W=D.periods[0])==null?void 0:W.duration)||"",onChange:E=>{var P;return l(D.id,(P=D.periods[0])==null?void 0:P.id,"duration",E.target.value)},type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(D.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ua,{size:16})})]}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 items-end",children:[c.jsx(Ce,{label:"Location",children:c.jsx(ot,{value:D.location,options:N,onChange:E=>s(D.id,"location",E)})}),c.jsxs("div",{className:"flex items-end justify-between gap-2",children:[c.jsx(Ce,{label:"Spots",className:"flex-1",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:D.spots,onChange:E=>s(D.id,"spots",E.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(D.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ua,{size:16})})]})]}),L?c.jsx(Ce,{label:"Production Fee",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:D.productionFee,onChange:E=>s(D.id,"productionFee",E.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,u!=="combined"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/60",children:"Line Items"}),c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>o(D.id),children:"Add Line Item"})]}),c.jsx("div",{className:"space-y-2",children:D.periods.map(E=>c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_1fr_1fr_auto] gap-2 items-end",children:[c.jsx(Ce,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.startDate,onChange:P=>l(D.id,E.id,"startDate",P.target.value),type:"date"})}),c.jsx(Ce,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.duration,onChange:P=>l(D.id,E.id,"duration",P.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Ce,{label:"Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:E.netRate,onChange:P=>l(D.id,E.id,"netRate",P.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>a(D.id,E.id),disabled:D.periods.length===1,title:"Remove dates",children:c.jsx(ua,{size:16})})]},E.id))})]}):null]},D.id)})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Currency",children:c.jsx(ot,{value:p,options:M,onChange:b})}),c.jsx(Ce,{label:"Payment Terms",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:x,onChange:D=>y(D.target.value),placeholder:"Payment terms"})})]}),k.isError?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:((O=k.error)==null?void 0:O.message)||"Generation failed"}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(te,{className:"rounded-2xl",onClick:_,disabled:j,children:j?c.jsx(Ye,{text:"Generating Proposal"}):"Generate Proposal"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:C,disabled:j,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 space-y-3",children:[!S.length&&!j?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,j?c.jsx(Ye,{text:"Processing proposal",className:"text-sm text-black/60 dark:text-white/65"}):null,S.length?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Proposals"}),c.jsx("div",{className:"space-y-4",children:S.map((D,$)=>{const L=(D==null?void 0:D.data)||null,U=(D==null?void 0:D.meta)||null,W=[];L!=null&&L.pptx_url&&W.push({url:L.pptx_url,type:"pptx"}),L!=null&&L.pdf_url&&W.push({url:L.pdf_url,type:"pdf"});const E=(L==null?void 0:L.locations)||(U==null?void 0:U.locationsLabel)||"",P=(U==null?void 0:U.packageType)==="combined"?U==null?void 0:U.combinedNetRateValue:((U==null?void 0:U.items)||[]).reduce((F,z)=>{const G=Array.isArray(z.netRatesValue)?z.netRatesValue:[];return F+G.reduce((q,B)=>q+(B||0),0)},0),A=Number.isFinite(P)?`${(U==null?void 0:U.currency)||"AED"} ${Number(P).toLocaleString()}`:"";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Client"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(U==null?void 0:U.client)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Package"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(U==null?void 0:U.packageType)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 sm:col-span-2",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Locations"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:E})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Total Amount"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:A})]})]}),W.length?c.jsx("div",{className:"space-y-2",children:W.map(F=>{const z=sH(F.url),G=rH(z),q=F.type==="pdf"?"proposal.pdf":"proposal.pptx",B=G||q,Q=F.type==="pdf";return c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:Q?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Kv,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:"PPTX"})}),c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:B})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:z,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:pe=>{pe.preventDefault(),C_(z,B)},onKeyDown:pe=>{(pe.key==="Enter"||pe.key===" ")&&(pe.preventDefault(),C_(z,B))},className:"inline-flex items-center",children:[c.jsx(va,{size:14,className:"mr-1"}),"Download"]})})]})]})},`${F.type}-${F.url}`)})}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No files returned yet."})]},`proposal-output-${$}`)})})]}):null]})]})]})}function sH(t){return t?t.startsWith("http")?t:`${Ea.API_BASE_URL}${t}`:""}function rH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function C_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function jo({className:t,placeholder:e="Search...",...n}){return c.jsx("input",{type:"text",placeholder:e,className:Te("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",t),...n})}function iH(){const{user:t}=mi(),[e,n]=v.useState({}),[s,r]=v.useState(!1),i=Ht({queryKey:["proposals","history"],queryFn:EB}),o=v.useMemo(()=>{var h;return Array.isArray(i.data)?i.data:(h=i.data)!=null&&h.proposals?i.data.proposals:i.data||[]},[i.data]),a=v.useMemo(()=>Td(t),[t]),l=v.useMemo(()=>{const h=o||[];if(a)return h;const f=(t==null?void 0:t.id)||(t==null?void 0:t.user_id)||(t==null?void 0:t.email)||"";return f?h.filter(p=>(p.submitted_by||p.user_id||"")===f):h},[o,a,t==null?void 0:t.id,t==null?void 0:t.user_id,t==null?void 0:t.email]),u=v.useMemo(()=>{const h=new Set;return(l||[]).forEach(f=>{const p=f.submitted_by||f.user_id;p&&h.add(p)}),Array.from(h)},[l]),d=v.useMemo(()=>u.filter(h=>!e[h]),[u,e]);return v.useEffect(()=>{if(!d.length)return;r(!0);let h=!0;return(async()=>{const f=await Promise.all(d.map(async p=>{var b,x;try{const y=await PB(p),g=(y==null?void 0:y.name)||((b=y==null?void 0:y.user)==null?void 0:b.name)||((x=y==null?void 0:y.profile)==null?void 0:x.name)||p;return[p,g]}catch{return[p,p]}}));h&&(n(p=>{const b={...p};return f.forEach(([x,y])=>{b[x]||(b[x]=y)}),b}),r(!1))})(),()=>{h=!1}},[d]),v.useEffect(()=>{d.length||r(!1)},[d.length]),{historyQuery:i,userNamesLoading:s,visibleProposals:l,userNameById:e}}function oH(){const t=iH();return c.jsx(aH,{...t})}function aH({historyQuery:t,userNamesLoading:e,visibleProposals:n,userNameById:s}){const[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),d=v.useMemo(()=>(n||[]).map((y,g)=>{var R;const m=y.client_name||y.client||"Proposal",w=y.submitted_by||y.user_id||"",k=w?s[w]||w:"",_=y.date_generated||y.created_at,C=y.package_type||"",S=y.locations||((R=y.proposal_data)==null?void 0:R.locations_text)||y.location||"",j=y.total_amount||(y.total_amount_value!=null?`${y.currency||""} ${Number(y.total_amount_value).toLocaleString()}`:""),N=[];return y.pptx_url&&N.push({url:y.pptx_url,type:"pptx"}),y.pdf_url&&N.push({url:y.pdf_url,type:"pdf"}),!N.length&&y.file_url&&N.push({url:y.file_url,type:"pdf"}),{id:y.id||y.file_url||g,clientName:m,userName:k,generatedAt:_,packageType:C,locationText:S,totalAmount:j,fileEntries:N}}),[n,s]),h=v.useMemo(()=>{const y=new Set;return d.forEach(g=>{g.packageType&&g.packageType!==""&&y.add(g.packageType)}),Array.from(y)},[d]),f=v.useMemo(()=>{const y=new Set;return d.forEach(g=>{!g.locationText||g.locationText===""||g.locationText.split(",").forEach(m=>{const w=m.trim();w&&y.add(w)})}),Array.from(y)},[d]),p=v.useMemo(()=>[{value:"",label:"All packages"},...h.map(y=>({value:y,label:y}))],[h]),b=v.useMemo(()=>[{value:"",label:"All locations"},...f.map(y=>({value:y,label:y}))],[f]),x=v.useMemo(()=>{const y=l.trim().toLowerCase();return d.filter(g=>!(r&&g.packageType!==r||o&&!(g.locationText||"").split(",").map(w=>w.trim()).filter(Boolean).includes(o)||y&&!`${g.clientName} ${g.locationText}`.toLowerCase().includes(y)))},[d,r,o,l]);return c.jsxs(vt,{className:"h-full flex flex-col",children:[c.jsx(Lt,{className:"space-y-2",children:c.jsx(Wt,{children:"History"})}),c.jsx($t,{className:"flex-1 min-h-0 flex flex-col",children:t.isLoading||e?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):n!=null&&n.length?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(jo,{value:l,onChange:y=>u(y.target.value),className:"w-full sm:w-[260px]",placeholder:"Search..."}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(ot,{value:r,options:p,onChange:i,className:"sm:w-[200px]"}),c.jsx(ot,{value:o,options:b,onChange:a,className:"sm:w-[220px]"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full min-w-0 overflow-hidden",children:c.jsx("div",{className:"h-full w-full min-w-0 overflow-auto",children:c.jsxs("table",{className:"min-w-[760px] w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Client"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Locations"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Amount"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"User"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Generated"}),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:(x||[]).map(y=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[c.jsx("td",{className:"px-4 py-3 font-semibold",children:y.clientName}),c.jsx("td",{className:"px-4 py-3",children:y.locationText}),c.jsx("td",{className:"px-4 py-3",children:y.totalAmount}),c.jsx("td",{className:"px-4 py-3",children:y.userName}),c.jsx("td",{className:"px-4 py-3",children:y.generatedAt?new Date(y.generatedAt).toLocaleString():""}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:y.fileEntries.length?c.jsx("div",{className:"flex flex-col gap-2",children:y.fileEntries.map(g=>{const m=lH(g.url),w=cH(m),k=g.type==="pdf"?"proposal.pdf":"proposal.pptx",_=w||k;return c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wide text-black/50 dark:text-white/60",children:g.type}),c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:C=>{C.preventDefault(),N_(m,_)},onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),N_(m,_))},className:"inline-flex items-center",children:[c.jsx(va,{size:14,className:"mr-1"}),"Download"]})})]},`${g.type}-${g.url}`)})}):c.jsx("span",{className:"text-xs text-black/50 dark:text-white/55",children:""})})]},y.id))})]})})}),x.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No matching proposals."})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No proposals yet."})})]})}function lH(t){return t?t.startsWith("http")?t:`${Ea.API_BASE_URL}${t}`:""}function cH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function N_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function uH(){const[t,e]=v.useState("generate");return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(te,{variant:t==="generate"?"default":"ghost",onClick:()=>e("generate"),className:"rounded-2xl",children:"Generate"}),c.jsx(te,{variant:t==="history"?"default":"ghost",onClick:()=>e("history"),className:"rounded-2xl",children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="generate"?"h-full":"hidden","aria-hidden":t!=="generate",children:c.jsx(tH,{})}),c.jsx("div",{className:t==="history"?"h-full":"hidden","aria-hidden":t!=="history",children:c.jsx(oH,{})})]})]})})}function JT(t){return t?typeof t=="string"?t:t.name||t.id||t.value||"":""}function ZT(t){return t?typeof t=="string"?t:t.name||t.value||t.permission||"":""}function jg(t,e){if(!t||!e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function dH(t){const e=new Map;return(t||[]).forEach(n=>{const s=JT(n);if(!s)return;const r=(n.permissions||n.permission_list||n.permissionList||[]).map(ZT).filter(Boolean);e.set(s,new Set(r))}),e}function hH(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permission_sets||n.permissionSets||n.permission_set_names||[]).map(JT).filter(Boolean);e.set(s,new Set(r))}),e}function fH(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permissions||[]).map(ZT).filter(Boolean);e.set(s,new Set(r))}),e}function pH({q:t,setQ:e,openNewUserModal:n,usersQuery:s,users:r,user:i,selectUser:o,setConfirmDelete:a,companyLookup:l,userCompanyFilter:u,setUserCompanyFilter:d,userProfileFilter:h,setUserProfileFilter:f,companyFilterOptions:p,profileFilterOptions:b}){const x=v.useMemo(()=>[{value:"",label:"All companies"},...p.map(m=>({...m}))],[p]),y=v.useMemo(()=>[{value:"",label:"All profiles"},...b.map(m=>({...m}))],[b]),g=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Wt,{children:"Users"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:m=>e(m.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:n,children:"Add user"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(ot,{value:u,options:x,onChange:d}),c.jsx(ot,{value:h,options:y,onChange:f})]})]});return c.jsxs(vt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Lt,{className:"hidden md:block space-y-2",children:g}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:g}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(m=>{var R,M,O,D;const w=Array.isArray(m.profiles)?m.profiles.map($=>($==null?void 0:$.display_name)||($==null?void 0:$.name)||$).filter(Boolean):[((R=m.profiles)==null?void 0:R.display_name)||((M=m.profiles)==null?void 0:M.name)||m.profile||m.profile_name].filter(Boolean),k=w.length?w.length>2?`${w[0]}, +${w.length-1}`:w.join(", "):"",_=!!(m.id&&(i!=null&&i.id)&&m.id===i.id||m.user_id&&(i!=null&&i.user_id)&&m.user_id===i.user_id||m.email&&(i!=null&&i.email)&&m.email===i.email),C=m.is_active??m.isActive??m.active,S=typeof C=="boolean",j=S?C:!0,N=j?"Deactivate":"Reactivate";return c.jsxs(Ft,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("div",{className:"text-base font-semibold",children:m.name||""}),S&&!j?c.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-semibold text-red-700 dark:bg-red-500/20 dark:text-red-200",children:"Inactive"}):null]}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:m.email})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(On,{onClick:()=>o(m),title:"Edit user","aria-label":"Edit user",children:c.jsx(Cd,{size:16})}),c.jsx(On,{variant:"ghost",onClick:()=>a({open:!0,type:"user",payload:{id:m.id||m.user_id,isActive:j},label:`${N} user "${m.email}"?`}),disabled:_,title:_?"You cannot deactivate yourself":`${N} user`,"aria-label":`${N} user`,className:j?void 0:"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300",children:j?c.jsx(eM,{size:16}):c.jsx(ZI,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Profiles: ",c.jsx("span",{className:"font-semibold",children:k})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Company:"," ",c.jsx("span",{className:"font-semibold",children:((O=m.company)==null?void 0:O.name)||l.get(((D=m.company)==null?void 0:D.code)||m.company_code||m.company_id)||""})]})]},m.id||m.user_id||m.email)})})})]})]})}function mH({q:t,setQ:e,usersQuery:n,users:s,user:r,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h,companyList:f,profileOptions:p,profileValues:b,permissionSetList:x,permissionSetValues:y,permissionList:g,permissionsQuery:m,page:w}){const{selectedUser:k,setSelectedUser:_,userForm:C,setUserForm:S,userModalOpen:j,setUserModalOpen:N,userModalLoading:R,setUserModalLoading:M,userModalMode:O,setUserModalMode:D,userProfilesOpen:$,setUserProfilesOpen:L,userPermissionSetsOpen:U,setUserPermissionSetsOpen:W,userPermissionsOpen:E,setUserPermissionsOpen:P,savingUser:A,setPermissionsMessage:F,selectUser:z,openNewUserModal:G,saveUser:q,deleteUser:B,selectedUserProfiles:Q,selectedUserPermissionSets:pe,selectedUserPermissions:Z,selectedUserPermissionSet:be,customUserPermissions:De,toggleUserPermission:xe,selectAllUserPermissions:me,clearUserPermissions:Le,toggleUserProfile:Y,selectAllUserProfiles:ae,clearUserProfiles:le,toggleUserPermissionSet:oe,selectAllUserPermissionSets:re,clearUserPermissionSets:_e}=gH({permissionList:g,profileValues:b,permissionSetValues:y,profileOptions:p,permissionSetList:x}),[se,V]=v.useState({open:!1,type:"",payload:null,label:""}),ye=!!(k&&(k.id&&(r!=null&&r.id)&&k.id===(r==null?void 0:r.id)||k.user_id&&(r!=null&&r.user_id)&&k.user_id===(r==null?void 0:r.user_id)||k.email&&(r!=null&&r.email)&&k.email===(r==null?void 0:r.email)));v.useEffect(()=>{_(null)},[w,_]);async function Ne(){if(!(!se.open||!se.payload))try{const Re=se.payload,J=(Re==null?void 0:Re.id)??Re;if(!J||r!=null&&r.id&&J===r.id||r!=null&&r.user_id&&J===r.user_id)return;await B(Re)}finally{V({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(pH,{q:t,setQ:e,openNewUserModal:G,usersQuery:n,users:s,user:r,selectUser:z,setConfirmDelete:V,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h}),c.jsx(xH,{open:j,onClose:()=>{N(!1),_(null),F(""),M(!1),D("edit"),L(!1),W(!1),P(!1)},userModalLoading:R,userModalMode:O,selectedUser:k,userForm:C,setUserForm:S,companyList:f,profileOptions:p,profileValues:b,userProfilesOpen:$,setUserProfilesOpen:L,selectAllUserProfiles:ae,clearUserProfiles:le,selectedUserProfiles:Q,toggleUserProfile:Y,permissionSetList:x,permissionSetValues:y,userPermissionSetsOpen:U,setUserPermissionSetsOpen:W,selectAllUserPermissionSets:re,clearUserPermissionSets:_e,selectedUserPermissionSets:pe,toggleUserPermissionSet:oe,userPermissionsOpen:E,setUserPermissionsOpen:P,selectedUserPermissions:Z,permissionList:g,permissionsQuery:m,selectedUserPermissionSet:be,toggleUserPermission:xe,selectAllUserPermissions:me,clearUserPermissions:Le,customUserPermissions:De,isSelfUser:ye,setConfirmDelete:V,saveUser:q,savingUser:A}),c.jsx(fc,{open:se.open,message:se.label,onClose:()=>V({open:!1,type:"",payload:null,label:""}),onConfirm:Ne})]})}function gH({permissionList:t,profileValues:e,permissionSetValues:n,profileOptions:s,permissionSetList:r}){const i=gr(),[o,a]=v.useState(null),[l,u]=v.useState({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[b,x]=v.useState("edit"),[y,g]=v.useState(!1),[m,w]=v.useState(!1),[k,_]=v.useState(!1),[C,S]=v.useState(!1),[j,N]=v.useState(""),R=v.useMemo(()=>new Set(l.profiles||[]),[l.profiles]),M=v.useMemo(()=>new Set(l.permissionSets||[]),[l.permissionSets]),O=v.useMemo(()=>kn(l.permissionsText),[l.permissionsText]),D=v.useMemo(()=>new Set(O),[O]),$=v.useMemo(()=>{if(!t.length)return O;const Y=new Set(t);return O.filter(ae=>!Y.has(ae))},[t,O]),L=v.useMemo(()=>dH(r),[r]),U=v.useMemo(()=>hH(s),[s]),W=v.useMemo(()=>fH(s),[s]);function E(Y,ae,le){return(Y||[]).filter(oe=>{const re=ae.get(oe);return re?jg(re,le):!0})}function P(Y,ae,le){const oe=new Set(le||[]);return(Y||[]).filter(re=>{const _e=W.get(re),se=U.get(re);if(!_e&&!se)return!0;if(se&&!jg(se,oe))return!1;const V=new Set;return _e&&_e.forEach(ye=>V.add(ye)),se&&se.forEach(ye=>{const Ne=L.get(ye);Ne&&Ne.forEach(Re=>V.add(Re))}),jg(V,ae)})}function A(Y,ae){const le=new Set(Y.profiles||[]),oe=new Set(Y.permissionSets||[]),re=new Set(kn(Y.permissionsText));return le.forEach(_e=>{const se=U.get(_e);se&&se.forEach(ye=>oe.add(ye));const V=W.get(_e);V&&V.forEach(ye=>re.add(ye)),se&&se.forEach(ye=>{const Ne=L.get(ye);Ne&&Ne.forEach(Re=>re.add(Re))})}),{...Y,permissionSets:Array.from(oe),permissionsText:Array.from(re).join(`
`)}}async function F(Y){var re,_e;a(Y),N(""),x("edit"),h(!0),p(!0),g(!1),w(!1),_(!1);const ae=Array.isArray(Y.profiles)?Y.profiles.map(se=>(se==null?void 0:se.name)||(se==null?void 0:se.id)||se).filter(Boolean):[((re=Y.profiles)==null?void 0:re.name)||Y.profile||Y.profile_name].filter(Boolean),le=(Y.permission_sets||Y.permissionSets||Y.permission_set_names||[]).map(se=>typeof se=="string"?se:(se==null?void 0:se.name)||(se==null?void 0:se.id)).filter(Boolean);u({name:Y.name||"",email:Y.email||"",profiles:ae,permissionSets:le,company:((_e=Y.company)==null?void 0:_e.code)||Y.company_code||Y.company_id||"",is_active:Y.is_active!==!1,permissionsText:""});const oe=Y.id||Y.user_id;if(oe)try{const se=await RB(oe),V=(se==null?void 0:se.permissions)??se,ye=Array.isArray(V)?V.map(Ne=>typeof Ne=="string"?Ne:Ne==null?void 0:Ne.name).filter(Boolean):[];u(Ne=>A({...Ne,permissionsText:ye.join(`
`)}))}catch{}p(!1)}function z(){a(null),N(""),x("add"),p(!1),g(!1),w(!1),_(!1),u({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),h(!0)}async function G(){var re,_e;if(b==="edit"&&!o)return;S(!0),N("");const Y=(o==null?void 0:o.id)||(o==null?void 0:o.user_id);if(b==="edit"&&!Y){S(!1),N("Missing user id");return}const ae=kn(l.permissionsText),le=l.profiles||[],oe={name:l.name,is_active:!!l.is_active,profile_names:le,profile_name:le[0]||null,permission_sets:l.permissionSets||[],company_code:l.company||null,...b==="add"?{email:l.email}:{}};try{if(b==="add"){const se=await AB(oe),V=(se==null?void 0:se.id)||(se==null?void 0:se.user_id)||((re=se==null?void 0:se.user)==null?void 0:re.id)||((_e=se==null?void 0:se.user)==null?void 0:_e.user_id);V!=null&&await qk(V,ae),N("User created")}else await OB(Y,oe),await qk(Y,ae),N("User updated");i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch(se){N((se==null?void 0:se.message)||"Failed to save user")}finally{S(!1)}}async function q(Y){const ae=(Y==null?void 0:Y.id)??Y;if(ae)try{const le=(Y==null?void 0:Y.isActive)??(Y==null?void 0:Y.is_active);(typeof le=="boolean"?le:!0)?await IB(ae):await MB(ae),i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch{}}function B(Y){u(ae=>{const le=new Set(kn(ae.permissionsText)),oe=le.has(Y);oe?le.delete(Y):le.add(Y);let re=ae.permissionSets||[],_e=ae.profiles||[];return oe&&(re=E(re,L,le),_e=P(_e,le,re)),{...ae,permissionsText:Array.from(le).join(`
`),permissionSets:re,profiles:_e}})}function Q(){const Y=new Set([...O,...t]);u(ae=>({...ae,permissionsText:Array.from(Y).join(`
`)}))}function pe(){u(Y=>({...Y,permissionsText:"",permissionSets:[],profiles:[]}))}function Z(Y){u(ae=>{const le=new Set(ae.profiles||[]),oe=new Set(ae.permissionSets||[]),re=new Set(kn(ae.permissionsText));if(le.has(Y)){le.delete(Y);const ye=E(Array.from(oe),L,re),Ne=P(Array.from(le),re,ye);return{...ae,profiles:Ne,permissionSets:ye,permissionsText:Array.from(re).join(`
`)}}le.add(Y);const se=U.get(Y);se&&se.forEach(ye=>oe.add(ye));const V=W.get(Y);return V&&V.forEach(ye=>re.add(ye)),se&&se.forEach(ye=>{const Ne=L.get(ye);Ne&&Ne.forEach(Re=>re.add(Re))}),{...ae,profiles:Array.from(le),permissionSets:Array.from(oe),permissionsText:Array.from(re).join(`
`)}})}function be(){u(Y=>{const ae=new Set([...Y.profiles||[],...e]),le=new Set(Y.permissionSets||[]),oe=new Set(kn(Y.permissionsText));return ae.forEach(re=>{const _e=U.get(re);_e&&_e.forEach(V=>le.add(V));const se=W.get(re);se&&se.forEach(V=>oe.add(V)),_e&&_e.forEach(V=>{const ye=L.get(V);ye&&ye.forEach(Ne=>oe.add(Ne))})}),{...Y,profiles:Array.from(ae),permissionSets:Array.from(le),permissionsText:Array.from(oe).join(`
`)}})}function De(){u(Y=>({...Y,profiles:[]}))}function xe(Y){u(ae=>{const le=new Set(ae.permissionSets||[]),oe=new Set(kn(ae.permissionsText));if(le.has(Y)){le.delete(Y);const se=P(ae.profiles||[],oe,Array.from(le));return{...ae,permissionSets:Array.from(le),profiles:se,permissionsText:Array.from(oe).join(`
`)}}le.add(Y);const _e=L.get(Y);return _e&&_e.forEach(se=>oe.add(se)),{...ae,permissionSets:Array.from(le),permissionsText:Array.from(oe).join(`
`)}})}function me(){u(Y=>{const ae=new Set([...Y.permissionSets||[],...n]),le=new Set(kn(Y.permissionsText));return ae.forEach(oe=>{const re=L.get(oe);re&&re.forEach(_e=>le.add(_e))}),{...Y,permissionSets:Array.from(ae),permissionsText:Array.from(le).join(`
`)}})}function Le(){u(Y=>{const ae=new Set(kn(Y.permissionsText)),le=P(Y.profiles||[],ae,[]);return{...Y,permissionSets:[],profiles:le,permissionsText:Array.from(ae).join(`
`)}})}return{selectedUser:o,setSelectedUser:a,userForm:l,setUserForm:u,userModalOpen:d,setUserModalOpen:h,userModalLoading:f,setUserModalLoading:p,userModalMode:b,setUserModalMode:x,userProfilesOpen:y,setUserProfilesOpen:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:w,userPermissionsOpen:k,setUserPermissionsOpen:_,savingUser:C,permissionsMessage:j,setPermissionsMessage:N,selectUser:F,openNewUserModal:z,saveUser:G,selectedUserProfiles:R,selectedUserPermissionSets:M,selectedUserPermissions:O,selectedUserPermissionSet:D,customUserPermissions:$,toggleUserPermission:B,selectAllUserPermissions:Q,clearUserPermissions:pe,toggleUserProfile:Z,selectAllUserProfiles:be,clearUserProfiles:De,toggleUserPermissionSet:xe,selectAllUserPermissionSets:me,clearUserPermissionSets:Le,deleteUser:q}}function xH({open:t,onClose:e,userModalLoading:n,userModalMode:s,selectedUser:r,userForm:i,setUserForm:o,companyList:a,profileOptions:l,profileValues:u,userProfilesOpen:d,setUserProfilesOpen:h,selectAllUserProfiles:f,clearUserProfiles:p,selectedUserProfiles:b,toggleUserProfile:x,permissionSetList:y,permissionSetValues:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:w,selectAllUserPermissionSets:k,clearUserPermissionSets:_,selectedUserPermissionSets:C,toggleUserPermissionSet:S,userPermissionsOpen:j,setUserPermissionsOpen:N,selectedUserPermissions:R,permissionList:M,permissionsQuery:O,selectedUserPermissionSet:D,toggleUserPermission:$,selectAllUserPermissions:L,clearUserPermissions:U,customUserPermissions:W,isSelfUser:E,setConfirmDelete:P,saveUser:A,savingUser:F}){const z=v.useMemo(()=>{const q=a.map(B=>{const Q=B.code||B.id||"";return{value:Q,label:B.name||B.code||Q||""}}).filter(B=>B.value);return[{value:"",label:"Select company"},...q]},[a]),G=v.useMemo(()=>[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],[]);return c.jsx(Cs,{open:t,onClose:e,title:s==="add"?"Add user":"Edit user",maxWidth:"560px",children:n?c.jsx(Ye,{text:"Loading user",className:"text-sm text-black/60 dark:text-white/65"}):s==="add"||r?c.jsxs("div",{className:"space-y-3",children:[s==="edit"?c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/55",children:["Editing ",r==null?void 0:r.email]}):null,c.jsx(Ce,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.name,onChange:q=>o(B=>({...B,name:q.target.value}))})}),c.jsx(Ce,{label:"Email",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.email,onChange:q=>o(B=>({...B,email:q.target.value})),type:"email",disabled:s==="edit"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Company",children:c.jsx(ot,{value:i.company||"",options:z,onChange:q=>o(B=>({...B,company:q}))})}),c.jsx(Ce,{label:"Status",children:c.jsx(ot,{value:i.is_active?"active":"inactive",options:G,onChange:q=>o(B=>({...B,is_active:q==="active"}))})})]}),c.jsx(Ce,{label:"Profiles",children:c.jsxs(Ft,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>h(q=>!q),"aria-expanded":d,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Profiles"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:jl(i.profiles.length,"profile")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:d?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",d&&"rotate-180")})]})]}),d?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!u.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!i.profiles.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[l.map(q=>{const B=q.name||q.id;if(!B)return null;const Q=b.has(B);return c.jsxs("button",{type:"button",onClick:()=>x(B),className:Te("mmg-profile-option flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",Q?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:q.display_name||q.name||B}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",Q?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ca,{size:14,className:Q?"opacity-100":"opacity-0"})})]},B)}),l.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No profiles available."})]})]}):null]})}),c.jsx(Ce,{label:"Permission Sets",children:c.jsxs(Ft,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>w(q=>!q),"aria-expanded":m,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:jl(i.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:m?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",m&&"rotate-180")})]})]}),m?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:k,disabled:!g.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:_,disabled:!i.permissionSets.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[y.map(q=>{const B=q.name||q.id;if(!B)return null;const Q=C.has(B);return c.jsxs("button",{type:"button",onClick:()=>S(B),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",Q?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:q.display_name||q.name||B}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",Q?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ca,{size:14,className:Q?"opacity-100":"opacity-0"})})]},B)}),y.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]})]}):null]})}),c.jsx(Ce,{label:"Permissions",children:c.jsxs(Ft,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>N(q=>!q),"aria-expanded":j,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:jl(R.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:j?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",j&&"rotate-180")})]})]}),j?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:L,disabled:!M.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:U,disabled:!R.length,children:"Clear"})]})}),O.isLoading?c.jsx(Ye,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):M.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:M.map(q=>{const B=D.has(q);return c.jsxs("button",{type:"button",onClick:()=>$(q),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",B?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:q}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",B?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ca,{size:14,className:B?"opacity-100":"opacity-0"})})]},q)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),W.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:W.map(q=>c.jsxs("button",{type:"button",onClick:()=>$(q),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:q}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},q))})]}):null]}):null]})}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[s==="edit"?c.jsx(te,{variant:"ghost",className:Te("rounded-2xl",typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"&&!((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))?"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300":"text-red-600 hover:text-red-700 dark:text-red-300"),onClick:()=>P({open:!0,type:"user",payload:{id:(r==null?void 0:r.id)||(r==null?void 0:r.user_id),isActive:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active):!0},label:`${typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"} user "${r==null?void 0:r.email}"?`}),disabled:E,children:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:A,disabled:F,children:F?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Select a user to edit."})})}function yH({companySearch:t,setCompanySearch:e,openCompanyModal:n,companiesQuery:s,filteredCompanyList:r,companyLookup:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Wt,{children:"Companies"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add company"})]})]});return c.jsxs(vt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Lt,{className:"hidden md:block space-y-2",children:a}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(Ft,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.name||l.code}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.code||""})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(On,{onClick:()=>n(l),title:"Edit company","aria-label":"Edit company",children:c.jsx(Cd,{size:16})}),c.jsx(On,{variant:"ghost",onClick:()=>o({open:!0,type:"company",payload:l.code||l.id,label:`Delete company "${l.name||l.code}"?`}),title:"Delete company","aria-label":"Delete company",children:c.jsx(ua,{size:16})})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[l.country?c.jsx("span",{children:l.country}):null,l.currency?c.jsxs("span",{children:[" ",l.currency]}):null,l.timezone?c.jsxs("span",{children:[" ",l.timezone]}):null]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[c.jsxs("span",{children:["Parent: ",i.get(l.parent_id)||""]}),c.jsxs("span",{children:[" ",l.isgroup?"Group":"Company"]}),c.jsxs("span",{children:[" ",l.is_active===!1?"Inactive":"Active"]})]})]},l.code||l.id)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching companies.":"No companies available."})]})})]})]})}function vH({companySearch:t,setCompanySearch:e,companiesQuery:n,filteredCompanyList:s,companyLookup:r,companyList:i}){const{companyForm:o,setCompanyForm:a,editingCompany:l,setEditingCompany:u,companyModalOpen:d,setCompanyModalOpen:h,savingCompany:f,openCompanyModal:p,saveCompany:b,deleteCompany:x}=bH(),[y,g]=v.useState({open:!1,type:"",payload:null,label:""});async function m(){if(!(!y.open||!y.payload))try{await x(y.payload)}finally{g({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(yH,{companySearch:t,setCompanySearch:e,openCompanyModal:p,companiesQuery:n,filteredCompanyList:s,companyLookup:r,setConfirmDelete:g}),c.jsx(wH,{open:d,onClose:()=>{h(!1),u(null),a({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})},editingCompany:l,companyForm:o,setCompanyForm:a,companyList:i,setConfirmDelete:g,saveCompany:b,savingCompany:f}),c.jsx(fc,{open:y.open,message:y.label,onClose:()=>g({open:!1,type:"",payload:null,label:""}),onConfirm:m})]})}function bH(){const t=gr(),[e,n]=v.useState({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0}),[s,r]=v.useState(null),[i,o]=v.useState(!1),[a,l]=v.useState(!1);function u(f){f?(r(f.code||f.id),n({code:f.code||"",name:f.name||"",parent_id:f.parent_id??"",country:f.country??"",currency:f.currency??"",timezone:f.timezone??"",isgroup:!!f.isgroup,is_active:f.is_active!==!1})):(r(null),n({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})),o(!0)}async function d(){if(!e.code.trim()||!e.name.trim())return;l(!0);const f={code:e.code.trim(),name:e.name.trim(),parent_id:e.parent_id||null,country:e.country||null,currency:e.currency||null,timezone:e.timezone||null,isgroup:!!e.isgroup,is_active:!!e.is_active};try{s?await HB(s,f):await UB(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}finally{l(!1)}}async function h(f){if(f)try{await WB(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}}return{companyForm:e,setCompanyForm:n,editingCompany:s,setEditingCompany:r,companyModalOpen:i,setCompanyModalOpen:o,savingCompany:a,openCompanyModal:u,saveCompany:d,deleteCompany:h}}function wH({open:t,onClose:e,editingCompany:n,companyForm:s,setCompanyForm:r,companyList:i,setConfirmDelete:o,saveCompany:a,savingCompany:l}){const u=[{value:"",label:"None"},...i.filter(f=>(f.code||f.id)!==s.code).map(f=>{const p=f.code||f.id||"";return{value:p,label:f.name||f.code||p||""}}).filter(f=>f.value)],d=[{value:"company",label:"Company"},{value:"group",label:"Group"}],h=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return c.jsx(Cs,{open:t,onClose:e,title:n?`Edit company: ${s.name||s.code}`:"Add company",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Code",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.code,onChange:f=>r(p=>({...p,code:f.target.value})),placeholder:"MMG-001",disabled:!!n})}),c.jsx(Ce,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:f=>r(p=>({...p,name:f.target.value})),placeholder:"MMG Global"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Parent company",children:c.jsx(ot,{value:s.parent_id||"",options:u,onChange:f=>r(p=>({...p,parent_id:f}))})}),c.jsx(Ce,{label:"Country",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.country,onChange:f=>r(p=>({...p,country:f.target.value})),placeholder:"US"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Currency",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.currency,onChange:f=>r(p=>({...p,currency:f.target.value})),placeholder:"USD"})}),c.jsx(Ce,{label:"Timezone",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.timezone,onChange:f=>r(p=>({...p,timezone:f.target.value})),placeholder:"America/New_York"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Type",children:c.jsx(ot,{value:s.isgroup?"group":"company",options:d,onChange:f=>r(p=>({...p,isgroup:f==="group"}))})}),c.jsx(Ce,{label:"Status",children:c.jsx(ot,{value:s.is_active?"active":"inactive",options:h,onChange:f=>r(p=>({...p,is_active:f==="active"}))})})]}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(te,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>o({open:!0,type:"company",payload:n,label:`Delete company "${s.name||s.code}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:a,disabled:l,children:l?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]})})}function kH({profileSearch:t,setProfileSearch:e,openProfileModal:n,filteredProfileOptions:s,duplicateProfile:r,setConfirmDelete:i}){const o=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Wt,{children:"Profiles"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:a=>e(a.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add profile"})]})]});return c.jsxs(vt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Lt,{className:"hidden md:block space-y-2",children:o}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:o}),c.jsxs("div",{className:"space-y-4 p-5 pt-1",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.map(a=>c.jsxs(Ft,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:a.display_name||a.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:a.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(On,{onClick:()=>r(a),title:"Duplicate profile","aria-label":"Duplicate profile",children:c.jsx(YC,{size:16})}),a.is_system?c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:"System"}):c.jsxs(c.Fragment,{children:[c.jsx(On,{onClick:()=>n(a),title:"Edit profile","aria-label":"Edit profile",children:c.jsx(Cd,{size:16})}),c.jsx(On,{variant:"ghost",onClick:()=>i({open:!0,type:"profile",payload:a.id||a.name,label:`Delete profile "${a.display_name||a.name}"?`}),title:"Delete profile","aria-label":"Delete profile",children:c.jsx(ua,{size:16})})]})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(a.permissions||[]).length," permission",(a.permissions||[]).length===1?"":"s"]}),a.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:a.description}):null]},a.id||a.name))}),s.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching profiles.":"No profiles available."})]})]})]})}function _H({profileSearch:t,setProfileSearch:e,filteredProfileOptions:n,permissionList:s,permissionSetValues:r,permissionSetList:i,permissionSetsQuery:o,permissionsQuery:a}){const{profileForm:l,setProfileForm:u,editingProfile:d,setEditingProfile:h,profileModalOpen:f,setProfileModalOpen:p,profileIsSystem:b,setProfileIsSystem:x,profilePermissionSetsOpen:y,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:w,savingProfile:k,openProfileModal:_,duplicateProfile:C,saveProfile:S,deleteProfile:j,selectedProfilePermissions:N,selectedProfilePermissionSet:R,selectedProfilePermissionSets:M,customProfilePermissions:O,toggleProfilePermission:D,selectAllProfilePermissions:$,clearProfilePermissions:L,toggleProfilePermissionSet:U,selectAllProfilePermissionSets:W,clearProfilePermissionSets:E}=SH({permissionList:s,permissionSetValues:r,permissionSetList:i}),[P,A]=v.useState({open:!1,type:"",payload:null,label:""});async function F(){if(!(!P.open||!P.payload))try{await j(P.payload)}finally{A({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(kH,{profileSearch:t,setProfileSearch:e,openProfileModal:_,filteredProfileOptions:n,duplicateProfile:C,setConfirmDelete:A}),c.jsx(jH,{open:f,onClose:()=>{p(!1),h(null),u({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),x(!1),g(!1),w(!1)},editingProfile:d,profileForm:l,setProfileForm:u,profileIsSystem:b,profilePermissionSetsOpen:y,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:w,permissionSetValues:r,permissionSetsQuery:o,permissionSetList:i,selectedProfilePermissionSets:M,toggleProfilePermissionSet:U,selectAllProfilePermissionSets:W,clearProfilePermissionSets:E,selectedProfilePermissions:N,permissionList:s,permissionsQuery:a,selectedProfilePermissionSet:R,toggleProfilePermission:D,selectAllProfilePermissions:$,clearProfilePermissions:L,customProfilePermissions:O,setConfirmDelete:A,saveProfile:S,savingProfile:k}),c.jsx(fc,{open:P.open,message:P.label,onClose:()=>A({open:!1,type:"",payload:null,label:""}),onConfirm:F})]})}function SH({permissionList:t,permissionSetValues:e,permissionSetList:n}){const s=gr(),[r,i]=v.useState({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),[o,a]=v.useState(null),[l,u]=v.useState(!1),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[b,x]=v.useState(!1),[y,g]=v.useState(!1),m=v.useMemo(()=>kn(r.permissionsText),[r.permissionsText]),w=v.useMemo(()=>new Set(m),[m]),k=v.useMemo(()=>new Set(r.permissionSets||[]),[r.permissionSets]),_=v.useMemo(()=>{if(!t.length)return m;const E=new Set(t);return m.filter(P=>!E.has(P))},[t,m]),C=v.useMemo(()=>{const E=new Map;return(n||[]).forEach(P=>{const A=P.name||P.id;if(!A)return;const F=(P.permissions||P.permission_list||P.permissionList||[]).map(z=>typeof z=="string"?z:(z==null?void 0:z.name)||(z==null?void 0:z.value)||(z==null?void 0:z.permission)).filter(Boolean);E.set(A,new Set(F))}),E},[n]);function S(E,P){return(E||[]).filter(A=>{const F=C.get(A);if(!F)return!0;for(const z of F)if(!P.has(z))return!1;return!0})}function j(E){h(!!(E!=null&&E.is_system)),!(E!=null&&E.is_system)&&(p(!1),x(!1),E?(a(E.id||E.name),i({name:E.name,display_name:E.display_name||E.name,description:E.description||"",permissionsText:(E.permissions||[]).map(P=>typeof P=="string"?P:P==null?void 0:P.name).filter(Boolean).join(`
`),permissionSets:(E.permission_sets||E.permissionSets||E.permission_set_names||[]).map(P=>typeof P=="string"?P:(P==null?void 0:P.name)||(P==null?void 0:P.id)).filter(Boolean)})):(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!0))}function N(E){if(!E)return;const P=E.name||E.display_name||"profile",A=E.display_name||E.name||P;h(!1),a(null),p(!1),x(!1),i({name:`${P}_new`,display_name:`${A}_new`,description:E.description||"",permissionsText:(E.permissions||[]).map(F=>typeof F=="string"?F:F==null?void 0:F.name).filter(Boolean).join(`
`),permissionSets:(E.permission_sets||E.permissionSets||E.permission_set_names||[]).map(F=>typeof F=="string"?F:(F==null?void 0:F.name)||(F==null?void 0:F.id)).filter(Boolean)}),u(!0)}async function R(){if(r.name.trim()){g(!0);try{const E={name:r.name.trim(),display_name:r.display_name||r.name,description:r.description,permissions:kn(r.permissionsText),permission_sets:r.permissionSets||[]};o?await $B(o,E):await LB(E),s.invalidateQueries({queryKey:["admin","profiles"]}),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),a(null),u(!1)}catch{}finally{g(!1)}}}async function M(E){try{await FB(E),s.invalidateQueries({queryKey:["admin","profiles"]}),o===E&&(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!1)}catch{}}function O(E){i(P=>{const A=new Set(kn(P.permissionsText)),F=A.has(E);F?A.delete(E):A.add(E);let z=P.permissionSets||[];return F&&(z=S(z,A)),{...P,permissionsText:Array.from(A).join(`
`),permissionSets:z}})}function D(){const E=new Set([...m,...t]);i(P=>({...P,permissionsText:Array.from(E).join(`
`)}))}function $(){i(E=>({...E,permissionsText:""}))}function L(E){i(P=>{const A=new Set(P.permissionSets||[]),F=new Set(kn(P.permissionsText));if(A.has(E))return A.delete(E),{...P,permissionSets:Array.from(A),permissionsText:Array.from(F).join(`
`)};A.add(E);const G=C.get(E);return G&&G.forEach(q=>F.add(q)),{...P,permissionSets:Array.from(A),permissionsText:Array.from(F).join(`
`)}})}function U(){i(E=>{const P=new Set([...E.permissionSets||[],...e]),A=new Set(kn(E.permissionsText));return P.forEach(F=>{const z=C.get(F);z&&z.forEach(G=>A.add(G))}),{...E,permissionSets:Array.from(P),permissionsText:Array.from(A).join(`
`)}})}function W(){i(E=>({...E,permissionSets:[]}))}return{profileForm:r,setProfileForm:i,editingProfile:o,setEditingProfile:a,profileModalOpen:l,setProfileModalOpen:u,profileIsSystem:d,setProfileIsSystem:h,profilePermissionSetsOpen:f,setProfilePermissionSetsOpen:p,profilePermissionsOpen:b,setProfilePermissionsOpen:x,savingProfile:y,openProfileModal:j,duplicateProfile:N,saveProfile:R,deleteProfile:M,selectedProfilePermissions:m,selectedProfilePermissionSet:w,selectedProfilePermissionSets:k,customProfilePermissions:_,toggleProfilePermission:O,selectAllProfilePermissions:D,clearProfilePermissions:$,toggleProfilePermissionSet:L,selectAllProfilePermissionSets:U,clearProfilePermissionSets:W}}function jH({open:t,onClose:e,editingProfile:n,profileForm:s,setProfileForm:r,profileIsSystem:i,profilePermissionSetsOpen:o,setProfilePermissionSetsOpen:a,profilePermissionsOpen:l,setProfilePermissionsOpen:u,permissionSetValues:d,permissionSetsQuery:h,permissionSetList:f,selectedProfilePermissionSets:p,toggleProfilePermissionSet:b,selectAllProfilePermissionSets:x,clearProfilePermissionSets:y,selectedProfilePermissions:g,permissionList:m,permissionsQuery:w,selectedProfilePermissionSet:k,toggleProfilePermission:_,selectAllProfilePermissions:C,clearProfilePermissions:S,customProfilePermissions:j,setConfirmDelete:N,saveProfile:R,savingProfile:M}){return c.jsx(Cs,{open:t,onClose:e,title:n?`Edit profile: ${n}`:"Add profile",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:O=>r(D=>({...D,name:O.target.value})),placeholder:"system_admin",disabled:!!n})}),c.jsx(Ce,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:O=>r(D=>({...D,display_name:O.target.value})),placeholder:"System Admin"})})]}),c.jsx(Ce,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:O=>r(D=>({...D,description:O.target.value})),placeholder:"What this profile can do"})}),c.jsx(Ce,{label:"Permission Sets",children:c.jsxs(Ft,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>a(O=>!O),"aria-expanded":o,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:jl(s.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:o?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",o&&"rotate-180")})]})]}),o?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:x,disabled:!d.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:y,disabled:!s.permissionSets.length,children:"Clear"})]})}),h.isLoading?c.jsx(Ye,{text:"Loading permission sets",className:"text-sm text-black/60 dark:text-white/65"}):f.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:f.map(O=>{const D=O.name||O.id;if(!D)return null;const $=p.has(D);return c.jsxs("button",{type:"button",onClick:()=>b(D),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",$?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate text-xs font-medium",children:O.display_name||O.name||D}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",$?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ca,{size:14,className:$?"opacity-100":"opacity-0"})})]},D)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]}):null]})}),c.jsx(Ce,{label:"Permissions",children:c.jsxs(Ft,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>u(O=>!O),"aria-expanded":l,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:jl(g.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:l?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",l&&"rotate-180")})]})]}),l?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,disabled:!m.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:S,disabled:!g.length,children:"Clear"})]})}),w.isLoading?c.jsx(Ye,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):m.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[110px] overflow-y-auto p-1",children:m.map(O=>{const D=k.has(O);return c.jsxs("button",{type:"button",onClick:()=>_(O),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",D?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:O}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",D?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ca,{size:14,className:D?"opacity-100":"opacity-0"})})]},O)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),j.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:j.map(O=>c.jsxs("button",{type:"button",onClick:()=>_(O),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:O}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},O))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(te,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>N({open:!0,type:"profile",payload:n,label:`Delete profile "${s.display_name||s.name}"?`}),disabled:i,children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:R,disabled:M||i,children:M?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]})})}function CH({permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:n,permissionSetsQuery:s,filteredPermissionSetList:r,duplicatePermissionSet:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Wt,{children:"Permission Sets"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add permission set"})]})]});return c.jsxs(vt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Lt,{className:"hidden md:block space-y-2",children:a}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(Ft,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.display_name||l.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(On,{onClick:()=>i(l),title:"Duplicate permission set","aria-label":"Duplicate permission set",children:c.jsx(YC,{size:16})}),c.jsx(On,{onClick:()=>n(l),title:"Edit permission set","aria-label":"Edit permission set",children:c.jsx(Cd,{size:16})}),c.jsx(On,{variant:"ghost",onClick:()=>o({open:!0,type:"permission-set",payload:l.name,label:`Delete permission set "${l.display_name||l.name}"?`}),title:"Delete permission set","aria-label":"Delete permission set",children:c.jsx(ua,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(l.permissions||[]).length," permission",(l.permissions||[]).length===1?"":"s"]}),l.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:l.description}):null]},l.name)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permission sets.":"No permission sets available."})]})})]})]})}function NH({permissionSetSearch:t,setPermissionSetSearch:e,permissionSetsQuery:n,filteredPermissionSetList:s,permissionList:r,permissionsQuery:i}){const{permissionSetForm:o,setPermissionSetForm:a,editingPermissionSet:l,setEditingPermissionSet:u,permissionSetModalOpen:d,setPermissionSetModalOpen:h,savingPermissionSet:f,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:b,openPermissionSetModal:x,duplicatePermissionSet:y,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:w,selectedPermissionSetPermissionSet:k,customPermissionSetPermissions:_,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j}=EH({permissionList:r}),[N,R]=v.useState({open:!1,type:"",payload:null,label:""});async function M(){if(!(!N.open||!N.payload))try{await m(N.payload)}finally{R({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(CH,{permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:x,permissionSetsQuery:n,filteredPermissionSetList:s,duplicatePermissionSet:y,setConfirmDelete:R}),c.jsx(TH,{open:d,onClose:()=>{h(!1),u(null),a({name:"",display_name:"",description:"",permissionsText:""}),b(!1)},editingPermissionSet:l,permissionSetForm:o,setPermissionSetForm:a,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:b,selectedPermissionSetPermissions:w,permissionList:r,permissionsQuery:i,selectedPermissionSetPermissionSet:k,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j,customPermissionSetPermissions:_,setConfirmDelete:R,savePermissionSet:g,savingPermissionSet:f}),c.jsx(fc,{open:N.open,message:N.label,onClose:()=>R({open:!1,type:"",payload:null,label:""}),onConfirm:M})]})}function EH({permissionList:t}){const e=gr(),[n,s]=v.useState({name:"",display_name:"",description:"",permissionsText:""}),[r,i]=v.useState(null),[o,a]=v.useState(!1),[l,u]=v.useState(!1),[d,h]=v.useState(!1),f=v.useMemo(()=>kn(n.permissionsText),[n.permissionsText]),p=v.useMemo(()=>new Set(f),[f]),b=v.useMemo(()=>{if(!t.length)return f;const C=new Set(t);return f.filter(S=>!C.has(S))},[t,f]);function x(C){h(!1),C?(i(C.name),s({name:C.name||"",display_name:C.display_name||C.name||"",description:C.description||"",permissionsText:(C.permissions||[]).map(S=>typeof S=="string"?S:S==null?void 0:S.name).filter(Boolean).join(`
`)})):(i(null),s({name:"",display_name:"",description:"",permissionsText:""})),a(!0)}function y(C){if(!C)return;const S=C.name||C.display_name||"permission_set",j=C.display_name||C.name||S;i(null),h(!1),s({name:`${S}_new`,display_name:`${j}_new`,description:C.description||"",permissionsText:(C.permissions||[]).map(N=>typeof N=="string"?N:N==null?void 0:N.name).filter(Boolean).join(`
`)}),a(!0)}async function g(){if(!n.name.trim())return;u(!0);const C={name:n.name.trim(),display_name:n.display_name||n.name.trim(),description:n.description,permissions:kn(n.permissionsText)};try{r?await KB(r,C):await qB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}finally{u(!1)}}async function m(C){if(C)try{await GB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}}function w(C){s(S=>{const j=new Set(kn(S.permissionsText));return j.has(C)?j.delete(C):j.add(C),{...S,permissionsText:Array.from(j).join(`
`)}})}function k(){const C=new Set([...f,...t]);s(S=>({...S,permissionsText:Array.from(C).join(`
`)}))}function _(){s(C=>({...C,permissionsText:""}))}return{permissionSetForm:n,setPermissionSetForm:s,editingPermissionSet:r,setEditingPermissionSet:i,permissionSetModalOpen:o,setPermissionSetModalOpen:a,savingPermissionSet:l,permissionSetPermissionsOpen:d,setPermissionSetPermissionsOpen:h,openPermissionSetModal:x,duplicatePermissionSet:y,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:f,selectedPermissionSetPermissionSet:p,customPermissionSetPermissions:b,togglePermissionSetPermission:w,selectAllPermissionSetPermissions:k,clearPermissionSetPermissions:_}}function TH({open:t,onClose:e,editingPermissionSet:n,permissionSetForm:s,setPermissionSetForm:r,permissionSetPermissionsOpen:i,setPermissionSetPermissionsOpen:o,selectedPermissionSetPermissions:a,permissionList:l,permissionsQuery:u,selectedPermissionSetPermissionSet:d,togglePermissionSetPermission:h,selectAllPermissionSetPermissions:f,clearPermissionSetPermissions:p,customPermissionSetPermissions:b,setConfirmDelete:x,savePermissionSet:y,savingPermissionSet:g}){return c.jsx(Cs,{open:t,onClose:e,title:n?`Edit permission set: ${n}`:"Add permission set",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:m=>r(w=>({...w,name:m.target.value})),placeholder:"sales_ops",disabled:!!n})}),c.jsx(Ce,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:m=>r(w=>({...w,display_name:m.target.value})),placeholder:"Sales Ops"})})]}),c.jsx(Ce,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:m=>r(w=>({...w,description:m.target.value})),placeholder:"What this permission set grants"})}),c.jsx(Ce,{label:"Permissions",children:c.jsxs(Ft,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>o(m=>!m),"aria-expanded":i,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:jl(a.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:i?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Te("transition-transform",i&&"rotate-180")})]})]}),i?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!l.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!a.length,children:"Clear"})]})}),u.isLoading?c.jsx(Ye,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:l.map(m=>{const w=d.has(m);return c.jsxs("button",{type:"button",onClick:()=>h(m),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",w?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:m}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",w?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ca,{size:14,className:w?"opacity-100":"opacity-0"})})]},m)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),b.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:b.map(m=>c.jsxs("button",{type:"button",onClick:()=>h(m),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:m}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},m))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(te,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>x({open:!0,type:"permission-set",payload:n,label:`Delete permission set "${s.display_name||s.name}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:y,disabled:g,children:g?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]})})}function PH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:b,mergedPermissionDescriptions:x,setConfirmDelete:y}){const g=[{value:"",label:"All modules"},...u.map(_=>({value:_,label:_}))],m=[{value:"",label:"All services"},...d.map(_=>({value:_,label:_}))],w=[{value:"",label:"All permissions"},...h.map(_=>({value:_,label:_}))],k=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Wt,{children:"Permissions"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(jo,{value:t,onChange:_=>e(_.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{className:"rounded-2xl self-start sm:self-auto",variant:"secondary",onClick:()=>n("add",""),children:"Add permission"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[c.jsx(ot,{value:s,options:g,onChange:r}),c.jsx(ot,{value:i,options:m,onChange:o}),c.jsx(ot,{value:a,options:w,onChange:l,className:"col-span-2 sm:col-span-1"})]})]});return c.jsxs(vt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Lt,{className:"hidden md:block space-y-2",children:k}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:k}),c.jsx("div",{className:"space-y-3 p-5 pt-1",children:f.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):p.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:p.map(_=>{const C=b(_),S=x[_];return c.jsxs(Ft,{className:"p-3",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Module"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.module})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Service"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.service})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Permission"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.action})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(On,{onClick:()=>n("edit",_),title:"Edit permission","aria-label":"Edit permission",children:c.jsx(Cd,{size:16})}),c.jsx(On,{variant:"ghost",onClick:()=>y({open:!0,type:"permission",payload:_,label:`Delete permission "${_}"?`}),title:"Delete permission","aria-label":"Delete permission",children:c.jsx(ua,{size:16})})]})]}),S?c.jsxs("div",{className:"mt-2 flex items-baseline gap-1 text-sm min-w-0",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Description"}),c.jsx("span",{className:"text-black/60 dark:text-white/65 truncate",children:S})]}):null]},_)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permissions.":"No permissions available."})})]})]})}function RH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:b,mergedPermissionDescriptions:x,permissionTree:y,updateLocalPermissionDescription:g}){const{permissionModal:m,setPermissionModal:w,permissionModalError:k,savingPermission:_,openPermissionModal:C,updatePermissionModalField:S,savePermissionModal:j,deletePermissionFromModal:N,setPermissionModalError:R}=AH({mergedPermissionDescriptions:x,updateLocalPermissionDescription:g}),[M,O]=v.useState({open:!1,type:"",payload:null,label:""}),D=m.module?y.servicesByModule[m.module]||[]:y.allServices,$=m.module&&m.service?y.actionsByService[`${m.module}:${m.service}`]||[]:y.allActions;async function L(){if(!(!M.open||!M.payload))try{await N(M.payload)}finally{O({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(PH,{permissionSearch:t,setPermissionSearch:e,openPermissionModal:n||C,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:b,mergedPermissionDescriptions:x,setConfirmDelete:O}),c.jsx(OH,{open:m.open,onClose:()=>{w({open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""}),R("")},permissionModal:m,permissionModuleOptions:u,permissionServiceOptions:D,permissionActionOptions:$,updatePermissionModalField:S,permissionModalError:k,savePermissionModal:j,savingPermission:_}),c.jsx(fc,{open:M.open,message:M.label,onClose:()=>O({open:!1,type:"",payload:null,label:""}),onConfirm:L})]})}const Dh={open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""};function AH({mergedPermissionDescriptions:t,updateLocalPermissionDescription:e}){const n=gr(),[s,r]=v.useState(Dh),[i,o]=v.useState(""),[a,l]=v.useState(!1);function u(p="add",b=""){const x=ny(b),y=b&&t[b]||"";o(""),r({open:!0,mode:p,value:b,original:b,module:x.module,service:x.service,action:x.action,description:y,originalDescription:y})}function d(p,b){r(x=>{const y={...x,[p]:b};return{...y,value:Vw(y)}}),o("")}async function h(){var b;const p=Vw(s);if(!p){o("Select module, service, and permission.");return}l(!0);try{const x=((b=s.description)==null?void 0:b.trim())||"";if(s.mode==="add")await mg(p,x),e(p,x);else if(p!==s.original)await mg(p,x),await Kk(s.original),e(s.original,""),e(p,x);else if(x!==s.originalDescription)await mg(p,x),e(p,x);else{r({...Dh});return}n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Dh})}catch{}finally{l(!1)}}async function f(p){const b=p||s.original||s.value;if(b){l(!0);try{await Kk(b),e(b,""),n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Dh})}catch{}finally{l(!1)}}}return{permissionModal:s,setPermissionModal:r,permissionModalError:i,savingPermission:a,openPermissionModal:u,updatePermissionModalField:d,savePermissionModal:h,deletePermissionFromModal:f,setPermissionModalError:o}}function OH({open:t,onClose:e,permissionModal:n,permissionModuleOptions:s,permissionServiceOptions:r,permissionActionOptions:i,updatePermissionModalField:o,permissionModalError:a,savePermissionModal:l,savingPermission:u}){return c.jsx(Cs,{open:t,onClose:e,title:n.mode==="edit"?"Edit permission":"Add permission",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ce,{label:"Permission",children:c.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr_auto_1fr] items-center gap-2",children:[c.jsxs("div",{children:[c.jsx("input",{list:"permission-module-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.module,onChange:d=>o("module",d.target.value),placeholder:"module"}),c.jsx("datalist",{id:"permission-module-options",children:s.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-service-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.service,onChange:d=>o("service",d.target.value),placeholder:"service"}),c.jsx("datalist",{id:"permission-service-options",children:r.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-action-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.action,onChange:d=>o("action",d.target.value),placeholder:"permission"}),c.jsx("datalist",{id:"permission-action-options",children:i.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]})]})}),c.jsx(Ce,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.description,onChange:d=>o("description",d.target.value),placeholder:"Short description"})}),a?c.jsx("div",{className:"text-xs text-red-600 dark:text-red-300",children:a}):null,c.jsx("div",{className:"flex justify-end",children:c.jsx(te,{className:"rounded-2xl",onClick:l,disabled:u,children:u?c.jsx(Ye,{text:"Saving"}):n.mode==="edit"?"Update Permission":"Add Permission"})})]})})}const IH=[{key:"chat",label:"AI Chat",description:"Chat assistant for general queries"},{key:"video_critique",label:"Video Critique",description:"AI-powered video analysis tool"},{key:"proposals",label:"Proposals",description:"Proposal generation and management"},{key:"asset_management",label:"Asset Management",description:"Digital asset management system"}],MH=[{key:"mockup_setup",label:"Mockup Setup",description:"Configure and upload mockup templates"},{key:"mockup_generate",label:"Mockup Generate",description:"Generate mockups from templates"}],Cg=20;function DH(){const{user:t}=mi(),[e,n]=v.useState("users"),[s,r]=v.useState(""),[i,o]=v.useState(0),[a,l]=v.useState(""),[u,d]=v.useState(""),[h,f]=v.useState(""),[p,b]=v.useState(""),[x,y]=v.useState(""),[g,m]=v.useState(""),[w,k]=v.useState(""),[_,C]=v.useState(""),[S,j]=v.useState("");if(!Td(t))return c.jsxs(vt,{children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Restricted"})}),c.jsx($t,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to the admin panel."})]});const N=Ht({queryKey:["admin","users",i],queryFn:()=>TB({limit:Cg,offset:i*Cg})}),R=Ht({queryKey:["admin","profiles"],queryFn:DB}),M=Ht({queryKey:["admin","permissions"],queryFn:zB}),O=Ht({queryKey:["admin","companies"],queryFn:BB}),D=Ht({queryKey:["admin","permission-sets"],queryFn:VB}),$=gr(),L={chat:!0,video_critique:!0,mockup_setup:!0,mockup_generate:!0,proposals:!0,asset_management:!0},U=Ht({queryKey:["service-visibility"],queryFn:v0,placeholderData:L,keepPreviousData:!0}),W=U.data||L,E=U.isLoading&&!U.isFetched,P=W._dev_mode===!0,A=KC({mutationFn:YB,onMutate:async J=>{await $.cancelQueries({queryKey:["service-visibility"]});const ee=$.getQueryData(["service-visibility"]);return $.setQueryData(["service-visibility"],J),{previousVisibility:ee}},onError:(J,ee,ne)=>{$.setQueryData(["service-visibility"],ne==null?void 0:ne.previousVisibility)},onSettled:()=>{$.invalidateQueries({queryKey:["service-visibility"]})}}),F=v.useCallback((J,ee)=>{const ne={...W,[J]:!ee};A.mutate(ne)},[W,A]),z=v.useMemo(()=>{var ne;const J=((ne=N.data)==null?void 0:ne.users)||N.data||[],ee=s.trim().toLowerCase();return J.filter(ke=>{var Rs,ds,As,Ur,ct;const fn=Array.isArray(ke.profiles)?ke.profiles.map(lt=>(lt==null?void 0:lt.display_name)||(lt==null?void 0:lt.name)||lt).filter(Boolean).join(" "):((Rs=ke.profiles)==null?void 0:Rs.display_name)||((ds=ke.profiles)==null?void 0:ds.name)||ke.profile||ke.profile_name||"",xr=`${ke.email||""} ${ke.name||""} ${fn}`.toLowerCase();if(ee&&!xr.includes(ee))return!1;const on=((As=ke.company)==null?void 0:As.code)||ke.company_code||ke.company_id||"";return!(x&&on!==x||g&&!(Array.isArray(ke.profiles)?ke.profiles.map(At=>(At==null?void 0:At.name)||(At==null?void 0:At.display_name)||At).filter(Boolean):[((Ur=ke.profiles)==null?void 0:Ur.name)||((ct=ke.profiles)==null?void 0:ct.display_name)||ke.profile||ke.profile_name].filter(Boolean)).includes(g))})},[N.data,s,x,g]);v.useMemo(()=>{var ee;return(((ee=N.data)==null?void 0:ee.users)||N.data||[]).length===Cg},[N.data]),v.useEffect(()=>{C(""),j("")},[w]),v.useEffect(()=>{j("")},[_]);const G=v.useMemo(()=>{var ee;const J=((ee=R.data)==null?void 0:ee.profiles)??R.data;return Array.isArray(J)?J:[]},[R.data]),q=v.useMemo(()=>{var Ur;const J=((Ur=M.data)==null?void 0:Ur.permissions)??M.data,ee=new Map,ne={},ke=(ct,lt,At)=>{if(!ct||!lt||!At)return;ee.has(ct)||ee.set(ct,new Map);const pn=ee.get(ct);pn.has(lt)||pn.set(lt,new Set),pn.get(lt).add(At)};Array.isArray(J)?J.forEach(ct=>{const lt=typeof ct=="string"?ct:ct==null?void 0:ct.name,At=typeof ct=="string"?"":(ct==null?void 0:ct.description)||"";if(lt&&At&&(ne[lt]=At),!lt)return;const pn=lt.split(":");pn.length>=3&&ke(pn[0],pn[1],pn[2])}):J&&typeof J=="object"&&Object.entries(J).forEach(([ct,lt])=>{!lt||typeof lt!="object"||Object.entries(lt).forEach(([At,pn])=>{Array.isArray(pn)&&pn.forEach(hs=>ke(ct,At,hs))})});const fn=Array.from(ee.keys()).sort(),xr={},on={},Rs=[],ds=new Set,As=new Set;return fn.forEach(ct=>{const lt=Array.from(ee.get(ct).keys()).sort();xr[ct]=lt,lt.forEach(At=>{ds.add(At);const pn=Array.from(ee.get(ct).get(At)).sort();on[`${ct}:${At}`]=pn,pn.forEach(hs=>{As.add(hs),Rs.push(`${ct}:${At}:${hs}`)})})}),{modules:fn,servicesByModule:xr,actionsByService:on,flat:Rs,allServices:Array.from(ds).sort(),allActions:Array.from(As).sort(),descriptions:ne}},[M.data]),B=v.useMemo(()=>q.flat,[q]),Q=q.descriptions||{},[pe,Z]=v.useState({}),be=v.useMemo(()=>({...Q||{},...pe}),[Q,pe]),De=v.useCallback((J,ee)=>{if(!J)return;const ne=(ee==null?void 0:ee.trim())||"";Z(ke=>{const fn={...ke};return ne?fn[J]=ne:delete fn[J],fn})},[]),xe=q.modules,me=w?q.servicesByModule[w]||[]:q.allServices,Le=w&&_?q.actionsByService[`${w}:${_}`]||[]:q.allActions,Y=v.useMemo(()=>{var ee;const J=((ee=O.data)==null?void 0:ee.companies)??O.data;return Array.isArray(J)?J:[]},[O.data]),ae=v.useMemo(()=>{var ee,ne;const J=((ee=D.data)==null?void 0:ee.permission_sets)??((ne=D.data)==null?void 0:ne.permissionSets)??D.data;return Array.isArray(J)?J.map(ke=>typeof ke=="string"?{name:ke}:ke):[]},[D.data]),le=v.useMemo(()=>{const J=u.trim().toLowerCase();return J?Y.filter(ee=>`${ee.name||""} ${ee.code||""} ${ee.country||""} ${ee.currency||""} ${ee.timezone||""}`.toLowerCase().includes(J)):Y},[Y,u]),oe=v.useMemo(()=>{const J=a.trim().toLowerCase();return J?G.filter(ee=>`${ee.display_name||""} ${ee.name||""} ${ee.description||""}`.toLowerCase().includes(J)):G},[G,a]),re=v.useMemo(()=>{const J=h.trim().toLowerCase();return J?ae.filter(ee=>`${ee.display_name||""} ${ee.name||""} ${ee.description||""}`.toLowerCase().includes(J)):ae},[ae,h]),_e=v.useMemo(()=>{const J=p.trim().toLowerCase();let ee=B;return(w||_||S)&&(ee=ee.filter(ne=>{const ke=ny(ne);return!(w&&ke.module!==w||_&&ke.service!==_||S&&ke.action!==S)})),J?ee.filter(ne=>{const ke=be[ne]||"";return`${ne} ${ke}`.toLowerCase().includes(J)}):ee},[B,p,be,w,_,S]),se=v.useMemo(()=>Y.map(J=>({value:J.code||J.id||"",label:J.name||J.code||J.id||""})).filter(J=>J.value),[Y]),V=v.useMemo(()=>G.map(J=>({value:J.name||J.display_name||"",label:J.display_name||J.name||""})).filter(J=>J.value),[G]),ye=v.useMemo(()=>ae.map(J=>J.name||J.id).filter(Boolean),[ae]),Ne=v.useMemo(()=>G.map(J=>J.name||J.id).filter(Boolean),[G]),Re=v.useMemo(()=>{const J=new Map;return Y.forEach(ee=>{const ne=ee.code||ee.id;ne&&J.set(ne,ee.name||ee.code||ne)}),J},[Y]);return c.jsxs("div",{className:"flex h-full min-h-0 flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto",children:[c.jsx(te,{variant:e==="users"?"default":"ghost",onClick:()=>n("users"),className:"rounded-2xl shrink-0",children:"Users"}),c.jsx(te,{variant:e==="companies"?"default":"ghost",onClick:()=>n("companies"),className:"rounded-2xl shrink-0",children:"Companies"}),c.jsx(te,{variant:e==="profiles"?"default":"ghost",onClick:()=>n("profiles"),className:"rounded-2xl shrink-0",children:"Profiles"}),c.jsx(te,{variant:e==="permission-sets"?"default":"ghost",onClick:()=>n("permission-sets"),className:"rounded-2xl shrink-0",children:"Permission Sets"}),c.jsx(te,{variant:e==="permissions"?"default":"ghost",onClick:()=>n("permissions"),className:"rounded-2xl shrink-0",children:"Permissions"}),c.jsx(te,{variant:e==="services"?"default":"ghost",onClick:()=>n("services"),className:"rounded-2xl shrink-0",children:"Services"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:e==="users"?"h-full":"hidden","aria-hidden":e!=="users",children:c.jsx(mH,{q:s,setQ:r,usersQuery:N,users:z,user:t,companyLookup:Re,userCompanyFilter:x,setUserCompanyFilter:y,userProfileFilter:g,setUserProfileFilter:m,companyFilterOptions:se,profileFilterOptions:V,companyList:Y,profileOptions:G,profileValues:Ne,permissionSetList:ae,permissionSetValues:ye,permissionList:B,permissionsQuery:M,page:i})}),c.jsx("div",{className:e==="companies"?"h-full":"hidden","aria-hidden":e!=="companies",children:c.jsx(vH,{companySearch:u,setCompanySearch:d,companiesQuery:O,filteredCompanyList:le,companyLookup:Re,companyList:Y})}),c.jsx("div",{className:e==="profiles"?"h-full":"hidden","aria-hidden":e!=="profiles",children:c.jsx(_H,{profileSearch:a,setProfileSearch:l,filteredProfileOptions:oe,permissionList:B,permissionSetValues:ye,permissionSetList:ae,permissionSetsQuery:D,permissionsQuery:M})}),c.jsx("div",{className:e==="permission-sets"?"h-full":"hidden","aria-hidden":e!=="permission-sets",children:c.jsx(NH,{permissionSetSearch:h,setPermissionSetSearch:f,permissionSetsQuery:D,filteredPermissionSetList:re,permissionList:B,permissionsQuery:M})}),c.jsx("div",{className:e==="permissions"?"h-full":"hidden","aria-hidden":e!=="permissions",children:c.jsx(RH,{permissionSearch:p,setPermissionSearch:b,permissionModuleFilter:w,setPermissionModuleFilter:k,permissionServiceFilter:_,setPermissionServiceFilter:C,permissionActionFilter:S,setPermissionActionFilter:j,permissionModuleOptions:xe,permissionFilterServiceOptions:me,permissionFilterActionOptions:Le,permissionsQuery:M,filteredPermissionList:_e,parsePermissionParts:ny,mergedPermissionDescriptions:be,permissionTree:q,updateLocalPermissionDescription:De})}),c.jsx("div",{className:e==="services"?"h-full overflow-y-auto":"hidden","aria-hidden":e!=="services",children:c.jsxs(vt,{className:"h-full",children:[c.jsxs(Lt,{className:"pb-2",children:[c.jsx(Wt,{className:"text-lg",children:"Service Visibility"}),c.jsx("p",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle which services are visible to users in the sidebar. Admin and Settings are always visible."})]}),c.jsx($t,{className:"space-y-6",children:E?c.jsxs("div",{className:"space-y-6 animate-pulse",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"h-4 w-28 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"grid gap-3",children:[1,2,3,4].map(J=>c.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"h-4 w-24 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"h-3 w-40 bg-black/5 dark:bg-white/5 rounded"})]}),c.jsx("div",{className:"h-6 w-11 bg-black/10 dark:bg-white/10 rounded-full"})]},J))})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"h-4 w-28 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"grid gap-3",children:[1,2].map(J=>c.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"h-4 w-24 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"h-3 w-40 bg-black/5 dark:bg-white/5 rounded"})]}),c.jsx("div",{className:"h-6 w-11 bg-black/10 dark:bg-white/10 rounded-full"})]},J))})]})]}):c.jsxs(c.Fragment,{children:[P&&c.jsxs("div",{className:"rounded-xl bg-amber-500/10 border border-amber-500/30 p-3 mb-4",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-amber-600 dark:text-amber-400 font-medium text-sm",children:"Dev Mode Active"})}),c.jsxs("p",{className:"text-xs text-amber-600/80 dark:text-amber-400/80 mt-1",children:["All services are forced visible. Running with ",c.jsx("code",{className:"bg-amber-500/20 px-1 rounded",children:"--dev-all-services"})," flag. Toggles are disabled in this mode."]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-sm font-medium text-black/70 dark:text-white/75",children:"General Services"}),c.jsx("div",{className:"grid gap-3",children:IH.map(J=>c.jsx(E_,{label:J.label,description:J.description,enabled:W[J.key]===!0,onChange:()=>F(J.key,W[J.key]),disabled:P||A.isPending},J.key))})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-sm font-medium text-black/70 dark:text-white/75",children:"Mockup Services"}),c.jsx("p",{className:"text-xs text-black/50 dark:text-white/50",children:"If both are disabled, the Mockup service will be hidden entirely."}),c.jsx("div",{className:"grid gap-3",children:MH.map(J=>c.jsx(E_,{label:J.label,description:J.description,enabled:W[J.key]===!0,onChange:()=>F(J.key,W[J.key]),disabled:P||A.isPending},J.key))})]}),c.jsx("div",{className:"pt-4 border-t border-black/10 dark:border-white/10",children:c.jsxs("p",{className:"text-xs text-black/50 dark:text-white/50",children:[c.jsx("strong",{children:"Always visible:"})," Admin (for admins only), Settings"]})})]})})]})})]})]})}function E_({label:t,description:e,enabled:n,onChange:s,disabled:r}){return c.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[c.jsx("div",{className:"text-sm font-medium",children:t}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/50 truncate",children:e})]}),c.jsx("button",{type:"button",role:"switch","aria-checked":n,disabled:r,onClick:s,className:["relative inline-flex h-6 w-11 shrink-0 cursor-pointer rounded-full border-2 border-transparent","transition-all duration-200 ease-in-out focus:outline-none focus-visible:ring-2 focus-visible:ring-black/20",n?"bg-green-500":"bg-black/20 dark:bg-white/20",r?"opacity-50 cursor-not-allowed":""].join(" "),children:c.jsx("span",{className:["pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow-lg ring-0","transition-transform duration-200 ease-in-out",n?"translate-x-5":"translate-x-0"].join(" ")})})]})}function LH({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function $H(){const{notifications:t,loading:e,clearAll:n,dismissNotification:s,markRead:r,formatTime:i}=y0(),[o,a]=v.useState(null),l=v.useMemo(()=>t,[t]);return c.jsxs("div",{className:"h-full min-h-0",children:[c.jsxs(vt,{className:"h-full flex flex-col",children:[c.jsxs(Lt,{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx(Wt,{children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:l.length?`${l.length} total`:"No alerts yet"})]}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:n,disabled:!l.length,children:"Clear all"})]}),c.jsx($t,{className:"flex-1 min-h-0 overflow-y-auto pt-2",children:e?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"space-y-2",children:l.map(u=>c.jsx(Ft,{className:"p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-base font-semibold text-black/85 dark:text-white/85 truncate",children:u.title||"Notification"}),u.message?c.jsx("div",{className:"mt-1 text-sm text-black/60 dark:text-white/65 leading-5 mmg-line-clamp-2",children:u.message}):null,u.created_at?c.jsx("div",{className:"mt-1 text-xs text-black/45 dark:text-white/45",children:i(u.created_at)}):null]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(On,{variant:"ghost",className:"h-8 w-8",onClick:()=>{r(u.id),a(u)},"aria-label":"View notification",children:c.jsx(QC,{size:14})}),c.jsx(On,{variant:"ghost",className:"h-8 w-8",onClick:()=>s(u.id),"aria-label":"Close notification",children:c.jsx(Gv,{size:14})})]})]})},u.id))}):c.jsx(Ft,{className:"p-6 text-center text-sm text-black/60 dark:text-white/65",children:"You're all caught up."})})]}),c.jsx(Cs,{open:!!o,onClose:()=>a(null),title:(o==null?void 0:o.title)||"Notification",maxWidth:"520px",children:c.jsx(LH,{notification:o})})]})}function FH(){const[t,e]=v.useState(null),[n,s]=v.useState([]),[r,i]=v.useState(""),[o,a]=v.useState(null),[l,u]=v.useState(null),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[b,x]=v.useState(!1),[y,g]=v.useState(null),[m,w]=v.useState({}),[k,_]=v.useState(null),[C,S]=v.useState(!1),[j,N]=v.useState(!1),R=v.useRef(null),M=v.useRef(null),O=v.useRef(null),D=v.useRef(null),$=v.useRef(!0),L=Ht({queryKey:["video-critique","history"],queryFn:S4,enabled:!0}),U=v.useMemo(()=>(r.trim().length>0||!!o)&&!d,[r,o,d]);v.useEffect(()=>{var Q;if(f||L.isLoading)return;const B=L.data;if(B&&((Q=B.messages)!=null&&Q.length||B.session_id||B.conversation_id)){e(B.session_id||B.conversation_id||null);const pe=(B.messages||[]).map(VH);s(pe.length?pe:[P_()])}else s([P_()]);p(!0)},[L.data,L.isLoading,f]),v.useEffect(()=>{const B=M.current;if(!B)return;const Q=()=>{const Z=B.scrollHeight-B.scrollTop-B.clientHeight<=120;$.current=Z};return Q(),B.addEventListener("scroll",Q,{passive:!0}),()=>B.removeEventListener("scroll",Q)},[]);const W=ge.useCallback((B="smooth",Q=!1)=>{var pe;!Q&&!$.current||(pe=O.current)==null||pe.scrollIntoView({behavior:B,block:"end"})},[]);v.useEffect(()=>{const B=d?"auto":"smooth";requestAnimationFrame(()=>W(B))},[n,d,W]),v.useEffect(()=>{f&&requestAnimationFrame(()=>W("auto",!0))},[f,W]),v.useEffect(()=>()=>{var B,Q;return(Q=(B=D.current)==null?void 0:B.abort)==null?void 0:Q.call(B)},[]);const E=v.useMemo(()=>{var B;return(B=y==null?void 0:y.fields)!=null&&B.length?y.fields.every(Q=>{if(!Q.required)return!0;const pe=m==null?void 0:m[Q.id];return pe!=null&&String(pe).trim()!==""}):!1},[y,m]);function P(){x(!1),g(null),w({}),_(null),S(!1),N(!1)}async function A({formType:B,workflowId:Q}){x(!0),S(!0),_({formType:B,workflowId:Q}),g(null),w({});try{const pe=await P4(B);g(pe);const Z={};((pe==null?void 0:pe.fields)||[]).forEach(be=>{Z[be.id]=be.default_value||""}),w(Z)}catch(pe){g({title:"Action",submit_text:"Submit",fields:[],error:(pe==null?void 0:pe.message)||"Failed to load form."})}finally{S(!1)}}function F(B,Q={}){s(pe=>[...pe,{id:crypto.randomUUID(),role:"assistant",content:B,files:[],status:null,...Q}])}async function z(B){if(!B||B.url)return;const Q=B.action_id||B.id,pe=B.workflow_id||B.workflowId;if(!Q||!pe){F("Missing action details. Please try again.");return}try{N(!0);const Z=await E4({actionId:Q,workflowId:pe});if(Z!=null&&Z.requires_form){N(!1),await A({formType:Z.form_type||B.form_type,workflowId:Z.workflow_id||pe});return}F((Z==null?void 0:Z.message)||"Action completed.")}catch(Z){F((Z==null?void 0:Z.message)||"Unable to complete that action.")}finally{N(!1)}}async function G(){if(!(!(k!=null&&k.formType)||!(k!=null&&k.workflowId))&&E){N(!0);try{const B=await T4({formType:k.formType,workflowId:k.workflowId,category:m.category,reason:m.reason});P(),F((B==null?void 0:B.message)||"Form submitted.")}catch(B){F((B==null?void 0:B.message)||"Unable to submit the form."),N(!1)}}}async function q(){var Y,ae;if(!U)return;const B=r.trim(),Q=o,pe=!!l&&!Q,Z=B||(Q?`Please review this file: ${Q.name}`:"");Q&&l&&u(null);const be=crypto.randomUUID(),De=Q?[{file_id:`local-${Date.now()}`,filename:Q.name,preview_url:URL.createObjectURL(Q)}]:[],xe={id:be,role:"user",content:B,files:De,status:null},me=crypto.randomUUID(),Le={id:me,role:"assistant",content:"",files:[],status:pe?null:"Reviewing..."};s(le=>[...le,xe,Le]),i(""),a(null),$.current=!0,requestAnimationFrame(()=>W("auto",!0));try{let le=[];if(pe){const V=T_(B);if(!V){s(Ne=>Ne.map(Re=>Re.id===me?{...Re,status:null,content:"Please provide a task number to upload this video."}:Re));return}h(!0);const ye=await Yk({file:l,taskNumber:V});s(Ne=>Ne.map(Re=>Re.id===me?{...Re,status:null,content:(ye==null?void 0:ye.message)||"Video uploaded."}:Re)),u(null);return}if(Q&&HH(Q)){const V=T_(B);if(V){h(!0);const ye=await Yk({file:Q,taskNumber:V});s(Ne=>Ne.map(Re=>Re.id===me?{...Re,status:null,content:(ye==null?void 0:ye.message)||"Video uploaded."}:Re));return}u(Q),s(ye=>ye.map(Ne=>Ne.id===me?{...Ne,status:null,content:"Video received. Which task number is this for?"}:Ne));return}if(Q&&WH(Q)){h(!0);const V=await j4({file:Q,message:B||void 0,sessionId:t});if(V!=null&&V.session_id&&e(ye=>ye||V.session_id),V!=null&&V.file_id){const ye={file_id:V.file_id,filename:Q.name,file_url:V.file_url||V.url||""};s(Ne=>Ne.map(Re=>{var J,ee,ne,ke;return Re.id===be?{...Re,files:[{...ye,preview_url:((ee=(J=Re.files)==null?void 0:J[0])==null?void 0:ee.preview_url)||((ke=(ne=Re.files)==null?void 0:ne[0])==null?void 0:ke.url)||""}]}:Re}))}s(ye=>ye.map(Ne=>Ne.id===me?{...Ne,status:null,content:(V==null?void 0:V.response)||(V==null?void 0:V.message)||"File received."}:Ne));return}if(Q){h(!0);const V=await C4({file:Q});if(!(V!=null&&V.file_id))throw new Error("Upload failed");le=[V.file_id];const ye={file_id:V.file_id,filename:Q.name,file_url:V.file_url||V.url||""};s(Ne=>Ne.map(Re=>{var J,ee,ne,ke;return Re.id===be?{...Re,files:[{...ye,preview_url:((ee=(J=Re.files)==null?void 0:J[0])==null?void 0:ee.preview_url)||((ke=(ne=Re.files)==null?void 0:ne[0])==null?void 0:ke.url)||""}]}:Re}))}if(!Q&&B.startsWith("/")){h(!0);const ye=B.replace(/^\/+/,"").split(/\\s+/),Ne=ye.shift()||"",Re=ye.join(" "),J=await N4({command:Ne,args:Re,sessionId:t});J!=null&&J.session_id&&e(ee=>ee||J.session_id),s(ee=>ee.map(ne=>ne.id===me?{...ne,status:null,content:(J==null?void 0:J.response)||(J==null?void 0:J.error)||"Command failed."}:ne));return}h(!0),(ae=(Y=D.current)==null?void 0:Y.abort)==null||ae.call(Y);const oe=new AbortController;D.current=oe;let re="",_e=null,se=!1;await A4({sessionId:t,message:Z,fileIds:le,signal:oe.signal,onEvent:V=>{var Re,J;if((V!=null&&V.session_id||V!=null&&V.conversation_id)&&e(ee=>ee||V.session_id||V.conversation_id),(V==null?void 0:V.type)==="error"||V!=null&&V.error){const ee=(V==null?void 0:V.message)||(V==null?void 0:V.error)||"Stream error";s(ne=>ne.map(ke=>ke.id===me?{...ke,status:null,content:`Error: ${ee}`}:ke));return}if((V==null?void 0:V.type)==="status"){s(ee=>ee.map(ne=>ne.id===me?{...ne,status:V.content||"Processing..."}:ne)),V.message_id&&(_e=V.message_id);return}if((V==null?void 0:V.type)==="delete"){V.message_id&&V.message_id===_e&&(re="",_e=null,s(ee=>ee.map(ne=>ne.id===me?{...ne,status:"Reviewing...",content:""}:ne)));return}if((V==null?void 0:V.type)==="tool_call"){const ee=V.name||((Re=V.tool)==null?void 0:Re.name)||"processing";s(ne=>ne.map(ke=>ke.id===me?{...ke,status:`Processing ${ee}...`}:ke));return}const ye=((J=V==null?void 0:V.result)==null?void 0:J.pdf_filename)||(V==null?void 0:V.pdf_filename),Ne=ee=>!ee||!ye||ee.pdf_filename?ee:{...ee,pdf_filename:ye};if(ye&&s(ee=>ee.map(ne=>ne.id===me&&!ne.pdf_filename?{...ne,pdf_filename:ye}:ne)),(V==null?void 0:V.type)==="delta"&&V.content){re+=V.content,s(ee=>ee.map(ne=>ne.id===me?{...ne,status:null,content:re}:ne));return}if((V==null?void 0:V.type)==="text_done"){re=V.content||re,s(ee=>ee.map(ne=>ne.id===me?{...ne,status:null,content:re}:ne));return}if(((V==null?void 0:V.type)==="chunk"||(V==null?void 0:V.type)==="content")&&V.content){V.message_id&&V.message_id!==_e&&(_e=V.message_id),re=V.type==="content"?V.content:re+V.content,s(ee=>ee.map(ne=>ne.id===me?{...ne,status:null,content:re}:ne));return}if(V!=null&&V.content&&!V.type){re+=V.content,s(ee=>ee.map(ne=>ne.id===me?{...ne,status:null,content:re}:ne));return}if((V==null?void 0:V.type)==="actions"&&V.actions){s(ee=>ee.map(ne=>ne.id===me?{...ne,actions:V.actions}:ne));return}if(V!=null&&V.actions){s(ee=>ee.map(ne=>ne.id===me?{...ne,actions:V.actions}:ne));return}if((V==null?void 0:V.type)==="files"&&V.files){if(se=!0,s(ee=>ee.map(ne=>ne.id===me?{...ne,files:[...ne.files||[],...V.files.map(Ne)]}:ne)),!re){const ee=V.files.find(ne=>ne.comment);ee!=null&&ee.comment&&(re=ee.comment,s(ne=>ne.map(ke=>ke.id===me?{...ke,status:null,content:re}:ke)))}return}if((V==null?void 0:V.type)==="file"&&(V.file||V.url)){const ee=Ne(V.file||V);se=!0,s(ne=>ne.map(ke=>ke.id===me?{...ke,files:[...ke.files||[],ee]}:ke)),!re&&ee.comment&&(re=ee.comment,s(ne=>ne.map(ke=>ke.id===me?{...ke,status:null,content:re}:ke)));return}if(V!=null&&V.files){se=!0,s(ee=>ee.map(ne=>ne.id===me?{...ne,files:[...ne.files||[],...V.files.map(Ne)]}:ne));return}typeof V=="string"&&V.trim()&&(re+=V,s(ee=>ee.map(ne=>ne.id===me?{...ne,status:null,content:re}:ne)))},onDone:()=>{!re&&!se&&s(V=>V.map(ye=>ye.id===me?{...ye,status:null,content:"Ready for the next request when you are."}:ye))}})}catch(le){s(oe=>oe.map(re=>re.id===me?{...re,status:null,content:(le==null?void 0:le.message)||"Failed to get response"}:re))}finally{h(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(vt,{className:"p-4 overflow-hidden flex-1 min-h-0",children:c.jsx("div",{ref:M,className:"h-full overflow-y-auto px-2",children:c.jsxs("div",{className:"space-y-3",children:[!f&&L.isLoading?c.jsx(Ye,{text:"Loading conversation",className:"text-sm text-black/60 dark:text-white/65"}):null,n.map(B=>c.jsx(zH,{msg:B,onMediaLoad:()=>W("auto"),onAction:z,actionsDisabled:j},B.id)),c.jsx("div",{ref:O})]})})}),c.jsxs(vt,{className:"p-3",children:[l&&!o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsxs("div",{className:"truncate",children:["Awaiting task number for ",l.name]}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>u(null),children:"x"})]}):null,o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:o.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>a(null),children:"x"})]}):null,c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:R,type:"file",className:"hidden",onChange:B=>{var Q;return a(((Q=B.target.files)==null?void 0:Q[0])||null)},accept:"video/*,image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var B;return(B=R.current)==null?void 0:B.click()},children:c.jsx(XC,{size:18})}),c.jsx(BH,{value:r,onChange:i,placeholder:"Describe the video request...",onEnter:q}),c.jsx(te,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!U,onClick:q,children:c.jsx(JC,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"Share a brief, a link, or upload a cut for review."})]}),c.jsx(Cs,{open:b,onClose:P,title:(y==null?void 0:y.title)||"Action",maxWidth:"520px",children:C?c.jsx(Ye,{text:"Loading form",className:"text-sm text-black/60 dark:text-white/65"}):y!=null&&y.error?c.jsx("div",{className:"text-sm text-red-600 dark:text-red-300",children:y.error}):c.jsxs("div",{className:"space-y-3",children:[((y==null?void 0:y.fields)||[]).map(B=>{if(B.type==="select"){const Q=[{value:"",label:B.placeholder||"Select..."},...B.options||[]];return c.jsx(Ce,{label:B.label,children:c.jsx(ot,{value:m[B.id]||"",options:Q,onChange:pe=>w(Z=>({...Z,[B.id]:pe}))})},B.id)}return B.type==="textarea"?c.jsx(Ce,{label:B.label,children:c.jsx("textarea",{rows:3,placeholder:B.placeholder||"",className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[B.id]||"",onChange:Q=>w(pe=>({...pe,[B.id]:Q.target.value}))})},B.id):c.jsx(Ce,{label:B.label,children:c.jsx("input",{type:"text",placeholder:B.placeholder||"",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[B.id]||"",onChange:Q=>w(pe=>({...pe,[B.id]:Q.target.value}))})},B.id)}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:P,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:G,disabled:!E||j||C,children:(y==null?void 0:y.submit_text)||"Submit"})]})]})})]})}function zH({msg:t,onMediaLoad:e,onAction:n,actionsDisabled:s}){var h;const r=t.role==="user",i=v.useMemo(()=>XH(t.content||""),[t.content]),o=v.useMemo(()=>Ry(t.status||""),[t.status]),a=v.useMemo(()=>!t.status&&qH(t.content||""),[t.status,t.content]),l=v.useMemo(()=>Ry(t.content||""),[t.content]),u=v.useRef(new Map),d=t.actions||t.buttons||[];return c.jsx("div",{className:r?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",r?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[t.status||a?c.jsx(UH,{text:o||l}):c.jsx("div",{dangerouslySetInnerHTML:{__html:i}}),(h=t.files)!=null&&h.length?c.jsx("div",{className:"mt-2 space-y-1",children:t.files.map((f,p)=>{const b=R4(f);if(!b)return null;const x=f.pdf_filename||t.pdf_filename,y=YH(x?{...f,pdf_filename:x}:f,b,u.current),g=Xc(y),m=["jpg","jpeg","png","gif","webp","bmp"].includes(g),w=!r,k=g==="pdf";return m?c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:w?c.jsxs(c.Fragment,{children:[c.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"block overflow-hidden rounded-lg",children:c.jsx("img",{src:b,alt:y,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),Lh(b,y)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),Lh(b,y))},className:"inline-flex items-center",children:[c.jsx(va,{size:14,className:"mr-1"}),"Download"]})})]})]}):c.jsx("div",{className:"overflow-hidden rounded-lg",children:c.jsx("img",{src:b,alt:y,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})})},f.file_id||b||p):c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:k?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Kv,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:g?g.toUpperCase():"FILE"})}),w?c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:y}):null]}),w?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(ho,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),Lh(b,y)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),Lh(b,y))},className:"inline-flex items-center",children:[c.jsx(va,{size:14,className:"mr-1"}),"Download"]})})]}):null]})},f.file_id||b||p)})}):null,d.length?c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.map((f,p)=>{const b=f.action_id||f.id||`${f.label}-${p}`,x=f.variant||"secondary";return f.url?c.jsx(te,{asChild:!0,size:"sm",variant:x,className:"rounded-xl",disabled:s,children:c.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",children:f.label||"Open"})},b):c.jsx(te,{size:"sm",variant:x,className:"rounded-xl",onClick:()=>n==null?void 0:n(f),disabled:s,children:f.label||"Action"},b)})}):null]})})}function BH({value:t,onChange:e,placeholder:n,onEnter:s,disabled:r}){const i=v.useRef(null);v.useEffect(()=>{const a=i.current;if(!a)return;a.style.height="0px";const u=22*5+16;a.style.height=Math.min(a.scrollHeight,u)+"px"},[t]);function o(a){a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),s==null||s())}return c.jsx("textarea",{ref:i,rows:1,value:t,disabled:r,onChange:a=>e(a.target.value),onKeyDown:o,placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function UH({text:t}){return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:t||"Reviewing"}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function T_(t){if(!t)return null;const e=String(t).match(/\b(\d{1,6})\b/);return e?Number(e[1]):null}function HH(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function WH(t){if(!t)return!1;if(t.type&&t.type.startsWith("image/"))return!0;const e=t.name||"";return/\.(png|jpe?g|gif|webp|bmp)$/i.test(e)}function VH(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||t.sender||"assistant",content:t.content||t.message||"",files:t.files||t.attachments||[],actions:t.actions||t.buttons||[],pdf_filename:t.pdf_filename||t.pdfFilename,status:null}}function Ry(t){return t?String(t).replace(/[_*`]/g,"").replace(/\.+$/,"").replace(/\s+/g," ").trim():""}function qH(t){const e=Ry(t);return e?!!(e==="Reviewing"||e.startsWith("Processing")||e.startsWith("Analyzing")):!1}function Xc(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length<=1?"":n.pop().toLowerCase()}function KH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function GH(t){if(!t)return!0;const e=t.trim().toLowerCase();if(!e||e==="file"||e==="download")return!0;const n=e.replace(/\.[^.]+$/,"");return!!(n==="tmp"||n==="temp"||/^[a-f0-9-]{16,}$/.test(n)||/^file[-_]?\d+$/.test(n)||/^(tmp|temp)/.test(n)||/^upload[-_]?.+$/.test(n))}function YH(t,e,n){const s=(t==null?void 0:t.pdf_filename)||"",r=s||(t==null?void 0:t.filename)||(t==null?void 0:t.title)||"",i=KH(e),o=(t==null?void 0:t.file_id)||(t==null?void 0:t.id)||e||r;let a=r||i||"";const l=Xc(a)||Xc(i)||Xc(e);if(s){const u=Xc(a)||"pdf";return a.toLowerCase().endsWith(`.${u}`)||(a=`${a}.${u}`),o&&n&&n.set(o,a),a}return GH(a)?l==="pdf"?a="Review.pdf":l?a=`Attachment.${l}`:a="Attachment":l&&!a.toLowerCase().endsWith(`.${l}`)&&(a=`${a}.${l}`),o&&n&&n.set(o,a),a||(l?`Attachment.${l}`:"Attachment")}async function Lh(t,e){try{const n=Ed(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{const n=document.createElement("a");n.href=t,n.download=e,n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),n.remove()}}function P_(){return{id:crypto.randomUUID(),role:"assistant",content:`Good ${QH()}, ready for a video critique?`,files:[],status:null}}function QH(){const t=new Date().getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function Ay(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Dc(t){return t?Ay(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">[Image: $1]</a>').replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/___(.+?)___/g,"<strong><em>$1</em></strong>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(?!INLINE_CODE_|CODE_BLOCK_)(.+?)__/g,"<strong>$1</strong>").replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>").replace(new RegExp("(?<!\\w)_(?!_)(.+?)(?<!_)_(?!\\w)","g"),"<em>$1</em>").replace(/~~(.+?)~~/g,"<del>$1</del>").replace(/==(.+?)==/g,'<mark class="chat-highlight">$1</mark>'):""}function XH(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(d,h,f)=>{const p=e.length;return e.push({lang:h||"",code:f.trim()}),`__CODE_BLOCK_${p}__`});const s=[];n=n.replace(/`([^`]+)`/g,(d,h)=>{const f=s.length;return s.push(h),`__INLINE_CODE_${f}__`});const r=n.split(`
`);let i=[],o=!1,a=!1,l=!1;for(let d=0;d<r.length;d++){let h=r[d];const f=h.match(/^__CODE_BLOCK_(\d+)__$/);if(f){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=e[parseInt(f[1],10)],m=g.lang?` class="language-${g.lang}"`:"";i.push(`<pre class="chat-code-block"><code${m}>${Ay(g.code)}</code></pre>`);continue}const p=h.match(/^(#{1,6})\s+(.*)$/);if(p){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=p[1].length,m=Dc(p[2]);i.push(`<h${g} class="chat-header chat-h${g}">${m}</h${g}>`);continue}if(/^[-*_]{3,}\s*$/.test(h)){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1),i.push('<hr class="chat-hr">');continue}const b=h.match(/^>\s*(.*)$/);if(b){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l||(i.push('<blockquote class="chat-blockquote">'),l=!0),i.push(Dc(b[1])+"<br>");continue}else l&&(i.push("</blockquote>"),l=!1);const x=h.match(/^(\s*)([-*])\s+(.*)$/);if(x){a&&(i.push("</ol>"),a=!1),o||(i.push('<ul class="chat-list">'),o=!0);const g=Dc(x[3]);i.push(`<li>${g}</li>`);continue}else o&&(i.push("</ul>"),o=!1);const y=h.match(/^(\s*)(\d+)\.\s+(.*)$/);if(y){o&&(i.push("</ul>"),o=!1),a||(i.push('<ol class="chat-numbered-list">'),a=!0);const g=Dc(y[3]);i.push(`<li>${g}</li>`);continue}else a&&(i.push("</ol>"),a=!1);if(h.trim()===""){i.push("<br>");continue}i.push(Dc(h)),d<r.length-1&&i.push("<br>")}o&&i.push("</ul>"),a&&i.push("</ol>"),l&&i.push("</blockquote>");let u=i.join("");return s.forEach((d,h)=>{u=u.replace(`__INLINE_CODE_${h}__`,`<code class="chat-inline-code">${Ay(d)}</code>`)}),u}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ud(t){return t+.5|0}const Ki=(t,e,n)=>Math.max(Math.min(t,n),e);function Jc(t){return Ki(Ud(t*2.55),0,255)}function ao(t){return Ki(Ud(t*255),0,255)}function Zr(t){return Ki(Ud(t/2.55)/100,0,1)}function R_(t){return Ki(Ud(t*100),0,100)}const Ms={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Oy=[..."0123456789ABCDEF"],JH=t=>Oy[t&15],ZH=t=>Oy[(t&240)>>4]+Oy[t&15],$h=t=>(t&240)>>4===(t&15),e8=t=>$h(t.r)&&$h(t.g)&&$h(t.b)&&$h(t.a);function t8(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Ms[t[1]]*17,g:255&Ms[t[2]]*17,b:255&Ms[t[3]]*17,a:e===5?Ms[t[4]]*17:255}:(e===7||e===9)&&(n={r:Ms[t[1]]<<4|Ms[t[2]],g:Ms[t[3]]<<4|Ms[t[4]],b:Ms[t[5]]<<4|Ms[t[6]],a:e===9?Ms[t[7]]<<4|Ms[t[8]]:255})),n}const n8=(t,e)=>t<255?e(t):"";function s8(t){var e=e8(t)?JH:ZH;return t?"#"+e(t.r)+e(t.g)+e(t.b)+n8(t.a,e):void 0}const r8=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function e2(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function i8(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function o8(t,e,n){const s=e2(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function a8(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function I0(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,u,d;return i!==o&&(d=i-o,u=a>.5?d/(2-i-o):d/(i+o),l=a8(n,s,r,d,i),l=l*60+.5),[l|0,u||0,a]}function M0(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(ao)}function D0(t,e,n){return M0(e2,t,e,n)}function l8(t,e,n){return M0(o8,t,e,n)}function c8(t,e,n){return M0(i8,t,e,n)}function t2(t){return(t%360+360)%360}function u8(t){const e=r8.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Jc(+e[5]):ao(+e[5]));const r=t2(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=l8(r,i,o):e[1]==="hsv"?s=c8(r,i,o):s=D0(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function d8(t,e){var n=I0(t);n[0]=t2(n[0]+e),n=D0(n),t.r=n[0],t.g=n[1],t.b=n[2]}function h8(t){if(!t)return;const e=I0(t),n=e[0],s=R_(e[1]),r=R_(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Zr(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const A_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},O_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function f8(){const t={},e=Object.keys(O_),n=Object.keys(A_);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,A_[i]);i=parseInt(O_[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Fh;function p8(t){Fh||(Fh=f8(),Fh.transparent=[0,0,0,0]);const e=Fh[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const m8=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function g8(t){const e=m8.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?Jc(o):Ki(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?Jc(s):Ki(s,0,255)),r=255&(e[4]?Jc(r):Ki(r,0,255)),i=255&(e[6]?Jc(i):Ki(i,0,255)),{r:s,g:r,b:i,a:n}}}function x8(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Zr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Ng=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Qa=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function y8(t,e,n){const s=Qa(Zr(t.r)),r=Qa(Zr(t.g)),i=Qa(Zr(t.b));return{r:ao(Ng(s+n*(Qa(Zr(e.r))-s))),g:ao(Ng(r+n*(Qa(Zr(e.g))-r))),b:ao(Ng(i+n*(Qa(Zr(e.b))-i))),a:t.a+n*(e.a-t.a)}}function zh(t,e,n){if(t){let s=I0(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=D0(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function n2(t,e){return t&&Object.assign(e||{},t)}function I_(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=ao(t[3]))):(e=n2(t,{r:0,g:0,b:0,a:1}),e.a=ao(e.a)),e}function v8(t){return t.charAt(0)==="r"?g8(t):u8(t)}class id{constructor(e){if(e instanceof id)return e;const n=typeof e;let s;n==="object"?s=I_(e):n==="string"&&(s=t8(e)||p8(e)||v8(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=n2(this._rgb);return e&&(e.a=Zr(e.a)),e}set rgb(e){this._rgb=I_(e)}rgbString(){return this._valid?x8(this._rgb):void 0}hexString(){return this._valid?s8(this._rgb):void 0}hslString(){return this._valid?h8(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,u=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-u,s.r=255&u*s.r+i*r.r+.5,s.g=255&u*s.g+i*r.g+.5,s.b=255&u*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=y8(this._rgb,e._rgb,n)),this}clone(){return new id(this.rgb)}alpha(e){return this._rgb.a=ao(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Ud(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return zh(this._rgb,2,e),this}darken(e){return zh(this._rgb,2,-e),this}saturate(e){return zh(this._rgb,1,e),this}desaturate(e){return zh(this._rgb,1,-e),this}rotate(e){return d8(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function qr(){}const b8=(()=>{let t=0;return()=>t++})();function wt(t){return t==null}function xn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function rt(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Ys(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function kr(t,e){return Ys(t)?t:e}function nt(t,e){return typeof t>"u"?e:t}const w8=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,s2=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Nt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function pt(t,e,n,s){let r,i,o;if(xn(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(rt(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function fp(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function pp(t){if(xn(t))return t.map(pp);if(rt(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=pp(t[n[r]]);return e}return t}function r2(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function k8(t,e,n,s){if(!r2(t))return;const r=e[t],i=n[t];rt(r)&&rt(i)?od(r,i,s):e[t]=pp(i)}function od(t,e,n){const s=xn(e)?e:[e],r=s.length;if(!rt(t))return t;n=n||{};const i=n.merger||k8;let o;for(let a=0;a<r;++a){if(o=s[a],!rt(o))continue;const l=Object.keys(o);for(let u=0,d=l.length;u<d;++u)i(l[u],t,o,n)}return t}function mu(t,e){return od(t,e,{merger:_8})}function _8(t,e,n){if(!r2(t))return;const s=e[t],r=n[t];rt(s)&&rt(r)?mu(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=pp(r))}const M_={"":t=>t,x:t=>t.x,y:t=>t.y};function S8(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function j8(t){const e=S8(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function ka(t,e){return(M_[e]||(M_[e]=j8(e)))(t)}function L0(t){return t.charAt(0).toUpperCase()+t.slice(1)}const ad=t=>typeof t<"u",xo=t=>typeof t=="function",D_=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function C8(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Et=Math.PI,sn=2*Et,mp=Number.POSITIVE_INFINITY,N8=Et/180,hn=Et/2,Io=Et/4,L_=Et*2/3,i2=Math.log10,lo=Math.sign;function kf(t,e,n){return Math.abs(t-e)<n}function $_(t){const e=Math.round(t);t=kf(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(i2(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function E8(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function T8(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function gp(t){return!T8(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function P8(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function R8(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function ai(t){return t*(Et/180)}function A8(t){return t*(180/Et)}function F_(t){if(!Ys(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function o2(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*Et&&(i+=sn),{angle:i,distance:r}}function O8(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Cr(t){return(t%sn+sn)%sn}function xp(t,e,n,s){const r=Cr(t),i=Cr(e),o=Cr(n),a=Cr(i-r),l=Cr(o-r),u=Cr(r-i),d=Cr(r-o);return r===i||r===o||s&&i===o||a>l&&u<d}function rs(t,e,n){return Math.max(e,Math.min(n,t))}function I8(t){return rs(t,-32768,32767)}function Qo(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function $0(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Iy=(t,e,n,s)=>$0(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),M8=(t,e,n)=>$0(t,n,s=>t[s][e]>=n);function D8(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const a2=["push","pop","shift","splice","unshift"];function L8(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),a2.forEach(n=>{const s="_onData"+L0(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function z_(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(a2.forEach(i=>{delete t[i]}),delete t._chartjs)}function l2(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const c2=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function u2(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,c2.call(window,()=>{s=!1,t.apply(e,n)}))}}function $8(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const d2=t=>t==="start"?"left":t==="end"?"right":"center",gs=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,F8=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,Bh=t=>t===0||t===1,B_=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*sn/n)),U_=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*sn/n)+1,gu={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*hn)+1,easeOutSine:t=>Math.sin(t*hn),easeInOutSine:t=>-.5*(Math.cos(Et*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Bh(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Bh(t)?t:B_(t,.075,.3),easeOutElastic:t=>Bh(t)?t:U_(t,.075,.3),easeInOutElastic(t){return Bh(t)?t:t<.5?.5*B_(t*2,.1125,.45):.5+.5*U_(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-gu.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?gu.easeInBounce(t*2)*.5:gu.easeOutBounce(t*2-1)*.5+.5};function h2(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function H_(t){return h2(t)?t:new id(t)}function Eg(t){return h2(t)?t:new id(t).saturate(.5).darken(.1).hexString()}const z8=["x","y","borderWidth","radius","tension"],B8=["color","borderColor","backgroundColor"];function U8(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:B8},numbers:{type:"number",properties:z8}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function H8(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const W_=new Map;function W8(t,e){e=e||{};const n=t+JSON.stringify(e);let s=W_.get(n);return s||(s=new Intl.NumberFormat(t,e),W_.set(n,s)),s}function F0(t,e,n){return W8(e,n).format(t)}const V8={values(t){return xn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),i=q8(t,n)}const o=i2(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),F0(t,s,l)}};function q8(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var f2={formatters:V8};function K8(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:f2.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const _a=Object.create(null),My=Object.create(null);function xu(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function Tg(t,e,n){return typeof e=="string"?od(xu(t,e),n):od(xu(t,""),e)}class G8{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Eg(r.backgroundColor),this.hoverBorderColor=(s,r)=>Eg(r.borderColor),this.hoverColor=(s,r)=>Eg(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Tg(this,e,n)}get(e){return xu(this,e)}describe(e,n){return Tg(My,e,n)}override(e,n){return Tg(_a,e,n)}route(e,n,s,r){const i=xu(this,e),o=xu(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],u=o[r];return rt(l)?Object.assign({},u,l):nt(l,u)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Zt=new G8({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[U8,H8,K8]);function Y8(t){return!t||wt(t.size)||wt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function V_(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function Mo(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function q_(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function K_(t,e,n,s){p2(t,e,n,s,null)}function p2(t,e,n,s,r){let i,o,a,l,u,d,h,f;const p=e.pointStyle,b=e.rotation,x=e.radius;let y=(b||0)*N8;if(p&&typeof p=="object"&&(i=p.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(y),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(x)||x<=0)){switch(t.beginPath(),p){default:r?t.ellipse(n,s,r/2,x,0,0,sn):t.arc(n,s,x,0,sn),t.closePath();break;case"triangle":d=r?r/2:x,t.moveTo(n+Math.sin(y)*d,s-Math.cos(y)*x),y+=L_,t.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*x),y+=L_,t.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*x),t.closePath();break;case"rectRounded":u=x*.516,l=x-u,o=Math.cos(y+Io)*l,h=Math.cos(y+Io)*(r?r/2-u:l),a=Math.sin(y+Io)*l,f=Math.sin(y+Io)*(r?r/2-u:l),t.arc(n-h,s-a,u,y-Et,y-hn),t.arc(n+f,s-o,u,y-hn,y),t.arc(n+h,s+a,u,y,y+hn),t.arc(n-f,s+o,u,y+hn,y+Et),t.closePath();break;case"rect":if(!b){l=Math.SQRT1_2*x,d=r?r/2:l,t.rect(n-d,s-l,2*d,2*l);break}y+=Io;case"rectRot":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+f,s-o),t.lineTo(n+h,s+a),t.lineTo(n-f,s+o),t.closePath();break;case"crossRot":y+=Io;case"cross":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"star":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o),y+=Io,h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"line":o=r?r/2:Math.cos(y)*x,a=Math.sin(y)*x,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(y)*(r?r/2:x),s+Math.sin(y)*x);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function m2(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function z0(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function B0(t){t.restore()}function Q8(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function X8(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,d=r.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,d),t.lineTo(a,d),t.stroke()}}function J8(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function yp(t,e,n,s,r,i={}){const o=xn(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,u;for(t.save(),t.font=r.string,Q8(t,i),l=0;l<o.length;++l)u=o[l],i.backdrop&&J8(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),wt(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(u,n,s,i.maxWidth)),t.fillText(u,n,s,i.maxWidth),X8(t,n,s,u,i),s+=Number(r.lineHeight);t.restore()}function vp(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*Et,Et,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,Et,hn,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,hn,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-hn,!0),t.lineTo(n+o.topLeft,s)}const Z8=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,eW=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function tW(t,e){const n=(""+t).match(Z8);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const nW=t=>+t||0;function U0(t,e){const n={},s=rt(e),r=s?Object.keys(e):e,i=rt(t)?s?o=>nt(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=nW(i(o));return n}function g2(t){return U0(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Rl(t){return U0(t,["topLeft","topRight","bottomLeft","bottomRight"])}function mr(t){const e=g2(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function is(t,e){t=t||{},e=e||Zt.font;let n=nt(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=nt(t.style,e.style);s&&!(""+s).match(eW)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:nt(t.family,e.family),lineHeight:tW(nt(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:nt(t.weight,e.weight),string:""};return r.string=Y8(r),r}function Uh(t,e,n,s){let r,i,o;for(r=0,i=t.length;r<i;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function sW(t,e,n){const{min:s,max:r}=t,i=s2(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function gc(t,e){return Object.assign(Object.create(t),e)}function H0(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=b2("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>H0([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return y2(a,l,()=>dW(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return Y_(a).includes(l)},ownKeys(a){return Y_(a)},set(a,l,u){const d=a._storage||(a._storage=r());return a[l]=d[l]=u,delete a._keys,!0}})}function sc(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:x2(t,s),setContext:i=>sc(t,i,n,s),override:i=>sc(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return y2(i,o,()=>iW(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function x2(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:xo(n)?n:()=>n,isIndexable:xo(s)?s:()=>s}}const rW=(t,e)=>t?t+L0(e):e,W0=(t,e)=>rt(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function y2(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function iW(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return xo(a)&&o.isScriptable(e)&&(a=oW(e,a,t,n)),xn(a)&&a.length&&(a=aW(e,a,t,o.isIndexable)),W0(e,a)&&(a=sc(a,r,i&&i[e],o)),a}function oW(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),W0(t,l)&&(l=V0(r._scopes,r,t,l)),l}function aW(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(rt(e[0])){const l=e,u=r._scopes.filter(d=>d!==l);e=[];for(const d of l){const h=V0(u,r,t,d);e.push(sc(h,i,o&&o[t],a))}}return e}function v2(t,e,n){return xo(t)?t(e,n):t}const lW=(t,e)=>t===!0?e:typeof t=="string"?ka(e,t):void 0;function cW(t,e,n,s,r){for(const i of e){const o=lW(n,i);if(o){t.add(o);const a=v2(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function V0(t,e,n,s){const r=e._rootScopes,i=v2(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=G_(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=G_(a,o,i,l,s),l===null)?!1:H0(Array.from(a),[""],r,i,()=>uW(e,n,s))}function G_(t,e,n,s,r){for(;n;)n=cW(t,e,n,s,r);return n}function uW(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return xn(r)&&rt(n)?n:r||{}}function dW(t,e,n,s){let r;for(const i of e)if(r=b2(rW(i,t),n),typeof r<"u")return W0(t,r)?V0(n,s,t,r):r}function b2(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function Y_(t){let e=t._keys;return e||(e=t._keys=hW(t._scopes)),e}function hW(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function q0(){return typeof window<"u"&&typeof document<"u"}function K0(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function bp(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const im=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function fW(t,e){return im(t).getPropertyValue(e)}const pW=["top","right","bottom","left"];function da(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=pW[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const mW=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function gW(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(mW(r,i,t.target))a=r,l=i;else{const u=e.getBoundingClientRect();a=s.clientX-u.left,l=s.clientY-u.top,o=!0}return{x:a,y:l,box:o}}function Bo(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=im(n),i=r.boxSizing==="border-box",o=da(r,"padding"),a=da(r,"border","width"),{x:l,y:u,box:d}=gW(t,n),h=o.left+(d&&a.left),f=o.top+(d&&a.top);let{width:p,height:b}=e;return i&&(p-=o.width+a.width,b-=o.height+a.height),{x:Math.round((l-h)/p*n.width/s),y:Math.round((u-f)/b*n.height/s)}}function xW(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&K0(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=im(i),l=da(a,"border","width"),u=da(a,"padding");e=o.width-u.width-l.width,n=o.height-u.height-l.height,s=bp(a.maxWidth,i,"clientWidth"),r=bp(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||mp,maxHeight:r||mp}}const Gi=t=>Math.round(t*10)/10;function yW(t,e,n,s){const r=im(t),i=da(r,"margin"),o=bp(r.maxWidth,t,"clientWidth")||mp,a=bp(r.maxHeight,t,"clientHeight")||mp,l=xW(t,e,n);let{width:u,height:d}=l;if(r.boxSizing==="content-box"){const f=da(r,"border","width"),p=da(r,"padding");u-=p.width+f.width,d-=p.height+f.height}return u=Math.max(0,u-i.width),d=Math.max(0,s?u/s:d-i.height),u=Gi(Math.min(u,o,l.maxWidth)),d=Gi(Math.min(d,a,l.maxHeight)),u&&!d&&(d=Gi(u/2)),(e!==void 0||n!==void 0)&&s&&l.height&&d>l.height&&(d=l.height,u=Gi(Math.floor(d*s))),{width:u,height:d}}function Q_(t,e,n){const s=e||1,r=Gi(t.height*s),i=Gi(t.width*s);t.height=Gi(t.height),t.width=Gi(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const vW=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};q0()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function X_(t,e){const n=fW(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const bW=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},wW=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Al(t,e,n){return t?bW(e,n):wW()}function w2(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function k2(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Hh(t,e,n){return t.options.clip?t[n]:e[n]}function kW(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Hh(n,e,"left"),right:Hh(n,e,"right"),top:Hh(s,e,"top"),bottom:Hh(s,e,"bottom")}:e}function _W(t,e){const n=e._clip;if(n.disabled)return!1;const s=kW(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class SW{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=c2.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Gr=new SW;const J_="transparent",jW={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=H_(t||J_),r=s.valid&&H_(e||J_);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class CW{constructor(e,n,s,r){const i=n[s];r=Uh([e.to,r,i,e.from]);const o=Uh([e.from,i,r]);this._active=!0,this._fn=e.fn||jW[e.type||typeof o],this._easing=gu[e.easing]||gu.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Uh([e.to,n,r,e.from]),this._from=Uh([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class _2{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!rt(e))return;const n=Object.keys(Zt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!rt(i))return;const o={};for(const a of n)o[a]=i[a];(xn(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=EW(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&NW(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const u=o[l];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,n));continue}const d=n[u];let h=i[u];const f=s.get(u);if(h)if(f&&h.active()){h.update(f,d,a);continue}else h.cancel();if(!f||!f.duration){e[u]=d;continue}i[u]=h=new CW(f,e,u,d),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Gr.add(this._chart,s),!0}}function NW(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function EW(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function Z_(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function TW(t,e,n){if(n===!1)return!1;const s=Z_(t,n),r=Z_(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function PW(t){let e,n,s,r;return rt(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function S2(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function eS(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,u;if(e===null)return;let d=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(d=!0,s.all)continue;break}u=t.values[l],Ys(u)&&(i||e===0||lo(e)===lo(u))&&(e+=u)}return!d&&!s.all?0:e}function RW(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,u,d;for(l=0,u=o.length;l<u;++l)d=o[l],a[l]={[r]:d,[i]:t[d]};return a}function Pg(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function AW(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function OW(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function IW(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function tS(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function nS(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,u=o.axis,d=AW(i,o,s),h=e.length;let f;for(let p=0;p<h;++p){const b=e[p],{[l]:x,[u]:y}=b,g=b._stacks||(b._stacks={});f=g[u]=IW(r,d,x),f[a]=y,f._top=tS(f,o,!0,s.type),f._bottom=tS(f,o,!1,s.type);const m=f._visualValues||(f._visualValues={});m[a]=y}}function Rg(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function MW(t,e){return gc(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function DW(t,e,n){return gc(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Lc(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const Ag=t=>t==="reset"||t==="none",sS=(t,e)=>e?t:Object.assign({},t),LW=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:S2(n,!0),values:null};class Ol{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Pg(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Lc(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,f,p,b)=>h==="x"?f:h==="r"?b:p,i=n.xAxisID=nt(s.xAxisID,Rg(e,"x")),o=n.yAxisID=nt(s.yAxisID,Rg(e,"y")),a=n.rAxisID=nt(s.rAxisID,Rg(e,"r")),l=n.indexAxis,u=n.iAxisID=r(l,i,o,a),d=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&z_(this._data,this),e._stacked&&Lc(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(rt(n)){const r=this._cachedMeta;this._data=RW(n,r)}else if(s!==n){if(s){z_(s,this);const r=this._cachedMeta;Lc(r),r._parsed=[]}n&&Object.isExtensible(n)&&L8(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=Pg(n.vScale,n),n.stack!==s.stack&&(r=!0,Lc(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(nS(this,n._parsed),n._stacked=Pg(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,u=e>0&&s._parsed[e-1],d,h,f;if(this._parsing===!1)s._parsed=r,s._sorted=!0,f=r;else{xn(r[e])?f=this.parseArrayData(s,r,e,n):rt(r[e])?f=this.parseObjectData(s,r,e,n):f=this.parsePrimitiveData(s,r,e,n);const p=()=>h[a]===null||u&&h[a]<u[a];for(d=0;d<n;++d)s._parsed[d+e]=h=f[d],l&&(p()&&(l=!1),u=h);s._sorted=l}o&&nS(this,f)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,u=i.getLabels(),d=i===o,h=new Array(r);let f,p,b;for(f=0,p=r;f<p;++f)b=f+s,h[f]={[a]:d||i.parse(u[b],b),[l]:o.parse(n[b],b)};return h}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,u,d,h;for(l=0,u=r;l<u;++l)d=l+s,h=n[d],a[l]={x:i.parse(h[0],d),y:o.parse(h[1],d)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=new Array(r);let d,h,f,p;for(d=0,h=r;d<h;++d)f=d+s,p=n[f],u[d]={x:i.parse(ka(p,a),f),y:o.parse(ka(p,l),f)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:S2(r,!0),values:n._stacks[e.axis]._visualValues};return eS(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=eS(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=LW(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=OW(a);let f,p;function b(){p=r[f];const x=p[a.axis];return!Ys(p[e.axis])||d>x||h<x}for(f=0;f<o&&!(!b()&&(this.updateRangeFromParsed(u,e,p,l),i));++f);if(i){for(f=o-1;f>=0;--f)if(!b()){this.updateRangeFromParsed(u,e,p,l);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],Ys(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=PW(nt(this.options.clip,TW(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(e,i,a,l),d=a;d<a+l;++d){const h=r[d];h.hidden||(h.active&&u?o.push(h):h.draw(e,i))}for(d=0;d<o.length;++d)o[d].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=DW(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=MW(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&ad(s);if(a)return sS(a,l);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],f=u.getOptionScopes(this.getDataset(),d),p=Object.keys(Zt.elements[e]),b=()=>this.getContext(s,r,n),x=u.resolveNamedOptions(f,p,b,h);return x.$shared&&(x.$shared=l,i[o]=Object.freeze(sS(x,l))),x}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,n),f=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(f,this.getContext(e,s,n))}const u=new _2(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Ag(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){Ag(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!Ag(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,u]of this._syncList)this[a](l,u);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=u=>{for(u.length+=n,a=u.length-1;a>=o;a--)u[a]=u[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Lc(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}$e(Ol,"defaults",{}),$e(Ol,"datasetElementType",null),$e(Ol,"dataElementType",null);function $W(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=l2(s.sort((r,i)=>r-i))}return t._cache.$bar}function FW(t){const e=t.iScale,n=$W(e,t.type);let s=e._length,r,i,o,a;const l=()=>{o===32767||o===-32768||(ad(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(r=0,i=n.length;r<i;++r)o=e.getPixelForValue(n[r]),l();for(a=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),l();return s}function zW(t,e,n,s){const r=n.barThickness;let i,o;return wt(r)?(i=e.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:e.pixels[t]-i/2}}function BW(t,e,n,s){const r=e.pixels,i=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const u=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:n.barPercentage,start:u}}function UW(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),o=Math.min(r,i),a=Math.max(r,i);let l=o,u=a;Math.abs(o)>Math.abs(a)&&(l=a,u=o),e[n.axis]=u,e._custom={barStart:l,barEnd:u,start:r,end:i,min:o,max:a}}function j2(t,e,n,s){return xn(t)?UW(t,e,n,s):e[n.axis]=n.parse(t,s),e}function rS(t,e,n,s){const r=t.iScale,i=t.vScale,o=r.getLabels(),a=r===i,l=[];let u,d,h,f;for(u=n,d=n+s;u<d;++u)f=e[u],h={},h[r.axis]=a||r.parse(o[u],u),l.push(j2(f,h,i,u));return l}function Og(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function HW(t,e,n){return t!==0?lo(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function WW(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function VW(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:u,bottom:d}=WW(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(i[iS(d,o,a,l)]=!0,r=u)),i[iS(r,o,a,l)]=!0,t.borderSkipped=i}function iS(t,e,n,s){return s?(t=qW(t,e,n),t=oS(t,n,e)):t=oS(t,e,n),t}function qW(t,e,n){return t===e?n:t===n?e:t}function oS(t,e,n){return t==="start"?e:t==="end"?n:t}function KW(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class _f extends Ol{parsePrimitiveData(e,n,s,r){return rS(e,n,s,r)}parseArrayData(e,n,s,r){return rS(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=i.axis==="x"?a:l,d=o.axis==="x"?a:l,h=[];let f,p,b,x;for(f=s,p=s+r;f<p;++f)x=n[f],b={},b[i.axis]=i.parse(ka(x,u),f),h.push(j2(ka(x,d),b,o,f));return h}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),o=i._custom,a=Og(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),u=a.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(n,r);for(let p=n;p<n+s;p++){const b=this.getParsed(p),x=i||wt(b[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),y=this._calculateBarIndexPixels(p,d),g=(b._stacks||{})[a.axis],m={horizontal:u,base:x.base,enableBorderRadius:!g||Og(b._custom)||o===g._top||o===g._bottom,x:u?x.head:y.center,y:u?y.center:x.head,height:u?y.size:Math.abs(x.size),width:u?Math.abs(x.size):y.size};f&&(m.options=h||this.resolveDataElementOptions(p,e[p].active?"active":r));const w=m.options||e[p].options;VW(m,w,g,o),KW(m,w,d.ratio),this.updateElement(e[p],p,m,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],u=d=>{const h=d._parsed.find(p=>p[s.axis]===l),f=h&&h[d.vScale.axis];if(wt(f)||isNaN(f))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((i===!1||o.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[nt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const a=e.barThickness;return{min:a||FW(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),u=l._custom,d=Og(u);let h=l[n.axis],f=0,p=s?this.applyStack(n,l,s):h,b,x;p!==h&&(f=p-h,p=h),d&&(h=u.barStart,p=u.barEnd-u.barStart,h!==0&&lo(h)!==lo(u.barEnd)&&(f=0),f+=h);const y=!wt(i)&&!d?i:f;let g=n.getPixelForValue(y);if(this.chart.getDataVisibility(e)?b=n.getPixelForValue(f+p):b=g,x=b-g,Math.abs(x)<o){x=HW(x,n,a)*o,h===a&&(g-=x/2);const m=n.getPixelForDecimal(0),w=n.getPixelForDecimal(1),k=Math.min(m,w),_=Math.max(m,w);g=Math.max(Math.min(g,_),k),b=g+x,s&&!d&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(b)-n.getValueForPixel(g))}if(g===n.getPixelForValue(a)){const m=lo(x)*n.getLineWidthForValue(a)/2;g+=m,x-=m}return{size:x,base:g,head:b,center:b+x/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,o=nt(r.maxBarThickness,1/0);let a,l;const u=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(e):n.stackCount,h=r.barThickness==="flex"?BW(e,n,r,d*u):zW(e,n,r,d*u),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(nt(f,this.getFirstScaleIdForIndexAxis())),b=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+p;a=h.start+h.chunk*b+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}$e(_f,"id","bar"),$e(_f,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),$e(_f,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function GW(t,e,n){let s=1,r=1,i=0,o=0;if(e<sn){const a=t,l=a+e,u=Math.cos(a),d=Math.sin(a),h=Math.cos(l),f=Math.sin(l),p=(w,k,_)=>xp(w,a,l,!0)?1:Math.max(k,k*n,_,_*n),b=(w,k,_)=>xp(w,a,l,!0)?-1:Math.min(k,k*n,_,_*n),x=p(0,u,h),y=p(hn,d,f),g=b(Et,u,h),m=b(Et+hn,d,f);s=(x-g)/2,r=(y-m)/2,i=-(x+g)/2,o=-(y+m)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class xl extends Ol{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(rt(s[e])){const{key:l="value"}=this._parsing;i=u=>+ka(s[u],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return ai(this.options.rotation-90)}_getCircumference(){return ai(this.options.circumference)}_getRotationExtents(){let e=sn,n=-sn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(w8(this.options.cutout,a),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:b,offsetY:x}=GW(h,d,l),y=(s.width-o)/f,g=(s.height-o)/p,m=Math.max(Math.min(y,g)/2,0),w=s2(this.options.radius,m),k=Math.max(w*l,0),_=(w-k)/this._getVisibleDatasetWeightTotal();this.offsetX=b*w,this.offsetY=x*w,r.total=this.calculateTotal(),this.outerRadius=w-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*u,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/sn)}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,u=o.options.animation,d=(a.left+a.right)/2,h=(a.top+a.bottom)/2,f=i&&u.animateScale,p=f?0:this.innerRadius,b=f?0:this.outerRadius,{sharedOptions:x,includeOptions:y}=this._getSharedOptions(n,r);let g=this._getRotation(),m;for(m=0;m<n;++m)g+=this._circumference(m,i);for(m=n;m<n+s;++m){const w=this._circumference(m,i),k=e[m],_={x:d+this.offsetX,y:h+this.offsetY,startAngle:g,endAngle:g+w,circumference:w,outerRadius:b,innerRadius:p};y&&(_.options=x||this.resolveDataElementOptions(m,k.active?"active":r)),g+=w,this.updateElement(k,m,_,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?sn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=F0(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,o,a,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(nt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}$e(xl,"id","doughnut"),$e(xl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),$e(xl,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),$e(xl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((l,u)=>{const h=e.getDatasetMeta(0).controller.getStyle(u);return{text:l,fillStyle:h.backgroundColor,fontColor:i,hidden:!e.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(a||h.borderRadius),index:u}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class Dy extends xl{}$e(Dy,"id","pie"),$e(Dy,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Do(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class G0{constructor(e){$e(this,"options");this.options=e||{}}static override(e){Object.assign(G0.prototype,e)}init(){}formats(){return Do()}parse(){return Do()}format(){return Do()}add(){return Do()}diff(){return Do()}startOf(){return Do()}endOf(){return Do()}}var YW={_date:G0};function QW(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const u=a._reversePixels?M8:Iy;if(s){if(r._sharedOptions){const d=i[0],h=typeof d.getRange=="function"&&d.getRange(e);if(h){const f=u(i,e,n-h),p=u(i,e,n+h);return{lo:f.lo,hi:p.hi}}}}else{const d=u(i,e,n);if(l){const{vScale:h}=r._cachedMeta,{_parsed:f}=t,p=f.slice(0,d.lo+1).reverse().findIndex(x=>!wt(x[h.axis]));d.lo-=Math.max(0,p);const b=f.slice(d.hi).findIndex(x=>!wt(x[h.axis]));d.hi+=Math.max(0,b)}return d}}return{lo:0,hi:i.length-1}}function om(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:u,data:d}=i[a],{lo:h,hi:f}=QW(i[a],e,o,r);for(let p=h;p<=f;++p){const b=d[p];b.skip||s(b,u,p)}}}function XW(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Ig(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||om(t,n,e,function(a,l,u){!r&&!m2(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:u})},!0),i}function JW(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],s),{angle:h}=o2(o,{x:e.x,y:e.y});xp(h,u,d)&&r.push({element:o,datasetIndex:a,index:l})}return om(t,n,e,i),r}function ZW(t,e,n,s,r,i){let o=[];const a=XW(n);let l=Number.POSITIVE_INFINITY;function u(d,h,f){const p=d.inRange(e.x,e.y,r);if(s&&!p)return;const b=d.getCenterPoint(r);if(!(!!i||t.isPointInArea(b))&&!p)return;const y=a(e,b);y<l?(o=[{element:d,datasetIndex:h,index:f}],l=y):y===l&&o.push({element:d,datasetIndex:h,index:f})}return om(t,n,e,u),o}function Mg(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?JW(t,e,n,r):ZW(t,e,n,s,r,i)}function aS(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return om(t,n,e,(l,u,d)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:u,index:d}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var eV={modes:{index(t,e,n,s){const r=Bo(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?Ig(t,r,i,s,o):Mg(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const d=a[0].index,h=u.data[d];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:d})}),l):[]},dataset(t,e,n,s){const r=Bo(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?Ig(t,r,i,s,o):Mg(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,u=t.getDatasetMeta(l).data;a=[];for(let d=0;d<u.length;++d)a.push({element:u[d],datasetIndex:l,index:d})}return a},point(t,e,n,s){const r=Bo(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Ig(t,r,i,s,o)},nearest(t,e,n,s){const r=Bo(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Mg(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=Bo(e,t);return aS(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Bo(e,t);return aS(t,r,"y",n.intersect,s)}}};const C2=["left","top","right","bottom"];function $c(t,e){return t.filter(n=>n.pos===e)}function lS(t,e){return t.filter(n=>C2.indexOf(n.pos)===-1&&n.box.axis===e)}function Fc(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function tV(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function nV(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!C2.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function sV(t,e){const n=nV(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,u=n[a.stack],d=u&&a.stackWeight/u.weight;a.horizontal?(a.width=d?d*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=d?d*r:l&&e.availableHeight)}return n}function rV(t){const e=tV(t),n=Fc(e.filter(u=>u.box.fullSize),!0),s=Fc($c(e,"left"),!0),r=Fc($c(e,"right")),i=Fc($c(e,"top"),!0),o=Fc($c(e,"bottom")),a=lS(e,"x"),l=lS(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:$c(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function cS(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function N2(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function iV(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!rt(r)){n.size&&(t[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,t[r]+=n.size}i.getPadding&&N2(o,i.getPadding());const a=Math.max(0,e.outerWidth-cS(o,t,"left","right")),l=Math.max(0,e.outerHeight-cS(o,t,"top","bottom")),u=a!==t.w,d=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:u,other:d}:{same:d,other:u}}function oV(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function aV(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function Zc(t,e,n,s){const r=[];let i,o,a,l,u,d;for(i=0,o=t.length,u=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,aV(a.horizontal,e));const{same:h,other:f}=iV(e,n,a,s);u|=h&&r.length,d=d||f,l.fullSize||r.push(a)}return u&&Zc(r,e,n,s)||d}function Wh(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function uS(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,u=s[a.stack]||{placed:0,weight:1},d=a.stackWeight/u.weight||1;if(a.horizontal){const h=e.w*d,f=u.size||l.height;ad(u.start)&&(o=u.start),l.fullSize?Wh(l,r.left,o,n.outerWidth-r.right-r.left,f):Wh(l,e.left+u.placed,o,h,f),u.start=o,u.placed+=h,o=l.bottom}else{const h=e.h*d,f=u.size||l.width;ad(u.start)&&(i=u.start),l.fullSize?Wh(l,i,r.top,f,n.outerHeight-r.bottom-r.top):Wh(l,i,e.top+u.placed,f,h),u.start=i,u.placed+=h,i=l.right}}e.x=i,e.y=o}var Yi={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=mr(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=rV(t.boxes),l=a.vertical,u=a.horizontal;pt(t.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const d=l.reduce((x,y)=>y.box.options&&y.box.options.display===!1?x:x+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/d,hBoxMaxHeight:o/2}),f=Object.assign({},r);N2(f,mr(s));const p=Object.assign({maxPadding:f,w:i,h:o,x:r.left,y:r.top},r),b=sV(l.concat(u),h);Zc(a.fullSize,p,h,b),Zc(l,p,h,b),Zc(u,p,h,b)&&Zc(l,p,h,b),oV(p),uS(a.leftAndTop,p,h,b),p.x+=p.w,p.y+=p.h,uS(a.rightAndBottom,p,h,b),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},pt(a.chartArea,x=>{const y=x.box;Object.assign(y,t.chartArea),y.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class E2{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class lV extends E2{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Sf="$chartjs",cV={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},dS=t=>t===null||t==="";function uV(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Sf]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",dS(r)){const i=X_(t,"width");i!==void 0&&(t.width=i)}if(dS(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=X_(t,"height");i!==void 0&&(t.height=i)}return t}const T2=vW?{passive:!0}:!1;function dV(t,e,n){t&&t.addEventListener(e,n,T2)}function hV(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,T2)}function fV(t,e){const n=cV[t.type]||t.type,{x:s,y:r}=Bo(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function wp(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function pV(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||wp(a.addedNodes,s),o=o&&!wp(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function mV(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||wp(a.removedNodes,s),o=o&&!wp(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const ld=new Map;let hS=0;function P2(){const t=window.devicePixelRatio;t!==hS&&(hS=t,ld.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function gV(t,e){ld.size||window.addEventListener("resize",P2),ld.set(t,e)}function xV(t){ld.delete(t),ld.size||window.removeEventListener("resize",P2)}function yV(t,e,n){const s=t.canvas,r=s&&K0(s);if(!r)return;const i=u2((a,l)=>{const u=r.clientWidth;n(a,l),u<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],u=l.contentRect.width,d=l.contentRect.height;u===0&&d===0||i(u,d)});return o.observe(r),gV(t,i),o}function Dg(t,e,n){n&&n.disconnect(),e==="resize"&&xV(t)}function vV(t,e,n){const s=t.canvas,r=u2(i=>{t.ctx!==null&&n(fV(i,t))},t);return dV(s,e,r),r}class bV extends E2{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(uV(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Sf])return!1;const s=n[Sf].initial;["height","width"].forEach(i=>{const o=s[i];wt(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[Sf],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:pV,detach:mV,resize:yV}[n]||vV;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Dg,detach:Dg,resize:Dg}[n]||hV)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return yW(e,n,s,r)}isAttached(e){const n=e&&K0(e);return!!(n&&n.isConnected)}}function wV(t){return!q0()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?lV:bV}var Jh;let xc=(Jh=class{constructor(){$e(this,"x");$e(this,"y");$e(this,"active",!1);$e(this,"options");$e(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return gp(this.x)&&gp(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},$e(Jh,"defaults",{}),$e(Jh,"defaultRoutes"),Jh);function kV(t,e){const n=t.options.ticks,s=_V(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?jV(e):[],o=i.length,a=i[0],l=i[o-1],u=[];if(o>r)return CV(e,u,i,o/r),u;const d=SV(i,e,r);if(o>0){let h,f;const p=o>1?Math.round((l-a)/(o-1)):null;for(Vh(e,u,d,wt(p)?0:a-p,a),h=0,f=o-1;h<f;h++)Vh(e,u,d,i[h],i[h+1]);return Vh(e,u,d,l,wt(p)?e.length:l+p),u}return Vh(e,u,d),u}function _V(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function SV(t,e,n){const s=NV(t),r=e.length/n;if(!s)return Math.max(r,1);const i=E8(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function jV(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function CV(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function Vh(t,e,n,s,r){const i=nt(s,0),o=Math.min(nt(r,t.length),t.length);let a=0,l,u,d;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),d=i;d<0;)a++,d=Math.round(i+a*n);for(u=Math.max(i,0);u<o;u++)u===d&&(e.push(t[u]),a++,d=Math.round(i+a*n))}function NV(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const EV=t=>t==="left"?"right":t==="right"?"left":t,fS=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,pS=(t,e)=>Math.min(e||t,t);function mS(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function TV(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(l-i,o-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(r-1))/2,l+=r<e?u:-u,l<i-a||l>o+a)))return l}function PV(t,e){pt(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function zc(t){return t.drawTicks?t.tickLength:0}function gS(t,e){if(!t.display)return 0;const n=is(t.font,e),s=mr(t.padding);return(xn(t.text)?t.text.length:1)*n.lineHeight+s.height}function RV(t,e){return gc(t,{scale:e,type:"scale"})}function AV(t,e,n){return gc(t,{tick:n,index:e,type:"tick"})}function OV(t,e,n){let s=d2(t);return(n&&e!=="right"||!n&&e==="right")&&(s=EV(s)),s}function IV(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:u,scales:d}=l;let h=0,f,p,b;const x=o-r,y=a-i;if(t.isHorizontal()){if(p=gs(s,i,a),rt(n)){const g=Object.keys(n)[0],m=n[g];b=d[g].getPixelForValue(m)+x-e}else n==="center"?b=(u.bottom+u.top)/2+x-e:b=fS(t,n,e);f=a-i}else{if(rt(n)){const g=Object.keys(n)[0],m=n[g];p=d[g].getPixelForValue(m)-y+e}else n==="center"?p=(u.left+u.right)/2-y+e:p=fS(t,n,e);b=gs(s,o,r),h=n==="left"?-hn:hn}return{titleX:p,titleY:b,maxWidth:f,rotation:h}}class yc extends xc{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=kr(e,Number.POSITIVE_INFINITY),n=kr(n,Number.NEGATIVE_INFINITY),s=kr(s,Number.POSITIVE_INFINITY),r=kr(r,Number.NEGATIVE_INFINITY),{min:kr(e,s),max:kr(n,r),minDefined:Ys(e),maxDefined:Ys(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,u=a.length;l<u;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:kr(n,kr(s,n)),max:kr(s,kr(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Nt(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=sW(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?mS(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=kV(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Nt(this.options.afterUpdate,[this])}beforeSetDimensions(){Nt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Nt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Nt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Nt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=Nt(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){Nt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Nt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=pS(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,u;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,f=d.highest.height,p=rs(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/s:p/(s-1),h+6>a&&(a=p/(s-(e.offset?.5:1)),l=this.maxHeight-zc(e.grid)-n.padding-gS(e.title,this.chart.options.font),u=Math.sqrt(h*h+f*f),o=A8(Math.min(Math.asin(rs((d.highest.height+6)/a,-1,1)),Math.asin(rs(l/u,-1,1))-Math.asin(rs(f/u,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Nt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Nt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=gS(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=zc(i)+l):(e.height=this.maxHeight,e.width=zc(i)+l),s.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:f}=this._getLabelSizes(),p=s.padding*2,b=ai(this.labelRotation),x=Math.cos(b),y=Math.sin(b);if(a){const g=s.mirror?0:y*h.width+x*f.height;e.height=Math.min(this.maxHeight,e.height+g+p)}else{const g=s.mirror?0:x*h.width+y*f.height;e.width=Math.min(this.maxWidth,e.width+g+p)}this._calculatePadding(u,d,y,x)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;l?u?(f=r*e.width,p=s*n.height):(f=s*e.height,p=r*n.width):i==="start"?p=n.width:i==="end"?f=e.width:i!=="inner"&&(f=e.width/2,p=n.width/2),this.paddingLeft=Math.max((f-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((p-h+o)*this.width/(this.width-h),0)}else{let d=n.height/2,h=e.height/2;i==="start"?(d=0,h=e.height):i==="end"&&(d=n.height,h=0),this.paddingTop=d+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Nt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)wt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=mS(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/pS(n,s));let u=0,d=0,h,f,p,b,x,y,g,m,w,k,_;for(h=0;h<n;h+=l){if(b=e[h].label,x=this._resolveTickFontOptions(h),r.font=y=x.string,g=i[y]=i[y]||{data:{},gc:[]},m=x.lineHeight,w=k=0,!wt(b)&&!xn(b))w=V_(r,g.data,g.gc,w,b),k=m;else if(xn(b))for(f=0,p=b.length;f<p;++f)_=b[f],!wt(_)&&!xn(_)&&(w=V_(r,g.data,g.gc,w,_),k+=m);o.push(w),a.push(k),u=Math.max(w,u),d=Math.max(k,d)}PV(i,n);const C=o.indexOf(u),S=a.indexOf(d),j=N=>({width:o[N]||0,height:a[N]||0});return{first:j(0),last:j(n-1),widest:j(C),highest:j(S),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return I8(this._alignToPixels?Mo(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=AV(this.getContext(),e,s))}return this.$context||(this.$context=RV(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=ai(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=zc(i),p=[],b=a.setContext(this.getContext()),x=b.display?b.width:0,y=x/2,g=function(U){return Mo(s,U,x)};let m,w,k,_,C,S,j,N,R,M,O,D;if(o==="top")m=g(this.bottom),S=this.bottom-f,N=m-y,M=g(e.top)+y,D=e.bottom;else if(o==="bottom")m=g(this.top),M=e.top,D=g(e.bottom)-y,S=m+y,N=this.top+f;else if(o==="left")m=g(this.right),C=this.right-f,j=m-y,R=g(e.left)+y,O=e.right;else if(o==="right")m=g(this.left),R=e.left,O=g(e.right)-y,C=m+y,j=this.left+f;else if(n==="x"){if(o==="center")m=g((e.top+e.bottom)/2+.5);else if(rt(o)){const U=Object.keys(o)[0],W=o[U];m=g(this.chart.scales[U].getPixelForValue(W))}M=e.top,D=e.bottom,S=m+y,N=S+f}else if(n==="y"){if(o==="center")m=g((e.left+e.right)/2);else if(rt(o)){const U=Object.keys(o)[0],W=o[U];m=g(this.chart.scales[U].getPixelForValue(W))}C=m-y,j=C-f,R=e.left,O=e.right}const $=nt(r.ticks.maxTicksLimit,h),L=Math.max(1,Math.ceil(h/$));for(w=0;w<h;w+=L){const U=this.getContext(w),W=i.setContext(U),E=a.setContext(U),P=W.lineWidth,A=W.color,F=E.dash||[],z=E.dashOffset,G=W.tickWidth,q=W.tickColor,B=W.tickBorderDash||[],Q=W.tickBorderDashOffset;k=TV(this,w,l),k!==void 0&&(_=Mo(s,k,P),u?C=j=R=O=_:S=N=M=D=_,p.push({tx1:C,ty1:S,tx2:j,ty2:N,x1:R,y1:M,x2:O,y2:D,width:P,color:A,borderDash:F,borderDashOffset:z,tickWidth:G,tickColor:q,tickBorderDash:B,tickBorderDashOffset:Q}))}return this._ticksLength=h,this._borderValue=m,p}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:u,padding:d,mirror:h}=i,f=zc(s.grid),p=f+d,b=h?-d:p,x=-ai(this.labelRotation),y=[];let g,m,w,k,_,C,S,j,N,R,M,O,D="middle";if(r==="top")C=this.bottom-b,S=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+b,S=this._getXAxisLabelAlignment();else if(r==="left"){const L=this._getYAxisLabelAlignment(f);S=L.textAlign,_=L.x}else if(r==="right"){const L=this._getYAxisLabelAlignment(f);S=L.textAlign,_=L.x}else if(n==="x"){if(r==="center")C=(e.top+e.bottom)/2+p;else if(rt(r)){const L=Object.keys(r)[0],U=r[L];C=this.chart.scales[L].getPixelForValue(U)+p}S=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")_=(e.left+e.right)/2-p;else if(rt(r)){const L=Object.keys(r)[0],U=r[L];_=this.chart.scales[L].getPixelForValue(U)}S=this._getYAxisLabelAlignment(f).textAlign}n==="y"&&(l==="start"?D="top":l==="end"&&(D="bottom"));const $=this._getLabelSizes();for(g=0,m=a.length;g<m;++g){w=a[g],k=w.label;const L=i.setContext(this.getContext(g));j=this.getPixelForTick(g)+i.labelOffset,N=this._resolveTickFontOptions(g),R=N.lineHeight,M=xn(k)?k.length:1;const U=M/2,W=L.color,E=L.textStrokeColor,P=L.textStrokeWidth;let A=S;o?(_=j,S==="inner"&&(g===m-1?A=this.options.reverse?"left":"right":g===0?A=this.options.reverse?"right":"left":A="center"),r==="top"?u==="near"||x!==0?O=-M*R+R/2:u==="center"?O=-$.highest.height/2-U*R+R:O=-$.highest.height+R/2:u==="near"||x!==0?O=R/2:u==="center"?O=$.highest.height/2-U*R:O=$.highest.height-M*R,h&&(O*=-1),x!==0&&!L.showLabelBackdrop&&(_+=R/2*Math.sin(x))):(C=j,O=(1-M)*R/2);let F;if(L.showLabelBackdrop){const z=mr(L.backdropPadding),G=$.heights[g],q=$.widths[g];let B=O-z.top,Q=0-z.left;switch(D){case"middle":B-=G/2;break;case"bottom":B-=G;break}switch(S){case"center":Q-=q/2;break;case"right":Q-=q;break;case"inner":g===m-1?Q-=q:g>0&&(Q-=q/2);break}F={left:Q,top:B,width:q+z.width,height:G+z.height,color:L.backdropColor}}y.push({label:k,font:N,textOffset:O,options:{rotation:x,color:W,strokeColor:E,strokeWidth:P,textAlign:A,textBaseline:D,translation:[_,C],backdrop:F}})}return y}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-ai(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let u,d;return n==="left"?r?(d=this.right+i,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d+=l)):(d=this.right-a,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+i,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d-=l)):(d=this.left+a,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,d,h,f;this.isHorizontal()?(u=Mo(e,this.left,o)-o/2,d=Mo(e,this.right,a)+a/2,h=f=l):(h=Mo(e,this.top,o)-o/2,f=Mo(e,this.bottom,a)+a/2,u=d=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,h),n.lineTo(d,f),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&z0(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,u=o.label,d=o.textOffset;yp(s,u,0,d,l,a)}r&&B0(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=is(s.font),o=mr(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||rt(n)?(l+=o.bottom,xn(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:u,titleY:d,maxWidth:h,rotation:f}=IV(this,l,n,a);yp(e,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:f,textAlign:OV(a,n,r),textBaseline:"middle",translation:[u,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=nt(e.grid&&e.grid.z,-1),r=nt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==yc.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return is(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class qh{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;LV(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,MV(e,o,s),this.override&&Zt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in Zt[r]&&(delete Zt[r][s],this.override&&delete _a[s])}}function MV(t,e,n){const s=od(Object.create(null),[n?Zt.get(n):{},Zt.get(e),t.defaults]);Zt.set(e,s),t.defaultRoutes&&DV(e,t.defaultRoutes),t.descriptors&&Zt.describe(e,t.descriptors)}function DV(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Zt.route(i,r,l,a)})}function LV(t){return"id"in t&&"defaults"in t}class $V{constructor(){this.controllers=new qh(Ol,"datasets",!0),this.elements=new qh(xc,"elements"),this.plugins=new qh(Object,"plugins"),this.scales=new qh(yc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):pt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=L0(e);Nt(s["before"+r],[],s),n[e](s),Nt(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var jr=new $V;class FV{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(Nt(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){wt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=nt(s.options&&s.options.plugins,{}),i=zV(s);return r===!1&&!n?[]:UV(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function zV(t){const e={},n=[],s=Object.keys(jr.plugins.items);for(let i=0;i<s.length;i++)n.push(jr.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function BV(t,e){return!e&&t===!1?null:t===!0?{}:t}function UV(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,u=BV(s[l],r);u!==null&&i.push({plugin:a,options:HV(t.config,{plugin:a,local:n[l]},u,o)})}return i}function HV(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ly(t,e){const n=Zt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function WV(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function VV(t,e){return t===e?"_index_":"_value_"}function xS(t){if(t==="x"||t==="y"||t==="r")return t}function qV(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function $y(t,...e){if(xS(t))return t;for(const n of e){const s=n.axis||qV(n.position)||t.length>1&&xS(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function yS(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function KV(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return yS(t,"x",n[0])||yS(t,"y",n[0])}return{}}function GV(t,e){const n=_a[t.type]||{scales:{}},s=e.scales||{},r=Ly(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!rt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=$y(o,a,KV(o,t),Zt.scales[a.type]),u=VV(l,r),d=n.scales||{};i[o]=mu(Object.create(null),[{axis:l},a,d[l],d[u]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||Ly(a,e),d=(_a[a]||{}).scales||{};Object.keys(d).forEach(h=>{const f=WV(h,l),p=o[f+"AxisID"]||f;i[p]=i[p]||Object.create(null),mu(i[p],[{axis:f},s[p],d[h]])})}),Object.keys(i).forEach(o=>{const a=i[o];mu(a,[Zt.scales[a.type],Zt.scale])}),i}function R2(t){const e=t.options||(t.options={});e.plugins=nt(e.plugins,{}),e.scales=GV(t,e)}function A2(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function YV(t){return t=t||{},t.data=A2(t.data),R2(t),t}const vS=new Map,O2=new Set;function Kh(t,e){let n=vS.get(t);return n||(n=e(),vS.set(t,n),O2.add(n)),n}const Bc=(t,e,n)=>{const s=ka(e,n);s!==void 0&&t.add(s)};class QV{constructor(e){this._config=YV(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=A2(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),R2(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Kh(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Kh(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Kh(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Kh(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(d=>{e&&(l.add(e),d.forEach(h=>Bc(l,e,h))),d.forEach(h=>Bc(l,r,h)),d.forEach(h=>Bc(l,_a[i]||{},h)),d.forEach(h=>Bc(l,Zt,h)),d.forEach(h=>Bc(l,My,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),O2.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,_a[n]||{},Zt.datasets[n]||{},{type:n},Zt,My]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=bS(this._resolverCache,e,r);let l=o;if(JV(o,n)){i.$shared=!1,s=xo(s)?s():s;const u=this.createResolver(e,s,a);l=sc(o,s,u)}for(const u of n)i[u]=l[u];return i}createResolver(e,n,s=[""],r){const{resolver:i}=bS(this._resolverCache,e,s);return rt(n)?sc(i,n,void 0,r):i}}function bS(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:H0(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const XV=t=>rt(t)&&Object.getOwnPropertyNames(t).some(e=>xo(t[e]));function JV(t,e){const{isScriptable:n,isIndexable:s}=x2(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(xo(a)||XV(a))||o&&xn(a))return!0}return!1}var ZV="4.5.1";const eq=["top","bottom","left","right","chartArea"];function wS(t,e){return t==="top"||t==="bottom"||eq.indexOf(t)===-1&&e==="x"}function kS(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function _S(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Nt(n&&n.onComplete,[t],e)}function tq(t){const e=t.chart,n=e.options.animation;Nt(n&&n.onProgress,[t],e)}function I2(t){return q0()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const jf={},SS=t=>{const e=I2(t);return Object.values(jf).filter(n=>n.canvas===e).pop()};function nq(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function sq(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}class Rr{static register(...e){jr.add(...e),jS()}static unregister(...e){jr.remove(...e),jS()}constructor(e,n){const s=this.config=new QV(n),r=I2(e),i=SS(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||wV(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,u=l&&l.height,d=l&&l.width;if(this.id=b8(),this.ctx=a,this.canvas=l,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new FV,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=$8(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],jf[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Gr.listen(this,"complete",_S),Gr.listen(this,"progress",tq),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return wt(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return jr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Q_(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return q_(this.canvas,this.ctx),this}stop(){return Gr.stop(this),this}resize(e,n){Gr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Q_(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Nt(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};pt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=$y(o,a),u=l==="r",d=l==="x";return{options:a,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),pt(i,o=>{const a=o.options,l=a.id,u=$y(l,a),d=nt(a.type,o.dtype);(a.position===void 0||wS(a.position,u)!==wS(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in s&&s[l].type===d)h=s[l];else{const f=jr.getScale(d);h=new f({id:l,type:d,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(a,e)}),pt(r,(o,a)=>{o||delete s[a]}),pt(s,o=>{Yi.configure(this,o,o.options),Yi.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(kS("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||Ly(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=jr.getController(a),{datasetElementType:u,dataElementType:d}=Zt.datasets[a];Object.assign(l,{dataElementType:jr.getElement(d),datasetElementType:u&&jr.getElement(u)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){pt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),f=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(f),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||pt(i,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(kS("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){pt(this.scales,e=>{Yi.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!D_(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;nq(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!D_(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Yi.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],pt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,xo(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Gr.has(this)?this.attached&&!Gr.running(this)&&Gr.start(this):(this.draw(),_S({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=_W(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&z0(n,r),e.controller.draw(),r&&B0(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return m2(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=eV.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=gc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);ad(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Gr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),q_(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete jf[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};pt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,u)=>{n.addEventListener(this,l,u),e[l]=u},r=(l,u)=>{e[l]&&(n.removeEventListener(this,l,u),delete e[l])},i=(l,u)=>{this.canvas&&this.resize(l,u)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){pt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},pt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!fp(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,u)=>l.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=C8(e),u=sq(e,this._lastEvent,s,l);s&&(this._lastEvent=null,Nt(i.onHover,[e,a,this],this),l&&Nt(i.onClick,[e,a,this],this));const d=!fp(a,r);return(d||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=u,d}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}$e(Rr,"defaults",Zt),$e(Rr,"instances",jf),$e(Rr,"overrides",_a),$e(Rr,"registry",jr),$e(Rr,"version",ZV),$e(Rr,"getChart",SS);function jS(){return pt(Rr.instances,t=>t._plugins.invalidate())}function rq(t,e,n){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:u,borderJoinStyle:d}=l,h=Math.min(u/o,Cr(s-n));if(t.beginPath(),t.arc(r,i,o-u/2,s+h/2,n-h/2),a>0){const f=Math.min(u/a,Cr(s-n));t.arc(r,i,a+u/2,n-f/2,s+f/2,!0)}else{const f=Math.min(u/2,o*Cr(s-n));if(d==="round")t.arc(r,i,f,n-Et/2,s+Et/2,!0);else if(d==="bevel"){const p=2*f*f,b=-p*Math.cos(n+Et/2)+r,x=-p*Math.sin(n+Et/2)+i,y=p*Math.cos(s+Et/2)+r,g=p*Math.sin(s+Et/2)+i;t.lineTo(b,x),t.lineTo(y,g)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function iq(t,e,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:a,innerRadius:l}=e;let u=r/a;t.beginPath(),t.arc(i,o,a,s-u,n+u),l>r?(u=r/l,t.arc(i,o,l,n+u,s-u,!0)):t.arc(i,o,r,n+hn,s-hn),t.closePath(),t.clip()}function oq(t){return U0(t,["outerStart","outerEnd","innerStart","innerEnd"])}function aq(t,e,n,s){const r=oq(t.options.borderRadius),i=(n-e)/2,o=Math.min(i,s*e/2),a=l=>{const u=(n-Math.min(i,l))*s/2;return rs(l,0,Math.min(i,u))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:rs(r.innerStart,0,o),innerEnd:rs(r.innerEnd,0,o)}}function Xa(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function kp(t,e,n,s,r,i){const{x:o,y:a,startAngle:l,pixelMargin:u,innerRadius:d}=e,h=Math.max(e.outerRadius+s+n-u,0),f=d>0?d+s+n+u:0;let p=0;const b=r-l;if(s){const L=d>0?d-s:0,U=h>0?h-s:0,W=(L+U)/2,E=W!==0?b*W/(W+s):b;p=(b-E)/2}const x=Math.max(.001,b*h-n/Et)/h,y=(b-x)/2,g=l+y+p,m=r-y-p,{outerStart:w,outerEnd:k,innerStart:_,innerEnd:C}=aq(e,f,h,m-g),S=h-w,j=h-k,N=g+w/S,R=m-k/j,M=f+_,O=f+C,D=g+_/M,$=m-C/O;if(t.beginPath(),i){const L=(N+R)/2;if(t.arc(o,a,h,N,L),t.arc(o,a,h,L,R),k>0){const P=Xa(j,R,o,a);t.arc(P.x,P.y,k,R,m+hn)}const U=Xa(O,m,o,a);if(t.lineTo(U.x,U.y),C>0){const P=Xa(O,$,o,a);t.arc(P.x,P.y,C,m+hn,$+Math.PI)}const W=(m-C/f+(g+_/f))/2;if(t.arc(o,a,f,m-C/f,W,!0),t.arc(o,a,f,W,g+_/f,!0),_>0){const P=Xa(M,D,o,a);t.arc(P.x,P.y,_,D+Math.PI,g-hn)}const E=Xa(S,g,o,a);if(t.lineTo(E.x,E.y),w>0){const P=Xa(S,N,o,a);t.arc(P.x,P.y,w,g-hn,N)}}else{t.moveTo(o,a);const L=Math.cos(N)*h+o,U=Math.sin(N)*h+a;t.lineTo(L,U);const W=Math.cos(R)*h+o,E=Math.sin(R)*h+a;t.lineTo(W,E)}t.closePath()}function lq(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){kp(t,e,n,s,l,r);for(let u=0;u<i;++u)t.fill();isNaN(a)||(l=o+(a%sn||sn))}return kp(t,e,n,s,l,r),t.fill(),l}function cq(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:f,borderRadius:p}=l,b=l.borderAlign==="inner";if(!u)return;t.setLineDash(h||[]),t.lineDashOffset=f,b?(t.lineWidth=u*2,t.lineJoin=d||"round"):(t.lineWidth=u,t.lineJoin=d||"bevel");let x=e.endAngle;if(i){kp(t,e,n,s,x,r);for(let y=0;y<i;++y)t.stroke();isNaN(a)||(x=o+(a%sn||sn))}b&&iq(t,e,x),l.selfJoin&&x-o>=Et&&p===0&&d!=="miter"&&rq(t,e,x),i||(kp(t,e,n,s,x,r),t.stroke())}class eu extends xc{constructor(n){super();$e(this,"circumference");$e(this,"endAngle");$e(this,"fullCircles");$e(this,"innerRadius");$e(this,"outerRadius");$e(this,"pixelMargin");$e(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:a}=o2(i,{x:n,y:s}),{startAngle:l,endAngle:u,innerRadius:d,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),p=(this.options.spacing+this.options.borderWidth)/2,b=nt(f,u-l),x=xp(o,l,u)&&l!==u,y=b>=sn||x,g=Qo(a,d+p,h+p);return y&&g}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:u,spacing:d}=this.options,h=(i+o)/2,f=(a+l+d+u)/2;return{x:s+Math.cos(h)*f,y:r+Math.sin(h)*f}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>sn?Math.floor(r/sn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const u=1-Math.sin(Math.min(Et,r||0)),d=i*u;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,lq(n,this,d,o,a),cq(n,this,d,o,a),n.restore()}}$e(eu,"id","arc"),$e(eu,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),$e(eu,"defaultRoutes",{backgroundColor:"backgroundColor"}),$e(eu,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function M2(t,e){const{x:n,y:s,base:r,width:i,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,u,d,h;return t.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),u=s-h,d=s+h):(h=i/2,a=n-h,l=n+h,u=Math.min(s,r),d=Math.max(s,r)),{left:a,top:u,right:l,bottom:d}}function Qi(t,e,n,s){return t?0:rs(e,n,s)}function uq(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=g2(s);return{t:Qi(r.top,i.top,0,n),r:Qi(r.right,i.right,0,e),b:Qi(r.bottom,i.bottom,0,n),l:Qi(r.left,i.left,0,e)}}function dq(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=Rl(r),o=Math.min(e,n),a=t.borderSkipped,l=s||rt(r);return{topLeft:Qi(!l||a.top||a.left,i.topLeft,0,o),topRight:Qi(!l||a.top||a.right,i.topRight,0,o),bottomLeft:Qi(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:Qi(!l||a.bottom||a.right,i.bottomRight,0,o)}}function hq(t){const e=M2(t),n=e.right-e.left,s=e.bottom-e.top,r=uq(t,n/2,s/2),i=dq(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function Lg(t,e,n,s){const r=e===null,i=n===null,a=t&&!(r&&i)&&M2(t,s);return a&&(r||Qo(e,a.left,a.right))&&(i||Qo(n,a.top,a.bottom))}function fq(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function pq(t,e){t.rect(e.x,e.y,e.w,e.h)}function $g(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+o,radius:t.radius}}class Cf extends xc{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=hq(this),a=fq(o.radius)?vp:pq;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,$g(o,n,i)),e.clip(),a(e,$g(i,-n,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),a(e,$g(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Lg(this,e,n,s)}inXRange(e,n){return Lg(this,e,null,n)}inYRange(e,n){return Lg(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}$e(Cf,"id","bar"),$e(Cf,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),$e(Cf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const CS=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},mq=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class NS extends xc{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Nt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=is(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=CS(s,i);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,i,a,l)+10):(d=this.maxHeight,u=this._fitCols(o,r,a,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+a;let h=e;i.textAlign="left",i.textBaseline="middle";let f=-1,p=-d;return this.legendItems.forEach((b,x)=>{const y=s+n/2+i.measureText(b.text).width;(x===0||u[u.length-1]+y+2*a>o)&&(h+=d,u[u.length-(x>0?0:1)]=0,p+=d,f++),l[x]={left:0,top:p,row:f,width:y,height:r},u[u.length-1]+=y+a}),h}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-e;let h=a,f=0,p=0,b=0,x=0;return this.legendItems.forEach((y,g)=>{const{itemWidth:m,itemHeight:w}=gq(s,n,i,y,r);g>0&&p+w+2*a>d&&(h+=f+a,u.push({width:f,height:p}),b+=f+a,x++,f=p=0),l[g]={left:b,top:p,col:x,width:m,height:w},f=Math.max(f,m),p+=w+a}),h+=f,u.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=Al(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=gs(s,this.left+r,this.right-this.lineWidths[a]);for(const u of n)a!==u.row&&(a=u.row,l=gs(s,this.left+r,this.right-this.lineWidths[a])),u.top+=this.top+e+r,u.left=o.leftForLtr(o.x(l),u.width),l+=u.width+r}else{let a=0,l=gs(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const u of n)u.col!==a&&(a=u.col,l=gs(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),u.top=l,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),l+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;z0(e,this),this._draw(),B0(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=Zt.color,l=Al(e.rtl,this.left,this.width),u=is(o.font),{padding:d}=o,h=u.size,f=h/2;let p;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:b,boxHeight:x,itemHeight:y}=CS(o,h),g=function(C,S,j){if(isNaN(b)||b<=0||isNaN(x)||x<0)return;r.save();const N=nt(j.lineWidth,1);if(r.fillStyle=nt(j.fillStyle,a),r.lineCap=nt(j.lineCap,"butt"),r.lineDashOffset=nt(j.lineDashOffset,0),r.lineJoin=nt(j.lineJoin,"miter"),r.lineWidth=N,r.strokeStyle=nt(j.strokeStyle,a),r.setLineDash(nt(j.lineDash,[])),o.usePointStyle){const R={radius:x*Math.SQRT2/2,pointStyle:j.pointStyle,rotation:j.rotation,borderWidth:N},M=l.xPlus(C,b/2),O=S+f;p2(r,R,M,O,o.pointStyleWidth&&b)}else{const R=S+Math.max((h-x)/2,0),M=l.leftForLtr(C,b),O=Rl(j.borderRadius);r.beginPath(),Object.values(O).some(D=>D!==0)?vp(r,{x:M,y:R,w:b,h:x,radius:O}):r.rect(M,R,b,x),r.fill(),N!==0&&r.stroke()}r.restore()},m=function(C,S,j){yp(r,j.text,C,S+y/2,u,{strikethrough:j.hidden,textAlign:l.textAlign(j.textAlign)})},w=this.isHorizontal(),k=this._computeTitleHeight();w?p={x:gs(i,this.left+d,this.right-s[0]),y:this.top+d+k,line:0}:p={x:this.left+d,y:gs(i,this.top+k+d,this.bottom-n[0].height),line:0},w2(this.ctx,e.textDirection);const _=y+d;this.legendItems.forEach((C,S)=>{r.strokeStyle=C.fontColor,r.fillStyle=C.fontColor;const j=r.measureText(C.text).width,N=l.textAlign(C.textAlign||(C.textAlign=o.textAlign)),R=b+f+j;let M=p.x,O=p.y;l.setWidth(this.width),w?S>0&&M+R+d>this.right&&(O=p.y+=_,p.line++,M=p.x=gs(i,this.left+d,this.right-s[p.line])):S>0&&O+_>this.bottom&&(M=p.x=M+n[p.line].width+d,p.line++,O=p.y=gs(i,this.top+k+d,this.bottom-n[p.line].height));const D=l.x(M);if(g(D,O,C),M=F8(N,M+b+f,w?M+R:this.right,e.rtl),m(l.x(M),O,C),w)p.x+=R+d;else if(typeof C.text!="string"){const $=u.lineHeight;p.y+=D2(C,$)+d}else p.y+=_}),k2(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=is(n.font),r=mr(n.padding);if(!n.display)return;const i=Al(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,u=r.top+l;let d,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),d=this.top+u,h=gs(e.align,h,this.right-f);else{const b=this.columnSizes.reduce((x,y)=>Math.max(x,y.height),0);d=u+gs(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const p=gs(a,h,h+f);o.textAlign=i.textAlign(d2(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,yp(o,n.text,p,d,s)}_computeTitleHeight(){const e=this.options.title,n=is(e.font),s=mr(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(Qo(e,this.left,this.right)&&Qo(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],Qo(e,r.left,r.left+r.width)&&Qo(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!vq(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=mq(r,s);r&&!i&&Nt(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&Nt(n.onHover,[e,s,this],this)}else s&&Nt(n.onClick,[e,s,this],this)}}function gq(t,e,n,s,r){const i=xq(s,t,e,n),o=yq(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function xq(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function yq(t,e,n){let s=t;return typeof e.text!="string"&&(s=D2(e,n)),s}function D2(t,e){const n=t.text?t.text.length:0;return e*n}function vq(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var bq={id:"legend",_element:NS,start(t,e,n){const s=t.legend=new NS({ctx:t.ctx,options:n,chart:t});Yi.configure(t,s,n),Yi.addBox(t,s)},stop(t){Yi.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Yi.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(n?0:void 0),d=mr(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const tu={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),d=O8(e,u);d<r&&(r=d,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function _r(t,e){return e&&(xn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Yr(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function wq(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function ES(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=is(e.bodyFont),u=is(e.titleFont),d=is(e.footerFont),h=i.length,f=r.length,p=s.length,b=mr(e.padding);let x=b.height,y=0,g=s.reduce((k,_)=>k+_.before.length+_.lines.length+_.after.length,0);if(g+=t.beforeBody.length+t.afterBody.length,h&&(x+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),g){const k=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;x+=p*k+(g-p)*l.lineHeight+(g-1)*e.bodySpacing}f&&(x+=e.footerMarginTop+f*d.lineHeight+(f-1)*e.footerSpacing);let m=0;const w=function(k){y=Math.max(y,n.measureText(k).width+m)};return n.save(),n.font=u.string,pt(t.title,w),n.font=l.string,pt(t.beforeBody.concat(t.afterBody),w),m=e.displayColors?o+2+e.boxPadding:0,pt(s,k=>{pt(k.before,w),pt(k.lines,w),pt(k.after,w)}),m=0,n.font=d.string,pt(t.footer,w),n.restore(),y+=b.width,{width:y,height:x}}function kq(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function _q(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function Sq(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let u="center";return s==="center"?u=r<=(a+l)/2?"left":"right":r<=i/2?u="left":r>=o-i/2&&(u="right"),_q(u,t,e,n)&&(u="center"),u}function TS(t,e,n){const s=n.yAlign||e.yAlign||kq(t,n);return{xAlign:n.xAlign||e.xAlign||Sq(t,e,n,s),yAlign:s}}function jq(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function Cq(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function PS(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,u=r+i,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Rl(o);let b=jq(e,a);const x=Cq(e,l,u);return l==="center"?a==="left"?b+=u:a==="right"&&(b-=u):a==="left"?b-=Math.max(d,f)+r:a==="right"&&(b+=Math.max(h,p)+r),{x:rs(b,0,s.width-e.width),y:rs(x,0,s.height-e.height)}}function Gh(t,e,n){const s=mr(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function RS(t){return _r([],Yr(t))}function Nq(t,e,n){return gc(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function AS(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const L2={beforeTitle:qr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:qr,beforeBody:qr,beforeLabel:qr,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return wt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:qr,afterBody:qr,beforeFooter:qr,footer:qr,afterFooter:qr};function Qn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?L2[e].call(n,s):r}class Fy extends xc{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new _2(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=Nq(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=Qn(s,"beforeTitle",this,e),i=Qn(s,"title",this,e),o=Qn(s,"afterTitle",this,e);let a=[];return a=_r(a,Yr(r)),a=_r(a,Yr(i)),a=_r(a,Yr(o)),a}getBeforeBody(e,n){return RS(Qn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return pt(e,i=>{const o={before:[],lines:[],after:[]},a=AS(s,i);_r(o.before,Yr(Qn(a,"beforeLabel",this,i))),_r(o.lines,Qn(a,"label",this,i)),_r(o.after,Yr(Qn(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return RS(Qn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=Qn(s,"beforeFooter",this,e),i=Qn(s,"footer",this,e),o=Qn(s,"afterFooter",this,e);let a=[];return a=_r(a,Yr(r)),a=_r(a,Yr(i)),a=_r(a,Yr(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,u;for(l=0,u=n.length;l<u;++l)a.push(wq(this.chart,n[l]));return e.filter&&(a=a.filter((d,h,f)=>e.filter(d,h,f,s))),e.itemSort&&(a=a.sort((d,h)=>e.itemSort(d,h,s))),pt(a,d=>{const h=AS(e.callbacks,d);r.push(Qn(h,"labelColor",this,d)),i.push(Qn(h,"labelPointStyle",this,d)),o.push(Qn(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=tu[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=ES(this,s),u=Object.assign({},a,l),d=TS(this.chart,s,u),h=PS(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:h}=Rl(a),{x:f,y:p}=e,{width:b,height:x}=n;let y,g,m,w,k,_;return i==="center"?(k=p+x/2,r==="left"?(y=f,g=y-o,w=k+o,_=k-o):(y=f+b,g=y+o,w=k-o,_=k+o),m=y):(r==="left"?g=f+Math.max(l,d)+o:r==="right"?g=f+b-Math.max(u,h)-o:g=this.caretX,i==="top"?(w=p,k=w-o,y=g-o,m=g+o):(w=p+x,k=w+o,y=g+o,m=g-o),_=w),{x1:y,x2:g,x3:m,y1:w,y2:k,y3:_}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const u=Al(s.rtl,this.x,this.width);for(e.x=Gh(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",o=is(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:u}=i,d=is(i.bodyFont),h=Gh(this,"left",i),f=r.x(h),p=l<d.lineHeight?(d.lineHeight-l)/2:0,b=n.y+p;if(i.usePointStyle){const x={radius:Math.min(u,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},y=r.leftForLtr(f,u)+u/2,g=b+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,K_(e,x,y,g),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,K_(e,x,y,g)}else{e.lineWidth=rt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=r.leftForLtr(f,u),y=r.leftForLtr(r.xPlus(f,1),u-2),g=Rl(o.borderRadius);Object.values(g).some(m=>m!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,vp(e,{x,y:b,w:u,h:l,radius:g}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),vp(e,{x:y,y:b+1,w:u-2,h:l-2,radius:g}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(x,b,u,l),e.strokeRect(x,b,u,l),e.fillStyle=o.backgroundColor,e.fillRect(y,b+1,u-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:u,boxPadding:d}=s,h=is(s.bodyFont);let f=h.lineHeight,p=0;const b=Al(s.rtl,this.x,this.width),x=function(j){n.fillText(j,b.x(e.x+p),e.y+f/2),e.y+=f+i},y=b.textAlign(o);let g,m,w,k,_,C,S;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,e.x=Gh(this,y,s),n.fillStyle=s.bodyColor,pt(this.beforeBody,x),p=a&&y!=="right"?o==="center"?u/2+d:u+2+d:0,k=0,C=r.length;k<C;++k){for(g=r[k],m=this.labelTextColors[k],n.fillStyle=m,pt(g.before,x),w=g.lines,a&&w.length&&(this._drawColorBox(n,e,k,b,s),f=Math.max(h.lineHeight,l)),_=0,S=w.length;_<S;++_)x(w[_]),f=h.lineHeight;pt(g.after,x)}p=0,f=h.lineHeight,pt(this.afterBody,x),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=Al(s.rtl,this.x,this.width);for(e.x=Gh(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=is(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:u,height:d}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:b}=Rl(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+h,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+u-f,l),n.quadraticCurveTo(a+u,l,a+u,l+f),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+u,l+d-b),n.quadraticCurveTo(a+u,l+d,a+u-b,l+d),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+p,l+d),n.quadraticCurveTo(a,l+d,a,l+d-p),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+h),n.quadraticCurveTo(a,l,a+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=tu[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=ES(this,e),l=Object.assign({},o,this._size),u=TS(n,e,l),d=PS(e,l,u,n);(r._to!==d.x||i._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=mr(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),w2(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),k2(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const u=this.chart.getDatasetMeta(a);if(!u)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:u.data[l],index:l}}),i=!fp(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!fp(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=tu[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}$e(Fy,"positioners",tu);var Eq={id:"tooltip",_element:Fy,positioners:tu,afterInit(t,e,n){n&&(t.tooltip=new Fy({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:L2},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Tq=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function Pq(t,e,n,s){const r=t.indexOf(e);if(r===-1)return Tq(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const Rq=(t,e)=>t===null?null:rs(Math.round(t),0,e);function OS(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class zy extends yc{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(wt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:Pq(s,e,nt(n,e),this._addedLabels),Rq(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return OS.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}$e(zy,"id","category"),$e(zy,"defaults",{ticks:{callback:OS}});function Aq(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:u,maxTicks:d,maxDigits:h,includeBounds:f}=t,p=i||1,b=d-1,{min:x,max:y}=e,g=!wt(o),m=!wt(a),w=!wt(u),k=(y-x)/(h+1);let _=$_((y-x)/b/p)*p,C,S,j,N;if(_<1e-14&&!g&&!m)return[{value:x},{value:y}];N=Math.ceil(y/_)-Math.floor(x/_),N>b&&(_=$_(N*_/b/p)*p),wt(l)||(C=Math.pow(10,l),_=Math.ceil(_*C)/C),r==="ticks"?(S=Math.floor(x/_)*_,j=Math.ceil(y/_)*_):(S=x,j=y),g&&m&&i&&P8((a-o)/i,_/1e3)?(N=Math.round(Math.min((a-o)/_,d)),_=(a-o)/N,S=o,j=a):w?(S=g?o:S,j=m?a:j,N=u-1,_=(j-S)/N):(N=(j-S)/_,kf(N,Math.round(N),_/1e3)?N=Math.round(N):N=Math.ceil(N));const R=Math.max(F_(_),F_(S));C=Math.pow(10,wt(l)?R:l),S=Math.round(S*C)/C,j=Math.round(j*C)/C;let M=0;for(g&&(f&&S!==o?(n.push({value:o}),S<o&&M++,kf(Math.round((S+M*_)*C)/C,o,IS(o,k,t))&&M++):S<o&&M++);M<N;++M){const O=Math.round((S+M*_)*C)/C;if(m&&O>a)break;n.push({value:O})}return m&&f&&j!==a?n.length&&kf(n[n.length-1].value,a,IS(a,k,t))?n[n.length-1].value=a:n.push({value:a}):(!m||j===a)&&n.push({value:j}),n}function IS(t,e,{horizontal:n,minRotation:s}){const r=ai(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class Oq extends yc{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return wt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=lo(r),u=lo(i);l<0&&u<0?a(0):l>0&&u>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=Aq(r,i);return e.bounds==="ticks"&&R8(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return F0(e,this.chart.options.locale,this.options.ticks.format)}}class By extends Oq{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Ys(e)?e:0,this.max=Ys(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=ai(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}$e(By,"id","linear"),$e(By,"defaults",{ticks:{callback:f2.formatters.numeric}});const am={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ts=Object.keys(am);function MS(t,e){return t-e}function DS(t,e){if(wt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Ys(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(gp(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function LS(t,e,n,s){const r=ts.length;for(let i=ts.indexOf(t);i<r-1;++i){const o=am[ts[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return ts[i]}return ts[r-1]}function Iq(t,e,n,s,r){for(let i=ts.length-1;i>=ts.indexOf(n);i--){const o=ts[i];if(am[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return ts[n?ts.indexOf(n):0]}function Mq(t){for(let e=ts.indexOf(t)+1,n=ts.length;e<n;++e)if(am[ts[e]].common)return ts[e]}function $S(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=$0(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function Dq(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function FS(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:Dq(t,s,r,n)}class _p extends yc{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new YW._date(e.adapters.date);r.init(n),mu(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:DS(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!a&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Ys(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Ys(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=D8(r,i,o);return this._unit=n.unit||(s.autoSkip?LS(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):Iq(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:Mq(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),FS(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=rs(n,0,o),s=rs(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||LS(i.minUnit,n,s,this._getLabelCapacity(n)),a=nt(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,u=gp(l)||l===!0,d={};let h=n,f,p;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const b=r.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,a,o),p++)$S(d,f,b);return(f===s||r.bounds==="ticks"||p===1)&&$S(d,f,b),Object.keys(d).sort(MS).map(x=>+x)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return Nt(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,u=this._majorUnit,d=l&&a[l],h=u&&a[u],f=s[n],p=u&&h&&f&&f.major;return this._adapter.format(e,r||(p?h:d))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=ai(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,FS(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(DS(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return l2(e.sort(MS))}}$e(_p,"id","time"),$e(_p,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Yh(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Iy(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Iy(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const u=o-i;return u?a+(l-a)*(e-i)/u:a}class zS extends _p{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Yh(n,this.min),this._tableRange=Yh(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,u,d;for(o=0,a=e.length;o<a;++o)u=e[o],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)d=r[o+1],l=r[o-1],u=r[o],Math.round((d+l)/2)!==u&&i.push({time:u,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Yh(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Yh(this._table,s*this._tableRange+this._minPos,!0)}}$e(zS,"id","timeseries"),$e(zS,"defaults",_p.defaults);Rr.register(eu,Cf,zy,xl,Dy,_f,bq,By,Eq);const Fn={pending:"rgba(234, 179, 8, 0.7)",rejected:"rgba(239, 68, 68, 0.7)",returned:"rgba(249, 115, 22, 0.7)",submitted:"rgba(59, 130, 246, 0.7)",accepted:"rgba(34, 197, 94, 0.7)"},Lq=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}];function $q(t){const e=t-4,n=t+1,s=[];for(let r=e;r<=n;r+=1)s.push(r);return s}function Mn({icon:t,label:e,value:n,helper:s,accentClass:r,onClick:i}){const o=!!i;return c.jsxs(Ft,{className:`p-4 ${o?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:i,role:o?"button":void 0,tabIndex:o?0:void 0,onKeyDown:o?a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),i==null||i())}:void 0,children:[c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("div",{className:`h-10 w-10 rounded-xl flex items-center justify-center ${r}`,children:c.jsx(t,{size:18})}),c.jsx("div",{className:"text-2xl font-semibold",children:n})]}),c.jsx("div",{className:"mt-2 text-xs text-black/55 dark:text-white/60",children:e}),s?c.jsx("div",{className:"text-xs text-black/45 dark:text-white/55",children:s}):null]})}function Ja({title:t,children:e}){return c.jsxs(vt,{className:"h-full",children:[c.jsx(Lt,{children:c.jsx(Wt,{children:t})}),c.jsx($t,{children:c.jsx("div",{className:"h-[260px]",children:e})})]})}function $2({title:t,subtitle:e,children:n,defaultOpen:s=!1}){const[r,i]=v.useState(s);return c.jsxs(Ft,{className:"p-3",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>i(o=>!o),"aria-expanded":r,children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:t}),e?c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:e}):null]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:r?"Hide":"View"}),c.jsx(ss,{size:16,className:`transition-transform ${r?"rotate-180":""}`})]})]}),r?c.jsx("div",{className:"mt-3 space-y-2 text-xs text-black/60 dark:text-white/65",children:n}):null]})}function Za({type:t,data:e,options:n}){const s=ge.useRef(null);return ge.useEffect(()=>{if(!s.current)return;const r=Rr.getChart(s.current);r&&r.destroy();const i=new Rr(s.current,{type:t,data:e,options:n});return()=>i.destroy()},[e,n,t]),c.jsx("canvas",{ref:s})}function Fq(t){const e=Number(t)||0;return e>=80?"bg-emerald-500/80":e>=60?"bg-amber-500/80":"bg-rose-500/80"}function BS(t){if(!t)return"--";const e=Gs(t);return e?e.toLocaleDateString():t}function zq({mode:t,period:e}){if(!e)return"Current period";if(t==="month"){const[n,s]=e.split("-");return new Date(Number(n),Number(s)-1,1).toLocaleString(void 0,{month:"long",year:"numeric"})}if(t==="year")return e;if(t==="range"){const[n,s]=e.split(",");return`${n} to ${s}`}return e}function US(t){return{labels:["Pending","Rejected","Returned","Submitted","Accepted"],datasets:[{data:[t.pending,t.rejected,t.returned,t.submitted,t.accepted],backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]}}function Qh(t){const e={Pending:0,Rejected:0,Returned:0,"Submitted to Sales":0,Accepted:0};return t.forEach(n=>{const s=n.status||"";s.includes("Pending")||s==="Critique"||s==="Raw"?e.Pending+=1:s==="Rejected"||s==="Editing"?e.Rejected+=1:s==="Returned"?e.Returned+=1:s==="Submitted to Sales"?e["Submitted to Sales"]+=1:(s==="Accepted"||s==="Done")&&(e.Accepted+=1)}),e}function Uc(t){return t.length?c.jsx("div",{className:"space-y-3",children:t.map(e=>c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:["#",e.task_number," - ",e.brand]}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[e.status," - ",e.videographer||"Unassigned"]})]}),c.jsxs("div",{className:"text-right text-xs text-black/50 dark:text-white/60",children:[c.jsxs("div",{children:["Film: ",BS(e.filming_deadline)]}),c.jsxs("div",{children:["Due: ",BS(e.submission_date)]})]})]})},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No tasks found."})}function Xh(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:(e.versions||[]).map(n=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsx("div",{className:"mt-1 text-black/50 dark:text-white/60",children:(n.lifecycle||[]).map(s=>`${s.stage} (${s.at||""})`).join(" -> ")})]},n.version))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No versions found."})}function Fg(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:e.rejectionEvents.map((n,s)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsxs("div",{className:"text-black/50 dark:text-white/60",children:[n.event.rejection_class||"Unclassified"," - ",n.event.rejection_comments||"No notes"]})]},`${e.task_number}-${s}`))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection events."})}function Bq(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No pending reviews."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,versions:[]}),n[r].versions.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx($2,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.versions.map(s=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Waiting: ",s.waitingHours??"--"," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]})]},`${n.task.task_number}-${s.version.version}`))},n.task.task_number))})}function Uq(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No response data."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,responses:[]}),n[r].responses.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx($2,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.responses.map((s,r)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Decision: ",s.decision]}),c.jsxs("div",{children:["Response: ",s.responseHours," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]}),c.jsxs("div",{children:["Reviewed: ",s.reviewTime?s.reviewTime.toLocaleString():"--"]}),s.rejectionClass?c.jsxs("div",{children:["Class: ",s.rejectionClass]}):null,s.comments?c.jsxs("div",{children:["Notes: ",s.comments]}):null]},`${n.task.task_number}-${r}`))},n.task.task_number))})}function Hq(){const t=new Date,e=t.getFullYear(),[n,s]=v.useState("month"),[r,i]=v.useState(e),[o,a]=v.useState(t.getMonth()+1),[l,u]=v.useState(""),[d,h]=v.useState(""),[f,p]=v.useState(!1),[b,x]=v.useState(null),[y,g]=v.useState(null),m=$q(e),w=v.useMemo(()=>m.map(xe=>({value:xe,label:String(xe)})),[m]),k=v.useMemo(()=>[{value:"month",label:"Month"},{value:"year",label:"Year"},{value:"range",label:"Range"}],[]),_=v.useMemo(()=>n==="month"?`${r}-${String(o).padStart(2,"0")}`:n==="year"?`${r}`:n==="range"&&l&&d?`${l},${d}`:"",[n,l,d,o,r]),C=Ht({queryKey:["video-critique","dashboard",n,_],queryFn:()=>_4({mode:n,period:_})}),S=C.data||{},j=S.tasks||[],N=S.summary||{},R=S.pie||{},M=S.reviewer||{},O=S.summary_videographers&&Object.keys(S.summary_videographers).length?S.summary_videographers:dT(j),D=S.videographers||{},$=v.useMemo(()=>pT(j),[j]),L=v.useMemo(()=>Oi(j),[j]),U=v.useMemo(()=>hT(j),[j]),W=v.useMemo(()=>fT(j),[j]),E=v.useMemo(()=>({labels:["Completed","Not Completed"],datasets:[{data:[R.completed||0,R.not_completed||0],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}),[R.completed,R.not_completed]),P=v.useMemo(()=>{const xe=$.tasksStarted||0,me=R.completed||0,Le=Math.max(xe-me,0);return{labels:["Completed","Not Completed"],datasets:[{data:[me,Le],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}},[$.tasksStarted,R.completed]),A=v.useMemo(()=>US(L),[L]),F=v.useMemo(()=>Object.entries(O).sort((xe,me)=>me[1].total-xe[1].total),[O]),z=!!b,G=!!y,q=y?O[y]:null,B=y?D[y]||[]:[],Q=v.useMemo(()=>Xu(j,"pending"),[j]),pe=v.useMemo(()=>Xu(j,"submitted"),[j]),Z=v.useMemo(()=>gg(j,"hod"),[j]),be=v.useMemo(()=>gg(j,"hos"),[j]),De=v.useMemo(()=>{const xe={};let me=0,Le=0;j.forEach(re=>{(re.versions||[]).forEach(_e=>{const se=_e.lifecycle||[];if(!se.length)return;const V=se[se.length-1],ye=((V==null?void 0:V.stage)||"").toLowerCase();(ye==="accepted"||ye==="done")&&(me+=1),(ye==="rejected"||ye==="editing"||ye==="returned")&&(Le+=1),se.forEach(Ne=>{const Re=(Ne.stage||"").toLowerCase();if(Re==="rejected"||Re==="editing"||Re==="returned"){const J=Ne.rejection_class||"Unclassified";xe[J]=(xe[J]||0)+1}})})});const Y=me+Le,ae=Y?(me/Y*100).toFixed(1):"0",le=Y?(Le/Y*100).toFixed(1):"0",oe=Object.entries(xe).sort((re,_e)=>_e[1]-re[1]);return{acceptedPct:ae,rejectedPct:le,classes:oe,totalRejections:Le}},[j]);return C.isLoading?c.jsxs(vt,{children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Video Critique Dashboard"})}),c.jsx($t,{children:c.jsx(Ye,{text:"Loading dashboard",className:"text-sm text-black/60 dark:text-white/65"})})]}):c.jsxs("div",{className:"flex flex-col gap-4 min-h-0 pb-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-1",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Video Critique Dashboard"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:zq({mode:n,period:_})})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(ot,{value:n,options:k,onChange:s,className:"sm:w-[200px]"}),n==="month"?c.jsxs(c.Fragment,{children:[c.jsx(ot,{value:o,options:Lq,onChange:a,className:"sm:w-[200px]"}),c.jsx(ot,{value:r,options:w,onChange:i,className:"sm:w-[200px]"})]}):null,n==="year"?c.jsx(ot,{value:r,options:w,onChange:i,className:"sm:w-[200px]"}):null,n==="range"?c.jsxs(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!0),children:[c.jsx(UI,{size:16,className:"mr-2"}),"Pick Range"]}):null,c.jsxs(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>C.refetch(),children:[c.jsx(QI,{size:16,className:"mr-2"}),"Refresh"]})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(Mn,{icon:pf,label:"Total Tasks",value:N.total||0,helper:"Tasks created",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("total_created")}),c.jsx(Mn,{icon:mh,label:"Assigned",value:N.assigned||0,helper:"Assigned to videographers",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("total_assigned")}),c.jsx(Mn,{icon:gh,label:"Tasks Started",value:$.tasksStarted||0,helper:"Filming date passed",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("total_started")}),c.jsx(Mn,{icon:xh,label:"Late Tasks",value:$.lateTasks||0,helper:"Submission overdue",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("total_late")}),c.jsx(Mn,{icon:pf,label:"Uploads",value:N.uploads||0,helper:"Total versions",accentClass:"bg-purple-500/10 text-purple-700 dark:text-purple-200",onClick:()=>x("upload_ratio")}),c.jsx(Mn,{icon:mh,label:"Completed",value:R.completed||0,helper:"Accepted or done",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("completed")})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(Mn,{icon:gh,label:"Pending HOD",value:$.pendingHOD||0,helper:"Versions in critique",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("pending_hod")}),c.jsx(Mn,{icon:gh,label:"Pending HOS",value:$.pendingHOS||0,helper:"Submitted to sales",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("pending_hos")}),c.jsx(Mn,{icon:xh,label:"Rejected by HOD",value:$.rejectionsByHOD||0,helper:"Editing / rejected",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("rejected_hod")}),c.jsx(Mn,{icon:xh,label:"Rejected by HOS",value:$.rejectionsByHOS||0,helper:"Returned",accentClass:"bg-orange-500/10 text-orange-700 dark:text-orange-200",onClick:()=>x("rejected_hos")}),c.jsx(Mn,{icon:pf,label:"Upload Ratio",value:$.uploadRatio||"0",helper:"Avg versions/task",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("upload_ratio")}),c.jsx(Mn,{icon:mh,label:"Acceptance Rate",value:`${N.accepted_pct||0}%`,helper:"Accepted vs reviewed",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("acceptance_rate")})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsx(Ja,{title:"Completion Overview",children:c.jsx(Za,{type:"doughnut",data:E,options:{maintainAspectRatio:!1}})}),c.jsx(Ja,{title:"Started vs Completed",children:c.jsx(Za,{type:"doughnut",data:P,options:{maintainAspectRatio:!1}})}),c.jsx(Ja,{title:"Status Distribution",children:c.jsx(Za,{type:"bar",data:A,options:{maintainAspectRatio:!1,indexAxis:"y",scales:{x:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}},y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}}}}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsxs(vt,{children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Reviewer Performance"})}),c.jsx($t,{children:c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Avg response time"}),c.jsx("span",{className:"font-semibold",children:M.avg_response_display||"0 hrs"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Handled"}),c.jsx("span",{className:"font-semibold",children:M.handled||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Accepted by HOS"}),c.jsx("span",{className:"font-semibold",children:M.accepted||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Success rate"}),c.jsxs("span",{className:"font-semibold",children:[M.handled_percent||0,"%"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Pending reviews"}),c.jsx("span",{className:"font-semibold",children:U.count||0})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(te,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("response_time"),children:"View response times"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("pending_reviews"),children:"View pending reviews"})]})]})})]}),c.jsxs(vt,{className:"lg:col-span-2",children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Videographers"})}),c.jsx($t,{children:F.length?c.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:F.map(([xe,me])=>c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>g(xe),children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:xe}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[me.total," tasks"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-lg font-semibold",children:[me.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]})]}),c.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-black/60 dark:text-white/60",children:[c.jsxs("div",{children:["Started: ",me.started]}),c.jsxs("div",{children:["Late: ",me.late]}),c.jsxs("div",{children:["Completed: ",me.completed]}),c.jsxs("div",{children:["Uploads: ",me.uploads]})]}),c.jsx("div",{className:"mt-3 h-2 rounded-full bg-black/10 dark:bg-white/10 overflow-hidden",children:c.jsx("div",{className:`h-full ${Fq(me.accepted_pct)}`,style:{width:`${me.accepted_pct}%`}})})]},xe))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No videographer data."})})]})]}),c.jsxs(Cs,{open:z,onClose:()=>x(null),title:"Details",maxWidth:"820px",children:[b==="total_created"?Uc(j):null,b==="total_assigned"?Uc(j.filter(xe=>xe.status!=="Not assigned yet")):null,b==="total_started"?Uc(j.filter(xe=>{const me=Gs(xe.filming_deadline||"");if(!me)return!1;const Le=new Date;return Le.setHours(0,0,0,0),me<=Le})):null,b==="total_late"?Uc(j.filter(xg)):null,b==="completed"?Uc(j.filter(xe=>xe.status==="Accepted"||xe.status==="Done")):null,b==="pending_hod"?Xh(Q.map(xe=>({...xe.task,versions:[xe.version]}))):null,b==="pending_hos"?Xh(pe.map(xe=>({...xe.task,versions:[xe.version]}))):null,b==="rejected_hod"?Fg(Z):null,b==="rejected_hos"?Fg(be):null,b==="upload_ratio"?Xh(j.filter(xe=>{var me;return(me=xe.versions)==null?void 0:me.length})):null,b==="acceptance_rate"?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Ft,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-emerald-600",children:[De.acceptedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]}),c.jsxs(Ft,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-red-600",children:[De.rejectedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Rejection"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/70 dark:text-white/70 mb-2",children:"Rejection classes"}),De.classes.length?c.jsx("div",{className:"space-y-2",children:De.classes.map(([xe,me])=>c.jsx("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:xe}),c.jsx("span",{children:me})]})},xe))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection data."})]})]}):null,b==="response_time"?Uq(W):null,b==="pending_reviews"?Bq(U.reviews||[]):null]}),c.jsx(Cs,{open:G,onClose:()=>g(null),title:y?`${y} Details`:"Videographer",maxWidth:"980px",children:y&&q?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Ft,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold",children:[q.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance rate"})]}),c.jsxs(Ft,{className:"p-4 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:q.late}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Late tasks"})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[c.jsx(Mn,{icon:gh,label:"Pending",value:Oi(B).pending,accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200"}),c.jsx(Mn,{icon:xh,label:"Rejected",value:Oi(B).rejected,accentClass:"bg-red-500/10 text-red-700 dark:text-red-200"}),c.jsx(Mn,{icon:mh,label:"Accepted",value:Oi(B).accepted,accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200"})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(Ja,{title:"Version Distribution",children:c.jsx(Za,{type:"bar",data:US(Oi(B)),options:{maintainAspectRatio:!1,indexAxis:"y"}})}),c.jsx(Ja,{title:"All Tasks Status",children:c.jsx(Za,{type:"pie",data:{labels:Object.keys(Qh(B)),datasets:[{data:Object.values(Qh(B)),backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(Ja,{title:"Overdue Tasks",children:c.jsx(Za,{type:"pie",data:{labels:Object.keys(Qh(B.filter(xg))),datasets:[{data:Object.values(Qh(B.filter(xg))),backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})}),c.jsxs(vt,{children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Failure Analysis"})}),c.jsx($t,{children:Fg(gg(B,"hod"))})]})]}),c.jsxs(vt,{children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Version History"})}),c.jsx($t,{children:Xh(B)})]})]}):null}),c.jsx(Cs,{open:f,onClose:()=>p(!1),title:"Select date range",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Start date"}),c.jsx("input",{type:"date",value:l,onChange:xe=>u(xe.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"End date"}),c.jsx("input",{type:"date",value:d,onChange:xe=>h(xe.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!1),children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:()=>p(!1),children:"Apply"})]})]})})]})}function Wq(){const[t,e]=v.useState("chat");return c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{variant:t==="chat"?"default":"ghost",className:"rounded-2xl",onClick:()=>e("chat"),children:"Chat"}),c.jsx(te,{variant:t==="dashboard"?"default":"ghost",className:"rounded-2xl",onClick:()=>e("dashboard"),children:"Dashboard"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="chat"?"h-full":"hidden","aria-hidden":t!=="chat",children:c.jsx(FH,{})}),c.jsx("div",{className:t==="dashboard"?"h-full overflow-y-auto px-2 py-1":"hidden","aria-hidden":t!=="dashboard",children:c.jsx(Hq,{})})]})]})}function Vq(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function HS(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function WS(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function qq({locations:t,locationsQuery:e}){var w;const[n,s]=v.useState(null),[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),[d,h]=v.useState(""),f=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.display_type)||"";S&&_.add(S)}),[{value:"",label:"All display types"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),p=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.company_schema)||"";S&&_.add(S)}),[{value:"",label:"All companies"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),b=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.series)||"";S&&_.add(S)}),[{value:"",label:"All series"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),x=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=r.trim().toLowerCase();return k.filter(S=>!(o&&((S==null?void 0:S.display_type)||"")!==o||l&&((S==null?void 0:S.company_schema)||"")!==l||d&&((S==null?void 0:S.series)||"")!==d||_&&!Vq(S).includes(_))).map((S,j)=>({id:(S==null?void 0:S.location_key)||`location-${j}`,raw:S}))},[t,o,l,d,r]),y=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;k.forEach(j=>{Object.keys(j||{}).forEach(N=>_.add(N))});const C=["display_name","location_key","display_type","company_schema","series","city","area","upload_fee","height","width","number_of_faces","spot_duration","loop_duration","sov_percent","eligible_for_proposals","eligible_for_mockups"],S=Array.from(_).filter(j=>!C.includes(j)).sort();return[...C.filter(j=>_.has(j)),...S]},[t]),g=v.useMemo(()=>n?Object.entries(n):[],[n]),m=n||null;return c.jsxs(c.Fragment,{children:[c.jsxs(vt,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Lt,{className:"space-y-1",children:[c.jsx(Wt,{children:"Locations"}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[x.length," location",x.length===1?"":"s"]})]}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-4 md:shrink-0",children:[c.jsx(jo,{value:r,onChange:k=>i(k.target.value),className:"w-full",placeholder:"Search locations..."}),c.jsx(ot,{value:o,options:f,onChange:a,className:"w-full"}),c.jsx(ot,{value:l,options:p,onChange:u,className:"w-full"}),c.jsx(ot,{value:d,options:b,onChange:h,className:"w-full"})]}),e.isLoading?c.jsx(Ye,{text:"Loading locations",className:"text-sm text-black/60 dark:text-white/65"}):e.isError?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:((w=e.error)==null?void 0:w.message)||"Failed to load locations."}):x.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsxs("tr",{children:[y.map(k=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:HS(k)},k)),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:x.map(k=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[y.map(_=>{var S;const C=WS((S=k.raw)==null?void 0:S[_]);return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:C},`${k.id}-${_}`)}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>s(k.raw),children:"Edit"})})]},k.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No locations found."})]})]}),c.jsx(Cs,{open:!!n,onClose:()=>s(null),title:"Edit location",maxWidth:"560px",children:m?c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ce,{label:"Location Key",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.location_key||"",disabled:!0,readOnly:!0})}),c.jsx(Ce,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_name||"",disabled:!0,readOnly:!0})}),c.jsx(Ce,{label:"Display Type",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_type||"",disabled:!0,readOnly:!0})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ce,{label:"Company",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.company_schema||"",disabled:!0,readOnly:!0})}),c.jsx(Ce,{label:"Series",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.series||"",disabled:!0,readOnly:!0})}),c.jsx(Ce,{label:"City",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.city||"",disabled:!0,readOnly:!0})}),c.jsx(Ce,{label:"Area",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.area||"",disabled:!0,readOnly:!0})})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>s(null),children:"Close"}),c.jsx(te,{className:"rounded-2xl",disabled:!0,children:"Save"})]}),c.jsxs("div",{className:"pt-2",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60 mb-2",children:"All fields"}),c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 divide-y divide-black/5 dark:divide-white/10",children:g.map(([k,_])=>c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 px-3 py-2 text-sm",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/45 dark:text-white/55 md:w-56",children:HS(k)}),c.jsx("div",{className:"text-black/80 dark:text-white/85 break-all",children:WS(_)})]},k))})]})]}):null})]})}function Kq(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function Gq(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function Yq(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function lm({title:t,items:e,itemsQuery:n,itemLabel:s="item",searchPlaceholder:r="Search...",emptyMessage:i="No items found.",preferredColumns:o=[],stringKey:a="value"}){var y;const[l,u]=v.useState(""),d=v.useMemo(()=>(Array.isArray(e)?e:[]).map(m=>m==null?{[a]:""}:typeof m=="string"||typeof m=="number"||typeof m=="boolean"?{[a]:m}:m),[e,a]),h=v.useMemo(()=>{const g=new Set;d.forEach(w=>{Object.keys(w||{}).forEach(k=>g.add(k))});const m=Array.from(g).filter(w=>!o.includes(w)).sort();return[...o.filter(w=>g.has(w)),...m]},[d,o]),f=v.useMemo(()=>{const g=l.trim().toLowerCase();return d.filter(w=>g?Kq(w).includes(g):!0).map((w,k)=>({id:(w==null?void 0:w.id)??(w==null?void 0:w[a])??`row-${k}`,raw:w}))},[d,l,a]),p=n==null?void 0:n.isLoading,b=n==null?void 0:n.isError,x=((y=n==null?void 0:n.error)==null?void 0:y.message)||"Failed to load data.";return c.jsxs(vt,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Lt,{className:"space-y-1",children:[c.jsx(Wt,{children:t}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[f.length," ",s,f.length===1?"":"s"]})]}),c.jsxs($t,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsx(jo,{value:l,onChange:g=>u(g.target.value),className:"w-full md:shrink-0",placeholder:r}),p?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):b?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:x}):f.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsx("tr",{children:h.map(g=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:Gq(g)},g))})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:f.map(g=>c.jsx("tr",{className:"text-black/80 dark:text-white/85",children:h.map(m=>{var w;return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:Yq((w=g.raw)==null?void 0:w[m])},`${g.id}-${m}`)})},g.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:i})]})]})}function Qq({networks:t,networksQuery:e}){return c.jsx(lm,{title:"Networks",items:t,itemsQuery:e,itemLabel:"network",searchPlaceholder:"Search networks...",emptyMessage:"No networks found.",preferredColumns:["network_name","name","company","company_schema","is_active","location_count"]})}function Xq({assetTypes:t,assetTypesQuery:e}){return c.jsx(lm,{title:"Asset Types",items:t,itemsQuery:e,itemLabel:"type",searchPlaceholder:"Search asset types...",emptyMessage:"No asset types found.",preferredColumns:["name","type_key","company","network_id","is_active","location_count"]})}function Jq({networkAssets:t,networkAssetsQuery:e}){return c.jsx(lm,{title:"Network Assets",items:t,itemsQuery:e,itemLabel:"asset",searchPlaceholder:"Search assets...",emptyMessage:"No network assets found.",preferredColumns:["display_name","asset_key","location_key","network_id","type_id","company","is_active"]})}function Zq({packages:t,packagesQuery:e}){return c.jsx(lm,{title:"Packages",items:t,itemsQuery:e,itemLabel:"package",searchPlaceholder:"Search packages...",emptyMessage:"No packages found.",preferredColumns:["name","company","is_active"]})}const e7=[{key:"networks",label:"Networks",disabled:!1},{key:"asset-types",label:"Asset Types",disabled:!1},{key:"network-assets",label:"Network Assets",disabled:!1},{key:"packages",label:"Packages",disabled:!1},{key:"locations",label:"Locations",disabled:!1}];function Hc(t,e=[]){if(Array.isArray(t))return t;for(const n of e)if(Array.isArray(t==null?void 0:t[n]))return t[n];return Array.isArray(t==null?void 0:t.data)?t.data:[]}function t7(){const{user:t}=mi(),[e,n]=v.useState("networks");if(!Td(t))return c.jsxs(vt,{children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Restricted"})}),c.jsx($t,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to asset management."})]});const s=Ht({queryKey:["asset-management","networks"],queryFn:()=>O4(),enabled:e==="networks"}),r=Ht({queryKey:["asset-management","asset-types"],queryFn:()=>I4(),enabled:e==="asset-types"}),i=Ht({queryKey:["asset-management","network-assets"],queryFn:()=>M4(),enabled:e==="network-assets"}),o=Ht({queryKey:["asset-management","packages"],queryFn:()=>L4(),enabled:e==="packages"}),a=Ht({queryKey:["asset-management","locations"],queryFn:()=>D4(),enabled:e==="locations"}),l=v.useMemo(()=>Hc(s.data,["networks"]),[s.data]),u=v.useMemo(()=>Hc(r.data,["asset_types","types"]),[r.data]),d=v.useMemo(()=>Hc(i.data,["network_assets","assets"]),[i.data]),h=v.useMemo(()=>Hc(o.data,["packages"]),[o.data]),f=v.useMemo(()=>Hc(a.data,["locations"]),[a.data]);return c.jsxs("div",{className:"flex h-full min-h-0 min-w-0 flex-col gap-4",children:[c.jsx("div",{className:"flex items-center gap-2 overflow-x-auto",children:e7.map(p=>c.jsx(te,{variant:e===p.key?"default":"ghost",onClick:()=>n(p.key),className:"rounded-2xl shrink-0",disabled:p.disabled,title:p.disabled?"Coming soon":void 0,children:p.label},p.key))}),c.jsxs("div",{className:"flex-1 min-h-0 min-w-0",children:[e==="networks"?c.jsx("div",{className:"h-full",children:c.jsx(Qq,{networks:l,networksQuery:s})}):null,e==="asset-types"?c.jsx("div",{className:"h-full",children:c.jsx(Xq,{assetTypes:u,assetTypesQuery:r})}):null,e==="network-assets"?c.jsx("div",{className:"h-full",children:c.jsx(Jq,{networkAssets:d,networkAssetsQuery:i})}):null,e==="packages"?c.jsx("div",{className:"h-full",children:c.jsx(Zq,{packages:h,packagesQuery:o})}):null,e==="locations"?c.jsx("div",{className:"h-full",children:c.jsx(qq,{locations:f,locationsQuery:a})}):null]})]})}function n7({children:t}){const{user:e,authReady:n,session:s,pendingAccess:r,logout:i}=mi(),o=lc();return!n||s&&!e?(console.log("[ProtectedRoute] Waiting for auth",{authReady:n,hasSession:!!s,hasUser:!!e}),null):(console.log("[ProtectedRoute] Auth ready, rendering children",{user:e==null?void 0:e.email}),r?c.jsx(RN,{email:r.email,message:r.message,onSignOut:i}):e?t:c.jsx(hf,{to:"/login",replace:!0,state:{from:o.pathname}}))}function s7(){const t="mmg-brand-theme",[e,n]=v.useState("none");v.useEffect(()=>{if(typeof window>"u")return;const i=window.localStorage.getItem(t)||"none";n(i),i==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",i)},[]);const s=r=>{n(r),typeof window<"u"&&window.localStorage.setItem(t,r),r==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",r)};return c.jsx("div",{className:"h-full min-h-0",children:c.jsxs(vt,{className:"h-full",children:[c.jsx(Lt,{children:c.jsx(Wt,{children:"Settings"})}),c.jsxs($t,{className:"text-sm text-black/60 dark:text-white/65 space-y-4",children:[c.jsxs(Ft,{className:"flex items-center justify-between p-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle dark / light mode"})]}),c.jsx(AN,{})]}),c.jsxs(Ft,{className:"space-y-3 p-4",children:[c.jsx("div",{className:"flex items-center justify-between gap-4",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Color theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Choose a color palette that layers on top of light / dark mode."})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2",children:[c.jsx("button",{type:"button",onClick:()=>s("none"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="none"?"border-black/60 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:c.jsx("span",{className:"font-medium",children:"System default"})}),c.jsxs("button",{type:"button",onClick:()=>s("blue"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="blue"?"border-blue-500/80 bg-blue-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Blue"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#007AFF]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("green"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="green"?"border-emerald-500/80 bg-emerald-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Green"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#0F806B]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("orange"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="orange"?"border-orange-500/80 bg-orange-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Orange"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#FF7900]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("gold"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="gold"?"border-amber-500/80 bg-amber-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Gold"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#CA9E2C]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("brand"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="brand"?"border-black/70 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Brand Theme"}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#000000]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#007AFF]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#CA9E2C]"})]})]})]})]})]})]})})}function r7(){return c.jsxs(GO,{children:[c.jsx(Dn,{path:"/",element:c.jsx(hf,{to:"/login",replace:!0})}),c.jsx(Dn,{path:"/login",element:c.jsx(N5,{})}),c.jsx(Dn,{path:"/auth/callback",element:c.jsx(E5,{})}),c.jsxs(Dn,{path:"/app",element:c.jsx(n7,{children:c.jsx(W4,{})}),children:[c.jsx(Dn,{index:!0,element:c.jsx(hf,{to:"chat",replace:!0})}),c.jsx(Dn,{path:"chat",element:c.jsx(gU,{})}),c.jsx(Dn,{path:"video-critique",element:c.jsx(Wq,{})}),c.jsx(Dn,{path:"mockup",element:c.jsx(GU,{})}),c.jsx(Dn,{path:"proposals",element:c.jsx(uH,{})}),c.jsx(Dn,{path:"notifications",element:c.jsx($H,{})}),c.jsx(Dn,{path:"admin",element:c.jsx(DH,{})}),c.jsx(Dn,{path:"asset-management",element:c.jsx(t7,{})}),c.jsx(Dn,{path:"settings",element:c.jsx(s7,{})})]}),c.jsx(Dn,{path:"*",element:c.jsx(hf,{to:"/login",replace:!0})})]})}function i7(){if(!(typeof window>"u"))try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=e.createOscillator(),s=e.createGain();n.type="sine",n.frequency.value=740,s.gain.value=.15,n.connect(s),s.connect(e.destination),n.start(),s.gain.exponentialRampToValueAtTime(.001,e.currentTime+.25),n.stop(e.currentTime+.3),n.onended=()=>{e.close()}}catch{}}function o7(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?"":e.toLocaleString()}function a7({children:t}){const[e,n]=v.useState([]),[s,r]=v.useState(!0),[i,o]=v.useState([]),a=v.useRef(new Set),l=v.useRef(!1),u=v.useRef(new Map),d=v.useCallback(async()=>{r(!0);const w=await JB();n(Array.isArray(w)?w:[]),r(!1)},[]),h=v.useCallback(async()=>{await e4(),n([])},[]),f=v.useCallback(async w=>{w&&(await t4(w),n(k=>k.filter(_=>_.id!==w)))},[]),p=v.useCallback(async w=>{w&&(await n4(w),n(k=>k.map(_=>_.id===w?{..._,read:!0}:_)))},[]),b=v.useCallback(async w=>{const k=await ZB(w);return n(_=>[k,..._]),k},[]),x=v.useCallback(w=>{o(_=>_.filter(C=>C.id!==w));const k=u.current.get(w);k&&(clearTimeout(k),u.current.delete(w))},[]),y=v.useCallback(w=>{if(!(w!=null&&w.id))return;o(_=>[..._,{id:w.id,notification:w}]);const k=setTimeout(()=>x(w.id),4200);u.current.set(w.id,k)},[x]);v.useEffect(()=>{d()},[d]),v.useEffect(()=>{if(!l.current){e.forEach(k=>a.current.add(k.id)),l.current=!0;return}const w=e.filter(k=>k.id&&!a.current.has(k.id));w.length&&(i7(),w.forEach(k=>{a.current.add(k.id),y(k)}))},[e,y]),v.useEffect(()=>{if(typeof window>"u")return;const w=k=>{k.key===s4&&d()};return window.addEventListener("storage",w),()=>window.removeEventListener("storage",w)},[d]),v.useEffect(()=>{if(!(typeof window>"u"))return window.mmgNotify=w=>b(w),window.mmgNotifications={add:w=>b(w),clear:h,dismiss:f,markRead:p},()=>{delete window.mmgNotify,delete window.mmgNotifications}},[b,h,f,p]);const g=v.useMemo(()=>e.filter(w=>!w.read).length,[e]),m=v.useMemo(()=>({notifications:e,loading:s,unreadCount:g,toasts:i,addNotification:b,clearAll:h,dismissNotification:f,markRead:p,dismissToast:x,formatTime:o7}),[e,s,g,i,b,h,f,p,x]);return c.jsx(iT.Provider,{value:m,children:t})}function l7(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const u=async(h=!0)=>{await l};async function d(){if("serviceWorker"in navigator){if(a=await LI(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!a)return;a.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),a.addEventListener("installed",h=>{h.isUpdate||s==null||s()}),a.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return l=d(),u}l7({immediate:!0});const c7="mmg-brand-theme";if(typeof window<"u"){const t=window.localStorage.getItem(c7);t&&t!=="none"?document.body.setAttribute("data-brand-theme",t):document.body.removeAttribute("data-brand-theme"),window.addEventListener("wheel",e=>{const n=e.target;n instanceof HTMLInputElement&&n.type==="number"&&n===document.activeElement&&e.preventDefault()},{passive:!1})}const u7=new TI({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});zg.createRoot(document.getElementById("root")).render(c.jsx(ge.StrictMode,{children:c.jsx(tI,{attribute:"class",defaultTheme:"light",enableSystem:!1,children:c.jsx(PI,{client:u7,children:c.jsx(j5,{children:c.jsx(a7,{children:c.jsx(XO,{children:c.jsx(r7,{})})})})})})}));
