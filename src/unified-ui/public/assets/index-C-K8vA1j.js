var OP=Object.defineProperty;var kb=t=>{throw TypeError(t)};var MP=(t,e,n)=>e in t?OP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $e=(t,e,n)=>MP(t,typeof e!="symbol"?e+"":e,n),_m=(t,e,n)=>e.has(t)||kb("Cannot "+n);var M=(t,e,n)=>(_m(t,e,"read from private field"),n?n.call(t):e.get(t)),Ce=(t,e,n)=>e.has(t)?kb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),xe=(t,e,n,s)=>(_m(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n),Fe=(t,e,n)=>(_m(t,e,"access private method"),n);var th=(t,e,n,s)=>({set _(r){xe(t,e,r,n)},get _(){return M(t,e,s)}});function IP(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function f1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var p1={exports:{}},Rp={},m1={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bd=Symbol.for("react.element"),DP=Symbol.for("react.portal"),LP=Symbol.for("react.fragment"),$P=Symbol.for("react.strict_mode"),FP=Symbol.for("react.profiler"),zP=Symbol.for("react.provider"),BP=Symbol.for("react.context"),UP=Symbol.for("react.forward_ref"),HP=Symbol.for("react.suspense"),WP=Symbol.for("react.memo"),VP=Symbol.for("react.lazy"),_b=Symbol.iterator;function qP(t){return t===null||typeof t!="object"?null:(t=_b&&t[_b]||t["@@iterator"],typeof t=="function"?t:null)}var g1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x1=Object.assign,y1={};function cc(t,e,n){this.props=t,this.context=e,this.refs=y1,this.updater=n||g1}cc.prototype.isReactComponent={};cc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};cc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function v1(){}v1.prototype=cc.prototype;function Jy(t,e,n){this.props=t,this.context=e,this.refs=y1,this.updater=n||g1}var Zy=Jy.prototype=new v1;Zy.constructor=Jy;x1(Zy,cc.prototype);Zy.isPureReactComponent=!0;var Sb=Array.isArray,b1=Object.prototype.hasOwnProperty,ev={current:null},w1={key:!0,ref:!0,__self:!0,__source:!0};function k1(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)b1.call(e,s)&&!w1.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:bd,type:t,key:i,ref:o,props:r,_owner:ev.current}}function KP(t,e){return{$$typeof:bd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function tv(t){return typeof t=="object"&&t!==null&&t.$$typeof===bd}function GP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var jb=/\/+/g;function Sm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?GP(""+t.key):e.toString(36)}function rf(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case bd:case DP:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+Sm(o,0):s,Sb(r)?(n="",t!=null&&(n=t.replace(jb,"$&/")+"/"),rf(r,e,n,"",function(u){return u})):r!=null&&(tv(r)&&(r=KP(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(jb,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",Sb(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+Sm(i,a);o+=rf(i,e,n,l,r)}else if(l=qP(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+Sm(i,a++),o+=rf(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function nh(t,e,n){if(t==null)return t;var s=[],r=0;return rf(t,s,"","",function(i){return e.call(n,i,r++)}),s}function YP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Un={current:null},of={transition:null},QP={ReactCurrentDispatcher:Un,ReactCurrentBatchConfig:of,ReactCurrentOwner:ev};function _1(){throw Error("act(...) is not supported in production builds of React.")}Je.Children={map:nh,forEach:function(t,e,n){nh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return nh(t,function(){e++}),e},toArray:function(t){return nh(t,function(e){return e})||[]},only:function(t){if(!tv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Je.Component=cc;Je.Fragment=LP;Je.Profiler=FP;Je.PureComponent=Jy;Je.StrictMode=$P;Je.Suspense=HP;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QP;Je.act=_1;Je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=x1({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ev.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)b1.call(e,l)&&!w1.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:bd,type:t.type,key:r,ref:i,props:s,_owner:o}};Je.createContext=function(t){return t={$$typeof:BP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:zP,_context:t},t.Consumer=t};Je.createElement=k1;Je.createFactory=function(t){var e=k1.bind(null,t);return e.type=t,e};Je.createRef=function(){return{current:null}};Je.forwardRef=function(t){return{$$typeof:UP,render:t}};Je.isValidElement=tv;Je.lazy=function(t){return{$$typeof:VP,_payload:{_status:-1,_result:t},_init:YP}};Je.memo=function(t,e){return{$$typeof:WP,type:t,compare:e===void 0?null:e}};Je.startTransition=function(t){var e=of.transition;of.transition={};try{t()}finally{of.transition=e}};Je.unstable_act=_1;Je.useCallback=function(t,e){return Un.current.useCallback(t,e)};Je.useContext=function(t){return Un.current.useContext(t)};Je.useDebugValue=function(){};Je.useDeferredValue=function(t){return Un.current.useDeferredValue(t)};Je.useEffect=function(t,e){return Un.current.useEffect(t,e)};Je.useId=function(){return Un.current.useId()};Je.useImperativeHandle=function(t,e,n){return Un.current.useImperativeHandle(t,e,n)};Je.useInsertionEffect=function(t,e){return Un.current.useInsertionEffect(t,e)};Je.useLayoutEffect=function(t,e){return Un.current.useLayoutEffect(t,e)};Je.useMemo=function(t,e){return Un.current.useMemo(t,e)};Je.useReducer=function(t,e,n){return Un.current.useReducer(t,e,n)};Je.useRef=function(t){return Un.current.useRef(t)};Je.useState=function(t){return Un.current.useState(t)};Je.useSyncExternalStore=function(t,e,n){return Un.current.useSyncExternalStore(t,e,n)};Je.useTransition=function(){return Un.current.useTransition()};Je.version="18.3.1";m1.exports=Je;var v=m1.exports;const ve=f1(v),Ap=IP({__proto__:null,default:ve},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XP=v,JP=Symbol.for("react.element"),ZP=Symbol.for("react.fragment"),eR=Object.prototype.hasOwnProperty,tR=XP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nR={key:!0,ref:!0,__self:!0,__source:!0};function S1(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)eR.call(e,s)&&!nR.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:JP,type:t,key:i,ref:o,props:r,_owner:tR.current}}Rp.Fragment=ZP;Rp.jsx=S1;Rp.jsxs=S1;p1.exports=Rp;var c=p1.exports,Gg={},j1={exports:{}},Ps={},C1={exports:{}},N1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,R){var V=T.length;T.push(R);e:for(;0<V;){var G=V-1>>>1,Q=T[G];if(0<r(Q,R))T[G]=R,T[V]=Q,V=G;else break e}}function n(T){return T.length===0?null:T[0]}function s(T){if(T.length===0)return null;var R=T[0],V=T.pop();if(V!==R){T[0]=V;e:for(var G=0,Q=T.length,re=Q>>>1;G<re;){var ee=2*(G+1)-1,z=T[ee],A=ee+1,Y=T[A];if(0>r(z,V))A<Q&&0>r(Y,z)?(T[G]=Y,T[A]=V,G=A):(T[G]=z,T[ee]=V,G=ee);else if(A<Q&&0>r(Y,V))T[G]=Y,T[A]=V,G=A;else break e}}return R}function r(T,R){var V=T.sortIndex-R.sortIndex;return V!==0?V:T.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,h=null,f=3,p=!1,w=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(T){for(var R=n(u);R!==null;){if(R.callback===null)s(u);else if(R.startTime<=T)s(u),R.sortIndex=R.expirationTime,e(l,R);else break;R=n(u)}}function k(T){if(x=!1,b(T),!w)if(n(l)!==null)w=!0,F(_);else{var R=n(u);R!==null&&K(k,R.startTime-T)}}function _(T,R){w=!1,x&&(x=!1,g(j),j=-1),p=!0;var V=f;try{for(b(R),h=n(l);h!==null&&(!(h.expirationTime>R)||T&&!L());){var G=h.callback;if(typeof G=="function"){h.callback=null,f=h.priorityLevel;var Q=G(h.expirationTime<=R);R=t.unstable_now(),typeof Q=="function"?h.callback=Q:h===n(l)&&s(l),b(R)}else s(l);h=n(l)}if(h!==null)var re=!0;else{var ee=n(u);ee!==null&&K(k,ee.startTime-R),re=!1}return re}finally{h=null,f=V,p=!1}}var C=!1,S=null,j=-1,E=5,P=-1;function L(){return!(t.unstable_now()-P<E)}function I(){if(S!==null){var T=t.unstable_now();P=T;var R=!0;try{R=S(!0,T)}finally{R?O():(C=!1,S=null)}}else C=!1}var O;if(typeof m=="function")O=function(){m(I)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,D=$.port2;$.port1.onmessage=I,O=function(){D.postMessage(null)}}else O=function(){y(I,0)};function F(T){S=T,C||(C=!0,O())}function K(T,R){j=y(function(){T(t.unstable_now())},R)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){w||p||(w=!0,F(_))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(T){switch(f){case 1:case 2:case 3:var R=3;break;default:R=f}var V=f;f=R;try{return T()}finally{f=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,R){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var V=f;f=T;try{return R()}finally{f=V}},t.unstable_scheduleCallback=function(T,R,V){var G=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?G+V:G):V=G,T){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=V+Q,T={id:d++,callback:R,priorityLevel:T,startTime:V,expirationTime:Q,sortIndex:-1},V>G?(T.sortIndex=V,e(u,T),n(l)===null&&T===n(u)&&(x?(g(j),j=-1):x=!0,K(k,V-G))):(T.sortIndex=Q,e(l,T),w||p||(w=!0,F(_))),T},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(T){var R=f;return function(){var V=f;f=R;try{return T.apply(this,arguments)}finally{f=V}}}})(N1);C1.exports=N1;var sR=C1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rR=v,Ts=sR;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var E1=new Set,bu={};function Pa(t,e){ec(t,e),ec(t+"Capture",e)}function ec(t,e){for(bu[t]=e,t=0;t<e.length;t++)E1.add(e[t])}var ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yg=Object.prototype.hasOwnProperty,iR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cb={},Nb={};function oR(t){return Yg.call(Nb,t)?!0:Yg.call(Cb,t)?!1:iR.test(t)?Nb[t]=!0:(Cb[t]=!0,!1)}function aR(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function lR(t,e,n,s){if(e===null||typeof e>"u"||aR(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hn(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var kn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kn[t]=new Hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kn[e]=new Hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kn[t]=new Hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kn[t]=new Hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kn[t]=new Hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kn[t]=new Hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kn[t]=new Hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kn[t]=new Hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kn[t]=new Hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var nv=/[\-:]([a-z])/g;function sv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(nv,sv);kn[e]=new Hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(nv,sv);kn[e]=new Hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(nv,sv);kn[e]=new Hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!1,!1)});kn.xlinkHref=new Hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kn[t]=new Hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function rv(t,e,n,s){var r=kn.hasOwnProperty(e)?kn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(lR(e,n,r,s)&&(n=null),s||r===null?oR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var yi=rR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sh=Symbol.for("react.element"),ll=Symbol.for("react.portal"),cl=Symbol.for("react.fragment"),iv=Symbol.for("react.strict_mode"),Qg=Symbol.for("react.profiler"),T1=Symbol.for("react.provider"),P1=Symbol.for("react.context"),ov=Symbol.for("react.forward_ref"),Xg=Symbol.for("react.suspense"),Jg=Symbol.for("react.suspense_list"),av=Symbol.for("react.memo"),Ti=Symbol.for("react.lazy"),R1=Symbol.for("react.offscreen"),Eb=Symbol.iterator;function Ec(t){return t===null||typeof t!="object"?null:(t=Eb&&t[Eb]||t["@@iterator"],typeof t=="function"?t:null)}var Ut=Object.assign,jm;function qc(t){if(jm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);jm=e&&e[1]||""}return`
`+jm+t}var Cm=!1;function Nm(t,e){if(!t||Cm)return"";Cm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Cm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?qc(t):""}function cR(t){switch(t.tag){case 5:return qc(t.type);case 16:return qc("Lazy");case 13:return qc("Suspense");case 19:return qc("SuspenseList");case 0:case 2:case 15:return t=Nm(t.type,!1),t;case 11:return t=Nm(t.type.render,!1),t;case 1:return t=Nm(t.type,!0),t;default:return""}}function Zg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case cl:return"Fragment";case ll:return"Portal";case Qg:return"Profiler";case iv:return"StrictMode";case Xg:return"Suspense";case Jg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case P1:return(t.displayName||"Context")+".Consumer";case T1:return(t._context.displayName||"Context")+".Provider";case ov:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case av:return e=t.displayName||null,e!==null?e:Zg(t.type)||"Memo";case Ti:e=t._payload,t=t._init;try{return Zg(t(e))}catch{}}return null}function uR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zg(e);case 8:return e===iv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ho(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function A1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function dR(t){var e=A1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rh(t){t._valueTracker||(t._valueTracker=dR(t))}function O1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=A1(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Af(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ex(t,e){var n=e.checked;return Ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Tb(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=ho(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function M1(t,e){e=e.checked,e!=null&&rv(t,"checked",e,!1)}function tx(t,e){M1(t,e);var n=ho(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?nx(t,e.type,n):e.hasOwnProperty("defaultValue")&&nx(t,e.type,ho(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Pb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function nx(t,e,n){(e!=="number"||Af(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Kc=Array.isArray;function _l(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+ho(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function sx(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return Ut({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Rb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(fe(92));if(Kc(n)){if(1<n.length)throw Error(fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ho(n)}}function I1(t,e){var n=ho(e.value),s=ho(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function Ab(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function D1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rx(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?D1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ih,L1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ih=ih||document.createElement("div"),ih.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ih.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function wu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ru={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hR=["Webkit","ms","Moz","O"];Object.keys(ru).forEach(function(t){hR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ru[e]=ru[t]})});function $1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ru.hasOwnProperty(t)&&ru[t]?(""+e).trim():e+"px"}function F1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=$1(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var fR=Ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ix(t,e){if(e){if(fR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function ox(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ax=null;function lv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var lx=null,Sl=null,jl=null;function Ob(t){if(t=_d(t)){if(typeof lx!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=Lp(e),lx(t.stateNode,t.type,e))}}function z1(t){Sl?jl?jl.push(t):jl=[t]:Sl=t}function B1(){if(Sl){var t=Sl,e=jl;if(jl=Sl=null,Ob(t),e)for(t=0;t<e.length;t++)Ob(e[t])}}function U1(t,e){return t(e)}function H1(){}var Em=!1;function W1(t,e,n){if(Em)return t(e,n);Em=!0;try{return U1(t,e,n)}finally{Em=!1,(Sl!==null||jl!==null)&&(H1(),B1())}}function ku(t,e){var n=t.stateNode;if(n===null)return null;var s=Lp(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(fe(231,e,typeof n));return n}var cx=!1;if(ui)try{var Tc={};Object.defineProperty(Tc,"passive",{get:function(){cx=!0}}),window.addEventListener("test",Tc,Tc),window.removeEventListener("test",Tc,Tc)}catch{cx=!1}function pR(t,e,n,s,r,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var iu=!1,Of=null,Mf=!1,ux=null,mR={onError:function(t){iu=!0,Of=t}};function gR(t,e,n,s,r,i,o,a,l){iu=!1,Of=null,pR.apply(mR,arguments)}function xR(t,e,n,s,r,i,o,a,l){if(gR.apply(this,arguments),iu){if(iu){var u=Of;iu=!1,Of=null}else throw Error(fe(198));Mf||(Mf=!0,ux=u)}}function Ra(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function V1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Mb(t){if(Ra(t)!==t)throw Error(fe(188))}function yR(t){var e=t.alternate;if(!e){if(e=Ra(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return Mb(r),t;if(i===s)return Mb(r),e;i=i.sibling}throw Error(fe(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(fe(189))}}if(n.alternate!==s)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?t:e}function q1(t){return t=yR(t),t!==null?K1(t):null}function K1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=K1(t);if(e!==null)return e;t=t.sibling}return null}var G1=Ts.unstable_scheduleCallback,Ib=Ts.unstable_cancelCallback,vR=Ts.unstable_shouldYield,bR=Ts.unstable_requestPaint,Jt=Ts.unstable_now,wR=Ts.unstable_getCurrentPriorityLevel,cv=Ts.unstable_ImmediatePriority,Y1=Ts.unstable_UserBlockingPriority,If=Ts.unstable_NormalPriority,kR=Ts.unstable_LowPriority,Q1=Ts.unstable_IdlePriority,Op=null,Lr=null;function _R(t){if(Lr&&typeof Lr.onCommitFiberRoot=="function")try{Lr.onCommitFiberRoot(Op,t,void 0,(t.current.flags&128)===128)}catch{}}var cr=Math.clz32?Math.clz32:CR,SR=Math.log,jR=Math.LN2;function CR(t){return t>>>=0,t===0?32:31-(SR(t)/jR|0)|0}var oh=64,ah=4194304;function Gc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Df(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Gc(a):(i&=o,i!==0&&(s=Gc(i)))}else o=n&~r,o!==0?s=Gc(o):i!==0&&(s=Gc(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-cr(e),r=1<<n,s|=t[n],e&=~r;return s}function NR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ER(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-cr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=NR(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function dx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function X1(){var t=oh;return oh<<=1,!(oh&4194240)&&(oh=64),t}function Tm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-cr(e),t[e]=n}function TR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-cr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function uv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-cr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var xt=0;function J1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Z1,dv,ej,tj,nj,hx=!1,lh=[],Zi=null,eo=null,to=null,_u=new Map,Su=new Map,Ai=[],PR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Db(t,e){switch(t){case"focusin":case"focusout":Zi=null;break;case"dragenter":case"dragleave":eo=null;break;case"mouseover":case"mouseout":to=null;break;case"pointerover":case"pointerout":_u.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Su.delete(e.pointerId)}}function Pc(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=_d(e),e!==null&&dv(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function RR(t,e,n,s,r){switch(e){case"focusin":return Zi=Pc(Zi,t,e,n,s,r),!0;case"dragenter":return eo=Pc(eo,t,e,n,s,r),!0;case"mouseover":return to=Pc(to,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return _u.set(i,Pc(_u.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Su.set(i,Pc(Su.get(i)||null,t,e,n,s,r)),!0}return!1}function sj(t){var e=Yo(t.target);if(e!==null){var n=Ra(e);if(n!==null){if(e=n.tag,e===13){if(e=V1(n),e!==null){t.blockedOn=e,nj(t.priority,function(){ej(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function af(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=fx(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);ax=s,n.target.dispatchEvent(s),ax=null}else return e=_d(n),e!==null&&dv(e),t.blockedOn=n,!1;e.shift()}return!0}function Lb(t,e,n){af(t)&&n.delete(e)}function AR(){hx=!1,Zi!==null&&af(Zi)&&(Zi=null),eo!==null&&af(eo)&&(eo=null),to!==null&&af(to)&&(to=null),_u.forEach(Lb),Su.forEach(Lb)}function Rc(t,e){t.blockedOn===e&&(t.blockedOn=null,hx||(hx=!0,Ts.unstable_scheduleCallback(Ts.unstable_NormalPriority,AR)))}function ju(t){function e(r){return Rc(r,t)}if(0<lh.length){Rc(lh[0],t);for(var n=1;n<lh.length;n++){var s=lh[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Zi!==null&&Rc(Zi,t),eo!==null&&Rc(eo,t),to!==null&&Rc(to,t),_u.forEach(e),Su.forEach(e),n=0;n<Ai.length;n++)s=Ai[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Ai.length&&(n=Ai[0],n.blockedOn===null);)sj(n),n.blockedOn===null&&Ai.shift()}var Cl=yi.ReactCurrentBatchConfig,Lf=!0;function OR(t,e,n,s){var r=xt,i=Cl.transition;Cl.transition=null;try{xt=1,hv(t,e,n,s)}finally{xt=r,Cl.transition=i}}function MR(t,e,n,s){var r=xt,i=Cl.transition;Cl.transition=null;try{xt=4,hv(t,e,n,s)}finally{xt=r,Cl.transition=i}}function hv(t,e,n,s){if(Lf){var r=fx(t,e,n,s);if(r===null)Fm(t,e,s,$f,n),Db(t,s);else if(RR(r,t,e,n,s))s.stopPropagation();else if(Db(t,s),e&4&&-1<PR.indexOf(t)){for(;r!==null;){var i=_d(r);if(i!==null&&Z1(i),i=fx(t,e,n,s),i===null&&Fm(t,e,s,$f,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Fm(t,e,s,null,n)}}var $f=null;function fx(t,e,n,s){if($f=null,t=lv(s),t=Yo(t),t!==null)if(e=Ra(t),e===null)t=null;else if(n=e.tag,n===13){if(t=V1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $f=t,null}function rj(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wR()){case cv:return 1;case Y1:return 4;case If:case kR:return 16;case Q1:return 536870912;default:return 16}default:return 16}}var qi=null,fv=null,lf=null;function ij(){if(lf)return lf;var t,e=fv,n=e.length,s,r="value"in qi?qi.value:qi.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return lf=r.slice(t,1<s?1-s:void 0)}function cf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ch(){return!0}function $b(){return!1}function Rs(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ch:$b,this.isPropagationStopped=$b,this}return Ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ch)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ch)},persist:function(){},isPersistent:ch}),e}var uc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pv=Rs(uc),kd=Ut({},uc,{view:0,detail:0}),IR=Rs(kd),Pm,Rm,Ac,Mp=Ut({},kd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ac&&(Ac&&t.type==="mousemove"?(Pm=t.screenX-Ac.screenX,Rm=t.screenY-Ac.screenY):Rm=Pm=0,Ac=t),Pm)},movementY:function(t){return"movementY"in t?t.movementY:Rm}}),Fb=Rs(Mp),DR=Ut({},Mp,{dataTransfer:0}),LR=Rs(DR),$R=Ut({},kd,{relatedTarget:0}),Am=Rs($R),FR=Ut({},uc,{animationName:0,elapsedTime:0,pseudoElement:0}),zR=Rs(FR),BR=Ut({},uc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UR=Rs(BR),HR=Ut({},uc,{data:0}),zb=Rs(HR),WR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qR[t])?!!e[t]:!1}function mv(){return KR}var GR=Ut({},kd,{key:function(t){if(t.key){var e=WR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=cf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?VR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mv,charCode:function(t){return t.type==="keypress"?cf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?cf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),YR=Rs(GR),QR=Ut({},Mp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bb=Rs(QR),XR=Ut({},kd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mv}),JR=Rs(XR),ZR=Ut({},uc,{propertyName:0,elapsedTime:0,pseudoElement:0}),eA=Rs(ZR),tA=Ut({},Mp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),nA=Rs(tA),sA=[9,13,27,32],gv=ui&&"CompositionEvent"in window,ou=null;ui&&"documentMode"in document&&(ou=document.documentMode);var rA=ui&&"TextEvent"in window&&!ou,oj=ui&&(!gv||ou&&8<ou&&11>=ou),Ub=" ",Hb=!1;function aj(t,e){switch(t){case"keyup":return sA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lj(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ul=!1;function iA(t,e){switch(t){case"compositionend":return lj(e);case"keypress":return e.which!==32?null:(Hb=!0,Ub);case"textInput":return t=e.data,t===Ub&&Hb?null:t;default:return null}}function oA(t,e){if(ul)return t==="compositionend"||!gv&&aj(t,e)?(t=ij(),lf=fv=qi=null,ul=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return oj&&e.locale!=="ko"?null:e.data;default:return null}}var aA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aA[t.type]:e==="textarea"}function cj(t,e,n,s){z1(s),e=Ff(e,"onChange"),0<e.length&&(n=new pv("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var au=null,Cu=null;function lA(t){bj(t,0)}function Ip(t){var e=fl(t);if(O1(e))return t}function cA(t,e){if(t==="change")return e}var uj=!1;if(ui){var Om;if(ui){var Mm="oninput"in document;if(!Mm){var Vb=document.createElement("div");Vb.setAttribute("oninput","return;"),Mm=typeof Vb.oninput=="function"}Om=Mm}else Om=!1;uj=Om&&(!document.documentMode||9<document.documentMode)}function qb(){au&&(au.detachEvent("onpropertychange",dj),Cu=au=null)}function dj(t){if(t.propertyName==="value"&&Ip(Cu)){var e=[];cj(e,Cu,t,lv(t)),W1(lA,e)}}function uA(t,e,n){t==="focusin"?(qb(),au=e,Cu=n,au.attachEvent("onpropertychange",dj)):t==="focusout"&&qb()}function dA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ip(Cu)}function hA(t,e){if(t==="click")return Ip(e)}function fA(t,e){if(t==="input"||t==="change")return Ip(e)}function pA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hr=typeof Object.is=="function"?Object.is:pA;function Nu(t,e){if(hr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Yg.call(e,r)||!hr(t[r],e[r]))return!1}return!0}function Kb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gb(t,e){var n=Kb(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Kb(n)}}function hj(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?hj(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function fj(){for(var t=window,e=Af();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Af(t.document)}return e}function xv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mA(t){var e=fj(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hj(n.ownerDocument.documentElement,n)){if(s!==null&&xv(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=Gb(n,i);var o=Gb(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gA=ui&&"documentMode"in document&&11>=document.documentMode,dl=null,px=null,lu=null,mx=!1;function Yb(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;mx||dl==null||dl!==Af(s)||(s=dl,"selectionStart"in s&&xv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),lu&&Nu(lu,s)||(lu=s,s=Ff(px,"onSelect"),0<s.length&&(e=new pv("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=dl)))}function uh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var hl={animationend:uh("Animation","AnimationEnd"),animationiteration:uh("Animation","AnimationIteration"),animationstart:uh("Animation","AnimationStart"),transitionend:uh("Transition","TransitionEnd")},Im={},pj={};ui&&(pj=document.createElement("div").style,"AnimationEvent"in window||(delete hl.animationend.animation,delete hl.animationiteration.animation,delete hl.animationstart.animation),"TransitionEvent"in window||delete hl.transitionend.transition);function Dp(t){if(Im[t])return Im[t];if(!hl[t])return t;var e=hl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in pj)return Im[t]=e[n];return t}var mj=Dp("animationend"),gj=Dp("animationiteration"),xj=Dp("animationstart"),yj=Dp("transitionend"),vj=new Map,Qb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bo(t,e){vj.set(t,e),Pa(e,[t])}for(var Dm=0;Dm<Qb.length;Dm++){var Lm=Qb[Dm],xA=Lm.toLowerCase(),yA=Lm[0].toUpperCase()+Lm.slice(1);bo(xA,"on"+yA)}bo(mj,"onAnimationEnd");bo(gj,"onAnimationIteration");bo(xj,"onAnimationStart");bo("dblclick","onDoubleClick");bo("focusin","onFocus");bo("focusout","onBlur");bo(yj,"onTransitionEnd");ec("onMouseEnter",["mouseout","mouseover"]);ec("onMouseLeave",["mouseout","mouseover"]);ec("onPointerEnter",["pointerout","pointerover"]);ec("onPointerLeave",["pointerout","pointerover"]);Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yc));function Xb(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,xR(s,e,void 0,t),t.currentTarget=null}function bj(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;Xb(r,a,u),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;Xb(r,a,u),i=l}}}if(Mf)throw t=ux,Mf=!1,ux=null,t}function Nt(t,e){var n=e[bx];n===void 0&&(n=e[bx]=new Set);var s=t+"__bubble";n.has(s)||(wj(e,t,2,!1),n.add(s))}function $m(t,e,n){var s=0;e&&(s|=4),wj(n,t,s,e)}var dh="_reactListening"+Math.random().toString(36).slice(2);function Eu(t){if(!t[dh]){t[dh]=!0,E1.forEach(function(n){n!=="selectionchange"&&(vA.has(n)||$m(n,!1,t),$m(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[dh]||(e[dh]=!0,$m("selectionchange",!1,e))}}function wj(t,e,n,s){switch(rj(e)){case 1:var r=OR;break;case 4:r=MR;break;default:r=hv}n=r.bind(null,e,n,t),r=void 0,!cx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Fm(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Yo(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}W1(function(){var u=i,d=lv(n),h=[];e:{var f=vj.get(t);if(f!==void 0){var p=pv,w=t;switch(t){case"keypress":if(cf(n)===0)break e;case"keydown":case"keyup":p=YR;break;case"focusin":w="focus",p=Am;break;case"focusout":w="blur",p=Am;break;case"beforeblur":case"afterblur":p=Am;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Fb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=LR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=JR;break;case mj:case gj:case xj:p=zR;break;case yj:p=eA;break;case"scroll":p=IR;break;case"wheel":p=nA;break;case"copy":case"cut":case"paste":p=UR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Bb}var x=(e&4)!==0,y=!x&&t==="scroll",g=x?f!==null?f+"Capture":null:f;x=[];for(var m=u,b;m!==null;){b=m;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,g!==null&&(k=ku(m,g),k!=null&&x.push(Tu(m,k,b)))),y)break;m=m.return}0<x.length&&(f=new p(f,w,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==ax&&(w=n.relatedTarget||n.fromElement)&&(Yo(w)||w[di]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(w=n.relatedTarget||n.toElement,p=u,w=w?Yo(w):null,w!==null&&(y=Ra(w),w!==y||w.tag!==5&&w.tag!==6)&&(w=null)):(p=null,w=u),p!==w)){if(x=Fb,k="onMouseLeave",g="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(x=Bb,k="onPointerLeave",g="onPointerEnter",m="pointer"),y=p==null?f:fl(p),b=w==null?f:fl(w),f=new x(k,m+"leave",p,n,d),f.target=y,f.relatedTarget=b,k=null,Yo(d)===u&&(x=new x(g,m+"enter",w,n,d),x.target=b,x.relatedTarget=y,k=x),y=k,p&&w)t:{for(x=p,g=w,m=0,b=x;b;b=Va(b))m++;for(b=0,k=g;k;k=Va(k))b++;for(;0<m-b;)x=Va(x),m--;for(;0<b-m;)g=Va(g),b--;for(;m--;){if(x===g||g!==null&&x===g.alternate)break t;x=Va(x),g=Va(g)}x=null}else x=null;p!==null&&Jb(h,f,p,x,!1),w!==null&&y!==null&&Jb(h,y,w,x,!0)}}e:{if(f=u?fl(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var _=cA;else if(Wb(f))if(uj)_=fA;else{_=dA;var C=uA}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=hA);if(_&&(_=_(t,u))){cj(h,_,n,d);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&nx(f,"number",f.value)}switch(C=u?fl(u):window,t){case"focusin":(Wb(C)||C.contentEditable==="true")&&(dl=C,px=u,lu=null);break;case"focusout":lu=px=dl=null;break;case"mousedown":mx=!0;break;case"contextmenu":case"mouseup":case"dragend":mx=!1,Yb(h,n,d);break;case"selectionchange":if(gA)break;case"keydown":case"keyup":Yb(h,n,d)}var S;if(gv)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else ul?aj(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(oj&&n.locale!=="ko"&&(ul||j!=="onCompositionStart"?j==="onCompositionEnd"&&ul&&(S=ij()):(qi=d,fv="value"in qi?qi.value:qi.textContent,ul=!0)),C=Ff(u,j),0<C.length&&(j=new zb(j,t,null,n,d),h.push({event:j,listeners:C}),S?j.data=S:(S=lj(n),S!==null&&(j.data=S)))),(S=rA?iA(t,n):oA(t,n))&&(u=Ff(u,"onBeforeInput"),0<u.length&&(d=new zb("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=S))}bj(h,e)})}function Tu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ff(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=ku(t,n),i!=null&&s.unshift(Tu(t,i,r)),i=ku(t,e),i!=null&&s.push(Tu(t,i,r))),t=t.return}return s}function Va(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jb(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&u!==null&&(a=u,r?(l=ku(n,i),l!=null&&o.unshift(Tu(n,l,a))):r||(l=ku(n,i),l!=null&&o.push(Tu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bA=/\r\n?/g,wA=/\u0000|\uFFFD/g;function Zb(t){return(typeof t=="string"?t:""+t).replace(bA,`
`).replace(wA,"")}function hh(t,e,n){if(e=Zb(e),Zb(t)!==e&&n)throw Error(fe(425))}function zf(){}var gx=null,xx=null;function yx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vx=typeof setTimeout=="function"?setTimeout:void 0,kA=typeof clearTimeout=="function"?clearTimeout:void 0,ew=typeof Promise=="function"?Promise:void 0,_A=typeof queueMicrotask=="function"?queueMicrotask:typeof ew<"u"?function(t){return ew.resolve(null).then(t).catch(SA)}:vx;function SA(t){setTimeout(function(){throw t})}function zm(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),ju(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);ju(e)}function no(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function tw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var dc=Math.random().toString(36).slice(2),Or="__reactFiber$"+dc,Pu="__reactProps$"+dc,di="__reactContainer$"+dc,bx="__reactEvents$"+dc,jA="__reactListeners$"+dc,CA="__reactHandles$"+dc;function Yo(t){var e=t[Or];if(e)return e;for(var n=t.parentNode;n;){if(e=n[di]||n[Or]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=tw(t);t!==null;){if(n=t[Or])return n;t=tw(t)}return e}t=n,n=t.parentNode}return null}function _d(t){return t=t[Or]||t[di],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function fl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function Lp(t){return t[Pu]||null}var wx=[],pl=-1;function wo(t){return{current:t}}function Rt(t){0>pl||(t.current=wx[pl],wx[pl]=null,pl--)}function _t(t,e){pl++,wx[pl]=t.current,t.current=e}var fo={},On=wo(fo),os=wo(!1),ya=fo;function tc(t,e){var n=t.type.contextTypes;if(!n)return fo;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function as(t){return t=t.childContextTypes,t!=null}function Bf(){Rt(os),Rt(On)}function nw(t,e,n){if(On.current!==fo)throw Error(fe(168));_t(On,e),_t(os,n)}function kj(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(fe(108,uR(t)||"Unknown",r));return Ut({},n,s)}function Uf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fo,ya=On.current,_t(On,t),_t(os,os.current),!0}function sw(t,e,n){var s=t.stateNode;if(!s)throw Error(fe(169));n?(t=kj(t,e,ya),s.__reactInternalMemoizedMergedChildContext=t,Rt(os),Rt(On),_t(On,t)):Rt(os),_t(os,n)}var Xr=null,$p=!1,Bm=!1;function _j(t){Xr===null?Xr=[t]:Xr.push(t)}function NA(t){$p=!0,_j(t)}function ko(){if(!Bm&&Xr!==null){Bm=!0;var t=0,e=xt;try{var n=Xr;for(xt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Xr=null,$p=!1}catch(r){throw Xr!==null&&(Xr=Xr.slice(t+1)),G1(cv,ko),r}finally{xt=e,Bm=!1}}return null}var ml=[],gl=0,Hf=null,Wf=0,Ls=[],$s=0,va=null,si=1,ri="";function Uo(t,e){ml[gl++]=Wf,ml[gl++]=Hf,Hf=t,Wf=e}function Sj(t,e,n){Ls[$s++]=si,Ls[$s++]=ri,Ls[$s++]=va,va=t;var s=si;t=ri;var r=32-cr(s)-1;s&=~(1<<r),n+=1;var i=32-cr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,si=1<<32-cr(e)+r|n<<r|s,ri=i+t}else si=1<<i|n<<r|s,ri=t}function yv(t){t.return!==null&&(Uo(t,1),Sj(t,1,0))}function vv(t){for(;t===Hf;)Hf=ml[--gl],ml[gl]=null,Wf=ml[--gl],ml[gl]=null;for(;t===va;)va=Ls[--$s],Ls[$s]=null,ri=Ls[--$s],Ls[$s]=null,si=Ls[--$s],Ls[$s]=null}var js=null,Ss=null,Dt=!1,lr=null;function jj(t,e){var n=Fs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function rw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,js=t,Ss=no(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,js=t,Ss=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=va!==null?{id:si,overflow:ri}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,js=t,Ss=null,!0):!1;default:return!1}}function kx(t){return(t.mode&1)!==0&&(t.flags&128)===0}function _x(t){if(Dt){var e=Ss;if(e){var n=e;if(!rw(t,e)){if(kx(t))throw Error(fe(418));e=no(n.nextSibling);var s=js;e&&rw(t,e)?jj(s,n):(t.flags=t.flags&-4097|2,Dt=!1,js=t)}}else{if(kx(t))throw Error(fe(418));t.flags=t.flags&-4097|2,Dt=!1,js=t}}}function iw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;js=t}function fh(t){if(t!==js)return!1;if(!Dt)return iw(t),Dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!yx(t.type,t.memoizedProps)),e&&(e=Ss)){if(kx(t))throw Cj(),Error(fe(418));for(;e;)jj(t,e),e=no(e.nextSibling)}if(iw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ss=no(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ss=null}}else Ss=js?no(t.stateNode.nextSibling):null;return!0}function Cj(){for(var t=Ss;t;)t=no(t.nextSibling)}function nc(){Ss=js=null,Dt=!1}function bv(t){lr===null?lr=[t]:lr.push(t)}var EA=yi.ReactCurrentBatchConfig;function Oc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var s=n.stateNode}if(!s)throw Error(fe(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,t))}return t}function ph(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ow(t){var e=t._init;return e(t._payload)}function Nj(t){function e(g,m){if(t){var b=g.deletions;b===null?(g.deletions=[m],g.flags|=16):b.push(m)}}function n(g,m){if(!t)return null;for(;m!==null;)e(g,m),m=m.sibling;return null}function s(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function r(g,m){return g=oo(g,m),g.index=0,g.sibling=null,g}function i(g,m,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<m?(g.flags|=2,m):b):(g.flags|=2,m)):(g.flags|=1048576,m)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,m,b,k){return m===null||m.tag!==6?(m=Gm(b,g.mode,k),m.return=g,m):(m=r(m,b),m.return=g,m)}function l(g,m,b,k){var _=b.type;return _===cl?d(g,m,b.props.children,k,b.key):m!==null&&(m.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ti&&ow(_)===m.type)?(k=r(m,b.props),k.ref=Oc(g,m,b),k.return=g,k):(k=gf(b.type,b.key,b.props,null,g.mode,k),k.ref=Oc(g,m,b),k.return=g,k)}function u(g,m,b,k){return m===null||m.tag!==4||m.stateNode.containerInfo!==b.containerInfo||m.stateNode.implementation!==b.implementation?(m=Ym(b,g.mode,k),m.return=g,m):(m=r(m,b.children||[]),m.return=g,m)}function d(g,m,b,k,_){return m===null||m.tag!==7?(m=ha(b,g.mode,k,_),m.return=g,m):(m=r(m,b),m.return=g,m)}function h(g,m,b){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Gm(""+m,g.mode,b),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case sh:return b=gf(m.type,m.key,m.props,null,g.mode,b),b.ref=Oc(g,null,m),b.return=g,b;case ll:return m=Ym(m,g.mode,b),m.return=g,m;case Ti:var k=m._init;return h(g,k(m._payload),b)}if(Kc(m)||Ec(m))return m=ha(m,g.mode,b,null),m.return=g,m;ph(g,m)}return null}function f(g,m,b,k){var _=m!==null?m.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:a(g,m,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case sh:return b.key===_?l(g,m,b,k):null;case ll:return b.key===_?u(g,m,b,k):null;case Ti:return _=b._init,f(g,m,_(b._payload),k)}if(Kc(b)||Ec(b))return _!==null?null:d(g,m,b,k,null);ph(g,b)}return null}function p(g,m,b,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(b)||null,a(m,g,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case sh:return g=g.get(k.key===null?b:k.key)||null,l(m,g,k,_);case ll:return g=g.get(k.key===null?b:k.key)||null,u(m,g,k,_);case Ti:var C=k._init;return p(g,m,b,C(k._payload),_)}if(Kc(k)||Ec(k))return g=g.get(b)||null,d(m,g,k,_,null);ph(m,k)}return null}function w(g,m,b,k){for(var _=null,C=null,S=m,j=m=0,E=null;S!==null&&j<b.length;j++){S.index>j?(E=S,S=null):E=S.sibling;var P=f(g,S,b[j],k);if(P===null){S===null&&(S=E);break}t&&S&&P.alternate===null&&e(g,S),m=i(P,m,j),C===null?_=P:C.sibling=P,C=P,S=E}if(j===b.length)return n(g,S),Dt&&Uo(g,j),_;if(S===null){for(;j<b.length;j++)S=h(g,b[j],k),S!==null&&(m=i(S,m,j),C===null?_=S:C.sibling=S,C=S);return Dt&&Uo(g,j),_}for(S=s(g,S);j<b.length;j++)E=p(S,g,j,b[j],k),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?j:E.key),m=i(E,m,j),C===null?_=E:C.sibling=E,C=E);return t&&S.forEach(function(L){return e(g,L)}),Dt&&Uo(g,j),_}function x(g,m,b,k){var _=Ec(b);if(typeof _!="function")throw Error(fe(150));if(b=_.call(b),b==null)throw Error(fe(151));for(var C=_=null,S=m,j=m=0,E=null,P=b.next();S!==null&&!P.done;j++,P=b.next()){S.index>j?(E=S,S=null):E=S.sibling;var L=f(g,S,P.value,k);if(L===null){S===null&&(S=E);break}t&&S&&L.alternate===null&&e(g,S),m=i(L,m,j),C===null?_=L:C.sibling=L,C=L,S=E}if(P.done)return n(g,S),Dt&&Uo(g,j),_;if(S===null){for(;!P.done;j++,P=b.next())P=h(g,P.value,k),P!==null&&(m=i(P,m,j),C===null?_=P:C.sibling=P,C=P);return Dt&&Uo(g,j),_}for(S=s(g,S);!P.done;j++,P=b.next())P=p(S,g,j,P.value,k),P!==null&&(t&&P.alternate!==null&&S.delete(P.key===null?j:P.key),m=i(P,m,j),C===null?_=P:C.sibling=P,C=P);return t&&S.forEach(function(I){return e(g,I)}),Dt&&Uo(g,j),_}function y(g,m,b,k){if(typeof b=="object"&&b!==null&&b.type===cl&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case sh:e:{for(var _=b.key,C=m;C!==null;){if(C.key===_){if(_=b.type,_===cl){if(C.tag===7){n(g,C.sibling),m=r(C,b.props.children),m.return=g,g=m;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ti&&ow(_)===C.type){n(g,C.sibling),m=r(C,b.props),m.ref=Oc(g,C,b),m.return=g,g=m;break e}n(g,C);break}else e(g,C);C=C.sibling}b.type===cl?(m=ha(b.props.children,g.mode,k,b.key),m.return=g,g=m):(k=gf(b.type,b.key,b.props,null,g.mode,k),k.ref=Oc(g,m,b),k.return=g,g=k)}return o(g);case ll:e:{for(C=b.key;m!==null;){if(m.key===C)if(m.tag===4&&m.stateNode.containerInfo===b.containerInfo&&m.stateNode.implementation===b.implementation){n(g,m.sibling),m=r(m,b.children||[]),m.return=g,g=m;break e}else{n(g,m);break}else e(g,m);m=m.sibling}m=Ym(b,g.mode,k),m.return=g,g=m}return o(g);case Ti:return C=b._init,y(g,m,C(b._payload),k)}if(Kc(b))return w(g,m,b,k);if(Ec(b))return x(g,m,b,k);ph(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,m!==null&&m.tag===6?(n(g,m.sibling),m=r(m,b),m.return=g,g=m):(n(g,m),m=Gm(b,g.mode,k),m.return=g,g=m),o(g)):n(g,m)}return y}var sc=Nj(!0),Ej=Nj(!1),Vf=wo(null),qf=null,xl=null,wv=null;function kv(){wv=xl=qf=null}function _v(t){var e=Vf.current;Rt(Vf),t._currentValue=e}function Sx(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Nl(t,e){qf=t,wv=xl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ns=!0),t.firstContext=null)}function Ws(t){var e=t._currentValue;if(wv!==t)if(t={context:t,memoizedValue:e,next:null},xl===null){if(qf===null)throw Error(fe(308));xl=t,qf.dependencies={lanes:0,firstContext:t}}else xl=xl.next=t;return e}var Qo=null;function Sv(t){Qo===null?Qo=[t]:Qo.push(t)}function Tj(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,Sv(e)):(n.next=r.next,r.next=n),e.interleaved=n,hi(t,s)}function hi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pi=!1;function jv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pj(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ai(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function so(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,st&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,hi(t,n)}return r=s.interleaved,r===null?(e.next=e,Sv(s)):(e.next=r.next,r.next=e),s.interleaved=e,hi(t,n)}function uf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,uv(t,n)}}function aw(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Kf(t,e,n,s){var r=t.updateQueue;Pi=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,d=u=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=t,x=a;switch(f=e,p=n,x.tag){case 1:if(w=x.payload,typeof w=="function"){h=w.call(p,h,f);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=x.payload,f=typeof w=="function"?w.call(p,h,f):w,f==null)break e;h=Ut({},h,f);break e;case 2:Pi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,l=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(d===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);wa|=o,t.lanes=o,t.memoizedState=h}}function lw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(fe(191,r));r.call(s)}}}var Sd={},$r=wo(Sd),Ru=wo(Sd),Au=wo(Sd);function Xo(t){if(t===Sd)throw Error(fe(174));return t}function Cv(t,e){switch(_t(Au,e),_t(Ru,t),_t($r,Sd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rx(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rx(e,t)}Rt($r),_t($r,e)}function rc(){Rt($r),Rt(Ru),Rt(Au)}function Rj(t){Xo(Au.current);var e=Xo($r.current),n=rx(e,t.type);e!==n&&(_t(Ru,t),_t($r,n))}function Nv(t){Ru.current===t&&(Rt($r),Rt(Ru))}var Ft=wo(0);function Gf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Um=[];function Ev(){for(var t=0;t<Um.length;t++)Um[t]._workInProgressVersionPrimary=null;Um.length=0}var df=yi.ReactCurrentDispatcher,Hm=yi.ReactCurrentBatchConfig,ba=0,Bt=null,an=null,fn=null,Yf=!1,cu=!1,Ou=0,TA=0;function Cn(){throw Error(fe(321))}function Tv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!hr(t[n],e[n]))return!1;return!0}function Pv(t,e,n,s,r,i){if(ba=i,Bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,df.current=t===null||t.memoizedState===null?OA:MA,t=n(s,r),cu){i=0;do{if(cu=!1,Ou=0,25<=i)throw Error(fe(301));i+=1,fn=an=null,e.updateQueue=null,df.current=IA,t=n(s,r)}while(cu)}if(df.current=Qf,e=an!==null&&an.next!==null,ba=0,fn=an=Bt=null,Yf=!1,e)throw Error(fe(300));return t}function Rv(){var t=Ou!==0;return Ou=0,t}function jr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?Bt.memoizedState=fn=t:fn=fn.next=t,fn}function Vs(){if(an===null){var t=Bt.alternate;t=t!==null?t.memoizedState:null}else t=an.next;var e=fn===null?Bt.memoizedState:fn.next;if(e!==null)fn=e,an=t;else{if(t===null)throw Error(fe(310));an=t,t={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},fn===null?Bt.memoizedState=fn=t:fn=fn.next=t}return fn}function Mu(t,e){return typeof e=="function"?e(t):e}function Wm(t){var e=Vs(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var s=an,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,u=i;do{var d=u.lane;if((ba&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,Bt.lanes|=d,wa|=d}u=u.next}while(u!==null&&u!==i);l===null?o=s:l.next=a,hr(s,e.memoizedState)||(ns=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Bt.lanes|=i,wa|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vm(t){var e=Vs(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);hr(i,e.memoizedState)||(ns=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function Aj(){}function Oj(t,e){var n=Bt,s=Vs(),r=e(),i=!hr(s.memoizedState,r);if(i&&(s.memoizedState=r,ns=!0),s=s.queue,Av(Dj.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||fn!==null&&fn.memoizedState.tag&1){if(n.flags|=2048,Iu(9,Ij.bind(null,n,s,r,e),void 0,null),mn===null)throw Error(fe(349));ba&30||Mj(n,e,r)}return r}function Mj(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ij(t,e,n,s){e.value=n,e.getSnapshot=s,Lj(e)&&$j(t)}function Dj(t,e,n){return n(function(){Lj(e)&&$j(t)})}function Lj(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hr(t,n)}catch{return!0}}function $j(t){var e=hi(t,1);e!==null&&ur(e,t,1,-1)}function cw(t){var e=jr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mu,lastRenderedState:t},e.queue=t,t=t.dispatch=AA.bind(null,Bt,t),[e.memoizedState,t]}function Iu(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function Fj(){return Vs().memoizedState}function hf(t,e,n,s){var r=jr();Bt.flags|=t,r.memoizedState=Iu(1|e,n,void 0,s===void 0?null:s)}function Fp(t,e,n,s){var r=Vs();s=s===void 0?null:s;var i=void 0;if(an!==null){var o=an.memoizedState;if(i=o.destroy,s!==null&&Tv(s,o.deps)){r.memoizedState=Iu(e,n,i,s);return}}Bt.flags|=t,r.memoizedState=Iu(1|e,n,i,s)}function uw(t,e){return hf(8390656,8,t,e)}function Av(t,e){return Fp(2048,8,t,e)}function zj(t,e){return Fp(4,2,t,e)}function Bj(t,e){return Fp(4,4,t,e)}function Uj(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Hj(t,e,n){return n=n!=null?n.concat([t]):null,Fp(4,4,Uj.bind(null,e,t),n)}function Ov(){}function Wj(t,e){var n=Vs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Tv(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function Vj(t,e){var n=Vs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Tv(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function qj(t,e,n){return ba&21?(hr(n,e)||(n=X1(),Bt.lanes|=n,wa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ns=!0),t.memoizedState=n)}function PA(t,e){var n=xt;xt=n!==0&&4>n?n:4,t(!0);var s=Hm.transition;Hm.transition={};try{t(!1),e()}finally{xt=n,Hm.transition=s}}function Kj(){return Vs().memoizedState}function RA(t,e,n){var s=io(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Gj(t))Yj(e,n);else if(n=Tj(t,e,n,s),n!==null){var r=Bn();ur(n,t,s,r),Qj(n,e,s)}}function AA(t,e,n){var s=io(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gj(t))Yj(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,hr(a,o)){var l=e.interleaved;l===null?(r.next=r,Sv(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=Tj(t,e,r,s),n!==null&&(r=Bn(),ur(n,t,s,r),Qj(n,e,s))}}function Gj(t){var e=t.alternate;return t===Bt||e!==null&&e===Bt}function Yj(t,e){cu=Yf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Qj(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,uv(t,n)}}var Qf={readContext:Ws,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useInsertionEffect:Cn,useLayoutEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useMutableSource:Cn,useSyncExternalStore:Cn,useId:Cn,unstable_isNewReconciler:!1},OA={readContext:Ws,useCallback:function(t,e){return jr().memoizedState=[t,e===void 0?null:e],t},useContext:Ws,useEffect:uw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,hf(4194308,4,Uj.bind(null,e,t),n)},useLayoutEffect:function(t,e){return hf(4194308,4,t,e)},useInsertionEffect:function(t,e){return hf(4,2,t,e)},useMemo:function(t,e){var n=jr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=jr();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=RA.bind(null,Bt,t),[s.memoizedState,t]},useRef:function(t){var e=jr();return t={current:t},e.memoizedState=t},useState:cw,useDebugValue:Ov,useDeferredValue:function(t){return jr().memoizedState=t},useTransition:function(){var t=cw(!1),e=t[0];return t=PA.bind(null,t[1]),jr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Bt,r=jr();if(Dt){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=e(),mn===null)throw Error(fe(349));ba&30||Mj(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,uw(Dj.bind(null,s,i,t),[t]),s.flags|=2048,Iu(9,Ij.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=jr(),e=mn.identifierPrefix;if(Dt){var n=ri,s=si;n=(s&~(1<<32-cr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ou++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=TA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},MA={readContext:Ws,useCallback:Wj,useContext:Ws,useEffect:Av,useImperativeHandle:Hj,useInsertionEffect:zj,useLayoutEffect:Bj,useMemo:Vj,useReducer:Wm,useRef:Fj,useState:function(){return Wm(Mu)},useDebugValue:Ov,useDeferredValue:function(t){var e=Vs();return qj(e,an.memoizedState,t)},useTransition:function(){var t=Wm(Mu)[0],e=Vs().memoizedState;return[t,e]},useMutableSource:Aj,useSyncExternalStore:Oj,useId:Kj,unstable_isNewReconciler:!1},IA={readContext:Ws,useCallback:Wj,useContext:Ws,useEffect:Av,useImperativeHandle:Hj,useInsertionEffect:zj,useLayoutEffect:Bj,useMemo:Vj,useReducer:Vm,useRef:Fj,useState:function(){return Vm(Mu)},useDebugValue:Ov,useDeferredValue:function(t){var e=Vs();return an===null?e.memoizedState=t:qj(e,an.memoizedState,t)},useTransition:function(){var t=Vm(Mu)[0],e=Vs().memoizedState;return[t,e]},useMutableSource:Aj,useSyncExternalStore:Oj,useId:Kj,unstable_isNewReconciler:!1};function nr(t,e){if(t&&t.defaultProps){e=Ut({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function jx(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Ut({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zp={isMounted:function(t){return(t=t._reactInternals)?Ra(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Bn(),r=io(t),i=ai(s,r);i.payload=e,n!=null&&(i.callback=n),e=so(t,i,r),e!==null&&(ur(e,t,r,s),uf(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Bn(),r=io(t),i=ai(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=so(t,i,r),e!==null&&(ur(e,t,r,s),uf(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bn(),s=io(t),r=ai(n,s);r.tag=2,e!=null&&(r.callback=e),e=so(t,r,s),e!==null&&(ur(e,t,s,n),uf(e,t,s))}};function dw(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Nu(n,s)||!Nu(r,i):!0}function Xj(t,e,n){var s=!1,r=fo,i=e.contextType;return typeof i=="object"&&i!==null?i=Ws(i):(r=as(e)?ya:On.current,s=e.contextTypes,i=(s=s!=null)?tc(t,r):fo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zp,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function hw(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&zp.enqueueReplaceState(e,e.state,null)}function Cx(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},jv(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Ws(i):(i=as(e)?ya:On.current,r.context=tc(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(jx(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&zp.enqueueReplaceState(r,r.state,null),Kf(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function ic(t,e){try{var n="",s=e;do n+=cR(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function qm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Nx(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var DA=typeof WeakMap=="function"?WeakMap:Map;function Jj(t,e,n){n=ai(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Jf||(Jf=!0,Lx=s),Nx(t,e)},n}function Zj(t,e,n){n=ai(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){Nx(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Nx(t,e),typeof s!="function"&&(ro===null?ro=new Set([this]):ro.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function fw(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new DA;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=QA.bind(null,t,e,n),e.then(t,t))}function pw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function mw(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ai(-1,1),e.tag=2,so(n,e,1))),n.lanes|=1),t)}var LA=yi.ReactCurrentOwner,ns=!1;function zn(t,e,n,s){e.child=t===null?Ej(e,null,n,s):sc(e,t.child,n,s)}function gw(t,e,n,s,r){n=n.render;var i=e.ref;return Nl(e,r),s=Pv(t,e,n,s,i,r),n=Rv(),t!==null&&!ns?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,fi(t,e,r)):(Dt&&n&&yv(e),e.flags|=1,zn(t,e,s,r),e.child)}function xw(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Bv(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,eC(t,e,i,s,r)):(t=gf(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Nu,n(o,s)&&t.ref===e.ref)return fi(t,e,r)}return e.flags|=1,t=oo(i,s),t.ref=e.ref,t.return=e,e.child=t}function eC(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Nu(i,s)&&t.ref===e.ref)if(ns=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(ns=!0);else return e.lanes=t.lanes,fi(t,e,r)}return Ex(t,e,n,s,r)}function tC(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(vl,vs),vs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(vl,vs),vs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,_t(vl,vs),vs|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,_t(vl,vs),vs|=s;return zn(t,e,r,n),e.child}function nC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ex(t,e,n,s,r){var i=as(n)?ya:On.current;return i=tc(e,i),Nl(e,r),n=Pv(t,e,n,s,i,r),s=Rv(),t!==null&&!ns?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,fi(t,e,r)):(Dt&&s&&yv(e),e.flags|=1,zn(t,e,n,r),e.child)}function yw(t,e,n,s,r){if(as(n)){var i=!0;Uf(e)}else i=!1;if(Nl(e,r),e.stateNode===null)ff(t,e),Xj(e,n,s),Cx(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ws(u):(u=as(n)?ya:On.current,u=tc(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==u)&&hw(e,o,s,u),Pi=!1;var f=e.memoizedState;o.state=f,Kf(e,s,o,r),l=e.memoizedState,a!==s||f!==l||os.current||Pi?(typeof d=="function"&&(jx(e,n,d,s),l=e.memoizedState),(a=Pi||dw(e,n,a,s,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,Pj(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:nr(e.type,a),o.props=u,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ws(l):(l=as(n)?ya:On.current,l=tc(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&hw(e,o,s,l),Pi=!1,f=e.memoizedState,o.state=f,Kf(e,s,o,r);var w=e.memoizedState;a!==h||f!==w||os.current||Pi?(typeof p=="function"&&(jx(e,n,p,s),w=e.memoizedState),(u=Pi||dw(e,n,u,s,f,w,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,w,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,w,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=w),o.props=s,o.state=w,o.context=l,s=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return Tx(t,e,n,s,i,r)}function Tx(t,e,n,s,r,i){nC(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&sw(e,n,!1),fi(t,e,i);s=e.stateNode,LA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=sc(e,t.child,null,i),e.child=sc(e,null,a,i)):zn(t,e,a,i),e.memoizedState=s.state,r&&sw(e,n,!0),e.child}function sC(t){var e=t.stateNode;e.pendingContext?nw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&nw(t,e.context,!1),Cv(t,e.containerInfo)}function vw(t,e,n,s,r){return nc(),bv(r),e.flags|=256,zn(t,e,n,s),e.child}var Px={dehydrated:null,treeContext:null,retryLane:0};function Rx(t){return{baseLanes:t,cachePool:null,transitions:null}}function rC(t,e,n){var s=e.pendingProps,r=Ft.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),_t(Ft,r&1),t===null)return _x(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Hp(o,s,0,null),t=ha(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Rx(n),e.memoizedState=Px,t):Mv(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return $A(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=oo(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=oo(a,i):(i=ha(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?Rx(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Px,s}return i=t.child,t=i.sibling,s=oo(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Mv(t,e){return e=Hp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mh(t,e,n,s){return s!==null&&bv(s),sc(e,t.child,null,n),t=Mv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $A(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=qm(Error(fe(422))),mh(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Hp({mode:"visible",children:s.children},r,0,null),i=ha(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&sc(e,t.child,null,o),e.child.memoizedState=Rx(o),e.memoizedState=Px,i);if(!(e.mode&1))return mh(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(fe(419)),s=qm(i,s,void 0),mh(t,e,o,s)}if(a=(o&t.childLanes)!==0,ns||a){if(s=mn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,hi(t,r),ur(s,t,r,-1))}return zv(),s=qm(Error(fe(421))),mh(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=XA.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,Ss=no(r.nextSibling),js=e,Dt=!0,lr=null,t!==null&&(Ls[$s++]=si,Ls[$s++]=ri,Ls[$s++]=va,si=t.id,ri=t.overflow,va=e),e=Mv(e,s.children),e.flags|=4096,e)}function bw(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Sx(t.return,e,n)}function Km(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function iC(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(zn(t,e,s.children,n),s=Ft.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bw(t,n,e);else if(t.tag===19)bw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(_t(Ft,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Gf(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Km(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Gf(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Km(e,!0,n,null,i);break;case"together":Km(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ff(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),wa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,n=oo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=oo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function FA(t,e,n){switch(e.tag){case 3:sC(e),nc();break;case 5:Rj(e);break;case 1:as(e.type)&&Uf(e);break;case 4:Cv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;_t(Vf,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(_t(Ft,Ft.current&1),e.flags|=128,null):n&e.child.childLanes?rC(t,e,n):(_t(Ft,Ft.current&1),t=fi(t,e,n),t!==null?t.sibling:null);_t(Ft,Ft.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return iC(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),_t(Ft,Ft.current),s)break;return null;case 22:case 23:return e.lanes=0,tC(t,e,n)}return fi(t,e,n)}var oC,Ax,aC,lC;oC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ax=function(){};aC=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Xo($r.current);var i=null;switch(n){case"input":r=ex(t,r),s=ex(t,s),i=[];break;case"select":r=Ut({},r,{value:void 0}),s=Ut({},s,{value:void 0}),i=[];break;case"textarea":r=sx(t,r),s=sx(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=zf)}ix(n,s);var o;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(bu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var l=s[u];if(a=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(bu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Nt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};lC=function(t,e,n,s){n!==s&&(e.flags|=4)};function Mc(t,e){if(!Dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Nn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function zA(t,e,n){var s=e.pendingProps;switch(vv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(e),null;case 1:return as(e.type)&&Bf(),Nn(e),null;case 3:return s=e.stateNode,rc(),Rt(os),Rt(On),Ev(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(fh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,lr!==null&&(zx(lr),lr=null))),Ax(t,e),Nn(e),null;case 5:Nv(e);var r=Xo(Au.current);if(n=e.type,t!==null&&e.stateNode!=null)aC(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(fe(166));return Nn(e),null}if(t=Xo($r.current),fh(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Or]=e,s[Pu]=i,t=(e.mode&1)!==0,n){case"dialog":Nt("cancel",s),Nt("close",s);break;case"iframe":case"object":case"embed":Nt("load",s);break;case"video":case"audio":for(r=0;r<Yc.length;r++)Nt(Yc[r],s);break;case"source":Nt("error",s);break;case"img":case"image":case"link":Nt("error",s),Nt("load",s);break;case"details":Nt("toggle",s);break;case"input":Tb(s,i),Nt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Nt("invalid",s);break;case"textarea":Rb(s,i),Nt("invalid",s)}ix(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&hh(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&hh(s.textContent,a,t),r=["children",""+a]):bu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Nt("scroll",s)}switch(n){case"input":rh(s),Pb(s,i,!0);break;case"textarea":rh(s),Ab(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=zf)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=D1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[Or]=e,t[Pu]=s,oC(t,e,!1,!1),e.stateNode=t;e:{switch(o=ox(n,s),n){case"dialog":Nt("cancel",t),Nt("close",t),r=s;break;case"iframe":case"object":case"embed":Nt("load",t),r=s;break;case"video":case"audio":for(r=0;r<Yc.length;r++)Nt(Yc[r],t);r=s;break;case"source":Nt("error",t),r=s;break;case"img":case"image":case"link":Nt("error",t),Nt("load",t),r=s;break;case"details":Nt("toggle",t),r=s;break;case"input":Tb(t,s),r=ex(t,s),Nt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Ut({},s,{value:void 0}),Nt("invalid",t);break;case"textarea":Rb(t,s),r=sx(t,s),Nt("invalid",t);break;default:r=s}ix(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?F1(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&L1(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&wu(t,l):typeof l=="number"&&wu(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(bu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Nt("scroll",t):l!=null&&rv(t,i,l,o))}switch(n){case"input":rh(t),Pb(t,s,!1);break;case"textarea":rh(t),Ab(t);break;case"option":s.value!=null&&t.setAttribute("value",""+ho(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?_l(t,!!s.multiple,i,!1):s.defaultValue!=null&&_l(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=zf)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nn(e),null;case 6:if(t&&e.stateNode!=null)lC(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(fe(166));if(n=Xo(Au.current),Xo($r.current),fh(e)){if(s=e.stateNode,n=e.memoizedProps,s[Or]=e,(i=s.nodeValue!==n)&&(t=js,t!==null))switch(t.tag){case 3:hh(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&hh(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Or]=e,e.stateNode=s}return Nn(e),null;case 13:if(Rt(Ft),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Dt&&Ss!==null&&e.mode&1&&!(e.flags&128))Cj(),nc(),e.flags|=98560,i=!1;else if(i=fh(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(fe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(fe(317));i[Or]=e}else nc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nn(e),i=!1}else lr!==null&&(zx(lr),lr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Ft.current&1?cn===0&&(cn=3):zv())),e.updateQueue!==null&&(e.flags|=4),Nn(e),null);case 4:return rc(),Ax(t,e),t===null&&Eu(e.stateNode.containerInfo),Nn(e),null;case 10:return _v(e.type._context),Nn(e),null;case 17:return as(e.type)&&Bf(),Nn(e),null;case 19:if(Rt(Ft),i=e.memoizedState,i===null)return Nn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)Mc(i,!1);else{if(cn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Gf(t),o!==null){for(e.flags|=128,Mc(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t(Ft,Ft.current&1|2),e.child}t=t.sibling}i.tail!==null&&Jt()>oc&&(e.flags|=128,s=!0,Mc(i,!1),e.lanes=4194304)}else{if(!s)if(t=Gf(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Mc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Dt)return Nn(e),null}else 2*Jt()-i.renderingStartTime>oc&&n!==1073741824&&(e.flags|=128,s=!0,Mc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Jt(),e.sibling=null,n=Ft.current,_t(Ft,s?n&1|2:n&1),e):(Nn(e),null);case 22:case 23:return Fv(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?vs&1073741824&&(Nn(e),e.subtreeFlags&6&&(e.flags|=8192)):Nn(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function BA(t,e){switch(vv(e),e.tag){case 1:return as(e.type)&&Bf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return rc(),Rt(os),Rt(On),Ev(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Nv(e),null;case 13:if(Rt(Ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));nc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(Ft),null;case 4:return rc(),null;case 10:return _v(e.type._context),null;case 22:case 23:return Fv(),null;case 24:return null;default:return null}}var gh=!1,Tn=!1,UA=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function yl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Vt(t,e,s)}else n.current=null}function Ox(t,e,n){try{n()}catch(s){Vt(t,e,s)}}var ww=!1;function HA(t,e){if(gx=Lf,t=fj(),xv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++u===r&&(a=o),f===i&&++d===s&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(xx={focusedElem:t,selectionRange:n},Lf=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var x=w.memoizedProps,y=w.memoizedState,g=e.stateNode,m=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:nr(e.type,x),y);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(k){Vt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return w=ww,ww=!1,w}function uu(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&Ox(e,n,i)}r=r.next}while(r!==s)}}function Bp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Mx(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function cC(t){var e=t.alternate;e!==null&&(t.alternate=null,cC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Or],delete e[Pu],delete e[bx],delete e[jA],delete e[CA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function uC(t){return t.tag===5||t.tag===3||t.tag===4}function kw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||uC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ix(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=zf));else if(s!==4&&(t=t.child,t!==null))for(Ix(t,e,n),t=t.sibling;t!==null;)Ix(t,e,n),t=t.sibling}function Dx(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Dx(t,e,n),t=t.sibling;t!==null;)Dx(t,e,n),t=t.sibling}var vn=null,or=!1;function Si(t,e,n){for(n=n.child;n!==null;)dC(t,e,n),n=n.sibling}function dC(t,e,n){if(Lr&&typeof Lr.onCommitFiberUnmount=="function")try{Lr.onCommitFiberUnmount(Op,n)}catch{}switch(n.tag){case 5:Tn||yl(n,e);case 6:var s=vn,r=or;vn=null,Si(t,e,n),vn=s,or=r,vn!==null&&(or?(t=vn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vn.removeChild(n.stateNode));break;case 18:vn!==null&&(or?(t=vn,n=n.stateNode,t.nodeType===8?zm(t.parentNode,n):t.nodeType===1&&zm(t,n),ju(t)):zm(vn,n.stateNode));break;case 4:s=vn,r=or,vn=n.stateNode.containerInfo,or=!0,Si(t,e,n),vn=s,or=r;break;case 0:case 11:case 14:case 15:if(!Tn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Ox(n,e,o),r=r.next}while(r!==s)}Si(t,e,n);break;case 1:if(!Tn&&(yl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Vt(n,e,a)}Si(t,e,n);break;case 21:Si(t,e,n);break;case 22:n.mode&1?(Tn=(s=Tn)||n.memoizedState!==null,Si(t,e,n),Tn=s):Si(t,e,n);break;default:Si(t,e,n)}}function _w(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new UA),e.forEach(function(s){var r=JA.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function er(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:vn=a.stateNode,or=!1;break e;case 3:vn=a.stateNode.containerInfo,or=!0;break e;case 4:vn=a.stateNode.containerInfo,or=!0;break e}a=a.return}if(vn===null)throw Error(fe(160));dC(i,o,r),vn=null,or=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Vt(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)hC(e,t),e=e.sibling}function hC(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(er(e,t),br(t),s&4){try{uu(3,t,t.return),Bp(3,t)}catch(x){Vt(t,t.return,x)}try{uu(5,t,t.return)}catch(x){Vt(t,t.return,x)}}break;case 1:er(e,t),br(t),s&512&&n!==null&&yl(n,n.return);break;case 5:if(er(e,t),br(t),s&512&&n!==null&&yl(n,n.return),t.flags&32){var r=t.stateNode;try{wu(r,"")}catch(x){Vt(t,t.return,x)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&M1(r,i),ox(a,o);var u=ox(a,i);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?F1(r,h):d==="dangerouslySetInnerHTML"?L1(r,h):d==="children"?wu(r,h):rv(r,d,h,u)}switch(a){case"input":tx(r,i);break;case"textarea":I1(r,i);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?_l(r,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?_l(r,!!i.multiple,i.defaultValue,!0):_l(r,!!i.multiple,i.multiple?[]:"",!1))}r[Pu]=i}catch(x){Vt(t,t.return,x)}}break;case 6:if(er(e,t),br(t),s&4){if(t.stateNode===null)throw Error(fe(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(x){Vt(t,t.return,x)}}break;case 3:if(er(e,t),br(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{ju(e.containerInfo)}catch(x){Vt(t,t.return,x)}break;case 4:er(e,t),br(t);break;case 13:er(e,t),br(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Lv=Jt())),s&4&&_w(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Tn=(u=Tn)||d,er(e,t),Tn=u):er(e,t),br(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Ne=t,d=t.child;d!==null;){for(h=Ne=d;Ne!==null;){switch(f=Ne,p=f.child,f.tag){case 0:case 11:case 14:case 15:uu(4,f,f.return);break;case 1:yl(f,f.return);var w=f.stateNode;if(typeof w.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(x){Vt(s,n,x)}}break;case 5:yl(f,f.return);break;case 22:if(f.memoizedState!==null){jw(h);continue}}p!==null?(p.return=f,Ne=p):jw(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=$1("display",o))}catch(x){Vt(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Vt(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:er(e,t),br(t),s&4&&_w(t);break;case 21:break;default:er(e,t),br(t)}}function br(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(uC(n)){var s=n;break e}n=n.return}throw Error(fe(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(wu(r,""),s.flags&=-33);var i=kw(t);Dx(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=kw(t);Ix(t,a,o);break;default:throw Error(fe(161))}}catch(l){Vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function WA(t,e,n){Ne=t,fC(t)}function fC(t,e,n){for(var s=(t.mode&1)!==0;Ne!==null;){var r=Ne,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||gh;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Tn;a=gh;var u=Tn;if(gh=o,(Tn=l)&&!u)for(Ne=r;Ne!==null;)o=Ne,l=o.child,o.tag===22&&o.memoizedState!==null?Cw(r):l!==null?(l.return=o,Ne=l):Cw(r);for(;i!==null;)Ne=i,fC(i),i=i.sibling;Ne=r,gh=a,Tn=u}Sw(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,Ne=i):Sw(t)}}function Sw(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Tn||Bp(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Tn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:nr(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&lw(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&ju(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}Tn||e.flags&512&&Mx(e)}catch(f){Vt(e,e.return,f)}}if(e===t){Ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ne=n;break}Ne=e.return}}function jw(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ne=n;break}Ne=e.return}}function Cw(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bp(4,e)}catch(l){Vt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Vt(e,r,l)}}var i=e.return;try{Mx(e)}catch(l){Vt(e,i,l)}break;case 5:var o=e.return;try{Mx(e)}catch(l){Vt(e,o,l)}}}catch(l){Vt(e,e.return,l)}if(e===t){Ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ne=a;break}Ne=e.return}}var VA=Math.ceil,Xf=yi.ReactCurrentDispatcher,Iv=yi.ReactCurrentOwner,Us=yi.ReactCurrentBatchConfig,st=0,mn=null,tn=null,wn=0,vs=0,vl=wo(0),cn=0,Du=null,wa=0,Up=0,Dv=0,du=null,es=null,Lv=0,oc=1/0,Yr=null,Jf=!1,Lx=null,ro=null,xh=!1,Ki=null,Zf=0,hu=0,$x=null,pf=-1,mf=0;function Bn(){return st&6?Jt():pf!==-1?pf:pf=Jt()}function io(t){return t.mode&1?st&2&&wn!==0?wn&-wn:EA.transition!==null?(mf===0&&(mf=X1()),mf):(t=xt,t!==0||(t=window.event,t=t===void 0?16:rj(t.type)),t):1}function ur(t,e,n,s){if(50<hu)throw hu=0,$x=null,Error(fe(185));wd(t,n,s),(!(st&2)||t!==mn)&&(t===mn&&(!(st&2)&&(Up|=n),cn===4&&Oi(t,wn)),ls(t,s),n===1&&st===0&&!(e.mode&1)&&(oc=Jt()+500,$p&&ko()))}function ls(t,e){var n=t.callbackNode;ER(t,e);var s=Df(t,t===mn?wn:0);if(s===0)n!==null&&Ib(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&Ib(n),e===1)t.tag===0?NA(Nw.bind(null,t)):_j(Nw.bind(null,t)),_A(function(){!(st&6)&&ko()}),n=null;else{switch(J1(s)){case 1:n=cv;break;case 4:n=Y1;break;case 16:n=If;break;case 536870912:n=Q1;break;default:n=If}n=wC(n,pC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function pC(t,e){if(pf=-1,mf=0,st&6)throw Error(fe(327));var n=t.callbackNode;if(El()&&t.callbackNode!==n)return null;var s=Df(t,t===mn?wn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=ep(t,s);else{e=s;var r=st;st|=2;var i=gC();(mn!==t||wn!==e)&&(Yr=null,oc=Jt()+500,da(t,e));do try{GA();break}catch(a){mC(t,a)}while(!0);kv(),Xf.current=i,st=r,tn!==null?e=0:(mn=null,wn=0,e=cn)}if(e!==0){if(e===2&&(r=dx(t),r!==0&&(s=r,e=Fx(t,r))),e===1)throw n=Du,da(t,0),Oi(t,s),ls(t,Jt()),n;if(e===6)Oi(t,s);else{if(r=t.current.alternate,!(s&30)&&!qA(r)&&(e=ep(t,s),e===2&&(i=dx(t),i!==0&&(s=i,e=Fx(t,i))),e===1))throw n=Du,da(t,0),Oi(t,s),ls(t,Jt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(fe(345));case 2:Ho(t,es,Yr);break;case 3:if(Oi(t,s),(s&130023424)===s&&(e=Lv+500-Jt(),10<e)){if(Df(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Bn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=vx(Ho.bind(null,t,es,Yr),e);break}Ho(t,es,Yr);break;case 4:if(Oi(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-cr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Jt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*VA(s/1960))-s,10<s){t.timeoutHandle=vx(Ho.bind(null,t,es,Yr),s);break}Ho(t,es,Yr);break;case 5:Ho(t,es,Yr);break;default:throw Error(fe(329))}}}return ls(t,Jt()),t.callbackNode===n?pC.bind(null,t):null}function Fx(t,e){var n=du;return t.current.memoizedState.isDehydrated&&(da(t,e).flags|=256),t=ep(t,e),t!==2&&(e=es,es=n,e!==null&&zx(e)),t}function zx(t){es===null?es=t:es.push.apply(es,t)}function qA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!hr(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oi(t,e){for(e&=~Dv,e&=~Up,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-cr(e),s=1<<n;t[n]=-1,e&=~s}}function Nw(t){if(st&6)throw Error(fe(327));El();var e=Df(t,0);if(!(e&1))return ls(t,Jt()),null;var n=ep(t,e);if(t.tag!==0&&n===2){var s=dx(t);s!==0&&(e=s,n=Fx(t,s))}if(n===1)throw n=Du,da(t,0),Oi(t,e),ls(t,Jt()),n;if(n===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ho(t,es,Yr),ls(t,Jt()),null}function $v(t,e){var n=st;st|=1;try{return t(e)}finally{st=n,st===0&&(oc=Jt()+500,$p&&ko())}}function ka(t){Ki!==null&&Ki.tag===0&&!(st&6)&&El();var e=st;st|=1;var n=Us.transition,s=xt;try{if(Us.transition=null,xt=1,t)return t()}finally{xt=s,Us.transition=n,st=e,!(st&6)&&ko()}}function Fv(){vs=vl.current,Rt(vl)}function da(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kA(n)),tn!==null)for(n=tn.return;n!==null;){var s=n;switch(vv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Bf();break;case 3:rc(),Rt(os),Rt(On),Ev();break;case 5:Nv(s);break;case 4:rc();break;case 13:Rt(Ft);break;case 19:Rt(Ft);break;case 10:_v(s.type._context);break;case 22:case 23:Fv()}n=n.return}if(mn=t,tn=t=oo(t.current,null),wn=vs=e,cn=0,Du=null,Dv=Up=wa=0,es=du=null,Qo!==null){for(e=0;e<Qo.length;e++)if(n=Qo[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Qo=null}return t}function mC(t,e){do{var n=tn;try{if(kv(),df.current=Qf,Yf){for(var s=Bt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Yf=!1}if(ba=0,fn=an=Bt=null,cu=!1,Ou=0,Iv.current=null,n===null||n.return===null){cn=1,Du=e,tn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=wn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=pw(o);if(p!==null){p.flags&=-257,mw(p,o,a,i,e),p.mode&1&&fw(i,u,e),e=p,l=u;var w=e.updateQueue;if(w===null){var x=new Set;x.add(l),e.updateQueue=x}else w.add(l);break e}else{if(!(e&1)){fw(i,u,e),zv();break e}l=Error(fe(426))}}else if(Dt&&a.mode&1){var y=pw(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),mw(y,o,a,i,e),bv(ic(l,a));break e}}i=l=ic(l,a),cn!==4&&(cn=2),du===null?du=[i]:du.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=Jj(i,l,e);aw(i,g);break e;case 1:a=l;var m=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ro===null||!ro.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=Zj(i,a,e);aw(i,k);break e}}i=i.return}while(i!==null)}yC(n)}catch(_){e=_,tn===n&&n!==null&&(tn=n=n.return);continue}break}while(!0)}function gC(){var t=Xf.current;return Xf.current=Qf,t===null?Qf:t}function zv(){(cn===0||cn===3||cn===2)&&(cn=4),mn===null||!(wa&268435455)&&!(Up&268435455)||Oi(mn,wn)}function ep(t,e){var n=st;st|=2;var s=gC();(mn!==t||wn!==e)&&(Yr=null,da(t,e));do try{KA();break}catch(r){mC(t,r)}while(!0);if(kv(),st=n,Xf.current=s,tn!==null)throw Error(fe(261));return mn=null,wn=0,cn}function KA(){for(;tn!==null;)xC(tn)}function GA(){for(;tn!==null&&!vR();)xC(tn)}function xC(t){var e=bC(t.alternate,t,vs);t.memoizedProps=t.pendingProps,e===null?yC(t):tn=e,Iv.current=null}function yC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=BA(n,e),n!==null){n.flags&=32767,tn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{cn=6,tn=null;return}}else if(n=zA(n,e,vs),n!==null){tn=n;return}if(e=e.sibling,e!==null){tn=e;return}tn=e=t}while(e!==null);cn===0&&(cn=5)}function Ho(t,e,n){var s=xt,r=Us.transition;try{Us.transition=null,xt=1,YA(t,e,n,s)}finally{Us.transition=r,xt=s}return null}function YA(t,e,n,s){do El();while(Ki!==null);if(st&6)throw Error(fe(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(TR(t,i),t===mn&&(tn=mn=null,wn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xh||(xh=!0,wC(If,function(){return El(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Us.transition,Us.transition=null;var o=xt;xt=1;var a=st;st|=4,Iv.current=null,HA(t,n),hC(n,t),mA(xx),Lf=!!gx,xx=gx=null,t.current=n,WA(n),bR(),st=a,xt=o,Us.transition=i}else t.current=n;if(xh&&(xh=!1,Ki=t,Zf=r),i=t.pendingLanes,i===0&&(ro=null),_R(n.stateNode),ls(t,Jt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Jf)throw Jf=!1,t=Lx,Lx=null,t;return Zf&1&&t.tag!==0&&El(),i=t.pendingLanes,i&1?t===$x?hu++:(hu=0,$x=t):hu=0,ko(),null}function El(){if(Ki!==null){var t=J1(Zf),e=Us.transition,n=xt;try{if(Us.transition=null,xt=16>t?16:t,Ki===null)var s=!1;else{if(t=Ki,Ki=null,Zf=0,st&6)throw Error(fe(331));var r=st;for(st|=4,Ne=t.current;Ne!==null;){var i=Ne,o=i.child;if(Ne.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ne=u;Ne!==null;){var d=Ne;switch(d.tag){case 0:case 11:case 15:uu(8,d,i)}var h=d.child;if(h!==null)h.return=d,Ne=h;else for(;Ne!==null;){d=Ne;var f=d.sibling,p=d.return;if(cC(d),d===u){Ne=null;break}if(f!==null){f.return=p,Ne=f;break}Ne=p}}}var w=i.alternate;if(w!==null){var x=w.child;if(x!==null){w.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}Ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ne=o;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:uu(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Ne=g;break e}Ne=i.return}}var m=t.current;for(Ne=m;Ne!==null;){o=Ne;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Ne=b;else e:for(o=m;Ne!==null;){if(a=Ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Bp(9,a)}}catch(_){Vt(a,a.return,_)}if(a===o){Ne=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,Ne=k;break e}Ne=a.return}}if(st=r,ko(),Lr&&typeof Lr.onPostCommitFiberRoot=="function")try{Lr.onPostCommitFiberRoot(Op,t)}catch{}s=!0}return s}finally{xt=n,Us.transition=e}}return!1}function Ew(t,e,n){e=ic(n,e),e=Jj(t,e,1),t=so(t,e,1),e=Bn(),t!==null&&(wd(t,1,e),ls(t,e))}function Vt(t,e,n){if(t.tag===3)Ew(t,t,n);else for(;e!==null;){if(e.tag===3){Ew(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ro===null||!ro.has(s))){t=ic(n,t),t=Zj(e,t,1),e=so(e,t,1),t=Bn(),e!==null&&(wd(e,1,t),ls(e,t));break}}e=e.return}}function QA(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Bn(),t.pingedLanes|=t.suspendedLanes&n,mn===t&&(wn&n)===n&&(cn===4||cn===3&&(wn&130023424)===wn&&500>Jt()-Lv?da(t,0):Dv|=n),ls(t,e)}function vC(t,e){e===0&&(t.mode&1?(e=ah,ah<<=1,!(ah&130023424)&&(ah=4194304)):e=1);var n=Bn();t=hi(t,e),t!==null&&(wd(t,e,n),ls(t,n))}function XA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),vC(t,n)}function JA(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(fe(314))}s!==null&&s.delete(e),vC(t,n)}var bC;bC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||os.current)ns=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ns=!1,FA(t,e,n);ns=!!(t.flags&131072)}else ns=!1,Dt&&e.flags&1048576&&Sj(e,Wf,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;ff(t,e),t=e.pendingProps;var r=tc(e,On.current);Nl(e,n),r=Pv(null,e,s,t,r,n);var i=Rv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,as(s)?(i=!0,Uf(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,jv(e),r.updater=zp,e.stateNode=r,r._reactInternals=e,Cx(e,s,t,n),e=Tx(null,e,s,!0,i,n)):(e.tag=0,Dt&&i&&yv(e),zn(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(ff(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=eO(s),t=nr(s,t),r){case 0:e=Ex(null,e,s,t,n);break e;case 1:e=yw(null,e,s,t,n);break e;case 11:e=gw(null,e,s,t,n);break e;case 14:e=xw(null,e,s,nr(s.type,t),n);break e}throw Error(fe(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:nr(s,r),Ex(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:nr(s,r),yw(t,e,s,r,n);case 3:e:{if(sC(e),t===null)throw Error(fe(387));s=e.pendingProps,i=e.memoizedState,r=i.element,Pj(t,e),Kf(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=ic(Error(fe(423)),e),e=vw(t,e,s,n,r);break e}else if(s!==r){r=ic(Error(fe(424)),e),e=vw(t,e,s,n,r);break e}else for(Ss=no(e.stateNode.containerInfo.firstChild),js=e,Dt=!0,lr=null,n=Ej(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(nc(),s===r){e=fi(t,e,n);break e}zn(t,e,s,n)}e=e.child}return e;case 5:return Rj(e),t===null&&_x(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,yx(s,r)?o=null:i!==null&&yx(s,i)&&(e.flags|=32),nC(t,e),zn(t,e,o,n),e.child;case 6:return t===null&&_x(e),null;case 13:return rC(t,e,n);case 4:return Cv(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=sc(e,null,s,n):zn(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:nr(s,r),gw(t,e,s,r,n);case 7:return zn(t,e,e.pendingProps,n),e.child;case 8:return zn(t,e,e.pendingProps.children,n),e.child;case 12:return zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,_t(Vf,s._currentValue),s._currentValue=o,i!==null)if(hr(i.value,o)){if(i.children===r.children&&!os.current){e=fi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=ai(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Sx(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(fe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Sx(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}zn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Nl(e,n),r=Ws(r),s=s(r),e.flags|=1,zn(t,e,s,n),e.child;case 14:return s=e.type,r=nr(s,e.pendingProps),r=nr(s.type,r),xw(t,e,s,r,n);case 15:return eC(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:nr(s,r),ff(t,e),e.tag=1,as(s)?(t=!0,Uf(e)):t=!1,Nl(e,n),Xj(e,s,r),Cx(e,s,r,n),Tx(null,e,s,!0,t,n);case 19:return iC(t,e,n);case 22:return tC(t,e,n)}throw Error(fe(156,e.tag))};function wC(t,e){return G1(t,e)}function ZA(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fs(t,e,n,s){return new ZA(t,e,n,s)}function Bv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function eO(t){if(typeof t=="function")return Bv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ov)return 11;if(t===av)return 14}return 2}function oo(t,e){var n=t.alternate;return n===null?(n=Fs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function gf(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")Bv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case cl:return ha(n.children,r,i,e);case iv:o=8,r|=8;break;case Qg:return t=Fs(12,n,e,r|2),t.elementType=Qg,t.lanes=i,t;case Xg:return t=Fs(13,n,e,r),t.elementType=Xg,t.lanes=i,t;case Jg:return t=Fs(19,n,e,r),t.elementType=Jg,t.lanes=i,t;case R1:return Hp(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case T1:o=10;break e;case P1:o=9;break e;case ov:o=11;break e;case av:o=14;break e;case Ti:o=16,s=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=Fs(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function ha(t,e,n,s){return t=Fs(7,t,s,e),t.lanes=n,t}function Hp(t,e,n,s){return t=Fs(22,t,s,e),t.elementType=R1,t.lanes=n,t.stateNode={isHidden:!1},t}function Gm(t,e,n){return t=Fs(6,t,null,e),t.lanes=n,t}function Ym(t,e,n){return e=Fs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function tO(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tm(0),this.expirationTimes=Tm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tm(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Uv(t,e,n,s,r,i,o,a,l){return t=new tO(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Fs(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jv(i),t}function nO(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ll,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function kC(t){if(!t)return fo;t=t._reactInternals;e:{if(Ra(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(as(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var n=t.type;if(as(n))return kj(t,n,e)}return e}function _C(t,e,n,s,r,i,o,a,l){return t=Uv(n,s,!0,t,r,i,o,a,l),t.context=kC(null),n=t.current,s=Bn(),r=io(n),i=ai(s,r),i.callback=e??null,so(n,i,r),t.current.lanes=r,wd(t,r,s),ls(t,s),t}function Wp(t,e,n,s){var r=e.current,i=Bn(),o=io(r);return n=kC(n),e.context===null?e.context=n:e.pendingContext=n,e=ai(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=so(r,e,o),t!==null&&(ur(t,r,o,i),uf(t,r,o)),o}function tp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Tw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Hv(t,e){Tw(t,e),(t=t.alternate)&&Tw(t,e)}function sO(){return null}var SC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Wv(t){this._internalRoot=t}Vp.prototype.render=Wv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));Wp(t,e,null,null)};Vp.prototype.unmount=Wv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ka(function(){Wp(null,t,null,null)}),e[di]=null}};function Vp(t){this._internalRoot=t}Vp.prototype.unstable_scheduleHydration=function(t){if(t){var e=tj();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ai.length&&e!==0&&e<Ai[n].priority;n++);Ai.splice(n,0,t),n===0&&sj(t)}};function Vv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Pw(){}function rO(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=tp(o);i.call(u)}}var o=_C(e,s,t,0,null,!1,!1,"",Pw);return t._reactRootContainer=o,t[di]=o.current,Eu(t.nodeType===8?t.parentNode:t),ka(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var u=tp(l);a.call(u)}}var l=Uv(t,0,!1,null,null,!1,!1,"",Pw);return t._reactRootContainer=l,t[di]=l.current,Eu(t.nodeType===8?t.parentNode:t),ka(function(){Wp(e,l,n,s)}),l}function Kp(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=tp(o);a.call(l)}}Wp(e,o,t,r)}else o=rO(n,e,t,r,s);return tp(o)}Z1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Gc(e.pendingLanes);n!==0&&(uv(e,n|1),ls(e,Jt()),!(st&6)&&(oc=Jt()+500,ko()))}break;case 13:ka(function(){var s=hi(t,1);if(s!==null){var r=Bn();ur(s,t,1,r)}}),Hv(t,1)}};dv=function(t){if(t.tag===13){var e=hi(t,134217728);if(e!==null){var n=Bn();ur(e,t,134217728,n)}Hv(t,134217728)}};ej=function(t){if(t.tag===13){var e=io(t),n=hi(t,e);if(n!==null){var s=Bn();ur(n,t,e,s)}Hv(t,e)}};tj=function(){return xt};nj=function(t,e){var n=xt;try{return xt=t,e()}finally{xt=n}};lx=function(t,e,n){switch(e){case"input":if(tx(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Lp(s);if(!r)throw Error(fe(90));O1(s),tx(s,r)}}}break;case"textarea":I1(t,n);break;case"select":e=n.value,e!=null&&_l(t,!!n.multiple,e,!1)}};U1=$v;H1=ka;var iO={usingClientEntryPoint:!1,Events:[_d,fl,Lp,z1,B1,$v]},Ic={findFiberByHostInstance:Yo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oO={bundleType:Ic.bundleType,version:Ic.version,rendererPackageName:Ic.rendererPackageName,rendererConfig:Ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=q1(t),t===null?null:t.stateNode},findFiberByHostInstance:Ic.findFiberByHostInstance||sO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{Op=yh.inject(oO),Lr=yh}catch{}}Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iO;Ps.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vv(e))throw Error(fe(200));return nO(t,e,null,n)};Ps.createRoot=function(t,e){if(!Vv(t))throw Error(fe(299));var n=!1,s="",r=SC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Uv(t,1,!1,null,null,n,!1,s,r),t[di]=e.current,Eu(t.nodeType===8?t.parentNode:t),new Wv(e)};Ps.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=q1(e),t=t===null?null:t.stateNode,t};Ps.flushSync=function(t){return ka(t)};Ps.hydrate=function(t,e,n){if(!qp(e))throw Error(fe(200));return Kp(null,t,e,!0,n)};Ps.hydrateRoot=function(t,e,n){if(!Vv(t))throw Error(fe(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=SC;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=_C(e,null,t,1,n??null,r,!1,i,o),t[di]=e.current,Eu(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Vp(e)};Ps.render=function(t,e,n){if(!qp(e))throw Error(fe(200));return Kp(null,t,e,!1,n)};Ps.unmountComponentAtNode=function(t){if(!qp(t))throw Error(fe(40));return t._reactRootContainer?(ka(function(){Kp(null,null,t,!1,function(){t._reactRootContainer=null,t[di]=null})}),!0):!1};Ps.unstable_batchedUpdates=$v;Ps.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!qp(n))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return Kp(t,e,n,!1,s)};Ps.version="18.3.1-next-f1338f8080-20240426";function jC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jC)}catch(t){console.error(t)}}jC(),j1.exports=Ps;var jd=j1.exports;const CC=f1(jd);var Rw=jd;Gg.createRoot=Rw.createRoot,Gg.hydrateRoot=Rw.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lu(){return Lu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Lu.apply(this,arguments)}var Gi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Gi||(Gi={}));const Aw="popstate";function aO(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return Bx("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:NC(r)}return cO(e,n,null,t)}function rn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lO(){return Math.random().toString(36).substr(2,8)}function Ow(t,e){return{usr:t.state,key:t.key,idx:e}}function Bx(t,e,n,s){return n===void 0&&(n=null),Lu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?hc(e):e,{state:n,key:e&&e.key||s||lO()})}function NC(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function hc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function cO(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=Gi.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Lu({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=Gi.Pop;let y=d(),g=y==null?null:y-u;u=y,l&&l({action:a,location:x.location,delta:g})}function f(y,g){a=Gi.Push;let m=Bx(x.location,y,g);u=d()+1;let b=Ow(m,u),k=x.createHref(m);try{o.pushState(b,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;r.location.assign(k)}i&&l&&l({action:a,location:x.location,delta:1})}function p(y,g){a=Gi.Replace;let m=Bx(x.location,y,g);u=d();let b=Ow(m,u),k=x.createHref(m);o.replaceState(b,"",k),i&&l&&l({action:a,location:x.location,delta:0})}function w(y){let g=r.location.origin!=="null"?r.location.origin:r.location.href,m=typeof y=="string"?y:NC(y);return m=m.replace(/ $/,"%20"),rn(g,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,g)}let x={get action(){return a},get location(){return t(r,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(Aw,h),l=y,()=>{r.removeEventListener(Aw,h),l=null}},createHref(y){return e(r,y)},createURL:w,encodeLocation(y){let g=w(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:p,go(y){return o.go(y)}};return x}var Mw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Mw||(Mw={}));function uO(t,e,n){return n===void 0&&(n="/"),dO(t,e,n)}function dO(t,e,n,s){let r=typeof e=="string"?hc(e):e,i=PC(r.pathname||"/",n);if(i==null)return null;let o=EC(t);hO(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=SO(i);a=wO(o[l],u)}return a}function EC(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(rn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=fa([s,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(rn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),EC(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:vO(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of TC(i.path))r(i,o,l)}),e}function TC(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=TC(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function hO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:bO(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const fO=/^:[\w-]+$/,pO=3,mO=2,gO=1,xO=10,yO=-2,Iw=t=>t==="*";function vO(t,e){let n=t.split("/"),s=n.length;return n.some(Iw)&&(s+=yO),e&&(s+=mO),n.filter(r=>!Iw(r)).reduce((r,i)=>r+(fO.test(i)?pO:i===""?gO:xO),s)}function bO(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function wO(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],u=a===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=kO({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),f=l.route;if(!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:fa([i,h.pathname]),pathnameBase:TO(fa([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=fa([i,h.pathnameBase]))}return o}function kO(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=_O(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let x=a[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const w=a[h];return p&&!w?u[f]=void 0:u[f]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function _O(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),qv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function SO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function PC(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const jO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,CO=t=>jO.test(t);function NO(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?hc(t):t,i;if(n)if(CO(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),qv(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=Dw(n.substring(1),"/"):i=Dw(n,e)}else i=e;return{pathname:i,search:PO(s),hash:RO(r)}}function Dw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Qm(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function EO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function RC(t,e){let n=EO(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function AC(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=hc(t):(r=Lu({},t),rn(!r.pathname||!r.pathname.includes("?"),Qm("?","pathname","search",r)),rn(!r.pathname||!r.pathname.includes("#"),Qm("#","pathname","hash",r)),rn(!r.search||!r.search.includes("#"),Qm("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;r.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=NO(r,a),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const fa=t=>t.join("/").replace(/\/\/+/g,"/"),TO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),PO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,RO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function AO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const OC=["post","put","patch","delete"];new Set(OC);const OO=["get",...OC];new Set(OO);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $u(){return $u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},$u.apply(this,arguments)}const Kv=v.createContext(null),MO=v.createContext(null),Cd=v.createContext(null),Gp=v.createContext(null),_o=v.createContext({outlet:null,matches:[],isDataRoute:!1}),MC=v.createContext(null);function Nd(){return v.useContext(Gp)!=null}function fc(){return Nd()||rn(!1),v.useContext(Gp).location}function IC(t){v.useContext(Cd).static||v.useLayoutEffect(t)}function Ed(){let{isDataRoute:t}=v.useContext(_o);return t?YO():IO()}function IO(){Nd()||rn(!1);let t=v.useContext(Kv),{basename:e,future:n,navigator:s}=v.useContext(Cd),{matches:r}=v.useContext(_o),{pathname:i}=fc(),o=JSON.stringify(RC(r,n.v7_relativeSplatPath)),a=v.useRef(!1);return IC(()=>{a.current=!0}),v.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){s.go(u);return}let h=AC(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:fa([e,h.pathname])),(d.replace?s.replace:s.push)(h,d.state,d)},[e,s,o,i,t])}const DO=v.createContext(null);function LO(t){let e=v.useContext(_o).outlet;return e&&v.createElement(DO.Provider,{value:t},e)}function $O(t,e){return FO(t,e)}function FO(t,e,n,s){Nd()||rn(!1);let{navigator:r}=v.useContext(Cd),{matches:i}=v.useContext(_o),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=fc(),d;if(e){var h;let y=typeof e=="string"?hc(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||rn(!1),d=y}else d=u;let f=d.pathname||"/",p=f;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let w=uO(t,{pathname:p}),x=WO(w&&w.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:fa([l,r.encodeLocation?r.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:fa([l,r.encodeLocation?r.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,s);return e&&x?v.createElement(Gp.Provider,{value:{location:$u({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Gi.Pop}},x):x}function zO(){let t=GO(),e=AO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),n?v.createElement("pre",{style:r},n):null,null)}const BO=v.createElement(zO,null);class UO extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?v.createElement(_o.Provider,{value:this.props.routeContext},v.createElement(MC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function HO(t){let{routeContext:e,match:n,children:s}=t,r=v.useContext(Kv);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),v.createElement(_o.Provider,{value:e},s)}function WO(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let d=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);d>=0||rn(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=n,w=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||w){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let p,w=!1,x=null,y=null;n&&(p=a&&h.route.id?a[h.route.id]:void 0,x=h.route.errorElement||BO,l&&(u<0&&f===0?(QO("route-fallback"),w=!0,y=null):u===f&&(w=!0,y=h.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),m=()=>{let b;return p?b=x:w?b=y:h.route.Component?b=v.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,v.createElement(HO,{match:h,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?v.createElement(UO,{location:n.location,revalidation:n.revalidation,component:x,error:p,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var DC=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(DC||{}),LC=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(LC||{});function VO(t){let e=v.useContext(Kv);return e||rn(!1),e}function qO(t){let e=v.useContext(MO);return e||rn(!1),e}function KO(t){let e=v.useContext(_o);return e||rn(!1),e}function $C(t){let e=KO(),n=e.matches[e.matches.length-1];return n.route.id||rn(!1),n.route.id}function GO(){var t;let e=v.useContext(MC),n=qO(),s=$C();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function YO(){let{router:t}=VO(DC.UseNavigateStable),e=$C(LC.UseNavigateStable),n=v.useRef(!1);return IC(()=>{n.current=!0}),v.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,$u({fromRouteId:e},i)))},[t,e])}const Lw={};function QO(t,e,n){Lw[t]||(Lw[t]=!0)}function XO(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function xf(t){let{to:e,replace:n,state:s,relative:r}=t;Nd()||rn(!1);let{future:i,static:o}=v.useContext(Cd),{matches:a}=v.useContext(_o),{pathname:l}=fc(),u=Ed(),d=AC(e,RC(a,i.v7_relativeSplatPath),l,r==="path"),h=JSON.stringify(d);return v.useEffect(()=>u(JSON.parse(h),{replace:n,state:s,relative:r}),[u,h,r,n,s]),null}function JO(t){return LO(t.context)}function Dn(t){rn(!1)}function ZO(t){let{basename:e="/",children:n=null,location:s,navigationType:r=Gi.Pop,navigator:i,static:o=!1,future:a}=t;Nd()&&rn(!1);let l=e.replace(/^\/*/,"/"),u=v.useMemo(()=>({basename:l,navigator:i,static:o,future:$u({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=hc(s));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:w="default"}=s,x=v.useMemo(()=>{let y=PC(d,l);return y==null?null:{location:{pathname:y,search:h,hash:f,state:p,key:w},navigationType:r}},[l,d,h,f,p,w,r]);return x==null?null:v.createElement(Cd.Provider,{value:u},v.createElement(Gp.Provider,{children:n,value:x}))}function eM(t){let{children:e,location:n}=t;return $O(Ux(e),n)}new Promise(()=>{});function Ux(t,e){e===void 0&&(e=[]);let n=[];return v.Children.forEach(t,(s,r)=>{if(!v.isValidElement(s))return;let i=[...e,r];if(s.type===v.Fragment){n.push.apply(n,Ux(s.props.children,i));return}s.type!==Dn&&rn(!1),!s.props.index||!s.props.children||rn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Ux(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const tM="6";try{window.__reactRouterVersion=tM}catch{}const nM="startTransition",$w=Ap[nM];function sM(t){let{basename:e,children:n,future:s,window:r}=t,i=v.useRef();i.current==null&&(i.current=aO({window:r,v5Compat:!0}));let o=i.current,[a,l]=v.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},d=v.useCallback(h=>{u&&$w?$w(()=>l(h)):l(h)},[l,u]);return v.useLayoutEffect(()=>o.listen(d),[o,d]),v.useEffect(()=>XO(s),[s]),v.createElement(ZO,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}var Fw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Fw||(Fw={}));var zw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(zw||(zw={}));var np=["light","dark"],Gv="(prefers-color-scheme: dark)",rM=typeof window>"u",Yv=v.createContext(void 0),iM={setTheme:t=>{},themes:[]},oM=()=>{var t;return(t=v.useContext(Yv))!=null?t:iM},aM=t=>v.useContext(Yv)?t.children:v.createElement(cM,{...t}),lM=["light","dark"],cM=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:s=!0,storageKey:r="theme",themes:i=lM,defaultTheme:o=n?"system":"light",attribute:a="data-theme",value:l,children:u,nonce:d})=>{let[h,f]=v.useState(()=>Bw(r,o)),[p,w]=v.useState(()=>Bw(r)),x=l?Object.values(l):i,y=v.useCallback(k=>{let _=k;if(!_)return;k==="system"&&n&&(_=Uw());let C=l?l[_]:_,S=e?dM():null,j=document.documentElement;if(a==="class"?(j.classList.remove(...x),C&&j.classList.add(C)):C?j.setAttribute(a,C):j.removeAttribute(a),s){let E=np.includes(o)?o:null,P=np.includes(_)?_:E;j.style.colorScheme=P}S==null||S()},[]),g=v.useCallback(k=>{let _=typeof k=="function"?k(k):k;f(_);try{localStorage.setItem(r,_)}catch{}},[t]),m=v.useCallback(k=>{let _=Uw(k);w(_),h==="system"&&n&&!t&&y("system")},[h,t]);v.useEffect(()=>{let k=window.matchMedia(Gv);return k.addListener(m),m(k),()=>k.removeListener(m)},[m]),v.useEffect(()=>{let k=_=>{if(_.key!==r)return;let C=_.newValue||o;g(C)};return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[g]),v.useEffect(()=>{y(t??h)},[t,h]);let b=v.useMemo(()=>({theme:h,setTheme:g,forcedTheme:t,resolvedTheme:h==="system"?p:h,themes:n?[...i,"system"]:i,systemTheme:n?p:void 0}),[h,g,t,p,n,i]);return v.createElement(Yv.Provider,{value:b},v.createElement(uM,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:s,storageKey:r,themes:i,defaultTheme:o,attribute:a,value:l,children:u,attrs:x,nonce:d}),u)},uM=v.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:s,enableColorScheme:r,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let u=i==="system",d=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(w=>`'${w}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=r?np.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(w,x=!1,y=!0)=>{let g=o?o[w]:w,m=x?w+"|| ''":`'${g}'`,b="";return r&&y&&!x&&np.includes(w)&&(b+=`d.style.colorScheme = '${w}';`),n==="class"?x||g?b+=`c.add(${m})`:b+="null":g&&(b+=`d[s](n,${m})`),b},p=t?`!function(){${d}${f(t)}}()`:s?`!function(){try{${d}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${Gv}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return v.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),Bw=(t,e)=>{if(rM)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},dM=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},Uw=t=>(t||(t=window.matchMedia(Gv)),t.matches?"dark":"light"),Aa=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},hM={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Di,Xy,t1,fM=(t1=class{constructor(){Ce(this,Di,hM);Ce(this,Xy,!1)}setTimeoutProvider(t){xe(this,Di,t)}setTimeout(t,e){return M(this,Di).setTimeout(t,e)}clearTimeout(t){M(this,Di).clearTimeout(t)}setInterval(t,e){return M(this,Di).setInterval(t,e)}clearInterval(t){M(this,Di).clearInterval(t)}},Di=new WeakMap,Xy=new WeakMap,t1),Jo=new fM;function pM(t){setTimeout(t,0)}var _a=typeof window>"u"||"Deno"in globalThis;function En(){}function mM(t,e){return typeof t=="function"?t(e):t}function Hx(t){return typeof t=="number"&&t>=0&&t!==1/0}function FC(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ao(t,e){return typeof t=="function"?t(e):t}function Ds(t,e){return typeof t=="function"?t(e):t}function Hw(t,e){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:o,stale:a}=t;if(o){if(s){if(e.queryHash!==Qv(o,e.options))return!1}else if(!Fu(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||r&&r!==e.state.fetchStatus||i&&!i(e))}function Ww(t,e){const{exact:n,status:s,predicate:r,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(Sa(e.options.mutationKey)!==Sa(i))return!1}else if(!Fu(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||r&&!r(e))}function Qv(t,e){return((e==null?void 0:e.queryKeyHashFn)||Sa)(t)}function Sa(t){return JSON.stringify(t,(e,n)=>Wx(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Fu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Fu(t[n],e[n])):!1}var gM=Object.prototype.hasOwnProperty;function Xv(t,e){if(t===e)return t;const n=Vw(t)&&Vw(e);if(!n&&!(Wx(t)&&Wx(e)))return e;const r=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let l=0;for(let u=0;u<o;u++){const d=n?u:i[u],h=t[d],f=e[d];if(h===f){a[d]=h,(n?u<r:gM.call(t,d))&&l++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){a[d]=f;continue}const p=Xv(h,f);a[d]=p,p===h&&l++}return r===o&&l===r?t:a}function zu(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Vw(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Wx(t){if(!qw(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!qw(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function qw(t){return Object.prototype.toString.call(t)==="[object Object]"}function xM(t){return new Promise(e=>{Jo.setTimeout(e,t)})}function Vx(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Xv(t,e):e}function yM(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function vM(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var Jv=Symbol();function zC(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Jv?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function BC(t,e){return typeof t=="function"?t(...e):!!t}var na,Li,Fl,n1,bM=(n1=class extends Aa{constructor(){super();Ce(this,na);Ce(this,Li);Ce(this,Fl);xe(this,Fl,e=>{if(!_a&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){M(this,Li)||this.setEventListener(M(this,Fl))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,Li))==null||e.call(this),xe(this,Li,void 0))}setEventListener(e){var n;xe(this,Fl,e),(n=M(this,Li))==null||n.call(this),xe(this,Li,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){M(this,na)!==e&&(xe(this,na,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof M(this,na)=="boolean"?M(this,na):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},na=new WeakMap,Li=new WeakMap,Fl=new WeakMap,n1),Zv=new bM;function qx(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),t(r)},n.reject=r=>{s({status:"rejected",reason:r}),e(r)},n}var wM=pM;function kM(){let t=[],e=0,n=a=>{a()},s=a=>{a()},r=wM;const i=a=>{e?t.push(a):r(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&r(()=>{s(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{r=a}}}var qt=kM(),zl,$i,Bl,s1,_M=(s1=class extends Aa{constructor(){super();Ce(this,zl,!0);Ce(this,$i);Ce(this,Bl);xe(this,Bl,e=>{if(!_a&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){M(this,$i)||this.setEventListener(M(this,Bl))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,$i))==null||e.call(this),xe(this,$i,void 0))}setEventListener(e){var n;xe(this,Bl,e),(n=M(this,$i))==null||n.call(this),xe(this,$i,e(this.setOnline.bind(this)))}setOnline(e){M(this,zl)!==e&&(xe(this,zl,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return M(this,zl)}},zl=new WeakMap,$i=new WeakMap,Bl=new WeakMap,s1),sp=new _M;function SM(t){return Math.min(1e3*2**t,3e4)}function UC(t){return(t??"online")==="online"?sp.isOnline():!0}var Kx=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function HC(t){let e=!1,n=0,s;const r=qx(),i=()=>r.status!=="pending",o=x=>{var y;if(!i()){const g=new Kx(x);f(g),(y=t.onCancel)==null||y.call(t,g)}},a=()=>{e=!0},l=()=>{e=!1},u=()=>Zv.isFocused()&&(t.networkMode==="always"||sp.isOnline())&&t.canRun(),d=()=>UC(t.networkMode)&&t.canRun(),h=x=>{i()||(s==null||s(),r.resolve(x))},f=x=>{i()||(s==null||s(),r.reject(x))},p=()=>new Promise(x=>{var y;s=g=>{(i()||u())&&x(g)},(y=t.onPause)==null||y.call(t)}).then(()=>{var x;s=void 0,i()||(x=t.onContinue)==null||x.call(t)}),w=()=>{if(i())return;let x;const y=n===0?t.initialPromise:void 0;try{x=y??t.fn()}catch(g){x=Promise.reject(g)}Promise.resolve(x).then(h).catch(g=>{var C;if(i())return;const m=t.retry??(_a?0:3),b=t.retryDelay??SM,k=typeof b=="function"?b(n,g):b,_=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,g);if(e||!_){f(g);return}n++,(C=t.onFail)==null||C.call(t,n,g),xM(k).then(()=>u()?void 0:p()).then(()=>{e?f(g):w()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(s==null||s(),r),cancelRetry:a,continueRetry:l,canStart:d,start:()=>(d()?w():p().then(w),r)}}var sa,r1,WC=(r1=class{constructor(){Ce(this,sa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Hx(this.gcTime)&&xe(this,sa,Jo.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(_a?1/0:5*60*1e3))}clearGcTimeout(){M(this,sa)&&(Jo.clearTimeout(M(this,sa)),xe(this,sa,void 0))}},sa=new WeakMap,r1),ra,Ul,Ms,ia,hn,hd,oa,rr,qr,i1,jM=(i1=class extends WC{constructor(e){super();Ce(this,rr);Ce(this,ra);Ce(this,Ul);Ce(this,Ms);Ce(this,ia);Ce(this,hn);Ce(this,hd);Ce(this,oa);xe(this,oa,!1),xe(this,hd,e.defaultOptions),this.setOptions(e.options),this.observers=[],xe(this,ia,e.client),xe(this,Ms,M(this,ia).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,xe(this,ra,Gw(this.options)),this.state=e.state??M(this,ra),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=M(this,hn))==null?void 0:e.promise}setOptions(e){if(this.options={...M(this,hd),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Gw(this.options);n.data!==void 0&&(this.setState(Kw(n.data,n.dataUpdatedAt)),xe(this,ra,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&M(this,Ms).remove(this)}setData(e,n){const s=Vx(this.state.data,e,this.options);return Fe(this,rr,qr).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){Fe(this,rr,qr).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,r;const n=(s=M(this,hn))==null?void 0:s.promise;return(r=M(this,hn))==null||r.cancel(e),n?n.then(En).catch(En):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(M(this,ra))}isActive(){return this.observers.some(e=>Ds(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Jv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ao(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!FC(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=M(this,hn))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=M(this,hn))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),M(this,Ms).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(M(this,hn)&&(M(this,oa)?M(this,hn).cancel({revert:!0}):M(this,hn).cancelRetry()),this.scheduleGc()),M(this,Ms).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Fe(this,rr,qr).call(this,{type:"invalidate"})}async fetch(e,n){var l,u,d,h,f,p,w,x,y,g,m,b;if(this.state.fetchStatus!=="idle"&&((l=M(this,hn))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(M(this,hn))return M(this,hn).continueRetry(),M(this,hn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const k=this.observers.find(_=>_.options.queryFn);k&&this.setOptions(k.options)}const s=new AbortController,r=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(xe(this,oa,!0),s.signal)})},i=()=>{const k=zC(this.options,n),C=(()=>{const S={client:M(this,ia),queryKey:this.queryKey,meta:this.meta};return r(S),S})();return xe(this,oa,!1),this.options.persister?this.options.persister(k,C,this):k(C)},a=(()=>{const k={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:M(this,ia),state:this.state,fetchFn:i};return r(k),k})();(u=this.options.behavior)==null||u.onFetch(a,this),xe(this,Ul,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=a.fetchOptions)==null?void 0:d.meta))&&Fe(this,rr,qr).call(this,{type:"fetch",meta:(h=a.fetchOptions)==null?void 0:h.meta}),xe(this,hn,HC({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,onCancel:k=>{k instanceof Kx&&k.revert&&this.setState({...M(this,Ul),fetchStatus:"idle"}),s.abort()},onFail:(k,_)=>{Fe(this,rr,qr).call(this,{type:"failed",failureCount:k,error:_})},onPause:()=>{Fe(this,rr,qr).call(this,{type:"pause"})},onContinue:()=>{Fe(this,rr,qr).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const k=await M(this,hn).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(p=(f=M(this,Ms).config).onSuccess)==null||p.call(f,k,this),(x=(w=M(this,Ms).config).onSettled)==null||x.call(w,k,this.state.error,this),k}catch(k){if(k instanceof Kx){if(k.silent)return M(this,hn).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw Fe(this,rr,qr).call(this,{type:"error",error:k}),(g=(y=M(this,Ms).config).onError)==null||g.call(y,k,this),(b=(m=M(this,Ms).config).onSettled)==null||b.call(m,this.state.data,k,this),k}finally{this.scheduleGc()}}},ra=new WeakMap,Ul=new WeakMap,Ms=new WeakMap,ia=new WeakMap,hn=new WeakMap,hd=new WeakMap,oa=new WeakMap,rr=new WeakSet,qr=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...VC(s.data,this.options),fetchMeta:e.meta??null};case"success":const r={...s,...Kw(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return xe(this,Ul,e.manual?r:void 0),r;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),qt.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),M(this,Ms).notify({query:this,type:"updated",action:e})})},i1);function VC(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:UC(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Kw(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Gw(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Jn,Ze,fd,Ln,aa,Hl,Zr,Fi,pd,Wl,Vl,la,ca,zi,ql,ht,Qc,Gx,Yx,Qx,Xx,Jx,Zx,ey,qC,o1,e0=(o1=class extends Aa{constructor(e,n){super();Ce(this,ht);Ce(this,Jn);Ce(this,Ze);Ce(this,fd);Ce(this,Ln);Ce(this,aa);Ce(this,Hl);Ce(this,Zr);Ce(this,Fi);Ce(this,pd);Ce(this,Wl);Ce(this,Vl);Ce(this,la);Ce(this,ca);Ce(this,zi);Ce(this,ql,new Set);this.options=n,xe(this,Jn,e),xe(this,Fi,null),xe(this,Zr,qx()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(M(this,Ze).addObserver(this),Yw(M(this,Ze),this.options)?Fe(this,ht,Qc).call(this):this.updateResult(),Fe(this,ht,Xx).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ty(M(this,Ze),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ty(M(this,Ze),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Fe(this,ht,Jx).call(this),Fe(this,ht,Zx).call(this),M(this,Ze).removeObserver(this)}setOptions(e){const n=this.options,s=M(this,Ze);if(this.options=M(this,Jn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ds(this.options.enabled,M(this,Ze))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Fe(this,ht,ey).call(this),M(this,Ze).setOptions(this.options),n._defaulted&&!zu(this.options,n)&&M(this,Jn).getQueryCache().notify({type:"observerOptionsUpdated",query:M(this,Ze),observer:this});const r=this.hasListeners();r&&Qw(M(this,Ze),s,this.options,n)&&Fe(this,ht,Qc).call(this),this.updateResult(),r&&(M(this,Ze)!==s||Ds(this.options.enabled,M(this,Ze))!==Ds(n.enabled,M(this,Ze))||ao(this.options.staleTime,M(this,Ze))!==ao(n.staleTime,M(this,Ze)))&&Fe(this,ht,Gx).call(this);const i=Fe(this,ht,Yx).call(this);r&&(M(this,Ze)!==s||Ds(this.options.enabled,M(this,Ze))!==Ds(n.enabled,M(this,Ze))||i!==M(this,zi))&&Fe(this,ht,Qx).call(this,i)}getOptimisticResult(e){const n=M(this,Jn).getQueryCache().build(M(this,Jn),e),s=this.createResult(n,e);return NM(this,s)&&(xe(this,Ln,s),xe(this,Hl,this.options),xe(this,aa,M(this,Ze).state)),s}getCurrentResult(){return M(this,Ln)}trackResult(e,n){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),n==null||n(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&M(this,Zr).status==="pending"&&M(this,Zr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){M(this,ql).add(e)}getCurrentQuery(){return M(this,Ze)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=M(this,Jn).defaultQueryOptions(e),s=M(this,Jn).getQueryCache().build(M(this,Jn),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return Fe(this,ht,Qc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),M(this,Ln)))}createResult(e,n){var E;const s=M(this,Ze),r=this.options,i=M(this,Ln),o=M(this,aa),a=M(this,Hl),u=e!==s?e.state:M(this,fd),{state:d}=e;let h={...d},f=!1,p;if(n._optimisticResults){const P=this.hasListeners(),L=!P&&Yw(e,n),I=P&&Qw(e,s,n,r);(L||I)&&(h={...h,...VC(d.data,e.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:w,errorUpdatedAt:x,status:y}=h;p=h.data;let g=!1;if(n.placeholderData!==void 0&&p===void 0&&y==="pending"){let P;i!=null&&i.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData)?(P=i.data,g=!0):P=typeof n.placeholderData=="function"?n.placeholderData((E=M(this,Vl))==null?void 0:E.state.data,M(this,Vl)):n.placeholderData,P!==void 0&&(y="success",p=Vx(i==null?void 0:i.data,P,n),f=!0)}if(n.select&&p!==void 0&&!g)if(i&&p===(o==null?void 0:o.data)&&n.select===M(this,pd))p=M(this,Wl);else try{xe(this,pd,n.select),p=n.select(p),p=Vx(i==null?void 0:i.data,p,n),xe(this,Wl,p),xe(this,Fi,null)}catch(P){xe(this,Fi,P)}M(this,Fi)&&(w=M(this,Fi),p=M(this,Wl),x=Date.now(),y="error");const m=h.fetchStatus==="fetching",b=y==="pending",k=y==="error",_=b&&m,C=p!==void 0,j={status:y,fetchStatus:h.fetchStatus,isPending:b,isSuccess:y==="success",isError:k,isInitialLoading:_,isLoading:_,data:p,dataUpdatedAt:h.dataUpdatedAt,error:w,errorUpdatedAt:x,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:m,isRefetching:m&&!b,isLoadingError:k&&!C,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:k&&C,isStale:t0(e,n),refetch:this.refetch,promise:M(this,Zr),isEnabled:Ds(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const P=O=>{j.status==="error"?O.reject(j.error):j.data!==void 0&&O.resolve(j.data)},L=()=>{const O=xe(this,Zr,j.promise=qx());P(O)},I=M(this,Zr);switch(I.status){case"pending":e.queryHash===s.queryHash&&P(I);break;case"fulfilled":(j.status==="error"||j.data!==I.value)&&L();break;case"rejected":(j.status!=="error"||j.error!==I.reason)&&L();break}}return j}updateResult(){const e=M(this,Ln),n=this.createResult(M(this,Ze),this.options);if(xe(this,aa,M(this,Ze).state),xe(this,Hl,this.options),M(this,aa).data!==void 0&&xe(this,Vl,M(this,Ze)),zu(n,e))return;xe(this,Ln,n);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!M(this,ql).size)return!0;const o=new Set(i??M(this,ql));return this.options.throwOnError&&o.add("error"),Object.keys(M(this,Ln)).some(a=>{const l=a;return M(this,Ln)[l]!==e[l]&&o.has(l)})};Fe(this,ht,qC).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Fe(this,ht,Xx).call(this)}},Jn=new WeakMap,Ze=new WeakMap,fd=new WeakMap,Ln=new WeakMap,aa=new WeakMap,Hl=new WeakMap,Zr=new WeakMap,Fi=new WeakMap,pd=new WeakMap,Wl=new WeakMap,Vl=new WeakMap,la=new WeakMap,ca=new WeakMap,zi=new WeakMap,ql=new WeakMap,ht=new WeakSet,Qc=function(e){Fe(this,ht,ey).call(this);let n=M(this,Ze).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(En)),n},Gx=function(){Fe(this,ht,Jx).call(this);const e=ao(this.options.staleTime,M(this,Ze));if(_a||M(this,Ln).isStale||!Hx(e))return;const s=FC(M(this,Ln).dataUpdatedAt,e)+1;xe(this,la,Jo.setTimeout(()=>{M(this,Ln).isStale||this.updateResult()},s))},Yx=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(M(this,Ze)):this.options.refetchInterval)??!1},Qx=function(e){Fe(this,ht,Zx).call(this),xe(this,zi,e),!(_a||Ds(this.options.enabled,M(this,Ze))===!1||!Hx(M(this,zi))||M(this,zi)===0)&&xe(this,ca,Jo.setInterval(()=>{(this.options.refetchIntervalInBackground||Zv.isFocused())&&Fe(this,ht,Qc).call(this)},M(this,zi)))},Xx=function(){Fe(this,ht,Gx).call(this),Fe(this,ht,Qx).call(this,Fe(this,ht,Yx).call(this))},Jx=function(){M(this,la)&&(Jo.clearTimeout(M(this,la)),xe(this,la,void 0))},Zx=function(){M(this,ca)&&(Jo.clearInterval(M(this,ca)),xe(this,ca,void 0))},ey=function(){const e=M(this,Jn).getQueryCache().build(M(this,Jn),this.options);if(e===M(this,Ze))return;const n=M(this,Ze);xe(this,Ze,e),xe(this,fd,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},qC=function(e){qt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(M(this,Ln))}),M(this,Jn).getQueryCache().notify({query:M(this,Ze),type:"observerResultsUpdated"})})},o1);function CM(t,e){return Ds(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Yw(t,e){return CM(t,e)||t.state.data!==void 0&&ty(t,e,e.refetchOnMount)}function ty(t,e,n){if(Ds(e.enabled,t)!==!1&&ao(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&t0(t,e)}return!1}function Qw(t,e,n,s){return(t!==e||Ds(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&t0(t,n)}function t0(t,e){return Ds(e.enabled,t)!==!1&&t.isStaleByTime(ao(e.staleTime,t))}function NM(t,e){return!zu(t.getCurrentResult(),e)}function Xw(t){return{onFetch:(e,n)=>{var d,h,f,p,w;const s=e.options,r=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((w=e.state.data)==null?void 0:w.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const u=async()=>{let x=!1;const y=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?x=!0:e.signal.addEventListener("abort",()=>{x=!0}),e.signal)})},g=zC(e.options,e.fetchOptions),m=async(b,k,_)=>{if(x)return Promise.reject();if(k==null&&b.pages.length)return Promise.resolve(b);const S=(()=>{const L={client:e.client,queryKey:e.queryKey,pageParam:k,direction:_?"backward":"forward",meta:e.options.meta};return y(L),L})(),j=await g(S),{maxPages:E}=e.options,P=_?vM:yM;return{pages:P(b.pages,j,E),pageParams:P(b.pageParams,k,E)}};if(r&&i.length){const b=r==="backward",k=b?EM:Jw,_={pages:i,pageParams:o},C=k(s,_);a=await m(_,C,b)}else{const b=t??i.length;do{const k=l===0?o[0]??s.initialPageParam:Jw(s,a);if(l>0&&k==null)break;a=await m(a,k),l++}while(l<b)}return a};e.options.persister?e.fetchFn=()=>{var x,y;return(y=(x=e.options).persister)==null?void 0:y.call(x,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function Jw(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function EM(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var md,Er,$n,ua,Tr,Ni,a1,TM=(a1=class extends WC{constructor(e){super();Ce(this,Tr);Ce(this,md);Ce(this,Er);Ce(this,$n);Ce(this,ua);xe(this,md,e.client),this.mutationId=e.mutationId,xe(this,$n,e.mutationCache),xe(this,Er,[]),this.state=e.state||KC(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){M(this,Er).includes(e)||(M(this,Er).push(e),this.clearGcTimeout(),M(this,$n).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){xe(this,Er,M(this,Er).filter(n=>n!==e)),this.scheduleGc(),M(this,$n).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){M(this,Er).length||(this.state.status==="pending"?this.scheduleGc():M(this,$n).remove(this))}continue(){var e;return((e=M(this,ua))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,a,l,u,d,h,f,p,w,x,y,g,m,b,k,_,C,S,j,E;const n=()=>{Fe(this,Tr,Ni).call(this,{type:"continue"})},s={client:M(this,md),meta:this.options.meta,mutationKey:this.options.mutationKey};xe(this,ua,HC({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(P,L)=>{Fe(this,Tr,Ni).call(this,{type:"failed",failureCount:P,error:L})},onPause:()=>{Fe(this,Tr,Ni).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>M(this,$n).canRun(this)}));const r=this.state.status==="pending",i=!M(this,ua).canStart();try{if(r)n();else{Fe(this,Tr,Ni).call(this,{type:"pending",variables:e,isPaused:i}),await((a=(o=M(this,$n).config).onMutate)==null?void 0:a.call(o,e,this,s));const L=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,e,s));L!==this.state.context&&Fe(this,Tr,Ni).call(this,{type:"pending",context:L,variables:e,isPaused:i})}const P=await M(this,ua).start();return await((h=(d=M(this,$n).config).onSuccess)==null?void 0:h.call(d,P,e,this.state.context,this,s)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,P,e,this.state.context,s)),await((x=(w=M(this,$n).config).onSettled)==null?void 0:x.call(w,P,null,this.state.variables,this.state.context,this,s)),await((g=(y=this.options).onSettled)==null?void 0:g.call(y,P,null,e,this.state.context,s)),Fe(this,Tr,Ni).call(this,{type:"success",data:P}),P}catch(P){try{throw await((b=(m=M(this,$n).config).onError)==null?void 0:b.call(m,P,e,this.state.context,this,s)),await((_=(k=this.options).onError)==null?void 0:_.call(k,P,e,this.state.context,s)),await((S=(C=M(this,$n).config).onSettled)==null?void 0:S.call(C,void 0,P,this.state.variables,this.state.context,this,s)),await((E=(j=this.options).onSettled)==null?void 0:E.call(j,void 0,P,e,this.state.context,s)),P}finally{Fe(this,Tr,Ni).call(this,{type:"error",error:P})}}finally{M(this,$n).runNext(this)}}},md=new WeakMap,Er=new WeakMap,$n=new WeakMap,ua=new WeakMap,Tr=new WeakSet,Ni=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),qt.batch(()=>{M(this,Er).forEach(s=>{s.onMutationUpdate(e)}),M(this,$n).notify({mutation:this,type:"updated",action:e})})},a1);function KC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ei,ir,gd,l1,PM=(l1=class extends Aa{constructor(e={}){super();Ce(this,ei);Ce(this,ir);Ce(this,gd);this.config=e,xe(this,ei,new Set),xe(this,ir,new Map),xe(this,gd,0)}build(e,n,s){const r=new TM({client:e,mutationCache:this,mutationId:++th(this,gd)._,options:e.defaultMutationOptions(n),state:s});return this.add(r),r}add(e){M(this,ei).add(e);const n=vh(e);if(typeof n=="string"){const s=M(this,ir).get(n);s?s.push(e):M(this,ir).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(M(this,ei).delete(e)){const n=vh(e);if(typeof n=="string"){const s=M(this,ir).get(n);if(s)if(s.length>1){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}else s[0]===e&&M(this,ir).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=vh(e);if(typeof n=="string"){const s=M(this,ir).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===e}else return!0}runNext(e){var s;const n=vh(e);if(typeof n=="string"){const r=(s=M(this,ir).get(n))==null?void 0:s.find(i=>i!==e&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){qt.batch(()=>{M(this,ei).forEach(e=>{this.notify({type:"removed",mutation:e})}),M(this,ei).clear(),M(this,ir).clear()})}getAll(){return Array.from(M(this,ei))}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Ww(n,s))}findAll(e={}){return this.getAll().filter(n=>Ww(e,n))}notify(e){qt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return qt.batch(()=>Promise.all(e.map(n=>n.continue().catch(En))))}},ei=new WeakMap,ir=new WeakMap,gd=new WeakMap,l1);function vh(t){var e;return(e=t.options.scope)==null?void 0:e.id}var ti,Bi,Zn,ni,ci,yf,ny,c1,RM=(c1=class extends Aa{constructor(n,s){super();Ce(this,ci);Ce(this,ti);Ce(this,Bi);Ce(this,Zn);Ce(this,ni);xe(this,ti,n),this.setOptions(s),this.bindMethods(),Fe(this,ci,yf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const s=this.options;this.options=M(this,ti).defaultMutationOptions(n),zu(this.options,s)||M(this,ti).getMutationCache().notify({type:"observerOptionsUpdated",mutation:M(this,Zn),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Sa(s.mutationKey)!==Sa(this.options.mutationKey)?this.reset():((r=M(this,Zn))==null?void 0:r.state.status)==="pending"&&M(this,Zn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=M(this,Zn))==null||n.removeObserver(this)}onMutationUpdate(n){Fe(this,ci,yf).call(this),Fe(this,ci,ny).call(this,n)}getCurrentResult(){return M(this,Bi)}reset(){var n;(n=M(this,Zn))==null||n.removeObserver(this),xe(this,Zn,void 0),Fe(this,ci,yf).call(this),Fe(this,ci,ny).call(this)}mutate(n,s){var r;return xe(this,ni,s),(r=M(this,Zn))==null||r.removeObserver(this),xe(this,Zn,M(this,ti).getMutationCache().build(M(this,ti),this.options)),M(this,Zn).addObserver(this),M(this,Zn).execute(n)}},ti=new WeakMap,Bi=new WeakMap,Zn=new WeakMap,ni=new WeakMap,ci=new WeakSet,yf=function(){var s;const n=((s=M(this,Zn))==null?void 0:s.state)??KC();xe(this,Bi,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},ny=function(n){qt.batch(()=>{var s,r,i,o,a,l,u,d;if(M(this,ni)&&this.hasListeners()){const h=M(this,Bi).variables,f=M(this,Bi).context,p={client:M(this,ti),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((r=(s=M(this,ni)).onSuccess)==null||r.call(s,n.data,h,f,p),(o=(i=M(this,ni)).onSettled)==null||o.call(i,n.data,null,h,f,p)):(n==null?void 0:n.type)==="error"&&((l=(a=M(this,ni)).onError)==null||l.call(a,n.error,h,f,p),(d=(u=M(this,ni)).onSettled)==null||d.call(u,void 0,n.error,h,f,p))}this.listeners.forEach(h=>{h(M(this,Bi))})})},c1);function Zw(t,e){const n=new Set(e);return t.filter(s=>!n.has(s))}function AM(t,e,n){const s=t.slice(0);return s[e]=n,s}var Kl,ys,Gl,Yl,Is,Ui,xd,yd,vd,_n,sy,ry,iy,oy,ay,u1,OM=(u1=class extends Aa{constructor(e,n,s){super();Ce(this,_n);Ce(this,Kl);Ce(this,ys);Ce(this,Gl);Ce(this,Yl);Ce(this,Is);Ce(this,Ui);Ce(this,xd);Ce(this,yd);Ce(this,vd,[]);xe(this,Kl,e),xe(this,Yl,s),xe(this,Gl,[]),xe(this,Is,[]),xe(this,ys,[]),this.setQueries(n)}onSubscribe(){this.listeners.size===1&&M(this,Is).forEach(e=>{e.subscribe(n=>{Fe(this,_n,oy).call(this,e,n)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,M(this,Is).forEach(e=>{e.destroy()})}setQueries(e,n){xe(this,Gl,e),xe(this,Yl,n),qt.batch(()=>{const s=M(this,Is),r=Fe(this,_n,iy).call(this,M(this,Gl));xe(this,vd,r),r.forEach(h=>h.observer.setOptions(h.defaultedQueryOptions));const i=r.map(h=>h.observer),o=i.map(h=>h.getCurrentResult()),a=s.length!==i.length,l=i.some((h,f)=>h!==s[f]),u=a||l,d=u?!0:o.some((h,f)=>{const p=M(this,ys)[f];return!p||!zu(h,p)});!u&&!d||(u&&xe(this,Is,i),xe(this,ys,o),this.hasListeners()&&(u&&(Zw(s,i).forEach(h=>{h.destroy()}),Zw(i,s).forEach(h=>{h.subscribe(f=>{Fe(this,_n,oy).call(this,h,f)})})),Fe(this,_n,ay).call(this)))})}getCurrentResult(){return M(this,ys)}getQueries(){return M(this,Is).map(e=>e.getCurrentQuery())}getObservers(){return M(this,Is)}getOptimisticResult(e,n){const s=Fe(this,_n,iy).call(this,e),r=s.map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[r,i=>Fe(this,_n,ry).call(this,i??r,n),()=>Fe(this,_n,sy).call(this,r,s)]}},Kl=new WeakMap,ys=new WeakMap,Gl=new WeakMap,Yl=new WeakMap,Is=new WeakMap,Ui=new WeakMap,xd=new WeakMap,yd=new WeakMap,vd=new WeakMap,_n=new WeakSet,sy=function(e,n){return n.map((s,r)=>{const i=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?i:s.observer.trackResult(i,o=>{n.forEach(a=>{a.observer.trackProp(o)})})})},ry=function(e,n){return n?((!M(this,Ui)||M(this,ys)!==M(this,yd)||n!==M(this,xd))&&(xe(this,xd,n),xe(this,yd,M(this,ys)),xe(this,Ui,Xv(M(this,Ui),n(e)))),M(this,Ui)):e},iy=function(e){const n=new Map;M(this,Is).forEach(r=>{const i=r.options.queryHash;if(!i)return;const o=n.get(i);o?o.push(r):n.set(i,[r])});const s=[];return e.forEach(r=>{var l;const i=M(this,Kl).defaultQueryOptions(r),a=((l=n.get(i.queryHash))==null?void 0:l.shift())??new e0(M(this,Kl),i);s.push({defaultedQueryOptions:i,observer:a})}),s},oy=function(e,n){const s=M(this,Is).indexOf(e);s!==-1&&(xe(this,ys,AM(M(this,ys),s,n)),Fe(this,_n,ay).call(this))},ay=function(){var e;if(this.hasListeners()){const n=M(this,Ui),s=Fe(this,_n,sy).call(this,M(this,ys),M(this,vd)),r=Fe(this,_n,ry).call(this,s,(e=M(this,Yl))==null?void 0:e.combine);n!==r&&qt.batch(()=>{this.listeners.forEach(i=>{i(M(this,ys))})})}},u1),Pr,d1,MM=(d1=class extends Aa{constructor(e={}){super();Ce(this,Pr);this.config=e,xe(this,Pr,new Map)}build(e,n,s){const r=n.queryKey,i=n.queryHash??Qv(r,n);let o=this.get(i);return o||(o=new jM({client:e,queryKey:r,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(o)),o}add(e){M(this,Pr).has(e.queryHash)||(M(this,Pr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=M(this,Pr).get(e.queryHash);n&&(e.destroy(),n===e&&M(this,Pr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){qt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return M(this,Pr).get(e)}getAll(){return[...M(this,Pr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Hw(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>Hw(e,s)):n}notify(e){qt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){qt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){qt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Pr=new WeakMap,d1),Ht,Hi,Wi,Ql,Xl,Vi,Jl,Zl,h1,IM=(h1=class{constructor(t={}){Ce(this,Ht);Ce(this,Hi);Ce(this,Wi);Ce(this,Ql);Ce(this,Xl);Ce(this,Vi);Ce(this,Jl);Ce(this,Zl);xe(this,Ht,t.queryCache||new MM),xe(this,Hi,t.mutationCache||new PM),xe(this,Wi,t.defaultOptions||{}),xe(this,Ql,new Map),xe(this,Xl,new Map),xe(this,Vi,0)}mount(){th(this,Vi)._++,M(this,Vi)===1&&(xe(this,Jl,Zv.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Ht).onFocus())})),xe(this,Zl,sp.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Ht).onOnline())})))}unmount(){var t,e;th(this,Vi)._--,M(this,Vi)===0&&((t=M(this,Jl))==null||t.call(this),xe(this,Jl,void 0),(e=M(this,Zl))==null||e.call(this),xe(this,Zl,void 0))}isFetching(t){return M(this,Ht).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return M(this,Hi).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,Ht).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=M(this,Ht).build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ao(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return M(this,Ht).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),r=M(this,Ht).get(s.queryHash),i=r==null?void 0:r.state.data,o=mM(e,i);if(o!==void 0)return M(this,Ht).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return qt.batch(()=>M(this,Ht).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,Ht).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=M(this,Ht);qt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=M(this,Ht);return qt.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=qt.batch(()=>M(this,Ht).findAll(t).map(r=>r.cancel(n)));return Promise.all(s).then(En).catch(En)}invalidateQueries(t,e={}){return qt.batch(()=>(M(this,Ht).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=qt.batch(()=>M(this,Ht).findAll(t).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(En)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(En)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=M(this,Ht).build(this,e);return n.isStaleByTime(ao(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(En).catch(En)}fetchInfiniteQuery(t){return t.behavior=Xw(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(En).catch(En)}ensureInfiniteQueryData(t){return t.behavior=Xw(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return sp.isOnline()?M(this,Hi).resumePausedMutations():Promise.resolve()}getQueryCache(){return M(this,Ht)}getMutationCache(){return M(this,Hi)}getDefaultOptions(){return M(this,Wi)}setDefaultOptions(t){xe(this,Wi,t)}setQueryDefaults(t,e){M(this,Ql).set(Sa(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...M(this,Ql).values()],n={};return e.forEach(s=>{Fu(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){M(this,Xl).set(Sa(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...M(this,Xl).values()],n={};return e.forEach(s=>{Fu(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...M(this,Wi).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Qv(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Jv&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...M(this,Wi).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){M(this,Ht).clear(),M(this,Hi).clear()}},Ht=new WeakMap,Hi=new WeakMap,Wi=new WeakMap,Ql=new WeakMap,Xl=new WeakMap,Vi=new WeakMap,Jl=new WeakMap,Zl=new WeakMap,h1),GC=v.createContext(void 0),Gs=t=>{const e=v.useContext(GC);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},DM=({client:t,children:e})=>(v.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),c.jsx(GC.Provider,{value:t,children:e})),YC=v.createContext(!1),QC=()=>v.useContext(YC);YC.Provider;function LM(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var $M=v.createContext(LM()),XC=()=>v.useContext($M),JC=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},ZC=t=>{v.useEffect(()=>{t.clearReset()},[t])},eN=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:r})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(r&&t.data===void 0||BC(n,[t.error,s])),tN=t=>{if(t.suspense){const n=r=>r==="static"?r:Math.max(r??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...r)=>n(s(...r)):n(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},nN=(t,e)=>t.isLoading&&t.isFetching&&!e,ly=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,rp=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function FM({queries:t,...e},n){const s=Gs(),r=QC(),i=XC(),o=v.useMemo(()=>t.map(x=>{const y=s.defaultQueryOptions(x);return y._optimisticResults=r?"isRestoring":"optimistic",y}),[t,s,r]);o.forEach(x=>{tN(x),JC(x,i)}),ZC(i);const[a]=v.useState(()=>new OM(s,o,e)),[l,u,d]=a.getOptimisticResult(o,e.combine),h=!r&&e.subscribed!==!1;v.useSyncExternalStore(v.useCallback(x=>h?a.subscribe(qt.batchCalls(x)):En,[a,h]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),v.useEffect(()=>{a.setQueries(o,e)},[o,e,a]);const p=l.some((x,y)=>ly(o[y],x))?l.flatMap((x,y)=>{const g=o[y];if(g){const m=new e0(s,g);if(ly(g,x))return rp(g,m,i);nN(x,r)&&rp(g,m,i)}return[]}):[];if(p.length>0)throw Promise.all(p);const w=l.find((x,y)=>{const g=o[y];return g&&eN({result:x,errorResetBoundary:i,throwOnError:g.throwOnError,query:s.getQueryCache().get(g.queryHash),suspense:g.suspense})});if(w!=null&&w.error)throw w.error;return u(d())}function zM(t,e,n){var h,f,p,w,x;const s=QC(),r=XC(),i=Gs(),o=i.defaultQueryOptions(t);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,o),o._optimisticResults=s?"isRestoring":"optimistic",tN(o),JC(o,r),ZC(r);const a=!i.getQueryCache().get(o.queryHash),[l]=v.useState(()=>new e(i,o)),u=l.getOptimisticResult(o),d=!s&&t.subscribed!==!1;if(v.useSyncExternalStore(v.useCallback(y=>{const g=d?l.subscribe(qt.batchCalls(y)):En;return l.updateResult(),g},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),v.useEffect(()=>{l.setOptions(o)},[o,l]),ly(o,u))throw rp(o,l,r);if(eN({result:u,errorResetBoundary:r,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((w=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||w.call(p,o,u),o.experimental_prefetchInRender&&!_a&&nN(u,s)){const y=a?rp(o,l,r):(x=i.getQueryCache().get(o.queryHash))==null?void 0:x.promise;y==null||y.catch(En).finally(()=>{l.updateResult()})}return o.notifyOnChangeProps?u:l.trackResult(u)}function Kt(t,e){return zM(t,e0)}function sN(t,e){const n=Gs(),[s]=v.useState(()=>new RM(n,t));v.useEffect(()=>{s.setOptions(t)},[s,t]);const r=v.useSyncExternalStore(v.useCallback(o=>s.subscribe(qt.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((o,a)=>{s.mutate(o,a).catch(En)},[s]);if(r.error&&BC(s.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rN=(...t)=>t.filter((e,n,s)=>!!e&&s.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var UM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=v.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...a},l)=>v.createElement("svg",{ref:l,...UM,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:rN("lucide",r),...a},[...o.map(([u,d])=>v.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=(t,e)=>{const n=v.forwardRef(({className:s,...r},i)=>v.createElement(HM,{ref:i,iconNode:e,className:rN(`lucide-${BM(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=it("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=it("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=it("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=it("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=it("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=it("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=it("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=it("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=it("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=it("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=it("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=it("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=it("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=it("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YM=it("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=it("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=it("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=it("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=it("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=it("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aN=it("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=it("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=it("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lN=it("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=it("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=it("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=it("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=it("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=it("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=it("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=it("UserRoundX",[["path",{d:"M2 21a8 8 0 0 1 11.873-7",key:"74fkxq"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m17 17 5 5",key:"p7ous7"}],["path",{d:"m22 17-5 5",key:"gqnmv0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=it("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=it("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ek(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Oa(...t){return e=>{let n=!1;const s=t.map(r=>{const i=ek(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():ek(t[r],null)}}}}function us(...t){return v.useCallback(Oa(...t),t)}var iI=Symbol.for("react.lazy"),ip=Ap[" use ".trim().toString()];function oI(t){return typeof t=="object"&&t!==null&&"then"in t}function uN(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===iI&&"_payload"in t&&oI(t._payload)}function aI(t){const e=cI(t),n=v.forwardRef((s,r)=>{let{children:i,...o}=s;uN(i)&&typeof ip=="function"&&(i=ip(i._payload));const a=v.Children.toArray(i),l=a.find(dI);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}var lI=aI("Slot");function cI(t){const e=v.forwardRef((n,s)=>{let{children:r,...i}=n;if(uN(r)&&typeof ip=="function"&&(r=ip(r._payload)),v.isValidElement(r)){const o=fI(r),a=hI(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Oa(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var uI=Symbol("radix.slottable");function dI(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===uI}function hI(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function fI(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function dN(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=dN(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function hN(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=dN(t))&&(s&&(s+=" "),s+=e);return s}const tk=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,nk=hN,pI=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return nk(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=tk(d)||tk(h);return r[u][f]}),a=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(w=>{let[x,y]=w;return Array.isArray(y)?y.includes({...i,...a}[x]):{...i,...a}[x]===y})?[...u,h,f]:u},[]);return nk(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},r0="-",mI=t=>{const e=xI(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const a=o.split(r0);return a[0]===""&&a.length!==1&&a.shift(),fN(a,e)||gI(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&s[o]?[...l,...s[o]]:l}}},fN=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?fN(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const i=t.join(r0);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},sk=/^\[(.+)\]$/,gI=t=>{if(sk.test(t)){const e=sk.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},xI=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return vI(Object.entries(t.classGroups),n).forEach(([i,o])=>{cy(o,s,i,e)}),s},cy=(t,e,n,s)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?e:rk(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(yI(r)){cy(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([i,o])=>{cy(o,rk(e,i),n,s)})})},rk=(t,e)=>{let n=t;return e.split(r0).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},yI=t=>t.isThemeGetter,vI=(t,e)=>e?t.map(([n,s])=>{const r=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,r]}):t,bI=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const r=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return r(i,o),o},set(i,o){n.has(i)?n.set(i,o):r(i,o)}}},pN="!",wI=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,r=e[0],i=e.length,o=a=>{const l=[];let u=0,d=0,h;for(let y=0;y<a.length;y++){let g=a[y];if(u===0){if(g===r&&(s||a.slice(y,y+i)===e)){l.push(a.slice(d,y)),d=y+i;continue}if(g==="/"){h=y;continue}}g==="["?u++:g==="]"&&u--}const f=l.length===0?a:a.substring(d),p=f.startsWith(pN),w=p?f.substring(1):f,x=h&&h>d?h-d:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:w,maybePostfixModifierPosition:x}};return n?a=>n({className:a,parseClassName:o}):o},kI=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},_I=t=>({cache:bI(t.cacheSize),parseClassName:wI(t),...mI(t)}),SI=/\s+/,jI=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,i=[],o=t.trim().split(SI);let a="";for(let l=o.length-1;l>=0;l-=1){const u=o[l],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=n(u);let w=!!p,x=s(w?f.substring(0,p):f);if(!x){if(!w){a=u+(a.length>0?" "+a:a);continue}if(x=s(f),!x){a=u+(a.length>0?" "+a:a);continue}w=!1}const y=kI(d).join(":"),g=h?y+pN:y,m=g+x;if(i.includes(m))continue;i.push(m);const b=r(x,w);for(let k=0;k<b.length;++k){const _=b[k];i.push(g+_)}a=u+(a.length>0?" "+a:a)}return a};function CI(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=mN(e))&&(s&&(s+=" "),s+=n);return s}const mN=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=mN(t[s]))&&(n&&(n+=" "),n+=e);return n};function NI(t,...e){let n,s,r,i=o;function o(l){const u=e.reduce((d,h)=>h(d),t());return n=_I(u),s=n.cache.get,r=n.cache.set,i=a,a(l)}function a(l){const u=s(l);if(u)return u;const d=jI(l,n);return r(l,d),d}return function(){return i(CI.apply(null,arguments))}}const Ct=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},gN=/^\[(?:([a-z-]+):)?(.+)\]$/i,EI=/^\d+\/\d+$/,TI=new Set(["px","full","screen"]),PI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,RI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,AI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,OI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,MI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Wr=t=>Tl(t)||TI.has(t)||EI.test(t),ji=t=>pc(t,"length",UI),Tl=t=>!!t&&!Number.isNaN(Number(t)),Jm=t=>pc(t,"number",Tl),Dc=t=>!!t&&Number.isInteger(Number(t)),II=t=>t.endsWith("%")&&Tl(t.slice(0,-1)),Ge=t=>gN.test(t),Ci=t=>PI.test(t),DI=new Set(["length","size","percentage"]),LI=t=>pc(t,DI,xN),$I=t=>pc(t,"position",xN),FI=new Set(["image","url"]),zI=t=>pc(t,FI,WI),BI=t=>pc(t,"",HI),Lc=()=>!0,pc=(t,e,n)=>{const s=gN.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},UI=t=>RI.test(t)&&!AI.test(t),xN=()=>!1,HI=t=>OI.test(t),WI=t=>MI.test(t),VI=()=>{const t=Ct("colors"),e=Ct("spacing"),n=Ct("blur"),s=Ct("brightness"),r=Ct("borderColor"),i=Ct("borderRadius"),o=Ct("borderSpacing"),a=Ct("borderWidth"),l=Ct("contrast"),u=Ct("grayscale"),d=Ct("hueRotate"),h=Ct("invert"),f=Ct("gap"),p=Ct("gradientColorStops"),w=Ct("gradientColorStopPositions"),x=Ct("inset"),y=Ct("margin"),g=Ct("opacity"),m=Ct("padding"),b=Ct("saturate"),k=Ct("scale"),_=Ct("sepia"),C=Ct("skew"),S=Ct("space"),j=Ct("translate"),E=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],L=()=>["auto",Ge,e],I=()=>[Ge,e],O=()=>["",Wr,ji],$=()=>["auto",Tl,Ge],D=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],F=()=>["solid","dashed","dotted","double","none"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],T=()=>["start","end","center","between","around","evenly","stretch"],R=()=>["","0",Ge],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],G=()=>[Tl,Ge];return{cacheSize:500,separator:":",theme:{colors:[Lc],spacing:[Wr,ji],blur:["none","",Ci,Ge],brightness:G(),borderColor:[t],borderRadius:["none","","full",Ci,Ge],borderSpacing:I(),borderWidth:O(),contrast:G(),grayscale:R(),hueRotate:G(),invert:R(),gap:I(),gradientColorStops:[t],gradientColorStopPositions:[II,ji],inset:L(),margin:L(),opacity:G(),padding:I(),saturate:G(),scale:G(),sepia:R(),skew:G(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Ge]}],container:["container"],columns:[{columns:[Ci]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...D(),Ge]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Dc,Ge]}],basis:[{basis:L()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ge]}],grow:[{grow:R()}],shrink:[{shrink:R()}],order:[{order:["first","last","none",Dc,Ge]}],"grid-cols":[{"grid-cols":[Lc]}],"col-start-end":[{col:["auto",{span:["full",Dc,Ge]},Ge]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[Lc]}],"row-start-end":[{row:["auto",{span:[Dc,Ge]},Ge]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ge]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ge]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...T()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...T(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...T(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[m]}],px:[{px:[m]}],py:[{py:[m]}],ps:[{ps:[m]}],pe:[{pe:[m]}],pt:[{pt:[m]}],pr:[{pr:[m]}],pb:[{pb:[m]}],pl:[{pl:[m]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ge,e]}],"min-w":[{"min-w":[Ge,e,"min","max","fit"]}],"max-w":[{"max-w":[Ge,e,"none","full","min","max","fit","prose",{screen:[Ci]},Ci]}],h:[{h:[Ge,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ge,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ge,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ge,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ci,ji]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Jm]}],"font-family":[{font:[Lc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ge]}],"line-clamp":[{"line-clamp":["none",Tl,Jm]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Wr,Ge]}],"list-image":[{"list-image":["none",Ge]}],"list-style-type":[{list:["none","disc","decimal",Ge]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...F(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Wr,ji]}],"underline-offset":[{"underline-offset":["auto",Wr,Ge]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ge]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ge]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...D(),$I]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",LI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},zI]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...F(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:F()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...F()]}],"outline-offset":[{"outline-offset":[Wr,Ge]}],"outline-w":[{outline:[Wr,ji]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Wr,ji]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ci,BI]}],"shadow-color":[{shadow:[Lc]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...K(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":K()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ci,Ge]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ge]}],duration:[{duration:G()}],ease:[{ease:["linear","in","out","in-out",Ge]}],delay:[{delay:G()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ge]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Dc,Ge]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ge]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ge]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ge]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Wr,ji,Jm]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},qI=NI(VI);function Pe(...t){return qI(hN(t))}function bn(t){return t.split(/\n|,/).map(e=>e.trim()).filter(Boolean)}function uy(t){if(!t)return{module:"",service:"",action:""};const[e,n,s]=t.split(":");return{module:(e==null?void 0:e.trim())||"",service:(n==null?void 0:n.trim())||"",action:(s==null?void 0:s.trim())||""}}function ik({module:t,service:e,action:n}){return!t||!e||!n?"":`${t}:${e}:${n}`}function Pl(t,e,n=`${e}s`){return t?`${t} ${t===1?e:n} selected`:`No ${n} selected`}function bf(t,e={}){return{...e,...t||{}}}const KI=pI("inline-flex items-center justify-center whitespace-nowrap rounded-xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black/10 dark:focus-visible:ring-white/15 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"mmg-btn-primary bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90 shadow-soft",secondary:"bg-black/5 text-black hover:bg-black/8 dark:bg-white/10 dark:text-white dark:hover:bg-white/15 shadow-soft",ghost:"bg-transparent hover:bg-black/5 text-black dark:text-white dark:hover:bg-white/10 shadow-soft"},size:{default:"h-10 px-4",sm:"h-9 px-3",lg:"h-11 px-5",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),se=ve.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...r},i)=>{const o=s?lI:"button";return c.jsx(o,{className:Pe(KI({variant:e,size:n,className:t})),ref:i,...r})});se.displayName="Button";function Ve({text:t="Loading",className:e=""}){return c.jsxs("span",{className:["inline-flex items-center gap-2",e].filter(Boolean).join(" "),children:[c.jsx("span",{children:t}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}var Mr=function(){return Mr=Object.assign||function(e){for(var n,s=1,r=arguments.length;s<r;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Mr.apply(this,arguments)};function mc(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function GI(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function l(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,l)}u((s=s.apply(t,e||[])).next())})}function YI(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}const QI=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class i0 extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class XI extends i0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ok extends i0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ak extends i0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var dy;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(dy||(dy={}));class JI{constructor(e,{headers:n={},customFetch:s,region:r=dy.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=QI(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return GI(this,arguments,void 0,function*(n,s={}){var r;let i,o;try{const{headers:a,method:l,body:u,signal:d,timeout:h}=s;let f={},{region:p}=s;p||(p=this.region);const w=new URL(`${this.url}/${n}`);p&&p!=="any"&&(f["x-region"]=p,w.searchParams.set("forceFunctionRegion",p));let x;u&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",x=u):typeof u=="string"?(f["Content-Type"]="text/plain",x=u):typeof FormData<"u"&&u instanceof FormData?x=u:(f["Content-Type"]="application/json",x=JSON.stringify(u)):x=u;let y=d;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),d?(y=o.signal,d.addEventListener("abort",()=>o.abort())):y=o.signal);const g=yield this.fetch(w.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:x,signal:y}).catch(_=>{throw new XI(_)}),m=g.headers.get("x-relay-error");if(m&&m==="true")throw new ok(g);if(!g.ok)throw new ak(g);let b=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return b==="application/json"?k=yield g.json():b==="application/octet-stream"||b==="application/pdf"?k=yield g.blob():b==="text/event-stream"?k=g:b==="multipart/form-data"?k=yield g.formData():k=yield g.text(),{data:k,error:null,response:g}}catch(a){return{data:null,error:a,response:a instanceof ak||a instanceof ok?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var ZI=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},eD=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,a=null,l=null,u=i.status,d=i.statusText;if(i.ok){var h,f;if(n.method!=="HEAD"){var p;const g=await i.text();g===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((p=n.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?a=g:a=JSON.parse(g))}const x=(h=n.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),y=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");x&&y&&y.length>1&&(l=parseInt(y[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,u=406,d="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var w;const x=await i.text();try{o=JSON.parse(x),Array.isArray(o)&&i.status===404&&(a=[],o=null,u=200,d="OK")}catch{i.status===404&&x===""?(u=204,d="No Content"):o={message:x}}if(o&&n.isMaybeSingle&&(!(o==null||(w=o.details)===null||w===void 0)&&w.includes("0 rows"))&&(o=null,u=200,d="OK"),o&&n.shouldThrowOnError)throw new ZI(o)}return{error:o,data:a,count:l,status:u,statusText:d}});return this.shouldThrowOnError||(r=r.catch(i=>{var o;let a="";const l=i==null?void 0:i.cause;if(l){var u,d,h,f;const w=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",x=(d=l==null?void 0:l.code)!==null&&d!==void 0?d:"";a=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,a+=`

Caused by: ${(f=l==null?void 0:l.name)!==null&&f!==void 0?f:"Error"}: ${w}`,x&&(a+=` (${x})`),l!=null&&l.stack&&(a+=`
${l.stack}`)}else{var p;a=(p=i==null?void 0:i.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},tD=class extends eD{select(t){let e=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:r=s}={}){const i=r?`${r}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:r=!1,format:i="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const lk=new RegExp("[,()]");var il=class extends tD{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&lk.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&lk.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${r}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},nD=class{constructor(t,{headers:e={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=s}select(t,e){const{head:n=!1,count:s}=e??{},r=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new il({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var s;const r="POST";if(e&&this.headers.append("Prefer",`count=${e}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,a)=>o.concat(Object.keys(a)),[]);if(i.length>0){const o=[...new Set(i)].map(a=>`"${a}"`);this.url.searchParams.set("columns",o.join(","))}}return new il({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new il({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var n;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new il({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new il({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},sD=class yN{constructor(e,{headers:n={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new nD(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new yN(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:r=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let u;s||r?(a=s?"HEAD":"GET",Object.entries(n).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{l.searchParams.append(h,f)})):(a="POST",u=n);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new il({method:a,url:l,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class rD{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const iD="2.88.0",oD=`realtime-js/${iD}`,vN="1.0.0",aD="2.0.0",ck=vN,hy=1e4,lD=1e3,cD=100;var Ri;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ri||(Ri={}));var on;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(on||(on={}));var ar;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ar||(ar={}));var fy;(function(t){t.websocket="websocket"})(fy||(fy={}));var Ko;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ko||(Ko={}));class uD{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,s){var r,i;const o=e.topic,a=(r=e.ref)!==null&&r!==void 0?r:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+u.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let w=new DataView(p),x=0;w.setUint8(x++,this.KINDS.userBroadcastPush),w.setUint8(x++,l.length),w.setUint8(x++,a.length),w.setUint8(x++,o.length),w.setUint8(x++,u.length),w.setUint8(x++,h.length),w.setUint8(x++,n),Array.from(l,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(a,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(o,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(u,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(h,g=>w.setUint8(x++,g.charCodeAt(0)));var y=new Uint8Array(p.byteLength+s.byteLength);return y.set(new Uint8Array(p),0),y.set(new Uint8Array(s),p.byteLength),y.buffer}decode(e,n){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return n(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,i,o,a,l]=s;return n({join_ref:r,ref:i,topic:o,event:a,payload:l})}return n({})}_binaryDecode(e){const n=new DataView(e),s=n.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,r)}}_decodeUserBroadcast(e,n,s){const r=n.getUint8(1),i=n.getUint8(2),o=n.getUint8(3),a=n.getUint8(4);let l=this.HEADER_LENGTH+4;const u=s.decode(e.slice(l,l+r));l=l+r;const d=s.decode(e.slice(l,l+i));l=l+i;const h=s.decode(e.slice(l,l+o));l=l+o;const f=e.slice(l,e.byteLength),p=a===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,w={type:this.BROADCAST_EVENT,event:d,payload:p};return o>0&&(w.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>n.includes(s)))}}class bN{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var kt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(kt||(kt={}));const uk=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=dD(o,t,e,r),i),{}):{}},dD=(t,e,n,s)=>{const r=e.find(a=>a.name===t),i=r==null?void 0:r.type,o=n[t];return i&&!s.includes(i)?wN(i,o):py(o)},wN=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return mD(e,n)}switch(t){case kt.bool:return hD(e);case kt.float4:case kt.float8:case kt.int2:case kt.int4:case kt.int8:case kt.numeric:case kt.oid:return fD(e);case kt.json:case kt.jsonb:return pD(e);case kt.timestamp:return gD(e);case kt.abstime:case kt.date:case kt.daterange:case kt.int4range:case kt.int8range:case kt.money:case kt.reltime:case kt.text:case kt.time:case kt.timestamptz:case kt.timetz:case kt.tsrange:case kt.tstzrange:return py(e);default:return py(e)}},py=t=>t,hD=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},fD=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},pD=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},mD=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>wN(e,a))}return t},gD=t=>typeof t=="string"?t.replace(" ","T"):t,kN=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Zm{constructor(e,n,s={},r=hy){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var dk;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(dk||(dk={}));class fu{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fu.syncState(this.state,r,i,o),this.pendingDiffs.forEach(l=>{this.state=fu.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=fu.syncDiff(this.state,r,i,o),a())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const i=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(i,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(y=>y.presence_ref),p=h.map(y=>y.presence_ref),w=d.filter(y=>p.indexOf(y.presence_ref)<0),x=h.filter(y=>f.indexOf(y.presence_ref)<0);w.length>0&&(a[u]=w),x.length>0&&(l[u]=x)}else a[u]=d}),this.syncDiff(i,{joins:a,leaves:l},s,r)}static syncDiff(e,n,s,r){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(a,l)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),d.length>0){const h=e[a].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...f)}s(a,d,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[a]=u,r(a,u,l),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hk;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(hk||(hk={}));var pu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(pu||(pu={}));var Qr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Qr||(Qr={}));class bl{constructor(e,n={config:{}},s){var r,i;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=on.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Zm(this,ar.join,this.params,this.timeout),this.rejoinTimer=new bN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=on.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=on.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=on.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=on.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=on.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ar.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new fu(this),this.broadcastEndpointURL=kN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==on.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,u=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&r!==void 0?r:[],d=!!this.bindings[pu.PRESENCE]&&this.bindings[pu.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Qr.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Qr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(Qr.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,y=(w=x==null?void 0:x.length)!==null&&w!==void 0?w:0,g=[];for(let m=0;m<y;m++){const b=x[m],{filter:{event:k,schema:_,table:C,filter:S}}=b,j=p&&p[m];if(j&&j.event===k&&bl.isFilterValueEqual(j.schema,_)&&bl.isFilterValueEqual(j.table,C)&&bl.isFilterValueEqual(j.filter,S))g.push(Object.assign(Object.assign({},b),{id:j.id}));else{this.unsubscribe(),this.state=on.errored,e==null||e(Qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Qr.SUBSCRIBED);return}}).receive("error",p=>{this.state=on.errored,e==null||e(Qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===on.joined&&e===pu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var r;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const u=await a.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=on.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ar.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new Zm(this,ar.leave,{},e),s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=on.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(i),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Zm(this,e,n,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>cD){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:d}=ar;if(s&&[a,l,u,d].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,n,s);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var w,x,y;return((w=p.filter)===null||w===void 0?void 0:w.event)==="*"||((y=(x=p.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var w,x,y,g,m,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const k=p.id,_=(w=p.filter)===null||w===void 0?void 0:w.event;return k&&((x=n.ids)===null||x===void 0?void 0:x.includes(k))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const k=(m=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return k==="*"||k===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const w=f.data,{schema:x,table:y,commit_timestamp:g,type:m,errors:b}=w;f=Object.assign(Object.assign({},{schema:x,table:y,commit_timestamp:g,eventType:m,new:{},old:{},errors:b}),this._getPayloadRecords(w))}p.callback(f,s)})}_isClosed(){return this.state===on.closed}_isJoined(){return this.state===on.joined}_isJoining(){return this.state===on.joining}_isLeaving(){return this.state===on.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),i={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&bl.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ar.close,{},e)}_onError(e){this._on(ar.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=on.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=uk(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=uk(e.columns,e.old_record)),n}}const eg=()=>{},_h={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xD=[1e3,2e3,5e3,1e4],yD=1e4,vD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bD{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=hy,this.transport=null,this.heartbeatIntervalMs=_h.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=eg,this.ref=0,this.reconnectTimer=null,this.vsn=ck,this.logger=eg,this.conn=null,this.sendBuffer=[],this.serializer=new uD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((s=n==null?void 0:n.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${fy.websocket}`,this.httpEndpoint=kN(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rD.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ri.connecting:return Ko.Connecting;case Ri.open:return Ko.Open;case Ri.closing:return Ko.Closing;default:return Ko.Closed}}isConnected(){return this.connectionState()===Ko.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new bl(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(lD,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},_h.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:i,ref:o}=n,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${r} ${a}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(r,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ri.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ri.open||this.conn.readyState===Ri.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ar.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([vD],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,s=!1;if(e)n=e,s=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),n=this.accessTokenValue}else n=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:oD};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(ar.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new bN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_h.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,r,i,o,a,l,u,d,h,f,p;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:hy,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:_h.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:eg,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:ck,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:w=>xD[w-1]||yD,this.vsn){case vN:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(w,x)=>x(JSON.stringify(w)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(w,x)=>x(JSON.parse(w));break;case aD:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Bu=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function wD(t,e,n){const s=new URL(e,t);if(n)for(const[r,i]of Object.entries(n))i!==void 0&&s.searchParams.set(r,i);return s.toString()}async function kD(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function _D(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:s,query:r,body:i,headers:o}){const a=wD(t.baseUrl,s,r),l=await kD(t.auth),u=await e(a,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const p=h?f:void 0,w=p==null?void 0:p.error;throw new Bu((w==null?void 0:w.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function Sh(t){return t.join("")}var SD=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Sh(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Sh(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Sh(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Sh(t.namespace)}`}),!0}catch(e){if(e instanceof Bu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Bu&&n.status===409)return;throw n}}};function qa(t){return t.join("")}var jD=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${qa(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${qa(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${qa(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${qa(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${qa(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${qa(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Bu&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Bu&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},CD=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=_D({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new SD(this.client,e),this.tableOps=new jD(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Yp=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function $t(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var ND=class extends Yp{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},my=class extends Yp{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const o0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ED=()=>Response,gy=t=>{if(Array.isArray(t))return t.map(n=>gy(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=gy(s)}),e},TD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},PD=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Uu(t){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uu(t)}function RD(t,e){if(Uu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Uu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AD(t){var e=RD(t,"string");return Uu(e)=="symbol"?e:e+""}function OD(t,e,n){return(e=AD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Be(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?fk(Object(n),!0).forEach(function(s){OD(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fk(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const tg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},MD=async(t,e,n)=>{t instanceof await ED()&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const r=t.status||500,i=(s==null?void 0:s.statusCode)||r+"";e(new ND(tg(s),r,i))}).catch(s=>{e(new my(tg(s),s))}):e(new my(tg(t),t))},ID=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?r:(TD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),Be(Be({},r),n))};async function Pd(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,ID(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>MD(l,a,s))})}async function Hu(t,e,n,s){return Pd(t,"GET",e,n,s)}async function sr(t,e,n,s,r){return Pd(t,"POST",e,s,r,n)}async function xy(t,e,n,s,r){return Pd(t,"PUT",e,s,r,n)}async function DD(t,e,n,s){return Pd(t,"HEAD",e,Be(Be({},n),{},{noResolveJson:!0}),s)}async function a0(t,e,n,s,r){return Pd(t,"DELETE",e,s,r,n)}var LD=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if($t(e))return{data:null,error:e};throw e}}};let _N;_N=Symbol.toStringTag;var $D=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[_N]="BlobDownloadBuilder",this.promise=null}asStream(){return new LD(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if($t(e))return{data:null,error:e};throw e}}};const FD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},pk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var zD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=o0(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,s){var r=this;try{let i;const o=Be(Be({},pk),s);let a=Be(Be({},r.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",r.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",r.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=r.toBase64(r.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(a=Be(Be({},a),s.headers));const u=r._removeEmptyFolders(e),d=r._getFinalPath(u),h=await(t=="PUT"?xy:sr)(r.fetch,`${r.url}/object/${d}`,i,Be({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(r.shouldThrowOnError)throw i;if($t(i))return{data:null,error:i};throw i}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,s){var r=this;const i=r._removeEmptyFolders(t),o=r._getFinalPath(i),a=new URL(r.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l;const u=Be({upsert:pk.upsert},s),d=Be(Be({},r.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await xy(r.fetch,a.toString(),l,{headers:d})).Key},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if($t(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var n=this;try{let s=n._getFinalPath(t);const r=Be({},n.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const i=await sr(n.fetch,`${n.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(n.url+i.url),a=o.searchParams.get("token");if(!a)throw new Yp("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var s=this;try{return{data:await sr(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers}),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async copy(t,e,n){var s=this;try{return{data:{path:(await sr(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers})).Key},error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async createSignedUrl(t,e,n){var s=this;try{let r=s._getFinalPath(t),i=await sr(s.fetch,`${s.url}/object/sign/${r}`,Be({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:s.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async createSignedUrls(t,e,n){var s=this;try{const r=await sr(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:r.map(o=>Be(Be({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),r=s?`?${s}`:"",i=this._getFinalPath(t),o=()=>Hu(this.fetch,`${this.url}/${n}/${i}${r}`,{headers:this.headers,noResolveJson:!0});return new $D(o,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:gy(await Hu(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await DD(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if($t(s)&&s instanceof my){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&s.push(o);let a=s.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${a}`)}}}async remove(t){var e=this;try{return{data:await a0(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async list(t,e,n){var s=this;try{const r=Be(Be(Be({},FD),e),{},{prefix:t||""});return{data:await sr(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},n),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}}async listV2(t,e){var n=this;try{const s=Be({},t);return{data:await sr(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,s,{headers:n.headers},e),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const SN="2.88.0",jN={"X-Client-Info":`storage-js/${SN}`};var BD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1;const r=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Be(Be({},jN),e),this.fetch=o0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await Hu(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await Hu(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await sr(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var n=this;try{return{data:await xy(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await sr(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await a0(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},UD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},jN),e),this.fetch=o0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await sr(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const s=n.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Hu(e.fetch,r,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await a0(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!PD(t))throw new Yp("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new CD({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(n,{get(r,i){const o=r[i];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(r,a),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const l0={"X-Client-Info":`storage-js/${SN}`,"Content-Type":"application/json"};var CN=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function ws(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var ng=class extends CN{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},HD=class extends CN{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const c0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),WD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},mk=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),VD=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const s=t.status||500,r=t;if(typeof r.json=="function")r.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new ng(mk(i),s,o))}).catch(()=>{const i=s+"";e(new ng(r.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new ng(r.statusText||`HTTP ${s} error`,s,i))}}else e(new HD(mk(t),t))},qD=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(WD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,Be(Be({},r),n)):r};async function KD(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,qD(e,s,r,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>VD(l,a,s))})}async function ks(t,e,n,s,r){return KD(t,"POST",e,s,r,n)}var GD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},l0),e),this.fetch=c0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await ks(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await ks(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ws(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await ks(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await ks(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ws(s))return{data:null,error:s};throw s}}},YD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},l0),e),this.fetch=c0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ks(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await ks(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await ks(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await ks(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ks(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}},QD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},l0),e),this.fetch=c0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await ks(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await ks(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await ks(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await ks(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}}},XD=class extends QD{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new JD(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},JD=class extends GD{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new ZD(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},ZD=class extends YD{constructor(t,e,n,s,r){super(t,e,r),this.vectorBucketName=n,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},eL=class extends BD{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new zD(this.url,this.headers,t,this.fetch)}get vectors(){return new XD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new UD(this.url+"/iceberg",this.headers,this.fetch)}};const NN="2.88.0",ol=30*1e3,yy=3,sg=yy*ol,tL="http://localhost:9999",nL="supabase.auth.token",sL={"X-Client-Info":`gotrue-js/${NN}`},vy="X-Supabase-Api-Version",EN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rL=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,iL=10*60*1e3;class Wu extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Me(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class oL extends Wu{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function aL(t){return Me(t)&&t.name==="AuthApiError"}class Go extends Wu{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class vi extends Wu{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class gs extends vi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function lL(t){return Me(t)&&t.name==="AuthSessionMissingError"}class Ka extends vi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class jh extends vi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ch extends vi{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function cL(t){return Me(t)&&t.name==="AuthImplicitGrantRedirectError"}class gk extends vi{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class uL extends vi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class by extends vi{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function rg(t){return Me(t)&&t.name==="AuthRetryableFetchError"}class xk extends vi{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class wy extends vi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const op="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),yk=` 	
\r=`.split(""),dL=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<yk.length;e+=1)t[yk[e].charCodeAt(0)]=-2;for(let e=0;e<op.length;e+=1)t[op[e].charCodeAt(0)]=e;return t})();function vk(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(op[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(op[s]),e.queuedBits-=6}}function TN(t,e,n){const s=dL[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function bk(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=o=>{pL(o,s,n)};for(let o=0;o<t.length;o+=1)TN(t.charCodeAt(o),r,i);return e.join("")}function hL(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function fL(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}hL(s,e)}}function pL(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Rl(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)TN(t.charCodeAt(r),n,s);return new Uint8Array(e)}function mL(t){const e=[];return fL(t,n=>e.push(n)),new Uint8Array(e)}function Zo(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>vk(r,n,s)),vk(null,n,s),e.join("")}function gL(t){return Math.round(Date.now()/1e3)+t}function xL(){return Symbol("auth-callback")}const yn=()=>typeof window<"u"&&typeof document<"u",Lo={tested:!1,writable:!1},PN=()=>{if(!yn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Lo.tested)return Lo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Lo.tested=!0,Lo.writable=!0}catch{Lo.tested=!0,Lo.writable=!1}return Lo.writable};function yL(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const RN=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),vL=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",al=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},$o=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},xn=async(t,e)=>{await t.removeItem(e)};class Qp{constructor(){this.promise=new Qp.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Qp.promiseConstructor=Promise;function ig(t){const e=t.split(".");if(e.length!==3)throw new wy("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!rL.test(e[s]))throw new wy("JWT not in base64url format");return{header:JSON.parse(bk(e[0])),payload:JSON.parse(bk(e[1])),signature:Rl(e[2]),raw:{header:e[0],payload:e[1]}}}async function bL(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function wL(t,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function kL(t){return("0"+t.toString(16)).substr(-2)}function _L(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let i=0;i<56;i++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,kL).join("")}async function SL(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function jL(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await SL(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ga(t,e,n=!1){const s=_L();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await al(t,`${e}-code-verifier`,r);const i=await jL(s);return[i,s===i?"plain":"s256"]}const CL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function NL(t){const e=t.headers.get(vy);if(!e||!e.match(CL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function EL(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function TL(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const PL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ya(t){if(!PL.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function og(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function RL(t,e){return new Proxy(t,{get:(n,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,r)}})}function wk(t){return JSON.parse(JSON.stringify(t))}const Wo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),AL=[502,503,504];async function kk(t){var e;if(!vL(t))throw new by(Wo(t),0);if(AL.includes(t.status))throw new by(Wo(t),t.status);let n;try{n=await t.json()}catch(i){throw new Go(Wo(i),i)}let s;const r=NL(t);if(r&&r.getTime()>=EN["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new xk(Wo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new gs}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new xk(Wo(n),t.status,n.weak_password.reasons);throw new oL(Wo(n),t.status||500,s)}const OL=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function ze(t,e,n,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[vy]||(i[vy]=EN["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await ML(t,e,n+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function ML(t,e,n,s,r,i){const o=OL(e,s,r,i);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new by(Wo(l),0)}if(a.ok||await kk(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await kk(l)}}function tr(t){var e;let n=null;LL(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=gL(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function _k(t){const e=tr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Mi(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function IL(t){return{data:t,error:null}}function DL(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i}=t,o=mc(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Sk(t){return t}function LL(t){return t.access_token&&t.refresh_token&&t.expires_in}const ag=["global","local","others"];class $L{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=RN(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=ag[0]){if(ag.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ag.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Me(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Mi})}catch(s){if(Me(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=mc(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:DL,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Me(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Mi})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:Sk});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(w=>{const x=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(w.split(";")[1].split("=")[1]);u[`${y}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Me(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Ya(e);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Mi})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Ya(e);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Mi})}catch(s){if(Me(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){Ya(e);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Mi})}catch(s){if(Me(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ya(e.userId);try{const{data:n,error:s}=await ze(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Ya(e.userId),Ya(e.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:Sk});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(w=>{const x=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(w.split(";")[1].split("=")[1]);u[`${y}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Me(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Me(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}}function jk(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Qa={debug:!!(globalThis&&PN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class AN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class FL extends AN{}async function zL(t,e,n){Qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Qa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{Qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw Qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new FL(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Qa.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function BL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ON(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function UL(t){return parseInt(t,16)}function HL(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function WL(t){var e;const{chainId:n,domain:s,expirationTime:r,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=ON(t.address),w=d?`${d}://${s}`:s,x=t.statement?`${t.statement}
`:"",y=`${w} wants you to sign in with your Ethereum account:
${p}

${x}`;let g=`URI: ${h}
Version: ${f}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(r&&(g+=`
Expiration Time: ${r.toISOString()}`),a&&(g+=`
Not Before: ${a.toISOString()}`),l&&(g+=`
Request ID: ${l}`),u){let m=`
Resources:`;for(const b of u){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);m+=`
- ${b}`}g+=m}return`${y}
${g}`}class en extends Error{constructor({message:e,code:n,cause:s,name:r}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=r??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class ap extends en{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function VL({error:t,options:e}){var n,s,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new en({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new en({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new en({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new en({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new en({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new en({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new en({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new en({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(MN(o)){if(i.rp.id!==o)return new en({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new en({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new en({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new en({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new en({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function qL({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new en({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new en({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(MN(s)){if(n.rpId!==s)return new en({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new en({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new en({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new en({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class KL{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const GL=new KL;function YL(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,r=mc(t,["challenge","user","excludeCredentials"]),i=Rl(e).buffer,o=Object.assign(Object.assign({},n),{id:Rl(n.id).buffer}),a=Object.assign(Object.assign({},r),{challenge:i,user:o});if(s&&s.length>0){a.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const u=s[l];a.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:Rl(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function QL(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=mc(t,["challenge","allowCredentials"]),r=Rl(e).buffer,i=Object.assign(Object.assign({},s),{challenge:r});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const a=n[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:Rl(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function XL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Zo(new Uint8Array(t.response.attestationObject)),clientDataJSON:Zo(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function JL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Zo(new Uint8Array(r.authenticatorData)),clientDataJSON:Zo(new Uint8Array(r.clientDataJSON)),signature:Zo(new Uint8Array(r.signature)),userHandle:r.userHandle?Zo(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function MN(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Ck(){var t,e;return!!(yn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function ZL(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ap("Browser returned unexpected credential type",e)}:{data:null,error:new ap("Empty credential response",e)}}catch(e){return{data:null,error:VL({error:e,options:t})}}}async function e5(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ap("Browser returned unexpected credential type",e)}:{data:null,error:new ap("Empty credential response",e)}}catch(e){return{data:null,error:qL({error:e,options:t})}}}const t5={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},n5={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function lp(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const i in r){const o=r[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(n(o))s[i]=o;else if(e(o)){const a=s[i];e(a)?s[i]=lp(a,o):s[i]=lp(o)}else s[i]=o}return s}function s5(t,e){return lp(t5,t,e||{})}function r5(t,e){return lp(n5,t,e||{})}class i5{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:r},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!o)return{data:null,error:a};const l=r??GL.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=s5(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:h}=await ZL({publicKey:u,signal:l});return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=r5(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:h}=await e5(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(o){return Me(o)?{data:null,error:o}:{data:null,error:new Go("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Wu("rpId is required for WebAuthn authentication")};try{if(!Ck())return{data:null,error:new Go("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:r},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:s,credential_response:l.credential_response}})}catch(o){return Me(o)?{data:null,error:o}:{data:null,error:new Go("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new Wu("rpId is required for WebAuthn registration")};try{if(!Ck())return{data:null,error:new Go("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:a};const{data:l,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:r},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Me(o)?{data:null,error:o}:{data:null,error:new Go("Unexpected error in register",o)}}}}BL();const o5={url:tL,storageKey:nL,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:sL,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Nk(t,e,n){return await n()}const Xa={};class Vu{get jwks(){var e,n;return(n=(e=Xa[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Xa[this.storageKey]=Object.assign(Object.assign({},Xa[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Xa[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Xa[this.storageKey]=Object.assign(Object.assign({},Xa[this.storageKey]),{cachedAt:e})}constructor(e){var n,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},o5),e);if(this.storageKey=i.storageKey,this.instanceID=(n=Vu.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Vu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&yn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new $L({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=RN(i.fetch),this.lock=i.lock||Nk,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&yn()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=zL:this.lock=Nk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new i5(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:PN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=jk(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=jk(this.memoryStorage)),yn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${NN}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(yn()&&(n=yL(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),yn()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(n,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),cL(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Me(n)?this._returnResult({error:n}):this._returnResult({error:new Go("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:tr}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(Me(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,s,r;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,w=null;this.flowType==="pkce"&&([p,w]=await Ga(this.storage,this.storageKey)),i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:w},xform:tr})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:tr})}else throw new jh("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return await xn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(await xn(this.storage,`${this.storageKey}-code-verifier`),Me(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_k})}else if("phone"in e){const{phone:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_k})}else throw new jh("You must provide either an email or phone number and a password");const{data:s,error:r}=n;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const i=new Ka;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,r,i,o,a,l,u,d,h,f;let p,w;if("message"in e)p=e.message,w=e.signature;else{const{chain:x,wallet:y,statement:g,options:m}=e;let b;if(yn())if(typeof y=="object")b=y;else{const E=window;if("ethereum"in E&&typeof E.ethereum=="object"&&"request"in E.ethereum&&typeof E.ethereum.request=="function")b=E.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const k=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href),_=await b.request({method:"eth_requestAccounts"}).then(E=>E).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=ON(_[0]);let S=(s=m==null?void 0:m.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!S){const E=await b.request({method:"eth_chainId"});S=UL(E)}const j={domain:k.host,address:C,statement:g,uri:k.href,version:"1",chainId:S,nonce:(r=m==null?void 0:m.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(i=m==null?void 0:m.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=m==null?void 0:m.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=m==null?void 0:m.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=m==null?void 0:m.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=m==null?void 0:m.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=WL(j),w=await b.request({method:"personal_sign",params:[HL(p),C]})}try{const{data:x,error:y}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:w},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:tr});if(y)throw y;if(!x||!x.session||!x.user){const g=new Ka;return this._returnResult({data:{user:null,session:null},error:g})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:y})}catch(x){if(Me(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(e){var n,s,r,i,o,a,l,u,d,h,f,p;let w,x;if("message"in e)w=e.message,x=e.signature;else{const{chain:y,wallet:g,statement:m,options:b}=e;let k;if(yn())if(typeof g=="object")k=g;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))k=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const _=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in k&&k.signIn){const C=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),m?{statement:m}:null));let S;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")S=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)S=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)w=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),x=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${_.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(r=(s=b==null?void 0:b.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((u=b==null?void 0:b.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(d=b==null?void 0:b.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const C=await k.signMessage(new TextEncoder().encode(w),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=C}}try{const{data:y,error:g}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Zo(x)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:tr});if(g)throw g;if(!y||!y.session||!y.user){const m=new Ka;return this._returnResult({data:{user:null,session:null},error:m})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:g})}catch(y){if(Me(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const n=await $o(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{if(!s&&this.flowType==="pkce")throw new uL;const{data:i,error:o}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:tr});if(await xn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new Ka;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}catch(i){if(await xn(this.storage,`${this.storageKey}-code-verifier`),Me(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:i,nonce:o}=e,a=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:tr}),{data:l,error:u}=a;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Ka;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,r,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Ga(this.storage,this.storageKey));const{error:h}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:d}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new jh("You must provide either an email or phone number.")}catch(a){if(await xn(this.storage,`${this.storageKey}-code-verifier`),Me(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,s;try{let r,i;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:tr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(r){if(Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var n,s,r,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await Ga(this.storage,this.storageKey));const u=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:IL});return!((i=u.data)===null||i===void 0)&&i.url&&yn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(a){if(await xn(this.storage,`${this.storageKey}-code-verifier`),Me(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new gs;const{error:r}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(Me(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:a}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new jh("You must provide either an email or phone number and a type")}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await $o(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<sg:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await $o(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=og()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=RL(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Mi}):await this._useSession(async n=>{var s,r,i;const{data:o,error:a}=n;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gs}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:Mi})})}catch(n){if(Me(n))return lL(n)&&(await this._removeSession(),await xn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new gs;const o=r.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ga(this.storage,this.storageKey));const{data:u,error:d}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Mi});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await xn(this.storage,`${this.storageKey}-code-verifier`),Me(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new gs;const n=Date.now()/1e3;let s=n,r=!0,i=null;const{payload:o}=ig(e.access_token);if(o.exp&&(s=o.exp,r=s<=n),r){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(Me(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new gs;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Me(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!yn())throw new Ch("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ch(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new gk("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ch("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new gk("No code detected.");const{data:m,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new Ch("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(a);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=ol&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const w=f-h;d-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,f,d):d-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,f,d);const{data:x,error:y}=await this._getUser(i);if(y)throw y;const g={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(s){if(Me(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await $o(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({error:i});const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(aL(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await xn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=xL(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:i},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Ga(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await xn(this.storage,`${this.storageKey}-code-verifier`),Me(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:r}=await this._useSession(async i=>{var o,a,l,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(r)throw r;return yn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Me(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:r,data:{session:i}}=n;if(r)throw r;const{options:o,provider:a,token:l,access_token:u,nonce:d}=e,h=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:a,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:tr}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Ka}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(r){if(await xn(this.storage,`${this.storageKey}-code-verifier`),Me(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)throw o;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await wL(async r=>(r>0&&await bL(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:tr})),(r,i)=>{const o=200*Math.pow(2,r);return i&&rg(i)&&Date.now()+o-s<ol})}catch(s){if(this._debug(n,"error",s),Me(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),yn()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await $o(this.storage,this.storageKey);if(r&&this.userStorage){let o=await $o(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await al(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:og()}else if(r&&!r.user&&!r.user){const o=await $o(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(r.user=o.user,await xn(this.storage,this.storageKey+"-user"),await al(this.storage,this.storageKey,r)):r.user=og()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const i=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<sg;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${sg}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),rg(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(r.access_token);!a&&(o!=null&&o.user)?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new gs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Qp;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new gs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(r,"error",i),Me(i)){const o={data:null,error:i};return rg(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await xn(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await al(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const i=wk(r);await al(this.storage,this.storageKey,i)}else{const r=wk(n);await al(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await xn(this.storage,this.storageKey),await xn(this.storage,this.storageKey+"-code-verifier"),await xn(this.storage,this.storageKey+"-user"),this.userStorage&&await xn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&yn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ol);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/ol);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${ol}ms, refresh threshold is ${yy} ticks`),r<=yy&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof AN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!yn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ga(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(a.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;return i?this._returnResult({data:null,error:i}):await ze(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&l.type==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?XL(e.webauthn.credential_response):JL(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:YL(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:QL(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=ig(s.access_token);let o=null;i.aal&&(o=i.aal);let a=o;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(a="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new gs})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new gs});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&yn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Me(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new gs});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&yn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Me(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;return s?this._returnResult({data:null,error:s}):n?await ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new gs})})}catch(e){if(Me(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?(await ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new gs})})}catch(n){if(Me(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(a=>a.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+iL>r)return s;const{data:i,error:o}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:p,error:w}=await this.getSession();if(w||!p.session)return this._returnResult({data:null,error:w});s=p.session.access_token}const{header:r,payload:i,signature:o,raw:{header:a,payload:l}}=ig(s);n!=null&&n.allowExpired||EL(i.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:r,signature:o},error:null}}const d=TL(r.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,mL(`${a}.${l}`)))throw new wy("Invalid JWT signature");return{data:{claims:i,header:r,signature:o},error:null}}catch(s){if(Me(s))return this._returnResult({data:null,error:s});throw s}}}Vu.nextInstanceID={};const a5=Vu,l5="2.88.0";let Xc="";typeof Deno<"u"?Xc="deno":typeof document<"u"?Xc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xc="react-native":Xc="node";const c5={"X-Client-Info":`supabase-js-${Xc}/${l5}`},u5={headers:c5},d5={schema:"public"},h5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},f5={};function qu(t){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qu(t)}function p5(t,e){if(qu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(qu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m5(t){var e=p5(t,"string");return qu(e)=="symbol"?e:e+""}function g5(t,e,n){return(e=m5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ek(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Wt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ek(Object(n),!0).forEach(function(s){g5(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ek(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const x5=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),y5=()=>Headers,v5=(t,e,n)=>{const s=x5(n),r=y5();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:t;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(i,Wt(Wt({},o),{},{headers:u}))}};function b5(t){return t.endsWith("/")?t:t+"/"}function w5(t,e){var n,s;const{db:r,auth:i,realtime:o,global:a}=t,{db:l,auth:u,realtime:d,global:h}=e,f={db:Wt(Wt({},l),r),auth:Wt(Wt({},u),i),realtime:Wt(Wt({},d),o),storage:{},global:Wt(Wt(Wt({},h),a),{},{headers:Wt(Wt({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(s=a==null?void 0:a.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function k5(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(b5(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var _5=class extends a5{constructor(t){super(t)}},S5=class{constructor(t,e,n){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const i=k5(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a={db:d5,realtime:f5,auth:Wt(Wt({},h5),{},{storageKey:o}),global:u5},l=w5(n??{},a);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=l.global.headers)!==null&&r!==void 0?r:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=v5(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Wt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new sD(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new eL(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new JI(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new _5({url:this.authUrl.href,headers:Wt(Wt({},f),d),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,flowType:o,lock:a,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new bD(this.realtimeUrl.href,Wt(Wt({},t),{},{params:Wt(Wt({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const j5=(t,e,n)=>new S5(t,e,n);function C5(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}C5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ma={SUPABASE_URL:window.SUPABASE_URL||void 0||"",SUPABASE_ANON_KEY:window.SUPABASE_ANON_KEY||void 0||"",API_BASE_URL:window.API_BASE_URL||void 0||""};let Nh=null;function u0(){if(Nh)return Nh;const{SUPABASE_URL:t,SUPABASE_ANON_KEY:e}=Ma;return!t||!e?null:(Nh=j5(t,e),Nh)}const d0="authToken";function gc(){return localStorage.getItem(d0)}function wl(t){t&&localStorage.setItem(d0,t)}function li(){localStorage.removeItem(d0)}const Ku=3e4;let lg=!1,Eh=null;function IN(t=Ku){const e=new AbortController,n=setTimeout(()=>e.abort(),t);return{controller:e,clear:()=>clearTimeout(n)}}async function DN(){var r;const t=gc();if(t)return t;const e=u0();if(!e)return null;const{data:n}=await e.auth.getSession(),s=((r=n==null?void 0:n.session)==null?void 0:r.access_token)||null;return s&&wl(s),s}async function LN(){return lg||(lg=!0,Eh=(async()=>{var t;try{const e=u0();if(!e)return null;const{data:n,error:s}=await e.auth.refreshSession();return s||!((t=n.session)!=null&&t.access_token)?null:(wl(n.session.access_token),n.session.access_token)}catch(e){return console.error("Token refresh failed:",e),null}finally{lg=!1,Eh=null}})()),Eh}async function De(t,e={}){const{baseUrl:n,timeout:s,...r}=e,i=`${n??Ma.API_BASE_URL}${t}`,o=new Headers(r.headers||{});!(r.body instanceof FormData)&&!o.has("Content-Type")&&o.set("Content-Type","application/json");const l=await DN();l&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${l}`);const u=s!==0&&s!==!1,{controller:d,clear:h}=u?IN(s||Ku):{controller:null,clear:()=>{}};try{let f=await fetch(i,{...r,headers:o,signal:d==null?void 0:d.signal});if(f.status===401){const w=await LN();if(w){if(o.set("Authorization",`Bearer ${w}`),f=await fetch(i,{...r,headers:o,signal:d==null?void 0:d.signal}),!(f.ok||f.status!==401))return li(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return li(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!f.ok){const w=await f.json().catch(()=>({detail:"Request failed"})),x=new Error(w.detail||w.error||`Request failed: ${f.status}`);throw x.status=f.status,x.data=w,x}return f.status===204?null:(f.headers.get("content-type")||"").includes("application/json")?f.json():f}catch(f){if(f.name==="AbortError"){const p=new Error(`Request timed out after ${s||Ku}ms`);throw p.status=408,p.isTimeout=!0,p}throw f}finally{h()}}async function $N(t,e={}){const{baseUrl:n,timeout:s,...r}=e,i=`${n??Ma.API_BASE_URL}${t}`,o=new Headers(r.headers||{}),a=await DN();a&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${a}`);const l=s!==0&&s!==!1,{controller:u,clear:d}=l?IN(s||Ku):{controller:null,clear:()=>{}};try{let h=await fetch(i,{...r,headers:o,signal:u==null?void 0:u.signal});if(h.status===401){const f=await LN();if(f){if(o.set("Authorization",`Bearer ${f}`),h=await fetch(i,{...r,headers:o,signal:u==null?void 0:u.signal}),!(h.ok||h.status!==401))return li(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return li(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!h.ok){const f=await h.json().catch(()=>({detail:"Request failed"})),p=new Error(f.detail||f.error||`Request failed: ${h.status}`);throw p.status=h.status,p.data=f,p}return h.blob()}catch(h){if(h.name==="AbortError"){const f=new Error(`Request timed out after ${s||Ku}ms`);throw f.status=408,f.isTimeout=!0,f}throw h}finally{d()}}const FN=v.createContext(null),cg={system_admin:["admin","hos","sales_person"],sales_manager:["hos","sales_person"],sales_user:["sales_person"],coordinator:["coordinator"],finance:["finance"],viewer:["viewer"]},N5={"admin@mmg.com":{password:"admin123",id:"dev-admin-1",name:"Sales Admin",email:"admin@mmg.com",roles:["admin","hos","sales_person"]},"hos@mmg.com":{password:"hos123",id:"dev-hos-1",name:"Head of Sales",email:"hos@mmg.com",roles:["hos","sales_person"]},"sales@mmg.com":{password:"sales123",id:"dev-sales-1",name:"Sales Person",email:"sales@mmg.com",roles:["sales_person"]}};function ug(t){return Array.from(new Set((t||[]).filter(Boolean).map(e=>String(e).toLowerCase())))}function Tk(t=[]){return t.map(e=>String(e||"").replaceAll(".",":"))}function E5(t){return(t||"sales_user").toLowerCase()}function Pk(t,e){var n,s,r,i,o,a,l,u,d;return((n=t==null?void 0:t.user_metadata)==null?void 0:n.full_name)||((s=t==null?void 0:t.user_metadata)==null?void 0:s.name)||((o=(i=(r=t==null?void 0:t.identities)==null?void 0:r[0])==null?void 0:i.identity_data)==null?void 0:o.full_name)||((u=(l=(a=t==null?void 0:t.identities)==null?void 0:a[0])==null?void 0:l.identity_data)==null?void 0:u.name)||((d=t==null?void 0:t.email)==null?void 0:d.split("@")[0])||e||"User"}function wf(t,e){const n=(t==null?void 0:t.permissions)||[];if(!n.length)return!1;const s=u=>String(u||"").trim().replaceAll(".",":"),r=n.map(s),i=s(e);if(r.includes("*:*:*"))return!0;const[o,a,l]=i.split(":");return r.some(u=>{const[d,h,f]=u.split(":");return u===i?!0:(d==="*"||d===o)&&(h==="*"||h===a)&&(f==="*"||f===l||f==="manage")})}function Rd(t){var e,n,s;return((e=t==null?void 0:t.roles)==null?void 0:e.includes("admin"))||((s=(n=t==null?void 0:t.profile)==null?void 0:n.toLowerCase)==null?void 0:s.call(n))==="system_admin"||wf(t,"*:*:*")||wf(t,"core:*:*")||wf(t,"core:system:admin")}function T5({children:t}){const e=u0(),n=!e&&window.location.hostname==="localhost",[s,r]=v.useState(null),[i,o]=v.useState(()=>{const m=localStorage.getItem("mmg_user")||localStorage.getItem("userData");return m?JSON.parse(m):null}),[a,l]=v.useState(!1),[u,d]=v.useState(null);v.useEffect(()=>{const m=window.location.hash;if(!m||!m.includes("error="))return;const b=new URLSearchParams(m.substring(1)),k=b.get("error"),_=b.get("error_code"),C=b.get("error_description");if(k){let S=C?decodeURIComponent(C.replace(/\+/g," ")):"Authentication failed";_==="otp_expired"?S="Email link has expired. Please sign up again to receive a new confirmation email.":_==="access_denied"&&(S="Access denied. The link may have expired or already been used."),setTimeout(()=>alert(S),300),window.history.replaceState(null,"",window.location.pathname+window.location.search)}},[]),v.useEffect(()=>{let m=null;async function b(){console.log("[Auth] init() starting");try{if(!e){console.log("[Auth] No supabase client - dev mode");const C=localStorage.getItem("mmg_user")||localStorage.getItem("userData");C&&o(JSON.parse(C)),l(!0),console.log("[Auth] Dev mode ready");return}console.log("[Auth] Getting supabase session...");const{data:k}=await e.auth.getSession(),_=(k==null?void 0:k.session)||null;console.log("[Auth] Session retrieved",{hasSession:!!_,hasToken:!!(_!=null&&_.access_token)}),r(_||null),l(!0),console.log("[Auth] authReady set to true"),_||(console.log("[Auth] No session - clearing auth"),li(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData")),_!=null&&_.access_token&&wl(_.access_token),_!=null&&_.access_token&&(console.log("[Auth] Starting background profile refresh"),h(_.access_token,_.user).catch(console.error)),m=e.auth.onAuthStateChange(async(C,S)=>{if(console.log("[Auth] onAuthStateChange",{event:C,hasSession:!!S}),C==="INITIAL_SESSION"){console.log("[Auth] Skipping INITIAL_SESSION (already handled)");return}r(S||null),S!=null&&S.access_token?(wl(S.access_token),u||(console.log("[Auth] Auth state change - refreshing profile"),h(S.access_token,S.user).catch(console.error))):(console.log("[Auth] Auth state change - no session, clearing"),li(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"))}).data.subscription}catch(k){console.log("[Auth] init() error",k),l(!0)}}return b(),()=>{var k;return(k=m==null?void 0:m.unsubscribe)==null?void 0:k.call(m)}},[e,u]),v.useEffect(()=>{const m=()=>{d(null),y()};return window.addEventListener("auth:logout",m),()=>window.removeEventListener("auth:logout",m)},[]);async function h(m,b=null){var k,_,C,S;console.log("[Auth] refreshProfile() starting");try{console.log("[Auth] Fetching /api/base/auth/me...");const j=await De("/api/base/auth/me",{headers:{Authorization:`Bearer ${m}`}});if(console.log("[Auth] /api/base/auth/me response received",{hasProfile:!!j}),!j)return console.log("[Auth] No profile returned"),null;const E=E5((j==null?void 0:j.profile_name)||(j==null?void 0:j.profile)||(j==null?void 0:j.profileName)),P=cg[E]||["sales_person"],L=(j==null?void 0:j.roles)||(j==null?void 0:j.rbac_roles)||(j==null?void 0:j.user_roles)||[],I={id:(j==null?void 0:j.id)||(b==null?void 0:b.id),email:(j==null?void 0:j.email)||(b==null?void 0:b.email),name:(j==null?void 0:j.name)||Pk(b,E),profile:E,profile_name:E,roles:ug([...P,...L]),permissions:Tk((j==null?void 0:j.permissions)||[]),raw:j};return console.log("[Auth] Profile loaded, setting user",{email:I.email,roles:I.roles}),o(I),localStorage.setItem("mmg_user",JSON.stringify(I)),localStorage.setItem("userData",JSON.stringify(I)),d(null),I}catch(j){if(console.log("[Auth] refreshProfile error",j),(j==null?void 0:j.status)===403&&((k=j==null?void 0:j.data)!=null&&k.requiresLogout)){const E=(b==null?void 0:b.email)||(i==null?void 0:i.email)||"";return((_=j==null?void 0:j.data)==null?void 0:_.code)==="USER_PENDING_APPROVAL"?(d({pending:!0,email:E,message:((C=j==null?void 0:j.data)==null?void 0:C.error)||"Your account is pending administrator approval."}),null):(await y(),null)}if(b){console.log("[Auth] Using fallback session user data");const E=((S=b.user_metadata)==null?void 0:S.profile)||"sales_user",P=cg[E]||["sales_person"],L={id:b.id,email:b.email,name:Pk(b,E),profile:E,profile_name:E,roles:ug(P),permissions:[],raw:b};return console.log("[Auth] Fallback user set",{email:L.email}),o(L),localStorage.setItem("mmg_user",JSON.stringify(L)),localStorage.setItem("userData",JSON.stringify(L)),d(null),L}return console.log("[Auth] No fallback available, returning null"),null}}async function f(){return s!=null&&s.access_token?s.access_token:localStorage.getItem("authToken")}async function p({email:m,password:b}){var C;if(d(null),!e){if(!n)throw new Error("Supabase not configured");const S=N5[m.toLowerCase()];if(!S||S.password!==b)throw new Error("Invalid email or password");const j=S.profile||((C=S.roles)!=null&&C.includes("admin")?"system_admin":"sales_user"),E=ug(S.roles||cg[j]||["sales_person"]),P={id:S.id,email:S.email,name:S.name,profile:j,profile_name:j,roles:E,permissions:Tk(S.permissions||[]),raw:S},L=`dev-token-${Date.now()}`;return wl(L),o(P),localStorage.setItem("mmg_user",JSON.stringify(P)),localStorage.setItem("userData",JSON.stringify(P)),P}const{data:k,error:_}=await e.auth.signInWithPassword({email:m,password:b});if(_)throw _;return wl(k.session.access_token),await h(k.session.access_token,k.session.user),k}async function w(){if(!e)throw new Error("Supabase not configured. Please contact your administrator.");const m=P5(),{data:b,error:k}=await e.auth.signInWithOAuth({provider:"azure",options:{scopes:"email profile openid",redirectTo:m}});if(k)throw k;return b}async function x({token:m,email:b,password:k,fullName:_}){var E;if(!e)throw new Error("Supabase not configured");const C=await De("/api/base/auth/validate-invite",{method:"POST",body:JSON.stringify({token:m,email:b})}),{data:S,error:j}=await e.auth.signUp({email:b,password:k,options:{data:{full_name:_,profile:(C==null?void 0:C.profile_name)||"sales_user"}}});if(j)throw j;return await De("/api/base/auth/consume-invite",{method:"POST",body:JSON.stringify({token:m,email:b,supabase_user_id:(E=S==null?void 0:S.user)==null?void 0:E.id,profile_name:C==null?void 0:C.profile_name,name:_})}),S}async function y(){try{e&&await e.auth.signOut()}finally{li(),r(null),o(null),d(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"),sessionStorage.removeItem("msSsoPending")}}const g=v.useMemo(()=>({authReady:a,user:i,session:s,pendingAccess:u,getAccessToken:f,signInWithPassword:p,signInWithMicrosoft:w,signUpWithInvite:x,refreshProfile:h,logout:y}),[a,i,s,u]);return c.jsx(FN.Provider,{value:g,children:t})}function pi(){const t=v.useContext(FN);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function P5(){const t=`${window.location.protocol}//${window.location.host}`,e=window.SUPABASE_REDIRECT_URL||void 0||"";return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?`${t}/auth/callback`:`${(e||t).replace(/\/$/,"")}/auth/callback`}function R5(){const{signInWithMicrosoft:t}=pi(),e=Ed(),n=fc(),s=v.useMemo(()=>{var h;return((h=n.state)==null?void 0:h.from)||"/app/chat"},[n.state]),[r,i]=v.useState(""),[o,a]=v.useState(!1),{user:l,authReady:u}=pi();v.useEffect(()=>{u&&l&&e(s,{replace:!0})},[u,l,s,e]);async function d(){if(!o){i("");try{a(!0),sessionStorage.setItem("postAuthRedirect",s||"/app/chat"),await new Promise(h=>requestAnimationFrame(h)),await t()}catch(h){i((h==null?void 0:h.message)||"SSO failed"),a(!1)}}}return c.jsxs("div",{className:"relative min-h-screen px-4 py-8 flex items-center justify-center overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 mmg-login-bg"}),c.jsx("div",{className:"mmg-particle one"}),c.jsx("div",{className:"mmg-particle two"}),c.jsx("div",{className:"mmg-particle three"}),c.jsxs("div",{className:"relative z-10 w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center",children:[c.jsxs("div",{className:"flex flex-col items-center text-center gap-4 min-h-[260px] lg:min-h-[520px] lg:pr-12 lg:border-r lg:border-black/10 dark:lg:border-white/10",children:[c.jsxs("div",{className:"flex flex-col items-center gap-4 pt-6",children:[c.jsx("img",{src:"/MMG_Logo_Blk.png",alt:"MMG",className:"h-24 sm:h-36 lg:h-40 w-auto ml-4 dark:hidden"}),c.jsx("img",{src:"/MMG_Logo.png",alt:"MMG",className:"hidden h-24 sm:h-36 lg:h-40 w-auto ml-4 dark:block"}),c.jsx("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-semibold tracking-[0.32em] sm:tracking-[0.35em] text-[#ca9e2c]",children:"NOVA AI"})]}),c.jsxs("div",{className:"mt-auto pb-6 hidden lg:flex flex-nowrap items-center justify-center gap-4 text-black/40 dark:text-white/35",children:[c.jsx("img",{src:"/backlite.png",alt:"Backlite",className:"h-8 sm:h-9 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-6 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/viola.png",alt:"Viola",className:"h-8 sm:h-9 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-6 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/media.png",alt:"Media",className:"h-8 sm:h-9 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-6 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/purple.png",alt:"Purple",className:"h-8 sm:h-9 w-auto"})]})]}),c.jsx("div",{className:"w-full max-w-md justify-self-center lg:pl-12",children:c.jsxs("div",{className:"space-y-3 flex flex-col items-center sm:items-stretch",children:[r?c.jsx("div",{className:"text-sm text-red-700 rounded-2xl px-4 py-2 bg-black/5 dark:bg-white/10 w-full max-w-xs sm:max-w-none",children:r}):null,c.jsx(se,{variant:"secondary",size:"lg",className:"w-full max-w-xs sm:max-w-none justify-center gap-2",onClick:d,disabled:o,children:o?c.jsx(Ve,{text:"Signing you in"}):c.jsxs(c.Fragment,{children:[c.jsx(qM,{size:18}),"Sign in with Microsoft"]})})]})}),c.jsxs("div",{className:"flex lg:hidden flex-nowrap items-center justify-center gap-2 text-black/40 dark:text-white/35",children:[c.jsx("img",{src:"/backlite.png",alt:"Backlite",className:"h-6 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-4 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/viola.png",alt:"Viola",className:"h-6 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-4 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/media.png",alt:"Media",className:"h-6 w-auto"}),c.jsx("span",{"aria-hidden":"true",className:"h-4 w-px bg-black/20 dark:bg-white/20"}),c.jsx("img",{src:"/purple.png",alt:"Purple",className:"h-6 w-auto"})]})]})]})}function zN({email:t,message:e,onSignOut:n}){return c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsxs("div",{className:"w-full max-w-[520px] space-y-4 rounded-2xl bg-white/60 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 p-6 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:"Access Pending"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:e||"Your account is pending administrator approval."}),t?c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:["Signed in as ",c.jsx("strong",{children:t})]}):null,c.jsx("div",{className:"flex justify-center pt-2",children:c.jsx(se,{variant:"secondary",onClick:n,children:"Sign Out"})})]})})}function A5(){const t=Ed(),{authReady:e,session:n,user:s,pendingAccess:r,logout:i}=pi();return v.useEffect(()=>{if(e&&!n){t("/login",{replace:!0});return}if(e&&n&&s){const o=sessionStorage.getItem("postAuthRedirect")||"/app/chat";sessionStorage.removeItem("postAuthRedirect"),t(o,{replace:!0})}},[e,n,s,t]),e&&r?c.jsx(zN,{email:r.email,message:r.message,onSignOut:i}):c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ve,{text:"Loading"})})})}function O5({size:t=128}){return c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("img",{src:"/MMG_Logo_Blk.png",width:t,height:t,alt:"MMG",className:"shrink-0 dark:hidden"}),c.jsx("img",{src:"/MMG_Logo.png",width:t,height:t,alt:"MMG",className:"shrink-0 hidden dark:block"}),c.jsx("span",{className:"mmg-brand-gold font-semibold text-lg leading-none tracking-tight hidden sm:inline-flex",children:"Nova"})]})}function BN(){const{theme:t,setTheme:e}=oM(),n=t==="dark";return c.jsx(se,{variant:"ghost",size:"icon","aria-label":"Toggle theme",onClick:()=>e(n?"light":"dark"),title:"Toggle theme",className:"rounded-2xl",children:n?c.jsx(nI,{size:18}):c.jsx(XM,{size:18})})}function tt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Ad(t,e=[]){let n=[];function s(i,o){const a=v.createContext(o),l=n.length;n=[...n,o];const u=h=>{var g;const{scope:f,children:p,...w}=h,x=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,y=v.useMemo(()=>w,Object.values(w));return c.jsx(x.Provider,{value:y,children:p})};u.displayName=i+"Provider";function d(h,f){var x;const p=((x=f==null?void 0:f[t])==null?void 0:x[l])||a,w=v.useContext(p);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const r=()=>{const i=n.map(o=>v.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[s,M5(r,...e)]}function M5(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:u})=>{const h=l(i)[`__scope${u}`];return{...a,...h}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var mo=globalThis!=null&&globalThis.document?v.useLayoutEffect:()=>{},I5=Ap[" useInsertionEffect ".trim().toString()]||mo;function UN({prop:t,defaultProp:e,onChange:n=()=>{},caller:s}){const[r,i,o]=D5({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const d=v.useRef(t!==void 0);v.useEffect(()=>{const h=d.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=a},[a,s])}const u=v.useCallback(d=>{var h;if(a){const f=L5(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[a,t,i,o]);return[l,u]}function D5({defaultProp:t,onChange:e}){const[n,s]=v.useState(t),r=v.useRef(n),i=v.useRef(e);return I5(()=>{i.current=e},[e]),v.useEffect(()=>{var o;r.current!==n&&((o=i.current)==null||o.call(i,n),r.current=n)},[n,r]),[n,s,i]}function L5(t){return typeof t=="function"}function $5(t){const e=F5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(B5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function F5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=H5(r),a=U5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Oa(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var z5=Symbol("radix.slottable");function B5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===z5}function U5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function H5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var W5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wn=W5.reduce((t,e)=>{const n=$5(`Primitive.${e}`),s=v.forwardRef((r,i)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function HN(t,e){t&&jd.flushSync(()=>t.dispatchEvent(e))}function Rk(t){const e=V5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(K5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function V5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=Y5(r),a=G5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Oa(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var q5=Symbol("radix.slottable");function K5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===q5}function G5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function Y5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function WN(t){const e=t+"CollectionProvider",[n,s]=Ad(e),[r,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:y,children:g}=x,m=ve.useRef(null),b=ve.useRef(new Map).current;return c.jsx(r,{scope:y,itemMap:b,collectionRef:m,children:g})};o.displayName=e;const a=t+"CollectionSlot",l=Rk(a),u=ve.forwardRef((x,y)=>{const{scope:g,children:m}=x,b=i(a,g),k=us(y,b.collectionRef);return c.jsx(l,{ref:k,children:m})});u.displayName=a;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=Rk(d),p=ve.forwardRef((x,y)=>{const{scope:g,children:m,...b}=x,k=ve.useRef(null),_=us(y,k),C=i(d,g);return ve.useEffect(()=>(C.itemMap.set(k,{ref:k,...b}),()=>void C.itemMap.delete(k))),c.jsx(f,{[h]:"",ref:_,children:m})});p.displayName=d;function w(x){const y=i(t+"CollectionConsumer",x);return ve.useCallback(()=>{const m=y.collectionRef.current;if(!m)return[];const b=Array.from(m.querySelectorAll(`[${h}]`));return Array.from(y.itemMap.values()).sort((C,S)=>b.indexOf(C.ref.current)-b.indexOf(S.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:u,ItemSlot:p},w,s]}var Q5=v.createContext(void 0);function VN(t){const e=v.useContext(Q5);return t||e||"ltr"}function mi(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function X5(t,e=globalThis==null?void 0:globalThis.document){const n=mi(t);v.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var J5="DismissableLayer",ky="dismissableLayer.update",Z5="dismissableLayer.pointerDownOutside",e$="dismissableLayer.focusOutside",Ak,qN=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),KN=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,u=v.useContext(qN),[d,h]=v.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=v.useState({}),w=us(e,S=>h(S)),x=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),g=x.indexOf(y),m=d?x.indexOf(d):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,k=m>=g,_=s$(S=>{const j=S.target,E=[...u.branches].some(P=>P.contains(j));!k||E||(r==null||r(S),o==null||o(S),S.defaultPrevented||a==null||a())},f),C=r$(S=>{const j=S.target;[...u.branches].some(P=>P.contains(j))||(i==null||i(S),o==null||o(S),S.defaultPrevented||a==null||a())},f);return X5(S=>{m===u.layers.size-1&&(s==null||s(S),!S.defaultPrevented&&a&&(S.preventDefault(),a()))},f),v.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Ak=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),Ok(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Ak)}},[d,f,n,u]),v.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),Ok())},[d,u]),v.useEffect(()=>{const S=()=>p({});return document.addEventListener(ky,S),()=>document.removeEventListener(ky,S)},[]),c.jsx(Wn.div,{...l,ref:w,style:{pointerEvents:b?k?"auto":"none":void 0,...t.style},onFocusCapture:tt(t.onFocusCapture,C.onFocusCapture),onBlurCapture:tt(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:tt(t.onPointerDownCapture,_.onPointerDownCapture)})});KN.displayName=J5;var t$="DismissableLayerBranch",n$=v.forwardRef((t,e)=>{const n=v.useContext(qN),s=v.useRef(null),r=us(e,s);return v.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),c.jsx(Wn.div,{...t,ref:r})});n$.displayName=t$;function s$(t,e=globalThis==null?void 0:globalThis.document){const n=mi(t),s=v.useRef(!1),r=v.useRef(()=>{});return v.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){GN(Z5,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function r$(t,e=globalThis==null?void 0:globalThis.document){const n=mi(t),s=v.useRef(!1);return v.useEffect(()=>{const r=i=>{i.target&&!s.current&&GN(e$,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function Ok(){const t=new CustomEvent(ky);document.dispatchEvent(t)}function GN(t,e,n,{discrete:s}){const r=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?HN(r,i):r.dispatchEvent(i)}var dg=0;function i$(){v.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Mk()),document.body.insertAdjacentElement("beforeend",t[1]??Mk()),dg++,()=>{dg===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),dg--}},[])}function Mk(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var hg="focusScope.autoFocusOnMount",fg="focusScope.autoFocusOnUnmount",Ik={bubbles:!1,cancelable:!0},o$="FocusScope",YN=v.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:i,...o}=t,[a,l]=v.useState(null),u=mi(r),d=mi(i),h=v.useRef(null),f=us(e,x=>l(x)),p=v.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;v.useEffect(()=>{if(s){let x=function(b){if(p.paused||!a)return;const k=b.target;a.contains(k)?h.current=k:Ei(h.current,{select:!0})},y=function(b){if(p.paused||!a)return;const k=b.relatedTarget;k!==null&&(a.contains(k)||Ei(h.current,{select:!0}))},g=function(b){if(document.activeElement===document.body)for(const _ of b)_.removedNodes.length>0&&Ei(a)};document.addEventListener("focusin",x),document.addEventListener("focusout",y);const m=new MutationObserver(g);return a&&m.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",y),m.disconnect()}}},[s,a,p.paused]),v.useEffect(()=>{if(a){Lk.add(p);const x=document.activeElement;if(!a.contains(x)){const g=new CustomEvent(hg,Ik);a.addEventListener(hg,u),a.dispatchEvent(g),g.defaultPrevented||(a$(h$(QN(a)),{select:!0}),document.activeElement===x&&Ei(a))}return()=>{a.removeEventListener(hg,u),setTimeout(()=>{const g=new CustomEvent(fg,Ik);a.addEventListener(fg,d),a.dispatchEvent(g),g.defaultPrevented||Ei(x??document.body,{select:!0}),a.removeEventListener(fg,d),Lk.remove(p)},0)}}},[a,u,d,p]);const w=v.useCallback(x=>{if(!n&&!s||p.paused)return;const y=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,g=document.activeElement;if(y&&g){const m=x.currentTarget,[b,k]=l$(m);b&&k?!x.shiftKey&&g===k?(x.preventDefault(),n&&Ei(b,{select:!0})):x.shiftKey&&g===b&&(x.preventDefault(),n&&Ei(k,{select:!0})):g===m&&x.preventDefault()}},[n,s,p.paused]);return c.jsx(Wn.div,{tabIndex:-1,...o,ref:f,onKeyDown:w})});YN.displayName=o$;function a$(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(Ei(s,{select:e}),document.activeElement!==n)return}function l$(t){const e=QN(t),n=Dk(e,t),s=Dk(e.reverse(),t);return[n,s]}function QN(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Dk(t,e){for(const n of t)if(!c$(n,{upTo:e}))return n}function c$(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function u$(t){return t instanceof HTMLInputElement&&"select"in t}function Ei(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&u$(t)&&e&&t.select()}}var Lk=d$();function d$(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=$k(t,e),t.unshift(e)},remove(e){var n;t=$k(t,e),(n=t[0])==null||n.resume()}}}function $k(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function h$(t){return t.filter(e=>e.tagName!=="A")}var f$=Ap[" useId ".trim().toString()]||(()=>{}),p$=0;function _y(t){const[e,n]=v.useState(f$());return mo(()=>{n(s=>s??String(p$++))},[t]),e?`radix-${e}`:""}const m$=["top","right","bottom","left"],go=Math.min,bs=Math.max,cp=Math.round,Th=Math.floor,Fr=t=>({x:t,y:t}),g$={left:"right",right:"left",bottom:"top",top:"bottom"},x$={start:"end",end:"start"};function Sy(t,e,n){return bs(t,go(e,n))}function gi(t,e){return typeof t=="function"?t(e):t}function xi(t){return t.split("-")[0]}function xc(t){return t.split("-")[1]}function h0(t){return t==="x"?"y":"x"}function f0(t){return t==="y"?"height":"width"}const y$=new Set(["top","bottom"]);function Ir(t){return y$.has(xi(t))?"y":"x"}function p0(t){return h0(Ir(t))}function v$(t,e,n){n===void 0&&(n=!1);const s=xc(t),r=p0(t),i=f0(r);let o=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=up(o)),[o,up(o)]}function b$(t){const e=up(t);return[jy(t),e,jy(e)]}function jy(t){return t.replace(/start|end/g,e=>x$[e])}const Fk=["left","right"],zk=["right","left"],w$=["top","bottom"],k$=["bottom","top"];function _$(t,e,n){switch(t){case"top":case"bottom":return n?e?zk:Fk:e?Fk:zk;case"left":case"right":return e?w$:k$;default:return[]}}function S$(t,e,n,s){const r=xc(t);let i=_$(xi(t),n==="start",s);return r&&(i=i.map(o=>o+"-"+r),e&&(i=i.concat(i.map(jy)))),i}function up(t){return t.replace(/left|right|bottom|top/g,e=>g$[e])}function j$(t){return{top:0,right:0,bottom:0,left:0,...t}}function XN(t){return typeof t!="number"?j$(t):{top:t,right:t,bottom:t,left:t}}function dp(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function Bk(t,e,n){let{reference:s,floating:r}=t;const i=Ir(e),o=p0(e),a=f0(o),l=xi(e),u=i==="y",d=s.x+s.width/2-r.width/2,h=s.y+s.height/2-r.height/2,f=s[a]/2-r[a]/2;let p;switch(l){case"top":p={x:d,y:s.y-r.height};break;case"bottom":p={x:d,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:h};break;case"left":p={x:s.x-r.width,y:h};break;default:p={x:s.x,y:s.y}}switch(xc(e)){case"start":p[o]-=f*(n&&u?-1:1);break;case"end":p[o]+=f*(n&&u?-1:1);break}return p}const C$=async(t,e,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:d,y:h}=Bk(u,s,l),f=s,p={},w=0;for(let x=0;x<a.length;x++){const{name:y,fn:g}=a[x],{x:m,y:b,data:k,reset:_}=await g({x:d,y:h,initialPlacement:s,placement:f,strategy:r,middlewareData:p,rects:u,platform:o,elements:{reference:t,floating:e}});d=m??d,h=b??h,p={...p,[y]:{...p[y],...k}},_&&w<=50&&(w++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(u=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):_.rects),{x:d,y:h}=Bk(u,f,l)),x=-1)}return{x:d,y:h,placement:f,strategy:r,middlewareData:p}};async function Gu(t,e){var n;e===void 0&&(e={});const{x:s,y:r,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=gi(e,t),w=XN(p),y=a[f?h==="floating"?"reference":"floating":h],g=dp(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:u,rootBoundary:d,strategy:l})),m=h==="floating"?{x:s,y:r,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),k=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},_=dp(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:m,offsetParent:b,strategy:l}):m);return{top:(g.top-_.top+w.top)/k.y,bottom:(_.bottom-g.bottom+w.bottom)/k.y,left:(g.left-_.left+w.left)/k.x,right:(_.right-g.right+w.right)/k.x}}const N$=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:r,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:d=0}=gi(t,e)||{};if(u==null)return{};const h=XN(d),f={x:n,y:s},p=p0(r),w=f0(p),x=await o.getDimensions(u),y=p==="y",g=y?"top":"left",m=y?"bottom":"right",b=y?"clientHeight":"clientWidth",k=i.reference[w]+i.reference[p]-f[p]-i.floating[w],_=f[p]-i.reference[p],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let S=C?C[b]:0;(!S||!await(o.isElement==null?void 0:o.isElement(C)))&&(S=a.floating[b]||i.floating[w]);const j=k/2-_/2,E=S/2-x[w]/2-1,P=go(h[g],E),L=go(h[m],E),I=P,O=S-x[w]-L,$=S/2-x[w]/2+j,D=Sy(I,$,O),F=!l.arrow&&xc(r)!=null&&$!==D&&i.reference[w]/2-($<I?P:L)-x[w]/2<0,K=F?$<I?$-I:$-O:0;return{[p]:f[p]+K,data:{[p]:D,centerOffset:$-D-K,...F&&{alignmentOffset:K}},reset:F}}}),E$=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:r,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:x=!0,...y}=gi(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const g=xi(r),m=Ir(a),b=xi(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(u.floating)),_=f||(b||!x?[up(a)]:b$(a)),C=w!=="none";!f&&C&&_.push(...S$(a,x,w,k));const S=[a,..._],j=await Gu(e,y),E=[];let P=((s=i.flip)==null?void 0:s.overflows)||[];if(d&&E.push(j[g]),h){const $=v$(r,o,k);E.push(j[$[0]],j[$[1]])}if(P=[...P,{placement:r,overflows:E}],!E.every($=>$<=0)){var L,I;const $=(((L=i.flip)==null?void 0:L.index)||0)+1,D=S[$];if(D&&(!(h==="alignment"?m!==Ir(D):!1)||P.every(T=>Ir(T.placement)===m?T.overflows[0]>0:!0)))return{data:{index:$,overflows:P},reset:{placement:D}};let F=(I=P.filter(K=>K.overflows[0]<=0).sort((K,T)=>K.overflows[1]-T.overflows[1])[0])==null?void 0:I.placement;if(!F)switch(p){case"bestFit":{var O;const K=(O=P.filter(T=>{if(C){const R=Ir(T.placement);return R===m||R==="y"}return!0}).map(T=>[T.placement,T.overflows.filter(R=>R>0).reduce((R,V)=>R+V,0)]).sort((T,R)=>T[1]-R[1])[0])==null?void 0:O[0];K&&(F=K);break}case"initialPlacement":F=a;break}if(r!==F)return{reset:{placement:F}}}return{}}}};function Uk(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Hk(t){return m$.some(e=>t[e]>=0)}const T$=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...r}=gi(t,e);switch(s){case"referenceHidden":{const i=await Gu(e,{...r,elementContext:"reference"}),o=Uk(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Hk(o)}}}case"escaped":{const i=await Gu(e,{...r,altBoundary:!0}),o=Uk(i,n.floating);return{data:{escapedOffsets:o,escaped:Hk(o)}}}default:return{}}}}},JN=new Set(["left","top"]);async function P$(t,e){const{placement:n,platform:s,elements:r}=t,i=await(s.isRTL==null?void 0:s.isRTL(r.floating)),o=xi(n),a=xc(n),l=Ir(n)==="y",u=JN.has(o)?-1:1,d=i&&l?-1:1,h=gi(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:w}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof w=="number"&&(p=a==="end"?w*-1:w),l?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const R$=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:r,y:i,placement:o,middlewareData:a}=e,l=await P$(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:i+l.y,data:{...l,placement:o}}}}},A$=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:g,y:m}=y;return{x:g,y:m}}},...l}=gi(t,e),u={x:n,y:s},d=await Gu(e,l),h=Ir(xi(r)),f=h0(h);let p=u[f],w=u[h];if(i){const y=f==="y"?"top":"left",g=f==="y"?"bottom":"right",m=p+d[y],b=p-d[g];p=Sy(m,p,b)}if(o){const y=h==="y"?"top":"left",g=h==="y"?"bottom":"right",m=w+d[y],b=w-d[g];w=Sy(m,w,b)}const x=a.fn({...e,[f]:p,[h]:w});return{...x,data:{x:x.x-n,y:x.y-s,enabled:{[f]:i,[h]:o}}}}}},O$=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:r,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=gi(t,e),d={x:n,y:s},h=Ir(r),f=h0(h);let p=d[f],w=d[h];const x=gi(a,e),y=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(l){const b=f==="y"?"height":"width",k=i.reference[f]-i.floating[b]+y.mainAxis,_=i.reference[f]+i.reference[b]-y.mainAxis;p<k?p=k:p>_&&(p=_)}if(u){var g,m;const b=f==="y"?"width":"height",k=JN.has(xi(r)),_=i.reference[h]-i.floating[b]+(k&&((g=o.offset)==null?void 0:g[h])||0)+(k?0:y.crossAxis),C=i.reference[h]+i.reference[b]+(k?0:((m=o.offset)==null?void 0:m[h])||0)-(k?y.crossAxis:0);w<_?w=_:w>C&&(w=C)}return{[f]:p,[h]:w}}}},M$=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:r,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...u}=gi(t,e),d=await Gu(e,u),h=xi(r),f=xc(r),p=Ir(r)==="y",{width:w,height:x}=i.floating;let y,g;h==="top"||h==="bottom"?(y=h,g=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(g=h,y=f==="end"?"top":"bottom");const m=x-d.top-d.bottom,b=w-d.left-d.right,k=go(x-d[y],m),_=go(w-d[g],b),C=!e.middlewareData.shift;let S=k,j=_;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(j=b),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(S=m),C&&!f){const P=bs(d.left,0),L=bs(d.right,0),I=bs(d.top,0),O=bs(d.bottom,0);p?j=w-2*(P!==0||L!==0?P+L:bs(d.left,d.right)):S=x-2*(I!==0||O!==0?I+O:bs(d.top,d.bottom))}await l({...e,availableWidth:j,availableHeight:S});const E=await o.getDimensions(a.floating);return w!==E.width||x!==E.height?{reset:{rects:!0}}:{}}}};function Xp(){return typeof window<"u"}function yc(t){return ZN(t)?(t.nodeName||"").toLowerCase():"#document"}function Cs(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Br(t){var e;return(e=(ZN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function ZN(t){return Xp()?t instanceof Node||t instanceof Cs(t).Node:!1}function fr(t){return Xp()?t instanceof Element||t instanceof Cs(t).Element:!1}function zr(t){return Xp()?t instanceof HTMLElement||t instanceof Cs(t).HTMLElement:!1}function Wk(t){return!Xp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Cs(t).ShadowRoot}const I$=new Set(["inline","contents"]);function Od(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=pr(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!I$.has(r)}const D$=new Set(["table","td","th"]);function L$(t){return D$.has(yc(t))}const $$=[":popover-open",":modal"];function Jp(t){return $$.some(e=>{try{return t.matches(e)}catch{return!1}})}const F$=["transform","translate","scale","rotate","perspective"],z$=["transform","translate","scale","rotate","perspective","filter"],B$=["paint","layout","strict","content"];function m0(t){const e=g0(),n=fr(t)?pr(t):t;return F$.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||z$.some(s=>(n.willChange||"").includes(s))||B$.some(s=>(n.contain||"").includes(s))}function U$(t){let e=xo(t);for(;zr(e)&&!ac(e);){if(m0(e))return e;if(Jp(e))return null;e=xo(e)}return null}function g0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const H$=new Set(["html","body","#document"]);function ac(t){return H$.has(yc(t))}function pr(t){return Cs(t).getComputedStyle(t)}function Zp(t){return fr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function xo(t){if(yc(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Wk(t)&&t.host||Br(t);return Wk(e)?e.host:e}function eE(t){const e=xo(t);return ac(e)?t.ownerDocument?t.ownerDocument.body:t.body:zr(e)&&Od(e)?e:eE(e)}function Yu(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=eE(t),i=r===((s=t.ownerDocument)==null?void 0:s.body),o=Cs(r);if(i){const a=Cy(o);return e.concat(o,o.visualViewport||[],Od(r)?r:[],a&&n?Yu(a):[])}return e.concat(r,Yu(r,[],n))}function Cy(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function tE(t){const e=pr(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=zr(t),i=r?t.offsetWidth:n,o=r?t.offsetHeight:s,a=cp(n)!==i||cp(s)!==o;return a&&(n=i,s=o),{width:n,height:s,$:a}}function x0(t){return fr(t)?t:t.contextElement}function Al(t){const e=x0(t);if(!zr(e))return Fr(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:i}=tE(e);let o=(i?cp(n.width):n.width)/s,a=(i?cp(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const W$=Fr(0);function nE(t){const e=Cs(t);return!g0()||!e.visualViewport?W$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function V$(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Cs(t)?!1:e}function Ca(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=x0(t);let o=Fr(1);e&&(s?fr(s)&&(o=Al(s)):o=Al(t));const a=V$(i,n,s)?nE(i):Fr(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,d=r.width/o.x,h=r.height/o.y;if(i){const f=Cs(i),p=s&&fr(s)?Cs(s):s;let w=f,x=Cy(w);for(;x&&s&&p!==w;){const y=Al(x),g=x.getBoundingClientRect(),m=pr(x),b=g.left+(x.clientLeft+parseFloat(m.paddingLeft))*y.x,k=g.top+(x.clientTop+parseFloat(m.paddingTop))*y.y;l*=y.x,u*=y.y,d*=y.x,h*=y.y,l+=b,u+=k,w=Cs(x),x=Cy(w)}}return dp({width:d,height:h,x:l,y:u})}function em(t,e){const n=Zp(t).scrollLeft;return e?e.left+n:Ca(Br(t)).left+n}function sE(t,e){const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-em(t,n),r=n.top+e.scrollTop;return{x:s,y:r}}function q$(t){let{elements:e,rect:n,offsetParent:s,strategy:r}=t;const i=r==="fixed",o=Br(s),a=e?Jp(e.floating):!1;if(s===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},u=Fr(1);const d=Fr(0),h=zr(s);if((h||!h&&!i)&&((yc(s)!=="body"||Od(o))&&(l=Zp(s)),zr(s))){const p=Ca(s);u=Al(s),d.x=p.x+s.clientLeft,d.y=p.y+s.clientTop}const f=o&&!h&&!i?sE(o,l):Fr(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-l.scrollTop*u.y+d.y+f.y}}function K$(t){return Array.from(t.getClientRects())}function G$(t){const e=Br(t),n=Zp(t),s=t.ownerDocument.body,r=bs(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=bs(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+em(t);const a=-n.scrollTop;return pr(s).direction==="rtl"&&(o+=bs(e.clientWidth,s.clientWidth)-r),{width:r,height:i,x:o,y:a}}const Vk=25;function Y$(t,e){const n=Cs(t),s=Br(t),r=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(r){i=r.width,o=r.height;const d=g0();(!d||d&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}const u=em(s);if(u<=0){const d=s.ownerDocument,h=d.body,f=getComputedStyle(h),p=d.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,w=Math.abs(s.clientWidth-h.clientWidth-p);w<=Vk&&(i-=w)}else u<=Vk&&(i+=u);return{width:i,height:o,x:a,y:l}}const Q$=new Set(["absolute","fixed"]);function X$(t,e){const n=Ca(t,!0,e==="fixed"),s=n.top+t.clientTop,r=n.left+t.clientLeft,i=zr(t)?Al(t):Fr(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=r*i.x,u=s*i.y;return{width:o,height:a,x:l,y:u}}function qk(t,e,n){let s;if(e==="viewport")s=Y$(t,n);else if(e==="document")s=G$(Br(t));else if(fr(e))s=X$(e,n);else{const r=nE(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return dp(s)}function rE(t,e){const n=xo(t);return n===e||!fr(n)||ac(n)?!1:pr(n).position==="fixed"||rE(n,e)}function J$(t,e){const n=e.get(t);if(n)return n;let s=Yu(t,[],!1).filter(a=>fr(a)&&yc(a)!=="body"),r=null;const i=pr(t).position==="fixed";let o=i?xo(t):t;for(;fr(o)&&!ac(o);){const a=pr(o),l=m0(o);!l&&a.position==="fixed"&&(r=null),(i?!l&&!r:!l&&a.position==="static"&&!!r&&Q$.has(r.position)||Od(o)&&!l&&rE(t,o))?s=s.filter(d=>d!==o):r=a,o=xo(o)}return e.set(t,s),s}function Z$(t){let{element:e,boundary:n,rootBoundary:s,strategy:r}=t;const o=[...n==="clippingAncestors"?Jp(e)?[]:J$(e,this._c):[].concat(n),s],a=o[0],l=o.reduce((u,d)=>{const h=qk(e,d,r);return u.top=bs(h.top,u.top),u.right=go(h.right,u.right),u.bottom=go(h.bottom,u.bottom),u.left=bs(h.left,u.left),u},qk(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function eF(t){const{width:e,height:n}=tE(t);return{width:e,height:n}}function tF(t,e,n){const s=zr(e),r=Br(e),i=n==="fixed",o=Ca(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Fr(0);function u(){l.x=em(r)}if(s||!s&&!i)if((yc(e)!=="body"||Od(r))&&(a=Zp(e)),s){const p=Ca(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else r&&u();i&&!s&&r&&u();const d=r&&!s&&!i?sE(r,a):Fr(0),h=o.left+a.scrollLeft-l.x-d.x,f=o.top+a.scrollTop-l.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function pg(t){return pr(t).position==="static"}function Kk(t,e){if(!zr(t)||pr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Br(t)===n&&(n=n.ownerDocument.body),n}function iE(t,e){const n=Cs(t);if(Jp(t))return n;if(!zr(t)){let r=xo(t);for(;r&&!ac(r);){if(fr(r)&&!pg(r))return r;r=xo(r)}return n}let s=Kk(t,e);for(;s&&L$(s)&&pg(s);)s=Kk(s,e);return s&&ac(s)&&pg(s)&&!m0(s)?n:s||U$(t)||n}const nF=async function(t){const e=this.getOffsetParent||iE,n=this.getDimensions,s=await n(t.floating);return{reference:tF(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function sF(t){return pr(t).direction==="rtl"}const rF={convertOffsetParentRelativeRectToViewportRelativeRect:q$,getDocumentElement:Br,getClippingRect:Z$,getOffsetParent:iE,getElementRects:nF,getClientRects:K$,getDimensions:eF,getScale:Al,isElement:fr,isRTL:sF};function oE(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function iF(t,e){let n=null,s;const r=Br(t);function i(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:p}=u;if(a||e(),!f||!p)return;const w=Th(h),x=Th(r.clientWidth-(d+f)),y=Th(r.clientHeight-(h+p)),g=Th(d),b={rootMargin:-w+"px "+-x+"px "+-y+"px "+-g+"px",threshold:bs(0,go(1,l))||1};let k=!0;function _(C){const S=C[0].intersectionRatio;if(S!==l){if(!k)return o();S?o(!1,S):s=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!oE(u,t.getBoundingClientRect())&&o(),k=!1}try{n=new IntersectionObserver(_,{...b,root:r.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(t)}return o(!0),i}function oF(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,u=x0(t),d=r||i?[...u?Yu(u):[],...Yu(e)]:[];d.forEach(g=>{r&&g.addEventListener("scroll",n,{passive:!0}),i&&g.addEventListener("resize",n)});const h=u&&a?iF(u,n):null;let f=-1,p=null;o&&(p=new ResizeObserver(g=>{let[m]=g;m&&m.target===u&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(e)})),n()}),u&&!l&&p.observe(u),p.observe(e));let w,x=l?Ca(t):null;l&&y();function y(){const g=Ca(t);x&&!oE(x,g)&&n(),x=g,w=requestAnimationFrame(y)}return n(),()=>{var g;d.forEach(m=>{r&&m.removeEventListener("scroll",n),i&&m.removeEventListener("resize",n)}),h==null||h(),(g=p)==null||g.disconnect(),p=null,l&&cancelAnimationFrame(w)}}const aF=R$,lF=A$,cF=E$,uF=M$,dF=T$,Gk=N$,hF=O$,fF=(t,e,n)=>{const s=new Map,r={platform:rF,...n},i={...r.platform,_c:s};return C$(t,e,{...r,platform:i})};var pF=typeof document<"u",mF=function(){},kf=pF?v.useLayoutEffect:mF;function hp(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!hp(t[s],e[s]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){const i=r[s];if(!(i==="_owner"&&t.$$typeof)&&!hp(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function aE(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Yk(t,e){const n=aE(t);return Math.round(e*n)/n}function mg(t){const e=v.useRef(t);return kf(()=>{e.current=t}),e}function gF(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[d,h]=v.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=v.useState(s);hp(f,s)||p(s);const[w,x]=v.useState(null),[y,g]=v.useState(null),m=v.useCallback(T=>{T!==C.current&&(C.current=T,x(T))},[]),b=v.useCallback(T=>{T!==S.current&&(S.current=T,g(T))},[]),k=i||w,_=o||y,C=v.useRef(null),S=v.useRef(null),j=v.useRef(d),E=l!=null,P=mg(l),L=mg(r),I=mg(u),O=v.useCallback(()=>{if(!C.current||!S.current)return;const T={placement:e,strategy:n,middleware:f};L.current&&(T.platform=L.current),fF(C.current,S.current,T).then(R=>{const V={...R,isPositioned:I.current!==!1};$.current&&!hp(j.current,V)&&(j.current=V,jd.flushSync(()=>{h(V)}))})},[f,e,n,L,I]);kf(()=>{u===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,h(T=>({...T,isPositioned:!1})))},[u]);const $=v.useRef(!1);kf(()=>($.current=!0,()=>{$.current=!1}),[]),kf(()=>{if(k&&(C.current=k),_&&(S.current=_),k&&_){if(P.current)return P.current(k,_,O);O()}},[k,_,O,P,E]);const D=v.useMemo(()=>({reference:C,floating:S,setReference:m,setFloating:b}),[m,b]),F=v.useMemo(()=>({reference:k,floating:_}),[k,_]),K=v.useMemo(()=>{const T={position:n,left:0,top:0};if(!F.floating)return T;const R=Yk(F.floating,d.x),V=Yk(F.floating,d.y);return a?{...T,transform:"translate("+R+"px, "+V+"px)",...aE(F.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:R,top:V}},[n,a,F.floating,d.x,d.y]);return v.useMemo(()=>({...d,update:O,refs:D,elements:F,floatingStyles:K}),[d,O,D,F,K])}const xF=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:r}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?Gk({element:s.current,padding:r}).fn(n):{}:s?Gk({element:s,padding:r}).fn(n):{}}}},yF=(t,e)=>({...aF(t),options:[t,e]}),vF=(t,e)=>({...lF(t),options:[t,e]}),bF=(t,e)=>({...hF(t),options:[t,e]}),wF=(t,e)=>({...cF(t),options:[t,e]}),kF=(t,e)=>({...uF(t),options:[t,e]}),_F=(t,e)=>({...dF(t),options:[t,e]}),SF=(t,e)=>({...xF(t),options:[t,e]});var jF="Arrow",lE=v.forwardRef((t,e)=>{const{children:n,width:s=10,height:r=5,...i}=t;return c.jsx(Wn.svg,{...i,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});lE.displayName=jF;var CF=lE;function NF(t){const[e,n]=v.useState(void 0);return mo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var y0="Popper",[cE,uE]=Ad(y0),[EF,dE]=cE(y0),hE=t=>{const{__scopePopper:e,children:n}=t,[s,r]=v.useState(null);return c.jsx(EF,{scope:e,anchor:s,onAnchorChange:r,children:n})};hE.displayName=y0;var fE="PopperAnchor",pE=v.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...r}=t,i=dE(fE,n),o=v.useRef(null),a=us(e,o),l=v.useRef(null);return v.useEffect(()=>{const u=l.current;l.current=(s==null?void 0:s.current)||o.current,u!==l.current&&i.onAnchorChange(l.current)}),s?null:c.jsx(Wn.div,{...r,ref:a})});pE.displayName=fE;var v0="PopperContent",[TF,PF]=cE(v0),mE=v.forwardRef((t,e)=>{var Y,U,J,be,me,H;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:w,...x}=t,y=dE(v0,n),[g,m]=v.useState(null),b=us(e,ye=>m(ye)),[k,_]=v.useState(null),C=NF(k),S=(C==null?void 0:C.width)??0,j=(C==null?void 0:C.height)??0,E=s+(i!=="center"?"-"+i:""),P=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},L=Array.isArray(u)?u:[u],I=L.length>0,O={padding:P,boundary:L.filter(AF),altBoundary:I},{refs:$,floatingStyles:D,placement:F,isPositioned:K,middlewareData:T}=gF({strategy:"fixed",placement:E,whileElementsMounted:(...ye)=>oF(...ye,{animationFrame:p==="always"}),elements:{reference:y.anchor},middleware:[yF({mainAxis:r+j,alignmentAxis:o}),l&&vF({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?bF():void 0,...O}),l&&wF({...O}),kF({...O,apply:({elements:ye,rects:X,availableWidth:ue,availableHeight:de})=>{const{width:he,height:oe}=X.reference,Se=ye.floating.style;Se.setProperty("--radix-popper-available-width",`${ue}px`),Se.setProperty("--radix-popper-available-height",`${de}px`),Se.setProperty("--radix-popper-anchor-width",`${he}px`),Se.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&SF({element:k,padding:a}),OF({arrowWidth:S,arrowHeight:j}),f&&_F({strategy:"referenceHidden",...O})]}),[R,V]=yE(F),G=mi(w);mo(()=>{K&&(G==null||G())},[K,G]);const Q=(Y=T.arrow)==null?void 0:Y.x,re=(U=T.arrow)==null?void 0:U.y,ee=((J=T.arrow)==null?void 0:J.centerOffset)!==0,[z,A]=v.useState();return mo(()=>{g&&A(window.getComputedStyle(g).zIndex)},[g]),c.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...D,transform:K?D.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:z,"--radix-popper-transform-origin":[(be=T.transformOrigin)==null?void 0:be.x,(me=T.transformOrigin)==null?void 0:me.y].join(" "),...((H=T.hide)==null?void 0:H.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:c.jsx(TF,{scope:n,placedSide:R,onArrowChange:_,arrowX:Q,arrowY:re,shouldHideArrow:ee,children:c.jsx(Wn.div,{"data-side":R,"data-align":V,...x,ref:b,style:{...x.style,animation:K?void 0:"none"}})})})});mE.displayName=v0;var gE="PopperArrow",RF={top:"bottom",right:"left",bottom:"top",left:"right"},xE=v.forwardRef(function(e,n){const{__scopePopper:s,...r}=e,i=PF(gE,s),o=RF[i.placedSide];return c.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:c.jsx(CF,{...r,ref:n,style:{...r.style,display:"block"}})})});xE.displayName=gE;function AF(t){return t!==null}var OF=t=>({name:"transformOrigin",options:t,fn(e){var y,g,m;const{placement:n,rects:s,middlewareData:r}=e,o=((y=r.arrow)==null?void 0:y.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,d]=yE(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((g=r.arrow)==null?void 0:g.x)??0)+a/2,p=(((m=r.arrow)==null?void 0:m.y)??0)+l/2;let w="",x="";return u==="bottom"?(w=o?h:`${f}px`,x=`${-l}px`):u==="top"?(w=o?h:`${f}px`,x=`${s.floating.height+l}px`):u==="right"?(w=`${-l}px`,x=o?h:`${p}px`):u==="left"&&(w=`${s.floating.width+l}px`,x=o?h:`${p}px`),{data:{x:w,y:x}}}});function yE(t){const[e,n="center"]=t.split("-");return[e,n]}var MF=hE,IF=pE,DF=mE,LF=xE,$F="Portal",vE=v.forwardRef((t,e)=>{var a;const{container:n,...s}=t,[r,i]=v.useState(!1);mo(()=>i(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?CC.createPortal(c.jsx(Wn.div,{...s,ref:e}),o):null});vE.displayName=$F;function FF(t,e){return v.useReducer((n,s)=>e[n][s]??n,t)}var Md=t=>{const{present:e,children:n}=t,s=zF(e),r=typeof n=="function"?n({present:s.isPresent}):v.Children.only(n),i=us(s.ref,BF(r));return typeof n=="function"||s.isPresent?v.cloneElement(r,{ref:i}):null};Md.displayName="Presence";function zF(t){const[e,n]=v.useState(),s=v.useRef(null),r=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=FF(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const u=Ph(s.current);i.current=a==="mounted"?u:"none"},[a]),mo(()=>{const u=s.current,d=r.current;if(d!==t){const f=i.current,p=Ph(u);t?l("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),mo(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=p=>{const x=Ph(s.current).includes(CSS.escape(p.animationName));if(p.target===e&&x&&(l("ANIMATION_END"),!r.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},f=p=>{p.target===e&&(i.current=Ph(s.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(u=>{s.current=u?getComputedStyle(u):null,n(u)},[])}}function Ph(t){return(t==null?void 0:t.animationName)||"none"}function BF(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var gg="rovingFocusGroup.onEntryFocus",UF={bubbles:!1,cancelable:!0},Id="RovingFocusGroup",[Ny,bE,HF]=WN(Id),[WF,wE]=Ad(Id,[HF]),[VF,qF]=WF(Id),kE=v.forwardRef((t,e)=>c.jsx(Ny.Provider,{scope:t.__scopeRovingFocusGroup,children:c.jsx(Ny.Slot,{scope:t.__scopeRovingFocusGroup,children:c.jsx(KF,{...t,ref:e})})}));kE.displayName=Id;var KF=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:r=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=v.useRef(null),p=us(e,f),w=VN(i),[x,y]=UN({prop:o,defaultProp:a??null,onChange:l,caller:Id}),[g,m]=v.useState(!1),b=mi(u),k=bE(n),_=v.useRef(!1),[C,S]=v.useState(0);return v.useEffect(()=>{const j=f.current;if(j)return j.addEventListener(gg,b),()=>j.removeEventListener(gg,b)},[b]),c.jsx(VF,{scope:n,orientation:s,dir:w,loop:r,currentTabStopId:x,onItemFocus:v.useCallback(j=>y(j),[y]),onItemShiftTab:v.useCallback(()=>m(!0),[]),onFocusableItemAdd:v.useCallback(()=>S(j=>j+1),[]),onFocusableItemRemove:v.useCallback(()=>S(j=>j-1),[]),children:c.jsx(Wn.div,{tabIndex:g||C===0?-1:0,"data-orientation":s,...h,ref:p,style:{outline:"none",...t.style},onMouseDown:tt(t.onMouseDown,()=>{_.current=!0}),onFocus:tt(t.onFocus,j=>{const E=!_.current;if(j.target===j.currentTarget&&E&&!g){const P=new CustomEvent(gg,UF);if(j.currentTarget.dispatchEvent(P),!P.defaultPrevented){const L=k().filter(F=>F.focusable),I=L.find(F=>F.active),O=L.find(F=>F.id===x),D=[I,O,...L].filter(Boolean).map(F=>F.ref.current);jE(D,d)}}_.current=!1}),onBlur:tt(t.onBlur,()=>m(!1))})})}),_E="RovingFocusGroupItem",SE=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:r=!1,tabStopId:i,children:o,...a}=t,l=_y(),u=i||l,d=qF(_E,n),h=d.currentTabStopId===u,f=bE(n),{onFocusableItemAdd:p,onFocusableItemRemove:w,currentTabStopId:x}=d;return v.useEffect(()=>{if(s)return p(),()=>w()},[s,p,w]),c.jsx(Ny.ItemSlot,{scope:n,id:u,focusable:s,active:r,children:c.jsx(Wn.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...a,ref:e,onMouseDown:tt(t.onMouseDown,y=>{s?d.onItemFocus(u):y.preventDefault()}),onFocus:tt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:tt(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){d.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const g=QF(y,d.orientation,d.dir);if(g!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let b=f().filter(k=>k.focusable).map(k=>k.ref.current);if(g==="last")b.reverse();else if(g==="prev"||g==="next"){g==="prev"&&b.reverse();const k=b.indexOf(y.currentTarget);b=d.loop?XF(b,k+1):b.slice(k+1)}setTimeout(()=>jE(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});SE.displayName=_E;var GF={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function YF(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function QF(t,e,n){const s=YF(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return GF[s]}function jE(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function XF(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var JF=kE,ZF=SE;function ez(t){const e=tz(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(sz);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function tz(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=iz(r),a=rz(i,r.props);return r.type!==v.Fragment&&(a.ref=s?Oa(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var nz=Symbol("radix.slottable");function sz(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===nz}function rz(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function iz(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var oz=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ja=new WeakMap,Rh=new WeakMap,Ah={},xg=0,CE=function(t){return t&&(t.host||CE(t.parentNode))},az=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=CE(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},lz=function(t,e,n,s){var r=az(e,Array.isArray(t)?t:[t]);Ah[n]||(Ah[n]=new WeakMap);var i=Ah[n],o=[],a=new Set,l=new Set(r),u=function(h){!h||a.has(h)||(a.add(h),u(h.parentNode))};r.forEach(u);var d=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))d(f);else try{var p=f.getAttribute(s),w=p!==null&&p!=="false",x=(Ja.get(f)||0)+1,y=(i.get(f)||0)+1;Ja.set(f,x),i.set(f,y),o.push(f),x===1&&w&&Rh.set(f,!0),y===1&&f.setAttribute(n,"true"),w||f.setAttribute(s,"true")}catch(g){console.error("aria-hidden: cannot operate on ",f,g)}})};return d(e),a.clear(),xg++,function(){o.forEach(function(h){var f=Ja.get(h)-1,p=i.get(h)-1;Ja.set(h,f),i.set(h,p),f||(Rh.has(h)||h.removeAttribute(s),Rh.delete(h)),p||h.removeAttribute(n)}),xg--,xg||(Ja=new WeakMap,Ja=new WeakMap,Rh=new WeakMap,Ah={})}},cz=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=oz(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),lz(s,r,n,"aria-hidden")):function(){return null}},_f="right-scroll-bar-position",Sf="width-before-scroll-bar",uz="with-scroll-bars-hidden",dz="--removed-body-scroll-bar-size";function yg(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function hz(t,e){var n=v.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var r=n.value;r!==s&&(n.value=s,n.callback(s,r))}}}})[0];return n.callback=e,n.facade}var fz=typeof window<"u"?v.useLayoutEffect:v.useEffect,Qk=new WeakMap;function pz(t,e){var n=hz(null,function(s){return t.forEach(function(r){return yg(r,s)})});return fz(function(){var s=Qk.get(n);if(s){var r=new Set(s),i=new Set(t),o=n.current;r.forEach(function(a){i.has(a)||yg(a,null)}),i.forEach(function(a){r.has(a)||yg(a,o)})}Qk.set(n,t)},[t]),n}function mz(t){return t}function gz(t,e){e===void 0&&(e=mz);var n=[],s=!1,r={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,s);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(s=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){s=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return r}function xz(t){t===void 0&&(t={});var e=gz(null);return e.options=Mr({async:!0,ssr:!1},t),e}var NE=function(t){var e=t.sideCar,n=mc(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return v.createElement(s,Mr({},n))};NE.isSideCarExport=!0;function yz(t,e){return t.useMedium(e),NE}var EE=xz(),vg=function(){},tm=v.forwardRef(function(t,e){var n=v.useRef(null),s=v.useState({onScrollCapture:vg,onWheelCapture:vg,onTouchMoveCapture:vg}),r=s[0],i=s[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,p=t.noRelative,w=t.noIsolation,x=t.inert,y=t.allowPinchZoom,g=t.as,m=g===void 0?"div":g,b=t.gapMode,k=mc(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=f,C=pz([n,e]),S=Mr(Mr({},k),r);return v.createElement(v.Fragment,null,d&&v.createElement(_,{sideCar:EE,removeScrollBar:u,shards:h,noRelative:p,noIsolation:w,inert:x,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:b}),o?v.cloneElement(v.Children.only(a),Mr(Mr({},S),{ref:C})):v.createElement(m,Mr({},S,{className:l,ref:C}),a))});tm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};tm.classNames={fullWidth:Sf,zeroRight:_f};var vz=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function bz(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=vz();return e&&t.setAttribute("nonce",e),t}function wz(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function kz(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var _z=function(){var t=0,e=null;return{add:function(n){t==0&&(e=bz())&&(wz(e,n),kz(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Sz=function(){var t=_z();return function(e,n){v.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},TE=function(){var t=Sz(),e=function(n){var s=n.styles,r=n.dynamic;return t(s,r),null};return e},jz={left:0,top:0,right:0,gap:0},bg=function(t){return parseInt(t||"",10)||0},Cz=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[bg(n),bg(s),bg(r)]},Nz=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return jz;var e=Cz(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},Ez=TE(),Ol="data-scroll-locked",Tz=function(t,e,n,s){var r=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(uz,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(a,"px ").concat(s,`;
  }
  body[`).concat(Ol,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(_f,` {
    right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(Sf,` {
    margin-right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(_f," .").concat(_f,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Sf," .").concat(Sf,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Ol,`] {
    `).concat(dz,": ").concat(a,`px;
  }
`)},Xk=function(){var t=parseInt(document.body.getAttribute(Ol)||"0",10);return isFinite(t)?t:0},Pz=function(){v.useEffect(function(){return document.body.setAttribute(Ol,(Xk()+1).toString()),function(){var t=Xk()-1;t<=0?document.body.removeAttribute(Ol):document.body.setAttribute(Ol,t.toString())}},[])},Rz=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,r=s===void 0?"margin":s;Pz();var i=v.useMemo(function(){return Nz(r)},[r]);return v.createElement(Ez,{styles:Tz(i,!e,r,n?"":"!important")})},Ey=!1;if(typeof window<"u")try{var Oh=Object.defineProperty({},"passive",{get:function(){return Ey=!0,!0}});window.addEventListener("test",Oh,Oh),window.removeEventListener("test",Oh,Oh)}catch{Ey=!1}var Za=Ey?{passive:!1}:!1,Az=function(t){return t.tagName==="TEXTAREA"},PE=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Az(t)&&n[e]==="visible")},Oz=function(t){return PE(t,"overflowY")},Mz=function(t){return PE(t,"overflowX")},Jk=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var r=RE(t,s);if(r){var i=AE(t,s),o=i[1],a=i[2];if(o>a)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},Iz=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},Dz=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},RE=function(t,e){return t==="v"?Oz(e):Mz(e)},AE=function(t,e){return t==="v"?Iz(e):Dz(e)},Lz=function(t,e){return t==="h"&&e==="rtl"?-1:1},$z=function(t,e,n,s,r){var i=Lz(t,window.getComputedStyle(e).direction),o=i*s,a=n.target,l=e.contains(a),u=!1,d=o>0,h=0,f=0;do{if(!a)break;var p=AE(t,a),w=p[0],x=p[1],y=p[2],g=x-y-i*w;(w||g)&&RE(t,a)&&(h+=g,f+=w);var m=a.parentNode;a=m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE?m.host:m}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(d&&Math.abs(h)<1||!d&&Math.abs(f)<1)&&(u=!0),u},Mh=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Zk=function(t){return[t.deltaX,t.deltaY]},e_=function(t){return t&&"current"in t?t.current:t},Fz=function(t,e){return t[0]===e[0]&&t[1]===e[1]},zz=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Bz=0,el=[];function Uz(t){var e=v.useRef([]),n=v.useRef([0,0]),s=v.useRef(),r=v.useState(Bz++)[0],i=v.useState(TE)[0],o=v.useRef(t);v.useEffect(function(){o.current=t},[t]),v.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var x=YI([t.lockRef.current],(t.shards||[]).map(e_),!0).filter(Boolean);return x.forEach(function(y){return y.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),x.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=v.useCallback(function(x,y){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var g=Mh(x),m=n.current,b="deltaX"in x?x.deltaX:m[0]-g[0],k="deltaY"in x?x.deltaY:m[1]-g[1],_,C=x.target,S=Math.abs(b)>Math.abs(k)?"h":"v";if("touches"in x&&S==="h"&&C.type==="range")return!1;var j=window.getSelection(),E=j&&j.anchorNode,P=E?E===C||E.contains(C):!1;if(P)return!1;var L=Jk(S,C);if(!L)return!0;if(L?_=S:(_=S==="v"?"h":"v",L=Jk(S,C)),!L)return!1;if(!s.current&&"changedTouches"in x&&(b||k)&&(s.current=_),!_)return!0;var I=s.current||_;return $z(I,y,x,I==="h"?b:k)},[]),l=v.useCallback(function(x){var y=x;if(!(!el.length||el[el.length-1]!==i)){var g="deltaY"in y?Zk(y):Mh(y),m=e.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&Fz(_.delta,g)})[0];if(m&&m.should){y.cancelable&&y.preventDefault();return}if(!m){var b=(o.current.shards||[]).map(e_).filter(Boolean).filter(function(_){return _.contains(y.target)}),k=b.length>0?a(y,b[0]):!o.current.noIsolation;k&&y.cancelable&&y.preventDefault()}}},[]),u=v.useCallback(function(x,y,g,m){var b={name:x,delta:y,target:g,should:m,shadowParent:Hz(g)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(k){return k!==b})},1)},[]),d=v.useCallback(function(x){n.current=Mh(x),s.current=void 0},[]),h=v.useCallback(function(x){u(x.type,Zk(x),x.target,a(x,t.lockRef.current))},[]),f=v.useCallback(function(x){u(x.type,Mh(x),x.target,a(x,t.lockRef.current))},[]);v.useEffect(function(){return el.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Za),document.addEventListener("touchmove",l,Za),document.addEventListener("touchstart",d,Za),function(){el=el.filter(function(x){return x!==i}),document.removeEventListener("wheel",l,Za),document.removeEventListener("touchmove",l,Za),document.removeEventListener("touchstart",d,Za)}},[]);var p=t.removeScrollBar,w=t.inert;return v.createElement(v.Fragment,null,w?v.createElement(i,{styles:zz(r)}):null,p?v.createElement(Rz,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Hz(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Wz=yz(EE,Uz);var OE=v.forwardRef(function(t,e){return v.createElement(tm,Mr({},t,{ref:e,sideCar:Wz}))});OE.classNames=tm.classNames;var Ty=["Enter"," "],Vz=["ArrowDown","PageUp","Home"],ME=["ArrowUp","PageDown","End"],qz=[...Vz,...ME],Kz={ltr:[...Ty,"ArrowRight"],rtl:[...Ty,"ArrowLeft"]},Gz={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Dd="Menu",[Qu,Yz,Qz]=WN(Dd),[Ia,IE]=Ad(Dd,[Qz,uE,wE]),nm=uE(),DE=wE(),[Xz,Da]=Ia(Dd),[Jz,Ld]=Ia(Dd),LE=t=>{const{__scopeMenu:e,open:n=!1,children:s,dir:r,onOpenChange:i,modal:o=!0}=t,a=nm(e),[l,u]=v.useState(null),d=v.useRef(!1),h=mi(i),f=VN(r);return v.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",w,{capture:!0,once:!0}),document.addEventListener("pointermove",w,{capture:!0,once:!0})},w=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",w,{capture:!0}),document.removeEventListener("pointermove",w,{capture:!0})}},[]),c.jsx(MF,{...a,children:c.jsx(Xz,{scope:e,open:n,onOpenChange:h,content:l,onContentChange:u,children:c.jsx(Jz,{scope:e,onClose:v.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:s})})})};LE.displayName=Dd;var Zz="MenuAnchor",b0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=nm(n);return c.jsx(IF,{...r,...s,ref:e})});b0.displayName=Zz;var w0="MenuPortal",[e3,$E]=Ia(w0,{forceMount:void 0}),FE=t=>{const{__scopeMenu:e,forceMount:n,children:s,container:r}=t,i=Da(w0,e);return c.jsx(e3,{scope:e,forceMount:n,children:c.jsx(Md,{present:n||i.open,children:c.jsx(vE,{asChild:!0,container:r,children:s})})})};FE.displayName=w0;var Hs="MenuContent",[t3,k0]=Ia(Hs),zE=v.forwardRef((t,e)=>{const n=$E(Hs,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Da(Hs,t.__scopeMenu),o=Ld(Hs,t.__scopeMenu);return c.jsx(Qu.Provider,{scope:t.__scopeMenu,children:c.jsx(Md,{present:s||i.open,children:c.jsx(Qu.Slot,{scope:t.__scopeMenu,children:o.modal?c.jsx(n3,{...r,ref:e}):c.jsx(s3,{...r,ref:e})})})})}),n3=v.forwardRef((t,e)=>{const n=Da(Hs,t.__scopeMenu),s=v.useRef(null),r=us(e,s);return v.useEffect(()=>{const i=s.current;if(i)return cz(i)},[]),c.jsx(_0,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:tt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),s3=v.forwardRef((t,e)=>{const n=Da(Hs,t.__scopeMenu);return c.jsx(_0,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),r3=ez("MenuContent.ScrollLock"),_0=v.forwardRef((t,e)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:w,...x}=t,y=Da(Hs,n),g=Ld(Hs,n),m=nm(n),b=DE(n),k=Yz(n),[_,C]=v.useState(null),S=v.useRef(null),j=us(e,S,y.onContentChange),E=v.useRef(0),P=v.useRef(""),L=v.useRef(0),I=v.useRef(null),O=v.useRef("right"),$=v.useRef(0),D=w?OE:v.Fragment,F=w?{as:r3,allowPinchZoom:!0}:void 0,K=R=>{var Y,U;const V=P.current+R,G=k().filter(J=>!J.disabled),Q=document.activeElement,re=(Y=G.find(J=>J.ref.current===Q))==null?void 0:Y.textValue,ee=G.map(J=>J.textValue),z=g3(ee,V,re),A=(U=G.find(J=>J.textValue===z))==null?void 0:U.ref.current;(function J(be){P.current=be,window.clearTimeout(E.current),be!==""&&(E.current=window.setTimeout(()=>J(""),1e3))})(V),A&&setTimeout(()=>A.focus())};v.useEffect(()=>()=>window.clearTimeout(E.current),[]),i$();const T=v.useCallback(R=>{var G,Q;return O.current===((G=I.current)==null?void 0:G.side)&&y3(R,(Q=I.current)==null?void 0:Q.area)},[]);return c.jsx(t3,{scope:n,searchRef:P,onItemEnter:v.useCallback(R=>{T(R)&&R.preventDefault()},[T]),onItemLeave:v.useCallback(R=>{var V;T(R)||((V=S.current)==null||V.focus(),C(null))},[T]),onTriggerLeave:v.useCallback(R=>{T(R)&&R.preventDefault()},[T]),pointerGraceTimerRef:L,onPointerGraceIntentChange:v.useCallback(R=>{I.current=R},[]),children:c.jsx(D,{...F,children:c.jsx(YN,{asChild:!0,trapped:r,onMountAutoFocus:tt(i,R=>{var V;R.preventDefault(),(V=S.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:c.jsx(KN,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:c.jsx(JF,{asChild:!0,...b,dir:g.dir,orientation:"vertical",loop:s,currentTabStopId:_,onCurrentTabStopIdChange:C,onEntryFocus:tt(l,R=>{g.isUsingKeyboardRef.current||R.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(DF,{role:"menu","aria-orientation":"vertical","data-state":n2(y.open),"data-radix-menu-content":"",dir:g.dir,...m,...x,ref:j,style:{outline:"none",...x.style},onKeyDown:tt(x.onKeyDown,R=>{const G=R.target.closest("[data-radix-menu-content]")===R.currentTarget,Q=R.ctrlKey||R.altKey||R.metaKey,re=R.key.length===1;G&&(R.key==="Tab"&&R.preventDefault(),!Q&&re&&K(R.key));const ee=S.current;if(R.target!==ee||!qz.includes(R.key))return;R.preventDefault();const A=k().filter(Y=>!Y.disabled).map(Y=>Y.ref.current);ME.includes(R.key)&&A.reverse(),p3(A)}),onBlur:tt(t.onBlur,R=>{R.currentTarget.contains(R.target)||(window.clearTimeout(E.current),P.current="")}),onPointerMove:tt(t.onPointerMove,Xu(R=>{const V=R.target,G=$.current!==R.clientX;if(R.currentTarget.contains(V)&&G){const Q=R.clientX>$.current?"right":"left";O.current=Q,$.current=R.clientX}}))})})})})})})});zE.displayName=Hs;var i3="MenuGroup",S0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{role:"group",...s,ref:e})});S0.displayName=i3;var o3="MenuLabel",BE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{...s,ref:e})});BE.displayName=o3;var fp="MenuItem",t_="menu.itemSelect",sm=v.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:s,...r}=t,i=v.useRef(null),o=Ld(fp,t.__scopeMenu),a=k0(fp,t.__scopeMenu),l=us(e,i),u=v.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(t_,{bubbles:!0,cancelable:!0});h.addEventListener(t_,p=>s==null?void 0:s(p),{once:!0}),HN(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return c.jsx(UE,{...r,ref:l,disabled:n,onClick:tt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:tt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:tt(t.onKeyDown,h=>{const f=a.searchRef.current!=="";n||f&&h.key===" "||Ty.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});sm.displayName=fp;var UE=v.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:s=!1,textValue:r,...i}=t,o=k0(fp,n),a=DE(n),l=v.useRef(null),u=us(e,l),[d,h]=v.useState(!1),[f,p]=v.useState("");return v.useEffect(()=>{const w=l.current;w&&p((w.textContent??"").trim())},[i.children]),c.jsx(Qu.ItemSlot,{scope:n,disabled:s,textValue:r??f,children:c.jsx(ZF,{asChild:!0,...a,focusable:!s,children:c.jsx(Wn.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:u,onPointerMove:tt(t.onPointerMove,Xu(w=>{s?o.onItemLeave(w):(o.onItemEnter(w),w.defaultPrevented||w.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:tt(t.onPointerLeave,Xu(w=>o.onItemLeave(w))),onFocus:tt(t.onFocus,()=>h(!0)),onBlur:tt(t.onBlur,()=>h(!1))})})})}),a3="MenuCheckboxItem",HE=v.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:s,...r}=t;return c.jsx(GE,{scope:t.__scopeMenu,checked:n,children:c.jsx(sm,{role:"menuitemcheckbox","aria-checked":pp(n)?"mixed":n,...r,ref:e,"data-state":C0(n),onSelect:tt(r.onSelect,()=>s==null?void 0:s(pp(n)?!0:!n),{checkForDefaultPrevented:!1})})})});HE.displayName=a3;var WE="MenuRadioGroup",[l3,c3]=Ia(WE,{value:void 0,onValueChange:()=>{}}),VE=v.forwardRef((t,e)=>{const{value:n,onValueChange:s,...r}=t,i=mi(s);return c.jsx(l3,{scope:t.__scopeMenu,value:n,onValueChange:i,children:c.jsx(S0,{...r,ref:e})})});VE.displayName=WE;var qE="MenuRadioItem",KE=v.forwardRef((t,e)=>{const{value:n,...s}=t,r=c3(qE,t.__scopeMenu),i=n===r.value;return c.jsx(GE,{scope:t.__scopeMenu,checked:i,children:c.jsx(sm,{role:"menuitemradio","aria-checked":i,...s,ref:e,"data-state":C0(i),onSelect:tt(s.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});KE.displayName=qE;var j0="MenuItemIndicator",[GE,u3]=Ia(j0,{checked:!1}),YE=v.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:s,...r}=t,i=u3(j0,n);return c.jsx(Md,{present:s||pp(i.checked)||i.checked===!0,children:c.jsx(Wn.span,{...r,ref:e,"data-state":C0(i.checked)})})});YE.displayName=j0;var d3="MenuSeparator",QE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Wn.div,{role:"separator","aria-orientation":"horizontal",...s,ref:e})});QE.displayName=d3;var h3="MenuArrow",XE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=nm(n);return c.jsx(LF,{...r,...s,ref:e})});XE.displayName=h3;var f3="MenuSub",[p7,JE]=Ia(f3),Jc="MenuSubTrigger",ZE=v.forwardRef((t,e)=>{const n=Da(Jc,t.__scopeMenu),s=Ld(Jc,t.__scopeMenu),r=JE(Jc,t.__scopeMenu),i=k0(Jc,t.__scopeMenu),o=v.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,u={__scopeMenu:t.__scopeMenu},d=v.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return v.useEffect(()=>d,[d]),v.useEffect(()=>{const h=a.current;return()=>{window.clearTimeout(h),l(null)}},[a,l]),c.jsx(b0,{asChild:!0,...u,children:c.jsx(UE,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":n2(n.open),...t,ref:Oa(e,r.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:tt(t.onPointerMove,Xu(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:tt(t.onPointerLeave,Xu(h=>{var p,w;d();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const x=(w=n.content)==null?void 0:w.dataset.side,y=x==="right",g=y?-5:5,m=f[y?"left":"right"],b=f[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+g,y:h.clientY},{x:m,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:m,y:f.bottom}],side:x}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:tt(t.onKeyDown,h=>{var p;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||Kz[s.dir].includes(h.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),h.preventDefault())})})})});ZE.displayName=Jc;var e2="MenuSubContent",t2=v.forwardRef((t,e)=>{const n=$E(Hs,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Da(Hs,t.__scopeMenu),o=Ld(Hs,t.__scopeMenu),a=JE(e2,t.__scopeMenu),l=v.useRef(null),u=us(e,l);return c.jsx(Qu.Provider,{scope:t.__scopeMenu,children:c.jsx(Md,{present:s||i.open,children:c.jsx(Qu.Slot,{scope:t.__scopeMenu,children:c.jsx(_0,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:tt(t.onFocusOutside,d=>{d.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:tt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:tt(t.onKeyDown,d=>{var p;const h=d.currentTarget.contains(d.target),f=Gz[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(p=a.trigger)==null||p.focus(),d.preventDefault())})})})})})});t2.displayName=e2;function n2(t){return t?"open":"closed"}function pp(t){return t==="indeterminate"}function C0(t){return pp(t)?"indeterminate":t?"checked":"unchecked"}function p3(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function m3(t,e){return t.map((n,s)=>t[(e+s)%t.length])}function g3(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=m3(t,Math.max(i,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function x3(t,e){const{x:n,y:s}=t;let r=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],u=a.x,d=a.y,h=l.x,f=l.y;d>s!=f>s&&n<(h-u)*(s-d)/(f-d)+u&&(r=!r)}return r}function y3(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return x3(n,e)}function Xu(t){return e=>e.pointerType==="mouse"?t(e):void 0}var v3=LE,b3=b0,w3=FE,k3=zE,_3=S0,S3=BE,j3=sm,C3=HE,N3=VE,E3=KE,T3=YE,P3=QE,R3=XE,A3=ZE,O3=t2,rm="DropdownMenu",[M3]=Ad(rm,[IE]),Vn=IE(),[I3,s2]=M3(rm),r2=t=>{const{__scopeDropdownMenu:e,children:n,dir:s,open:r,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=Vn(e),u=v.useRef(null),[d,h]=UN({prop:r,defaultProp:i??!1,onChange:o,caller:rm});return c.jsx(I3,{scope:e,triggerId:_y(),triggerRef:u,contentId:_y(),open:d,onOpenChange:h,onOpenToggle:v.useCallback(()=>h(f=>!f),[h]),modal:a,children:c.jsx(v3,{...l,open:d,onOpenChange:h,dir:s,modal:a,children:n})})};r2.displayName=rm;var i2="DropdownMenuTrigger",o2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...r}=t,i=s2(i2,n),o=Vn(n);return c.jsx(b3,{asChild:!0,...o,children:c.jsx(Wn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...r,ref:Oa(e,i.triggerRef),onPointerDown:tt(t.onPointerDown,a=>{!s&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:tt(t.onKeyDown,a=>{s||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});o2.displayName=i2;var D3="DropdownMenuPortal",a2=t=>{const{__scopeDropdownMenu:e,...n}=t,s=Vn(e);return c.jsx(w3,{...s,...n})};a2.displayName=D3;var l2="DropdownMenuContent",c2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=s2(l2,n),i=Vn(n),o=v.useRef(!1);return c.jsx(k3,{id:r.contentId,"aria-labelledby":r.triggerId,...i,...s,ref:e,onCloseAutoFocus:tt(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:tt(t.onInteractOutside,a=>{const l=a.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;(!r.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});c2.displayName=l2;var L3="DropdownMenuGroup",$3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(_3,{...r,...s,ref:e})});$3.displayName=L3;var F3="DropdownMenuLabel",u2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(S3,{...r,...s,ref:e})});u2.displayName=F3;var z3="DropdownMenuItem",d2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(j3,{...r,...s,ref:e})});d2.displayName=z3;var B3="DropdownMenuCheckboxItem",U3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(C3,{...r,...s,ref:e})});U3.displayName=B3;var H3="DropdownMenuRadioGroup",W3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(N3,{...r,...s,ref:e})});W3.displayName=H3;var V3="DropdownMenuRadioItem",q3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(E3,{...r,...s,ref:e})});q3.displayName=V3;var K3="DropdownMenuItemIndicator",G3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(T3,{...r,...s,ref:e})});G3.displayName=K3;var Y3="DropdownMenuSeparator",h2=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(P3,{...r,...s,ref:e})});h2.displayName=Y3;var Q3="DropdownMenuArrow",X3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(R3,{...r,...s,ref:e})});X3.displayName=Q3;var J3="DropdownMenuSubTrigger",Z3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(A3,{...r,...s,ref:e})});Z3.displayName=J3;var eB="DropdownMenuSubContent",tB=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Vn(n);return c.jsx(O3,{...r,...s,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});tB.displayName=eB;var nB=r2,sB=o2,rB=a2,iB=c2,oB=u2,aB=d2,lB=h2;const im=nB,om=sB,$d=ve.forwardRef(({className:t,sideOffset:e=8,...n},s)=>c.jsx(rB,{children:c.jsx(iB,{ref:s,sideOffset:e,className:Pe("z-[90] min-w-[220px] overflow-hidden rounded-2xl p-1","bg-white/75 dark:bg-black/40 backdrop-blur-md shadow-soft2","ring-1 ring-black/5 dark:ring-white/10",t),...n})}));$d.displayName="DropdownMenuContent";const f2=ve.forwardRef(({className:t,...e},n)=>c.jsx(oB,{ref:n,className:Pe("px-3 py-2 text-xs text-black/60 dark:text-white/60",t),...e}));f2.displayName="DropdownMenuLabel";const mp=ve.forwardRef(({className:t,...e},n)=>c.jsx(lB,{ref:n,className:Pe("my-1 h-px bg-black/5 dark:bg-white/10",t),...e}));mp.displayName="DropdownMenuSeparator";const Ju=ve.forwardRef(({className:t,inset:e,...n},s)=>c.jsx(aB,{ref:s,className:Pe("relative flex cursor-default select-none items-center gap-2 rounded-xl px-3 py-2 text-sm outline-none","text-black/90 dark:text-white/90","focus:bg-black/5 dark:focus:bg-white/10",e&&"pl-8",t),...n}));Ju.displayName="DropdownMenuItem";function An({className:t,variant:e="secondary",...n}){return c.jsx(se,{variant:e,size:"icon",className:Pe("rounded-xl h-8 w-8",t),...n})}function Ns({open:t,onClose:e,title:n,children:s,maxWidth:r="520px"}){if(!t)return null;const i=c.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm px-4 py-6 overflow-y-auto",children:c.jsx("div",{className:"w-full",style:{maxWidth:r},children:c.jsxs("div",{className:"rounded-2xl bg-white/90 dark:bg-neutral-900/95 shadow-2xl ring-1 ring-black/10 dark:ring-white/10 max-h-[85vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-black/5 dark:border-white/10",children:[c.jsx("div",{className:"text-sm font-semibold",children:n}),c.jsx("button",{className:"text-black/60 dark:text-white/60 hover:opacity-100 opacity-70",onClick:e,children:""})]}),c.jsx("div",{className:"p-4 overflow-y-auto",children:s})]})})});return typeof document>"u"?i:jd.createPortal(i,document.body)}function vc({open:t,onClose:e,onConfirm:n,message:s}){return t?c.jsx(Ns,{open:t,onClose:e,title:"Confirm",maxWidth:"420px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-black/70 dark:text-white/70",children:s||"Are you sure?"}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:n,children:"Confirm"})]})]})}):null}const p2=v.createContext(null);function N0(){const t=v.useContext(p2);if(!t)throw new Error("useNotifications must be used inside NotificationsProvider");return t}function cB({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function uB(){const t=Ed(),{notifications:e,unreadCount:n,clearAll:s,dismissNotification:r,markRead:i,formatTime:o}=N0(),[a,l]=v.useState(null),u=v.useMemo(()=>e.slice(0,6),[e]);return c.jsxs(c.Fragment,{children:[c.jsxs(im,{children:[c.jsx(om,{asChild:!0,children:c.jsxs("button",{className:"relative flex h-9 w-9 items-center justify-center rounded-2xl bg-black/5 dark:bg-white/10 text-black/80 dark:text-white/80 shadow-soft","aria-label":"Notifications",children:[c.jsx(WM,{size:18}),n?c.jsx("span",{className:"absolute -right-1 -top-1 min-w-[18px] rounded-full bg-rose-500 px-1 text-[11px] font-semibold leading-4 text-white",children:n>99?"99+":n}):null]})}),c.jsxs($d,{align:"end",className:"w-[320px] p-0 bg-white/90 dark:bg-neutral-900/85",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold",children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:e.length?`${e.length} total`:"No alerts"})]}),c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:s,disabled:!e.length,children:"Clear all"})]}),c.jsx(mp,{}),c.jsx("div",{className:"max-h-[320px] overflow-y-auto p-2 space-y-2",children:u.length?u.map(d=>c.jsx("div",{className:Pe("rounded-xl px-3 py-2 ring-1 transition-colors",d.read?"bg-white/50 dark:bg-white/5 ring-black/5 dark:ring-white/10":"bg-black/5 dark:bg-white/10 ring-black/10 dark:ring-white/20"),children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:d.title||"Notification"}),d.message?c.jsx("div",{className:"mt-0.5 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:d.message}):null,d.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:o(d.created_at)}):null]}),c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx(An,{variant:"ghost",className:"h-7 w-7",onClick:()=>r(d.id),"aria-label":"Dismiss notification",children:c.jsx(s0,{size:14})}),c.jsx(An,{variant:"ghost",className:"h-7 w-7",onClick:()=>{i(d.id),l(d)},"aria-label":"View notification",children:c.jsx(oN,{size:14})})]})]})},d.id)):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 p-4 text-xs text-black/50 dark:text-white/60 text-center",children:"You're all caught up."})}),c.jsx(mp,{}),c.jsx("div",{className:"px-3 py-2",children:c.jsx(se,{variant:"secondary",className:"w-full rounded-2xl",onClick:()=>t("/app/notifications"),children:"View all notifications"})})]})]}),c.jsx(Ns,{open:!!a,onClose:()=>l(null),title:(a==null?void 0:a.title)||"Notification",maxWidth:"520px",children:c.jsx(cB,{notification:a})})]})}function zt({className:t,...e}){return c.jsx("div",{className:Pe("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 shadow-soft",t),...e})}function dB(){const{toasts:t,dismissToast:e,formatTime:n}=N0();return t.length?c.jsx("div",{className:"fixed right-6 top-24 z-50 flex w-[320px] flex-col gap-2",children:t.map(s=>{const r=s.notification;return c.jsx(zt,{className:"p-3 bg-white dark:bg-neutral-900 shadow-soft ring-1 ring-black/10 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:r.title||"Notification"}),r.message?c.jsx("div",{className:"mt-1 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:r.message}):null,r.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:n(r.created_at)}):null]}),c.jsx("button",{type:"button",className:"rounded-full p-1 text-black/50 hover:text-black/80 dark:text-white/50 dark:hover:text-white/80",onClick:()=>e(s.id),"aria-label":"Dismiss notification",children:c.jsx(s0,{size:14})})]})},s.id)})}):null}async function hB(){return De("/api/modules/accessible",{method:"GET"})}async function fB({limit:t,offset:e=0,newestFirst:n=!1,signal:s}={}){const r=new URLSearchParams;t!=null&&r.set("limit",t),e>0&&r.set("offset",e),n&&r.set("newest_first","true");const i=r.toString();return De(`/api/sales/chat/history${i?`?${i}`:""}`,{signal:s})}async function pB(t,e=[]){return De("/api/sales/chat/attachments/refresh",{method:"POST",body:JSON.stringify({file_ids:t,prefetch_ids:e})})}async function mB({conversationId:t,message:e,fileIds:n,onEvent:s,onChunk:r,onDone:i,onError:o,signal:a}){try{const l=gc(),u=Ma.API_BASE_URL||"",d=await fetch(`${u}/api/sales/chat/stream`,{method:"POST",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}},body:JSON.stringify({message:e,conversation_id:t,...n!=null&&n.length?{file_ids:n}:{}}),signal:a});if(d.status===401){li(),window.dispatchEvent(new CustomEvent("auth:logout")),o==null||o(new Error("Unauthorized"));return}if(!d.ok){const x=await d.json().catch(()=>({}));throw new Error(x.detail||`API error: ${d.status}`)}const h=d.body.getReader(),f=new TextDecoder;let p="",w=!1;for(;;){const{done:x,value:y}=await h.read();if(x)break;p+=f.decode(y,{stream:!0});const g=p.split(`
`);p=g.pop()||"";for(const m of g){const b=m.trim();if(!b.startsWith("data:"))continue;const k=b.replace(/^data:\s?/,"");if(!k||k==="[DONE]"){w=!0,i==null||i();continue}try{const _=JSON.parse(k);s==null||s(_),!s&&r&&(_.type==="chunk"||_.type==="content")&&r(_)}catch{const _={content:k};s==null||s(_),s||r==null||r(_)}}}w||i==null||i()}catch(l){throw o==null||o(l),l}}async function gB({requestId:t,eventIndex:e=0,onEvent:n,onDone:s,onError:r,onNotFound:i,signal:o}){try{const a=gc(),u=`${Ma.API_BASE_URL||""}/api/sales/chat/resume/${t}?event_index=${e}`,d=await fetch(u,{method:"GET",headers:{...a?{Authorization:`Bearer ${a}`}:{}},signal:o});if(d.status===401)return li(),window.dispatchEvent(new CustomEvent("auth:logout")),r==null||r(new Error("Unauthorized")),{status:"error"};if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(f.detail||`API error: ${d.status}`)}const h=d.headers.get("content-type")||"";if(h.includes("application/json")){const f=await d.json();if(f.status==="not_found")return i==null||i(),{status:"not_found"};if(f.status==="completed"){for(const p of f.events||[])n==null||n(p);return s==null||s(),{status:"completed",events:f.events}}return f}else if(h.includes("text/event-stream")){const f=d.body.getReader(),p=new TextDecoder;let w="",x=!1;for(;;){const{done:y,value:g}=await f.read();if(y)break;w+=p.decode(g,{stream:!0});const m=w.split(`
`);w=m.pop()||"";for(const b of m){const k=b.trim();if(!k.startsWith("data:"))continue;const _=k.replace(/^data:\s?/,"");if(!_||_==="[DONE]"){x=!0,s==null||s();continue}try{const C=JSON.parse(_);n==null||n(C)}catch{}}}return x||s==null||s(),{status:"streaming_completed"}}return{status:"unknown"}}catch(a){return a.name==="AbortError"?{status:"aborted"}:(r==null||r(a),{status:"error",error:a.message})}}async function xB(t){const e=new FormData;return e.append("file",t),De("/api/sales/files/upload",{method:"POST",body:e})}async function yB(){return De("/api/assets/asset-types")}async function n_(t,{timeOfDay:e,side:n,venueType:s}={}){const r=new URLSearchParams;e&&r.set("time_of_day",e),n&&r.set("side",n),s&&r.set("venue_type",s);const i=Array.isArray(t)?t[0]:t;return i?De(`/api/sales/mockup/templates/${encodeURIComponent(i)}?${r.toString()}`):[]}async function vB(t){return De("/api/sales/mockup/save-frame",{method:"POST",body:t})}async function bB(t){return De("/api/sales/mockup/update-frame",{method:"PUT",body:t})}async function wB(t,e,{timeOfDay:n,side:s}={}){const r=new URLSearchParams;return r.set("photo_filename",e),n&&r.set("time_of_day",n),s&&r.set("side",s),De(`/api/sales/mockup/photo/${t}?${r.toString()}`,{method:"DELETE"})}async function kB({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),i&&o.set("photo_filename",i);const a=encodeURIComponent(e);return De(`/api/assets/mockup-frames/${t}/${a}/frame?${o.toString()}`)}async function _B({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e||!i)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),o.set("photo_filename",i);const a=encodeURIComponent(e);return De(`/api/assets/mockup-frames/${t}/${a}?${o.toString()}`,{method:"DELETE"})}async function SB(t){return $N("/api/sales/mockup/test-preview",{method:"POST",body:t})}async function jB(t){return De("/api/sales/mockup/generate",{method:"POST",body:t})}async function m2(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){if(!t||!e)return null;const o=new URLSearchParams;o.set("photo_filename",e),n&&o.set("time_of_day",n),s&&o.set("side",s),r&&o.set("company",r),i&&o.set("venue_type",i);const a=`/api/sales/mockup/photo/${t}?${o.toString()}`;return $N(a)}async function CB(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){const o=await m2(t,e,{timeOfDay:n,side:s,company:r,venueType:i});return o?URL.createObjectURL(o):""}async function g2(){return De("/api/sales/mockup/eligibility/setup")}async function x2(){return De("/api/sales/mockup/eligibility/generate")}async function NB({service:t,displayType:e}={}){const n=new URLSearchParams;t&&n.set("service",t),e&&n.set("display_type",e);const s=n.toString();return De(`/api/sales/locations${s?`?${s}`:""}`)}async function EB(t){return t?De(`/api/sales/locations/${encodeURIComponent(t)}`):null}async function TB(t){return De("/api/sales/proposals",{method:"POST",body:JSON.stringify(t)})}async function PB(){return De("/api/sales/proposals/history")}async function RB({limit:t=100,offset:e=0}={}){return De("/api/rbac/users")}async function AB(t){return De(`/api/rbac/user/${t}`)}async function OB(t){return De(`/api/rbac/users/${t}/permissions`)}async function MB(t){return De("/api/rbac/users",{method:"POST",body:JSON.stringify(t)})}async function IB(t,e){return De(`/api/rbac/users/${t}`,{method:"PUT",body:JSON.stringify(e)})}async function DB(t){return De(`/api/rbac/users/${encodeURIComponent(t)}/deactivate`,{method:"POST"})}async function LB(t){return De(`/api/rbac/users/${encodeURIComponent(t)}/reactivate`,{method:"POST"})}async function $B(){return De("/api/rbac/profiles")}async function FB(t){return De("/api/rbac/profiles",{method:"POST",body:JSON.stringify(t)})}async function zB(t,e){return De(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function BB(t){return De(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"DELETE"})}async function s_(t,e){return De(`/api/rbac/users/${t}/permissions`,{method:"PUT",body:JSON.stringify({permissions:e})})}async function UB(){return await De("/api/rbac/permissions")}async function wg(t,e){return De("/api/rbac/permissions",{method:"POST",body:JSON.stringify({name:t,description:e})})}async function r_(t){return De(`/api/rbac/permissions/${encodeURIComponent(t)}`,{method:"DELETE"})}async function HB(){const t=await De("/api/rbac/companies");return t.companies||t}async function WB(t){return De("/api/assets/companies",{method:"POST",body:JSON.stringify(t)})}async function VB(t,e){return De(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function qB(t){return De(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"DELETE"})}async function KB(){return De("/api/rbac/permission-sets")}async function GB(t){return De("/api/rbac/permission-sets",{method:"POST",body:JSON.stringify(t)})}async function YB(t,e){return De(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function QB(t){return De(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"DELETE"})}async function E0(){return De("/api/admin/service-visibility")}async function XB(t){return De("/api/admin/service-visibility",{method:"PUT",body:JSON.stringify(t)})}const T0="mmg-notifications",Fd="/api/notifications";function JB(t,e){if(!t)return e;try{return JSON.parse(t)}catch{return e}}function lo(){if(typeof window>"u")return[];const t=window.localStorage.getItem(T0),e=JB(t,[]);return Array.isArray(e)?e:[]}function am(t){typeof window>"u"||window.localStorage.setItem(T0,JSON.stringify(t))}function i_(t){const e=new Date().toISOString();return{id:(t==null?void 0:t.id)||(typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`ntf_${Date.now()}_${Math.random().toString(16).slice(2,8)}`),title:(t==null?void 0:t.title)||"Notification",message:(t==null?void 0:t.message)||"",created_at:(t==null?void 0:t.created_at)||e,read:!!(t!=null&&t.read),level:(t==null?void 0:t.level)||"info",meta:(t==null?void 0:t.meta)||{}}}function ZB(t){return Array.isArray(t)?t:Array.isArray(t==null?void 0:t.notifications)?t.notifications:Array.isArray(t==null?void 0:t.data)?t.data:[]}function e4(){return De(Fd).then(t=>ZB(t)).catch(()=>lo())}function t4(t){return De(Fd,{method:"POST",body:JSON.stringify(t||{})}).then(e=>(e==null?void 0:e.notification)||(e==null?void 0:e.data)||e||i_(t)).catch(()=>{const e=lo(),n=i_(t),s=[n,...e];return am(s),n})}function n4(){return De(Fd,{method:"DELETE"}).then(()=>[]).catch(()=>(am([]),[]))}function s4(t){return t?De(`${Fd}/${encodeURIComponent(t)}`,{method:"DELETE"}).then(()=>lo()).catch(()=>{const e=lo().filter(n=>n.id!==t);return am(e),e}):Promise.resolve(lo())}function r4(t){return t?De(`${Fd}/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify({read:!0})}).then(()=>lo()).catch(()=>{const e=lo().map(n=>n.id===t?{...n,read:!0}:n);return am(e),e}):Promise.resolve(lo())}const i4=T0;function qs(t){if(!t||t==="NA")return null;if(t.includes("T")){const i=new Date(t);if(!Number.isNaN(i.getTime()))return i}const e=t.split(" "),n=e[0],s=e[1],r=n.split("-");if(r.length===3){const i=Number(r[0]),o=Number(r[1])-1,a=Number(r[2]);if(Number.isNaN(i)||Number.isNaN(o)||Number.isNaN(a))return null;if(s){const u=s.split(":"),d=Number(u[0]||0),h=Number(u[1]||0),f=Number(u[2]||0),p=new Date(a,o,i,d,h,f);return Number.isNaN(p.getTime())?null:p}const l=new Date(a,o,i);return l.setHours(0,0,0,0),Number.isNaN(l.getTime())?null:l}return null}function y2(t){var n;if(!((n=t==null?void 0:t.lifecycle)!=null&&n.length))return"";const e=t.lifecycle[t.lifecycle.length-1];return((e==null?void 0:e.stage)||"").toLowerCase()}function v2(t){const e={};return t.forEach(n=>{const s=n.videographer||n.Videographer||"Unassigned";e[s]||(e[s]=[]),e[s].push(n)}),e}function Ii(t){const e={pending:0,rejected:0,returned:0,submitted:0,accepted:0};return t.forEach(n=>{(n.versions||[]).forEach(s=>{const r=y2(s);r==="pending"||r==="critique"?e.pending+=1:r==="rejected"||r==="editing"?e.rejected+=1:r==="returned"?e.returned+=1:r==="submitted"||r==="submitted to sales"?e.submitted+=1:(r==="accepted"||r==="done")&&(e.accepted+=1)})}),e}function b2(t){const e=t.length,n=t.filter(a=>{const l=a.videographer||a.Videographer||"Unassigned";return l&&l!=="Unassigned"&&a.status!=="Not assigned yet"}).length;let s=0;t.forEach(a=>{s+=(a.versions||[]).length});const r=Ii(t),i=r.accepted+r.submitted+r.rejected+r.returned,o=i>0?Math.round((r.accepted+r.submitted)/i*100):0;return{total:e,assigned:n,uploads:s,pending:r.pending,rejected:r.rejected,returned:r.returned,submitted_to_sales:r.submitted,accepted_videos:r.accepted,accepted_pct:o}}function w2(t){const e=t.filter(n=>n.status==="Accepted"||n.status==="Done").length;return{completed:e,not_completed:t.length-e}}function o4(t){let e=0,n=0,s=0,r=0,i=0;t.forEach(d=>{(d.versions||[]).forEach(h=>{const f=h.lifecycle||[];if(f.length<2)return;let p=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="pending"||m==="critique"){p=qs(g.at);break}}let w=null,x=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="rejected"||m==="editing"||m==="accepted"||m==="submitted"||m==="submitted to sales"){w=qs(g.at),x=m;break}}if(!p||!w||!x)return;s+=1;const y=Math.round((w-p)/(1e3*60*60));if(e+=y,n+=1,x==="accepted"||x==="submitted"||x==="submitted to sales"){let g=!1,m=!1;f.forEach(b=>{const k=(b.stage||"").toLowerCase();(k==="accepted"||k==="done")&&(g=!0),k==="returned"&&(m=!0)}),g&&(r+=1),m&&(i+=1)}})});const o=n>0?Math.round(e/n):0,a=o>0?`${o} hrs`:"0 hrs",l=r+i,u=l>0?Math.round(r/l*100):0;return{avg_response_display:a,handled:s,accepted:r,handled_percent:u}}function k2(t){const e=v2(t),n={},s=new Date;return s.setHours(0,0,0,0),Object.entries(e).forEach(([r,i])=>{let o=0,a=0,l=0,u=0;i.forEach(p=>{(p.status==="Accepted"||p.status==="Done")&&(o+=1),a+=(p.versions||[]).length;const w=qs(p.filming_deadline||p.filming_date||"");w&&w<=s&&(u+=1);const x=qs(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(l+=1)});const d=Ii(i),h=d.accepted+d.submitted+d.rejected+d.returned,f=h>0?Math.round((d.accepted+d.submitted)/h*100):0;n[r]={total:i.length,started:u,late:l,completed:o,uploads:a,accepted_pct:f}}),n}function Zu(t,e){const n=[];return t.forEach(s=>{(s.versions||[]).forEach(r=>{const i=y2(r);(i==="submitted to sales"?"submitted":i)===e&&n.push({task:s,version:r,stage:i})})}),n}function kg(t,e){const n=[];return t.forEach(s=>{const r=[];(s.versions||[]).forEach(i=>{(i.lifecycle||[]).forEach(o=>{const a=(o.stage||"").toLowerCase();(e==="hod"&&(a==="rejected"||a==="editing")||e==="hos"&&a==="returned")&&r.push({version:i.version,event:o,stage:a})})}),r.length&&n.push({...s,rejectionEvents:r,rejectionCount:r.length})}),n}function _2(t){const e=Zu(t,"pending"),n=[];return e.forEach(({task:s,version:r})=>{let i=null;(r.lifecycle||[]).forEach(a=>{const l=(a.stage||"").toLowerCase();(l==="pending"||l==="critique")&&(i=qs(a.at))});const o=i?Math.round((Date.now()-i.getTime())/(1e3*60*60)):null;n.push({task:s,version:r,uploadTime:i,waitingHours:o})}),{count:n.length,reviews:n}}function S2(t){const e=[];return t.forEach(n=>{(n.versions||[]).forEach(s=>{let r=null,i=null,o=null,a=null,l=null;if((s.lifecycle||[]).forEach(u=>{const d=(u.stage||"").toLowerCase();!r&&(d==="pending"||d==="critique")&&(r=qs(u.at)),!i&&(d==="rejected"||d==="editing"||d==="accepted"||d==="submitted"||d==="submitted to sales")&&(i=qs(u.at),o=d,a=u.rejection_class||null,l=u.rejection_comments||null)}),r&&i&&o){const u=Math.round((i-r)/36e5);e.push({task:n,version:s,responseHours:u,uploadTime:r,reviewTime:i,decision:o,rejectionClass:a,comments:l})}})}),e}function j2(t){const e=b2(t),n=w2(t),s=new Date;s.setHours(0,0,0,0);let r=0,i=0,o=0,a=0,l=0,u=0;t.forEach(p=>{const w=qs(p.filming_deadline||p.filming_date||"");w&&w<=s&&(r+=1);const x=qs(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(i+=1),(p.status==="Accepted"||p.status==="Done")&&(a+=1,o+=(p.versions||[]).length),(p.versions||[]).forEach(y=>{(y.lifecycle||[]).forEach(g=>{const m=(g.stage||"").toLowerCase();(m==="rejected"||m==="editing")&&(l+=1),m==="returned"&&(u+=1)})})});const d=a>0?(o/a).toFixed(2):"0",h=Zu(t,"pending"),f=Zu(t,"submitted");return{summary:e,pie:n,tasksStarted:r,lateTasks:i,pendingHOD:h.length,pendingHOS:f.length,rejectionsByHOD:l,rejectionsByHOS:u,uploadRatio:d}}function _g(t){const e=qs(t.submission_date||"");if(!e)return!1;const n=new Date;return n.setHours(0,0,0,0),e<n&&t.status!=="Accepted"&&t.status!=="Done"}const wr=[{task_number:2217,brand:"City Brand Launch",filming_deadline:"17-02-2025",submission_date:"20-02-2025",status:"Critique",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"18-02-2025 10:00:00"}]}]},{task_number:2216,brand:"Mall LED Loop",filming_deadline:"16-02-2025",submission_date:"19-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"17-02-2025 09:00:00"},{stage:"submitted to sales",at:"18-02-2025 11:30:00"}]}]},{task_number:2215,brand:"Festival Teaser",filming_deadline:"15-02-2025",submission_date:"18-02-2025",status:"Returned",videographer:"Alyssa Reed",location:"Abu Dhabi",versions:[{version:1,lifecycle:[{stage:"pending",at:"15-02-2025 10:00:00"},{stage:"submitted",at:"16-02-2025 12:00:00"},{stage:"returned",at:"17-02-2025 15:30:00",rejection_class:"Lighting",rejection_comments:"Exposure too dark",rejected_by:"Head of Sales"}]}]},{task_number:2214,brand:"Luxury Auto Montage",filming_deadline:"14-02-2025",submission_date:"17-02-2025",status:"Editing",videographer:"Noah Chen",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"14-02-2025 09:30:00"},{stage:"rejected",at:"15-02-2025 12:10:00",rejection_class:"Artwork Color",rejection_comments:"Incorrect color profile",rejected_by:"Reviewer"}]}]},{task_number:2213,brand:"Airport Arrival Hero",filming_deadline:"12-02-2025",submission_date:"15-02-2025",status:"Accepted",videographer:"Noah Chen",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"12-02-2025 10:00:00"},{stage:"submitted to sales",at:"13-02-2025 15:00:00"},{stage:"accepted",at:"14-02-2025 12:00:00"}]}]},{task_number:2212,brand:"Retail Weekend Promo",filming_deadline:"10-02-2025",submission_date:"13-02-2025",status:"Done",videographer:"Ravi Sharma",location:"Ajman",versions:[{version:1,lifecycle:[{stage:"pending",at:"10-02-2025 10:00:00"},{stage:"submitted",at:"11-02-2025 14:00:00"},{stage:"done",at:"12-02-2025 10:00:00"}]}]},{task_number:2211,brand:"Harbor Night Loop",filming_deadline:"18-02-2025",submission_date:"21-02-2025",status:"Editing",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"16-02-2025 11:00:00"},{stage:"editing",at:"17-02-2025 13:00:00",rejection_class:"Environment Too Dark",rejection_comments:"Please brighten the surrounding scene",rejected_by:"Reviewer"}]}]},{task_number:2210,brand:"City Center Countdown",filming_deadline:"22-02-2025",submission_date:"25-02-2025",status:"Assigned to Alyssa",videographer:"Alyssa Reed",location:"Dubai",versions:[]},{task_number:2209,brand:"Expo Walkthrough",filming_deadline:"24-02-2025",submission_date:"27-02-2025",status:"Not assigned yet",videographer:"Unassigned",location:"Abu Dhabi",versions:[]},{task_number:2208,brand:"Weekend Highlights",filming_deadline:"13-02-2025",submission_date:"16-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"13-02-2025 09:00:00"},{stage:"rejected",at:"14-02-2025 10:30:00",rejection_class:"Lighting",rejection_comments:"Flicker in the panel",rejected_by:"Reviewer"}]},{version:2,lifecycle:[{stage:"pending",at:"15-02-2025 12:15:00"},{stage:"submitted",at:"16-02-2025 14:40:00"}]}]}],a4={session_id:"vc-session-01",messages:[{id:"vc-msg-1",role:"assistant",content:"Good morning. Upload a cut or describe the request, and I will log the critique, checklist, and next steps.",timestamp:"2025-02-18T08:40:12+04:00"}],message_count:1,last_updated:"2025-02-18T08:40:12+04:00"},l4=[{workflow_id:"workflow-2217",task_number:2217,folder_name:"City Brand Launch",status:"pending_reviewer",created_at:"2025-02-18T09:10:00+04:00",reviewer_approved:!1,hos_approved:!1}];function mr(t){return new Promise(e=>setTimeout(e,t))}function c4(t,e){const n=[];let s=0;for(;s<t.length;)n.push(t.slice(s,s+e)),s+=e;return n}function P0(t,e){const n=(t||"").trim();return[`${n?`Thanks for the details on "${n}".`:"Thanks for the upload."} ${e?"I reviewed the file and captured the critique highlights below:":"Here is a quick critique outline to confirm before I log the request:"}`,"","- Narrative clarity: tighten the opening 3 seconds.","- Visual hierarchy: spotlight the primary CTA earlier.","- Audio mix: reduce music by about 3dB under VO.","- Export: keep 1080x1920, 29.97fps.","","Reply with any edits or confirm if I should submit to the reviewer."].join(`
`)}function u4(t){return[{action_id:"approve_reviewer",label:"Approve",workflow_id:t,variant:"secondary"},{action_id:"reject_reviewer",label:"Reject",workflow_id:t,variant:"ghost"}]}function d4(t){let e=!1;return t&&(t.aborted?e=!0:t.addEventListener("abort",()=>{e=!0},{once:!0})),()=>e}function h4(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function f4(){const t=b2(wr),e=w2(wr),n=o4(wr),s=k2(wr),r=v2(wr),i=j2(wr),o=Ii(wr),a=_2(wr),l=S2(wr);return{mode:"month",period:"2025-02",tasks:wr,summary:t,pie:e,reviewer:n,summary_videographers:s,videographers:r,quick_stats:i,status_counts:o,pending_reviews:a,response_times:l}}async function p4({mode:t,period:e}={}){return await mr(240),{...f4(),mode:t||"month",period:e||"2025-02"}}async function m4(){return await mr(200),a4}async function g4({file:t,message:e,sessionId:n}){await mr(200);const s=n||`vc-session-${Date.now()}`,r=`vc-file-${Date.now()}`;return h4(t)?{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",type:"video",message:"Video received. Which task number is this for?",session_id:s}:{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",file_url:URL.createObjectURL(t),type:"image",response:P0(e,!0),session_id:s,timestamp:new Date().toISOString()}}async function x4({file:t}){return await mr(200),{file_id:`vc-asset-${Date.now()}`,filename:(t==null?void 0:t.name)||"attachment",file_url:URL.createObjectURL(t)}}async function y4({file:t,taskNumber:e}){return await mr(260),{success:!0,file_id:`vc-video-${Date.now()}`,workflow_id:`workflow-${Date.now()}`,version:1,message:`Video uploaded successfully (v1) for task #${e}`}}async function v4({command:t,args:e,sessionId:n}){await mr(200);const s=n||`vc-session-${Date.now()}`,r=(t||"").toLowerCase(),i=(e||"").trim();return r?r==="help"?{success:!0,command:r,response:`**Video Critique Commands**

- /log or /design - Start a new design request
- /recent - Export recent task data
- /edit <task_number> - Edit an existing task
- /delete <task_number> - Delete a task

You can also paste briefs or upload images/videos.`,session_id:s}:r==="log"||r==="design"?{success:!0,command:r,response:P0(i||"I want to log a design request",!1),session_id:s}:r==="edit"?{success:!0,command:r,response:i?"Editing task "+i+". Which fields should I update?":"Please provide a task number: /edit <task_number>",session_id:s}:r==="delete"?{success:!0,command:r,response:i?"Delete request queued for task "+i+". Confirm to proceed.":"Please provide a task number: /delete <task_number>",session_id:s}:r==="recent"?{success:!0,command:r,response:"Preparing the latest export. I will send the download link shortly.",session_id:s}:{success:!1,command:r,error:"Unknown command: /"+r+". Use /help for available commands.",session_id:s}:{success:!1,command:"",error:"Unknown command: /. Use /help for available commands.",session_id:s}}async function b4({actionId:t,workflowId:e}){return await mr(200),t==="reject_reviewer"||t==="return_hos"?{success:!0,message:"Please provide rejection details.",requires_form:!0,form_type:t==="return_hos"?"return":"rejection",workflow_id:e}:{success:!0,message:`Action ${t} applied for ${e}.`}}async function w4({formType:t,workflowId:e}){return await mr(200),{success:!0,message:`${t} submitted for ${e}.`}}async function k4(t){return await mr(120),t==="return"?{title:"Return for Revision",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be revised..."}]}:{title:"Reject Video",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be fixed..."}]}}function _4(t){return t!=null&&t.preview_url?t.preview_url:t!=null&&t.file_url?t.file_url:t!=null&&t.url?t.url:null}async function S4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){const a=d4(o);try{const l=t||`vc-session-${Date.now()}`;if(a()||(await mr(180),a()))return;const u=P0(e,!1),d=c4(u,48);for(const h of d){if(a())return;s==null||s({type:"delta",content:h}),await mr(90)}if(a())return;s==null||s({type:"text_done",content:u}),n!=null&&n.length&&(s==null||s({type:"files",files:n.map((h,f)=>({file_id:h,filename:f===0?"Brief.pdf":`Attachment-${f+1}.pdf`,file_url:`https://example.com/mock-${h}.pdf`}))})),(e||"").toLowerCase().includes("approval")&&(s==null||s({type:"actions",actions:u4(l4[0].workflow_id)})),s==null||s({type:"done",session_id:l}),r==null||r()}catch(l){throw s==null||s({type:"error",message:(l==null?void 0:l.message)||"Stream failed"}),i==null||i(l),l}}async function j4(t){return p4(t)}async function C4(){return m4()}async function N4({file:t,message:e,sessionId:n}){return g4({file:t,message:e,sessionId:n})}async function E4({file:t}){return x4({file:t})}async function o_({file:t,taskNumber:e}){return y4({file:t,taskNumber:e})}async function T4({command:t,args:e,sessionId:n}){return v4({command:t,args:e,sessionId:n})}async function P4({actionId:t,workflowId:e}){return b4({actionId:t,workflowId:e})}async function R4({formType:t,workflowId:e,category:n,reason:s}){return w4({formType:t,workflowId:e})}async function A4(t){return k4(t)}function O4(t){return _4(t)}async function M4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){return S4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o})}function zd(t,e,n){Array.isArray(n)&&n.filter(Boolean).forEach(s=>t.append(e,s))}async function I4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;zd(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return De(`/api/assets/networks${s?`?${s}`:""}`)}async function D4({companies:t,networkId:e,activeOnly:n=!0}={}){const s=new URLSearchParams;zd(s,"companies",t),e!=null&&s.set("network_id",String(e)),n!==void 0&&s.set("active_only",String(n));const r=s.toString();return De(`/api/assets/asset-types${r?`?${r}`:""}`)}async function L4({companies:t,networkId:e,typeId:n,activeOnly:s=!0}={}){const r=new URLSearchParams;zd(r,"companies",t),e!=null&&r.set("network_id",String(e)),n!=null&&r.set("type_id",String(n)),s!==void 0&&r.set("active_only",String(s));const i=r.toString();return De(`/api/assets/network-assets${i?`?${i}`:""}`)}async function $4({companies:t,networkId:e,typeId:n,activeOnly:s=!0,includeEligibility:r=!1}={}){const i=new URLSearchParams;zd(i,"companies",t),e!=null&&i.set("network_id",String(e)),n!=null&&i.set("type_id",String(n)),s!==void 0&&i.set("active_only",String(s)),r!==void 0&&i.set("include_eligibility",String(r));const o=i.toString();return De(`/api/assets/locations${o?`?${o}`:""}`)}async function F4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;zd(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return De(`/api/assets/packages${s?`?${s}`:""}`)}const z4={chat:"chat",video_critique:"video_critique",mockup:["mockup_setup","mockup_generate"],proposals:"proposals",asset_management:"asset_management"},Py={chat:{to:"/app/chat",label:"AI Chat Assistant",icon:QM},video_critique:{to:"/app/video-critique",label:"Video Critique",icon:vf},mockup:{to:"/app/mockup",label:"Mockup Assistant",icon:GM},proposals:{to:"/app/proposals",label:"Proposal Assistant",icon:ZM},admin:{to:"/app/admin",label:"Admin",icon:tI},asset_management:{to:"/app/asset-management",label:"Asset Management",icon:JM},settings:{to:"/app/settings",label:"Settings",icon:cN}},B4=["chat","mockup","proposals","video_critique","admin","asset_management","settings"];function U4(t){return t.includes("/app/video-critique")?"Video Critique":t.includes("/app/chat")?"AI Chat Assistant":t.includes("/app/mockup")?"Mockup Assistant":t.includes("/app/proposals")?"Proposal Assistant":t.includes("/app/notifications")?"Notifications":t.includes("/app/admin")?"Admin Panel":t.includes("/app/asset-management")?"Asset Management":t.includes("/app/settings")?"Settings":"Workspace"}function H4(t){const e=[{name:"sales",tools:["chat","video_critique","mockup","proposals"],sort_order:1}];return Rd(t)&&e.push({name:"core",tools:["admin"],sort_order:100}),e}function W4(t,e){var a;const s=[...((a=t==null?void 0:t.modules)!=null&&a.length?t.modules:H4(e))||[]].sort((l,u)=>(l.sort_order||0)-(u.sort_order||0)),r=new Set;s.forEach(l=>{(l.tools||[]).forEach(u=>{r.add(u==="ai_costs"?"costs":u)})}),r.has("chat")&&r.add("video_critique"),Rd(e)&&(r.add("admin"),r.add("asset_management")),r.add("settings");const i=[],o=new Set;return B4.forEach(l=>{if(!r.has(l))return;const u=Py[l];u&&!o.has(u.to)&&(o.add(u.to),i.push(u))}),i}function V4(t,e){if(!e)return!0;const n=z4[t];return n?Array.isArray(n)?n.some(s=>e[s]!==!1):e[n]!==!1:!0}function q4(){const{user:t,logout:e,authReady:n}=pi(),s=fc(),r=Ed(),[i,o]=v.useState(!1),[a,l]=v.useState(!1),u=Kt({queryKey:["modules","accessible"],queryFn:hB}),d=Kt({queryKey:["service-visibility"],queryFn:E0,staleTime:3e4}),h=v.useMemo(()=>((t==null?void 0:t.name)||"User").split(" ").slice(0,2).map(g=>g[0]).join("").toUpperCase(),[t]),f=v.useMemo(()=>W4(u.data,t),[u.data,t]),p=y=>{const g=d.data,m=Object.keys(Py).find(b=>Py[b].to===y.to);return V4(m,g)},w=!d.isLoading||d.data||d.isError;return!n||!w?c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ve,{text:"Loading"})})}):c.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[c.jsx("header",{className:"sticky top-0 z-40",children:c.jsx("div",{className:"w-full px-6 lg:px-10",children:c.jsx("div",{className:"mmg-header-card mt-4 rounded-2xl bg-white/65 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 gap-3",children:[c.jsxs("div",{className:"flex items-end gap-3",children:[c.jsx(O5,{size:64}),c.jsx("div",{className:"hidden sm:block text-sm leading-none text-black/50 dark:text-white/60 relative -top-px",children:"|"}),c.jsx("div",{className:"hidden sm:block text-sm font-medium leading-none text-black/70 dark:text-white/70",children:U4(s.pathname)})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl lg:hidden",onClick:()=>l(!0),title:"Open sidebar","aria-label":"Open sidebar",children:c.jsx(Xm,{size:18})}),c.jsx(uB,{}),c.jsx(BN,{}),c.jsxs(im,{children:[c.jsx(om,{asChild:!0,children:c.jsxs("button",{className:"flex items-center gap-2 rounded-2xl px-2.5 py-1.5 hover:bg-black/5 dark:hover:bg-white/10 transition-colors","aria-label":"User menu",children:[c.jsx("div",{className:"h-9 w-9 rounded-2xl bg-black/5 dark:bg-white/10 flex items-center justify-center shadow-soft",children:c.jsx("span",{className:"text-xs font-semibold",children:h})}),c.jsxs("div",{className:"hidden sm:flex flex-col items-start leading-tight",children:[c.jsx("span",{className:"mmg-brand-gold text-sm font-medium",children:t==null?void 0:t.name}),c.jsx("span",{className:"text-xs text-black/50 dark:text-white/60",children:t==null?void 0:t.email})]})]})}),c.jsxs($d,{align:"end",children:[c.jsx(f2,{children:c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("span",{className:"truncate",children:t==null?void 0:t.email}),c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:((t==null?void 0:t.roles)||[]).join(" | ")})]})}),c.jsx(mp,{}),c.jsxs(Ju,{onSelect:()=>r("/app/settings"),children:[c.jsx(cN,{size:16}),"Settings"]}),c.jsxs(Ju,{onSelect:()=>{e(),r("/")},children:[c.jsx(YM,{size:16}),"Logout"]})]})]})]})]})})})}),c.jsx(dB,{}),c.jsx("div",{className:"w-full px-6 lg:px-10 pb-4 flex-1 flex overflow-hidden min-w-0",children:c.jsxs("div",{className:Pe("mt-4 grid grid-cols-1 gap-4 lg:grid-cols-[280px_1fr] flex-1 min-h-0 min-w-0","transition-[grid-template-columns] duration-500",i&&"lg:grid-cols-[64px_1fr] 2xl:grid-cols-[72px_1fr]"),children:[c.jsxs("aside",{className:Pe("hidden lg:block rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10","overflow-hidden"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:Pe("text-s ms-3 font-semibold tracking-wide text-black/50 dark:text-white/60",i&&"hidden lg:block lg:sr-only"),children:"Tools"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>o(y=>!y),title:"Toggle sidebar","aria-label":"Toggle sidebar",children:c.jsx(Xm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-2",children:f.map(y=>{const g=s.pathname===y.to||s.pathname.startsWith(`${y.to}/`),m=y.icon,b=p(y);return c.jsx("div",{className:Pe("mmg-nav-item",!b&&"mmg-nav-item-hidden"),children:c.jsxs("button",{onClick:()=>r(y.to),className:Pe("mmg-nav-btn w-full flex items-center gap-3 rounded-2xl p-2 text-sm transition-colors mb-1.5 shadow-soft",g?"mmg-nav-btn-active":"","text-base",i&&"lg:justify-center lg:gap-0"),tabIndex:b?0:-1,children:[c.jsx("span",{className:"mmg-nav-icon h-8 w-8 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(m,{size:22})}),c.jsx("span",{className:Pe("min-w-0 truncate",i&&"hidden"),children:y.label})]})},y.to)})}),c.jsx("div",{className:"px-3 pb-3 pt-1",children:c.jsx("div",{className:Pe("h-px bg-black/5 dark:bg-white/10",i&&"lg:mx-auto lg:w-10")})})]}),c.jsx("main",{className:"min-h-0 min-w-0 h-full",children:c.jsx(JO,{})})]})}),c.jsxs("div",{className:Pe("fixed inset-0 z-50 lg:hidden",a?"pointer-events-auto":"pointer-events-none"),children:[c.jsx("div",{className:Pe("absolute inset-0 bg-black/40 transition-opacity",a?"opacity-100":"opacity-0"),onClick:()=>l(!1)}),c.jsxs("aside",{className:Pe("absolute inset-y-0 left-0 w-72 max-w-full rounded-r-2xl bg-white/90 dark:bg-neutral-900/95","backdrop-blur-xl shadow-2xl ring-1 ring-black/10 dark:ring-white/10","transition-transform duration-200",a?"translate-x-0":"-translate-x-full"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:"text-sm font-semibold tracking-wide text-black/60 dark:text-white/70",children:"Tools"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>l(!1),title:"Close sidebar","aria-label":"Close sidebar",children:c.jsx(Xm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-3",children:f.map(y=>{const g=s.pathname===y.to||s.pathname.startsWith(`${y.to}/`),m=y.icon,b=p(y);return c.jsx("div",{className:Pe("mmg-nav-item",!b&&"mmg-nav-item-hidden"),children:c.jsxs("button",{onClick:()=>{r(y.to),l(!1)},className:Pe("mmg-nav-btn w-full flex items-center gap-2.5 rounded-2xl p-2.5 text-sm transition-colors mb-1.5 shadow-soft",g?"mmg-nav-btn-active":"","text-sm"),tabIndex:b?0:-1,children:[c.jsx("span",{className:"mmg-nav-icon h-9 w-9 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(m,{size:20})}),c.jsx("span",{className:"min-w-0 truncate",children:y.label})]})},y.to)})})]})]})]})}const lm=0,So=1,bc=2,C2=4;function a_(t){return()=>t}function K4(t){t()}function N2(t,e){return n=>t(e(n))}function l_(t,e){return()=>t(e)}function G4(t,e){return n=>t(e,n)}function R0(t){return t!==void 0}function Y4(...t){return()=>{t.map(K4)}}function wc(){}function cm(t,e){return e(t),t}function Q4(t,e){return e(t)}function At(...t){return t}function dt(t,e){return t(So,e)}function Ye(t,e){t(lm,e)}function A0(t){t(bc)}function It(t){return t(C2)}function Ae(t,e){return dt(t,G4(e,lm))}function dr(t,e){const n=t(So,s=>{n(),e(s)});return n}function c_(t){let e,n;return s=>r=>{e=r,n&&clearTimeout(n),n=setTimeout(()=>{s(e)},t)}}function E2(t,e){return t===e}function Pt(t=E2){let e;return n=>s=>{t(e,s)||(e=s,n(s))}}function He(t){return e=>n=>{t(n)&&e(n)}}function _e(t){return e=>N2(e,t)}function Rr(t){return e=>()=>{e(t)}}function ce(t,...e){const n=X4(...e);return(s,r)=>{switch(s){case bc:A0(t);return;case So:return dt(t,n(r))}}}function Dr(t,e){return n=>s=>{n(e=t(e,s))}}function Na(t){return e=>n=>{t>0?t--:e(n)}}function ii(t){let e=null,n;return s=>r=>{e=r,!n&&(n=setTimeout(()=>{n=void 0,s(e)},t))}}function Qe(...t){const e=new Array(t.length);let n=0,s=null;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);dt(i,l=>{const u=n;n=n|a,e[o]=l,u!==r&&n===r&&s&&(s(),s=null)})}),i=>o=>{const a=()=>{i([o].concat(e))};n===r?a():s=a}}function X4(...t){return e=>t.reduceRight(Q4,e)}function J4(t){let e,n;const s=()=>e==null?void 0:e();return function(r,i){switch(r){case So:return i?n===i?void 0:(s(),n=i,e=dt(t,i),e):(s(),wc);case bc:s(),n=null;return}}}function ge(t){let e=t;const n=et();return(s,r)=>{switch(s){case lm:e=r;break;case So:{r(e);break}case C2:return e}return n(s,r)}}function Rn(t,e){return cm(ge(e),n=>Ae(t,n))}function et(){const t=[];return(e,n)=>{switch(e){case lm:t.slice().forEach(s=>{s(n)});return;case bc:t.splice(0,t.length);return;case So:return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}}}function Es(t){return cm(et(),e=>Ae(t,e))}function at(t,e=[],{singleton:n}={singleton:!0}){return{constructor:t,dependencies:e,id:Z4(),singleton:n}}const Z4=()=>Symbol();function eU(t){const e=new Map,n=({constructor:s,dependencies:r,id:i,singleton:o})=>{if(o&&e.has(i))return e.get(i);const a=s(r.map(l=>n(l)));return o&&e.set(i,a),a};return n(t)}function nn(...t){const e=et(),n=new Array(t.length);let s=0;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);dt(i,l=>{n[o]=l,s=s|a,s===r&&Ye(e,n)})}),function(i,o){switch(i){case bc:{A0(e);return}case So:return s===r&&o(n),dt(e,o)}}}function Ue(t,e=E2){return ce(t,Pt(e))}function Ry(...t){return function(e,n){switch(e){case bc:return;case So:return Y4(...t.map(s=>dt(s,n)))}}}var cs=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t))(cs||{});const tU={0:"debug",3:"error",1:"log",2:"warn"},nU=()=>typeof globalThis>"u"?window:globalThis,jo=at(()=>{const t=ge(3);return{log:ge((e,n,s=1)=>{var r;const i=(r=nU().VIRTUOSO_LOG_LEVEL)!=null?r:It(t);s>=i&&console[tU[s]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,n)}),logLevel:t}},[],{singleton:!0});function La(t,e,n){return O0(t,e,n).callbackRef}function O0(t,e,n){const s=ve.useRef(null);let r=o=>{};const i=ve.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const a=()=>{const l=o[0].target;l.offsetParent!==null&&t(l)};n?a():requestAnimationFrame(a)}):null,[t,n]);return r=o=>{o&&e?(i==null||i.observe(o),s.current=o):(s.current&&(i==null||i.unobserve(s.current)),s.current=null)},{callbackRef:r,ref:s}}function sU(t,e,n,s,r,i,o,a,l){const u=ve.useCallback(d=>{const h=rU(d.children,e,a?"offsetWidth":"offsetHeight",r);let f=d.parentElement;for(;!f.dataset.virtuosoScroller;)f=f.parentElement;const p=f.lastElementChild.dataset.viewportType==="window";let w;p&&(w=f.ownerDocument.defaultView);const x=o?a?o.scrollLeft:o.scrollTop:p?a?w.scrollX||w.document.documentElement.scrollLeft:w.scrollY||w.document.documentElement.scrollTop:a?f.scrollLeft:f.scrollTop,y=o?a?o.scrollWidth:o.scrollHeight:p?a?w.document.documentElement.scrollWidth:w.document.documentElement.scrollHeight:a?f.scrollWidth:f.scrollHeight,g=o?a?o.offsetWidth:o.offsetHeight:p?a?w.innerWidth:w.innerHeight:a?f.offsetWidth:f.offsetHeight;s({scrollHeight:y,scrollTop:Math.max(x,0),viewportHeight:g}),i==null||i(a?u_("column-gap",getComputedStyle(d).columnGap,r):u_("row-gap",getComputedStyle(d).rowGap,r)),h!==null&&t(h)},[t,e,r,i,o,s,a]);return O0(u,n,l)}function rU(t,e,n,s){const r=t.length;if(r===0)return null;const i=[];for(let o=0;o<r;o++){const a=t.item(o);if(a.dataset.index===void 0)continue;const l=parseInt(a.dataset.index),u=parseFloat(a.dataset.knownSize),d=e(a,n);if(d===0&&s("Zero-sized element, this should not happen",{child:a},cs.ERROR),d===u)continue;const h=i[i.length-1];i.length===0||h.size!==d||h.endIndex!==l-1?i.push({endIndex:l,size:d,startIndex:l}):i[i.length-1].endIndex++}return i}function u_(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,cs.WARN),e==="normal"?0:parseInt(e??"0",10)}function T2(t,e,n){const s=ve.useRef(null),r=ve.useCallback(l=>{if(!(l!=null&&l.offsetParent))return;const u=l.getBoundingClientRect(),d=u.width;let h,f;if(e){const p=e.getBoundingClientRect(),w=u.top-p.top;f=p.height-Math.max(0,w),h=w+e.scrollTop}else{const p=o.current.ownerDocument.defaultView;f=p.innerHeight-Math.max(0,u.top),h=u.top+p.scrollY}s.current={offsetTop:h,visibleHeight:f,visibleWidth:d},t(s.current)},[t,e]),{callbackRef:i,ref:o}=O0(r,!0,n),a=ve.useCallback(()=>{r(o.current)},[r,o]);return ve.useEffect(()=>{var l;if(e){e.addEventListener("scroll",a);const u=new ResizeObserver(()=>{requestAnimationFrame(a)});return u.observe(e),()=>{e.removeEventListener("scroll",a),u.unobserve(e)}}else{const u=(l=o.current)==null?void 0:l.ownerDocument.defaultView;return u==null||u.addEventListener("scroll",a),u==null||u.addEventListener("resize",a),()=>{u==null||u.removeEventListener("scroll",a),u==null||u.removeEventListener("resize",a)}}},[a,e,o]),i}const qn=at(()=>{const t=et(),e=et(),n=ge(0),s=et(),r=ge(0),i=et(),o=et(),a=ge(0),l=ge(0),u=ge(0),d=ge(0),h=et(),f=et(),p=ge(!1),w=ge(!1),x=ge(!1);return Ae(ce(t,_e(({scrollTop:y})=>y)),e),Ae(ce(t,_e(({scrollHeight:y})=>y)),o),Ae(e,r),{deviation:n,fixedFooterHeight:u,fixedHeaderHeight:l,footerHeight:d,headerHeight:a,horizontalDirection:w,scrollBy:f,scrollContainerState:t,scrollHeight:o,scrollingInProgress:p,scrollTo:h,scrollTop:e,skipAnimationFrameInResizeObserver:x,smoothScrollTargetReached:s,statefulScrollTop:r,viewportHeight:i}},[],{singleton:!0}),ed={lvl:0};function P2(t,e){const n=t.length;if(n===0)return[];let{index:s,value:r}=e(t[0]);const i=[];for(let o=1;o<n;o++){const{index:a,value:l}=e(t[o]);i.push({end:a-1,start:s,value:r}),s=a,r=l}return i.push({end:1/0,start:s,value:r}),i}function bt(t){return t===ed}function td(t,e){if(!bt(t))return e===t.k?t.v:e<t.k?td(t.l,e):td(t.r,e)}function gr(t,e,n="k"){if(bt(t))return[-1/0,void 0];if(Number(t[n])===e)return[t.k,t.v];if(Number(t[n])<e){const s=gr(t.r,e,n);return s[0]===-1/0?[t.k,t.v]:s}return gr(t.l,e,n)}function _s(t,e,n){return bt(t)?O2(e,n,1):e===t.k?ln(t,{k:e,v:n}):e<t.k?d_(ln(t,{l:_s(t.l,e,n)})):d_(ln(t,{r:_s(t.r,e,n)}))}function Ml(){return ed}function Il(t,e,n){if(bt(t))return[];const s=gr(t,e)[0];return iU(Oy(t,s,n))}function Ay(t,e){if(bt(t))return ed;const{k:n,l:s,r}=t;if(e===n){if(bt(s))return r;if(bt(r))return s;{const[i,o]=A2(s);return jf(ln(t,{k:i,l:R2(s),v:o}))}}else return e<n?jf(ln(t,{l:Ay(s,e)})):jf(ln(t,{r:Ay(r,e)}))}function ea(t){return bt(t)?[]:[...ea(t.l),{k:t.k,v:t.v},...ea(t.r)]}function Oy(t,e,n){if(bt(t))return[];const{k:s,l:r,r:i,v:o}=t;let a=[];return s>e&&(a=a.concat(Oy(r,e,n))),s>=e&&s<=n&&a.push({k:s,v:o}),s<=n&&(a=a.concat(Oy(i,e,n))),a}function jf(t){const{l:e,lvl:n,r:s}=t;if(s.lvl>=n-1&&e.lvl>=n-1)return t;if(n>s.lvl+1){if(Sg(e))return M2(ln(t,{lvl:n-1}));if(!bt(e)&&!bt(e.r))return ln(e.r,{l:ln(e,{r:e.r.l}),lvl:n,r:ln(t,{l:e.r.r,lvl:n-1})});throw new Error("Unexpected empty nodes")}else{if(Sg(t))return My(ln(t,{lvl:n-1}));if(!bt(s)&&!bt(s.l)){const r=s.l,i=Sg(r)?s.lvl-1:s.lvl;return ln(r,{l:ln(t,{lvl:n-1,r:r.l}),lvl:r.lvl+1,r:My(ln(s,{l:r.r,lvl:i}))})}else throw new Error("Unexpected empty nodes")}}function ln(t,e){return O2(e.k!==void 0?e.k:t.k,e.v!==void 0?e.v:t.v,e.lvl!==void 0?e.lvl:t.lvl,e.l!==void 0?e.l:t.l,e.r!==void 0?e.r:t.r)}function R2(t){return bt(t.r)?t.l:jf(ln(t,{r:R2(t.r)}))}function Sg(t){return bt(t)||t.lvl>t.r.lvl}function A2(t){return bt(t.r)?[t.k,t.v]:A2(t.r)}function O2(t,e,n,s=ed,r=ed){return{k:t,l:s,lvl:n,r,v:e}}function d_(t){return My(M2(t))}function M2(t){const{l:e}=t;return!bt(e)&&e.lvl===t.lvl?ln(e,{r:ln(t,{l:e.r})}):t}function My(t){const{lvl:e,r:n}=t;return!bt(n)&&!bt(n.r)&&n.lvl===e&&n.r.lvl===e?ln(n,{l:ln(t,{r:n.l}),lvl:e+1}):t}function iU(t){return P2(t,({k:e,v:n})=>({index:e,value:n}))}function I2(t,e){return!!(t&&t.startIndex===e.startIndex&&t.endIndex===e.endIndex)}function nd(t,e){return!!(t&&t[0]===e[0]&&t[1]===e[1])}const M0=at(()=>({recalcInProgress:ge(!1)}),[],{singleton:!0});function D2(t,e,n){return t[gp(t,e,n)]}function gp(t,e,n,s=0){let r=t.length-1;for(;s<=r;){const i=Math.floor((s+r)/2),o=t[i],a=n(o,e);if(a===0)return i;if(a===-1){if(r-s<2)return i-1;r=i-1}else{if(r===s)return i;s=i+1}}throw new Error(`Failed binary finding record in array - ${t.join(",")}, searched for ${e}`)}function oU(t,e,n,s){const r=gp(t,e,s),i=gp(t,n,s,r);return t.slice(r,i+1)}function yo(t,e){return Math.round(t.getBoundingClientRect()[e])}function um(t){return!bt(t.groupOffsetTree)}function I0({index:t},e){return e===t?0:e<t?-1:1}function aU(){return{groupIndices:[],groupOffsetTree:Ml(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:Ml()}}function lU(t,e){let n=bt(t)?0:1/0;for(const s of e){const{endIndex:r,size:i,startIndex:o}=s;if(n=Math.min(n,o),bt(t)){t=_s(t,0,i);continue}const a=Il(t,o-1,r+1);if(a.some(mU(s)))continue;let l=!1,u=!1;for(const{end:d,start:h,value:f}of a)l?(r>=h||i===f)&&(t=Ay(t,h)):(u=f!==i,l=!0),d>r&&r>=h&&f!==i&&(t=_s(t,r+1,f));u&&(t=_s(t,o,i))}return[t,n]}function cU(t){return typeof t.groupIndex<"u"}function uU({offset:t},e){return e===t?0:e<t?-1:1}function sd(t,e,n){if(e.length===0)return 0;const{index:s,offset:r,size:i}=D2(e,t,I0),o=t-s,a=i*o+(o-1)*n+r;return a>0?a+n:a}function L2(t,e){if(!um(e))return t;let n=0;for(;e.groupIndices[n]<=t+n;)n++;return t+n}function $2(t,e,n){if(cU(t))return e.groupIndices[t.groupIndex]+1;{const s=t.index==="LAST"?n:t.index;let r=L2(s,e);return r=Math.max(0,r,Math.min(n,r)),r}}function dU(t,e,n,s=0){return s>0&&(e=Math.max(e,D2(t,s,I0).offset)),P2(oU(t,e,n,uU),pU)}function hU(t,[e,n,s,r]){e.length>0&&s("received item sizes",e,cs.DEBUG);const i=t.sizeTree;let o=i,a=0;if(n.length>0&&bt(i)&&e.length===2){const f=e[0].size,p=e[1].size;o=n.reduce((w,x)=>_s(_s(w,x,f),x+1,p),o)}else[o,a]=lU(o,e);if(o===i)return t;const{lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h}=Iy(t.offsetTree,a,o,r);return{groupIndices:n,groupOffsetTree:n.reduce((f,p)=>_s(f,p,sd(p,h,r)),Ml()),lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h,sizeTree:o}}function fU(t){return ea(t).map(({k:e,v:n},s,r)=>{const i=r[s+1];return{endIndex:i?i.k-1:1/0,size:n,startIndex:e}})}function h_(t,e){let n=0,s=0;for(;n<t;)n+=e[s+1]-e[s]-1,s++;return s-(n===t?0:1)}function Iy(t,e,n,s){let r=t,i=0,o=0,a=0,l=0;if(e!==0){l=gp(r,e-1,I0),a=r[l].offset;const u=gr(n,e-1);i=u[0],o=u[1],r.length&&r[l].size===gr(n,e)[1]&&(l-=1),r=r.slice(0,l+1)}else r=[];for(const{start:u,value:d}of Il(n,e,1/0)){const h=u-i,f=h*o+a+h*s;r.push({index:u,offset:f,size:d}),i=u,a=f,o=d}return{lastIndex:i,lastOffset:a,lastSize:o,offsetTree:r}}function pU(t){return{index:t.index,value:t}}function mU(t){const{endIndex:e,size:n,startIndex:s}=t;return r=>r.start===s&&(r.end===e||r.end===1/0)&&r.value===n}const gU={offsetHeight:"height",offsetWidth:"width"},Ur=at(([{log:t},{recalcInProgress:e}])=>{const n=et(),s=et(),r=Rn(s,0),i=et(),o=et(),a=ge(0),l=ge([]),u=ge(void 0),d=ge(void 0),h=ge(void 0),f=ge(void 0),p=ge((S,j)=>yo(S,gU[j])),w=ge(void 0),x=ge(0),y=aU(),g=Rn(ce(n,Qe(l,t,x),Dr(hU,y),Pt()),y),m=Rn(ce(l,Pt(),Dr((S,j)=>({current:j,prev:S.current}),{current:[],prev:[]}),_e(({prev:S})=>S)),[]);Ae(ce(l,He(S=>S.length>0),Qe(g,x),_e(([S,j,E])=>{const P=S.reduce((L,I,O)=>_s(L,I,sd(I,j.offsetTree,E)||O),Ml());return{...j,groupIndices:S,groupOffsetTree:P}})),g),Ae(ce(s,Qe(g),He(([S,{lastIndex:j}])=>S<j),_e(([S,{lastIndex:j,lastSize:E}])=>[{endIndex:j,size:E,startIndex:S}])),n),Ae(u,d);const b=Rn(ce(u,_e(S=>S===void 0)),!0);Ae(ce(d,He(S=>S!==void 0&&bt(It(g).sizeTree)),_e(S=>{const j=It(h),E=It(l).length>0;return j?E?[{endIndex:0,size:j,startIndex:0},{endIndex:1,size:S,startIndex:1}]:[]:[{endIndex:0,size:S,startIndex:0}]})),n),Ae(ce(f,He(S=>S!==void 0&&S.length>0&&bt(It(g).sizeTree)),_e(S=>{const j=[];let E=S[0],P=0;for(let L=1;L<S.length;L++){const I=S[L];I!==E&&(j.push({endIndex:L-1,size:E,startIndex:P}),E=I,P=L)}return j.push({endIndex:S.length-1,size:E,startIndex:P}),j})),n),Ae(ce(l,Qe(h,d),He(([,S,j])=>S!==void 0&&j!==void 0),_e(([S,j,E])=>{const P=[];for(let L=0;L<S.length;L++){const I=S[L],O=S[L+1];P.push({startIndex:I,endIndex:I,size:j}),O!==void 0&&P.push({startIndex:I+1,endIndex:O-1,size:E})}return P})),n);const k=Es(ce(n,Qe(g),Dr(({sizes:S},[j,E])=>({changed:E!==S,sizes:E}),{changed:!1,sizes:y}),_e(S=>S.changed)));dt(ce(a,Dr((S,j)=>({diff:S.prev-j,prev:j}),{diff:0,prev:0}),_e(S=>S.diff)),S=>{const{groupIndices:j}=It(g);if(S>0)Ye(e,!0),Ye(i,S+h_(S,j));else if(S<0){const E=It(m);E.length>0&&(S-=h_(-S,E)),Ye(o,S)}}),dt(ce(a,Qe(t)),([S,j])=>{S<0&&j("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},cs.ERROR)});const _=Es(i);Ae(ce(i,Qe(g),_e(([S,j])=>{const E=j.groupIndices.length>0,P=[],L=j.lastSize;if(E){const I=td(j.sizeTree,0);let O=0,$=0;for(;O<S;){const F=j.groupIndices[$],K=j.groupIndices.length===$+1?1/0:j.groupIndices[$+1]-F-1;P.push({endIndex:F,size:I,startIndex:F}),P.push({endIndex:F+1+K-1,size:L,startIndex:F+1}),$++,O+=K+1}const D=ea(j.sizeTree);return O!==S&&D.shift(),D.reduce((F,{k:K,v:T})=>{let R=F.ranges;return F.prevSize!==0&&(R=[...F.ranges,{endIndex:K+S-1,size:F.prevSize,startIndex:F.prevIndex}]),{prevIndex:K+S,prevSize:T,ranges:R}},{prevIndex:S,prevSize:0,ranges:P}).ranges}return ea(j.sizeTree).reduce((I,{k:O,v:$})=>({prevIndex:O+S,prevSize:$,ranges:[...I.ranges,{endIndex:O+S-1,size:I.prevSize,startIndex:I.prevIndex}]}),{prevIndex:0,prevSize:L,ranges:[]}).ranges})),n);const C=Es(ce(o,Qe(g,x),_e(([S,{offsetTree:j},E])=>{const P=-S;return sd(P,j,E)})));return Ae(ce(o,Qe(g,x),_e(([S,j,E])=>{if(j.groupIndices.length>0){if(bt(j.sizeTree))return j;let P=Ml();const L=It(m);let I=0,O=0,$=0;for(;I<-S;){$=L[O];const D=L[O+1]-$-1;O++,I+=D+1}if(P=ea(j.sizeTree).reduce((D,{k:F,v:K})=>_s(D,Math.max(0,F+S),K),P),I!==-S){const D=td(j.sizeTree,$);P=_s(P,0,D);const F=gr(j.sizeTree,-S+1)[1];P=_s(P,1,F)}return{...j,sizeTree:P,...Iy(j.offsetTree,0,P,E)}}else{const P=ea(j.sizeTree).reduce((L,{k:I,v:O})=>_s(L,Math.max(0,I+S),O),Ml());return{...j,sizeTree:P,...Iy(j.offsetTree,0,P,E)}}})),g),{beforeUnshiftWith:_,data:w,defaultItemSize:d,firstItemIndex:a,fixedItemSize:u,fixedGroupSize:h,gap:x,groupIndices:l,heightEstimates:f,itemSize:p,listRefresh:k,shiftWith:o,shiftWithOffset:C,sizeRanges:n,sizes:g,statefulTotalCount:r,totalCount:s,trackItemSizes:b,unshiftWith:i}},At(jo,M0),{singleton:!0});function xU(t){return t.reduce((e,n)=>(e.groupIndices.push(e.totalCount),e.totalCount+=n+1,e),{groupIndices:[],totalCount:0})}const F2=at(([{groupIndices:t,sizes:e,totalCount:n},{headerHeight:s,scrollTop:r}])=>{const i=et(),o=et(),a=Es(ce(i,_e(xU)));return Ae(ce(a,_e(l=>l.totalCount)),n),Ae(ce(a,_e(l=>l.groupIndices)),t),Ae(ce(nn(r,e,s),He(([l,u])=>um(u)),_e(([l,u,d])=>gr(u.groupOffsetTree,Math.max(l-d,0),"v")[0]),Pt(),_e(l=>[l])),o),{groupCounts:i,topItemsIndexes:o}},At(Ur,qn)),Co=at(([{log:t}])=>{const e=ge(!1),n=Es(ce(e,He(s=>s),Pt()));return dt(e,s=>{s&&It(t)("props updated",{},cs.DEBUG)}),{didMount:n,propsReady:e}},At(jo),{singleton:!0}),yU=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function z2(t){const e=typeof t=="number"?{index:t}:t;return e.align||(e.align="start"),(!e.behavior||!yU)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const Bd=at(([{gap:t,listRefresh:e,sizes:n,totalCount:s},{fixedFooterHeight:r,fixedHeaderHeight:i,footerHeight:o,headerHeight:a,scrollingInProgress:l,scrollTo:u,smoothScrollTargetReached:d,viewportHeight:h},{log:f}])=>{const p=et(),w=et(),x=ge(0);let y=null,g=null,m=null;function b(){y&&(y(),y=null),m&&(m(),m=null),g&&(clearTimeout(g),g=null),Ye(l,!1)}return Ae(ce(p,Qe(n,h,s,x,a,o,f),Qe(t,i,r),_e(([[k,_,C,S,j,E,P,L],I,O,$])=>{const D=z2(k),{align:F,behavior:K,offset:T}=D,R=S-1,V=$2(D,_,R);let G=sd(V,_.offsetTree,I)+E;F==="end"?(G+=O+gr(_.sizeTree,V)[1]-C+$,V===R&&(G+=P)):F==="center"?G+=(O+gr(_.sizeTree,V)[1]-C+$)/2:G-=j,T&&(G+=T);const Q=re=>{b(),re?(L("retrying to scroll to",{location:k},cs.DEBUG),Ye(p,k)):(Ye(w,!0),L("list did not change, scroll successful",{},cs.DEBUG))};if(b(),K==="smooth"){let re=!1;m=dt(e,ee=>{re=re||ee}),y=dr(d,()=>{Q(re)})}else y=dr(ce(e,vU(150)),Q);return g=setTimeout(()=>{b()},1200),Ye(l,!0),L("scrolling from index to",{behavior:K,index:V,top:G},cs.DEBUG),{behavior:K,top:G}})),u),{scrollTargetReached:w,scrollToIndex:p,topListHeight:x}},At(Ur,qn,jo),{singleton:!0});function vU(t){return e=>{const n=setTimeout(()=>{e(!1)},t);return s=>{s&&(e(!0),clearTimeout(n))}}}function D0(t,e){t==0?e():requestAnimationFrame(()=>{D0(t-1,e)})}function L0(t,e){const n=e-1;return typeof t=="number"?t:t.index==="LAST"?n:t.index}const Ud=at(([{defaultItemSize:t,listRefresh:e,sizes:n},{scrollTop:s},{scrollTargetReached:r,scrollToIndex:i},{didMount:o}])=>{const a=ge(!0),l=ge(0),u=ge(!0);return Ae(ce(o,Qe(l),He(([d,h])=>!!h),Rr(!1)),a),Ae(ce(o,Qe(l),He(([d,h])=>!!h),Rr(!1)),u),dt(ce(nn(e,o),Qe(a,n,t,u),He(([[,d],h,{sizeTree:f},p,w])=>d&&(!bt(f)||R0(p))&&!h&&!w),Qe(l)),([,d])=>{dr(r,()=>{Ye(u,!0)}),D0(4,()=>{dr(s,()=>{Ye(a,!0)}),Ye(i,d)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:l,scrolledToInitialItem:a}},At(Ur,qn,Bd,Co),{singleton:!0});function B2(t,e){return Math.abs(t-e)<1.01}const rd="up",mu="down",bU="none",wU={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},kU=0,Hd=at(([{footerHeight:t,headerHeight:e,scrollBy:n,scrollContainerState:s,scrollTop:r,viewportHeight:i}])=>{const o=ge(!1),a=ge(!0),l=et(),u=et(),d=ge(4),h=ge(kU),f=Rn(ce(Ry(ce(Ue(r),Na(1),Rr(!0)),ce(Ue(r),Na(1),Rr(!1),c_(100))),Pt()),!1),p=Rn(ce(Ry(ce(n,Rr(!0)),ce(n,Rr(!1),c_(200))),Pt()),!1);Ae(ce(nn(Ue(r),Ue(h)),_e(([m,b])=>m<=b),Pt()),a),Ae(ce(a,ii(50)),u);const w=Es(ce(nn(s,Ue(i),Ue(e),Ue(t),Ue(d)),Dr((m,[{scrollHeight:b,scrollTop:k},_,C,S,j])=>{const E=k+_-b>-j,P={scrollHeight:b,scrollTop:k,viewportHeight:_};if(E){let I,O;return k>m.state.scrollTop?(I="SCROLLED_DOWN",O=m.state.scrollTop-k):(I="SIZE_DECREASED",O=m.state.scrollTop-k||m.scrollTopDelta),{atBottom:!0,atBottomBecause:I,scrollTopDelta:O,state:P}}let L;return P.scrollHeight>m.state.scrollHeight?L="SIZE_INCREASED":_<m.state.viewportHeight?L="VIEWPORT_HEIGHT_DECREASING":k<m.state.scrollTop?L="SCROLLING_UPWARDS":L="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:L,state:P}},wU),Pt((m,b)=>m&&m.atBottom===b.atBottom))),x=Rn(ce(s,Dr((m,{scrollHeight:b,scrollTop:k,viewportHeight:_})=>{if(B2(m.scrollHeight,b))return{changed:!1,jump:0,scrollHeight:b,scrollTop:k};{const C=b-(k+_)<1;return m.scrollTop!==k&&C?{changed:!0,jump:m.scrollTop-k,scrollHeight:b,scrollTop:k}:{changed:!0,jump:0,scrollHeight:b,scrollTop:k}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),He(m=>m.changed),_e(m=>m.jump)),0);Ae(ce(w,_e(m=>m.atBottom)),o),Ae(ce(o,ii(50)),l);const y=ge(mu);Ae(ce(s,_e(({scrollTop:m})=>m),Pt(),Dr((m,b)=>It(p)?{direction:m.direction,prevScrollTop:b}:{direction:b<m.prevScrollTop?rd:mu,prevScrollTop:b},{direction:mu,prevScrollTop:0}),_e(m=>m.direction)),y),Ae(ce(s,ii(50),Rr(bU)),y);const g=ge(0);return Ae(ce(f,He(m=>!m),Rr(0)),g),Ae(ce(r,ii(100),Qe(f),He(([m,b])=>b),Dr(([m,b],[k])=>[b,k],[0,0]),_e(([m,b])=>b-m)),g),{atBottomState:w,atBottomStateChange:l,atBottomThreshold:d,atTopStateChange:u,atTopThreshold:h,isAtBottom:o,isAtTop:a,isScrolling:f,lastJumpDueToItemResize:x,scrollDirection:y,scrollVelocity:g}},At(qn)),id="top",od="bottom",f_="none";function p_(t,e,n){return typeof t=="number"?n===rd&&e===id||n===mu&&e===od?t:0:n===rd?e===id?t.main:t.reverse:e===od?t.main:t.reverse}function m_(t,e){var n;return typeof t=="number"?t:(n=t[e])!=null?n:0}const $0=at(([{deviation:t,fixedHeaderHeight:e,headerHeight:n,scrollTop:s,viewportHeight:r}])=>{const i=et(),o=ge(0),a=ge(0),l=ge(0),u=Rn(ce(nn(Ue(s),Ue(r),Ue(n),Ue(i,nd),Ue(l),Ue(o),Ue(e),Ue(t),Ue(a)),_e(([d,h,f,[p,w],x,y,g,m,b])=>{const k=d-m,_=y+g,C=Math.max(f-k,0);let S=f_;const j=m_(b,id),E=m_(b,od);return p-=m,p+=f+g,w+=f+g,w-=m,p>d+_-j&&(S=rd),w<d-C+h+E&&(S=mu),S!==f_?[Math.max(k-f-p_(x,id,S)-j,0),k-C-g+h+p_(x,od,S)+E]:null}),He(d=>d!=null),Pt(nd)),[0,0]);return{increaseViewportBy:a,listBoundary:i,overscan:l,topListHeight:o,visibleRange:u}},At(qn),{singleton:!0});function _U(t,e,n){if(um(e)){const s=L2(t,e);return[{index:gr(e.groupOffsetTree,s)[0],offset:0,size:0},{data:n==null?void 0:n[0],index:s,offset:0,size:0}]}return[{data:n==null?void 0:n[0],index:t,offset:0,size:0}]}const jg={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function Cf(t,e,n,s,r,i){const{lastIndex:o,lastOffset:a,lastSize:l}=r;let u=0,d=0;if(t.length>0){u=t[0].offset;const x=t[t.length-1];d=x.offset+x.size}const h=n-o,f=a+h*l+(h-1)*s,p=u,w=f-d;return{bottom:d,firstItemIndex:i,items:g_(t,r,i),offsetBottom:w,offsetTop:u,top:p,topItems:g_(e,r,i),topListHeight:e.reduce((x,y)=>y.size+x,0),totalCount:n}}function U2(t,e,n,s,r,i){let o=0;if(n.groupIndices.length>0)for(const d of n.groupIndices){if(d-o>=t)break;o++}const a=t+o,l=L0(e,a),u=Array.from({length:a}).map((d,h)=>({data:i[h+l],index:h+l,offset:0,size:0}));return Cf(u,[],a,r,n,s)}function g_(t,e,n){if(t.length===0)return[];if(!um(e))return t.map(u=>({...u,index:u.index+n,originalIndex:u.index}));const s=t[0].index,r=t[t.length-1].index,i=[],o=Il(e.groupOffsetTree,s,r);let a,l=0;for(const u of t){(!a||a.end<u.index)&&(a=o.shift(),l=e.groupIndices.indexOf(a.start));let d;u.index===a.start?d={index:l,type:"group"}:d={groupIndex:l,index:u.index-(l+1)+n},i.push({...d,data:u.data,offset:u.offset,originalIndex:u.index,size:u.size})}return i}function x_(t,e){var n;return t===void 0?0:typeof t=="number"?t:(n=t[e])!=null?n:0}const $a=at(([{data:t,firstItemIndex:e,gap:n,sizes:s,totalCount:r},i,{listBoundary:o,topListHeight:a,visibleRange:l},{initialTopMostItemIndex:u,scrolledToInitialItem:d},{topListHeight:h},f,{didMount:p},{recalcInProgress:w}])=>{const x=ge([]),y=ge(0),g=et(),m=ge(0);Ae(i.topItemsIndexes,x);const b=Rn(ce(nn(p,w,Ue(l,nd),Ue(r),Ue(s),Ue(u),d,Ue(x),Ue(e),Ue(n),Ue(m),t),He(([S,j,,E,,,,,,,,P])=>{const L=P&&P.length!==E;return S&&!j&&!L}),_e(([,,[S,j],E,P,L,I,O,$,D,F,K])=>{var T,R,V,G;const Q=P,{offsetTree:re,sizeTree:ee}=Q,z=It(y);if(E===0)return{...jg,totalCount:E};if(S===0&&j===0)return z===0?{...jg,totalCount:E}:U2(z,L,P,$,D,K||[]);if(bt(ee))return z>0?null:Cf(_U(L0(L,E),Q,K),[],E,D,Q,$);const A=[];if(O.length>0){const ye=O[0],X=O[O.length-1];let ue=0;for(const de of Il(ee,ye,X)){const he=de.value,oe=Math.max(de.start,ye),Se=Math.min(de.end,X);for(let ie=oe;ie<=Se;ie++)A.push({data:K==null?void 0:K[ie],index:ie,offset:ue,size:he}),ue+=he}}if(!I)return Cf([],A,E,D,Q,$);const Y=O.length>0?O[O.length-1]+1:0,U=dU(re,S,j,Y);if(U.length===0)return null;const J=E-1,be=cm([],ye=>{for(const X of U){const ue=X.value;let de=ue.offset,he=X.start;const oe=ue.size;if(ue.offset<S){he+=Math.floor((S-ue.offset+D)/(oe+D));const ie=he-X.start;de+=ie*oe+ie*D}he<Y&&(de+=(Y-he)*oe,he=Y);const Se=Math.min(X.end,J);for(let ie=he;ie<=Se&&!(de>=j);ie++)ye.push({data:K==null?void 0:K[ie],index:ie,offset:de,size:oe}),de+=oe+D}}),me=x_(F,id),H=x_(F,od);if(be.length>0&&(me>0||H>0)){const ye=be[0],X=be[be.length-1];if(me>0&&ye.index>Y){const ue=Math.min(me,ye.index-Y),de=[];let he=ye.offset;for(let oe=ye.index-1;oe>=ye.index-ue;oe--){const Se=(R=(T=Il(ee,oe,oe)[0])==null?void 0:T.value)!=null?R:ye.size;he-=Se+D,de.unshift({data:K==null?void 0:K[oe],index:oe,offset:he,size:Se})}be.unshift(...de)}if(H>0&&X.index<J){const ue=Math.min(H,J-X.index);let de=X.offset+X.size+D;for(let he=X.index+1;he<=X.index+ue;he++){const oe=(G=(V=Il(ee,he,he)[0])==null?void 0:V.value)!=null?G:X.size;be.push({data:K==null?void 0:K[he],index:he,offset:de,size:oe}),de+=oe+D}}}return Cf(be,A,E,D,Q,$)}),He(S=>S!==null),Pt()),jg);Ae(ce(t,He(R0),_e(S=>S==null?void 0:S.length)),r),Ae(ce(b,_e(S=>S.topListHeight)),h),Ae(h,a),Ae(ce(b,_e(S=>[S.top,S.bottom])),o),Ae(ce(b,_e(S=>S.items)),g);const k=Es(ce(b,He(({items:S})=>S.length>0),Qe(r,t),He(([{items:S},j])=>S[S.length-1].originalIndex===j-1),_e(([,S,j])=>[S-1,j]),Pt(nd),_e(([S])=>S))),_=Es(ce(b,ii(200),He(({items:S,topItems:j})=>S.length>0&&S[0].originalIndex===j.length),_e(({items:S})=>S[0].index),Pt())),C=Es(ce(b,He(({items:S})=>S.length>0),_e(({items:S})=>{let j=0,E=S.length-1;for(;S[j].type==="group"&&j<E;)j++;for(;S[E].type==="group"&&E>j;)E--;return{endIndex:S[E].index,startIndex:S[j].index}}),Pt(I2)));return{endReached:k,initialItemCount:y,itemsRendered:g,listState:b,minOverscanItemCount:m,rangeChanged:C,startReached:_,topItemsIndexes:x,...f}},At(Ur,F2,$0,Ud,Bd,Hd,Co,M0),{singleton:!0}),H2=at(([{fixedFooterHeight:t,fixedHeaderHeight:e,footerHeight:n,headerHeight:s},{listState:r}])=>{const i=et(),o=Rn(ce(nn(n,t,s,e,r),_e(([a,l,u,d,h])=>a+l+u+d+h.offsetBottom+h.bottom)),0);return Ae(Ue(o),i),{totalListHeight:o,totalListHeightChanged:i}},At(qn,$a),{singleton:!0}),SU=at(([{viewportHeight:t},{totalListHeight:e}])=>{const n=ge(!1),s=Rn(ce(nn(n,t,e),He(([r])=>r),_e(([,r,i])=>Math.max(0,r-i)),ii(0),Pt()),0);return{alignToBottom:n,paddingTopAddition:s}},At(qn,H2),{singleton:!0}),W2=at(()=>({context:ge(null)})),jU=({itemBottom:t,itemTop:e,locationParams:{align:n,behavior:s,...r},viewportBottom:i,viewportTop:o})=>e<o?{...r,align:n??"start",behavior:s}:t>i?{...r,align:n??"end",behavior:s}:null,V2=at(([{gap:t,sizes:e,totalCount:n},{fixedFooterHeight:s,fixedHeaderHeight:r,headerHeight:i,scrollingInProgress:o,scrollTop:a,viewportHeight:l},{scrollToIndex:u}])=>{const d=et();return Ae(ce(d,Qe(e,l,n,i,r,s,a),Qe(t),_e(([[h,f,p,w,x,y,g,m],b])=>{const{align:k,behavior:_,calculateViewLocation:C=jU,done:S,...j}=h,E=$2(h,f,w-1),P=sd(E,f.offsetTree,b)+x+y,L=P+gr(f.sizeTree,E)[1],I=m+y,O=m+p-g,$=C({itemBottom:L,itemTop:P,locationParams:{align:k,behavior:_,...j},viewportBottom:O,viewportTop:I});return $?S&&dr(ce(o,He(D=>!D),Na(It(o)?1:2)),S):S==null||S(),$}),He(h=>h!==null)),u),{scrollIntoView:d}},At(Ur,qn,Bd,$a,jo),{singleton:!0});function y_(t){return t?t==="smooth"?"smooth":"auto":!1}const CU=(t,e)=>typeof t=="function"?y_(t(e)):e&&y_(t),NU=at(([{listRefresh:t,totalCount:e,fixedItemSize:n,data:s},{atBottomState:r,isAtBottom:i},{scrollToIndex:o},{scrolledToInitialItem:a},{didMount:l,propsReady:u},{log:d},{scrollingInProgress:h},{context:f},{scrollIntoView:p}])=>{const w=ge(!1),x=et();let y=null;function g(_){Ye(o,{align:"end",behavior:_,index:"LAST"})}dt(ce(nn(ce(Ue(e),Na(1)),l),Qe(Ue(w),i,a,h),_e(([[_,C],S,j,E,P])=>{let L=C&&E,I="auto";return L&&(I=CU(S,j||P),L=L&&!!I),{followOutputBehavior:I,shouldFollow:L,totalCount:_}}),He(({shouldFollow:_})=>_)),({followOutputBehavior:_,totalCount:C})=>{y&&(y(),y=null),It(n)?requestAnimationFrame(()=>{It(d)("following output to ",{totalCount:C},cs.DEBUG),g(_)}):y=dr(t,()=>{It(d)("following output to ",{totalCount:C},cs.DEBUG),g(_),y=null})});function m(_){const C=dr(r,S=>{_&&!S.atBottom&&S.notAtBottomBecause==="SIZE_INCREASED"&&!y&&(It(d)("scrolling to bottom due to increased size",{},cs.DEBUG),g("auto"))});setTimeout(C,100)}dt(ce(nn(Ue(w),e,u),He(([_,,C])=>_&&C),Dr(({value:_},[,C])=>({refreshed:_===C,value:C}),{refreshed:!1,value:0}),He(({refreshed:_})=>_),Qe(w,e)),([,_])=>{It(a)&&m(_!==!1)}),dt(x,()=>{m(It(w)!==!1)}),dt(nn(Ue(w),r),([_,C])=>{_&&!C.atBottom&&C.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&g("auto")});const b=ge(null),k=et();return Ae(Ry(ce(Ue(s),_e(_=>{var C;return(C=_==null?void 0:_.length)!=null?C:0})),ce(Ue(e))),k),dt(ce(nn(ce(k,Na(1)),l),Qe(Ue(b),a,h,f),_e(([[_,C],S,j,E,P])=>C&&j&&(S==null?void 0:S({context:P,totalCount:_,scrollingInProgress:E}))),He(_=>!!_),ii(0)),_=>{y&&(y(),y=null),It(n)?requestAnimationFrame(()=>{It(d)("scrolling into view",{}),Ye(p,_)}):y=dr(t,()=>{It(d)("scrolling into view",{}),Ye(p,_),y=null})}),{autoscrollToBottom:x,followOutput:w,scrollIntoViewOnChange:b}},At(Ur,Hd,Bd,Ud,Co,jo,qn,W2,V2)),EU=at(([{data:t,firstItemIndex:e,gap:n,sizes:s},{initialTopMostItemIndex:r},{initialItemCount:i,listState:o},{didMount:a}])=>(Ae(ce(a,Qe(i),He(([,l])=>l!==0),Qe(r,s,e,n,t),_e(([[,l],u,d,h,f,p=[]])=>U2(l,u,d,h,f,p))),o),{}),At(Ur,Ud,$a,Co),{singleton:!0}),TU=at(([{didMount:t},{scrollTo:e},{listState:n}])=>{const s=ge(0);return dt(ce(t,Qe(s),He(([,r])=>r!==0),_e(([,r])=>({top:r}))),r=>{dr(ce(n,Na(1),He(i=>i.items.length>1)),()=>{requestAnimationFrame(()=>{Ye(e,r)})})}),{initialScrollTop:s}},At(Co,qn,$a),{singleton:!0}),q2=at(([{scrollVelocity:t}])=>{const e=ge(!1),n=et(),s=ge(!1);return Ae(ce(t,Qe(s,e,n),He(([r,i])=>!!i),_e(([r,i,o,a])=>{const{enter:l,exit:u}=i;if(o){if(u(r,a))return!1}else if(l(r,a))return!0;return o}),Pt()),e),dt(ce(nn(e,t,n),Qe(s)),([[r,i,o],a])=>{r&&a&&a.change&&a.change(i,o)}),{isSeeking:e,scrollSeekConfiguration:s,scrollSeekRangeChanged:n,scrollVelocity:t}},At(Hd),{singleton:!0}),F0=at(([{scrollContainerState:t,scrollTo:e}])=>{const n=et(),s=et(),r=et(),i=ge(!1),o=ge(void 0);return Ae(ce(nn(n,s),_e(([{scrollHeight:a,scrollTop:l,viewportHeight:u},{offsetTop:d}])=>({scrollHeight:a,scrollTop:Math.max(0,l-d),viewportHeight:u}))),t),Ae(ce(e,Qe(s),_e(([a,{offsetTop:l}])=>({...a,top:a.top+l}))),r),{customScrollParent:o,useWindowScroll:i,windowScrollContainerState:n,windowScrollTo:r,windowViewportRect:s}},At(qn)),PU=at(([{sizeRanges:t,sizes:e},{headerHeight:n,scrollTop:s},{initialTopMostItemIndex:r},{didMount:i},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:l}])=>{const u=et(),d=ge(void 0),h=ge(null),f=ge(null);return Ae(a,h),Ae(l,f),dt(ce(u,Qe(e,s,o,h,f,n)),([p,w,x,y,g,m,b])=>{const k=fU(w.sizeTree);y&&g!==null&&m!==null&&(x=g.scrollTop-m.offsetTop),x-=b,p({ranges:k,scrollTop:x})}),Ae(ce(d,He(R0),_e(RU)),r),Ae(ce(i,Qe(d),He(([,p])=>p!==void 0),Pt(),_e(([,p])=>p.ranges)),t),{getState:u,restoreStateFrom:d}},At(Ur,qn,Ud,Co,F0));function RU(t){return{align:"start",index:0,offset:t.scrollTop}}const AU=at(([{topItemsIndexes:t}])=>{const e=ge(0);return Ae(ce(e,He(n=>n>=0),_e(n=>Array.from({length:n}).map((s,r)=>r))),t),{topItemCount:e}},At($a));function K2(t){let e=!1,n;return()=>(e||(e=!0,n=t()),n)}const OU=K2(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),MU=at(([{deviation:t,scrollBy:e,scrollingInProgress:n,scrollTop:s},{isAtBottom:r,isScrolling:i,lastJumpDueToItemResize:o,scrollDirection:a},{listState:l},{beforeUnshiftWith:u,gap:d,shiftWithOffset:h,sizes:f},{log:p},{recalcInProgress:w}])=>{const x=Es(ce(l,Qe(o),Dr(([,g,m,b],[{bottom:k,items:_,offsetBottom:C,totalCount:S},j])=>{const E=k+C;let P=0;return m===S&&g.length>0&&_.length>0&&(_[0].originalIndex===0&&g[0].originalIndex===0||(P=E-b,P!==0&&(P+=j))),[P,_,S,E]},[0,[],0,0]),He(([g])=>g!==0),Qe(s,a,n,r,p,w),He(([,g,m,b,,,k])=>!k&&!b&&g!==0&&m===rd),_e(([[g],,,,,m])=>(m("Upward scrolling compensation",{amount:g},cs.DEBUG),g))));function y(g){g>0?(Ye(e,{behavior:"auto",top:-g}),Ye(t,0)):(Ye(t,0),Ye(e,{behavior:"auto",top:-g}))}return dt(ce(x,Qe(t,i)),([g,m,b])=>{b&&OU()?Ye(t,m-g):y(-g)}),dt(ce(nn(Rn(i,!1),t,w),He(([g,m,b])=>!g&&!b&&m!==0),_e(([g,m])=>m),ii(1)),y),Ae(ce(h,_e(g=>({top:-g}))),e),dt(ce(u,Qe(f,d),_e(([g,{groupIndices:m,lastSize:b,sizeTree:k},_])=>{function C(S){return S*(b+_)}if(m.length===0)return C(g);{let S=0;const j=td(k,0);let E=0,P=0;for(;E<g;){E++,S+=j;let L=m.length===P+1?1/0:m[P+1]-m[P]-1;E+L>g&&(S-=j,L=g-E+1),E+=L,S+=C(L),P++}return S}})),g=>{Ye(t,g),requestAnimationFrame(()=>{Ye(e,{top:g}),requestAnimationFrame(()=>{Ye(t,0),Ye(w,!1)})})}),{deviation:t}},At(qn,Hd,$a,Ur,jo,M0)),IU=at(([t,e,n,s,r,i,o,a,l,u,d])=>({...t,...e,...n,...s,...r,...i,...o,...a,...l,...u,...d}),At($0,EU,Co,q2,H2,TU,SU,F0,V2,jo,W2)),G2=at(([{data:t,defaultItemSize:e,firstItemIndex:n,fixedItemSize:s,fixedGroupSize:r,gap:i,groupIndices:o,heightEstimates:a,itemSize:l,sizeRanges:u,sizes:d,statefulTotalCount:h,totalCount:f,trackItemSizes:p},{initialItemFinalLocationReached:w,initialTopMostItemIndex:x,scrolledToInitialItem:y},g,m,b,k,{scrollToIndex:_},C,{topItemCount:S},{groupCounts:j},E])=>{const{listState:P,minOverscanItemCount:L,topItemsIndexes:I,rangeChanged:O,...$}=k;return Ae(O,E.scrollSeekRangeChanged),Ae(ce(E.windowViewportRect,_e(D=>D.visibleHeight)),g.viewportHeight),{data:t,defaultItemHeight:e,firstItemIndex:n,fixedItemHeight:s,fixedGroupHeight:r,gap:i,groupCounts:j,heightEstimates:a,initialItemFinalLocationReached:w,initialTopMostItemIndex:x,scrolledToInitialItem:y,sizeRanges:u,topItemCount:S,topItemsIndexes:I,totalCount:f,...b,groupIndices:o,itemSize:l,listState:P,minOverscanItemCount:L,scrollToIndex:_,statefulTotalCount:h,trackItemSizes:p,rangeChanged:O,...$,...E,...g,sizes:d,...m}},At(Ur,Ud,qn,PU,NU,$a,Bd,MU,AU,F2,IU));function DU(t,e){const n={},s={};let r=0;const i=t.length;for(;r<i;)s[t[r]]=1,r+=1;for(const o in e)Object.hasOwn(s,o)||(n[o]=e[o]);return n}const Ih=typeof document<"u"?ve.useLayoutEffect:ve.useEffect;function Y2(t,e,n){const s=Object.keys(e.required||{}),r=Object.keys(e.optional||{}),i=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),a=ve.createContext({});function l(y,g){y.propsReady&&Ye(y.propsReady,!1);for(const m of s){const b=y[e.required[m]];Ye(b,g[m])}for(const m of r)if(m in g){const b=y[e.optional[m]];Ye(b,g[m])}y.propsReady&&Ye(y.propsReady,!0)}function u(y){return i.reduce((g,m)=>(g[m]=b=>{const k=y[e.methods[m]];Ye(k,b)},g),{})}function d(y){return o.reduce((g,m)=>(g[m]=J4(y[e.events[m]]),g),{})}const h=ve.forwardRef((y,g)=>{const{children:m,...b}=y,[k]=ve.useState(()=>cm(eU(t),S=>{l(S,b)})),[_]=ve.useState(l_(d,k));Ih(()=>{for(const S of o)S in b&&dt(_[S],b[S]);return()=>{Object.values(_).map(A0)}},[b,_,k]),Ih(()=>{l(k,b)}),ve.useImperativeHandle(g,a_(u(k)));const C=n;return c.jsx(a.Provider,{value:k,children:n?c.jsx(C,{...DU([...s,...r,...o],b),children:m}):m})}),f=y=>{const g=ve.useContext(a);return ve.useCallback(m=>{Ye(g[y],m)},[g,y])},p=y=>{const g=ve.useContext(a)[y],m=ve.useCallback(b=>dt(g,b),[g]);return ve.useSyncExternalStore(m,()=>It(g),()=>It(g))},w=y=>{const g=ve.useContext(a)[y],[m,b]=ve.useState(l_(It,g));return Ih(()=>dt(g,k=>{k!==m&&b(a_(k))}),[g,m]),m},x=ve.version.startsWith("18")?p:w;return{Component:h,useEmitter:(y,g)=>{const m=ve.useContext(a)[y];Ih(()=>dt(m,g),[g,m])},useEmitterValue:x,usePublisher:f}}const Q2=ve.createContext(void 0),X2=ve.createContext(void 0),J2=typeof document<"u"?ve.useLayoutEffect:ve.useEffect;function Cg(t){return"self"in t}function LU(t){return"body"in t}function Z2(t,e,n,s=wc,r,i){const o=ve.useRef(null),a=ve.useRef(null),l=ve.useRef(null),u=ve.useCallback(f=>{let p,w,x;const y=f.target;if(LU(y)||Cg(y)){const m=Cg(y)?y:y.defaultView;x=i?m.scrollX:m.scrollY,p=i?m.document.documentElement.scrollWidth:m.document.documentElement.scrollHeight,w=i?m.innerWidth:m.innerHeight}else x=i?y.scrollLeft:y.scrollTop,p=i?y.scrollWidth:y.scrollHeight,w=i?y.offsetWidth:y.offsetHeight;const g=()=>{t({scrollHeight:p,scrollTop:Math.max(x,0),viewportHeight:w})};f.suppressFlushSync?g():CC.flushSync(g),a.current!==null&&(x===a.current||x<=0||x===p-w)&&(a.current=null,e(!0),l.current&&(clearTimeout(l.current),l.current=null))},[t,e,i]);ve.useEffect(()=>{const f=r||o.current;return s(r||o.current),u({suppressFlushSync:!0,target:f}),f.addEventListener("scroll",u,{passive:!0}),()=>{s(null),f.removeEventListener("scroll",u)}},[o,u,n,s,r]);function d(f){const p=o.current;if(!p||(i?"offsetWidth"in p&&p.offsetWidth===0:"offsetHeight"in p&&p.offsetHeight===0))return;const w=f.behavior==="smooth";let x,y,g;Cg(p)?(y=Math.max(yo(p.document.documentElement,i?"width":"height"),i?p.document.documentElement.scrollWidth:p.document.documentElement.scrollHeight),x=i?p.innerWidth:p.innerHeight,g=i?window.scrollX:window.scrollY):(y=p[i?"scrollWidth":"scrollHeight"],x=yo(p,i?"width":"height"),g=p[i?"scrollLeft":"scrollTop"]);const m=y-x;if(f.top=Math.ceil(Math.max(Math.min(m,f.top),0)),B2(x,y)||f.top===g){t({scrollHeight:y,scrollTop:g,viewportHeight:x}),w&&e(!0);return}w?(a.current=f.top,l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{l.current=null,a.current=null,e(!0)},1e3)):a.current=null,i&&(f={behavior:f.behavior,left:f.top}),p.scrollTo(f)}function h(f){i&&(f={behavior:f.behavior,left:f.top}),o.current.scrollBy(f)}return{scrollByCallback:h,scrollerRef:o,scrollToCallback:d}}const Ng="-webkit-sticky",v_="sticky",z0=K2(()=>{if(typeof document>"u")return v_;const t=document.createElement("div");return t.style.position=Ng,t.style.position===Ng?Ng:v_});function B0(t){return t}const $U=at(()=>{const t=ge(a=>`Item ${a}`),e=ge(a=>`Group ${a}`),n=ge({}),s=ge(B0),r=ge("div"),i=ge(wc),o=(a,l=null)=>Rn(ce(n,_e(u=>u[a]),Pt()),l);return{components:n,computeItemKey:s,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:e,HeaderComponent:o("Header"),HeaderFooterTag:r,ItemComponent:o("Item","div"),itemContent:t,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:i,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}}),FU=at(([t,e])=>({...t,...e}),At(G2,$U)),zU=({height:t})=>c.jsx("div",{style:{height:t}}),BU={overflowAnchor:"none",position:z0(),zIndex:1},eT={overflowAnchor:"none"},UU={...eT,display:"inline-block",height:"100%"},b_=ve.memo(function({showTopList:t=!1}){const e=We("listState"),n=zs("sizeRanges"),s=We("useWindowScroll"),r=We("customScrollParent"),i=zs("windowScrollContainerState"),o=zs("scrollContainerState"),a=r||s?i:o,l=We("itemContent"),u=We("context"),d=We("groupContent"),h=We("trackItemSizes"),f=We("itemSize"),p=We("log"),w=zs("gap"),x=We("horizontalDirection"),{callbackRef:y}=sU(n,f,h,t?wc:a,p,w,r,x,We("skipAnimationFrameInResizeObserver")),[g,m]=ve.useState(0);U0("deviation",$=>{g!==$&&m($)});const b=We("EmptyPlaceholder"),k=We("ScrollSeekPlaceholder")||zU,_=We("ListComponent"),C=We("ItemComponent"),S=We("GroupComponent"),j=We("computeItemKey"),E=We("isSeeking"),P=We("groupIndices").length>0,L=We("alignToBottom"),I=We("initialItemFinalLocationReached"),O=t?{}:{boxSizing:"border-box",...x?{display:"inline-block",height:"100%",marginLeft:g!==0?g:L?"auto":0,paddingLeft:e.offsetTop,paddingRight:e.offsetBottom,whiteSpace:"nowrap"}:{marginTop:g!==0?g:L?"auto":0,paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},...I?{}:{visibility:"hidden"}};return!t&&e.totalCount===0&&b?c.jsx(b,{...Pn(b,u)}):c.jsx(_,{...Pn(_,u),"data-testid":t?"virtuoso-top-item-list":"virtuoso-item-list",ref:y,style:O,children:(t?e.topItems:e.items).map($=>{const D=$.originalIndex,F=j(D+e.firstItemIndex,$.data,u);return E?v.createElement(k,{...Pn(k,u),height:$.size,index:$.index,key:F,type:$.type||"item",...$.type==="group"?{}:{groupIndex:$.groupIndex}}):$.type==="group"?v.createElement(S,{...Pn(S,u),"data-index":D,"data-item-index":$.index,"data-known-size":$.size,key:F,style:BU},d($.index,u)):v.createElement(C,{...Pn(C,u),...qU(C,$.data),"data-index":D,"data-item-group-index":$.groupIndex,"data-item-index":$.index,"data-known-size":$.size,key:F,style:x?UU:eT},P?l($.index,$.groupIndex,$.data,u):l($.index,$.data,u))})})}),HU={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},WU={outline:"none",overflowX:"auto",position:"relative"},dm=t=>({height:"100%",position:"absolute",top:0,width:"100%",...t?{display:"flex",flexDirection:"column"}:{}}),VU={position:z0(),top:0,width:"100%",zIndex:1};function Pn(t,e){if(typeof t!="string")return{context:e}}function qU(t,e){return{item:typeof t=="string"?void 0:e}}const KU=ve.memo(function(){const t=We("HeaderComponent"),e=zs("headerHeight"),n=We("HeaderFooterTag"),s=La(ve.useMemo(()=>i=>{e(yo(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null}),GU=ve.memo(function(){const t=We("FooterComponent"),e=zs("footerHeight"),n=We("HeaderFooterTag"),s=La(ve.useMemo(()=>i=>{e(yo(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null});function tT({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ve.memo(function({children:s,style:r,context:i,...o}){const a=n("scrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("scrollerRef"),h=e("horizontalDirection")||!1,{scrollByCallback:f,scrollerRef:p,scrollToCallback:w}=Z2(a,u,l,d,void 0,h);return t("scrollTo",w),t("scrollBy",f),c.jsx(l,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:p,style:{...h?WU:HU,...r},tabIndex:0,...o,...Pn(l,i),children:s})})}function nT({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ve.memo(function({children:s,style:r,context:i,...o}){const a=n("windowScrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("totalListHeight"),h=e("deviation"),f=e("customScrollParent"),p=ve.useRef(null),w=e("scrollerRef"),{scrollByCallback:x,scrollerRef:y,scrollToCallback:g}=Z2(a,u,l,w,f);return J2(()=>{var m;return y.current=f||((m=p.current)==null?void 0:m.ownerDocument.defaultView),()=>{y.current=null}},[y,f]),t("windowScrollTo",g),t("scrollBy",x),c.jsx(l,{ref:p,"data-virtuoso-scroller":!0,style:{position:"relative",...r,...d!==0?{height:d+h}:{}},...o,...Pn(l,i),children:s})})}const YU=({children:t})=>{const e=ve.useContext(Q2),n=zs("viewportHeight"),s=zs("fixedItemHeight"),r=We("alignToBottom"),i=We("horizontalDirection"),o=ve.useMemo(()=>N2(n,l=>yo(l,i?"width":"height")),[n,i]),a=La(o,!0,We("skipAnimationFrameInResizeObserver"));return ve.useEffect(()=>{e&&(n(e.viewportHeight),s(e.itemHeight))},[e,n,s]),c.jsx("div",{"data-viewport-type":"element",ref:a,style:dm(r),children:t})},QU=({children:t})=>{const e=ve.useContext(Q2),n=zs("windowViewportRect"),s=zs("fixedItemHeight"),r=We("customScrollParent"),i=T2(n,r,We("skipAnimationFrameInResizeObserver")),o=We("alignToBottom");return ve.useEffect(()=>{e&&(s(e.itemHeight),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,n,s]),c.jsx("div",{"data-viewport-type":"window",ref:i,style:dm(o),children:t})},XU=({children:t})=>{const e=We("TopItemListComponent")||"div",n=We("headerHeight"),s={...VU,marginTop:`${n}px`},r=We("context");return c.jsx(e,{style:s,...Pn(e,r),children:t})},JU=ve.memo(function(t){const e=We("useWindowScroll"),n=We("topItemsIndexes").length>0,s=We("customScrollParent"),r=We("context");return c.jsxs(s||e?t6:e6,{...t,context:r,children:[n&&c.jsx(XU,{children:c.jsx(b_,{showTopList:!0})}),c.jsxs(s||e?QU:YU,{children:[c.jsx(KU,{}),c.jsx(b_,{}),c.jsx(GU,{})]})]})}),{Component:ZU,useEmitter:U0,useEmitterValue:We,usePublisher:zs}=Y2(FU,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},JU),e6=tT({useEmitter:U0,useEmitterValue:We,usePublisher:zs}),t6=nT({useEmitter:U0,useEmitterValue:We,usePublisher:zs}),n6=ZU,s6=at(()=>{const t=ge(u=>c.jsxs("td",{children:["Item $",u]})),e=ge(null),n=ge(u=>c.jsxs("td",{colSpan:1e3,children:["Group ",u]})),s=ge(null),r=ge(null),i=ge({}),o=ge(B0),a=ge(wc),l=(u,d=null)=>Rn(ce(i,_e(h=>h[u]),Pt()),d);return{components:i,computeItemKey:o,context:e,EmptyPlaceholder:l("EmptyPlaceholder"),FillerRow:l("FillerRow"),fixedFooterContent:r,fixedHeaderContent:s,itemContent:t,groupContent:n,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),TableBodyComponent:l("TableBody","tbody"),TableComponent:l("Table","table"),TableFooterComponent:l("TableFoot","tfoot"),TableHeadComponent:l("TableHead","thead"),TableRowComponent:l("TableRow","tr"),GroupComponent:l("Group","tr")}});At(G2,s6);z0();const w_={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},r6={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:k_,floor:xp,max:gu,min:Eg,round:__}=Math;function S_(t,e,n){return Array.from({length:e-t+1}).map((s,r)=>({data:n===null?null:n[r+t],index:r+t}))}function i6(t){return{...r6,items:t}}function Dh(t,e){return t&&t.width===e.width&&t.height===e.height}function o6(t,e){return t&&t.column===e.column&&t.row===e.row}const a6=at(([{increaseViewportBy:t,listBoundary:e,overscan:n,visibleRange:s},{footerHeight:r,headerHeight:i,scrollBy:o,scrollContainerState:a,scrollTo:l,scrollTop:u,smoothScrollTargetReached:d,viewportHeight:h},f,p,{didMount:w,propsReady:x},{customScrollParent:y,useWindowScroll:g,windowScrollContainerState:m,windowScrollTo:b,windowViewportRect:k},_])=>{const C=ge(0),S=ge(0),j=ge(w_),E=ge({height:0,width:0}),P=ge({height:0,width:0}),L=et(),I=et(),O=ge(0),$=ge(null),D=ge({column:0,row:0}),F=et(),K=et(),T=ge(!1),R=ge(0),V=ge(!0),G=ge(!1),Q=ge(!1);dt(ce(w,Qe(R),He(([U,J])=>!!J)),()=>{Ye(V,!1)}),dt(ce(nn(w,V,P,E,R,G),He(([U,J,be,me,,H])=>U&&!J&&be.height!==0&&me.height!==0&&!H)),([,,,,U])=>{Ye(G,!0),D0(1,()=>{Ye(L,U)}),dr(ce(u),()=>{Ye(e,[0,0]),Ye(V,!0)})}),Ae(ce(K,He(U=>U!=null&&U.scrollTop>0),Rr(0)),S),dt(ce(w,Qe(K),He(([,U])=>U!=null)),([,U])=>{U&&(Ye(E,U.viewport),Ye(P,U.item),Ye(D,U.gap),U.scrollTop>0&&(Ye(T,!0),dr(ce(u,Na(1)),J=>{Ye(T,!1)}),Ye(l,{top:U.scrollTop})))}),Ae(ce(E,_e(({height:U})=>U)),h),Ae(ce(nn(Ue(E,Dh),Ue(P,Dh),Ue(D,(U,J)=>U&&U.column===J.column&&U.row===J.row),Ue(u)),_e(([U,J,be,me])=>({gap:be,item:J,scrollTop:me,viewport:U}))),F),Ae(ce(nn(Ue(C),s,Ue(D,o6),Ue(P,Dh),Ue(E,Dh),Ue($),Ue(S),Ue(T),Ue(V),Ue(R)),He(([,,,,,,,U])=>!U),_e(([U,[J,be],me,H,ye,X,ue,,de,he])=>{const{column:oe,row:Se}=me,{height:ie,width:W}=H,{width:ke}=ye;if(ue===0&&(U===0||ke===0))return w_;if(W===0){const Mn=L0(he,U),Kn=Mn+Math.max(ue-1,0);return i6(S_(Mn,Kn,X))}const Re=sT(ke,W,oe);let Oe,ae;de?J===0&&be===0&&ue>0?(Oe=0,ae=ue-1):(Oe=Re*xp((J+Se)/(ie+Se)),ae=Re*k_((be+Se)/(ie+Se))-1,ae=Eg(U-1,gu(ae,Re-1)),Oe=Eg(ae,gu(0,Oe))):(Oe=0,ae=-1);const te=S_(Oe,ae,X),{bottom:ne,top:je}=j_(ye,me,H,te),Xt=k_(U/Re),Ys=Xt*ie+(Xt-1)*Se-ne;return{bottom:ne,itemHeight:ie,items:te,itemWidth:W,offsetBottom:Ys,offsetTop:je,top:je}})),j),Ae(ce($,He(U=>U!==null),_e(U=>U.length)),C),Ae(ce(nn(E,P,j,D),He(([U,J,{items:be}])=>be.length>0&&J.height!==0&&U.height!==0),_e(([U,J,{items:be},me])=>{const{bottom:H,top:ye}=j_(U,me,J,be);return[ye,H]}),Pt(nd)),e);const re=ge(!1);Ae(ce(u,Qe(re),_e(([U,J])=>J||U!==0)),re);const ee=Es(ce(nn(j,C),He(([{items:U}])=>U.length>0),Qe(re),He(([[U,J],be])=>{const me=U.items[U.items.length-1].index===J-1;return(be||U.bottom>0&&U.itemHeight>0&&U.offsetBottom===0&&U.items.length===J)&&me}),_e(([[,U]])=>U-1),Pt())),z=Es(ce(Ue(j),He(({items:U})=>U.length>0&&U[0].index===0),Rr(0),Pt())),A=Es(ce(Ue(j),Qe(T),He(([{items:U},J])=>U.length>0&&!J),_e(([{items:U}])=>({endIndex:U[U.length-1].index,startIndex:U[0].index})),Pt(I2),ii(0)));Ae(A,p.scrollSeekRangeChanged),Ae(ce(L,Qe(E,P,C,D),_e(([U,J,be,me,H])=>{const ye=z2(U),{align:X,behavior:ue,offset:de}=ye;let he=ye.index;he==="LAST"&&(he=me-1),he=gu(0,he,Eg(me-1,he));let oe=Dy(J,H,be,he);return X==="end"?oe=__(oe-J.height+be.height):X==="center"&&(oe=__(oe-J.height/2+be.height/2)),de&&(oe+=de),{behavior:ue,top:oe}})),l);const Y=Rn(ce(j,_e(U=>U.offsetBottom+U.bottom)),0);return Ae(ce(k,_e(U=>({height:U.visibleHeight,width:U.visibleWidth}))),E),{customScrollParent:y,data:$,deviation:O,footerHeight:r,gap:D,headerHeight:i,increaseViewportBy:t,initialItemCount:S,itemDimensions:P,overscan:n,restoreStateFrom:K,scrollBy:o,scrollContainerState:a,scrollHeight:I,scrollTo:l,scrollToIndex:L,scrollTop:u,smoothScrollTargetReached:d,totalCount:C,useWindowScroll:g,viewportDimensions:E,windowScrollContainerState:m,windowScrollTo:b,windowViewportRect:k,...p,gridState:j,horizontalDirection:Q,initialTopMostItemIndex:R,totalListHeight:Y,...f,endReached:ee,propsReady:x,rangeChanged:A,startReached:z,stateChanged:F,stateRestoreInProgress:T,..._}},At($0,qn,Hd,q2,Co,F0,jo));function sT(t,e,n){return gu(1,xp((t+n)/(xp(e)+n)))}function j_(t,e,n,s){const{height:r}=n;if(r===void 0||s.length===0)return{bottom:0,top:0};const i=Dy(t,e,n,s[0].index);return{bottom:Dy(t,e,n,s[s.length-1].index)+r,top:i}}function Dy(t,e,n,s){const r=sT(t.width,n.width,e.column),i=xp(s/r),o=i*n.height+gu(0,i-1)*e.row;return o>0?o+e.row:o}const l6=at(()=>{const t=ge(h=>`Item ${h}`),e=ge({}),n=ge(null),s=ge("virtuoso-grid-item"),r=ge("virtuoso-grid-list"),i=ge(B0),o=ge("div"),a=ge(wc),l=(h,f=null)=>Rn(ce(e,_e(p=>p[h]),Pt()),f),u=ge(!1),d=ge(!1);return Ae(Ue(d),u),{components:e,computeItemKey:i,context:n,FooterComponent:l("Footer"),HeaderComponent:l("Header"),headerFooterTag:o,itemClassName:s,ItemComponent:l("Item","div"),itemContent:t,listClassName:r,ListComponent:l("List","div"),readyStateChanged:u,reportReadyState:d,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}}),c6=at(([t,e])=>({...t,...e}),At(a6,l6)),u6=ve.memo(function(){const t=Mt("gridState"),e=Mt("listClassName"),n=Mt("itemClassName"),s=Mt("itemContent"),r=Mt("computeItemKey"),i=Mt("isSeeking"),o=Bs("scrollHeight"),a=Mt("ItemComponent"),l=Mt("ListComponent"),u=Mt("ScrollSeekPlaceholder"),d=Mt("context"),h=Bs("itemDimensions"),f=Bs("gap"),p=Mt("log"),w=Mt("stateRestoreInProgress"),x=Bs("reportReadyState"),y=La(ve.useMemo(()=>g=>{const m=g.parentElement.parentElement.scrollHeight;o(m);const b=g.firstChild;if(b){const{height:k,width:_}=b.getBoundingClientRect();h({height:k,width:_})}f({column:C_("column-gap",getComputedStyle(g).columnGap,p),row:C_("row-gap",getComputedStyle(g).rowGap,p)})},[o,h,f,p]),!0,!1);return J2(()=>{t.itemHeight>0&&t.itemWidth>0&&x(!0)},[t]),w?null:c.jsx(l,{className:e,ref:y,...Pn(l,d),"data-testid":"virtuoso-item-list",style:{paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},children:t.items.map(g=>{const m=r(g.index,g.data,d);return i?c.jsx(u,{...Pn(u,d),height:t.itemHeight,index:g.index,width:t.itemWidth},m):v.createElement(a,{...Pn(a,d),className:n,"data-index":g.index,key:m},s(g.index,g.data,d))})})}),d6=ve.memo(function(){const t=Mt("HeaderComponent"),e=Bs("headerHeight"),n=Mt("headerFooterTag"),s=La(ve.useMemo(()=>i=>{e(yo(i,"height"))},[e]),!0,!1),r=Mt("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null}),h6=ve.memo(function(){const t=Mt("FooterComponent"),e=Bs("footerHeight"),n=Mt("headerFooterTag"),s=La(ve.useMemo(()=>i=>{e(yo(i,"height"))},[e]),!0,!1),r=Mt("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Pn(t,r)})}):null}),f6=({children:t})=>{const e=ve.useContext(X2),n=Bs("itemDimensions"),s=Bs("viewportDimensions"),r=La(ve.useMemo(()=>i=>{s(i.getBoundingClientRect())},[s]),!0,!1);return ve.useEffect(()=>{e&&(s({height:e.viewportHeight,width:e.viewportWidth}),n({height:e.itemHeight,width:e.itemWidth}))},[e,s,n]),c.jsx("div",{ref:r,style:dm(!1),children:t})},p6=({children:t})=>{const e=ve.useContext(X2),n=Bs("windowViewportRect"),s=Bs("itemDimensions"),r=Mt("customScrollParent"),i=T2(n,r,!1);return ve.useEffect(()=>{e&&(s({height:e.itemHeight,width:e.itemWidth}),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,n,s]),c.jsx("div",{ref:i,style:dm(!1),children:t})},m6=ve.memo(function({...t}){const e=Mt("useWindowScroll"),n=Mt("customScrollParent"),s=n||e?x6:g6,r=n||e?p6:f6,i=Mt("context");return c.jsx(s,{...t,...Pn(s,i),children:c.jsxs(r,{children:[c.jsx(d6,{}),c.jsx(u6,{}),c.jsx(h6,{})]})})}),{useEmitter:rT,useEmitterValue:Mt,usePublisher:Bs}=Y2(c6,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},m6),g6=tT({useEmitter:rT,useEmitterValue:Mt,usePublisher:Bs}),x6=nT({useEmitter:rT,useEmitterValue:Mt,usePublisher:Bs});function C_(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,cs.WARN),e==="normal"?0:parseInt(e??"0",10)}function St({className:t,...e}){return c.jsx("div",{className:Pe("mmg-card rounded-2xl bg-white/70 dark:bg-white/5 backdrop-blur-xs shadow-soft","ring-1 ring-black/5 dark:ring-white/10",t),...e})}function Gt({className:t,...e}){return c.jsx("div",{className:Pe("p-5 pb-3",t),...e})}function Yt({className:t,...e}){return c.jsx("h3",{className:Pe("text-base font-semibold",t),...e})}function Qt({className:t,...e}){return c.jsx("div",{className:Pe("p-5 pt-0",t),...e})}const Tg=new Set,Pg=6;function y6(){const t=Gs(),[e,n]=v.useState([]),[s,r]=v.useState(""),[i,o]=v.useState([]),[a,l]=v.useState(""),[u,d]=v.useState(!0),[h,f]=v.useState(!1),[p,w]=v.useState(null),[x,y]=v.useState(!1),g=v.useRef(null),m=v.useRef(null),b=v.useRef(null),k=v.useRef(null),_=v.useRef(0),C=v.useRef(!1);v.useEffect(()=>{gc()&&Promise.allSettled([t.prefetchQuery({queryKey:["mockup","eligibility","setup"],queryFn:g2}),t.prefetchQuery({queryKey:["mockup","eligibility","generate"],queryFn:x2})])},[t]),v.useEffect(()=>{console.log("[ChatPage] Mount - starting loadHistory, showing loading spinner");async function O(){var $,D;try{console.log("[ChatPage] Fetching history from API...");const F=await fB({limit:500,newestFirst:!0});if(console.log("[ChatPage] History received:",{messageCount:(($=F==null?void 0:F.messages)==null?void 0:$.length)||0}),(D=F==null?void 0:F.messages)!=null&&D.length){const K=F.messages.map(C6);n(K),w(F.session_id||null),d(!1),console.log("[ChatPage] Loading complete - hiding spinner, showing messages"),P();const T=K.flatMap(R=>R.files||[]).filter(R=>R==null?void 0:R.file_id).map(R=>R.file_id);T.length>0&&(console.log("[ChatPage] Loading URLs for",T.length,"attachments in background..."),pB(T).then(R=>{console.log("[ChatPage] Attachment URLs loaded:",Object.keys((R==null?void 0:R.urls)||{}).length),R!=null&&R.urls&&(n(V=>V.map(G=>({...G,files:(G.files||[]).map(Q=>{const re=R.urls[Q.file_id];if(re){const ee=typeof re=="string"?re:re.full||re.url;return{...Q,url:ee,width:re.width||Q.width,height:re.height||Q.height}}return Q})}))),P())}).catch(R=>{console.warn("[ChatPage] Failed to load attachment URLs:",R)}))}else console.log("[ChatPage] No history - showing greeting"),n([N_()]),d(!1),P()}catch(F){console.error("[ChatPage] Failed to load history:",F),n([N_()]),d(!1),P()}}O()},[]),v.useEffect(()=>{const O=sessionStorage.getItem("pendingChatRequest");if(O)try{const $=JSON.parse(O),{requestId:D,eventIndex:F,userMessage:K,timestamp:T,assistantMsgId:R}=$,V=5*60*1e3;if(Date.now()-T>V){console.log("[ChatPage] Pending request expired, clearing"),sessionStorage.removeItem("pendingChatRequest");return}console.log("[ChatPage] Found pending request, attempting resume:",D),y(!0);const G=crypto.randomUUID(),Q=R||crypto.randomUUID(),re={id:G,role:"user",content:K,files:[],status:null},ee={id:Q,role:"assistant",content:"",files:[],status:"Resuming"};n(A=>[...A,re,ee]),f(!0);let z="";gB({requestId:D,eventIndex:F||0,onEvent:A=>{var Y;if(_.current++,A!=null&&A.conversation_id&&w(U=>U||A.conversation_id),A!=null&&A.error){n(U=>U.map(J=>J.id===Q?{...J,status:null,content:`Error: ${A.error}`}:J));return}if((A==null?void 0:A.type)==="status"){n(U=>U.map(J=>J.id===Q?{...J,status:A.content||"Processing"}:J));return}if((A==null?void 0:A.type)==="delete"){n(U=>U.map(J=>J.id===Q?{...J,status:null}:J));return}if((A==null?void 0:A.type)==="tool_call"){const U=((Y=A.tool)==null?void 0:Y.name)||"processing";n(J=>J.map(be=>be.id===Q?{...be,status:`Processing ${U}`}:be));return}if(((A==null?void 0:A.type)==="chunk"||(A==null?void 0:A.type)==="content")&&A.content){z=A.type==="content"?A.content:z+A.content,n(U=>U.map(J=>J.id===Q?{...J,status:null,content:z}:J));return}if(A!=null&&A.content&&!A.type){z+=A.content,n(U=>U.map(J=>J.id===Q?{...J,status:null,content:z}:J));return}if(((A==null?void 0:A.type)==="files"||(A==null?void 0:A.type)==="file")&&(A.files||A.file||A.file_id)){const U=A.file||{},J=A.files||(A.file?[{file_id:U.file_id,url:U.url,filename:U.filename,title:U.title}]:[{file_id:A.file_id,url:A.url,filename:A.filename,title:A.title}]),be=U.comment||A.comment||"";be&&(z=be),n(me=>me.map(H=>H.id===Q?{...H,content:be||H.content,files:[...H.files||[],...J]}:H));return}},onDone:()=>{console.log("[ChatPage] Resume completed successfully"),sessionStorage.removeItem("pendingChatRequest"),n(A=>A.map(Y=>{var U;return Y.id===Q&&!Y.content&&!((U=Y.files)!=null&&U.length)?{...Y,status:null,content:"I'm ready to help. What would you like to do?"}:Y.id===Q?{...Y,status:null}:Y})),f(!1),y(!1)},onError:A=>{console.error("[ChatPage] Resume failed:",A),sessionStorage.removeItem("pendingChatRequest"),n(Y=>Y.map(U=>U.id===Q?{...U,status:null,content:"Failed to resume previous request. Please try again."}:U)),f(!1),y(!1)},onNotFound:()=>{console.log("[ChatPage] Request not found on server, clearing pending state"),sessionStorage.removeItem("pendingChatRequest"),n(A=>A.filter(Y=>Y.id!==G&&Y.id!==Q)),f(!1),y(!1)}})}catch($){console.error("[ChatPage] Error parsing pending request:",$),sessionStorage.removeItem("pendingChatRequest")}},[]);const S=v.useMemo(()=>(s.trim().length>0||i.length>0)&&!h,[s,i.length,h]),j=v.useMemo(()=>e.filter(O=>!O.is_tool_response),[e]),E=v.useCallback((O=!1)=>{var $,D;O?($=b.current)==null||$.scrollToIndex({index:"LAST",behavior:"auto",align:"end"}):(D=b.current)==null||D.scrollToIndex({index:"LAST",behavior:"smooth",align:"end"})},[]),P=v.useCallback(()=>{C.current||(C.current=!0,E(!0),requestAnimationFrame(()=>E(!0)),setTimeout(()=>E(!0),120))},[E]),L=v.useCallback((O,$)=>c.jsx("div",{className:"px-2 py-1.5",style:{contain:"layout"},children:c.jsx(w6,{msg:$})}),[]);async function I(){var G,Q;if(!S)return;const O=s.trim(),$=i,D=$.map(re=>({filename:re.name,preview_url:URL.createObjectURL(re)})),F=O||($.length===1?`Please process this file: ${$[0].name}`:`Please process these files: ${$.map(re=>re.name).join(", ")}`),K=crypto.randomUUID(),T={id:K,role:"user",content:O,files:D,status:null},R=crypto.randomUUID(),V={id:R,role:"assistant",content:"",files:[],status:"Thinking"};n(re=>[...re,T,V]),r(""),o([]),l(""),requestAnimationFrame(()=>E(!0));try{f(!0),(Q=(G=m.current)==null?void 0:G.abort)==null||Q.call(G);const re=new AbortController;m.current=re;let ee=[],z="";if($.length>0){const A=await Promise.all($.map(Y=>xB(Y)));if(A.some(Y=>!(Y!=null&&Y.file_id)))throw new Error("Upload failed");ee=A.map(Y=>Y.file_id),n(Y=>Y.map(U=>U.id===K?{...U,files:A.map((J,be)=>{var me,H;return{file_id:J.file_id,filename:((me=$[be])==null?void 0:me.name)||J.filename||"Attachment",url:J.url,width:J.image_width,height:J.image_height,preview_url:(H=D[be])==null?void 0:H.preview_url}})}:U))}k.current=null,_.current=0,await mB({conversationId:p,message:F,fileIds:ee,signal:re.signal,onEvent:A=>{var Y;if(!re.signal.aborted){if(_.current++,A!=null&&A.request_id&&!k.current&&(k.current=A.request_id,sessionStorage.setItem("pendingChatRequest",JSON.stringify({requestId:A.request_id,eventIndex:0,userMessage:F,assistantMsgId:R,timestamp:Date.now()}))),k.current&&_.current%5===0){const U=sessionStorage.getItem("pendingChatRequest");if(U){const J=JSON.parse(U);J.eventIndex=_.current,sessionStorage.setItem("pendingChatRequest",JSON.stringify(J))}}if(A!=null&&A.conversation_id&&w(U=>U||A.conversation_id),A!=null&&A.error){n(U=>U.map(J=>J.id===R?{...J,status:null,content:`Error: ${A.error}`}:J));return}if((A==null?void 0:A.type)==="status"){const U=oT(A.content||"Processing");n(J=>J.map(be=>be.id===R?{...be,status:U}:be));return}if((A==null?void 0:A.type)==="delete"){n(U=>U.map(J=>J.id===R?{...J,status:null}:J));return}if((A==null?void 0:A.type)==="tool_call"){const U=((Y=A.tool)==null?void 0:Y.name)||"processing";n(J=>J.map(be=>be.id===R?{...be,status:`Processing ${U}`}:be));return}if(((A==null?void 0:A.type)==="chunk"||(A==null?void 0:A.type)==="content")&&A.content){z=A.type==="content"?A.content:z+A.content,n(U=>U.map(J=>J.id===R?{...J,status:null,content:ad(z)}:J));return}if(A!=null&&A.content&&!A.type){z+=A.content,n(U=>U.map(J=>J.id===R?{...J,status:null,content:ad(z)}:J));return}if(((A==null?void 0:A.type)==="files"||(A==null?void 0:A.type)==="file")&&(A.files||A.file||A.file_id)){const U=A.file||{},J=A.files||(A.file?[{file_id:U.file_id,url:U.url,filename:U.filename,title:U.title}]:[{file_id:A.file_id,url:A.url,filename:A.filename,title:A.title}]),be=U.comment||A.comment||"";be&&(z=be),n(me=>me.map(H=>H.id===R?{...H,content:be||H.content,files:[...H.files||[],...J]}:H));return}}},onDone:()=>{sessionStorage.removeItem("pendingChatRequest"),k.current=null,_.current=0,n(A=>A.map(Y=>{var U;return Y.id===R&&!Y.content&&!((U=Y.files)!=null&&U.length)?{...Y,status:null,content:"I'm ready to help. What would you like to do?"}:Y.id===R?{...Y,status:null}:Y}))}})}catch(re){sessionStorage.removeItem("pendingChatRequest"),k.current=null,_.current=0,n(ee=>ee.map(z=>z.id===R?{...z,status:null,content:(re==null?void 0:re.message)||"Failed to get response"}:z))}finally{f(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(St,{className:"p-4 overflow-hidden flex-1 min-h-0",children:u?c.jsx("div",{className:"h-full flex items-center justify-center",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ve,{text:"Loading conversation"})})}):c.jsx(n6,{ref:b,className:"h-full scrollbar-thin",data:j,initialTopMostItemIndex:j.length-1,followOutput:"smooth",overscan:200,increaseViewportBy:{top:200,bottom:200},computeItemKey:(O,$)=>$.id,itemContent:L,skipAnimationFrameInResizeObserver:!0})}),c.jsxs(St,{className:"p-3",children:[a?c.jsx("div",{className:"mb-2 text-xs text-red-600 dark:text-red-300",children:a}):null,i.length>0&&c.jsx("div",{className:"mb-2 space-y-1",children:i.map((O,$)=>c.jsxs("div",{className:"flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:O.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>{o(D=>D.filter((F,K)=>K!==$)),l("")},children:""})]},`${O.name}-${O.size}-${$}`))}),c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:g,type:"file",className:"hidden",multiple:!0,onChange:O=>{const $=Array.from(O.target.files||[]);$.length&&(o(D=>{const F=Math.max(0,Pg-D.length);if(F<=0)return l(`You can upload up to ${Pg} files.`),D;const K=$.slice(0,F);return $.length>F?l(`You can upload up to ${Pg} files.`):l(""),[...D,...K]}),O.target.value="")},accept:"image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var O;return(O=g.current)==null?void 0:O.click()},children:c.jsx(aN,{size:18})}),c.jsx(S6,{value:s,onChange:r,placeholder:"Type your message...",onEnter:I}),c.jsx(se,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!S,onClick:I,children:c.jsx(lN,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"AI can make mistakes. Verify important information."})]})]})}const H0=320,v6=200,iT=320,b6=100,w6=ve.memo(function({msg:e}){var d;const n=e.role==="user",s=v.useMemo(()=>N6(e.content||""),[e.content]),r=!!e.status,i=e.files||[],o=i.some(h=>{const f=Ly((h==null?void 0:h.filename)||(h==null?void 0:h.url)||"");return["jpg","jpeg","png","gif","webp","bmp"].includes(f)}),a=i.some(h=>{const f=Ly((h==null?void 0:h.filename)||(h==null?void 0:h.url)||"");return f&&!["jpg","jpeg","png","gif","webp","bmp"].includes(f)}),l=o?H0:a?iT:null,u=v.useMemo(()=>{const h={overflowWrap:"anywhere",wordBreak:"break-word"};return l?{...h,maxWidth:l}:h},[l]);return c.jsx("div",{className:n?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",n?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[r?c.jsx(j6,{text:e.status}):c.jsx("div",{dangerouslySetInnerHTML:{__html:s},style:u}),((d=e.files)==null?void 0:d.length)>0&&c.jsx("div",{className:"mt-2 space-y-1",children:e.files.map((h,f)=>c.jsx(k6,{file:h,isUser:n},h.file_id||`file-${f}`))})]})})}),k6=ve.memo(function({file:e,isUser:n}){const s=Ly(e.filename||e.url||""),r=["jpg","jpeg","png","gif","webp","bmp"].includes(s),i=e.filename||"Attachment",o=f=>f&&!f.startsWith("/api/"),a=e.preview_url||(o(e.url)?e.url:null),l=a;if(r){const f={width:H0,maxWidth:"100%"};return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",style:f,children:[c.jsx(_6,{src:a,fullUrl:l,alt:i,isUser:n}),!n&&l&&o(l)&&c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(po,{size:14,className:"mr-1"})," Open"]})}),c.jsxs(se,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>E_(l,i),children:[c.jsx(ja,{size:14,className:"mr-1"})," Download"]})]})]})}const u=s==="pdf",d=s==="pdf",h={width:iT,height:b6,maxWidth:"100%"};return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3 flex flex-col",style:h,children:[c.jsxs("div",{className:"flex items-start gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:[u?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(n0,{size:12})," PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:s?s.toUpperCase():"FILE"}),n?null:c.jsx("div",{className:"text-xs font-semibold text-black/80 dark:text-white/85 leading-5 truncate",children:i})]}),!n&&l&&c.jsxs("div",{className:"mt-auto pt-3 flex items-center gap-2",children:[d?c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(po,{size:14,className:"mr-1"})," Open"]})}):null,c.jsxs(se,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>E_(l,i),children:[c.jsx(ja,{size:14,className:"mr-1"})," Download"]})]})]})}),_6=ve.memo(function({src:e,fullUrl:n,alt:s,isUser:r}){const i=e&&Tg.has(e),[o,a]=v.useState(i),[l,u]=v.useState(!1);v.useEffect(()=>{e&&Tg.has(e)?a(!0):e&&(a(!1),u(!1))},[e]);const d=v.useCallback(()=>{e&&Tg.add(e),a(!0)},[e]),h=v.useCallback(()=>{u(!0)},[]),f=v.useMemo(()=>({width:H0,height:v6,maxWidth:"100%"}),[]);if(l)return c.jsx("div",{className:"flex items-center justify-center bg-black/5 dark:bg-white/5 rounded-lg",style:f,children:c.jsx(KM,{className:"text-red-400",size:24})});const p=c.jsxs("div",{className:"relative overflow-hidden rounded-lg bg-black/5 dark:bg-white/5",style:{...f,contain:"layout"},children:[e?c.jsx("img",{src:e,alt:s,className:`w-full h-full object-contain transition-opacity duration-150 ${o?"opacity-100":"opacity-0"}`,onLoad:d,onError:h}):null,o?null:c.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})]});return!r&&n?c.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"block",children:p}):p});function S6({value:t,onChange:e,placeholder:n,onEnter:s}){const r=v.useRef(null);return v.useEffect(()=>{const i=r.current;i&&(i.style.height="0px",i.style.height=Math.min(i.scrollHeight,132)+"px")},[t]),c.jsx("textarea",{ref:r,rows:1,value:t,onChange:i=>e(i.target.value),onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),s==null||s())},placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function j6({text:t}){const e=oT(t||"Thinking");return c.jsx("span",{className:"inline-flex items-center opacity-80",children:c.jsx(Ve,{text:e})})}function ad(t){return t?String(t).replace(/_+Building Proposal\.{3,}_+/gi,"Building Proposal").replace(/_?Building Proposal\.{3,}_?/gi,"Building Proposal"):""}function oT(t){return t?ad(t).replace(/\s*\.{3,}$/,"").trim():"Thinking"}function C6(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||"assistant",content:ad(t.content||""),files:t.files||t.attachments||[],status:null,is_tool_response:!!t.is_tool_response}}function N_(){const t=new Date().getHours(),e=t>=5&&t<12?"morning":t<17?"afternoon":t<21?"evening":"night";return{id:crypto.randomUUID(),role:"assistant",content:`Good ${e}, how can I help?`,files:[],status:null}}function Ly(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length>1?n.pop().toLowerCase():""}async function E_(t,e){try{const n=gc(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{window.open(t,"_blank")}}function $y(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function N6(t){if(!t)return"";t=ad(t);const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(u,d,h)=>(e.push({lang:d,code:h.trim()}),`__CODE_BLOCK_${e.length-1}__`));const s=[];n=n.replace(/`([^`]+)`/g,(u,d)=>(s.push(d),`__INLINE_CODE_${s.length-1}__`));const r=n.split(`
`),i=[];let o=!1,a=null;for(const u of r){const d=u.trim();if(/^_?Building Proposal\.{3,}_?$/i.test(d)){i.push("Building Proposal<br>");continue}const h=u.match(/^__CODE_BLOCK_(\d+)__$/);if(h){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const x=e[parseInt(h[1])];i.push(`<pre class="chat-code-block"><code>${$y(x.code)}</code></pre>`);continue}const f=u.match(/^(#{1,6})\s+(.*)$/);if(f){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const x=f[1].length;i.push(`<h${x} class="chat-header">${Lh(f[2])}</h${x}>`);continue}const p=u.match(/^[-*]\s+(.*)$/);if(p){(!o||a!=="ul")&&(o&&i.push("</ol>"),i.push('<ul class="chat-list">'),o=!0,a="ul"),i.push(`<li>${Lh(p[1])}</li>`);continue}const w=u.match(/^\d+\.\s+(.*)$/);if(w){(!o||a!=="ol")&&(o&&i.push("</ul>"),i.push('<ol class="chat-numbered-list">'),o=!0,a="ol"),i.push(`<li>${Lh(w[1])}</li>`);continue}o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1),u.trim()===""?i.push("<br>"):i.push(Lh(u)+"<br>")}o&&i.push(a==="ul"?"</ul>":"</ol>");let l=i.join("");return s.forEach((u,d)=>{l=l.replace(`__INLINE_CODE_${d}__`,`<code class="chat-inline-code">${$y(u)}</code>`)}),l}function Lh(t){return t?$y(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>"):""}function Ee({label:t,children:e,className:n,labelClassName:s,withGap:r=!0}){return c.jsxs("label",{className:Pe("block",r&&"space-y-1",n),children:[c.jsx("div",{className:Pe("text-xs font-semibold text-black/60 dark:text-white/65",s),children:t}),e]})}function ot({value:t="",options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,className:i,contentClassName:o,useNativeSelect:a=!1}){const l=v.useMemo(()=>e.find(u=>u.value===t),[e,t]);return a?c.jsxs("select",{className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","disabled:opacity-60 disabled:cursor-not-allowed",i),value:t,onChange:u=>n==null?void 0:n(u.target.value),disabled:r,children:[s?c.jsx("option",{value:"",disabled:!0,children:s}):null,e.map(u=>c.jsx("option",{value:u.value,disabled:u.disabled,children:u.label},u.value))]}):r?c.jsxs("button",{type:"button",disabled:!0,className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Pe("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(ss,{size:16,className:"text-black/50 dark:text-white/60"})]}):c.jsxs(im,{children:[c.jsx(om,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Pe("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(ss,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx($d,{align:"start",className:Pe("min-w-[220px]",o),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(u=>{const d=u.value===t;return c.jsx(Ju,{disabled:u.disabled,onSelect:()=>{u.disabled||n==null||n(u.value)},className:Pe("cursor-pointer gap-0 py-1",d&&"bg-black/5 dark:bg-white/10 font-semibold"),children:c.jsx("span",{className:"min-w-0 truncate",children:u.label})},u.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]})}function E6({locations:t,timeOfDay:e,side:n,templateOptions:s,getTemplateKey:r,defaultFrameConfig:i,templateKey:o,setTemplateKey:a,venueType:l,timeOfDayDisabled:u,locationOptions:d}){const[h,f]=v.useState(""),p=o??h,w=a??f,[x,y]=v.useState(null),[g,m]=v.useState(i),[b,k]=v.useState(""),[_,C]=v.useState([]),[S,j]=v.useState(!1),[E,P]=v.useState([]),[L,I]=v.useState(!1),[O,$]=v.useState(""),D=ve.useRef([]),F=v.useMemo(()=>{const A=new Map;return s.forEach(Y=>{A.set(r(Y),Y)}),A},[r,s]),K=v.useMemo(()=>{const A=new Map;return(d||[]).forEach(Y=>{const U=(Y==null?void 0:Y.location_key)??(Y==null?void 0:Y.key)??(Y==null?void 0:Y.id)??(Y==null?void 0:Y.value)??Y;if(!U)return;const J=(Y==null?void 0:Y.display_name)??(Y==null?void 0:Y.name)??(Y==null?void 0:Y.label)??U;A.set(String(U),J)}),A},[d]),T=v.useMemo(()=>t.length?t.map(A=>K.get(String(A))||A).filter(Boolean).join(", "):"",[K,t]),R=(x==null?void 0:x.frame_count)||0,V=_.length>1,G=V&&!x,Q=V&&R&&_.length!==R,re=G?"Select a template to map multiple creatives to frames.":Q?`Upload exactly ${R} creatives to match the template frames.`:"",ee=t.length&&(_.length||b.trim())&&!L&&!re;v.useEffect(()=>{if(!p){y(null),m(i);return}const A=F.get(p);if(!A){y(null),m(i);return}y(A),m(bf(A.config,i))},[i,p,F]),v.useEffect(()=>{p&&w("")},[n,e,t,l,u]),v.useEffect(()=>{D.current=E},[E]),v.useEffect(()=>()=>{O6(D.current)},[]);async function z(){if(ee){$("");try{I(!0);const A=new FormData,Y=u?"all":e;A.append("location_key",t[0]||""),A.append("location_keys",JSON.stringify(t)),A.append("venue_type",l),x?(A.append("time_of_day",x.time_of_day||Y||"all"),A.append("side",x.side||n||"all"),A.append("specific_photo",x.photo),A.append("frame_config",JSON.stringify(g))):(A.append("time_of_day",Y||"all"),A.append("side",n||"all")),b.trim()?A.append("ai_prompt",b.trim()):_.length&&_.forEach(me=>A.append("creative",me.file));const U=await jB(A),J=await R6(U,T),be={id:crypto.randomUUID(),location:T,images:J};P(me=>[be,...me])}catch(A){$((A==null?void 0:A.message)||"Unable to generate mockup.")}finally{I(!1)}}}return{templateKey:p,setTemplateKey:w,aiPrompt:b,setAiPrompt:k,creativeFiles:_,setCreativeFiles:C,creativeDragActive:S,setCreativeDragActive:j,multiCreativeError:re,selectedTemplate:x,lastResults:E,generating:L,generateError:O,setGenerateError:$,onGenerate:z,canGenerate:ee}}function T6(t){const e=E6(t);return c.jsx(P6,{...t,...e})}function P6({locations:t,setLocations:e,venueType:n,setVenueType:s,setTemplateKey:r,locationOptions:i,locationsQuery:o,timeOfDay:a,setTimeOfDay:l,timeOfDayDisabled:u,sideDisabled:d,side:h,setSide:f,timeOfDayOptions:p,sideOptions:w,venueTypeOptions:x,templateKey:y,templateOptions:g,templatesQuery:m,templateThumbs:b,getTemplateKey:k,setCreativeFiles:_,creativeFiles:C,creativeDragActive:S,setCreativeDragActive:j,multiCreativeError:E,selectedTemplate:P,aiPrompt:L,setAiPrompt:I,generateError:O,setGenerateError:$,generating:D,onGenerate:F,canGenerate:K,lastResults:T,useNativeSelects:R}){const V=v.useMemo(()=>i.map(H=>{const ye=(H==null?void 0:H.key)??(H==null?void 0:H.id)??(H==null?void 0:H.value)??H,X=(H==null?void 0:H.name)??(H==null?void 0:H.label)??ye;return{value:ye,label:X}}),[i]),G=P==null?void 0:P.frame_count,Q=v.useMemo(()=>T.flatMap(H=>(H.images||[]).map((ye,X)=>({entryId:H.id,location:H.location,image:ye,index:X}))),[T]);function re(H){const ye=Array.from(H||[]).filter(Boolean);ye.length&&(_(X=>{const ue=[...X];return ye.forEach(de=>{ue.some(oe=>oe.file.name===de.name&&oe.file.size===de.size&&oe.file.lastModified===de.lastModified)||ue.push({id:crypto.randomUUID(),file:de})}),ue}),I(""))}function ee(H){H.preventDefault(),j(!0)}function z(H){H.preventDefault(),j(!1)}function A(H){var ye;H.preventDefault(),j(!1),re((ye=H.dataTransfer)==null?void 0:ye.files)}function Y(H){_(ye=>ye.filter(X=>X.id!==H))}function U(){_([])}function J(H){I(H),H.trim()&&_([])}function be(){e([]),s("all"),l("all"),f("all"),r(""),_([]),I(""),$("")}const me=v.useRef(null);return c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Mockup Generator"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[c.jsxs(Ee,{label:"Location",children:[c.jsx(ot,{value:t[0]||"",options:V,placeholder:"Select a location",onChange:H=>{e(H?[H]:[]),s("all"),l("all"),f("all"),r("")},useNativeSelect:R}),o.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading locations"})}):null]}),c.jsx(Ee,{label:"Venue Type",children:c.jsx(ot,{value:n,options:x,onChange:H=>s(H),useNativeSelect:R})}),!u&&c.jsx(Ee,{label:"Time of Day",children:c.jsx(ot,{value:a,options:p,onChange:H=>l(H),useNativeSelect:R})}),!d&&c.jsx(Ee,{label:"Billboard Side",children:c.jsx(ot,{value:h,options:w,onChange:H=>f(H),useNativeSelect:R})})]}),t.length?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Templates (optional)"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Select a template or keep random."})]}),y?c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>r(""),children:"Use random"}):null]}),m.isLoading?c.jsx(Ve,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!m.isLoading&&!g.length?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:g.map(H=>{const ye=k(H),X=ye===y,ue=b[ye];return c.jsxs("div",{className:Pe("rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-left text-sm transition flex flex-col",X?"border-2":"hover:bg-black/5 dark:hover:bg-white/10"),style:X?{borderColor:"rgb(var(--brand-accent) / 0.6)",boxShadow:"0 0 0 1px rgb(var(--brand-accent) / 0.25)"}:void 0,children:[c.jsx("button",{type:"button",onClick:()=>r(ye),className:"text-left flex flex-col flex-1",children:c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:ue?c.jsx("img",{src:ue,alt:H.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})})}),c.jsx("div",{className:"pt-2",children:ue?c.jsx(se,{variant:"secondary",size:"sm",className:"w-full rounded-xl",asChild:!0,children:c.jsxs("a",{href:ue,target:"_blank",rel:"noreferrer",children:[c.jsx(po,{size:16,className:"mr-2"}),"Open"]})}):c.jsx(se,{variant:"secondary",size:"sm",className:"w-full rounded-xl",disabled:!0,children:"Open"})})]},ye)})})]}):null,c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsxs(Ee,{label:"Upload Creative/Ad Image",children:[C.length?c.jsx("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:ee,onDragLeave:z,onDrop:A,children:c.jsxs("div",{className:"w-full space-y-2",children:[C.map(H=>c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("div",{className:"truncate",children:H.file.name}),c.jsx("button",{type:"button",className:"opacity-70 hover:opacity-100",onClick:ye=>{ye.preventDefault(),ye.stopPropagation(),Y(H.id)},children:"x"})]},H.id)),c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-black/50 dark:text-white/60",children:[c.jsxs("span",{children:[C.length," file",C.length>1?"s":""," selected"]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"underline",onClick:()=>{var H;return(H=me.current)==null?void 0:H.click()},children:"Add more"}),c.jsx("button",{type:"button",className:"underline",onClick:U,children:"Clear all"})]})]})]})}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:ee,onDragLeave:z,onDrop:A,children:[c.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:"image/jpeg,image/png,image/webp,image/gif",onChange:H=>{re(H.target.files),H.target.value=""}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP, GIF up to 10MB each"})]}),c.jsx("input",{ref:me,type:"file",multiple:!0,accept:"image/jpeg,image/png,image/webp,image/gif",className:"hidden",onChange:H=>{re(H.target.files),H.target.value=""}}),c.jsx("div",{className:"mt-2 text-xs text-black/55 dark:text-white/60",children:G&&G>1?`Upload 1 image to reuse across ${G} frames, or upload exactly ${G} images (one per frame).`:G===1?"Upload 1 image.":"Upload 1 image to reuse across frames, or select a template to upload multiple images."}),E?c.jsx("div",{className:"mt-2 text-xs text-red-600 dark:text-red-300",children:E}):null]}),c.jsx(Ee,{label:"Or use AI prompt",children:c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px]",value:L,onChange:H=>J(H.target.value),placeholder:"Describe what you want to generate..."})})]}),O?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:O}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(se,{className:"rounded-2xl",onClick:F,disabled:!K,children:D?c.jsx(Ve,{text:"Generating Mockup"}):"Generate Mockup"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:be,disabled:D,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4",children:[!T.length&&!D?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,D?c.jsx(Ve,{text:"Processing mockup",className:"text-sm text-black/60 dark:text-white/65"}):null,T.length?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Mockups generated this session"}),Q.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:Q.map(H=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("a",{href:H.image.url,target:"_blank",rel:"noopener noreferrer",className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:H.image.url,alt:H.image.label||"Generated mockup",className:"w-full h-40 object-cover",loading:"lazy"})}),c.jsxs("div",{className:"mt-2 space-y-2",children:[H.location?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60 truncate",children:H.location}):null,c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:H.image.url,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(po,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:ye=>{ye.preventDefault(),R_(H.image.url,H.image.filename)},onKeyDown:ye=>{(ye.key==="Enter"||ye.key===" ")&&(ye.preventDefault(),R_(H.image.url,H.image.filename))},className:"inline-flex items-center",children:[c.jsx(ja,{size:14,className:"mr-1"}),"Download"]})})]})]})]},`${H.entryId}-img-${H.index}`))}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No images returned yet."})]}):null]})]})]})}function T_(t){return typeof Blob<"u"&&t instanceof Blob}async function R6(t,e){if(!t)return[];if(t instanceof Response){const i=await t.blob();return i?[Rg(i,e,1)]:[]}if(T_(t))return[Rg(t,e,1)];const n=t,s=(n==null?void 0:n.images)||(n==null?void 0:n.image_urls)||(n==null?void 0:n.urls)||(n==null?void 0:n.results)||(n==null?void 0:n.files)||(n==null?void 0:n.data)||null,r=Array.isArray(s)?s:n!=null&&n.url?[n.url]:[];return r.length?r.map((i,o)=>{if(typeof i=="string")return P_(i,e,o+1);if(T_(i))return Rg(i,e,o+1);const a=(i==null?void 0:i.url)||(i==null?void 0:i.image_url)||(i==null?void 0:i.file_url)||"";return P_(a,e,o+1)}):[]}function Rg(t,e,n){const s=URL.createObjectURL(t),r=Fy(s,e,n);return{url:s,filename:r}}function P_(t,e,n){return t?{url:t,filename:Fy(t,e,n)}:{url:"",filename:Fy("",e,n)}}function Fy(t,e,n){const s=A6(t);if(s)return s;const r=(e||"result").toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),i=n?`_${n}`:"";return`mockup_${r||"result"}${i}.jpg`}function A6(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function O6(t){(Array.isArray(t)?t:[]).forEach(n=>{((n==null?void 0:n.images)||[]).forEach(s=>{var r;(r=s==null?void 0:s.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(s.url)})})}async function R_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e||"download",document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function M6(t,e,n){return t.length?t.length<=n?t.join(", "):`${t.slice(0,n).join(", ")} +${t.length-n}`:e}function I6({value:t=[],options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,maxLabelCount:i=2,className:o,contentClassName:a}){const l=v.useMemo(()=>new Set(t),[t]),u=v.useMemo(()=>e.filter(f=>l.has(f.value)).map(f=>f.label),[e,l]);function d(f){r||n&&(l.has(f)?n(t.filter(p=>p!==f)):n([...t,f]))}const h=M6(u,s,i);return c.jsxs("div",{className:"space-y-2",children:[c.jsxs(im,{children:[c.jsx(om,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Pe("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",o),children:[c.jsx("span",{className:Pe("truncate",!u.length&&"text-black/50 dark:text-white/55"),children:h}),c.jsx(ss,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx($d,{align:"start",className:Pe("min-w-[220px]",a),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(f=>{const p=l.has(f.value);return c.jsxs(Ju,{onSelect:w=>{w.preventDefault(),d(f.value)},className:"cursor-pointer py-1",children:[c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",p?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:10,className:p?"opacity-100":"opacity-0"})}),c.jsx("span",{className:"min-w-0 truncate",children:f.label})]},f.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]}),u.length?c.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(f=>c.jsx("span",{className:"text-[11px] rounded-md bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/70 px-2",children:f},f))}):null]})}function D6({locations:t,setLocations:e,venueType:n,setVenueType:s,assetType:r,setAssetType:i,setTemplateKey:o,locationOptions:a,locationsQuery:l,assetTypeOptions:u,assetTypesQuery:d,timeOfDay:h,setTimeOfDay:f,timeOfDayDisabled:p,sideDisabled:w,side:x,setSide:y,timeOfDayOptions:g,sideOptions:m,venueTypeOptions:b,editingTemplate:k,editingTemplateLoading:_,stopEditTemplate:C,templatesOpen:S,setTemplatesOpen:j,templateOptions:E,templatesQuery:P,templateThumbs:L,getTemplateKey:I,startEditTemplate:O,deleteTemplate:$,setupPhoto:D,setSetupPhoto:F,handleSetupPhoto:K,handleSetupDragOver:T,handleSetupDragLeave:R,handleSetupDrop:V,setupDragActive:G,handleSetupPhotoClear:Q,framesJson:re,setFramesJson:ee,setFramesJsonDirty:z,applyFramesJsonToCanvas:A,buildFramesPayload:Y,setupImageReady:U,greenscreenOpen:J,setGreenscreenOpen:be,greenscreenColor:me,setGreenscreenColor:H,greenscreenDetecting:ye,colorTolerance:X,setColorTolerance:ue,RangeField:de,handleGreenscreenDetect:he,canDetectGreenscreen:oe,hasActiveFrame:Se,frameSettingsOpen:ie,setFrameSettingsOpen:W,setupFrameConfig:ke,handleSetupFrameConfigChange:Re,FrameConfigControls:Oe,previewOpen:ae,setPreviewOpen:te,testPreviewMode:ne,setTestPreviewMode:je,testPreviewImgRef:Xt,testPreviewUrlRef:Ys,previewImgRef:Mn,drawPreview:Kn,activeTestCreativeFile:Qs,updateTestCreativeForActive:Hr,generateTestPreview:yr,testPreviewing:lt,activeFrameIndex:ct,canvasRef:ft,canvasWidth:dn,canvasHeight:bi,handleCanvasPointerDown:Eo,handleCanvasPointerMove:Fa,handleCanvasPointerUp:To,handleCanvasWheel:za,setupHint:Vd,handleZoomOut:qd,handleZoomIn:Ot,handleFitToScreen:pt,zoomPercent:Xs,pixelUpscale:Js,setPixelUpscale:ds,setupError:jc,setupMessage:Po,addFrame:Cc,resetCurrentFrame:hs,saveSetup:ut,setupSaving:mt,clearAllFrames:Ba,currentPoints:Sn,frameCount:jn,useNativeSelects:wi}){var Qd,Gn,Oo;const[fs,Ro]=v.useState({open:!1,template:null}),[ki,Ua]=v.useState(!1),Kd=((Qd=fs.template)==null?void 0:Qd.time_of_day)||"all",Ao=((Gn=fs.template)==null?void 0:Gn.side)||"all",Ha=((Oo=fs.template)==null?void 0:Oo.storage_key)||"",gm=Ha?` for ${Ha}`:"",xm=fs.template?`Delete "${fs.template.photo}" (${Kd}/${Ao})${gm}? This removes the photo and its frames.`:"Delete this template? This removes the photo and its frames.";async function Gd(){if(!(!fs.template||ki)){Ua(!0);try{await $(fs.template)}finally{Ua(!1),Ro({open:!1,template:null})}}}function Yd(){ki||Ro({open:!1,template:null})}return c.jsxs(c.Fragment,{children:[c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Mockup Setup"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[c.jsxs(Ee,{label:"Location",children:[c.jsx(I6,{value:t,onChange:le=>{e(le),o("")},options:a.map(le=>{const gn=(le==null?void 0:le.key)??(le==null?void 0:le.id)??(le==null?void 0:le.value)??le,_i=(le==null?void 0:le.name)??(le==null?void 0:le.label)??gn;return{value:gn,label:_i}}),placeholder:"Select locations"}),l.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading locations"})}):null]}),c.jsxs(Ee,{label:"Asset Type",children:[c.jsx(ot,{value:r,options:[{value:"",label:"All asset types"},...u.map(le=>typeof le=="string"?{value:le,label:le}:{value:(le==null?void 0:le.type_key)??(le==null?void 0:le.key)??(le==null?void 0:le.id)??(le==null?void 0:le.value)??"",label:(le==null?void 0:le.name)??(le==null?void 0:le.label)??(le==null?void 0:le.type_key)??"Unknown"})],placeholder:"Select asset type",onChange:le=>i(le),useNativeSelect:wi}),d!=null&&d.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading asset types"})}):null]}),c.jsx(Ee,{label:"Venue Type",children:c.jsx(ot,{value:n,options:b,placeholder:"Select venue type",onChange:le=>s(le),useNativeSelect:wi})}),!p&&c.jsx(Ee,{label:"Time of Day",children:c.jsx(ot,{value:h,options:g,placeholder:"Select time of day",onChange:le=>f(le),useNativeSelect:wi})}),!w&&c.jsx(Ee,{label:"Billboard Side",children:c.jsx(ot,{value:x,options:m,placeholder:"Select side",onChange:le=>y(le),useNativeSelect:wi})})]}),k?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/50 dark:bg-white/5 px-4 py-3 flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:"Editing template:"})," ",k.photo," (",k.time_of_day,"/",k.side,")"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[_?c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"}):null,c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,children:"Stop editing"})]})]}):null,k?null:c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>j(le=>!le),"aria-expanded":S,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Existing templates"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:t.length?`${E.length} template${E.length===1?"":"s"}`:"Select at least one location to load templates."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:S?"Hide":"Show"}),c.jsx(ss,{size:16,className:Pe("transition-transform",S&&"rotate-180")})]})]}),S?c.jsxs("div",{className:"mt-3 space-y-2",children:[P.isLoading?c.jsx(Ve,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!P.isLoading&&(!E.length||!t.length)?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:E.map(le=>{const gn=I(le);return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:L[gn]?c.jsx("img",{src:L[gn],alt:le.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-2",children:[c.jsx("div",{className:"font-semibold truncate",children:le.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[le.time_of_day,"/",le.side," - ",le.frame_count," frame",le.frame_count>1?"s":""]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>O(le),disabled:_||ki,children:"Edit"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>Ro({open:!0,template:le}),disabled:ki,children:"Delete"})]})]})]},gn)})})]}):null]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Upload Billboard Photo",children:D?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${G?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:T,onDragLeave:R,onDrop:V,children:[c.jsx("div",{className:"truncate",children:D.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:Q,children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${G?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:T,onDragLeave:R,onDrop:V,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp",onChange:le=>{var _i;const gn=(_i=le.target.files)==null?void 0:_i[0];gn&&(F(gn),K(gn))}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP up to 20MB"})]})}),c.jsxs(Ee,{label:"Frames Data",children:[c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px] font-mono",value:re,onChange:le=>{ee(le.target.value),z(!0)},placeholder:'[{"points":[0,0,0,0],"config":{"brightness":100}}]'}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-black/50 dark:text-white/60",children:[c.jsx("span",{children:"Auto-filled from canvas. Edit to override."}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"text-xs underline",onClick:A,children:"Apply to canvas"}),c.jsx("button",{type:"button",className:"text-xs underline",onClick:()=>{z(!1);const le=Y();ee(le.length?JSON.stringify(le,null,2):"[]")},children:"Sync from canvas"})]})]})]})]}),U?c.jsxs(c.Fragment,{children:[c.jsxs(zt,{className:"bg-white/50 dark:bg-white/5 p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>be(le=>!le),"aria-expanded":J,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Green Screen Detection"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Detect billboard frame using chroma key."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:J?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",J&&"rotate-180")})]})]}),J?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"color",value:me,onChange:le=>H(le.target.value.toUpperCase()),className:"h-10 w-16 rounded-lg border border-black/10 dark:border-white/20"}),c.jsx("input",{type:"text",value:me,onChange:le=>H(le.target.value.toUpperCase()),className:"flex-1 rounded-xl bg-white/70 dark:bg-white/10 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none font-mono"})]}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Tip: Shift+click to pick a color. Shift+drag or middle mouse pans."}),c.jsx(de,{label:"Color Tolerance",value:X,min:10,max:100,onChange:le=>ue(le),helper:"Lower is stricter, higher is more forgiving."}),c.jsx(se,{className:"rounded-2xl w-full",onClick:he,disabled:!oe||ye,children:ye?c.jsx(Ve,{text:"Detecting"}):"Detect Green Screen Now"})]}):null]}),Se?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>W(le=>!le),"aria-expanded":ie,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Current Frame Settings"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Adjust the current frame appearance."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:ie?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",ie&&"rotate-180")})]})]}),ie?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsx(Oe,{config:ke,onChange:Re}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Settings apply to the current frame only."})]}):null]}):null,Se?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>te(le=>!le),"aria-expanded":ae,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Test Preview Mode"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Preview creative on the current frame before saving."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:ae?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",ae&&"rotate-180")})]})]}),ae?c.jsxs("div",{className:"mt-3 space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3 text-sm",children:[c.jsx("input",{type:"checkbox",checked:ne,onChange:le=>{je(le.target.checked),le.target.checked||(Xt.current=null,Ys.current="",Kn())}}),c.jsx("span",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Enable preview"})]}),ne?c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-semibold text-blue-900 dark:text-blue-100",children:"Upload Test Creative"}),c.jsx("input",{type:"file",accept:"image/*",onChange:le=>{var gn;return Hr(((gn=le.target.files)==null?void 0:gn[0])||null)},className:"w-full text-sm"}),Qs?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Selected: ",Qs.name]}):null,c.jsx(se,{className:"rounded-2xl w-full",onClick:yr,disabled:!Qs||!D||!Se||lt,children:lt?c.jsx(Ve,{text:"Generating"}):"Generate Test Preview"}),ct>=0?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Preview applies to frame ",ct+1,"."]}):null]}):null]}):null]}):null]}):null]}),U?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-2",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:qd,disabled:!Mn.current,children:"-"}),c.jsx(se,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:Ot,disabled:!Mn.current,children:"+"}),c.jsx(se,{variant:"ghost",size:"sm",onClick:pt,disabled:!Mn.current,children:"Fit"}),c.jsxs("span",{className:"text-xs text-black/60 dark:text-white/60",children:[Xs,"%"]})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-black/70 dark:text-white/70",children:[c.jsx("input",{type:"checkbox",checked:Js,onChange:le=>ds(le.target.checked)}),"Pixel Upscale"]})]}),c.jsx("canvas",{ref:ft,width:dn,height:bi,className:"w-full h-auto rounded-xl border border-black/10 dark:border-white/10 bg-white",onPointerDown:Eo,onPointerMove:Fa,onPointerUp:To,onPointerLeave:To,onWheel:za,style:{touchAction:"none"}}),c.jsx("div",{className:"text-xs text-black/60 dark:text-white/60",children:Vd})]}):c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-black/5 dark:bg-white/10 px-4 py-3 text-sm text-black/60 dark:text-white/65",children:"Upload a billboard photo or pick an existing template to enable the canvas tools."})]}),jc?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:jc}):null,Po?c.jsx("div",{className:"rounded-xl bg-green-50/70 text-green-700 px-4 py-2 text-sm dark:bg-green-500/10 dark:text-green-200",children:Po}):null,c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(se,{className:"rounded-2xl",onClick:Cc,disabled:Sn.length!==4,children:"Add Frame"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:hs,children:"Reset Current Frame"}),c.jsx(se,{className:"rounded-2xl",onClick:ut,disabled:mt||!t.length||!D,children:mt?c.jsx(Ve,{text:"Saving"}):k?"Save Changes":"Save All Frames"}),c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>Ba(!1),children:"Clear All Frames"})]}),jn?c.jsxs("div",{className:"rounded-xl bg-blue-50/70 text-blue-900 px-3 py-2 text-sm dark:bg-blue-500/10 dark:text-blue-100",children:["Frames configured: ",jn]}):null]})]}),c.jsx(vc,{open:fs.open,message:xm,onClose:Yd,onConfirm:Gd})]})}const yp=[{value:"all",label:"All (Default)"},{value:"day",label:"Day"},{value:"night",label:"Night"}],L6=yp.filter(t=>t.value!=="all"),vp=[{value:"all",label:"All (Default)"},{value:"gold",label:"Gold"},{value:"silver",label:"Silver"},{value:"single_side",label:"Single Side"}],$6=vp.filter(t=>t.value!=="all"),W0=[{value:"all",label:"All (Default)"},{value:"outdoor",label:"Outdoor"},{value:"indoor",label:"Indoor"}],F6=W0.filter(t=>t.value!=="all"),z6=yp.reduce((t,e)=>(t[e.value]=e.label,t),{}),B6=vp.reduce((t,e)=>(t[e.value]=e.label,t),{}),U6=W0.reduce((t,e)=>(t[e.value]=e.label,t),{});function ga(t){return Array.from(new Set(t.filter(Boolean)))}function H6(t=[]){const e=new Set,n={},s={};t.forEach(o=>{const a=(o==null?void 0:o.venue_type)||(o==null?void 0:o.environment);if(!a)return;if(e.add(a),a==="indoor"){n[a]||(n[a]=[]),s[a]||(s[a]={});return}const l=(o==null?void 0:o.time_of_day)||"day",u=(o==null?void 0:o.side)||"gold";n[a]||(n[a]=[]),n[a].push(l),s[a]||(s[a]={}),s[a][l]||(s[a][l]=[]),s[a][l].push(u)});const r={};Object.keys(n).forEach(o=>{r[o]=ga(n[o])});const i={};return Object.keys(s).forEach(o=>{i[o]={},Object.keys(s[o]).forEach(a=>{i[o][a]=ga(s[o][a])})}),{has_frames:t.length>0,available_venue_types:ga(Array.from(e)),available_time_of_days:r,available_sides:i}}function Ag(t,e){return["all",...ga(t).filter(r=>r!=="all")].map(r=>({value:r,label:(e==null?void 0:e[r])||(r==="all"?"All (Default)":r)}))}const A_=!1,$h=1200,Fh=800,W6=.5,V6=4,O_=.1,q6=4,Vo={brightness:100,contrast:100,saturation:100,depthMultiplier:15,lightDirection:"top",imageBlur:0,edgeBlur:1,overlayOpacity:0,shadowIntensity:0,lightingAdjustment:0,colorTemperature:0,vignette:0,edgeSmoother:3,sharpening:0},aT=[{value:"top-left",label:"Top Left",glyph:""},{value:"top",label:"Top",glyph:""},{value:"top-right",label:"Top Right",glyph:""},{value:"left",label:"Left",glyph:""},{value:"center",label:"Center",glyph:""},{value:"right",label:"Right",glyph:""},{value:"bottom-left",label:"Bottom Left",glyph:""},{value:"bottom",label:"Bottom",glyph:""},{value:"bottom-right",label:"Bottom Right",glyph:""}],K6=aT.reduce((t,e)=>(t[e.value]=e.label,t),{});function G6(t,e,n){const s=(t-e)/(n-e)*100;return`linear-gradient(to right, rgb(var(--brand-accent, 102 126 234)) ${s}%, rgba(0, 0, 0, 0.1) ${s}%)`}function Y6(){var bb,wb;const t=Gs(),{user:e}=pi(),n=wf(e,"sales:mockups:setup"),s=Kt({queryKey:["service-visibility"],queryFn:E0,staleTime:3e4}),r=((bb=s.data)==null?void 0:bb.mockup_generate)!==!1,i=((wb=s.data)==null?void 0:wb.mockup_setup)!==!1,o=()=>r?"generate":i&&n?"setup":"history",[a,l]=v.useState(o);v.useEffect(()=>{a==="generate"&&!r?l(i&&n?"setup":"history"):a==="setup"&&!i&&l(r?"generate":"history")},[r,i,n,a]);const[u,d]=v.useState([]),[h,f]=v.useState("all"),[p,w]=v.useState(""),[x,y]=v.useState("all"),[g,m]=v.useState("all"),[b,k]=v.useState(""),_=u[0]||"",C=h==="indoor",S=C,j=C,E=S?"all":x;v.useEffect(()=>{h==="indoor"&&(x!=="all"&&y("all"),g!=="all"&&m("all"))},[h]);const P=v.useRef(a),[L,I]=v.useState(null),[O,$]=v.useState(!1),[D,F]=v.useState(""),[K,T]=v.useState(""),[R,V]=v.useState("[]"),[G,Q]=v.useState(!1),[re,ee]=v.useState({}),[z,A]=v.useState(null),[Y,U]=v.useState(!1),[J,be]=v.useState(!1),[me,H]=v.useState("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),[ye,X]=v.useState(Vo),[ue,de]=v.useState("#1CFF1C"),[he,oe]=v.useState(40),[Se,ie]=v.useState(!1),[W,ke]=v.useState([]),[Re,Oe]=v.useState(0),[ae,te]=v.useState(1),[ne,je]=v.useState(!1),[Xt,Ys]=v.useState(-1),[Mn,Kn]=v.useState(!1),[Qs,Hr]=v.useState(!0),[yr,lt]=v.useState(!0),[ct,ft]=v.useState(!0),[dn,bi]=v.useState(!0),[Eo,Fa]=v.useState(!1),[To,za]=v.useState({}),[Vd,qd]=v.useState(!1),Ot=v.useRef(null),pt=v.useRef(null),Xs=v.useRef(null),Js=v.useRef(""),ds=v.useRef(new Map),jc=v.useRef({}),Po=v.useRef({}),Cc=v.useRef([]),hs=v.useRef(!1),ut=v.useRef([]),mt=v.useRef([]),Ba=v.useRef(-1),Sn=v.useRef({zoom:1,panX:0,panY:0}),jn=v.useRef({isDrawing:!1,isDraggingCorner:!1,isDraggingFrame:!1,dragFrameIndex:-1,dragPointIndex:-1,startX:0,startY:0,isPanning:!1,shiftPanPending:!1,hasPanned:!1,panStartX:0,panStartY:0,panOriginX:0,panOriginY:0}),wi=v.useRef({pointers:new Map,isPinching:!1,startDistance:0,startZoom:1,startPanX:0,startPanY:0,startCenterX:0,startCenterY:0}),fs=v.useRef({drawX:0,drawY:0,drawW:0,drawH:0,scale:1,imgNaturalW:0,imgNaturalH:0}),Ro=Kt({queryKey:["mockup","eligibility","setup"],queryFn:g2,enabled:a==="setup"}),ki=Kt({queryKey:["mockup","eligibility","generate"],queryFn:x2,enabled:a==="generate"}),Ua=Kt({queryKey:["mockup","asset-types"],queryFn:yB,enabled:a==="setup"}),Kd=Kt({queryKey:["mockup","templates",_,"generate"],queryFn:()=>n_(_),enabled:a==="generate"&&!!_}),Ao=FM({queries:a==="setup"?u.map(N=>({queryKey:["mockup","templates",N,E,g,h],queryFn:()=>n_(N,{timeOfDay:E,side:g,venueType:h}),enabled:!!N,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:!1,staleTime:1/0})):[]}),Ha=v.useMemo(()=>{var q;return{data:Ao.flatMap((B,pe)=>{const Z=B.data,we=Array.isArray(Z)?Z:(Z==null?void 0:Z.templates)||[],Te=u[pe];return we.map(Le=>({...Le,storage_key:Le.storage_key||Te}))}),isLoading:Ao.some(B=>B.isLoading),isFetching:Ao.some(B=>B.isFetching),error:((q=Ao.find(B=>B.error))==null?void 0:q.error)||null}},[u,Ao]);v.useEffect(()=>()=>{ds.current.forEach(N=>{N!=null&&N.url&&URL.revokeObjectURL(N.url)}),ds.current.clear(),Js.current&&URL.revokeObjectURL(Js.current)},[]),v.useEffect(()=>{jc.current=To},[To]),v.useEffect(()=>{Po.current=re},[re]);const gm=v.useMemo(()=>{const N=Ro.data;return Array.isArray(N)?N:(N==null?void 0:N.locations)||[]},[Ro.data]),xm=v.useMemo(()=>{const N=ki.data;return Array.isArray(N)?N:(N==null?void 0:N.locations)||[]},[ki.data]),Gd=a==="setup"?gm:xm,Yd=a==="setup"?Ro:ki,Qd=v.useMemo(()=>{const N=Ua.data;return Array.isArray(N)?N:(N==null?void 0:N.asset_types)||(N==null?void 0:N.types)||[]},[Ua.data]),Gn=Kd.data,Oo=v.useMemo(()=>Array.isArray(Gn)?Gn:(Gn==null?void 0:Gn.templates)||[],[Gn]),le=v.useMemo(()=>Gn!=null&&Gn.available_configs?Gn.available_configs:H6(Oo),[Gn,Oo]),gn=v.useMemo(()=>{const N=(le==null?void 0:le.available_venue_types)||[];return N.length?Ag(N,U6):W0},[le]),_i=v.useMemo(()=>{const N=le==null?void 0:le.available_time_of_days;if(!N)return yp;let q=[];return h&&h!=="all"?q=N[h]||[]:q=ga(Object.values(N).flat()),q.length?Ag(q,z6):yp},[le,h]),ym=v.useMemo(()=>{const N=le==null?void 0:le.available_sides;if(!N)return vp;let q=[];if(h&&h!=="all"){const B=N[h]||{};x&&x!=="all"?q=B[x]||[]:q=ga(Object.values(B).flat())}else{const B=Object.values(N).flatMap(pe=>Object.values(pe));q=ga(B.flat())}return q.length?Ag(q,B6):vp},[le,h,x]),ob=v.useMemo(()=>{let N=Oo;return h&&h!=="all"&&(N=N.filter(q=>(q.environment||q.venue_type)===h)),x&&x!=="all"&&(N=N.filter(q=>q.time_of_day===x)),g&&g!=="all"&&(N=N.filter(q=>q.side===g)),N},[Oo,h,x,g]);v.useEffect(()=>{a==="generate"&&(gn.some(N=>N.value===h)||f("all"))},[a,gn,h]),v.useEffect(()=>{a!=="generate"||S||_i.some(N=>N.value===x)||y("all")},[a,S,_i,x]),v.useEffect(()=>{a!=="generate"||j||ym.some(N=>N.value===g)||m("all")},[a,j,ym,g]);const ab=v.useMemo(()=>{const N=Ha.data;return Array.isArray(N)?N:(N==null?void 0:N.templates)||[]},[Ha.data]),Xd=a==="setup"?ab:ob,lb=v.useMemo(()=>Xd.map(N=>kr(N)).join("|"),[Xd,kr]);v.useEffect(()=>{Cc.current=Xd},[Xd]),v.useEffect(()=>{P.current!==a&&(P.current==="setup"&&z&&db(),d([]),a==="setup"?(f(""),w(""),y(""),m("")):(f("all"),w(""),y("all"),m("all")),k("")),P.current=a},[z,a]),v.useEffect(()=>{h==="indoor"&&x&&y("all")},[x,h]),v.useEffect(()=>{ee(N=>{const q=new Set(Cc.current.map(Z=>kr(Z))),B={};let pe=!1;return Object.entries(N).forEach(([Z,we])=>{q.has(Z)?B[Z]=we:we&&(pe=!0,URL.revokeObjectURL(we))}),pe?B:N})},[lb,kr]),v.useEffect(()=>{let N=!0;const q=Cc.current;if(!_||!q.length)return()=>{};const B=q.filter(pe=>!Po.current[kr(pe)]);return B.length?((async()=>{const pe=await Promise.all(B.map(async we=>{const Te=kr(we);let Le="";try{Le=await CB(we.storage_key||_,we.photo,{timeOfDay:we.time_of_day||E,side:we.side||g,company:we.company,venueType:we.venue_type||we.environment||h})}catch{Le=""}return{key:Te,url:Le}}));if(!N){pe.forEach(({url:we})=>{we&&URL.revokeObjectURL(we)});return}const Z={};pe.forEach(({key:we,url:Te})=>{Te&&!Po.current[we]?Z[we]=Te:Te&&URL.revokeObjectURL(Te)}),Object.keys(Z).length>0&&ee(we=>({...we,...Z}))})(),()=>{N=!1}):()=>{}},[_,lb,E,g,h,kr]),v.useEffect(()=>()=>{Object.values(Po.current).forEach(N=>{N&&URL.revokeObjectURL(N)})},[]);const YT=!!pt.current,QT=W.length===4||Xt>=0,Zs=Xt>=0?`frame-${Xt}`:W.length===4?"current":null,cb=Zs?To[Zs]:null,XT=Math.round(ae*100);v.useEffect(()=>{if(!Zs){Xs.current=null,Js.current="";return}const N=ds.current.get(Zs);Xs.current=(N==null?void 0:N.img)||null,Js.current=(N==null?void 0:N.url)||"",Eo&&yt()},[Zs,To,Eo]),v.useEffect(()=>{pt.current&&Nc(),yt()},[Eo]),v.useEffect(()=>{yt()},[ne]),v.useEffect(()=>{Mn&&pt.current&&yt()},[Mn]),v.useEffect(()=>{if(G)return;const N=Wa();V(N.length?JSON.stringify(N,null,2):"[]")},[W,Re,ye,G]);async function JT(){F(""),T("");const N=z?kr(z):null;if(!u.length){T("Select at least one location first");return}if(!L){T("Upload a billboard photo first");return}let q=Wa();if(R.trim())try{q=JSON.parse(R)}catch(B){T((B==null?void 0:B.message)||"Frames JSON is invalid");return}if(!Array.isArray(q)||!q.length){T("Add at least one frame before saving");return}try{$(!0);const B=new FormData;z?(B.append("location_key",z.storage_key||_),B.append("photo_filename",z.photo),B.append("venue_type",h),p&&B.append("asset_type_key",p),B.append("time_of_day",E||"all"),B.append("side",g||"all"),B.append("frames_data",JSON.stringify(q)),L&&L.name!==z.photo&&B.append("photo",L),await bB(B),F("Updated frames successfully")):(B.append("location_keys",JSON.stringify(u)),B.append("venue_type",h),p&&B.append("asset_type_key",p),B.append("time_of_day",E||"all"),B.append("side",g||"all"),B.append("frames_data",JSON.stringify(q)),B.append("photo",L),await vB(B),F("Saved frames successfully")),vb(!0),A(null),U(!1),I(null),pt.current=null,Kn(!1),N&&ee(pe=>{if(!pe[N])return pe;const Z={...pe},we=Z[N];return we&&URL.revokeObjectURL(we),delete Z[N],Z}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"}),yt()}catch(B){T((B==null?void 0:B.message)||"Failed to save template")}finally{$(!1)}}async function ZT(N){const q=(N==null?void 0:N.storage_key)||_;if(!q||!(N!=null&&N.photo))return;const B=(N==null?void 0:N.environment)||(N==null?void 0:N.venue_type)||"outdoor",pe=N!=null&&N.time_of_day&&N.time_of_day!=="all"?N.time_of_day:"day",Z=N!=null&&N.side&&N.side!=="all"?N.side:"gold";try{N!=null&&N.company?await _B({company:N.company,locationKey:q,environment:B,timeOfDay:pe,side:Z,photoFilename:N.photo}):await wB(q,N.photo,{timeOfDay:N.time_of_day,side:N.side}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"})}catch(we){T((we==null?void 0:we.message)||"Failed to delete template")}}function ub(N,{resetFrames:q=!0}={}){pt.current=N,Kn(!0);const B=cP(N.naturalWidth,N.naturalHeight);fs.current={drawX:B.x,drawY:B.y,drawW:B.w,drawH:B.h,scale:B.scale,imgNaturalW:N.naturalWidth,imgNaturalH:N.naturalHeight},wm(!1),q&&(ut.current=[],mt.current=[],As(),hs.current=!1,yP(),Jd(),ps(),Io(),V("[]"),Q(!1)),Nc(),yt()}function eP(N,q){return new Promise((B,pe)=>{const Z=new Image;Z.onload=()=>{ub(Z,q),B()},Z.onerror=()=>pe(new Error("Failed to load image")),Z.src=N})}function tP(N,q){return new Promise((B,pe)=>{const Z=new FileReader;Z.onload=we=>{const Te=new Image;Te.onload=()=>{ub(Te,q),B()},Te.onerror=()=>pe(new Error("Failed to load image")),Te.src=we.target.result},Z.onerror=()=>pe(new Error("Failed to read image")),Z.readAsDataURL(N)})}function vm(N){return N?Array.isArray(N)&&N.length===4&&Array.isArray(N[0])?N:Array.isArray(N)&&N.length>=8&&typeof N[0]=="number"?[[N[0],N[1]],[N[2],N[3]],[N[4],N[5]],[N[6],N[7]]]:null:null}function nP(N){if(!N)return[];let q=N.frames||N.frames_data||N.framesData||N.frame_data||N.frame_points;if(typeof q=="string")try{q=JSON.parse(q)}catch{q=[]}return Array.isArray(q)?q.map(B=>{const pe=vm((B==null?void 0:B.points)||(B==null?void 0:B.frame_points)||B)||vm(B==null?void 0:B.points);if(!pe)return null;let Z=(B==null?void 0:B.config)||(N==null?void 0:N.config);if(typeof Z=="string")try{Z=JSON.parse(Z)}catch{Z=null}const we=bf(Z,Vo);return{points:pe,config:we,source:"existing"}}).filter(Boolean):[]}async function sP(N){if(!(!_||!(N!=null&&N.photo))){A(N),U(!0),T(""),F(""),I(null);try{const q=N.venue_type||N.environment||"outdoor",B=N.time_of_day&&N.time_of_day!=="all"?N.time_of_day:"day",pe=N.side&&N.side!=="all"?N.side:"gold";f(q),q==="indoor"?(y(""),m("")):(N.time_of_day&&N.time_of_day!=="all"?y(N.time_of_day):y(""),N.side&&N.side!=="all"?m(N.side):m(""));const Z=await m2(N.storage_key||_,N.photo,{timeOfDay:N.time_of_day||E,side:N.side||g,company:N.company,venueType:N.venue_type||N.environment||h});if(!Z)throw new Error("Failed to load template image");const we=URL.createObjectURL(Z);try{await eP(we,{resetFrames:!1})}finally{URL.revokeObjectURL(we)}let Te=N;if(N.company){const Xe=await kB({company:N.company,locationKey:N.storage_key||_,environment:q,timeOfDay:B,side:pe,photoFilename:N.photo});Xe!=null&&Xe.frames_data&&(Te={...N,frames_data:Xe.frames_data,config:Xe.config??N.config,time_of_day:Xe.time_of_day||N.time_of_day,side:Xe.side||N.side,environment:Xe.environment||N.environment})}const Le=nP(Te);mt.current=Le,ut.current=[],As(),hs.current=!1,ps(),Io(),V(Le.length?JSON.stringify(Wa(),null,2):"[]"),Q(!1),yt();const vt=new File([Z],N.photo,{type:Z.type||"image/jpeg"});I(vt)}catch(q){T((q==null?void 0:q.message)||"Failed to load template for editing")}finally{U(!1)}}}function db(){A(null),U(!1),F(""),T(""),y(""),m(""),I(null),pt.current=null,Kn(!1),ut.current=[],mt.current=[],As(),hs.current=!1,ps(),Io(),V("[]"),Q(!1),Nc(),yt()}function bm(N){const q=Ot.current;if(!q)return null;const B=q.getBoundingClientRect(),pe=q.width/B.width,Z=q.height/B.height;return{x:(N.clientX-B.left)*pe,y:(N.clientY-B.top)*Z}}function hb(N){return Math.min(V6,Math.max(W6,N))}function Mo(){const{drawX:N,drawY:q,drawW:B,drawH:pe,scale:Z}=fs.current,{zoom:we,panX:Te,panY:Le}=Sn.current;return{drawX:N+Te,drawY:q+Le,drawW:B*we,drawH:pe*we,scale:Z*we}}function wm(N=!0){Sn.current={zoom:1,panX:0,panY:0},te(1),N&&yt()}function fb(){const N=Ot.current;return N?{x:N.width/2,y:N.height/2}:{x:$h/2,y:Fh/2}}function pb(N,q,B){const{drawX:pe,drawY:Z,scale:we}=fs.current,{zoom:Te,panX:Le,panY:vt}=Sn.current,Xe=hb(N),Ie=we*Te,qe=we*Xe;if(!Ie||!qe)return;const Ke=(q-(pe+Le))/Ie,Lt=(B-(Z+vt))/Ie,jt=q-pe-Ke*qe,Yn=B-Z-Lt*qe;Sn.current={zoom:Xe,panX:jt,panY:Yn},te(Xe),yt()}function rP(N,q){if(!pt.current)return;const{drawX:B,drawY:pe,drawW:Z,drawH:we,scale:Te}=Mo();if(N<B||q<pe||N>B+Z||q>pe+we)return;const Le=Math.floor((N-B)/Te),vt=Math.floor((q-pe)/Te),Xe=document.createElement("canvas");Xe.width=pt.current.naturalWidth,Xe.height=pt.current.naturalHeight;const Ie=Xe.getContext("2d");Ie.drawImage(pt.current,0,0);const qe=Ie.getImageData(Le,vt,1,1),[Ke,Lt,jt]=qe.data,Yn=`#${[Ke,Lt,jt].map(vr=>vr.toString(16).padStart(2,"0")).join("").toUpperCase()}`;de(Yn)}function iP(N){}function oP(){if(!pt.current)return;const N=fb();pb(Sn.current.zoom+O_,N.x,N.y)}function aP(){if(!pt.current)return;const N=fb();pb(Sn.current.zoom-O_,N.x,N.y)}function lP(){pt.current&&wm()}function cP(N,q){const B=Math.min($h/N,Fh/q),pe=Math.round(N*B),Z=Math.round(q*B),we=Math.round(($h-pe)/2),Te=Math.round((Fh-Z)/2);return{x:we,y:Te,w:pe,h:Z,scale:B}}function uP(){const N=Ot.current;if(!N)return;const q=N.getContext("2d");q.clearRect(0,0,N.width,N.height),q.fillStyle="#f8f9fa",q.fillRect(0,0,N.width,N.height)}function yt(){const N=Ot.current;if(!N)return;const q=N.getContext("2d");uP();const B=pt.current;if(!B)return;const{drawX:pe,drawY:Z,drawW:we,drawH:Te,scale:Le}=Mo();if(q.imageSmoothingEnabled=!ne,ne||(q.imageSmoothingQuality="high"),Eo&&Xs.current){q.drawImage(Xs.current,pe,Z,we,Te);return}q.drawImage(B,pe,Z,we,Te),mt.current.forEach((Ie,qe)=>{const Ke=Ie.points,Lt=Ba.current===qe,jt=1;q.fillStyle="rgba(128, 128, 128, 0.3)",q.strokeStyle=Lt?"#667eea":"#333",q.lineWidth=jt,q.setLineDash([8,4]),q.lineCap="butt",q.lineJoin="miter",q.beginPath(),Ke.forEach((Yn,vr)=>{const Do=pe+Yn[0]*Le,ms=Z+Yn[1]*Le;vr===0?q.moveTo(Do,ms):q.lineTo(Do,ms)}),q.closePath(),q.fill(),q.stroke(),q.setLineDash([]),Ke.forEach(Yn=>{const vr=pe+Yn[0]*Le,Do=Z+Yn[1]*Le,ms=4;q.fillStyle=Lt?"#667eea":"#333",q.fillRect(vr-ms/2,Do-ms/2,ms,ms)})});const Xe=ut.current;Xe.length>0&&(q.fillStyle="rgba(128, 128, 128, 0.3)",q.strokeStyle="#667eea",q.lineWidth=1,q.setLineDash([8,4]),q.lineCap="butt",q.lineJoin="miter",q.beginPath(),Xe.forEach((qe,Ke)=>{const Lt=pe+qe[0]*Le,jt=Z+qe[1]*Le;Ke===0?q.moveTo(Lt,jt):q.lineTo(Lt,jt)}),Xe.length===4&&(q.closePath(),q.fill()),q.stroke(),q.setLineDash([]),Xe.forEach(qe=>{const Ke=pe+qe[0]*Le,Lt=Z+qe[1]*Le;q.fillStyle="#667eea",q.fillRect(Ke-4/2,Lt-4/2,4,4)}))}function ps(){ke([...ut.current])}function Io(){Oe(mt.current.length)}function As(){Ba.current=-1,Ys(-1)}function dP(){if(Xt>=0){const N=mt.current[Xt];return N?{key:`frame-${Xt}`,points:N.points,config:N.config}:null}return ut.current.length===4?{key:"current",points:ut.current,config:ye}:null}function hP(){ds.current.forEach(N=>{N!=null&&N.url&&URL.revokeObjectURL(N.url)}),ds.current.clear(),Js.current&&URL.revokeObjectURL(Js.current),Js.current="",Xs.current=null}function Jd(){hP(),Fa(!1),za({})}function fP(N){Zs&&za(q=>{const B={...q};return N?B[Zs]=N:delete B[Zs],B})}function Zd(N){ut.current=[],ps(),Ba.current=N,Ys(N);const q=mt.current[N];q!=null&&q.config&&X(bf(q.config,Vo)),ft(!0),Q(!1);const B=Wa();V(B.length?JSON.stringify(B,null,2):"[]")}function pP(N,q){X(B=>{const pe={...B,[N]:q},Z=Ba.current;return Z>=0&&mt.current[Z]&&(mt.current[Z].config=pe),pe})}function mb(N,q,B){const{drawX:pe,drawY:Z,scale:we}=Mo(),Te=(N-pe)/we,Le=(q-Z)/we;let vt=!1;for(let Xe=0,Ie=B.length-1;Xe<B.length;Ie=Xe++){const qe=B[Xe][0],Ke=B[Xe][1],Lt=B[Ie][0],jt=B[Ie][1];Ke>Le!=jt>Le&&Te<(Lt-qe)*(Le-Ke)/(jt-Ke)+qe&&(vt=!vt)}return vt}function gb(N,q){if(ut.current.length===4&&mb(N,q,ut.current))return-1;for(let B=mt.current.length-1;B>=0;B-=1)if(mb(N,q,mt.current[B].points))return B;return null}function xb(N,q){const{drawX:pe,drawY:Z,scale:we}=Mo();if(ut.current.length>0)for(let Te=0;Te<ut.current.length;Te+=1){const Le=pe+ut.current[Te][0]*we,vt=Z+ut.current[Te][1]*we;if(Math.hypot(N-Le,q-vt)<15)return{frame:-1,point:Te}}for(let Te=0;Te<mt.current.length;Te+=1){const Le=mt.current[Te].points;for(let vt=0;vt<Le.length;vt+=1){const Xe=pe+Le[vt][0]*we,Ie=Z+Le[vt][1]*we;if(Math.hypot(N-Xe,q-Ie)<15)return{frame:Te,point:vt}}}return null}function Nc(){if(!pt.current){H("Select one or more locations, upload a billboard photo, then click four corners to define the frame.");return}H("Click and drag to draw a box. Use +/Fit to zoom; Shift+drag or middle mouse pans; pinch to zoom.")}function yb(N){N&&tP(N,{resetFrames:!0}).catch(q=>{T((q==null?void 0:q.message)||"Failed to load image")})}function mP(N){if(a!=="setup"||!pt.current)return;const q=bm(N);if(!q)return;const{x:B,y:pe}=q,Z=jn.current;if(N.pointerType==="touch"){const Ke=wi.current;if(Ke.pointers.set(N.pointerId,{x:B,y:pe}),Ke.pointers.size===2){const[Lt,jt]=Array.from(Ke.pointers.values()),Yn=(Lt.x+jt.x)/2,vr=(Lt.y+jt.y)/2;Ke.isPinching=!0,Ke.startDistance=Math.hypot(Lt.x-jt.x,Lt.y-jt.y),Ke.startZoom=Sn.current.zoom,Ke.startPanX=Sn.current.panX,Ke.startPanY=Sn.current.panY,Ke.startCenterX=Yn,Ke.startCenterY=vr,Z.isDrawing=!1,Z.isDraggingCorner=!1,Z.isDraggingFrame=!1,Z.isPanning=!1,Ot.current&&(Ot.current.style.cursor="grabbing");return}}if(N.button===1||N.shiftKey){N.preventDefault(),Z.isPanning=!0,Z.shiftPanPending=N.shiftKey&&N.button===0,Z.hasPanned=!1,Z.panStartX=B,Z.panStartY=pe,Z.panOriginX=Sn.current.panX,Z.panOriginY=Sn.current.panY,Ot.current&&(Ot.current.style.cursor="grabbing");return}Z.shiftPanPending=!1,Z.hasPanned=!1;const{drawX:Te,drawY:Le,drawW:vt,drawH:Xe}=Mo(),Ie=xb(B,pe);if(Ie){jn.current.isDraggingCorner=!0,jn.current.dragFrameIndex=Ie.frame,jn.current.dragPointIndex=Ie.point,Ie.frame>=0?Zd(Ie.frame):(As(),ft(!0)),yt();return}const qe=gb(B,pe);if(qe!==null){jn.current.isDraggingFrame=!0,jn.current.dragFrameIndex=qe,jn.current.startX=B,jn.current.startY=pe,qe>=0?Zd(qe):(As(),ft(!0)),Ot.current&&(Ot.current.style.cursor="move"),yt();return}B<Te||pe<Le||B>Te+vt||pe>Le+Xe||(hs.current=!1,jn.current.isDrawing=!0,jn.current.startX=B,jn.current.startY=pe,As())}function gP(N){if(a!=="setup"||!pt.current)return;const q=bm(N);if(!q)return;const{x:B,y:pe}=q,Z=jn.current;if(N.pointerType==="touch"){const Ie=wi.current;if(Ie.pointers.has(N.pointerId)&&Ie.pointers.set(N.pointerId,{x:B,y:pe}),Ie.isPinching&&Ie.pointers.size>=2){const[qe,Ke]=Array.from(Ie.pointers.values()),Lt=(qe.x+Ke.x)/2,jt=(qe.y+Ke.y)/2,Yn=Math.hypot(qe.x-Ke.x,qe.y-Ke.y),{drawX:vr,drawY:Do,scale:ms}=fs.current,km=Ie.startZoom;if(Ie.startDistance>0&&ms){const eh=hb(km*(Yn/Ie.startDistance)),TP=(Ie.startCenterX-(vr+Ie.startPanX))/(ms*km),PP=(Ie.startCenterY-(Do+Ie.startPanY))/(ms*km),RP=Lt-vr-TP*ms*eh,AP=jt-Do-PP*ms*eh;Sn.current={zoom:eh,panX:RP,panY:AP},te(eh),yt()}return}}if(Z.isPanning){N.preventDefault();const Ie=B-Z.panStartX,qe=pe-Z.panStartY;if(Z.shiftPanPending&&!Z.hasPanned){if(Math.hypot(Ie,qe)<q6)return;Z.hasPanned=!0}Sn.current.panX=Z.panOriginX+Ie,Sn.current.panY=Z.panOriginY+qe,yt();return}const{drawX:we,drawY:Te,scale:Le}=Mo();if(Z.isDraggingCorner){const Ie=(B-we)/Le,qe=(pe-Te)/Le;Z.dragFrameIndex===-1?ut.current[Z.dragPointIndex]=[Math.round(Ie),Math.round(qe)]:mt.current[Z.dragFrameIndex].points[Z.dragPointIndex]=[Math.round(Ie),Math.round(qe)],yt();return}if(Z.isDraggingFrame){const Ie=(B-Z.startX)/Le,qe=(pe-Z.startY)/Le;Z.dragFrameIndex===-1?ut.current=ut.current.map(Ke=>[Math.round(Ke[0]+Ie),Math.round(Ke[1]+qe)]):mt.current[Z.dragFrameIndex].points=mt.current[Z.dragFrameIndex].points.map(Ke=>[Math.round(Ke[0]+Ie),Math.round(Ke[1]+qe)]),Z.startX=B,Z.startY=pe,yt();return}if(Z.isDrawing){yt();const Ie=Ot.current.getContext("2d");Ie.fillStyle="rgba(128, 128, 128, 0.3)";const qe=B-Z.startX,Ke=pe-Z.startY;Ie.fillRect(Z.startX,Z.startY,qe,Ke),Ie.strokeStyle="#667eea",Ie.lineWidth=1,Ie.setLineDash([8,4]),Ie.lineCap="butt",Ie.lineJoin="miter",Ie.strokeRect(Z.startX,Z.startY,qe,Ke),Ie.setLineDash([]);return}const vt=xb(B,pe),Xe=gb(B,pe);Ot.current&&(vt?Ot.current.style.cursor="pointer":Xe!==null?Ot.current.style.cursor="move":Ot.current.style.cursor="crosshair")}function xP(N){if(a!=="setup"||!pt.current)return;const q=bm(N),B=jn.current;if(N.pointerType==="touch"){const jt=wi.current;if(jt.pointers.has(N.pointerId)&&jt.pointers.delete(N.pointerId),jt.isPinching&&jt.pointers.size<2&&(jt.isPinching=!1),jt.isPinching)return}if(B.isPanning){B.isPanning=!1,Ot.current&&(Ot.current.style.cursor="crosshair"),B.shiftPanPending&&!B.hasPanned&&yr&&q&&rP(q.x,q.y),B.shiftPanPending=!1,B.hasPanned=!1;return}if(B.isDraggingCorner){B.isDraggingCorner=!1,B.dragFrameIndex=-1,B.dragPointIndex=-1,Ot.current&&(Ot.current.style.cursor="crosshair"),ps(),yt();return}if(B.isDraggingFrame){B.isDraggingFrame=!1,B.dragFrameIndex=-1,Ot.current&&(Ot.current.style.cursor="crosshair"),ps(),yt();return}if(!B.isDrawing||!q)return;const{x:pe,y:Z}=q,{drawX:we,drawY:Te,scale:Le}=Mo(),vt=B.startX,Xe=B.startY,Ie=(Math.min(vt,pe)-we)/Le,qe=(Math.min(Xe,Z)-Te)/Le,Ke=(Math.max(vt,pe)-we)/Le,Lt=(Math.max(Xe,Z)-Te)/Le;ut.current=[[Math.round(Ie),Math.round(qe)],[Math.round(Ke),Math.round(qe)],[Math.round(Ke),Math.round(Lt)],[Math.round(Ie),Math.round(Lt)]],B.isDrawing=!1,ps(),As(),ft(!0),H("Frame drawn. Drag corners to adjust, or drag inside to move. Click Add Frame to save."),yt()}function yP(){X(Vo)}function vP(){if(ut.current.length!==4){T("Select 4 corner points first");return}const N={...ye},q=hs.current?"greenscreen":"manual";mt.current.push({points:[...ut.current],config:N,source:q});const B="current";ut.current=[];const pe=mt.current.length-1;Zd(pe),hs.current=!1,ps(),Io(),H(`Frame ${mt.current.length} added. Draw another box or save when done.`);const Z=ds.current.get(B);Z&&(ds.current.set(`frame-${pe}`,Z),ds.current.delete(B));const we=jc.current[B];we&&za(Te=>{const Le={...Te};return Le[`frame-${pe}`]=we,delete Le[B],Le}),Fa(!1),Xs.current=null,yt()}function bP(){ut.current=[],As(),hs.current=!1,ps(),ds.current.delete("current"),za(N=>{if(!N.current)return N;const q={...N};return delete q.current,q}),Fa(!1),Xs.current=null,mt.current.length?H(`Frames saved: ${mt.current.length}. Draw another box or save all frames.`):Nc(),yt()}function vb(N=!1){!N&&!window.confirm("Clear all frames? This will reset your work.")||(mt.current=[],ut.current=[],As(),hs.current=!1,Jd(),ps(),Io(),V("[]"),Q(!1),Nc(),yt())}function Wa(){const N=[...mt.current];return ut.current.length===4&&N.push({points:[...ut.current],config:{...ye}}),N.map(q=>({points:q.points.map(B=>[B[0],B[1]]),config:q.config}))}function wP(N){if(!N.trim())return[];let q=[];try{q=JSON.parse(N)}catch(B){throw new Error((B==null?void 0:B.message)||"Frames JSON is invalid")}if(!Array.isArray(q))throw new Error("Frames JSON must be an array of frames.");return q.map((B,pe)=>{const Z=vm((B==null?void 0:B.points)||(B==null?void 0:B.frame_points)||B);if(!Z||Z.length!==4)throw new Error(`Frame ${pe+1} must include 4 points.`);const we=Z.map(Le=>{const vt=Number(Le[0]),Xe=Number(Le[1]);if(!Number.isFinite(vt)||!Number.isFinite(Xe))throw new Error(`Frame ${pe+1} has invalid point values.`);return[vt,Xe]});let Te=B==null?void 0:B.config;if(typeof Te=="string")try{Te=JSON.parse(Te)}catch{Te=null}return{points:we,config:bf(Te,Vo),source:"json"}})}function kP(){T("");try{const N=wP(R);mt.current=N,ut.current=[],hs.current=!1,Jd(),N.length?Zd(0):As(),ps(),Io(),Q(!1),V(N.length?JSON.stringify(Wa(),null,2):"[]"),yt()}catch(N){T((N==null?void 0:N.message)||"Frames JSON is invalid")}}function _P(){!pt.current||Se||(ie(!0),setTimeout(()=>{if(!pt.current){ie(!1);return}try{const N=document.createElement("canvas");N.width=pt.current.width,N.height=pt.current.height;const q=N.getContext("2d");q.drawImage(pt.current,0,0);const B=q.getImageData(0,0,pt.current.width,pt.current.height),pe=J6(B,{color:ue,tolerance:he,depthMultiplier:ye.depthMultiplier,existingFrames:mt.current});pe?(ut.current=pe,As(),hs.current=!0,ps(),ft(!0),H("Click and drag to draw a box. Use +/Fit to zoom; Shift+drag or middle mouse pans; pinch to zoom."),yt()):H("No green screen detected. Adjust tolerance or draw frame manually.")}finally{ie(!1)}},0))}async function SP(){const N=dP();if(!L||!N||!Zs){T("Upload a photo and select or draw a frame first.");return}const q=cb;if(!q){T("Upload a test creative for the active frame first.");return}if(!Vd){T(""),qd(!0);try{const B=new FormData;B.append("billboard_photo",L),B.append("creative",q),B.append("frame_points",JSON.stringify(N.points)),B.append("config",JSON.stringify(N.config)),B.append("time_of_day",x||"day");const pe=await SB(B),Z=ds.current.get(Zs);Z!=null&&Z.url&&URL.revokeObjectURL(Z.url);const we=URL.createObjectURL(pe),Te=new Image;Te.onload=()=>{ds.current.set(Zs,{url:we,img:Te}),Js.current=we,Xs.current=Te,yt()},Te.src=we}catch(B){T((B==null?void 0:B.message)||"Failed to generate preview")}finally{qd(!1)}}}function jP(){I(null),pt.current=null,ut.current=[],mt.current=[],As(),hs.current=!1,Kn(!1),Jd(),wm(!1),ps(),Io(),V("[]"),Q(!1),H("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),yt()}function CP(N){N.preventDefault(),be(!0)}function NP(N){N.preventDefault(),be(!1)}function EP(N){var B,pe;N.preventDefault(),be(!1);const q=(pe=(B=N.dataTransfer)==null?void 0:B.files)==null?void 0:pe[0];q&&(I(q),yb(q))}return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3 py-1",children:[r&&c.jsx(se,{variant:a==="generate"?"default":"ghost",onClick:()=>l("generate"),className:`rounded-2xl mmg-tab-btn ${a==="generate"?"mmg-tab-btn-active":""}`,children:"Generate"}),i&&n&&c.jsx(se,{variant:a==="setup"?"default":"ghost",onClick:()=>l("setup"),className:`rounded-2xl mmg-tab-btn ${a==="setup"?"mmg-tab-btn-active":""}`,children:"Setup"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:a==="generate"?"h-full":"hidden","aria-hidden":a!=="generate",children:c.jsx(T6,{locations:u,setLocations:d,venueType:h,setVenueType:f,templateKey:b,setTemplateKey:k,locationOptions:Gd,locationsQuery:Yd,timeOfDay:x,setTimeOfDay:y,timeOfDayDisabled:S,sideDisabled:j,side:g,setSide:m,timeOfDayOptions:_i,sideOptions:ym,venueTypeOptions:gn,templateOptions:ob,templatesQuery:Kd,templateThumbs:re,getTemplateKey:kr,defaultFrameConfig:Vo,useNativeSelects:A_})}),a==="setup"?c.jsx("div",{className:"h-full",children:c.jsx(D6,{locations:u,setLocations:d,venueType:h,setVenueType:f,assetType:p,setAssetType:w,setTemplateKey:k,locationOptions:Gd,locationsQuery:Yd,assetTypeOptions:Qd,assetTypesQuery:Ua,timeOfDay:x,setTimeOfDay:y,timeOfDayDisabled:S,sideDisabled:j,side:g,setSide:m,timeOfDayOptions:L6,sideOptions:$6,venueTypeOptions:F6,editingTemplate:z,editingTemplateLoading:Y,stopEditTemplate:db,templatesOpen:Qs,setTemplatesOpen:Hr,templateOptions:ab,templatesQuery:Ha,templateThumbs:re,getTemplateKey:kr,startEditTemplate:sP,deleteTemplate:ZT,setupPhoto:L,setSetupPhoto:I,handleSetupPhoto:yb,handleSetupDragOver:CP,handleSetupDragLeave:NP,handleSetupDrop:EP,setupDragActive:J,handleSetupPhotoClear:jP,framesJson:R,setFramesJson:V,setFramesJsonDirty:Q,applyFramesJsonToCanvas:kP,buildFramesPayload:Wa,setupImageReady:Mn,greenscreenOpen:yr,setGreenscreenOpen:lt,greenscreenColor:ue,setGreenscreenColor:de,greenscreenDetecting:Se,colorTolerance:he,setColorTolerance:oe,RangeField:Xn,handleGreenscreenDetect:_P,canDetectGreenscreen:YT,hasActiveFrame:QT,frameSettingsOpen:ct,setFrameSettingsOpen:ft,setupFrameConfig:ye,handleSetupFrameConfigChange:pP,FrameConfigControls:Q6,previewOpen:dn,setPreviewOpen:bi,testPreviewMode:Eo,setTestPreviewMode:Fa,testPreviewImgRef:Xs,testPreviewUrlRef:Js,previewImgRef:pt,drawPreview:yt,activeTestCreativeFile:cb,updateTestCreativeForActive:fP,generateTestPreview:SP,testPreviewing:Vd,activeFrameIndex:Xt,canvasRef:Ot,canvasWidth:$h,canvasHeight:Fh,handleCanvasPointerDown:mP,handleCanvasPointerMove:gP,handleCanvasPointerUp:xP,handleCanvasWheel:iP,setupHint:me,handleZoomOut:aP,handleZoomIn:oP,handleFitToScreen:lP,zoomPercent:XT,pixelUpscale:ne,setPixelUpscale:je,setupError:K,setupMessage:D,addFrame:vP,resetCurrentFrame:bP,saveSetup:JT,setupSaving:O,clearAllFrames:vb,currentPoints:W,frameCount:Re,useNativeSelects:A_})}):null]})]})})}function Q6({config:t,onChange:e}){return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Xn,{label:"Brightness",value:t.brightness,min:50,max:200,suffix:"%",onChange:n=>e("brightness",n)}),c.jsx(Xn,{label:"Contrast",value:t.contrast,min:50,max:200,suffix:"%",onChange:n=>e("contrast",n)}),c.jsx(Xn,{label:"Saturation",value:t.saturation,min:0,max:200,suffix:"%",onChange:n=>e("saturation",n)}),c.jsx(Xn,{label:"Image Blur",value:t.imageBlur,min:0,max:20,onChange:n=>e("imageBlur",n),helper:"Blur entire creative (0 = off)."}),c.jsx(Xn,{label:"Edge Blur",value:t.edgeBlur,min:1,max:20,suffix:"px",onChange:n=>e("edgeBlur",n),helper:"Edge blur amount (1 = off)."}),c.jsx(Xn,{label:"Overlay Opacity",value:t.overlayOpacity,min:0,max:50,suffix:"%",onChange:n=>e("overlayOpacity",n),helper:"Billboard overlay strength."}),c.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(X6,{value:t.lightDirection,onChange:n=>e("lightDirection",n)}),c.jsx(Xn,{label:"Depth Perception",value:t.depthMultiplier,min:5,max:30,suffix:"x",onChange:n=>e("depthMultiplier",n),helper:"Perspective compensation."})]}),c.jsx(Xn,{label:"Shadow Intensity",value:t.shadowIntensity,min:0,max:100,suffix:"%",onChange:n=>e("shadowIntensity",n),helper:"Edge darkening."}),c.jsx(Xn,{label:"Lighting Match",value:t.lightingAdjustment,min:-50,max:50,suffix:"%",onChange:n=>e("lightingAdjustment",n),helper:"Brightness matching."}),c.jsx(Xn,{label:"Color Temperature",value:t.colorTemperature,min:-50,max:50,onChange:n=>e("colorTemperature",n),helper:"Warm/cool shift."}),c.jsx(Xn,{label:"Vignette",value:t.vignette,min:0,max:100,suffix:"%",onChange:n=>e("vignette",n),helper:"Corner darkening."}),c.jsx(Xn,{label:"Edge Smoother",value:t.edgeSmoother,min:1,max:20,suffix:"x",onChange:n=>e("edgeSmoother",n),helper:"Higher = softer edges."}),c.jsx(Xn,{label:"Sharpening",value:t.sharpening,min:0,max:100,suffix:"%",onChange:n=>e("sharpening",n),helper:"Unsharp mask strength (0 = off)."})]})}function X6({value:t,onChange:e}){return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:["Light Direction: ",K6[t]||"Top"]}),c.jsx("div",{className:"grid grid-cols-3 gap-2 w-[150px]",children:aT.map(n=>c.jsx("button",{type:"button",onClick:()=>e(n.value),className:`rounded-lg border px-2 py-2 text-sm font-semibold ${t===n.value?"border-black/40 dark:border-white/50 bg-black/5 dark:bg-white/15 text-black dark:text-white":"border-black/10 dark:border-white/20 bg-white/80 dark:bg-black/40 text-black/70 dark:text-white/80"}`,title:n.label,children:n.glyph},n.value))})]})}function Xn({label:t,value:e,min:n,max:s,step:r=1,suffix:i="",helper:o,onChange:a}){return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:[t,": ",e,i]}),c.jsx("input",{type:"range",min:n,max:s,step:r,value:e,onChange:l=>a(Number(l.target.value)),style:{background:G6(e,n,s)},className:"w-full accent-black"}),o?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:o}):null]})}function kr(t){return`${t.storage_key||""}::${t.photo}::${t.time_of_day||"all"}::${t.side||"all"}`}function J6(t,{color:e,tolerance:n,depthMultiplier:s,existingFrames:r}){const i=t.data,o=t.width,a=t.height,l=parseInt(e.slice(1,3),16),u=parseInt(e.slice(3,5),16),d=parseInt(e.slice(5,7),16),h=n,f=new Uint8Array(o*a);r.forEach(O=>{const $=O.points;for(let D=0;D<a;D+=1)for(let F=0;F<o;F+=1)Z6(F,D,$)&&(f[D*o+F]=1)});const p=new Uint8Array(o*a);let w=0;for(let O=0;O<a;O+=1)for(let $=0;$<o;$+=1){const D=O*o+$;if(f[D]===1)continue;const F=D*4,K=i[F],T=i[F+1],R=i[F+2];Math.sqrt((K-l)**2+(T-u)**2+(R-d)**2)<=h&&(p[D]=255,w+=1)}if(w<1e3)return null;const x=new Uint8Array(o*a),y=3;for(let O=0;O<a;O+=1)for(let $=0;$<o;$+=1){const D=O*o+$;let F=!1;for(let K=-y;K<=y;K+=1){for(let T=-y;T<=y;T+=1){const R=O+K,V=$+T;if(R>=0&&R<a&&V>=0&&V<o&&p[R*o+V]===255){F=!0;break}}if(F)break}x[D]=F?255:0}const g=[];for(let O=1;O<a-1;O+=1)for(let $=1;$<o-1;$+=1){const D=O*o+$;x[D]===0&&(x[D-1]===255||x[D+1]===255||x[D-o]===255||x[D+o]===255||x[D-o-1]===255||x[D-o+1]===255||x[D+o-1]===255||x[D+o+1]===255)&&g.push([$,O])}if(g.length<4)return null;let m=g[0],b=g[0],k=g[0],_=g[0];g.forEach(O=>{const[$,D]=O;$+D<m[0]+m[1]&&(m=O),$-D>b[0]-b[1]&&(b=O),$+D>k[0]+k[1]&&(k=O),$-D<_[0]-_[1]&&(_=O)});const C=Math.abs(b[0]-m[0]),S=Math.abs(k[0]-_[0]),j=Math.abs(_[1]-m[1]),E=Math.abs(k[1]-b[1]),P=C/S,L=j/E,I=s||Vo.depthMultiplier;if(P>1.1){const O=Math.floor((P-1)*I);_=[_[0],Math.min(a-1,_[1]+O)],k=[k[0],Math.min(a-1,k[1]+O)]}else if(P<.9){const O=Math.floor((1/P-1)*I);m=[m[0],Math.max(0,m[1]-O)],b=[b[0],Math.max(0,b[1]-O)]}if(L>1.1){const O=Math.floor((L-1)*I);b=[Math.min(o-1,b[0]+O),b[1]],k=[Math.min(o-1,k[0]+O),k[1]]}else if(L<.9){const O=Math.floor((1/L-1)*I);m=[Math.max(0,m[0]-O),m[1]],_=[Math.max(0,_[0]-O),_[1]]}return[m,b,k,_]}function Z6(t,e,n){let s=!1;for(let r=0,i=n.length-1;r<n.length;i=r++){const o=n[r][0],a=n[r][1],l=n[i][0],u=n[i][1];a>e!=u>e&&t<(l-o)*(e-a)/(u-a)+o&&(s=!s)}return s}function eH(t){if(!t)return"";const e=String(t).trim();if(!e)return"";if(e.includes("/"))return e;const n=e.split("-");if(n.length===3){const[s,r,i]=n;if(s&&r&&i)return`${i}/${r}/${s}`}return e}function M_(t){const e=Number.parseInt(t,10),n=Number.isFinite(e)&&e>0?e:1;return`${n} ${n===1?"Week":"Weeks"}`}function zh(t,e){const n=e;if(t==null||t==="")return`${n} 0`;const s=typeof t=="string"?t.trim():t;if(typeof s=="string"&&s.toUpperCase().startsWith(n))return s;const r=typeof s=="number"?s:Number.parseFloat(String(s).replace(/,/g,""));return Number.isFinite(r)?`${n} ${r.toLocaleString()}`:`${n} 0`}function I_(t){if(t==null)return 0;const e=Number.parseFloat(String(t).replace(/[^\d.-]/g,""));return Number.isFinite(e)?e:0}function tH(){const t=Gs(),[e,n]=v.useState(""),s=()=>({id:crypto.randomUUID(),startDate:"",duration:"",netRate:""}),r=()=>({id:crypto.randomUUID(),location:"",spots:"1",productionFee:"",periods:[s()]}),[i,o]=v.useState(()=>[r()]),[a,l]=v.useState("separate"),[u,d]=v.useState(""),[h,f]=v.useState("AED"),[p,w]=v.useState("100% upfront"),[x,y]=v.useState([]),[g,m]=v.useState({}),b=Kt({queryKey:["locations","proposals"],queryFn:()=>NB({service:"proposals"})}),k=v.useMemo(()=>{const D=b.data;return Array.isArray(D)?D:(D==null?void 0:D.locations)||(D==null?void 0:D.data)||[]},[b.data]),_=v.useMemo(()=>Array.from(new Set(i.map(D=>D.location).filter(Boolean))),[i]);v.useEffect(()=>{if(!_.length)return;const D=_.filter(K=>!g[K]);if(!D.length)return;let F=!0;return(async()=>{const K=await Promise.all(D.map(async T=>{try{const R=await EB(T);return[T,R]}catch{return[T,null]}}));F&&m(T=>{const R={...T};return K.forEach(([V,G])=>{G&&(R[V]=G)}),R})})(),()=>{F=!1}},[_,g]);const C=sN({mutationFn:D=>TB(D),onSuccess:()=>{t.invalidateQueries({queryKey:["proposals","history"]})}});function S(D,F,K){o(T=>T.map(R=>R.id===D?{...R,[F]:K}:R))}function j(D,F,K,T){o(R=>R.map(V=>V.id!==D?V:{...V,periods:V.periods.map(G=>G.id===F?{...G,[K]:T}:G)}))}function E(){o(D=>[...D,r()])}function P(D){o(F=>F.length>1?F.filter(K=>K.id!==D):F)}function L(D){o(F=>F.map(K=>K.id===D?{...K,periods:[...K.periods,s()]}:K))}function I(D,F){o(K=>K.map(T=>T.id!==D||T.periods.length<=1?T:{...T,periods:T.periods.filter(R=>R.id!==F)}))}function O(){const D=h||"AED",F=zh(u,D),K=i.filter(Q=>Q.location),T=K.map(Q=>{const re=Q.periods.filter(he=>he.startDate||he.duration||he.netRate),ee=a==="combined"?[re[0]||Q.periods[0]]:re,z=ee.map(he=>eH((he==null?void 0:he.startDate)||"")),A=ee.map(he=>M_(he==null?void 0:he.duration)),Y=ee.map(he=>zh(he==null?void 0:he.netRate,D)),U=Number.parseInt(Q.spots,10),J=Number.isFinite(U)&&U>0?U:1,be=g[Q.location]||{},me=be.location||be,H=(me.display_type||me.displayType||"").toLowerCase()==="static",ye=me.upload_fee??me.uploadFee??0,X=me.production_fee??me.productionFee??0,ue=Q.productionFee,de={location:Q.location||"",upload_fee:zh(ye,D),spots:J};return H&&(de.production_fee=zh(ue!==""&&ue!==null&&ue!==void 0?ue:X,D)),a==="combined"?(de.start_date=z[0]||"",de.duration=A[0]||M_(1)):(de.start_dates=z,de.durations=A,de.net_rates=Y),de}),R=K.map(Q=>{const re=k.find(ee=>(ee.location_key||ee.key||ee.id)===Q.location);return(re==null?void 0:re.display_name)||(re==null?void 0:re.name)||(re==null?void 0:re.label)||Q.location}).filter(Boolean).join(", "),V={proposals:T,client_name:e,proposal_type:a,payment_terms:p||"100% upfront",currency:D};a==="combined"&&(V.combined_net_rate=F);const G={client:e,packageType:a,items:T.map(Q=>({location:Q.location,netRatesValue:Array.isArray(Q.net_rates)?Q.net_rates.map(I_):[]})),combinedNetRateValue:a==="combined"?I_(F):0,locationsLabel:R,currency:D,paymentTerms:p||"100% upfront"};C.mutate(V,{onSuccess:Q=>{y(re=>[{data:Q,meta:G},...re].slice(0,3))}})}function $(){n(""),o([r()]),l("separate"),d(""),f("AED"),w("100% upfront")}return{client:e,setClient:n,items:i,updateItem:S,addItem:E,removeItem:P,addPeriod:L,removePeriod:I,updatePeriod:j,packageType:a,setPackageType:l,combinedNetRate:u,setCombinedNetRate:d,currency:h,setCurrency:f,paymentTerms:p,setPaymentTerms:w,lastResults:x,locationsQuery:b,locationOptions:k,generateMutation:C,handleGenerate:O,resetForm:$}}function nH(){const t=tH();return c.jsx(sH,{...t})}function sH({client:t,setClient:e,items:n,updateItem:s,addItem:r,removeItem:i,addPeriod:o,removePeriod:a,updatePeriod:l,packageType:u,setPackageType:d,combinedNetRate:h,setCombinedNetRate:f,currency:p,setCurrency:w,paymentTerms:x,setPaymentTerms:y,lastResults:g,locationsQuery:m,locationOptions:b,generateMutation:k,handleGenerate:_,resetForm:C}){var I;const S=Array.isArray(g)?g:[],j=k.isPending,E=v.useMemo(()=>{const O=b.map($=>{const D=$.location_key||$.key||$.id||"",F=$.display_name||$.name||$.label||D||"";return{value:D,label:F}}).filter($=>$.value);return[{value:"",label:"Select a location"},...O]},[b]),P=v.useMemo(()=>[{value:"separate",label:"Separate"},{value:"combined",label:"Combined"}],[]),L=v.useMemo(()=>[{value:"AED",label:"AED"},{value:"EUR",label:"EUR"},{value:"USD",label:"USD"},{value:"GBP",label:"GBP"}],[]);return c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{className:"flex flex-row items-center justify-between",children:c.jsx(Yt,{children:"Generate Proposal"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Client",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:t,onChange:O=>e(O.target.value),placeholder:"Client name"})}),c.jsx(Ee,{label:"Package Type",children:c.jsx(ot,{value:u,options:P,onChange:d})})]}),u==="combined"?c.jsx(Ee,{label:"Combined Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:h,onChange:O=>f(O.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Locations"}),m.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ve,{text:"Loading locations"})}):null]}),c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:r,children:"Add Location"})]}),c.jsx("div",{className:"space-y-3",children:n.map(O=>{var F,K;const $=b.find(T=>(T.location_key||T.key||T.id)===O.location),D=(($==null?void 0:$.display_type)||"").toLowerCase()==="static";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[u==="combined"?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1.4fr_0.6fr_0.9fr_0.7fr_auto] gap-2 items-end",children:[c.jsx(Ee,{label:"Location",children:c.jsx(ot,{value:O.location,options:E,onChange:T=>s(O.id,"location",T)})}),c.jsx(Ee,{label:"Spots",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.spots,onChange:T=>s(O.id,"spots",T.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Ee,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((F=O.periods[0])==null?void 0:F.startDate)||"",onChange:T=>{var R;return l(O.id,(R=O.periods[0])==null?void 0:R.id,"startDate",T.target.value)},type:"date"})}),c.jsx(Ee,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((K=O.periods[0])==null?void 0:K.duration)||"",onChange:T=>{var R;return l(O.id,(R=O.periods[0])==null?void 0:R.id,"duration",T.target.value)},type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(O.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ma,{size:16})})]}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 items-end",children:[c.jsx(Ee,{label:"Location",children:c.jsx(ot,{value:O.location,options:E,onChange:T=>s(O.id,"location",T)})}),c.jsxs("div",{className:"flex items-end justify-between gap-2",children:[c.jsx(Ee,{label:"Spots",className:"flex-1",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.spots,onChange:T=>s(O.id,"spots",T.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(O.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ma,{size:16})})]})]}),D?c.jsx(Ee,{label:"Production Fee",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.productionFee,onChange:T=>s(O.id,"productionFee",T.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,u!=="combined"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/60",children:"Line Items"}),c.jsx(se,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>o(O.id),children:"Add Line Item"})]}),c.jsx("div",{className:"space-y-2",children:O.periods.map(T=>c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_1fr_1fr_auto] gap-2 items-end",children:[c.jsx(Ee,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:T.startDate,onChange:R=>l(O.id,T.id,"startDate",R.target.value),type:"date"})}),c.jsx(Ee,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:T.duration,onChange:R=>l(O.id,T.id,"duration",R.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Ee,{label:"Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:T.netRate,onChange:R=>l(O.id,T.id,"netRate",R.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>a(O.id,T.id),disabled:O.periods.length===1,title:"Remove dates",children:c.jsx(ma,{size:16})})]},T.id))})]}):null]},O.id)})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Currency",children:c.jsx(ot,{value:p,options:L,onChange:w})}),c.jsx(Ee,{label:"Payment Terms",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:x,onChange:O=>y(O.target.value),placeholder:"Payment terms"})})]}),k.isError?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:((I=k.error)==null?void 0:I.message)||"Generation failed"}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(se,{className:"rounded-2xl",onClick:_,disabled:j,children:j?c.jsx(Ve,{text:"Generating Proposal"}):"Generate Proposal"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:C,disabled:j,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 space-y-3",children:[!S.length&&!j?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,j?c.jsx(Ve,{text:"Processing proposal",className:"text-sm text-black/60 dark:text-white/65"}):null,S.length?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Proposals"}),c.jsx("div",{className:"space-y-4",children:S.map((O,$)=>{const D=(O==null?void 0:O.data)||null,F=(O==null?void 0:O.meta)||null,K=[];D!=null&&D.pptx_url&&K.push({url:D.pptx_url,type:"pptx"}),D!=null&&D.pdf_url&&K.push({url:D.pdf_url,type:"pdf"});const T=(D==null?void 0:D.locations)||(F==null?void 0:F.locationsLabel)||"",R=(F==null?void 0:F.packageType)==="combined"?F==null?void 0:F.combinedNetRateValue:((F==null?void 0:F.items)||[]).reduce((G,Q)=>{const re=Array.isArray(Q.netRatesValue)?Q.netRatesValue:[];return G+re.reduce((ee,z)=>ee+(z||0),0)},0),V=Number.isFinite(R)?`${(F==null?void 0:F.currency)||"AED"} ${Number(R).toLocaleString()}`:"";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Client"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(F==null?void 0:F.client)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Package"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(F==null?void 0:F.packageType)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 sm:col-span-2",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Locations"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:T})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Total Amount"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:V})]})]}),K.length?c.jsx("div",{className:"space-y-2",children:K.map(G=>{const Q=rH(G.url),re=iH(Q),ee=G.type==="pdf"?"proposal.pdf":"proposal.pptx",z=re||ee,A=G.type==="pdf";return c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:A?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(n0,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:"PPTX"})}),c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:z})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:Q,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(po,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:Y=>{Y.preventDefault(),D_(Q,z)},onKeyDown:Y=>{(Y.key==="Enter"||Y.key===" ")&&(Y.preventDefault(),D_(Q,z))},className:"inline-flex items-center",children:[c.jsx(ja,{size:14,className:"mr-1"}),"Download"]})})]})]})},`${G.type}-${G.url}`)})}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No files returned yet."})]},`proposal-output-${$}`)})})]}):null]})]})]})}function rH(t){return t?t.startsWith("http")?t:`${Ma.API_BASE_URL}${t}`:""}function iH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function D_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function No({className:t,placeholder:e="Search...",...n}){return c.jsx("input",{type:"text",placeholder:e,className:Pe("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",t),...n})}function oH(){const{user:t}=pi(),[e,n]=v.useState({}),[s,r]=v.useState(!1),i=Kt({queryKey:["proposals","history"],queryFn:PB}),o=v.useMemo(()=>{var h;return Array.isArray(i.data)?i.data:(h=i.data)!=null&&h.proposals?i.data.proposals:i.data||[]},[i.data]),a=v.useMemo(()=>Rd(t),[t]),l=v.useMemo(()=>{const h=o||[];if(a)return h;const f=(t==null?void 0:t.id)||(t==null?void 0:t.user_id)||(t==null?void 0:t.email)||"";return f?h.filter(p=>(p.submitted_by||p.user_id||"")===f):h},[o,a,t==null?void 0:t.id,t==null?void 0:t.user_id,t==null?void 0:t.email]),u=v.useMemo(()=>{const h=new Set;return(l||[]).forEach(f=>{const p=f.submitted_by||f.user_id;p&&h.add(p)}),Array.from(h)},[l]),d=v.useMemo(()=>u.filter(h=>!e[h]),[u,e]);return v.useEffect(()=>{if(!d.length)return;r(!0);let h=!0;return(async()=>{const f=await Promise.all(d.map(async p=>{var w,x;try{const y=await AB(p),g=(y==null?void 0:y.name)||((w=y==null?void 0:y.user)==null?void 0:w.name)||((x=y==null?void 0:y.profile)==null?void 0:x.name)||p;return[p,g]}catch{return[p,p]}}));h&&(n(p=>{const w={...p};return f.forEach(([x,y])=>{w[x]||(w[x]=y)}),w}),r(!1))})(),()=>{h=!1}},[d]),v.useEffect(()=>{d.length||r(!1)},[d.length]),{historyQuery:i,userNamesLoading:s,visibleProposals:l,userNameById:e}}function aH(){const t=oH();return c.jsx(lH,{...t})}function lH({historyQuery:t,userNamesLoading:e,visibleProposals:n,userNameById:s}){const[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),d=v.useMemo(()=>(n||[]).map((y,g)=>{var P;const m=y.client_name||y.client||"Proposal",b=y.submitted_by||y.user_id||"",k=b?s[b]||b:"",_=y.date_generated||y.created_at,C=y.package_type||"",S=y.locations||((P=y.proposal_data)==null?void 0:P.locations_text)||y.location||"",j=y.total_amount||(y.total_amount_value!=null?`${y.currency||""} ${Number(y.total_amount_value).toLocaleString()}`:""),E=[];return y.pptx_url&&E.push({url:y.pptx_url,type:"pptx"}),y.pdf_url&&E.push({url:y.pdf_url,type:"pdf"}),!E.length&&y.file_url&&E.push({url:y.file_url,type:"pdf"}),{id:y.id||y.file_url||g,clientName:m,userName:k,generatedAt:_,packageType:C,locationText:S,totalAmount:j,fileEntries:E}}),[n,s]),h=v.useMemo(()=>{const y=new Set;return d.forEach(g=>{g.packageType&&g.packageType!==""&&y.add(g.packageType)}),Array.from(y)},[d]),f=v.useMemo(()=>{const y=new Set;return d.forEach(g=>{!g.locationText||g.locationText===""||g.locationText.split(",").forEach(m=>{const b=m.trim();b&&y.add(b)})}),Array.from(y)},[d]),p=v.useMemo(()=>[{value:"",label:"All packages"},...h.map(y=>({value:y,label:y}))],[h]),w=v.useMemo(()=>[{value:"",label:"All locations"},...f.map(y=>({value:y,label:y}))],[f]),x=v.useMemo(()=>{const y=l.trim().toLowerCase();return d.filter(g=>!(r&&g.packageType!==r||o&&!(g.locationText||"").split(",").map(b=>b.trim()).filter(Boolean).includes(o)||y&&!`${g.clientName} ${g.locationText}`.toLowerCase().includes(y)))},[d,r,o,l]);return c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsx(Gt,{className:"space-y-2",children:c.jsx(Yt,{children:"History"})}),c.jsx(Qt,{className:"flex-1 min-h-0 flex flex-col",children:t.isLoading||e?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):n!=null&&n.length?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(No,{value:l,onChange:y=>u(y.target.value),className:"w-full sm:w-[260px]",placeholder:"Search..."}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(ot,{value:r,options:p,onChange:i,className:"sm:w-[200px]"}),c.jsx(ot,{value:o,options:w,onChange:a,className:"sm:w-[220px]"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full min-w-0 overflow-hidden",children:c.jsx("div",{className:"h-full w-full min-w-0 overflow-auto",children:c.jsxs("table",{className:"min-w-[760px] w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Client"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Locations"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Amount"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"User"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Generated"}),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:(x||[]).map(y=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[c.jsx("td",{className:"px-4 py-3 font-semibold",children:y.clientName}),c.jsx("td",{className:"px-4 py-3",children:y.locationText}),c.jsx("td",{className:"px-4 py-3",children:y.totalAmount}),c.jsx("td",{className:"px-4 py-3",children:y.userName}),c.jsx("td",{className:"px-4 py-3",children:y.generatedAt?new Date(y.generatedAt).toLocaleString():""}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:y.fileEntries.length?c.jsx("div",{className:"flex flex-col gap-2",children:y.fileEntries.map(g=>{const m=cH(g.url),b=uH(m),k=g.type==="pdf"?"proposal.pdf":"proposal.pptx",_=b||k;return c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wide text-black/50 dark:text-white/60",children:g.type}),c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(po,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:C=>{C.preventDefault(),L_(m,_)},onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),L_(m,_))},className:"inline-flex items-center",children:[c.jsx(ja,{size:14,className:"mr-1"}),"Download"]})})]},`${g.type}-${g.url}`)})}):c.jsx("span",{className:"text-xs text-black/50 dark:text-white/55",children:""})})]},y.id))})]})})}),x.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No matching proposals."})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No proposals yet."})})]})}function cH(t){return t?t.startsWith("http")?t:`${Ma.API_BASE_URL}${t}`:""}function uH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function L_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function dH(){const[t,e]=v.useState("generate");return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3 py-1",children:[c.jsx(se,{variant:t==="generate"?"default":"ghost",onClick:()=>e("generate"),className:`rounded-2xl mmg-tab-btn ${t==="generate"?"mmg-tab-btn-active":""}`,children:"Generate"}),c.jsx(se,{variant:t==="history"?"default":"ghost",onClick:()=>e("history"),className:`rounded-2xl mmg-tab-btn ${t==="history"?"mmg-tab-btn-active":""}`,children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="generate"?"h-full":"hidden","aria-hidden":t!=="generate",children:c.jsx(nH,{})}),c.jsx("div",{className:t==="history"?"h-full":"hidden","aria-hidden":t!=="history",children:c.jsx(aH,{})})]})]})})}function lT(t){return t?typeof t=="string"?t:t.name||t.id||t.value||"":""}function cT(t){return t?typeof t=="string"?t:t.name||t.value||t.permission||"":""}function Og(t,e){if(!t||!e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function hH(t){const e=new Map;return(t||[]).forEach(n=>{const s=lT(n);if(!s)return;const r=(n.permissions||n.permission_list||n.permissionList||[]).map(cT).filter(Boolean);e.set(s,new Set(r))}),e}function fH(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permission_sets||n.permissionSets||n.permission_set_names||[]).map(lT).filter(Boolean);e.set(s,new Set(r))}),e}function pH(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permissions||[]).map(cT).filter(Boolean);e.set(s,new Set(r))}),e}function mH({q:t,setQ:e,openNewUserModal:n,usersQuery:s,users:r,user:i,selectUser:o,setConfirmDelete:a,companyLookup:l,userCompanyFilter:u,setUserCompanyFilter:d,userProfileFilter:h,setUserProfileFilter:f,companyFilterOptions:p,profileFilterOptions:w}){const x=v.useMemo(()=>[{value:"",label:"All companies"},...p.map(m=>({...m}))],[p]),y=v.useMemo(()=>[{value:"",label:"All profiles"},...w.map(m=>({...m}))],[w]),g=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Users"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(No,{value:t,onChange:m=>e(m.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:n,children:"Add user"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(ot,{value:u,options:x,onChange:d}),c.jsx(ot,{value:h,options:y,onChange:f})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:g}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:g}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(m=>{var P,L,I,O;const b=Array.isArray(m.profiles)?m.profiles.map($=>($==null?void 0:$.display_name)||($==null?void 0:$.name)||$).filter(Boolean):[((P=m.profiles)==null?void 0:P.display_name)||((L=m.profiles)==null?void 0:L.name)||m.profile||m.profile_name].filter(Boolean),k=b.length?b.length>2?`${b[0]}, +${b.length-1}`:b.join(", "):"",_=!!(m.id&&(i!=null&&i.id)&&m.id===i.id||m.user_id&&(i!=null&&i.user_id)&&m.user_id===i.user_id||m.email&&(i!=null&&i.email)&&m.email===i.email),C=m.is_active??m.isActive??m.active,S=typeof C=="boolean",j=S?C:!0,E=j?"Deactivate":"Reactivate";return c.jsxs(zt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("div",{className:"text-base font-semibold",children:m.name||""}),S&&!j?c.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-semibold text-red-700 dark:bg-red-500/20 dark:text-red-200",children:"Inactive"}):null]}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:m.email})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>o(m),title:"Edit user","aria-label":"Edit user",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>a({open:!0,type:"user",payload:{id:m.id||m.user_id,isActive:j},label:`${E} user "${m.email}"?`}),disabled:_,title:_?"You cannot deactivate yourself":`${E} user`,"aria-label":`${E} user`,className:j?void 0:"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300",children:j?c.jsx(rI,{size:16}):c.jsx(sI,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Profiles: ",c.jsx("span",{className:"font-semibold",children:k})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Company:"," ",c.jsx("span",{className:"font-semibold",children:((I=m.company)==null?void 0:I.name)||l.get(((O=m.company)==null?void 0:O.code)||m.company_code||m.company_id)||""})]})]},m.id||m.user_id||m.email)})})})]})]})}function gH({q:t,setQ:e,usersQuery:n,users:s,user:r,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h,companyList:f,profileOptions:p,profileValues:w,permissionSetList:x,permissionSetValues:y,permissionList:g,permissionsQuery:m,page:b}){const{selectedUser:k,setSelectedUser:_,userForm:C,setUserForm:S,userModalOpen:j,setUserModalOpen:E,userModalLoading:P,setUserModalLoading:L,userModalMode:I,setUserModalMode:O,userProfilesOpen:$,setUserProfilesOpen:D,userPermissionSetsOpen:F,setUserPermissionSetsOpen:K,userPermissionsOpen:T,setUserPermissionsOpen:R,savingUser:V,setPermissionsMessage:G,selectUser:Q,openNewUserModal:re,saveUser:ee,deleteUser:z,selectedUserProfiles:A,selectedUserPermissionSets:Y,selectedUserPermissions:U,selectedUserPermissionSet:J,customUserPermissions:be,toggleUserPermission:me,selectAllUserPermissions:H,clearUserPermissions:ye,toggleUserProfile:X,selectAllUserProfiles:ue,clearUserProfiles:de,toggleUserPermissionSet:he,selectAllUserPermissionSets:oe,clearUserPermissionSets:Se}=xH({permissionList:g,profileValues:w,permissionSetValues:y,profileOptions:p,permissionSetList:x}),[ie,W]=v.useState({open:!1,type:"",payload:null,label:""}),ke=!!(k&&(k.id&&(r!=null&&r.id)&&k.id===(r==null?void 0:r.id)||k.user_id&&(r!=null&&r.user_id)&&k.user_id===(r==null?void 0:r.user_id)||k.email&&(r!=null&&r.email)&&k.email===(r==null?void 0:r.email)));v.useEffect(()=>{_(null)},[b,_]);async function Re(){if(!(!ie.open||!ie.payload))try{const Oe=ie.payload,ae=(Oe==null?void 0:Oe.id)??Oe;if(!ae||r!=null&&r.id&&ae===r.id||r!=null&&r.user_id&&ae===r.user_id)return;await z(Oe)}finally{W({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(mH,{q:t,setQ:e,openNewUserModal:re,usersQuery:n,users:s,user:r,selectUser:Q,setConfirmDelete:W,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h}),c.jsx(yH,{open:j,onClose:()=>{E(!1),_(null),G(""),L(!1),O("edit"),D(!1),K(!1),R(!1)},userModalLoading:P,userModalMode:I,selectedUser:k,userForm:C,setUserForm:S,companyList:f,profileOptions:p,profileValues:w,userProfilesOpen:$,setUserProfilesOpen:D,selectAllUserProfiles:ue,clearUserProfiles:de,selectedUserProfiles:A,toggleUserProfile:X,permissionSetList:x,permissionSetValues:y,userPermissionSetsOpen:F,setUserPermissionSetsOpen:K,selectAllUserPermissionSets:oe,clearUserPermissionSets:Se,selectedUserPermissionSets:Y,toggleUserPermissionSet:he,userPermissionsOpen:T,setUserPermissionsOpen:R,selectedUserPermissions:U,permissionList:g,permissionsQuery:m,selectedUserPermissionSet:J,toggleUserPermission:me,selectAllUserPermissions:H,clearUserPermissions:ye,customUserPermissions:be,isSelfUser:ke,setConfirmDelete:W,saveUser:ee,savingUser:V}),c.jsx(vc,{open:ie.open,message:ie.label,onClose:()=>W({open:!1,type:"",payload:null,label:""}),onConfirm:Re})]})}function xH({permissionList:t,profileValues:e,permissionSetValues:n,profileOptions:s,permissionSetList:r}){const i=Gs(),[o,a]=v.useState(null),[l,u]=v.useState({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,x]=v.useState("edit"),[y,g]=v.useState(!1),[m,b]=v.useState(!1),[k,_]=v.useState(!1),[C,S]=v.useState(!1),[j,E]=v.useState(""),P=v.useMemo(()=>new Set(l.profiles||[]),[l.profiles]),L=v.useMemo(()=>new Set(l.permissionSets||[]),[l.permissionSets]),I=v.useMemo(()=>bn(l.permissionsText),[l.permissionsText]),O=v.useMemo(()=>new Set(I),[I]),$=v.useMemo(()=>{if(!t.length)return I;const X=new Set(t);return I.filter(ue=>!X.has(ue))},[t,I]),D=v.useMemo(()=>hH(r),[r]),F=v.useMemo(()=>fH(s),[s]),K=v.useMemo(()=>pH(s),[s]);function T(X,ue,de){return(X||[]).filter(he=>{const oe=ue.get(he);return oe?Og(oe,de):!0})}function R(X,ue,de){const he=new Set(de||[]);return(X||[]).filter(oe=>{const Se=K.get(oe),ie=F.get(oe);if(!Se&&!ie)return!0;if(ie&&!Og(ie,he))return!1;const W=new Set;return Se&&Se.forEach(ke=>W.add(ke)),ie&&ie.forEach(ke=>{const Re=D.get(ke);Re&&Re.forEach(Oe=>W.add(Oe))}),Og(W,ue)})}function V(X,ue){const de=new Set(X.profiles||[]),he=new Set(X.permissionSets||[]),oe=new Set(bn(X.permissionsText));return de.forEach(Se=>{const ie=F.get(Se);ie&&ie.forEach(ke=>he.add(ke));const W=K.get(Se);W&&W.forEach(ke=>oe.add(ke)),ie&&ie.forEach(ke=>{const Re=D.get(ke);Re&&Re.forEach(Oe=>oe.add(Oe))})}),{...X,permissionSets:Array.from(he),permissionsText:Array.from(oe).join(`
`)}}async function G(X){var oe,Se;a(X),E(""),x("edit"),h(!0),p(!0),g(!1),b(!1),_(!1);const ue=Array.isArray(X.profiles)?X.profiles.map(ie=>(ie==null?void 0:ie.name)||(ie==null?void 0:ie.id)||ie).filter(Boolean):[((oe=X.profiles)==null?void 0:oe.name)||X.profile||X.profile_name].filter(Boolean),de=(X.permission_sets||X.permissionSets||X.permission_set_names||[]).map(ie=>typeof ie=="string"?ie:(ie==null?void 0:ie.name)||(ie==null?void 0:ie.id)).filter(Boolean);u({name:X.name||"",email:X.email||"",profiles:ue,permissionSets:de,company:((Se=X.company)==null?void 0:Se.code)||X.company_code||X.company_id||"",is_active:X.is_active!==!1,permissionsText:""});const he=X.id||X.user_id;if(he)try{const ie=await OB(he),W=(ie==null?void 0:ie.permissions)??ie,ke=Array.isArray(W)?W.map(Re=>typeof Re=="string"?Re:Re==null?void 0:Re.name).filter(Boolean):[];u(Re=>V({...Re,permissionsText:ke.join(`
`)}))}catch{}p(!1)}function Q(){a(null),E(""),x("add"),p(!1),g(!1),b(!1),_(!1),u({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),h(!0)}async function re(){var oe,Se;if(w==="edit"&&!o)return;S(!0),E("");const X=(o==null?void 0:o.id)||(o==null?void 0:o.user_id);if(w==="edit"&&!X){S(!1),E("Missing user id");return}const ue=bn(l.permissionsText),de=l.profiles||[],he={name:l.name,is_active:!!l.is_active,profile_names:de,profile_name:de[0]||null,permission_sets:l.permissionSets||[],company_code:l.company||null,...w==="add"?{email:l.email}:{}};try{if(w==="add"){const ie=await MB(he),W=(ie==null?void 0:ie.id)||(ie==null?void 0:ie.user_id)||((oe=ie==null?void 0:ie.user)==null?void 0:oe.id)||((Se=ie==null?void 0:ie.user)==null?void 0:Se.user_id);W!=null&&await s_(W,ue),E("User created")}else await IB(X,he),await s_(X,ue),E("User updated");i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch(ie){E((ie==null?void 0:ie.message)||"Failed to save user")}finally{S(!1)}}async function ee(X){const ue=(X==null?void 0:X.id)??X;if(ue)try{const de=(X==null?void 0:X.isActive)??(X==null?void 0:X.is_active);(typeof de=="boolean"?de:!0)?await DB(ue):await LB(ue),i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch{}}function z(X){u(ue=>{const de=new Set(bn(ue.permissionsText)),he=de.has(X);he?de.delete(X):de.add(X);let oe=ue.permissionSets||[],Se=ue.profiles||[];return he&&(oe=T(oe,D,de),Se=R(Se,de,oe)),{...ue,permissionsText:Array.from(de).join(`
`),permissionSets:oe,profiles:Se}})}function A(){const X=new Set([...I,...t]);u(ue=>({...ue,permissionsText:Array.from(X).join(`
`)}))}function Y(){u(X=>({...X,permissionsText:"",permissionSets:[],profiles:[]}))}function U(X){u(ue=>{const de=new Set(ue.profiles||[]),he=new Set(ue.permissionSets||[]),oe=new Set(bn(ue.permissionsText));if(de.has(X)){de.delete(X);const ke=T(Array.from(he),D,oe),Re=R(Array.from(de),oe,ke);return{...ue,profiles:Re,permissionSets:ke,permissionsText:Array.from(oe).join(`
`)}}de.add(X);const ie=F.get(X);ie&&ie.forEach(ke=>he.add(ke));const W=K.get(X);return W&&W.forEach(ke=>oe.add(ke)),ie&&ie.forEach(ke=>{const Re=D.get(ke);Re&&Re.forEach(Oe=>oe.add(Oe))}),{...ue,profiles:Array.from(de),permissionSets:Array.from(he),permissionsText:Array.from(oe).join(`
`)}})}function J(){u(X=>{const ue=new Set([...X.profiles||[],...e]),de=new Set(X.permissionSets||[]),he=new Set(bn(X.permissionsText));return ue.forEach(oe=>{const Se=F.get(oe);Se&&Se.forEach(W=>de.add(W));const ie=K.get(oe);ie&&ie.forEach(W=>he.add(W)),Se&&Se.forEach(W=>{const ke=D.get(W);ke&&ke.forEach(Re=>he.add(Re))})}),{...X,profiles:Array.from(ue),permissionSets:Array.from(de),permissionsText:Array.from(he).join(`
`)}})}function be(){u(X=>({...X,profiles:[]}))}function me(X){u(ue=>{const de=new Set(ue.permissionSets||[]),he=new Set(bn(ue.permissionsText));if(de.has(X)){de.delete(X);const ie=R(ue.profiles||[],he,Array.from(de));return{...ue,permissionSets:Array.from(de),profiles:ie,permissionsText:Array.from(he).join(`
`)}}de.add(X);const Se=D.get(X);return Se&&Se.forEach(ie=>he.add(ie)),{...ue,permissionSets:Array.from(de),permissionsText:Array.from(he).join(`
`)}})}function H(){u(X=>{const ue=new Set([...X.permissionSets||[],...n]),de=new Set(bn(X.permissionsText));return ue.forEach(he=>{const oe=D.get(he);oe&&oe.forEach(Se=>de.add(Se))}),{...X,permissionSets:Array.from(ue),permissionsText:Array.from(de).join(`
`)}})}function ye(){u(X=>{const ue=new Set(bn(X.permissionsText)),de=R(X.profiles||[],ue,[]);return{...X,permissionSets:[],profiles:de,permissionsText:Array.from(ue).join(`
`)}})}return{selectedUser:o,setSelectedUser:a,userForm:l,setUserForm:u,userModalOpen:d,setUserModalOpen:h,userModalLoading:f,setUserModalLoading:p,userModalMode:w,setUserModalMode:x,userProfilesOpen:y,setUserProfilesOpen:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:b,userPermissionsOpen:k,setUserPermissionsOpen:_,savingUser:C,permissionsMessage:j,setPermissionsMessage:E,selectUser:G,openNewUserModal:Q,saveUser:re,selectedUserProfiles:P,selectedUserPermissionSets:L,selectedUserPermissions:I,selectedUserPermissionSet:O,customUserPermissions:$,toggleUserPermission:z,selectAllUserPermissions:A,clearUserPermissions:Y,toggleUserProfile:U,selectAllUserProfiles:J,clearUserProfiles:be,toggleUserPermissionSet:me,selectAllUserPermissionSets:H,clearUserPermissionSets:ye,deleteUser:ee}}function yH({open:t,onClose:e,userModalLoading:n,userModalMode:s,selectedUser:r,userForm:i,setUserForm:o,companyList:a,profileOptions:l,profileValues:u,userProfilesOpen:d,setUserProfilesOpen:h,selectAllUserProfiles:f,clearUserProfiles:p,selectedUserProfiles:w,toggleUserProfile:x,permissionSetList:y,permissionSetValues:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:b,selectAllUserPermissionSets:k,clearUserPermissionSets:_,selectedUserPermissionSets:C,toggleUserPermissionSet:S,userPermissionsOpen:j,setUserPermissionsOpen:E,selectedUserPermissions:P,permissionList:L,permissionsQuery:I,selectedUserPermissionSet:O,toggleUserPermission:$,selectAllUserPermissions:D,clearUserPermissions:F,customUserPermissions:K,isSelfUser:T,setConfirmDelete:R,saveUser:V,savingUser:G}){const Q=v.useMemo(()=>{const ee=a.map(z=>{const A=z.code||z.id||"";return{value:A,label:z.name||z.code||A||""}}).filter(z=>z.value);return[{value:"",label:"Select company"},...ee]},[a]),re=v.useMemo(()=>[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],[]);return c.jsx(Ns,{open:t,onClose:e,title:s==="add"?"Add user":"Edit user",maxWidth:"560px",children:n?c.jsx(Ve,{text:"Loading user",className:"text-sm text-black/60 dark:text-white/65"}):s==="add"||r?c.jsxs("div",{className:"space-y-3",children:[s==="edit"?c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/55",children:["Editing ",r==null?void 0:r.email]}):null,c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.name,onChange:ee=>o(z=>({...z,name:ee.target.value}))})}),c.jsx(Ee,{label:"Email",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.email,onChange:ee=>o(z=>({...z,email:ee.target.value})),type:"email",disabled:s==="edit"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Company",children:c.jsx(ot,{value:i.company||"",options:Q,onChange:ee=>o(z=>({...z,company:ee}))})}),c.jsx(Ee,{label:"Status",children:c.jsx(ot,{value:i.is_active?"active":"inactive",options:re,onChange:ee=>o(z=>({...z,is_active:ee==="active"}))})})]}),c.jsx(Ee,{label:"Profiles",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>h(ee=>!ee),"aria-expanded":d,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Profiles"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Pl(i.profiles.length,"profile")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:d?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",d&&"rotate-180")})]})]}),d?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!u.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!i.profiles.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[l.map(ee=>{const z=ee.name||ee.id;if(!z)return null;const A=w.has(z);return c.jsxs("button",{type:"button",onClick:()=>x(z),className:Pe("mmg-profile-option flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",A?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee.display_name||ee.name||z}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",A?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:A?"opacity-100":"opacity-0"})})]},z)}),l.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No profiles available."})]})]}):null]})}),c.jsx(Ee,{label:"Permission Sets",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>b(ee=>!ee),"aria-expanded":m,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Pl(i.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:m?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",m&&"rotate-180")})]})]}),m?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:k,disabled:!g.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:_,disabled:!i.permissionSets.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[y.map(ee=>{const z=ee.name||ee.id;if(!z)return null;const A=C.has(z);return c.jsxs("button",{type:"button",onClick:()=>S(z),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",A?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee.display_name||ee.name||z}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",A?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:A?"opacity-100":"opacity-0"})})]},z)}),y.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]})]}):null]})}),c.jsx(Ee,{label:"Permissions",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>E(ee=>!ee),"aria-expanded":j,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Pl(P.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:j?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",j&&"rotate-180")})]})]}),j?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:D,disabled:!L.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:F,disabled:!P.length,children:"Clear"})]})}),I.isLoading?c.jsx(Ve,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):L.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:L.map(ee=>{const z=O.has(ee);return c.jsxs("button",{type:"button",onClick:()=>$(ee),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",z?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",z?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:z?"opacity-100":"opacity-0"})})]},ee)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),K.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:K.map(ee=>c.jsxs("button",{type:"button",onClick:()=>$(ee),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:ee}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},ee))})]}):null]}):null]})}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[s==="edit"?c.jsx(se,{variant:"ghost",className:Pe("rounded-2xl",typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"&&!((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))?"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300":"text-red-600 hover:text-red-700 dark:text-red-300"),onClick:()=>R({open:!0,type:"user",payload:{id:(r==null?void 0:r.id)||(r==null?void 0:r.user_id),isActive:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active):!0},label:`${typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"} user "${r==null?void 0:r.email}"?`}),disabled:T,children:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:V,disabled:G,children:G?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Select a user to edit."})})}function vH({companySearch:t,setCompanySearch:e,openCompanyModal:n,companiesQuery:s,filteredCompanyList:r,companyLookup:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Companies"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(No,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add company"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:a}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(zt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.name||l.code}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.code||""})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>n(l),title:"Edit company","aria-label":"Edit company",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>o({open:!0,type:"company",payload:l.code||l.id,label:`Delete company "${l.name||l.code}"?`}),title:"Delete company","aria-label":"Delete company",children:c.jsx(ma,{size:16})})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[l.country?c.jsx("span",{children:l.country}):null,l.currency?c.jsxs("span",{children:[" ",l.currency]}):null,l.timezone?c.jsxs("span",{children:[" ",l.timezone]}):null]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[c.jsxs("span",{children:["Parent: ",i.get(l.parent_id)||""]}),c.jsxs("span",{children:[" ",l.isgroup?"Group":"Company"]}),c.jsxs("span",{children:[" ",l.is_active===!1?"Inactive":"Active"]})]})]},l.code||l.id)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching companies.":"No companies available."})]})})]})]})}function bH({companySearch:t,setCompanySearch:e,companiesQuery:n,filteredCompanyList:s,companyLookup:r,companyList:i}){const{companyForm:o,setCompanyForm:a,editingCompany:l,setEditingCompany:u,companyModalOpen:d,setCompanyModalOpen:h,savingCompany:f,openCompanyModal:p,saveCompany:w,deleteCompany:x}=wH(),[y,g]=v.useState({open:!1,type:"",payload:null,label:""});async function m(){if(!(!y.open||!y.payload))try{await x(y.payload)}finally{g({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(vH,{companySearch:t,setCompanySearch:e,openCompanyModal:p,companiesQuery:n,filteredCompanyList:s,companyLookup:r,setConfirmDelete:g}),c.jsx(kH,{open:d,onClose:()=>{h(!1),u(null),a({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})},editingCompany:l,companyForm:o,setCompanyForm:a,companyList:i,setConfirmDelete:g,saveCompany:w,savingCompany:f}),c.jsx(vc,{open:y.open,message:y.label,onClose:()=>g({open:!1,type:"",payload:null,label:""}),onConfirm:m})]})}function wH(){const t=Gs(),[e,n]=v.useState({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0}),[s,r]=v.useState(null),[i,o]=v.useState(!1),[a,l]=v.useState(!1);function u(f){f?(r(f.code||f.id),n({code:f.code||"",name:f.name||"",parent_id:f.parent_id??"",country:f.country??"",currency:f.currency??"",timezone:f.timezone??"",isgroup:!!f.isgroup,is_active:f.is_active!==!1})):(r(null),n({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})),o(!0)}async function d(){if(!e.code.trim()||!e.name.trim())return;l(!0);const f={code:e.code.trim(),name:e.name.trim(),parent_id:e.parent_id||null,country:e.country||null,currency:e.currency||null,timezone:e.timezone||null,isgroup:!!e.isgroup,is_active:!!e.is_active};try{s?await VB(s,f):await WB(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}finally{l(!1)}}async function h(f){if(f)try{await qB(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}}return{companyForm:e,setCompanyForm:n,editingCompany:s,setEditingCompany:r,companyModalOpen:i,setCompanyModalOpen:o,savingCompany:a,openCompanyModal:u,saveCompany:d,deleteCompany:h}}function kH({open:t,onClose:e,editingCompany:n,companyForm:s,setCompanyForm:r,companyList:i,setConfirmDelete:o,saveCompany:a,savingCompany:l}){const u=[{value:"",label:"None"},...i.filter(f=>(f.code||f.id)!==s.code).map(f=>{const p=f.code||f.id||"";return{value:p,label:f.name||f.code||p||""}}).filter(f=>f.value)],d=[{value:"company",label:"Company"},{value:"group",label:"Group"}],h=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return c.jsx(Ns,{open:t,onClose:e,title:n?`Edit company: ${s.name||s.code}`:"Add company",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Code",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.code,onChange:f=>r(p=>({...p,code:f.target.value})),placeholder:"MMG-001",disabled:!!n})}),c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:f=>r(p=>({...p,name:f.target.value})),placeholder:"MMG Global"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Parent company",children:c.jsx(ot,{value:s.parent_id||"",options:u,onChange:f=>r(p=>({...p,parent_id:f}))})}),c.jsx(Ee,{label:"Country",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.country,onChange:f=>r(p=>({...p,country:f.target.value})),placeholder:"US"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Currency",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.currency,onChange:f=>r(p=>({...p,currency:f.target.value})),placeholder:"USD"})}),c.jsx(Ee,{label:"Timezone",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.timezone,onChange:f=>r(p=>({...p,timezone:f.target.value})),placeholder:"America/New_York"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Type",children:c.jsx(ot,{value:s.isgroup?"group":"company",options:d,onChange:f=>r(p=>({...p,isgroup:f==="group"}))})}),c.jsx(Ee,{label:"Status",children:c.jsx(ot,{value:s.is_active?"active":"inactive",options:h,onChange:f=>r(p=>({...p,is_active:f==="active"}))})})]}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(se,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>o({open:!0,type:"company",payload:n,label:`Delete company "${s.name||s.code}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:a,disabled:l,children:l?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]})})}function _H({profileSearch:t,setProfileSearch:e,openProfileModal:n,filteredProfileOptions:s,duplicateProfile:r,setConfirmDelete:i}){const o=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Profiles"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(No,{value:t,onChange:a=>e(a.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add profile"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:o}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:o}),c.jsxs("div",{className:"space-y-4 p-5 pt-1",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.map(a=>c.jsxs(zt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:a.display_name||a.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:a.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>r(a),title:"Duplicate profile","aria-label":"Duplicate profile",children:c.jsx(iN,{size:16})}),a.is_system?c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:"System"}):c.jsxs(c.Fragment,{children:[c.jsx(An,{onClick:()=>n(a),title:"Edit profile","aria-label":"Edit profile",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>i({open:!0,type:"profile",payload:a.id||a.name,label:`Delete profile "${a.display_name||a.name}"?`}),title:"Delete profile","aria-label":"Delete profile",children:c.jsx(ma,{size:16})})]})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(a.permissions||[]).length," permission",(a.permissions||[]).length===1?"":"s"]}),a.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:a.description}):null]},a.id||a.name))}),s.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching profiles.":"No profiles available."})]})]})]})}function SH({profileSearch:t,setProfileSearch:e,filteredProfileOptions:n,permissionList:s,permissionSetValues:r,permissionSetList:i,permissionSetsQuery:o,permissionsQuery:a}){const{profileForm:l,setProfileForm:u,editingProfile:d,setEditingProfile:h,profileModalOpen:f,setProfileModalOpen:p,profileIsSystem:w,setProfileIsSystem:x,profilePermissionSetsOpen:y,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:b,savingProfile:k,openProfileModal:_,duplicateProfile:C,saveProfile:S,deleteProfile:j,selectedProfilePermissions:E,selectedProfilePermissionSet:P,selectedProfilePermissionSets:L,customProfilePermissions:I,toggleProfilePermission:O,selectAllProfilePermissions:$,clearProfilePermissions:D,toggleProfilePermissionSet:F,selectAllProfilePermissionSets:K,clearProfilePermissionSets:T}=jH({permissionList:s,permissionSetValues:r,permissionSetList:i}),[R,V]=v.useState({open:!1,type:"",payload:null,label:""});async function G(){if(!(!R.open||!R.payload))try{await j(R.payload)}finally{V({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(_H,{profileSearch:t,setProfileSearch:e,openProfileModal:_,filteredProfileOptions:n,duplicateProfile:C,setConfirmDelete:V}),c.jsx(CH,{open:f,onClose:()=>{p(!1),h(null),u({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),x(!1),g(!1),b(!1)},editingProfile:d,profileForm:l,setProfileForm:u,profileIsSystem:w,profilePermissionSetsOpen:y,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:b,permissionSetValues:r,permissionSetsQuery:o,permissionSetList:i,selectedProfilePermissionSets:L,toggleProfilePermissionSet:F,selectAllProfilePermissionSets:K,clearProfilePermissionSets:T,selectedProfilePermissions:E,permissionList:s,permissionsQuery:a,selectedProfilePermissionSet:P,toggleProfilePermission:O,selectAllProfilePermissions:$,clearProfilePermissions:D,customProfilePermissions:I,setConfirmDelete:V,saveProfile:S,savingProfile:k}),c.jsx(vc,{open:R.open,message:R.label,onClose:()=>V({open:!1,type:"",payload:null,label:""}),onConfirm:G})]})}function jH({permissionList:t,permissionSetValues:e,permissionSetList:n}){const s=Gs(),[r,i]=v.useState({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),[o,a]=v.useState(null),[l,u]=v.useState(!1),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,x]=v.useState(!1),[y,g]=v.useState(!1),m=v.useMemo(()=>bn(r.permissionsText),[r.permissionsText]),b=v.useMemo(()=>new Set(m),[m]),k=v.useMemo(()=>new Set(r.permissionSets||[]),[r.permissionSets]),_=v.useMemo(()=>{if(!t.length)return m;const T=new Set(t);return m.filter(R=>!T.has(R))},[t,m]),C=v.useMemo(()=>{const T=new Map;return(n||[]).forEach(R=>{const V=R.name||R.id;if(!V)return;const G=(R.permissions||R.permission_list||R.permissionList||[]).map(Q=>typeof Q=="string"?Q:(Q==null?void 0:Q.name)||(Q==null?void 0:Q.value)||(Q==null?void 0:Q.permission)).filter(Boolean);T.set(V,new Set(G))}),T},[n]);function S(T,R){return(T||[]).filter(V=>{const G=C.get(V);if(!G)return!0;for(const Q of G)if(!R.has(Q))return!1;return!0})}function j(T){h(!!(T!=null&&T.is_system)),!(T!=null&&T.is_system)&&(p(!1),x(!1),T?(a(T.id||T.name),i({name:T.name,display_name:T.display_name||T.name,description:T.description||"",permissionsText:(T.permissions||[]).map(R=>typeof R=="string"?R:R==null?void 0:R.name).filter(Boolean).join(`
`),permissionSets:(T.permission_sets||T.permissionSets||T.permission_set_names||[]).map(R=>typeof R=="string"?R:(R==null?void 0:R.name)||(R==null?void 0:R.id)).filter(Boolean)})):(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!0))}function E(T){if(!T)return;const R=T.name||T.display_name||"profile",V=T.display_name||T.name||R;h(!1),a(null),p(!1),x(!1),i({name:`${R}_new`,display_name:`${V}_new`,description:T.description||"",permissionsText:(T.permissions||[]).map(G=>typeof G=="string"?G:G==null?void 0:G.name).filter(Boolean).join(`
`),permissionSets:(T.permission_sets||T.permissionSets||T.permission_set_names||[]).map(G=>typeof G=="string"?G:(G==null?void 0:G.name)||(G==null?void 0:G.id)).filter(Boolean)}),u(!0)}async function P(){if(r.name.trim()){g(!0);try{const T={name:r.name.trim(),display_name:r.display_name||r.name,description:r.description,permissions:bn(r.permissionsText),permission_sets:r.permissionSets||[]};o?await zB(o,T):await FB(T),s.invalidateQueries({queryKey:["admin","profiles"]}),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),a(null),u(!1)}catch{}finally{g(!1)}}}async function L(T){try{await BB(T),s.invalidateQueries({queryKey:["admin","profiles"]}),o===T&&(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!1)}catch{}}function I(T){i(R=>{const V=new Set(bn(R.permissionsText)),G=V.has(T);G?V.delete(T):V.add(T);let Q=R.permissionSets||[];return G&&(Q=S(Q,V)),{...R,permissionsText:Array.from(V).join(`
`),permissionSets:Q}})}function O(){const T=new Set([...m,...t]);i(R=>({...R,permissionsText:Array.from(T).join(`
`)}))}function $(){i(T=>({...T,permissionsText:""}))}function D(T){i(R=>{const V=new Set(R.permissionSets||[]),G=new Set(bn(R.permissionsText));if(V.has(T))return V.delete(T),{...R,permissionSets:Array.from(V),permissionsText:Array.from(G).join(`
`)};V.add(T);const re=C.get(T);return re&&re.forEach(ee=>G.add(ee)),{...R,permissionSets:Array.from(V),permissionsText:Array.from(G).join(`
`)}})}function F(){i(T=>{const R=new Set([...T.permissionSets||[],...e]),V=new Set(bn(T.permissionsText));return R.forEach(G=>{const Q=C.get(G);Q&&Q.forEach(re=>V.add(re))}),{...T,permissionSets:Array.from(R),permissionsText:Array.from(V).join(`
`)}})}function K(){i(T=>({...T,permissionSets:[]}))}return{profileForm:r,setProfileForm:i,editingProfile:o,setEditingProfile:a,profileModalOpen:l,setProfileModalOpen:u,profileIsSystem:d,setProfileIsSystem:h,profilePermissionSetsOpen:f,setProfilePermissionSetsOpen:p,profilePermissionsOpen:w,setProfilePermissionsOpen:x,savingProfile:y,openProfileModal:j,duplicateProfile:E,saveProfile:P,deleteProfile:L,selectedProfilePermissions:m,selectedProfilePermissionSet:b,selectedProfilePermissionSets:k,customProfilePermissions:_,toggleProfilePermission:I,selectAllProfilePermissions:O,clearProfilePermissions:$,toggleProfilePermissionSet:D,selectAllProfilePermissionSets:F,clearProfilePermissionSets:K}}function CH({open:t,onClose:e,editingProfile:n,profileForm:s,setProfileForm:r,profileIsSystem:i,profilePermissionSetsOpen:o,setProfilePermissionSetsOpen:a,profilePermissionsOpen:l,setProfilePermissionsOpen:u,permissionSetValues:d,permissionSetsQuery:h,permissionSetList:f,selectedProfilePermissionSets:p,toggleProfilePermissionSet:w,selectAllProfilePermissionSets:x,clearProfilePermissionSets:y,selectedProfilePermissions:g,permissionList:m,permissionsQuery:b,selectedProfilePermissionSet:k,toggleProfilePermission:_,selectAllProfilePermissions:C,clearProfilePermissions:S,customProfilePermissions:j,setConfirmDelete:E,saveProfile:P,savingProfile:L}){return c.jsx(Ns,{open:t,onClose:e,title:n?`Edit profile: ${n}`:"Add profile",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:I=>r(O=>({...O,name:I.target.value})),placeholder:"system_admin",disabled:!!n})}),c.jsx(Ee,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:I=>r(O=>({...O,display_name:I.target.value})),placeholder:"System Admin"})})]}),c.jsx(Ee,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:I=>r(O=>({...O,description:I.target.value})),placeholder:"What this profile can do"})}),c.jsx(Ee,{label:"Permission Sets",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>a(I=>!I),"aria-expanded":o,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Pl(s.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:o?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",o&&"rotate-180")})]})]}),o?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:x,disabled:!d.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:y,disabled:!s.permissionSets.length,children:"Clear"})]})}),h.isLoading?c.jsx(Ve,{text:"Loading permission sets",className:"text-sm text-black/60 dark:text-white/65"}):f.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:f.map(I=>{const O=I.name||I.id;if(!O)return null;const $=p.has(O);return c.jsxs("button",{type:"button",onClick:()=>w(O),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",$?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate text-xs font-medium",children:I.display_name||I.name||O}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",$?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:$?"opacity-100":"opacity-0"})})]},O)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]}):null]})}),c.jsx(Ee,{label:"Permissions",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>u(I=>!I),"aria-expanded":l,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Pl(g.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:l?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",l&&"rotate-180")})]})]}),l?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,disabled:!m.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:S,disabled:!g.length,children:"Clear"})]})}),b.isLoading?c.jsx(Ve,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):m.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[110px] overflow-y-auto p-1",children:m.map(I=>{const O=k.has(I);return c.jsxs("button",{type:"button",onClick:()=>_(I),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",O?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:I}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",O?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:O?"opacity-100":"opacity-0"})})]},I)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),j.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:j.map(I=>c.jsxs("button",{type:"button",onClick:()=>_(I),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:I}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},I))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(se,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>E({open:!0,type:"profile",payload:n,label:`Delete profile "${s.display_name||s.name}"?`}),disabled:i,children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:P,disabled:L||i,children:L?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]})})}function NH({permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:n,permissionSetsQuery:s,filteredPermissionSetList:r,duplicatePermissionSet:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Permission Sets"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(No,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add permission set"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:a}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(zt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.display_name||l.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>i(l),title:"Duplicate permission set","aria-label":"Duplicate permission set",children:c.jsx(iN,{size:16})}),c.jsx(An,{onClick:()=>n(l),title:"Edit permission set","aria-label":"Edit permission set",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>o({open:!0,type:"permission-set",payload:l.name,label:`Delete permission set "${l.display_name||l.name}"?`}),title:"Delete permission set","aria-label":"Delete permission set",children:c.jsx(ma,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(l.permissions||[]).length," permission",(l.permissions||[]).length===1?"":"s"]}),l.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:l.description}):null]},l.name)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permission sets.":"No permission sets available."})]})})]})]})}function EH({permissionSetSearch:t,setPermissionSetSearch:e,permissionSetsQuery:n,filteredPermissionSetList:s,permissionList:r,permissionsQuery:i}){const{permissionSetForm:o,setPermissionSetForm:a,editingPermissionSet:l,setEditingPermissionSet:u,permissionSetModalOpen:d,setPermissionSetModalOpen:h,savingPermissionSet:f,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:w,openPermissionSetModal:x,duplicatePermissionSet:y,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:b,selectedPermissionSetPermissionSet:k,customPermissionSetPermissions:_,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j}=TH({permissionList:r}),[E,P]=v.useState({open:!1,type:"",payload:null,label:""});async function L(){if(!(!E.open||!E.payload))try{await m(E.payload)}finally{P({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(NH,{permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:x,permissionSetsQuery:n,filteredPermissionSetList:s,duplicatePermissionSet:y,setConfirmDelete:P}),c.jsx(PH,{open:d,onClose:()=>{h(!1),u(null),a({name:"",display_name:"",description:"",permissionsText:""}),w(!1)},editingPermissionSet:l,permissionSetForm:o,setPermissionSetForm:a,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:w,selectedPermissionSetPermissions:b,permissionList:r,permissionsQuery:i,selectedPermissionSetPermissionSet:k,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j,customPermissionSetPermissions:_,setConfirmDelete:P,savePermissionSet:g,savingPermissionSet:f}),c.jsx(vc,{open:E.open,message:E.label,onClose:()=>P({open:!1,type:"",payload:null,label:""}),onConfirm:L})]})}function TH({permissionList:t}){const e=Gs(),[n,s]=v.useState({name:"",display_name:"",description:"",permissionsText:""}),[r,i]=v.useState(null),[o,a]=v.useState(!1),[l,u]=v.useState(!1),[d,h]=v.useState(!1),f=v.useMemo(()=>bn(n.permissionsText),[n.permissionsText]),p=v.useMemo(()=>new Set(f),[f]),w=v.useMemo(()=>{if(!t.length)return f;const C=new Set(t);return f.filter(S=>!C.has(S))},[t,f]);function x(C){h(!1),C?(i(C.name),s({name:C.name||"",display_name:C.display_name||C.name||"",description:C.description||"",permissionsText:(C.permissions||[]).map(S=>typeof S=="string"?S:S==null?void 0:S.name).filter(Boolean).join(`
`)})):(i(null),s({name:"",display_name:"",description:"",permissionsText:""})),a(!0)}function y(C){if(!C)return;const S=C.name||C.display_name||"permission_set",j=C.display_name||C.name||S;i(null),h(!1),s({name:`${S}_new`,display_name:`${j}_new`,description:C.description||"",permissionsText:(C.permissions||[]).map(E=>typeof E=="string"?E:E==null?void 0:E.name).filter(Boolean).join(`
`)}),a(!0)}async function g(){if(!n.name.trim())return;u(!0);const C={name:n.name.trim(),display_name:n.display_name||n.name.trim(),description:n.description,permissions:bn(n.permissionsText)};try{r?await YB(r,C):await GB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}finally{u(!1)}}async function m(C){if(C)try{await QB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}}function b(C){s(S=>{const j=new Set(bn(S.permissionsText));return j.has(C)?j.delete(C):j.add(C),{...S,permissionsText:Array.from(j).join(`
`)}})}function k(){const C=new Set([...f,...t]);s(S=>({...S,permissionsText:Array.from(C).join(`
`)}))}function _(){s(C=>({...C,permissionsText:""}))}return{permissionSetForm:n,setPermissionSetForm:s,editingPermissionSet:r,setEditingPermissionSet:i,permissionSetModalOpen:o,setPermissionSetModalOpen:a,savingPermissionSet:l,permissionSetPermissionsOpen:d,setPermissionSetPermissionsOpen:h,openPermissionSetModal:x,duplicatePermissionSet:y,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:f,selectedPermissionSetPermissionSet:p,customPermissionSetPermissions:w,togglePermissionSetPermission:b,selectAllPermissionSetPermissions:k,clearPermissionSetPermissions:_}}function PH({open:t,onClose:e,editingPermissionSet:n,permissionSetForm:s,setPermissionSetForm:r,permissionSetPermissionsOpen:i,setPermissionSetPermissionsOpen:o,selectedPermissionSetPermissions:a,permissionList:l,permissionsQuery:u,selectedPermissionSetPermissionSet:d,togglePermissionSetPermission:h,selectAllPermissionSetPermissions:f,clearPermissionSetPermissions:p,customPermissionSetPermissions:w,setConfirmDelete:x,savePermissionSet:y,savingPermissionSet:g}){return c.jsx(Ns,{open:t,onClose:e,title:n?`Edit permission set: ${n}`:"Add permission set",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:m=>r(b=>({...b,name:m.target.value})),placeholder:"sales_ops",disabled:!!n})}),c.jsx(Ee,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:m=>r(b=>({...b,display_name:m.target.value})),placeholder:"Sales Ops"})})]}),c.jsx(Ee,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:m=>r(b=>({...b,description:m.target.value})),placeholder:"What this permission set grants"})}),c.jsx(Ee,{label:"Permissions",children:c.jsxs(zt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>o(m=>!m),"aria-expanded":i,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:Pl(a.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:i?"Hide":"Edit"}),c.jsx(ss,{size:16,className:Pe("transition-transform",i&&"rotate-180")})]})]}),i?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!l.length,children:"Select all"}),c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!a.length,children:"Clear"})]})}),u.isLoading?c.jsx(Ve,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:l.map(m=>{const b=d.has(m);return c.jsxs("button",{type:"button",onClick:()=>h(m),className:Pe("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",b?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:m}),c.jsx("span",{className:Pe("h-4 w-4 rounded-full flex items-center justify-center transition-colors",b?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(pa,{size:14,className:b?"opacity-100":"opacity-0"})})]},m)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),w.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:w.map(m=>c.jsxs("button",{type:"button",onClick:()=>h(m),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:m}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},m))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(se,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>x({open:!0,type:"permission-set",payload:n,label:`Delete permission set "${s.display_name||s.name}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:y,disabled:g,children:g?c.jsx(Ve,{text:"Saving"}):"Save"})]})]})]})})}function RH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:x,setConfirmDelete:y}){const g=[{value:"",label:"All modules"},...u.map(_=>({value:_,label:_}))],m=[{value:"",label:"All services"},...d.map(_=>({value:_,label:_}))],b=[{value:"",label:"All permissions"},...h.map(_=>({value:_,label:_}))],k=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Permissions"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(No,{value:t,onChange:_=>e(_.target.value),className:"w-full sm:w-[220px]"}),c.jsx(se,{className:"rounded-2xl self-start sm:self-auto",variant:"secondary",onClick:()=>n("add",""),children:"Add permission"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[c.jsx(ot,{value:s,options:g,onChange:r}),c.jsx(ot,{value:i,options:m,onChange:o}),c.jsx(ot,{value:a,options:b,onChange:l,className:"col-span-2 sm:col-span-1"})]})]});return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{className:"hidden md:block space-y-2",children:k}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:k}),c.jsx("div",{className:"space-y-3 p-5 pt-1",children:f.isLoading?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):p.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:p.map(_=>{const C=w(_),S=x[_];return c.jsxs(zt,{className:"p-3",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Module"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.module})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Service"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.service})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Permission"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.action})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{onClick:()=>n("edit",_),title:"Edit permission","aria-label":"Edit permission",children:c.jsx(Td,{size:16})}),c.jsx(An,{variant:"ghost",onClick:()=>y({open:!0,type:"permission",payload:_,label:`Delete permission "${_}"?`}),title:"Delete permission","aria-label":"Delete permission",children:c.jsx(ma,{size:16})})]})]}),S?c.jsxs("div",{className:"mt-2 flex items-baseline gap-1 text-sm min-w-0",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Description"}),c.jsx("span",{className:"text-black/60 dark:text-white/65 truncate",children:S})]}):null]},_)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permissions.":"No permissions available."})})]})]})}function AH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:x,permissionTree:y,updateLocalPermissionDescription:g}){const{permissionModal:m,setPermissionModal:b,permissionModalError:k,savingPermission:_,openPermissionModal:C,updatePermissionModalField:S,savePermissionModal:j,deletePermissionFromModal:E,setPermissionModalError:P}=OH({mergedPermissionDescriptions:x,updateLocalPermissionDescription:g}),[L,I]=v.useState({open:!1,type:"",payload:null,label:""}),O=m.module?y.servicesByModule[m.module]||[]:y.allServices,$=m.module&&m.service?y.actionsByService[`${m.module}:${m.service}`]||[]:y.allActions;async function D(){if(!(!L.open||!L.payload))try{await E(L.payload)}finally{I({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(RH,{permissionSearch:t,setPermissionSearch:e,openPermissionModal:n||C,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:x,setConfirmDelete:I}),c.jsx(MH,{open:m.open,onClose:()=>{b({open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""}),P("")},permissionModal:m,permissionModuleOptions:u,permissionServiceOptions:O,permissionActionOptions:$,updatePermissionModalField:S,permissionModalError:k,savePermissionModal:j,savingPermission:_}),c.jsx(vc,{open:L.open,message:L.label,onClose:()=>I({open:!1,type:"",payload:null,label:""}),onConfirm:D})]})}const Bh={open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""};function OH({mergedPermissionDescriptions:t,updateLocalPermissionDescription:e}){const n=Gs(),[s,r]=v.useState(Bh),[i,o]=v.useState(""),[a,l]=v.useState(!1);function u(p="add",w=""){const x=uy(w),y=w&&t[w]||"";o(""),r({open:!0,mode:p,value:w,original:w,module:x.module,service:x.service,action:x.action,description:y,originalDescription:y})}function d(p,w){r(x=>{const y={...x,[p]:w};return{...y,value:ik(y)}}),o("")}async function h(){var w;const p=ik(s);if(!p){o("Select module, service, and permission.");return}l(!0);try{const x=((w=s.description)==null?void 0:w.trim())||"";if(s.mode==="add")await wg(p,x),e(p,x);else if(p!==s.original)await wg(p,x),await r_(s.original),e(s.original,""),e(p,x);else if(x!==s.originalDescription)await wg(p,x),e(p,x);else{r({...Bh});return}n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Bh})}catch{}finally{l(!1)}}async function f(p){const w=p||s.original||s.value;if(w){l(!0);try{await r_(w),e(w,""),n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Bh})}catch{}finally{l(!1)}}}return{permissionModal:s,setPermissionModal:r,permissionModalError:i,savingPermission:a,openPermissionModal:u,updatePermissionModalField:d,savePermissionModal:h,deletePermissionFromModal:f,setPermissionModalError:o}}function MH({open:t,onClose:e,permissionModal:n,permissionModuleOptions:s,permissionServiceOptions:r,permissionActionOptions:i,updatePermissionModalField:o,permissionModalError:a,savePermissionModal:l,savingPermission:u}){return c.jsx(Ns,{open:t,onClose:e,title:n.mode==="edit"?"Edit permission":"Add permission",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ee,{label:"Permission",children:c.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr_auto_1fr] items-center gap-2",children:[c.jsxs("div",{children:[c.jsx("input",{list:"permission-module-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.module,onChange:d=>o("module",d.target.value),placeholder:"module"}),c.jsx("datalist",{id:"permission-module-options",children:s.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-service-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.service,onChange:d=>o("service",d.target.value),placeholder:"service"}),c.jsx("datalist",{id:"permission-service-options",children:r.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-action-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.action,onChange:d=>o("action",d.target.value),placeholder:"permission"}),c.jsx("datalist",{id:"permission-action-options",children:i.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]})]})}),c.jsx(Ee,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.description,onChange:d=>o("description",d.target.value),placeholder:"Short description"})}),a?c.jsx("div",{className:"text-xs text-red-600 dark:text-red-300",children:a}):null,c.jsx("div",{className:"flex justify-end",children:c.jsx(se,{className:"rounded-2xl",onClick:l,disabled:u,children:u?c.jsx(Ve,{text:"Saving"}):n.mode==="edit"?"Update Permission":"Add Permission"})})]})})}const IH=[{key:"chat",label:"AI Chat",description:"Chat assistant for general queries"},{key:"video_critique",label:"Video Critique",description:"AI-powered video analysis tool"},{key:"proposals",label:"Proposals",description:"Proposal generation and management"},{key:"asset_management",label:"Asset Management",description:"Digital asset management system"}],DH=[{key:"mockup_setup",label:"Mockup Setup",description:"Configure and upload mockup templates"},{key:"mockup_generate",label:"Mockup Generate",description:"Generate mockups from templates"}];function LH({isInitializing:t,isDevMode:e,serviceVisibility:n,isUpdating:s,onToggleService:r}){return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Gt,{className:"pb-2",children:[c.jsx(Yt,{className:"text-lg",children:"Service Visibility"}),c.jsx("p",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle which services are visible to users in the sidebar. Admin and Settings are always visible."})]}),c.jsx(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-6",children:t?c.jsxs("div",{className:"space-y-6 animate-pulse",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"h-4 w-28 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"grid gap-3",children:[1,2,3,4].map(i=>c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"h-4 w-24 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"h-3 w-40 bg-black/5 dark:bg-white/5 rounded"})]}),c.jsx("div",{className:"h-6 w-11 bg-black/10 dark:bg-white/10 rounded-full"})]},i))})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"h-4 w-28 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"grid gap-3",children:[1,2].map(i=>c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"h-4 w-24 bg-black/10 dark:bg-white/10 rounded"}),c.jsx("div",{className:"h-3 w-40 bg-black/5 dark:bg-white/5 rounded"})]}),c.jsx("div",{className:"h-6 w-11 bg-black/10 dark:bg-white/10 rounded-full"})]},i))})]})]}):c.jsxs(c.Fragment,{children:[e&&c.jsxs("div",{className:"rounded-xl bg-amber-500/10 border border-amber-500/30 p-3 mb-4",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-amber-600 dark:text-amber-400 font-medium text-sm",children:"Dev Mode Active"})}),c.jsxs("p",{className:"text-xs text-amber-600/80 dark:text-amber-400/80 mt-1",children:["All services are forced visible. Running with"," ",c.jsx("code",{className:"bg-amber-500/20 px-1 rounded",children:"--dev-all-services"})," flag. Toggles are disabled in this mode."]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-sm font-medium text-black/70 dark:text-white/75",children:"General Services"}),c.jsx("div",{className:"grid gap-3",children:IH.map(i=>c.jsx($_,{label:i.label,description:i.description,enabled:n[i.key]===!0,onChange:()=>r(i.key,n[i.key]),disabled:e||s},i.key))})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"text-sm font-medium text-black/70 dark:text-white/75",children:"Mockup Services"}),c.jsx("p",{className:"text-xs text-black/50 dark:text-white/50",children:"If both are disabled, the Mockup service will be hidden entirely."}),c.jsx("div",{className:"grid gap-3",children:DH.map(i=>c.jsx($_,{label:i.label,description:i.description,enabled:n[i.key]===!0,onChange:()=>r(i.key,n[i.key]),disabled:e||s},i.key))})]}),c.jsx("div",{className:"pt-4 border-t border-black/10 dark:border-white/10",children:c.jsxs("p",{className:"text-xs text-black/50 dark:text-white/50",children:[c.jsx("strong",{children:"Always visible:"})," Admin (for admins only), Settings"]})})]})})]})}function $_({label:t,description:e,enabled:n,onChange:s,disabled:r}){return c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between rounded-xl bg-black/[0.02] dark:bg-white/[0.03] p-3 ring-1 ring-black/5 dark:ring-white/10",children:[c.jsxs("div",{className:"flex-1 min-w-0 sm:mr-4",children:[c.jsx("div",{className:"text-sm font-medium",children:t}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/50 break-words sm:truncate",children:e})]}),c.jsx("button",{type:"button",role:"switch","aria-checked":n,disabled:r,onClick:s,className:["relative inline-flex h-6 w-11 shrink-0 cursor-pointer rounded-full border-2 border-transparent self-start sm:self-auto","transition-all duration-200 ease-in-out focus:outline-none focus-visible:ring-2 focus-visible:ring-black/20",n?"bg-green-500":"bg-black/20 dark:bg-white/20",r?"opacity-50 cursor-not-allowed":""].join(" "),children:c.jsx("span",{className:["pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow-lg ring-0","transition-transform duration-200 ease-in-out",n?"translate-x-5":"translate-x-0"].join(" ")})})]})}const Mg=20;function $H(){const{user:t}=pi(),[e,n]=v.useState("users"),[s,r]=v.useState(""),[i,o]=v.useState(0),[a,l]=v.useState(""),[u,d]=v.useState(""),[h,f]=v.useState(""),[p,w]=v.useState(""),[x,y]=v.useState(""),[g,m]=v.useState(""),[b,k]=v.useState(""),[_,C]=v.useState(""),[S,j]=v.useState("");if(!Rd(t))return c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Restricted"})}),c.jsx(Qt,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to the admin panel."})]});const E=Kt({queryKey:["admin","users",i],queryFn:()=>RB({limit:Mg,offset:i*Mg})}),P=Kt({queryKey:["admin","profiles"],queryFn:$B}),L=Kt({queryKey:["admin","permissions"],queryFn:UB}),I=Kt({queryKey:["admin","companies"],queryFn:HB}),O=Kt({queryKey:["admin","permission-sets"],queryFn:KB}),$=Gs(),D={chat:!0,video_critique:!0,mockup_setup:!0,mockup_generate:!0,proposals:!0,asset_management:!0},F=Kt({queryKey:["service-visibility"],queryFn:E0,placeholderData:D,keepPreviousData:!0}),K=F.data||D,T=F.isLoading&&!F.isFetched,R=K._dev_mode===!0,V=sN({mutationFn:XB,onMutate:async ae=>{await $.cancelQueries({queryKey:["service-visibility"]});const te=$.getQueryData(["service-visibility"]);return $.setQueryData(["service-visibility"],ae),{previousVisibility:te}},onError:(ae,te,ne)=>{$.setQueryData(["service-visibility"],ne==null?void 0:ne.previousVisibility)},onSettled:()=>{$.invalidateQueries({queryKey:["service-visibility"]})}}),G=v.useCallback((ae,te)=>{const ne={...K,[ae]:!te};V.mutate(ne)},[K,V]),Q=v.useMemo(()=>{var ne;const ae=((ne=E.data)==null?void 0:ne.users)||E.data||[],te=s.trim().toLowerCase();return ae.filter(je=>{var Kn,Qs,Hr,yr,lt;const Xt=Array.isArray(je.profiles)?je.profiles.map(ct=>(ct==null?void 0:ct.display_name)||(ct==null?void 0:ct.name)||ct).filter(Boolean).join(" "):((Kn=je.profiles)==null?void 0:Kn.display_name)||((Qs=je.profiles)==null?void 0:Qs.name)||je.profile||je.profile_name||"",Ys=`${je.email||""} ${je.name||""} ${Xt}`.toLowerCase();if(te&&!Ys.includes(te))return!1;const Mn=((Hr=je.company)==null?void 0:Hr.code)||je.company_code||je.company_id||"";return!(x&&Mn!==x||g&&!(Array.isArray(je.profiles)?je.profiles.map(ft=>(ft==null?void 0:ft.name)||(ft==null?void 0:ft.display_name)||ft).filter(Boolean):[((yr=je.profiles)==null?void 0:yr.name)||((lt=je.profiles)==null?void 0:lt.display_name)||je.profile||je.profile_name].filter(Boolean)).includes(g))})},[E.data,s,x,g]);v.useMemo(()=>{var te;return(((te=E.data)==null?void 0:te.users)||E.data||[]).length===Mg},[E.data]),v.useEffect(()=>{C(""),j("")},[b]),v.useEffect(()=>{j("")},[_]);const re=v.useMemo(()=>{var te;const ae=((te=P.data)==null?void 0:te.profiles)??P.data;return Array.isArray(ae)?ae:[]},[P.data]),ee=v.useMemo(()=>{var yr;const ae=((yr=L.data)==null?void 0:yr.permissions)??L.data,te=new Map,ne={},je=(lt,ct,ft)=>{if(!lt||!ct||!ft)return;te.has(lt)||te.set(lt,new Map);const dn=te.get(lt);dn.has(ct)||dn.set(ct,new Set),dn.get(ct).add(ft)};Array.isArray(ae)?ae.forEach(lt=>{const ct=typeof lt=="string"?lt:lt==null?void 0:lt.name,ft=typeof lt=="string"?"":(lt==null?void 0:lt.description)||"";if(ct&&ft&&(ne[ct]=ft),!ct)return;const dn=ct.split(":");dn.length>=3&&je(dn[0],dn[1],dn[2])}):ae&&typeof ae=="object"&&Object.entries(ae).forEach(([lt,ct])=>{!ct||typeof ct!="object"||Object.entries(ct).forEach(([ft,dn])=>{Array.isArray(dn)&&dn.forEach(bi=>je(lt,ft,bi))})});const Xt=Array.from(te.keys()).sort(),Ys={},Mn={},Kn=[],Qs=new Set,Hr=new Set;return Xt.forEach(lt=>{const ct=Array.from(te.get(lt).keys()).sort();Ys[lt]=ct,ct.forEach(ft=>{Qs.add(ft);const dn=Array.from(te.get(lt).get(ft)).sort();Mn[`${lt}:${ft}`]=dn,dn.forEach(bi=>{Hr.add(bi),Kn.push(`${lt}:${ft}:${bi}`)})})}),{modules:Xt,servicesByModule:Ys,actionsByService:Mn,flat:Kn,allServices:Array.from(Qs).sort(),allActions:Array.from(Hr).sort(),descriptions:ne}},[L.data]),z=v.useMemo(()=>ee.flat,[ee]),A=ee.descriptions||{},[Y,U]=v.useState({}),J=v.useMemo(()=>({...A||{},...Y}),[A,Y]),be=v.useCallback((ae,te)=>{if(!ae)return;const ne=(te==null?void 0:te.trim())||"";U(je=>{const Xt={...je};return ne?Xt[ae]=ne:delete Xt[ae],Xt})},[]),me=ee.modules,H=b?ee.servicesByModule[b]||[]:ee.allServices,ye=b&&_?ee.actionsByService[`${b}:${_}`]||[]:ee.allActions,X=v.useMemo(()=>{var te;const ae=((te=I.data)==null?void 0:te.companies)??I.data;return Array.isArray(ae)?ae:[]},[I.data]),ue=v.useMemo(()=>{var te,ne;const ae=((te=O.data)==null?void 0:te.permission_sets)??((ne=O.data)==null?void 0:ne.permissionSets)??O.data;return Array.isArray(ae)?ae.map(je=>typeof je=="string"?{name:je}:je):[]},[O.data]),de=v.useMemo(()=>{const ae=u.trim().toLowerCase();return ae?X.filter(te=>`${te.name||""} ${te.code||""} ${te.country||""} ${te.currency||""} ${te.timezone||""}`.toLowerCase().includes(ae)):X},[X,u]),he=v.useMemo(()=>{const ae=a.trim().toLowerCase();return ae?re.filter(te=>`${te.display_name||""} ${te.name||""} ${te.description||""}`.toLowerCase().includes(ae)):re},[re,a]),oe=v.useMemo(()=>{const ae=h.trim().toLowerCase();return ae?ue.filter(te=>`${te.display_name||""} ${te.name||""} ${te.description||""}`.toLowerCase().includes(ae)):ue},[ue,h]),Se=v.useMemo(()=>{const ae=p.trim().toLowerCase();let te=z;return(b||_||S)&&(te=te.filter(ne=>{const je=uy(ne);return!(b&&je.module!==b||_&&je.service!==_||S&&je.action!==S)})),ae?te.filter(ne=>{const je=J[ne]||"";return`${ne} ${je}`.toLowerCase().includes(ae)}):te},[z,p,J,b,_,S]),ie=v.useMemo(()=>X.map(ae=>({value:ae.code||ae.id||"",label:ae.name||ae.code||ae.id||""})).filter(ae=>ae.value),[X]),W=v.useMemo(()=>re.map(ae=>({value:ae.name||ae.display_name||"",label:ae.display_name||ae.name||""})).filter(ae=>ae.value),[re]),ke=v.useMemo(()=>ue.map(ae=>ae.name||ae.id).filter(Boolean),[ue]),Re=v.useMemo(()=>re.map(ae=>ae.name||ae.id).filter(Boolean),[re]),Oe=v.useMemo(()=>{const ae=new Map;return X.forEach(te=>{const ne=te.code||te.id;ne&&ae.set(ne,te.name||te.code||ne)}),ae},[X]);return c.jsxs("div",{className:"flex h-full min-h-0 flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto py-1",children:[c.jsx(se,{variant:e==="users"?"default":"ghost",onClick:()=>n("users"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="users"?"mmg-tab-btn-active":""}`,children:"Users"}),c.jsx(se,{variant:e==="companies"?"default":"ghost",onClick:()=>n("companies"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="companies"?"mmg-tab-btn-active":""}`,children:"Companies"}),c.jsx(se,{variant:e==="profiles"?"default":"ghost",onClick:()=>n("profiles"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="profiles"?"mmg-tab-btn-active":""}`,children:"Profiles"}),c.jsx(se,{variant:e==="permission-sets"?"default":"ghost",onClick:()=>n("permission-sets"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="permission-sets"?"mmg-tab-btn-active":""}`,children:"Permission Sets"}),c.jsx(se,{variant:e==="permissions"?"default":"ghost",onClick:()=>n("permissions"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="permissions"?"mmg-tab-btn-active":""}`,children:"Permissions"}),c.jsx(se,{variant:e==="services"?"default":"ghost",onClick:()=>n("services"),className:`rounded-2xl shrink-0 mmg-tab-btn ${e==="services"?"mmg-tab-btn-active":""}`,children:"Services"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:e==="users"?"h-full":"hidden","aria-hidden":e!=="users",children:c.jsx(gH,{q:s,setQ:r,usersQuery:E,users:Q,user:t,companyLookup:Oe,userCompanyFilter:x,setUserCompanyFilter:y,userProfileFilter:g,setUserProfileFilter:m,companyFilterOptions:ie,profileFilterOptions:W,companyList:X,profileOptions:re,profileValues:Re,permissionSetList:ue,permissionSetValues:ke,permissionList:z,permissionsQuery:L,page:i})}),c.jsx("div",{className:e==="companies"?"h-full":"hidden","aria-hidden":e!=="companies",children:c.jsx(bH,{companySearch:u,setCompanySearch:d,companiesQuery:I,filteredCompanyList:de,companyLookup:Oe,companyList:X})}),c.jsx("div",{className:e==="profiles"?"h-full":"hidden","aria-hidden":e!=="profiles",children:c.jsx(SH,{profileSearch:a,setProfileSearch:l,filteredProfileOptions:he,permissionList:z,permissionSetValues:ke,permissionSetList:ue,permissionSetsQuery:O,permissionsQuery:L})}),c.jsx("div",{className:e==="permission-sets"?"h-full":"hidden","aria-hidden":e!=="permission-sets",children:c.jsx(EH,{permissionSetSearch:h,setPermissionSetSearch:f,permissionSetsQuery:O,filteredPermissionSetList:oe,permissionList:z,permissionsQuery:L})}),c.jsx("div",{className:e==="permissions"?"h-full":"hidden","aria-hidden":e!=="permissions",children:c.jsx(AH,{permissionSearch:p,setPermissionSearch:w,permissionModuleFilter:b,setPermissionModuleFilter:k,permissionServiceFilter:_,setPermissionServiceFilter:C,permissionActionFilter:S,setPermissionActionFilter:j,permissionModuleOptions:me,permissionFilterServiceOptions:H,permissionFilterActionOptions:ye,permissionsQuery:L,filteredPermissionList:Se,parsePermissionParts:uy,mergedPermissionDescriptions:J,permissionTree:ee,updateLocalPermissionDescription:be})}),c.jsx("div",{className:e==="services"?"h-full min-h-0":"hidden","aria-hidden":e!=="services",children:c.jsx(LH,{isInitializing:T,isDevMode:R,serviceVisibility:K,isUpdating:V.isPending,onToggleService:G})})]})]})}function FH({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function zH(){const{notifications:t,loading:e,clearAll:n,dismissNotification:s,markRead:r,formatTime:i}=N0(),[o,a]=v.useState(null),l=v.useMemo(()=>t,[t]);return c.jsxs("div",{className:"h-full min-h-0",children:[c.jsxs(St,{className:"h-full flex flex-col",children:[c.jsxs(Gt,{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx(Yt,{children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:l.length?`${l.length} total`:"No alerts yet"})]}),c.jsx(se,{variant:"secondary",className:"rounded-2xl",onClick:n,disabled:!l.length,children:"Clear all"})]}),c.jsx(Qt,{className:"flex-1 min-h-0 overflow-y-auto pt-2",children:e?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"space-y-2",children:l.map(u=>c.jsx(zt,{className:"p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-base font-semibold text-black/85 dark:text-white/85 truncate",children:u.title||"Notification"}),u.message?c.jsx("div",{className:"mt-1 text-sm text-black/60 dark:text-white/65 leading-5 mmg-line-clamp-2",children:u.message}):null,u.created_at?c.jsx("div",{className:"mt-1 text-xs text-black/45 dark:text-white/45",children:i(u.created_at)}):null]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(An,{variant:"ghost",className:"h-8 w-8",onClick:()=>{r(u.id),a(u)},"aria-label":"View notification",children:c.jsx(oN,{size:14})}),c.jsx(An,{variant:"ghost",className:"h-8 w-8",onClick:()=>s(u.id),"aria-label":"Close notification",children:c.jsx(s0,{size:14})})]})]})},u.id))}):c.jsx(zt,{className:"p-6 text-center text-sm text-black/60 dark:text-white/65",children:"You're all caught up."})})]}),c.jsx(Ns,{open:!!o,onClose:()=>a(null),title:(o==null?void 0:o.title)||"Notification",maxWidth:"520px",children:c.jsx(FH,{notification:o})})]})}function BH(){const[t,e]=v.useState(null),[n,s]=v.useState([]),[r,i]=v.useState(""),[o,a]=v.useState(null),[l,u]=v.useState(null),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,x]=v.useState(!1),[y,g]=v.useState(null),[m,b]=v.useState({}),[k,_]=v.useState(null),[C,S]=v.useState(!1),[j,E]=v.useState(!1),P=v.useRef(null),L=v.useRef(null),I=v.useRef(null),O=v.useRef(null),$=v.useRef(!0),D=Kt({queryKey:["video-critique","history"],queryFn:C4,enabled:!0}),F=v.useMemo(()=>(r.trim().length>0||!!o)&&!d,[r,o,d]);v.useEffect(()=>{var A;if(f||D.isLoading)return;const z=D.data;if(z&&((A=z.messages)!=null&&A.length||z.session_id||z.conversation_id)){e(z.session_id||z.conversation_id||null);const Y=(z.messages||[]).map(KH);s(Y.length?Y:[z_()])}else s([z_()]);p(!0)},[D.data,D.isLoading,f]),v.useEffect(()=>{const z=L.current;if(!z)return;const A=()=>{const U=z.scrollHeight-z.scrollTop-z.clientHeight<=120;$.current=U};return A(),z.addEventListener("scroll",A,{passive:!0}),()=>z.removeEventListener("scroll",A)},[]);const K=ve.useCallback((z="smooth",A=!1)=>{var Y;!A&&!$.current||(Y=I.current)==null||Y.scrollIntoView({behavior:z,block:"end"})},[]);v.useEffect(()=>{const z=d?"auto":"smooth";requestAnimationFrame(()=>K(z))},[n,d,K]),v.useEffect(()=>{f&&requestAnimationFrame(()=>K("auto",!0))},[f,K]),v.useEffect(()=>()=>{var z,A;return(A=(z=O.current)==null?void 0:z.abort)==null?void 0:A.call(z)},[]);const T=v.useMemo(()=>{var z;return(z=y==null?void 0:y.fields)!=null&&z.length?y.fields.every(A=>{if(!A.required)return!0;const Y=m==null?void 0:m[A.id];return Y!=null&&String(Y).trim()!==""}):!1},[y,m]);function R(){x(!1),g(null),b({}),_(null),S(!1),E(!1)}async function V({formType:z,workflowId:A}){x(!0),S(!0),_({formType:z,workflowId:A}),g(null),b({});try{const Y=await A4(z);g(Y);const U={};((Y==null?void 0:Y.fields)||[]).forEach(J=>{U[J.id]=J.default_value||""}),b(U)}catch(Y){g({title:"Action",submit_text:"Submit",fields:[],error:(Y==null?void 0:Y.message)||"Failed to load form."})}finally{S(!1)}}function G(z,A={}){s(Y=>[...Y,{id:crypto.randomUUID(),role:"assistant",content:z,files:[],status:null,...A}])}async function Q(z){if(!z||z.url)return;const A=z.action_id||z.id,Y=z.workflow_id||z.workflowId;if(!A||!Y){G("Missing action details. Please try again.");return}try{E(!0);const U=await P4({actionId:A,workflowId:Y});if(U!=null&&U.requires_form){E(!1),await V({formType:U.form_type||z.form_type,workflowId:U.workflow_id||Y});return}G((U==null?void 0:U.message)||"Action completed.")}catch(U){G((U==null?void 0:U.message)||"Unable to complete that action.")}finally{E(!1)}}async function re(){if(!(!(k!=null&&k.formType)||!(k!=null&&k.workflowId))&&T){E(!0);try{const z=await R4({formType:k.formType,workflowId:k.workflowId,category:m.category,reason:m.reason});R(),G((z==null?void 0:z.message)||"Form submitted.")}catch(z){G((z==null?void 0:z.message)||"Unable to submit the form."),E(!1)}}}async function ee(){var X,ue;if(!F)return;const z=r.trim(),A=o,Y=!!l&&!A,U=z||(A?`Please review this file: ${A.name}`:"");A&&l&&u(null);const J=crypto.randomUUID(),be=A?[{file_id:`local-${Date.now()}`,filename:A.name,preview_url:URL.createObjectURL(A)}]:[],me={id:J,role:"user",content:z,files:be,status:null},H=crypto.randomUUID(),ye={id:H,role:"assistant",content:"",files:[],status:Y?null:"Reviewing..."};s(de=>[...de,me,ye]),i(""),a(null),$.current=!0,requestAnimationFrame(()=>K("auto",!0));try{let de=[];if(Y){const W=F_(z);if(!W){s(Re=>Re.map(Oe=>Oe.id===H?{...Oe,status:null,content:"Please provide a task number to upload this video."}:Oe));return}h(!0);const ke=await o_({file:l,taskNumber:W});s(Re=>Re.map(Oe=>Oe.id===H?{...Oe,status:null,content:(ke==null?void 0:ke.message)||"Video uploaded."}:Oe)),u(null);return}if(A&&VH(A)){const W=F_(z);if(W){h(!0);const ke=await o_({file:A,taskNumber:W});s(Re=>Re.map(Oe=>Oe.id===H?{...Oe,status:null,content:(ke==null?void 0:ke.message)||"Video uploaded."}:Oe));return}u(A),s(ke=>ke.map(Re=>Re.id===H?{...Re,status:null,content:"Video received. Which task number is this for?"}:Re));return}if(A&&qH(A)){h(!0);const W=await N4({file:A,message:z||void 0,sessionId:t});if(W!=null&&W.session_id&&e(ke=>ke||W.session_id),W!=null&&W.file_id){const ke={file_id:W.file_id,filename:A.name,file_url:W.file_url||W.url||""};s(Re=>Re.map(Oe=>{var ae,te,ne,je;return Oe.id===J?{...Oe,files:[{...ke,preview_url:((te=(ae=Oe.files)==null?void 0:ae[0])==null?void 0:te.preview_url)||((je=(ne=Oe.files)==null?void 0:ne[0])==null?void 0:je.url)||""}]}:Oe}))}s(ke=>ke.map(Re=>Re.id===H?{...Re,status:null,content:(W==null?void 0:W.response)||(W==null?void 0:W.message)||"File received."}:Re));return}if(A){h(!0);const W=await E4({file:A});if(!(W!=null&&W.file_id))throw new Error("Upload failed");de=[W.file_id];const ke={file_id:W.file_id,filename:A.name,file_url:W.file_url||W.url||""};s(Re=>Re.map(Oe=>{var ae,te,ne,je;return Oe.id===J?{...Oe,files:[{...ke,preview_url:((te=(ae=Oe.files)==null?void 0:ae[0])==null?void 0:te.preview_url)||((je=(ne=Oe.files)==null?void 0:ne[0])==null?void 0:je.url)||""}]}:Oe}))}if(!A&&z.startsWith("/")){h(!0);const ke=z.replace(/^\/+/,"").split(/\\s+/),Re=ke.shift()||"",Oe=ke.join(" "),ae=await T4({command:Re,args:Oe,sessionId:t});ae!=null&&ae.session_id&&e(te=>te||ae.session_id),s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:(ae==null?void 0:ae.response)||(ae==null?void 0:ae.error)||"Command failed."}:ne));return}h(!0),(ue=(X=O.current)==null?void 0:X.abort)==null||ue.call(X);const he=new AbortController;O.current=he;let oe="",Se=null,ie=!1;await M4({sessionId:t,message:U,fileIds:de,signal:he.signal,onEvent:W=>{var Oe,ae;if((W!=null&&W.session_id||W!=null&&W.conversation_id)&&e(te=>te||W.session_id||W.conversation_id),(W==null?void 0:W.type)==="error"||W!=null&&W.error){const te=(W==null?void 0:W.message)||(W==null?void 0:W.error)||"Stream error";s(ne=>ne.map(je=>je.id===H?{...je,status:null,content:`Error: ${te}`}:je));return}if((W==null?void 0:W.type)==="status"){s(te=>te.map(ne=>ne.id===H?{...ne,status:W.content||"Processing..."}:ne)),W.message_id&&(Se=W.message_id);return}if((W==null?void 0:W.type)==="delete"){W.message_id&&W.message_id===Se&&(oe="",Se=null,s(te=>te.map(ne=>ne.id===H?{...ne,status:"Reviewing...",content:""}:ne)));return}if((W==null?void 0:W.type)==="tool_call"){const te=W.name||((Oe=W.tool)==null?void 0:Oe.name)||"processing";s(ne=>ne.map(je=>je.id===H?{...je,status:`Processing ${te}...`}:je));return}const ke=((ae=W==null?void 0:W.result)==null?void 0:ae.pdf_filename)||(W==null?void 0:W.pdf_filename),Re=te=>!te||!ke||te.pdf_filename?te:{...te,pdf_filename:ke};if(ke&&s(te=>te.map(ne=>ne.id===H&&!ne.pdf_filename?{...ne,pdf_filename:ke}:ne)),(W==null?void 0:W.type)==="delta"&&W.content){oe+=W.content,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:oe}:ne));return}if((W==null?void 0:W.type)==="text_done"){oe=W.content||oe,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:oe}:ne));return}if(((W==null?void 0:W.type)==="chunk"||(W==null?void 0:W.type)==="content")&&W.content){W.message_id&&W.message_id!==Se&&(Se=W.message_id),oe=W.type==="content"?W.content:oe+W.content,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:oe}:ne));return}if(W!=null&&W.content&&!W.type){oe+=W.content,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:oe}:ne));return}if((W==null?void 0:W.type)==="actions"&&W.actions){s(te=>te.map(ne=>ne.id===H?{...ne,actions:W.actions}:ne));return}if(W!=null&&W.actions){s(te=>te.map(ne=>ne.id===H?{...ne,actions:W.actions}:ne));return}if((W==null?void 0:W.type)==="files"&&W.files){if(ie=!0,s(te=>te.map(ne=>ne.id===H?{...ne,files:[...ne.files||[],...W.files.map(Re)]}:ne)),!oe){const te=W.files.find(ne=>ne.comment);te!=null&&te.comment&&(oe=te.comment,s(ne=>ne.map(je=>je.id===H?{...je,status:null,content:oe}:je)))}return}if((W==null?void 0:W.type)==="file"&&(W.file||W.url)){const te=Re(W.file||W);ie=!0,s(ne=>ne.map(je=>je.id===H?{...je,files:[...je.files||[],te]}:je)),!oe&&te.comment&&(oe=te.comment,s(ne=>ne.map(je=>je.id===H?{...je,status:null,content:oe}:je)));return}if(W!=null&&W.files){ie=!0,s(te=>te.map(ne=>ne.id===H?{...ne,files:[...ne.files||[],...W.files.map(Re)]}:ne));return}typeof W=="string"&&W.trim()&&(oe+=W,s(te=>te.map(ne=>ne.id===H?{...ne,status:null,content:oe}:ne)))},onDone:()=>{!oe&&!ie&&s(W=>W.map(ke=>ke.id===H?{...ke,status:null,content:"Ready for the next request when you are."}:ke))}})}catch(de){s(he=>he.map(oe=>oe.id===H?{...oe,status:null,content:(de==null?void 0:de.message)||"Failed to get response"}:oe))}finally{h(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(St,{className:"p-4 overflow-hidden flex-1 min-h-0",children:c.jsx("div",{ref:L,className:"h-full overflow-y-auto px-2",children:c.jsxs("div",{className:"space-y-3",children:[!f&&D.isLoading?c.jsx(Ve,{text:"Loading conversation",className:"text-sm text-black/60 dark:text-white/65"}):null,n.map(z=>c.jsx(UH,{msg:z,onMediaLoad:()=>K("auto"),onAction:Q,actionsDisabled:j},z.id)),c.jsx("div",{ref:I})]})})}),c.jsxs(St,{className:"p-3",children:[l&&!o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsxs("div",{className:"truncate",children:["Awaiting task number for ",l.name]}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>u(null),children:"x"})]}):null,o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:o.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>a(null),children:"x"})]}):null,c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:P,type:"file",className:"hidden",onChange:z=>{var A;return a(((A=z.target.files)==null?void 0:A[0])||null)},accept:"video/*,image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(se,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var z;return(z=P.current)==null?void 0:z.click()},children:c.jsx(aN,{size:18})}),c.jsx(HH,{value:r,onChange:i,placeholder:"Describe the video request...",onEnter:ee}),c.jsx(se,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!F,onClick:ee,children:c.jsx(lN,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"Share a brief, a link, or upload a cut for review."})]}),c.jsx(Ns,{open:w,onClose:R,title:(y==null?void 0:y.title)||"Action",maxWidth:"520px",children:C?c.jsx(Ve,{text:"Loading form",className:"text-sm text-black/60 dark:text-white/65"}):y!=null&&y.error?c.jsx("div",{className:"text-sm text-red-600 dark:text-red-300",children:y.error}):c.jsxs("div",{className:"space-y-3",children:[((y==null?void 0:y.fields)||[]).map(z=>{if(z.type==="select"){const A=[{value:"",label:z.placeholder||"Select..."},...z.options||[]];return c.jsx(Ee,{label:z.label,children:c.jsx(ot,{value:m[z.id]||"",options:A,onChange:Y=>b(U=>({...U,[z.id]:Y}))})},z.id)}return z.type==="textarea"?c.jsx(Ee,{label:z.label,children:c.jsx("textarea",{rows:3,placeholder:z.placeholder||"",className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[z.id]||"",onChange:A=>b(Y=>({...Y,[z.id]:A.target.value}))})},z.id):c.jsx(Ee,{label:z.label,children:c.jsx("input",{type:"text",placeholder:z.placeholder||"",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[z.id]||"",onChange:A=>b(Y=>({...Y,[z.id]:A.target.value}))})},z.id)}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:R,children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:re,disabled:!T||j||C,children:(y==null?void 0:y.submit_text)||"Submit"})]})]})})]})}function UH({msg:t,onMediaLoad:e,onAction:n,actionsDisabled:s}){var h;const r=t.role==="user",i=v.useMemo(()=>ZH(t.content||""),[t.content]),o=v.useMemo(()=>zy(t.status||""),[t.status]),a=v.useMemo(()=>!t.status&&GH(t.content||""),[t.status,t.content]),l=v.useMemo(()=>zy(t.content||""),[t.content]),u=v.useRef(new Map),d=t.actions||t.buttons||[];return c.jsx("div",{className:r?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",r?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[t.status||a?c.jsx(WH,{text:o||l}):c.jsx("div",{dangerouslySetInnerHTML:{__html:i}}),(h=t.files)!=null&&h.length?c.jsx("div",{className:"mt-2 space-y-1",children:t.files.map((f,p)=>{const w=O4(f);if(!w)return null;const x=f.pdf_filename||t.pdf_filename,y=XH(x?{...f,pdf_filename:x}:f,w,u.current),g=Zc(y),m=["jpg","jpeg","png","gif","webp","bmp"].includes(g),b=!r,k=g==="pdf";return m?c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:b?c.jsxs(c.Fragment,{children:[c.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"block overflow-hidden rounded-lg",children:c.jsx("img",{src:w,alt:y,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(po,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),Uh(w,y)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),Uh(w,y))},className:"inline-flex items-center",children:[c.jsx(ja,{size:14,className:"mr-1"}),"Download"]})})]})]}):c.jsx("div",{className:"overflow-hidden rounded-lg",children:c.jsx("img",{src:w,alt:y,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})})},f.file_id||w||p):c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:k?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(n0,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:g?g.toUpperCase():"FILE"})}),b?c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:y}):null]}),b?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(se,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(po,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(se,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),Uh(w,y)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),Uh(w,y))},className:"inline-flex items-center",children:[c.jsx(ja,{size:14,className:"mr-1"}),"Download"]})})]}):null]})},f.file_id||w||p)})}):null,d.length?c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.map((f,p)=>{const w=f.action_id||f.id||`${f.label}-${p}`,x=f.variant||"secondary";return f.url?c.jsx(se,{asChild:!0,size:"sm",variant:x,className:"rounded-xl",disabled:s,children:c.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",children:f.label||"Open"})},w):c.jsx(se,{size:"sm",variant:x,className:"rounded-xl",onClick:()=>n==null?void 0:n(f),disabled:s,children:f.label||"Action"},w)})}):null]})})}function HH({value:t,onChange:e,placeholder:n,onEnter:s,disabled:r}){const i=v.useRef(null);v.useEffect(()=>{const a=i.current;if(!a)return;a.style.height="0px";const u=22*5+16;a.style.height=Math.min(a.scrollHeight,u)+"px"},[t]);function o(a){a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),s==null||s())}return c.jsx("textarea",{ref:i,rows:1,value:t,disabled:r,onChange:a=>e(a.target.value),onKeyDown:o,placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function WH({text:t}){return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:t||"Reviewing"}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function F_(t){if(!t)return null;const e=String(t).match(/\b(\d{1,6})\b/);return e?Number(e[1]):null}function VH(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function qH(t){if(!t)return!1;if(t.type&&t.type.startsWith("image/"))return!0;const e=t.name||"";return/\.(png|jpe?g|gif|webp|bmp)$/i.test(e)}function KH(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||t.sender||"assistant",content:t.content||t.message||"",files:t.files||t.attachments||[],actions:t.actions||t.buttons||[],pdf_filename:t.pdf_filename||t.pdfFilename,status:null}}function zy(t){return t?String(t).replace(/[_*`]/g,"").replace(/\.+$/,"").replace(/\s+/g," ").trim():""}function GH(t){const e=zy(t);return e?!!(e==="Reviewing"||e.startsWith("Processing")||e.startsWith("Analyzing")):!1}function Zc(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length<=1?"":n.pop().toLowerCase()}function YH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function QH(t){if(!t)return!0;const e=t.trim().toLowerCase();if(!e||e==="file"||e==="download")return!0;const n=e.replace(/\.[^.]+$/,"");return!!(n==="tmp"||n==="temp"||/^[a-f0-9-]{16,}$/.test(n)||/^file[-_]?\d+$/.test(n)||/^(tmp|temp)/.test(n)||/^upload[-_]?.+$/.test(n))}function XH(t,e,n){const s=(t==null?void 0:t.pdf_filename)||"",r=s||(t==null?void 0:t.filename)||(t==null?void 0:t.title)||"",i=YH(e),o=(t==null?void 0:t.file_id)||(t==null?void 0:t.id)||e||r;let a=r||i||"";const l=Zc(a)||Zc(i)||Zc(e);if(s){const u=Zc(a)||"pdf";return a.toLowerCase().endsWith(`.${u}`)||(a=`${a}.${u}`),o&&n&&n.set(o,a),a}return QH(a)?l==="pdf"?a="Review.pdf":l?a=`Attachment.${l}`:a="Attachment":l&&!a.toLowerCase().endsWith(`.${l}`)&&(a=`${a}.${l}`),o&&n&&n.set(o,a),a||(l?`Attachment.${l}`:"Attachment")}async function Uh(t,e){try{const n=gc(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{const n=document.createElement("a");n.href=t,n.download=e,n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),n.remove()}}function z_(){return{id:crypto.randomUUID(),role:"assistant",content:`Good ${JH()}, ready for a video critique?`,files:[],status:null}}function JH(){const t=new Date().getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function By(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function $c(t){return t?By(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">[Image: $1]</a>').replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/___(.+?)___/g,"<strong><em>$1</em></strong>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(?!INLINE_CODE_|CODE_BLOCK_)(.+?)__/g,"<strong>$1</strong>").replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>").replace(new RegExp("(?<!\\w)_(?!_)(.+?)(?<!_)_(?!\\w)","g"),"<em>$1</em>").replace(/~~(.+?)~~/g,"<del>$1</del>").replace(/==(.+?)==/g,'<mark class="chat-highlight">$1</mark>'):""}function ZH(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(d,h,f)=>{const p=e.length;return e.push({lang:h||"",code:f.trim()}),`__CODE_BLOCK_${p}__`});const s=[];n=n.replace(/`([^`]+)`/g,(d,h)=>{const f=s.length;return s.push(h),`__INLINE_CODE_${f}__`});const r=n.split(`
`);let i=[],o=!1,a=!1,l=!1;for(let d=0;d<r.length;d++){let h=r[d];const f=h.match(/^__CODE_BLOCK_(\d+)__$/);if(f){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=e[parseInt(f[1],10)],m=g.lang?` class="language-${g.lang}"`:"";i.push(`<pre class="chat-code-block"><code${m}>${By(g.code)}</code></pre>`);continue}const p=h.match(/^(#{1,6})\s+(.*)$/);if(p){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=p[1].length,m=$c(p[2]);i.push(`<h${g} class="chat-header chat-h${g}">${m}</h${g}>`);continue}if(/^[-*_]{3,}\s*$/.test(h)){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1),i.push('<hr class="chat-hr">');continue}const w=h.match(/^>\s*(.*)$/);if(w){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l||(i.push('<blockquote class="chat-blockquote">'),l=!0),i.push($c(w[1])+"<br>");continue}else l&&(i.push("</blockquote>"),l=!1);const x=h.match(/^(\s*)([-*])\s+(.*)$/);if(x){a&&(i.push("</ol>"),a=!1),o||(i.push('<ul class="chat-list">'),o=!0);const g=$c(x[3]);i.push(`<li>${g}</li>`);continue}else o&&(i.push("</ul>"),o=!1);const y=h.match(/^(\s*)(\d+)\.\s+(.*)$/);if(y){o&&(i.push("</ul>"),o=!1),a||(i.push('<ol class="chat-numbered-list">'),a=!0);const g=$c(y[3]);i.push(`<li>${g}</li>`);continue}else a&&(i.push("</ol>"),a=!1);if(h.trim()===""){i.push("<br>");continue}i.push($c(h)),d<r.length-1&&i.push("<br>")}o&&i.push("</ul>"),a&&i.push("</ol>"),l&&i.push("</blockquote>");let u=i.join("");return s.forEach((d,h)=>{u=u.replace(`__INLINE_CODE_${h}__`,`<code class="chat-inline-code">${By(d)}</code>`)}),u}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Wd(t){return t+.5|0}const Yi=(t,e,n)=>Math.max(Math.min(t,n),e);function eu(t){return Yi(Wd(t*2.55),0,255)}function co(t){return Yi(Wd(t*255),0,255)}function Jr(t){return Yi(Wd(t/2.55)/100,0,1)}function B_(t){return Yi(Wd(t*100),0,100)}const Os={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Uy=[..."0123456789ABCDEF"],e8=t=>Uy[t&15],t8=t=>Uy[(t&240)>>4]+Uy[t&15],Hh=t=>(t&240)>>4===(t&15),n8=t=>Hh(t.r)&&Hh(t.g)&&Hh(t.b)&&Hh(t.a);function s8(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Os[t[1]]*17,g:255&Os[t[2]]*17,b:255&Os[t[3]]*17,a:e===5?Os[t[4]]*17:255}:(e===7||e===9)&&(n={r:Os[t[1]]<<4|Os[t[2]],g:Os[t[3]]<<4|Os[t[4]],b:Os[t[5]]<<4|Os[t[6]],a:e===9?Os[t[7]]<<4|Os[t[8]]:255})),n}const r8=(t,e)=>t<255?e(t):"";function i8(t){var e=n8(t)?e8:t8;return t?"#"+e(t.r)+e(t.g)+e(t.b)+r8(t.a,e):void 0}const o8=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function uT(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function a8(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function l8(t,e,n){const s=uT(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function c8(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function V0(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,u,d;return i!==o&&(d=i-o,u=a>.5?d/(2-i-o):d/(i+o),l=c8(n,s,r,d,i),l=l*60+.5),[l|0,u||0,a]}function q0(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(co)}function K0(t,e,n){return q0(uT,t,e,n)}function u8(t,e,n){return q0(l8,t,e,n)}function d8(t,e,n){return q0(a8,t,e,n)}function dT(t){return(t%360+360)%360}function h8(t){const e=o8.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?eu(+e[5]):co(+e[5]));const r=dT(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=u8(r,i,o):e[1]==="hsv"?s=d8(r,i,o):s=K0(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function f8(t,e){var n=V0(t);n[0]=dT(n[0]+e),n=K0(n),t.r=n[0],t.g=n[1],t.b=n[2]}function p8(t){if(!t)return;const e=V0(t),n=e[0],s=B_(e[1]),r=B_(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Jr(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const U_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},H_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function m8(){const t={},e=Object.keys(H_),n=Object.keys(U_);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,U_[i]);i=parseInt(H_[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Wh;function g8(t){Wh||(Wh=m8(),Wh.transparent=[0,0,0,0]);const e=Wh[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const x8=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function y8(t){const e=x8.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?eu(o):Yi(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?eu(s):Yi(s,0,255)),r=255&(e[4]?eu(r):Yi(r,0,255)),i=255&(e[6]?eu(i):Yi(i,0,255)),{r:s,g:r,b:i,a:n}}}function v8(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Jr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Ig=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,tl=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function b8(t,e,n){const s=tl(Jr(t.r)),r=tl(Jr(t.g)),i=tl(Jr(t.b));return{r:co(Ig(s+n*(tl(Jr(e.r))-s))),g:co(Ig(r+n*(tl(Jr(e.g))-r))),b:co(Ig(i+n*(tl(Jr(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Vh(t,e,n){if(t){let s=V0(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=K0(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function hT(t,e){return t&&Object.assign(e||{},t)}function W_(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=co(t[3]))):(e=hT(t,{r:0,g:0,b:0,a:1}),e.a=co(e.a)),e}function w8(t){return t.charAt(0)==="r"?y8(t):h8(t)}class ld{constructor(e){if(e instanceof ld)return e;const n=typeof e;let s;n==="object"?s=W_(e):n==="string"&&(s=s8(e)||g8(e)||w8(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=hT(this._rgb);return e&&(e.a=Jr(e.a)),e}set rgb(e){this._rgb=W_(e)}rgbString(){return this._valid?v8(this._rgb):void 0}hexString(){return this._valid?i8(this._rgb):void 0}hslString(){return this._valid?p8(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,u=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-u,s.r=255&u*s.r+i*r.r+.5,s.g=255&u*s.g+i*r.g+.5,s.b=255&u*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=b8(this._rgb,e._rgb,n)),this}clone(){return new ld(this.rgb)}alpha(e){return this._rgb.a=co(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Wd(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Vh(this._rgb,2,e),this}darken(e){return Vh(this._rgb,2,-e),this}saturate(e){return Vh(this._rgb,1,e),this}desaturate(e){return Vh(this._rgb,1,-e),this}rotate(e){return f8(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Vr(){}const k8=(()=>{let t=0;return()=>t++})();function wt(t){return t==null}function pn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function rt(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Ks(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function _r(t,e){return Ks(t)?t:e}function nt(t,e){return typeof t>"u"?e:t}const _8=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,fT=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Et(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function gt(t,e,n,s){let r,i,o;if(pn(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(rt(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function bp(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function wp(t){if(pn(t))return t.map(wp);if(rt(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=wp(t[n[r]]);return e}return t}function pT(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function S8(t,e,n,s){if(!pT(t))return;const r=e[t],i=n[t];rt(r)&&rt(i)?cd(r,i,s):e[t]=wp(i)}function cd(t,e,n){const s=pn(e)?e:[e],r=s.length;if(!rt(t))return t;n=n||{};const i=n.merger||S8;let o;for(let a=0;a<r;++a){if(o=s[a],!rt(o))continue;const l=Object.keys(o);for(let u=0,d=l.length;u<d;++u)i(l[u],t,o,n)}return t}function xu(t,e){return cd(t,e,{merger:j8})}function j8(t,e,n){if(!pT(t))return;const s=e[t],r=n[t];rt(s)&&rt(r)?xu(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=wp(r))}const V_={"":t=>t,x:t=>t.x,y:t=>t.y};function C8(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function N8(t){const e=C8(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function Ea(t,e){return(V_[e]||(V_[e]=N8(e)))(t)}function G0(t){return t.charAt(0).toUpperCase()+t.slice(1)}const ud=t=>typeof t<"u",vo=t=>typeof t=="function",q_=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function E8(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Tt=Math.PI,sn=2*Tt,kp=Number.POSITIVE_INFINITY,T8=Tt/180,un=Tt/2,Fo=Tt/4,K_=Tt*2/3,mT=Math.log10,uo=Math.sign;function Nf(t,e,n){return Math.abs(t-e)<n}function G_(t){const e=Math.round(t);t=Nf(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(mT(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function P8(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function R8(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function _p(t){return!R8(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function A8(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function O8(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function oi(t){return t*(Tt/180)}function M8(t){return t*(180/Tt)}function Y_(t){if(!Ks(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function gT(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*Tt&&(i+=sn),{angle:i,distance:r}}function I8(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Nr(t){return(t%sn+sn)%sn}function Sp(t,e,n,s){const r=Nr(t),i=Nr(e),o=Nr(n),a=Nr(i-r),l=Nr(o-r),u=Nr(r-i),d=Nr(r-o);return r===i||r===o||s&&i===o||a>l&&u<d}function rs(t,e,n){return Math.max(e,Math.min(n,t))}function D8(t){return rs(t,-32768,32767)}function ta(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function Y0(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Hy=(t,e,n,s)=>Y0(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),L8=(t,e,n)=>Y0(t,n,s=>t[s][e]>=n);function $8(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const xT=["push","pop","shift","splice","unshift"];function F8(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),xT.forEach(n=>{const s="_onData"+G0(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function Q_(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(xT.forEach(i=>{delete t[i]}),delete t._chartjs)}function yT(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const vT=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function bT(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,vT.call(window,()=>{s=!1,t.apply(e,n)}))}}function z8(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const wT=t=>t==="start"?"left":t==="end"?"right":"center",xs=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,B8=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,qh=t=>t===0||t===1,X_=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*sn/n)),J_=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*sn/n)+1,yu={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*un)+1,easeOutSine:t=>Math.sin(t*un),easeInOutSine:t=>-.5*(Math.cos(Tt*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>qh(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>qh(t)?t:X_(t,.075,.3),easeOutElastic:t=>qh(t)?t:J_(t,.075,.3),easeInOutElastic(t){return qh(t)?t:t<.5?.5*X_(t*2,.1125,.45):.5+.5*J_(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-yu.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?yu.easeInBounce(t*2)*.5:yu.easeOutBounce(t*2-1)*.5+.5};function kT(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Z_(t){return kT(t)?t:new ld(t)}function Dg(t){return kT(t)?t:new ld(t).saturate(.5).darken(.1).hexString()}const U8=["x","y","borderWidth","radius","tension"],H8=["color","borderColor","backgroundColor"];function W8(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:H8},numbers:{type:"number",properties:U8}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function V8(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const eS=new Map;function q8(t,e){e=e||{};const n=t+JSON.stringify(e);let s=eS.get(n);return s||(s=new Intl.NumberFormat(t,e),eS.set(n,s)),s}function Q0(t,e,n){return q8(e,n).format(t)}const K8={values(t){return pn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),i=G8(t,n)}const o=mT(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Q0(t,s,l)}};function G8(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var _T={formatters:K8};function Y8(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:_T.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ta=Object.create(null),Wy=Object.create(null);function vu(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function Lg(t,e,n){return typeof e=="string"?cd(vu(t,e),n):cd(vu(t,""),e)}class Q8{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Dg(r.backgroundColor),this.hoverBorderColor=(s,r)=>Dg(r.borderColor),this.hoverColor=(s,r)=>Dg(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Lg(this,e,n)}get(e){return vu(this,e)}describe(e,n){return Lg(Wy,e,n)}override(e,n){return Lg(Ta,e,n)}route(e,n,s,r){const i=vu(this,e),o=vu(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],u=o[r];return rt(l)?Object.assign({},u,l):nt(l,u)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Zt=new Q8({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[W8,V8,Y8]);function X8(t){return!t||wt(t.size)||wt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function tS(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function zo(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function nS(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function sS(t,e,n,s){ST(t,e,n,s,null)}function ST(t,e,n,s,r){let i,o,a,l,u,d,h,f;const p=e.pointStyle,w=e.rotation,x=e.radius;let y=(w||0)*T8;if(p&&typeof p=="object"&&(i=p.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(y),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(x)||x<=0)){switch(t.beginPath(),p){default:r?t.ellipse(n,s,r/2,x,0,0,sn):t.arc(n,s,x,0,sn),t.closePath();break;case"triangle":d=r?r/2:x,t.moveTo(n+Math.sin(y)*d,s-Math.cos(y)*x),y+=K_,t.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*x),y+=K_,t.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*x),t.closePath();break;case"rectRounded":u=x*.516,l=x-u,o=Math.cos(y+Fo)*l,h=Math.cos(y+Fo)*(r?r/2-u:l),a=Math.sin(y+Fo)*l,f=Math.sin(y+Fo)*(r?r/2-u:l),t.arc(n-h,s-a,u,y-Tt,y-un),t.arc(n+f,s-o,u,y-un,y),t.arc(n+h,s+a,u,y,y+un),t.arc(n-f,s+o,u,y+un,y+Tt),t.closePath();break;case"rect":if(!w){l=Math.SQRT1_2*x,d=r?r/2:l,t.rect(n-d,s-l,2*d,2*l);break}y+=Fo;case"rectRot":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+f,s-o),t.lineTo(n+h,s+a),t.lineTo(n-f,s+o),t.closePath();break;case"crossRot":y+=Fo;case"cross":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"star":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o),y+=Fo,h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"line":o=r?r/2:Math.cos(y)*x,a=Math.sin(y)*x,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(y)*(r?r/2:x),s+Math.sin(y)*x);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function jT(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function X0(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function J0(t){t.restore()}function J8(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Z8(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,d=r.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,d),t.lineTo(a,d),t.stroke()}}function eW(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function jp(t,e,n,s,r,i={}){const o=pn(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,u;for(t.save(),t.font=r.string,J8(t,i),l=0;l<o.length;++l)u=o[l],i.backdrop&&eW(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),wt(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(u,n,s,i.maxWidth)),t.fillText(u,n,s,i.maxWidth),Z8(t,n,s,u,i),s+=Number(r.lineHeight);t.restore()}function Cp(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*Tt,Tt,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,Tt,un,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,un,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-un,!0),t.lineTo(n+o.topLeft,s)}const tW=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,nW=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function sW(t,e){const n=(""+t).match(tW);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const rW=t=>+t||0;function Z0(t,e){const n={},s=rt(e),r=s?Object.keys(e):e,i=rt(t)?s?o=>nt(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=rW(i(o));return n}function CT(t){return Z0(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Dl(t){return Z0(t,["topLeft","topRight","bottomLeft","bottomRight"])}function xr(t){const e=CT(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function is(t,e){t=t||{},e=e||Zt.font;let n=nt(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=nt(t.style,e.style);s&&!(""+s).match(nW)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:nt(t.family,e.family),lineHeight:sW(nt(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:nt(t.weight,e.weight),string:""};return r.string=X8(r),r}function Kh(t,e,n,s){let r,i,o;for(r=0,i=t.length;r<i;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function iW(t,e,n){const{min:s,max:r}=t,i=fT(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function kc(t,e){return Object.assign(Object.create(t),e)}function eb(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=PT("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>eb([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return ET(a,l,()=>fW(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return iS(a).includes(l)},ownKeys(a){return iS(a)},set(a,l,u){const d=a._storage||(a._storage=r());return a[l]=d[l]=u,delete a._keys,!0}})}function lc(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:NT(t,s),setContext:i=>lc(t,i,n,s),override:i=>lc(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return ET(i,o,()=>aW(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function NT(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:vo(n)?n:()=>n,isIndexable:vo(s)?s:()=>s}}const oW=(t,e)=>t?t+G0(e):e,tb=(t,e)=>rt(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function ET(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function aW(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return vo(a)&&o.isScriptable(e)&&(a=lW(e,a,t,n)),pn(a)&&a.length&&(a=cW(e,a,t,o.isIndexable)),tb(e,a)&&(a=lc(a,r,i&&i[e],o)),a}function lW(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),tb(t,l)&&(l=nb(r._scopes,r,t,l)),l}function cW(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(rt(e[0])){const l=e,u=r._scopes.filter(d=>d!==l);e=[];for(const d of l){const h=nb(u,r,t,d);e.push(lc(h,i,o&&o[t],a))}}return e}function TT(t,e,n){return vo(t)?t(e,n):t}const uW=(t,e)=>t===!0?e:typeof t=="string"?Ea(e,t):void 0;function dW(t,e,n,s,r){for(const i of e){const o=uW(n,i);if(o){t.add(o);const a=TT(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function nb(t,e,n,s){const r=e._rootScopes,i=TT(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=rS(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=rS(a,o,i,l,s),l===null)?!1:eb(Array.from(a),[""],r,i,()=>hW(e,n,s))}function rS(t,e,n,s,r){for(;n;)n=dW(t,e,n,s,r);return n}function hW(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return pn(r)&&rt(n)?n:r||{}}function fW(t,e,n,s){let r;for(const i of e)if(r=PT(oW(i,t),n),typeof r<"u")return tb(t,r)?nb(n,s,t,r):r}function PT(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function iS(t){let e=t._keys;return e||(e=t._keys=pW(t._scopes)),e}function pW(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function sb(){return typeof window<"u"&&typeof document<"u"}function rb(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Np(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const hm=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function mW(t,e){return hm(t).getPropertyValue(e)}const gW=["top","right","bottom","left"];function xa(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=gW[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const xW=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function yW(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(xW(r,i,t.target))a=r,l=i;else{const u=e.getBoundingClientRect();a=s.clientX-u.left,l=s.clientY-u.top,o=!0}return{x:a,y:l,box:o}}function qo(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=hm(n),i=r.boxSizing==="border-box",o=xa(r,"padding"),a=xa(r,"border","width"),{x:l,y:u,box:d}=yW(t,n),h=o.left+(d&&a.left),f=o.top+(d&&a.top);let{width:p,height:w}=e;return i&&(p-=o.width+a.width,w-=o.height+a.height),{x:Math.round((l-h)/p*n.width/s),y:Math.round((u-f)/w*n.height/s)}}function vW(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&rb(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=hm(i),l=xa(a,"border","width"),u=xa(a,"padding");e=o.width-u.width-l.width,n=o.height-u.height-l.height,s=Np(a.maxWidth,i,"clientWidth"),r=Np(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||kp,maxHeight:r||kp}}const Qi=t=>Math.round(t*10)/10;function bW(t,e,n,s){const r=hm(t),i=xa(r,"margin"),o=Np(r.maxWidth,t,"clientWidth")||kp,a=Np(r.maxHeight,t,"clientHeight")||kp,l=vW(t,e,n);let{width:u,height:d}=l;if(r.boxSizing==="content-box"){const f=xa(r,"border","width"),p=xa(r,"padding");u-=p.width+f.width,d-=p.height+f.height}return u=Math.max(0,u-i.width),d=Math.max(0,s?u/s:d-i.height),u=Qi(Math.min(u,o,l.maxWidth)),d=Qi(Math.min(d,a,l.maxHeight)),u&&!d&&(d=Qi(u/2)),(e!==void 0||n!==void 0)&&s&&l.height&&d>l.height&&(d=l.height,u=Qi(Math.floor(d*s))),{width:u,height:d}}function oS(t,e,n){const s=e||1,r=Qi(t.height*s),i=Qi(t.width*s);t.height=Qi(t.height),t.width=Qi(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const wW=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};sb()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function aS(t,e){const n=mW(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const kW=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},_W=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Ll(t,e,n){return t?kW(e,n):_W()}function RT(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function AT(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Gh(t,e,n){return t.options.clip?t[n]:e[n]}function SW(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Gh(n,e,"left"),right:Gh(n,e,"right"),top:Gh(s,e,"top"),bottom:Gh(s,e,"bottom")}:e}function jW(t,e){const n=e._clip;if(n.disabled)return!1;const s=SW(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class CW{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=vT.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Kr=new CW;const lS="transparent",NW={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=Z_(t||lS),r=s.valid&&Z_(e||lS);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class EW{constructor(e,n,s,r){const i=n[s];r=Kh([e.to,r,i,e.from]);const o=Kh([e.from,i,r]);this._active=!0,this._fn=e.fn||NW[e.type||typeof o],this._easing=yu[e.easing]||yu.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Kh([e.to,n,r,e.from]),this._from=Kh([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class OT{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!rt(e))return;const n=Object.keys(Zt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!rt(i))return;const o={};for(const a of n)o[a]=i[a];(pn(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=PW(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&TW(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const u=o[l];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,n));continue}const d=n[u];let h=i[u];const f=s.get(u);if(h)if(f&&h.active()){h.update(f,d,a);continue}else h.cancel();if(!f||!f.duration){e[u]=d;continue}i[u]=h=new EW(f,e,u,d),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Kr.add(this._chart,s),!0}}function TW(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function PW(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function cS(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function RW(t,e,n){if(n===!1)return!1;const s=cS(t,n),r=cS(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function AW(t){let e,n,s,r;return rt(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function MT(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function uS(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,u;if(e===null)return;let d=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(d=!0,s.all)continue;break}u=t.values[l],Ks(u)&&(i||e===0||uo(e)===uo(u))&&(e+=u)}return!d&&!s.all?0:e}function OW(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,u,d;for(l=0,u=o.length;l<u;++l)d=o[l],a[l]={[r]:d,[i]:t[d]};return a}function $g(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function MW(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function IW(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function DW(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function dS(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function hS(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,u=o.axis,d=MW(i,o,s),h=e.length;let f;for(let p=0;p<h;++p){const w=e[p],{[l]:x,[u]:y}=w,g=w._stacks||(w._stacks={});f=g[u]=DW(r,d,x),f[a]=y,f._top=dS(f,o,!0,s.type),f._bottom=dS(f,o,!1,s.type);const m=f._visualValues||(f._visualValues={});m[a]=y}}function Fg(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function LW(t,e){return kc(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function $W(t,e,n){return kc(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Fc(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const zg=t=>t==="reset"||t==="none",fS=(t,e)=>e?t:Object.assign({},t),FW=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:MT(n,!0),values:null};class $l{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=$g(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Fc(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,f,p,w)=>h==="x"?f:h==="r"?w:p,i=n.xAxisID=nt(s.xAxisID,Fg(e,"x")),o=n.yAxisID=nt(s.yAxisID,Fg(e,"y")),a=n.rAxisID=nt(s.rAxisID,Fg(e,"r")),l=n.indexAxis,u=n.iAxisID=r(l,i,o,a),d=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Q_(this._data,this),e._stacked&&Fc(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(rt(n)){const r=this._cachedMeta;this._data=OW(n,r)}else if(s!==n){if(s){Q_(s,this);const r=this._cachedMeta;Fc(r),r._parsed=[]}n&&Object.isExtensible(n)&&F8(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=$g(n.vScale,n),n.stack!==s.stack&&(r=!0,Fc(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(hS(this,n._parsed),n._stacked=$g(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,u=e>0&&s._parsed[e-1],d,h,f;if(this._parsing===!1)s._parsed=r,s._sorted=!0,f=r;else{pn(r[e])?f=this.parseArrayData(s,r,e,n):rt(r[e])?f=this.parseObjectData(s,r,e,n):f=this.parsePrimitiveData(s,r,e,n);const p=()=>h[a]===null||u&&h[a]<u[a];for(d=0;d<n;++d)s._parsed[d+e]=h=f[d],l&&(p()&&(l=!1),u=h);s._sorted=l}o&&hS(this,f)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,u=i.getLabels(),d=i===o,h=new Array(r);let f,p,w;for(f=0,p=r;f<p;++f)w=f+s,h[f]={[a]:d||i.parse(u[w],w),[l]:o.parse(n[w],w)};return h}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,u,d,h;for(l=0,u=r;l<u;++l)d=l+s,h=n[d],a[l]={x:i.parse(h[0],d),y:o.parse(h[1],d)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=new Array(r);let d,h,f,p;for(d=0,h=r;d<h;++d)f=d+s,p=n[f],u[d]={x:i.parse(Ea(p,a),f),y:o.parse(Ea(p,l),f)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:MT(r,!0),values:n._stacks[e.axis]._visualValues};return uS(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=uS(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=FW(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=IW(a);let f,p;function w(){p=r[f];const x=p[a.axis];return!Ks(p[e.axis])||d>x||h<x}for(f=0;f<o&&!(!w()&&(this.updateRangeFromParsed(u,e,p,l),i));++f);if(i){for(f=o-1;f>=0;--f)if(!w()){this.updateRangeFromParsed(u,e,p,l);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],Ks(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=AW(nt(this.options.clip,RW(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(e,i,a,l),d=a;d<a+l;++d){const h=r[d];h.hidden||(h.active&&u?o.push(h):h.draw(e,i))}for(d=0;d<o.length;++d)o[d].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=$W(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=LW(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&ud(s);if(a)return fS(a,l);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],f=u.getOptionScopes(this.getDataset(),d),p=Object.keys(Zt.elements[e]),w=()=>this.getContext(s,r,n),x=u.resolveNamedOptions(f,p,w,h);return x.$shared&&(x.$shared=l,i[o]=Object.freeze(fS(x,l))),x}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,n),f=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(f,this.getContext(e,s,n))}const u=new OT(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||zg(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){zg(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!zg(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,u]of this._syncList)this[a](l,u);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=u=>{for(u.length+=n,a=u.length-1;a>=o;a--)u[a]=u[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Fc(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}$e($l,"defaults",{}),$e($l,"datasetElementType",null),$e($l,"dataElementType",null);function zW(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=yT(s.sort((r,i)=>r-i))}return t._cache.$bar}function BW(t){const e=t.iScale,n=zW(e,t.type);let s=e._length,r,i,o,a;const l=()=>{o===32767||o===-32768||(ud(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(r=0,i=n.length;r<i;++r)o=e.getPixelForValue(n[r]),l();for(a=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),l();return s}function UW(t,e,n,s){const r=n.barThickness;let i,o;return wt(r)?(i=e.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:e.pixels[t]-i/2}}function HW(t,e,n,s){const r=e.pixels,i=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const u=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:n.barPercentage,start:u}}function WW(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),o=Math.min(r,i),a=Math.max(r,i);let l=o,u=a;Math.abs(o)>Math.abs(a)&&(l=a,u=o),e[n.axis]=u,e._custom={barStart:l,barEnd:u,start:r,end:i,min:o,max:a}}function IT(t,e,n,s){return pn(t)?WW(t,e,n,s):e[n.axis]=n.parse(t,s),e}function pS(t,e,n,s){const r=t.iScale,i=t.vScale,o=r.getLabels(),a=r===i,l=[];let u,d,h,f;for(u=n,d=n+s;u<d;++u)f=e[u],h={},h[r.axis]=a||r.parse(o[u],u),l.push(IT(f,h,i,u));return l}function Bg(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function VW(t,e,n){return t!==0?uo(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function qW(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function KW(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:u,bottom:d}=qW(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(i[mS(d,o,a,l)]=!0,r=u)),i[mS(r,o,a,l)]=!0,t.borderSkipped=i}function mS(t,e,n,s){return s?(t=GW(t,e,n),t=gS(t,n,e)):t=gS(t,e,n),t}function GW(t,e,n){return t===e?n:t===n?e:t}function gS(t,e,n){return t==="start"?e:t==="end"?n:t}function YW(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class Ef extends $l{parsePrimitiveData(e,n,s,r){return pS(e,n,s,r)}parseArrayData(e,n,s,r){return pS(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=i.axis==="x"?a:l,d=o.axis==="x"?a:l,h=[];let f,p,w,x;for(f=s,p=s+r;f<p;++f)x=n[f],w={},w[i.axis]=i.parse(Ea(x,u),f),h.push(IT(Ea(x,d),w,o,f));return h}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),o=i._custom,a=Bg(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),u=a.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(n,r);for(let p=n;p<n+s;p++){const w=this.getParsed(p),x=i||wt(w[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),y=this._calculateBarIndexPixels(p,d),g=(w._stacks||{})[a.axis],m={horizontal:u,base:x.base,enableBorderRadius:!g||Bg(w._custom)||o===g._top||o===g._bottom,x:u?x.head:y.center,y:u?y.center:x.head,height:u?y.size:Math.abs(x.size),width:u?Math.abs(x.size):y.size};f&&(m.options=h||this.resolveDataElementOptions(p,e[p].active?"active":r));const b=m.options||e[p].options;KW(m,b,g,o),YW(m,b,d.ratio),this.updateElement(e[p],p,m,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],u=d=>{const h=d._parsed.find(p=>p[s.axis]===l),f=h&&h[d.vScale.axis];if(wt(f)||isNaN(f))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((i===!1||o.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[nt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const a=e.barThickness;return{min:a||BW(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),u=l._custom,d=Bg(u);let h=l[n.axis],f=0,p=s?this.applyStack(n,l,s):h,w,x;p!==h&&(f=p-h,p=h),d&&(h=u.barStart,p=u.barEnd-u.barStart,h!==0&&uo(h)!==uo(u.barEnd)&&(f=0),f+=h);const y=!wt(i)&&!d?i:f;let g=n.getPixelForValue(y);if(this.chart.getDataVisibility(e)?w=n.getPixelForValue(f+p):w=g,x=w-g,Math.abs(x)<o){x=VW(x,n,a)*o,h===a&&(g-=x/2);const m=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),k=Math.min(m,b),_=Math.max(m,b);g=Math.max(Math.min(g,_),k),w=g+x,s&&!d&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(w)-n.getValueForPixel(g))}if(g===n.getPixelForValue(a)){const m=uo(x)*n.getLineWidthForValue(a)/2;g+=m,x-=m}return{size:x,base:g,head:w,center:w+x/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,o=nt(r.maxBarThickness,1/0);let a,l;const u=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(e):n.stackCount,h=r.barThickness==="flex"?HW(e,n,r,d*u):UW(e,n,r,d*u),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(nt(f,this.getFirstScaleIdForIndexAxis())),w=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+p;a=h.start+h.chunk*w+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}$e(Ef,"id","bar"),$e(Ef,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),$e(Ef,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function QW(t,e,n){let s=1,r=1,i=0,o=0;if(e<sn){const a=t,l=a+e,u=Math.cos(a),d=Math.sin(a),h=Math.cos(l),f=Math.sin(l),p=(b,k,_)=>Sp(b,a,l,!0)?1:Math.max(k,k*n,_,_*n),w=(b,k,_)=>Sp(b,a,l,!0)?-1:Math.min(k,k*n,_,_*n),x=p(0,u,h),y=p(un,d,f),g=w(Tt,u,h),m=w(Tt+un,d,f);s=(x-g)/2,r=(y-m)/2,i=-(x+g)/2,o=-(y+m)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class kl extends $l{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(rt(s[e])){const{key:l="value"}=this._parsing;i=u=>+Ea(s[u],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return oi(this.options.rotation-90)}_getCircumference(){return oi(this.options.circumference)}_getRotationExtents(){let e=sn,n=-sn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(_8(this.options.cutout,a),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:w,offsetY:x}=QW(h,d,l),y=(s.width-o)/f,g=(s.height-o)/p,m=Math.max(Math.min(y,g)/2,0),b=fT(this.options.radius,m),k=Math.max(b*l,0),_=(b-k)/this._getVisibleDatasetWeightTotal();this.offsetX=w*b,this.offsetY=x*b,r.total=this.calculateTotal(),this.outerRadius=b-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*u,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/sn)}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,u=o.options.animation,d=(a.left+a.right)/2,h=(a.top+a.bottom)/2,f=i&&u.animateScale,p=f?0:this.innerRadius,w=f?0:this.outerRadius,{sharedOptions:x,includeOptions:y}=this._getSharedOptions(n,r);let g=this._getRotation(),m;for(m=0;m<n;++m)g+=this._circumference(m,i);for(m=n;m<n+s;++m){const b=this._circumference(m,i),k=e[m],_={x:d+this.offsetX,y:h+this.offsetY,startAngle:g,endAngle:g+b,circumference:b,outerRadius:w,innerRadius:p};y&&(_.options=x||this.resolveDataElementOptions(m,k.active?"active":r)),g+=b,this.updateElement(k,m,_,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?sn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=Q0(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,o,a,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(nt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}$e(kl,"id","doughnut"),$e(kl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),$e(kl,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),$e(kl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((l,u)=>{const h=e.getDatasetMeta(0).controller.getStyle(u);return{text:l,fillStyle:h.backgroundColor,fontColor:i,hidden:!e.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(a||h.borderRadius),index:u}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class Vy extends kl{}$e(Vy,"id","pie"),$e(Vy,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Bo(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class ib{constructor(e){$e(this,"options");this.options=e||{}}static override(e){Object.assign(ib.prototype,e)}init(){}formats(){return Bo()}parse(){return Bo()}format(){return Bo()}add(){return Bo()}diff(){return Bo()}startOf(){return Bo()}endOf(){return Bo()}}var XW={_date:ib};function JW(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const u=a._reversePixels?L8:Hy;if(s){if(r._sharedOptions){const d=i[0],h=typeof d.getRange=="function"&&d.getRange(e);if(h){const f=u(i,e,n-h),p=u(i,e,n+h);return{lo:f.lo,hi:p.hi}}}}else{const d=u(i,e,n);if(l){const{vScale:h}=r._cachedMeta,{_parsed:f}=t,p=f.slice(0,d.lo+1).reverse().findIndex(x=>!wt(x[h.axis]));d.lo-=Math.max(0,p);const w=f.slice(d.hi).findIndex(x=>!wt(x[h.axis]));d.hi+=Math.max(0,w)}return d}}return{lo:0,hi:i.length-1}}function fm(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:u,data:d}=i[a],{lo:h,hi:f}=JW(i[a],e,o,r);for(let p=h;p<=f;++p){const w=d[p];w.skip||s(w,u,p)}}}function ZW(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Ug(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||fm(t,n,e,function(a,l,u){!r&&!jT(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:u})},!0),i}function eV(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],s),{angle:h}=gT(o,{x:e.x,y:e.y});Sp(h,u,d)&&r.push({element:o,datasetIndex:a,index:l})}return fm(t,n,e,i),r}function tV(t,e,n,s,r,i){let o=[];const a=ZW(n);let l=Number.POSITIVE_INFINITY;function u(d,h,f){const p=d.inRange(e.x,e.y,r);if(s&&!p)return;const w=d.getCenterPoint(r);if(!(!!i||t.isPointInArea(w))&&!p)return;const y=a(e,w);y<l?(o=[{element:d,datasetIndex:h,index:f}],l=y):y===l&&o.push({element:d,datasetIndex:h,index:f})}return fm(t,n,e,u),o}function Hg(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?eV(t,e,n,r):tV(t,e,n,s,r,i)}function xS(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return fm(t,n,e,(l,u,d)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:u,index:d}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var nV={modes:{index(t,e,n,s){const r=qo(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?Ug(t,r,i,s,o):Hg(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const d=a[0].index,h=u.data[d];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:d})}),l):[]},dataset(t,e,n,s){const r=qo(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?Ug(t,r,i,s,o):Hg(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,u=t.getDatasetMeta(l).data;a=[];for(let d=0;d<u.length;++d)a.push({element:u[d],datasetIndex:l,index:d})}return a},point(t,e,n,s){const r=qo(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Ug(t,r,i,s,o)},nearest(t,e,n,s){const r=qo(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Hg(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=qo(e,t);return xS(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=qo(e,t);return xS(t,r,"y",n.intersect,s)}}};const DT=["left","top","right","bottom"];function zc(t,e){return t.filter(n=>n.pos===e)}function yS(t,e){return t.filter(n=>DT.indexOf(n.pos)===-1&&n.box.axis===e)}function Bc(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function sV(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function rV(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!DT.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function iV(t,e){const n=rV(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,u=n[a.stack],d=u&&a.stackWeight/u.weight;a.horizontal?(a.width=d?d*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=d?d*r:l&&e.availableHeight)}return n}function oV(t){const e=sV(t),n=Bc(e.filter(u=>u.box.fullSize),!0),s=Bc(zc(e,"left"),!0),r=Bc(zc(e,"right")),i=Bc(zc(e,"top"),!0),o=Bc(zc(e,"bottom")),a=yS(e,"x"),l=yS(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:zc(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function vS(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function LT(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function aV(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!rt(r)){n.size&&(t[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,t[r]+=n.size}i.getPadding&&LT(o,i.getPadding());const a=Math.max(0,e.outerWidth-vS(o,t,"left","right")),l=Math.max(0,e.outerHeight-vS(o,t,"top","bottom")),u=a!==t.w,d=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:u,other:d}:{same:d,other:u}}function lV(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function cV(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function tu(t,e,n,s){const r=[];let i,o,a,l,u,d;for(i=0,o=t.length,u=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,cV(a.horizontal,e));const{same:h,other:f}=aV(e,n,a,s);u|=h&&r.length,d=d||f,l.fullSize||r.push(a)}return u&&tu(r,e,n,s)||d}function Yh(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function bS(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,u=s[a.stack]||{placed:0,weight:1},d=a.stackWeight/u.weight||1;if(a.horizontal){const h=e.w*d,f=u.size||l.height;ud(u.start)&&(o=u.start),l.fullSize?Yh(l,r.left,o,n.outerWidth-r.right-r.left,f):Yh(l,e.left+u.placed,o,h,f),u.start=o,u.placed+=h,o=l.bottom}else{const h=e.h*d,f=u.size||l.width;ud(u.start)&&(i=u.start),l.fullSize?Yh(l,i,r.top,f,n.outerHeight-r.bottom-r.top):Yh(l,i,e.top+u.placed,f,h),u.start=i,u.placed+=h,i=l.right}}e.x=i,e.y=o}var Xi={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=xr(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=oV(t.boxes),l=a.vertical,u=a.horizontal;gt(t.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const d=l.reduce((x,y)=>y.box.options&&y.box.options.display===!1?x:x+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/d,hBoxMaxHeight:o/2}),f=Object.assign({},r);LT(f,xr(s));const p=Object.assign({maxPadding:f,w:i,h:o,x:r.left,y:r.top},r),w=iV(l.concat(u),h);tu(a.fullSize,p,h,w),tu(l,p,h,w),tu(u,p,h,w)&&tu(l,p,h,w),lV(p),bS(a.leftAndTop,p,h,w),p.x+=p.w,p.y+=p.h,bS(a.rightAndBottom,p,h,w),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},gt(a.chartArea,x=>{const y=x.box;Object.assign(y,t.chartArea),y.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class $T{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class uV extends $T{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Tf="$chartjs",dV={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},wS=t=>t===null||t==="";function hV(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Tf]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",wS(r)){const i=aS(t,"width");i!==void 0&&(t.width=i)}if(wS(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=aS(t,"height");i!==void 0&&(t.height=i)}return t}const FT=wW?{passive:!0}:!1;function fV(t,e,n){t&&t.addEventListener(e,n,FT)}function pV(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,FT)}function mV(t,e){const n=dV[t.type]||t.type,{x:s,y:r}=qo(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function Ep(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function gV(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Ep(a.addedNodes,s),o=o&&!Ep(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function xV(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Ep(a.removedNodes,s),o=o&&!Ep(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const dd=new Map;let kS=0;function zT(){const t=window.devicePixelRatio;t!==kS&&(kS=t,dd.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function yV(t,e){dd.size||window.addEventListener("resize",zT),dd.set(t,e)}function vV(t){dd.delete(t),dd.size||window.removeEventListener("resize",zT)}function bV(t,e,n){const s=t.canvas,r=s&&rb(s);if(!r)return;const i=bT((a,l)=>{const u=r.clientWidth;n(a,l),u<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],u=l.contentRect.width,d=l.contentRect.height;u===0&&d===0||i(u,d)});return o.observe(r),yV(t,i),o}function Wg(t,e,n){n&&n.disconnect(),e==="resize"&&vV(t)}function wV(t,e,n){const s=t.canvas,r=bT(i=>{t.ctx!==null&&n(mV(i,t))},t);return fV(s,e,r),r}class kV extends $T{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(hV(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Tf])return!1;const s=n[Tf].initial;["height","width"].forEach(i=>{const o=s[i];wt(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[Tf],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:gV,detach:xV,resize:bV}[n]||wV;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Wg,detach:Wg,resize:Wg}[n]||pV)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return bW(e,n,s,r)}isAttached(e){const n=e&&rb(e);return!!(n&&n.isConnected)}}function _V(t){return!sb()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?uV:kV}var sf;let _c=(sf=class{constructor(){$e(this,"x");$e(this,"y");$e(this,"active",!1);$e(this,"options");$e(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return _p(this.x)&&_p(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},$e(sf,"defaults",{}),$e(sf,"defaultRoutes"),sf);function SV(t,e){const n=t.options.ticks,s=jV(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?NV(e):[],o=i.length,a=i[0],l=i[o-1],u=[];if(o>r)return EV(e,u,i,o/r),u;const d=CV(i,e,r);if(o>0){let h,f;const p=o>1?Math.round((l-a)/(o-1)):null;for(Qh(e,u,d,wt(p)?0:a-p,a),h=0,f=o-1;h<f;h++)Qh(e,u,d,i[h],i[h+1]);return Qh(e,u,d,l,wt(p)?e.length:l+p),u}return Qh(e,u,d),u}function jV(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function CV(t,e,n){const s=TV(t),r=e.length/n;if(!s)return Math.max(r,1);const i=P8(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function NV(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function EV(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function Qh(t,e,n,s,r){const i=nt(s,0),o=Math.min(nt(r,t.length),t.length);let a=0,l,u,d;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),d=i;d<0;)a++,d=Math.round(i+a*n);for(u=Math.max(i,0);u<o;u++)u===d&&(e.push(t[u]),a++,d=Math.round(i+a*n))}function TV(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const PV=t=>t==="left"?"right":t==="right"?"left":t,_S=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,SS=(t,e)=>Math.min(e||t,t);function jS(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function RV(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(l-i,o-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(r-1))/2,l+=r<e?u:-u,l<i-a||l>o+a)))return l}function AV(t,e){gt(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function Uc(t){return t.drawTicks?t.tickLength:0}function CS(t,e){if(!t.display)return 0;const n=is(t.font,e),s=xr(t.padding);return(pn(t.text)?t.text.length:1)*n.lineHeight+s.height}function OV(t,e){return kc(t,{scale:e,type:"scale"})}function MV(t,e,n){return kc(t,{tick:n,index:e,type:"tick"})}function IV(t,e,n){let s=wT(t);return(n&&e!=="right"||!n&&e==="right")&&(s=PV(s)),s}function DV(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:u,scales:d}=l;let h=0,f,p,w;const x=o-r,y=a-i;if(t.isHorizontal()){if(p=xs(s,i,a),rt(n)){const g=Object.keys(n)[0],m=n[g];w=d[g].getPixelForValue(m)+x-e}else n==="center"?w=(u.bottom+u.top)/2+x-e:w=_S(t,n,e);f=a-i}else{if(rt(n)){const g=Object.keys(n)[0],m=n[g];p=d[g].getPixelForValue(m)-y+e}else n==="center"?p=(u.left+u.right)/2-y+e:p=_S(t,n,e);w=xs(s,o,r),h=n==="left"?-un:un}return{titleX:p,titleY:w,maxWidth:f,rotation:h}}class Sc extends _c{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=_r(e,Number.POSITIVE_INFINITY),n=_r(n,Number.NEGATIVE_INFINITY),s=_r(s,Number.POSITIVE_INFINITY),r=_r(r,Number.NEGATIVE_INFINITY),{min:_r(e,s),max:_r(n,r),minDefined:Ks(e),maxDefined:Ks(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,u=a.length;l<u;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:_r(n,_r(s,n)),max:_r(s,_r(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Et(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=iW(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?jS(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=SV(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Et(this.options.afterUpdate,[this])}beforeSetDimensions(){Et(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Et(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Et(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Et(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=Et(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){Et(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Et(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=SS(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,u;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,f=d.highest.height,p=rs(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/s:p/(s-1),h+6>a&&(a=p/(s-(e.offset?.5:1)),l=this.maxHeight-Uc(e.grid)-n.padding-CS(e.title,this.chart.options.font),u=Math.sqrt(h*h+f*f),o=M8(Math.min(Math.asin(rs((d.highest.height+6)/a,-1,1)),Math.asin(rs(l/u,-1,1))-Math.asin(rs(f/u,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Et(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Et(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=CS(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=Uc(i)+l):(e.height=this.maxHeight,e.width=Uc(i)+l),s.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:f}=this._getLabelSizes(),p=s.padding*2,w=oi(this.labelRotation),x=Math.cos(w),y=Math.sin(w);if(a){const g=s.mirror?0:y*h.width+x*f.height;e.height=Math.min(this.maxHeight,e.height+g+p)}else{const g=s.mirror?0:x*h.width+y*f.height;e.width=Math.min(this.maxWidth,e.width+g+p)}this._calculatePadding(u,d,y,x)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;l?u?(f=r*e.width,p=s*n.height):(f=s*e.height,p=r*n.width):i==="start"?p=n.width:i==="end"?f=e.width:i!=="inner"&&(f=e.width/2,p=n.width/2),this.paddingLeft=Math.max((f-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((p-h+o)*this.width/(this.width-h),0)}else{let d=n.height/2,h=e.height/2;i==="start"?(d=0,h=e.height):i==="end"&&(d=n.height,h=0),this.paddingTop=d+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Et(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)wt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=jS(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/SS(n,s));let u=0,d=0,h,f,p,w,x,y,g,m,b,k,_;for(h=0;h<n;h+=l){if(w=e[h].label,x=this._resolveTickFontOptions(h),r.font=y=x.string,g=i[y]=i[y]||{data:{},gc:[]},m=x.lineHeight,b=k=0,!wt(w)&&!pn(w))b=tS(r,g.data,g.gc,b,w),k=m;else if(pn(w))for(f=0,p=w.length;f<p;++f)_=w[f],!wt(_)&&!pn(_)&&(b=tS(r,g.data,g.gc,b,_),k+=m);o.push(b),a.push(k),u=Math.max(b,u),d=Math.max(k,d)}AV(i,n);const C=o.indexOf(u),S=a.indexOf(d),j=E=>({width:o[E]||0,height:a[E]||0});return{first:j(0),last:j(n-1),widest:j(C),highest:j(S),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return D8(this._alignToPixels?zo(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=MV(this.getContext(),e,s))}return this.$context||(this.$context=OV(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=oi(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=Uc(i),p=[],w=a.setContext(this.getContext()),x=w.display?w.width:0,y=x/2,g=function(F){return zo(s,F,x)};let m,b,k,_,C,S,j,E,P,L,I,O;if(o==="top")m=g(this.bottom),S=this.bottom-f,E=m-y,L=g(e.top)+y,O=e.bottom;else if(o==="bottom")m=g(this.top),L=e.top,O=g(e.bottom)-y,S=m+y,E=this.top+f;else if(o==="left")m=g(this.right),C=this.right-f,j=m-y,P=g(e.left)+y,I=e.right;else if(o==="right")m=g(this.left),P=e.left,I=g(e.right)-y,C=m+y,j=this.left+f;else if(n==="x"){if(o==="center")m=g((e.top+e.bottom)/2+.5);else if(rt(o)){const F=Object.keys(o)[0],K=o[F];m=g(this.chart.scales[F].getPixelForValue(K))}L=e.top,O=e.bottom,S=m+y,E=S+f}else if(n==="y"){if(o==="center")m=g((e.left+e.right)/2);else if(rt(o)){const F=Object.keys(o)[0],K=o[F];m=g(this.chart.scales[F].getPixelForValue(K))}C=m-y,j=C-f,P=e.left,I=e.right}const $=nt(r.ticks.maxTicksLimit,h),D=Math.max(1,Math.ceil(h/$));for(b=0;b<h;b+=D){const F=this.getContext(b),K=i.setContext(F),T=a.setContext(F),R=K.lineWidth,V=K.color,G=T.dash||[],Q=T.dashOffset,re=K.tickWidth,ee=K.tickColor,z=K.tickBorderDash||[],A=K.tickBorderDashOffset;k=RV(this,b,l),k!==void 0&&(_=zo(s,k,R),u?C=j=P=I=_:S=E=L=O=_,p.push({tx1:C,ty1:S,tx2:j,ty2:E,x1:P,y1:L,x2:I,y2:O,width:R,color:V,borderDash:G,borderDashOffset:Q,tickWidth:re,tickColor:ee,tickBorderDash:z,tickBorderDashOffset:A}))}return this._ticksLength=h,this._borderValue=m,p}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:u,padding:d,mirror:h}=i,f=Uc(s.grid),p=f+d,w=h?-d:p,x=-oi(this.labelRotation),y=[];let g,m,b,k,_,C,S,j,E,P,L,I,O="middle";if(r==="top")C=this.bottom-w,S=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+w,S=this._getXAxisLabelAlignment();else if(r==="left"){const D=this._getYAxisLabelAlignment(f);S=D.textAlign,_=D.x}else if(r==="right"){const D=this._getYAxisLabelAlignment(f);S=D.textAlign,_=D.x}else if(n==="x"){if(r==="center")C=(e.top+e.bottom)/2+p;else if(rt(r)){const D=Object.keys(r)[0],F=r[D];C=this.chart.scales[D].getPixelForValue(F)+p}S=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")_=(e.left+e.right)/2-p;else if(rt(r)){const D=Object.keys(r)[0],F=r[D];_=this.chart.scales[D].getPixelForValue(F)}S=this._getYAxisLabelAlignment(f).textAlign}n==="y"&&(l==="start"?O="top":l==="end"&&(O="bottom"));const $=this._getLabelSizes();for(g=0,m=a.length;g<m;++g){b=a[g],k=b.label;const D=i.setContext(this.getContext(g));j=this.getPixelForTick(g)+i.labelOffset,E=this._resolveTickFontOptions(g),P=E.lineHeight,L=pn(k)?k.length:1;const F=L/2,K=D.color,T=D.textStrokeColor,R=D.textStrokeWidth;let V=S;o?(_=j,S==="inner"&&(g===m-1?V=this.options.reverse?"left":"right":g===0?V=this.options.reverse?"right":"left":V="center"),r==="top"?u==="near"||x!==0?I=-L*P+P/2:u==="center"?I=-$.highest.height/2-F*P+P:I=-$.highest.height+P/2:u==="near"||x!==0?I=P/2:u==="center"?I=$.highest.height/2-F*P:I=$.highest.height-L*P,h&&(I*=-1),x!==0&&!D.showLabelBackdrop&&(_+=P/2*Math.sin(x))):(C=j,I=(1-L)*P/2);let G;if(D.showLabelBackdrop){const Q=xr(D.backdropPadding),re=$.heights[g],ee=$.widths[g];let z=I-Q.top,A=0-Q.left;switch(O){case"middle":z-=re/2;break;case"bottom":z-=re;break}switch(S){case"center":A-=ee/2;break;case"right":A-=ee;break;case"inner":g===m-1?A-=ee:g>0&&(A-=ee/2);break}G={left:A,top:z,width:ee+Q.width,height:re+Q.height,color:D.backdropColor}}y.push({label:k,font:E,textOffset:I,options:{rotation:x,color:K,strokeColor:T,strokeWidth:R,textAlign:V,textBaseline:O,translation:[_,C],backdrop:G}})}return y}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-oi(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let u,d;return n==="left"?r?(d=this.right+i,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d+=l)):(d=this.right-a,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+i,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d-=l)):(d=this.left+a,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,d,h,f;this.isHorizontal()?(u=zo(e,this.left,o)-o/2,d=zo(e,this.right,a)+a/2,h=f=l):(h=zo(e,this.top,o)-o/2,f=zo(e,this.bottom,a)+a/2,u=d=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,h),n.lineTo(d,f),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&X0(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,u=o.label,d=o.textOffset;jp(s,u,0,d,l,a)}r&&J0(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=is(s.font),o=xr(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||rt(n)?(l+=o.bottom,pn(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:u,titleY:d,maxWidth:h,rotation:f}=DV(this,l,n,a);jp(e,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:f,textAlign:IV(a,n,r),textBaseline:"middle",translation:[u,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=nt(e.grid&&e.grid.z,-1),r=nt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Sc.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return is(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Xh{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;FV(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,LV(e,o,s),this.override&&Zt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in Zt[r]&&(delete Zt[r][s],this.override&&delete Ta[s])}}function LV(t,e,n){const s=cd(Object.create(null),[n?Zt.get(n):{},Zt.get(e),t.defaults]);Zt.set(e,s),t.defaultRoutes&&$V(e,t.defaultRoutes),t.descriptors&&Zt.describe(e,t.descriptors)}function $V(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Zt.route(i,r,l,a)})}function FV(t){return"id"in t&&"defaults"in t}class zV{constructor(){this.controllers=new Xh($l,"datasets",!0),this.elements=new Xh(_c,"elements"),this.plugins=new Xh(Object,"plugins"),this.scales=new Xh(Sc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):gt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=G0(e);Et(s["before"+r],[],s),n[e](s),Et(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var Cr=new zV;class BV{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(Et(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){wt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=nt(s.options&&s.options.plugins,{}),i=UV(s);return r===!1&&!n?[]:WV(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function UV(t){const e={},n=[],s=Object.keys(Cr.plugins.items);for(let i=0;i<s.length;i++)n.push(Cr.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function HV(t,e){return!e&&t===!1?null:t===!0?{}:t}function WV(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,u=HV(s[l],r);u!==null&&i.push({plugin:a,options:VV(t.config,{plugin:a,local:n[l]},u,o)})}return i}function VV(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function qy(t,e){const n=Zt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function qV(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function KV(t,e){return t===e?"_index_":"_value_"}function NS(t){if(t==="x"||t==="y"||t==="r")return t}function GV(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Ky(t,...e){if(NS(t))return t;for(const n of e){const s=n.axis||GV(n.position)||t.length>1&&NS(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function ES(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function YV(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return ES(t,"x",n[0])||ES(t,"y",n[0])}return{}}function QV(t,e){const n=Ta[t.type]||{scales:{}},s=e.scales||{},r=qy(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!rt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=Ky(o,a,YV(o,t),Zt.scales[a.type]),u=KV(l,r),d=n.scales||{};i[o]=xu(Object.create(null),[{axis:l},a,d[l],d[u]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||qy(a,e),d=(Ta[a]||{}).scales||{};Object.keys(d).forEach(h=>{const f=qV(h,l),p=o[f+"AxisID"]||f;i[p]=i[p]||Object.create(null),xu(i[p],[{axis:f},s[p],d[h]])})}),Object.keys(i).forEach(o=>{const a=i[o];xu(a,[Zt.scales[a.type],Zt.scale])}),i}function BT(t){const e=t.options||(t.options={});e.plugins=nt(e.plugins,{}),e.scales=QV(t,e)}function UT(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function XV(t){return t=t||{},t.data=UT(t.data),BT(t),t}const TS=new Map,HT=new Set;function Jh(t,e){let n=TS.get(t);return n||(n=e(),TS.set(t,n),HT.add(n)),n}const Hc=(t,e,n)=>{const s=Ea(e,n);s!==void 0&&t.add(s)};class JV{constructor(e){this._config=XV(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=UT(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),BT(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Jh(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Jh(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Jh(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Jh(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(d=>{e&&(l.add(e),d.forEach(h=>Hc(l,e,h))),d.forEach(h=>Hc(l,r,h)),d.forEach(h=>Hc(l,Ta[i]||{},h)),d.forEach(h=>Hc(l,Zt,h)),d.forEach(h=>Hc(l,Wy,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),HT.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,Ta[n]||{},Zt.datasets[n]||{},{type:n},Zt,Wy]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=PS(this._resolverCache,e,r);let l=o;if(eq(o,n)){i.$shared=!1,s=vo(s)?s():s;const u=this.createResolver(e,s,a);l=lc(o,s,u)}for(const u of n)i[u]=l[u];return i}createResolver(e,n,s=[""],r){const{resolver:i}=PS(this._resolverCache,e,s);return rt(n)?lc(i,n,void 0,r):i}}function PS(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:eb(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const ZV=t=>rt(t)&&Object.getOwnPropertyNames(t).some(e=>vo(t[e]));function eq(t,e){const{isScriptable:n,isIndexable:s}=NT(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(vo(a)||ZV(a))||o&&pn(a))return!0}return!1}var tq="4.5.1";const nq=["top","bottom","left","right","chartArea"];function RS(t,e){return t==="top"||t==="bottom"||nq.indexOf(t)===-1&&e==="x"}function AS(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function OS(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Et(n&&n.onComplete,[t],e)}function sq(t){const e=t.chart,n=e.options.animation;Et(n&&n.onProgress,[t],e)}function WT(t){return sb()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Pf={},MS=t=>{const e=WT(t);return Object.values(Pf).filter(n=>n.canvas===e).pop()};function rq(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function iq(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}class Ar{static register(...e){Cr.add(...e),IS()}static unregister(...e){Cr.remove(...e),IS()}constructor(e,n){const s=this.config=new JV(n),r=WT(e),i=MS(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||_V(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,u=l&&l.height,d=l&&l.width;if(this.id=k8(),this.ctx=a,this.canvas=l,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new BV,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=z8(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Pf[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Kr.listen(this,"complete",OS),Kr.listen(this,"progress",sq),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return wt(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Cr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():oS(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return nS(this.canvas,this.ctx),this}stop(){return Kr.stop(this),this}resize(e,n){Kr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,oS(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Et(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};gt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=Ky(o,a),u=l==="r",d=l==="x";return{options:a,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),gt(i,o=>{const a=o.options,l=a.id,u=Ky(l,a),d=nt(a.type,o.dtype);(a.position===void 0||RS(a.position,u)!==RS(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in s&&s[l].type===d)h=s[l];else{const f=Cr.getScale(d);h=new f({id:l,type:d,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(a,e)}),gt(r,(o,a)=>{o||delete s[a]}),gt(s,o=>{Xi.configure(this,o,o.options),Xi.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(AS("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||qy(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=Cr.getController(a),{datasetElementType:u,dataElementType:d}=Zt.datasets[a];Object.assign(l,{dataElementType:Cr.getElement(d),datasetElementType:u&&Cr.getElement(u)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){gt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),f=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(f),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||gt(i,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(AS("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){gt(this.scales,e=>{Xi.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!q_(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;rq(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!q_(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Xi.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],gt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,vo(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Kr.has(this)?this.attached&&!Kr.running(this)&&Kr.start(this):(this.draw(),OS({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=jW(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&X0(n,r),e.controller.draw(),r&&J0(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return jT(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=nV.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=kc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);ud(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Kr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),nS(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Pf[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};gt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,u)=>{n.addEventListener(this,l,u),e[l]=u},r=(l,u)=>{e[l]&&(n.removeEventListener(this,l,u),delete e[l])},i=(l,u)=>{this.canvas&&this.resize(l,u)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){gt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},gt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!bp(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,u)=>l.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=E8(e),u=iq(e,this._lastEvent,s,l);s&&(this._lastEvent=null,Et(i.onHover,[e,a,this],this),l&&Et(i.onClick,[e,a,this],this));const d=!bp(a,r);return(d||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=u,d}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}$e(Ar,"defaults",Zt),$e(Ar,"instances",Pf),$e(Ar,"overrides",Ta),$e(Ar,"registry",Cr),$e(Ar,"version",tq),$e(Ar,"getChart",MS);function IS(){return gt(Ar.instances,t=>t._plugins.invalidate())}function oq(t,e,n){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:u,borderJoinStyle:d}=l,h=Math.min(u/o,Nr(s-n));if(t.beginPath(),t.arc(r,i,o-u/2,s+h/2,n-h/2),a>0){const f=Math.min(u/a,Nr(s-n));t.arc(r,i,a+u/2,n-f/2,s+f/2,!0)}else{const f=Math.min(u/2,o*Nr(s-n));if(d==="round")t.arc(r,i,f,n-Tt/2,s+Tt/2,!0);else if(d==="bevel"){const p=2*f*f,w=-p*Math.cos(n+Tt/2)+r,x=-p*Math.sin(n+Tt/2)+i,y=p*Math.cos(s+Tt/2)+r,g=p*Math.sin(s+Tt/2)+i;t.lineTo(w,x),t.lineTo(y,g)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function aq(t,e,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:a,innerRadius:l}=e;let u=r/a;t.beginPath(),t.arc(i,o,a,s-u,n+u),l>r?(u=r/l,t.arc(i,o,l,n+u,s-u,!0)):t.arc(i,o,r,n+un,s-un),t.closePath(),t.clip()}function lq(t){return Z0(t,["outerStart","outerEnd","innerStart","innerEnd"])}function cq(t,e,n,s){const r=lq(t.options.borderRadius),i=(n-e)/2,o=Math.min(i,s*e/2),a=l=>{const u=(n-Math.min(i,l))*s/2;return rs(l,0,Math.min(i,u))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:rs(r.innerStart,0,o),innerEnd:rs(r.innerEnd,0,o)}}function nl(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function Tp(t,e,n,s,r,i){const{x:o,y:a,startAngle:l,pixelMargin:u,innerRadius:d}=e,h=Math.max(e.outerRadius+s+n-u,0),f=d>0?d+s+n+u:0;let p=0;const w=r-l;if(s){const D=d>0?d-s:0,F=h>0?h-s:0,K=(D+F)/2,T=K!==0?w*K/(K+s):w;p=(w-T)/2}const x=Math.max(.001,w*h-n/Tt)/h,y=(w-x)/2,g=l+y+p,m=r-y-p,{outerStart:b,outerEnd:k,innerStart:_,innerEnd:C}=cq(e,f,h,m-g),S=h-b,j=h-k,E=g+b/S,P=m-k/j,L=f+_,I=f+C,O=g+_/L,$=m-C/I;if(t.beginPath(),i){const D=(E+P)/2;if(t.arc(o,a,h,E,D),t.arc(o,a,h,D,P),k>0){const R=nl(j,P,o,a);t.arc(R.x,R.y,k,P,m+un)}const F=nl(I,m,o,a);if(t.lineTo(F.x,F.y),C>0){const R=nl(I,$,o,a);t.arc(R.x,R.y,C,m+un,$+Math.PI)}const K=(m-C/f+(g+_/f))/2;if(t.arc(o,a,f,m-C/f,K,!0),t.arc(o,a,f,K,g+_/f,!0),_>0){const R=nl(L,O,o,a);t.arc(R.x,R.y,_,O+Math.PI,g-un)}const T=nl(S,g,o,a);if(t.lineTo(T.x,T.y),b>0){const R=nl(S,E,o,a);t.arc(R.x,R.y,b,g-un,E)}}else{t.moveTo(o,a);const D=Math.cos(E)*h+o,F=Math.sin(E)*h+a;t.lineTo(D,F);const K=Math.cos(P)*h+o,T=Math.sin(P)*h+a;t.lineTo(K,T)}t.closePath()}function uq(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){Tp(t,e,n,s,l,r);for(let u=0;u<i;++u)t.fill();isNaN(a)||(l=o+(a%sn||sn))}return Tp(t,e,n,s,l,r),t.fill(),l}function dq(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:f,borderRadius:p}=l,w=l.borderAlign==="inner";if(!u)return;t.setLineDash(h||[]),t.lineDashOffset=f,w?(t.lineWidth=u*2,t.lineJoin=d||"round"):(t.lineWidth=u,t.lineJoin=d||"bevel");let x=e.endAngle;if(i){Tp(t,e,n,s,x,r);for(let y=0;y<i;++y)t.stroke();isNaN(a)||(x=o+(a%sn||sn))}w&&aq(t,e,x),l.selfJoin&&x-o>=Tt&&p===0&&d!=="miter"&&oq(t,e,x),i||(Tp(t,e,n,s,x,r),t.stroke())}class nu extends _c{constructor(n){super();$e(this,"circumference");$e(this,"endAngle");$e(this,"fullCircles");$e(this,"innerRadius");$e(this,"outerRadius");$e(this,"pixelMargin");$e(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:a}=gT(i,{x:n,y:s}),{startAngle:l,endAngle:u,innerRadius:d,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),p=(this.options.spacing+this.options.borderWidth)/2,w=nt(f,u-l),x=Sp(o,l,u)&&l!==u,y=w>=sn||x,g=ta(a,d+p,h+p);return y&&g}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:u,spacing:d}=this.options,h=(i+o)/2,f=(a+l+d+u)/2;return{x:s+Math.cos(h)*f,y:r+Math.sin(h)*f}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>sn?Math.floor(r/sn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const u=1-Math.sin(Math.min(Tt,r||0)),d=i*u;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,uq(n,this,d,o,a),dq(n,this,d,o,a),n.restore()}}$e(nu,"id","arc"),$e(nu,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),$e(nu,"defaultRoutes",{backgroundColor:"backgroundColor"}),$e(nu,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function VT(t,e){const{x:n,y:s,base:r,width:i,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,u,d,h;return t.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),u=s-h,d=s+h):(h=i/2,a=n-h,l=n+h,u=Math.min(s,r),d=Math.max(s,r)),{left:a,top:u,right:l,bottom:d}}function Ji(t,e,n,s){return t?0:rs(e,n,s)}function hq(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=CT(s);return{t:Ji(r.top,i.top,0,n),r:Ji(r.right,i.right,0,e),b:Ji(r.bottom,i.bottom,0,n),l:Ji(r.left,i.left,0,e)}}function fq(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=Dl(r),o=Math.min(e,n),a=t.borderSkipped,l=s||rt(r);return{topLeft:Ji(!l||a.top||a.left,i.topLeft,0,o),topRight:Ji(!l||a.top||a.right,i.topRight,0,o),bottomLeft:Ji(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:Ji(!l||a.bottom||a.right,i.bottomRight,0,o)}}function pq(t){const e=VT(t),n=e.right-e.left,s=e.bottom-e.top,r=hq(t,n/2,s/2),i=fq(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function Vg(t,e,n,s){const r=e===null,i=n===null,a=t&&!(r&&i)&&VT(t,s);return a&&(r||ta(e,a.left,a.right))&&(i||ta(n,a.top,a.bottom))}function mq(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function gq(t,e){t.rect(e.x,e.y,e.w,e.h)}function qg(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+o,radius:t.radius}}class Rf extends _c{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=pq(this),a=mq(o.radius)?Cp:gq;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,qg(o,n,i)),e.clip(),a(e,qg(i,-n,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),a(e,qg(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Vg(this,e,n,s)}inXRange(e,n){return Vg(this,e,null,n)}inYRange(e,n){return Vg(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}$e(Rf,"id","bar"),$e(Rf,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),$e(Rf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const DS=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},xq=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class LS extends _c{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Et(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=is(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=DS(s,i);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,i,a,l)+10):(d=this.maxHeight,u=this._fitCols(o,r,a,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+a;let h=e;i.textAlign="left",i.textBaseline="middle";let f=-1,p=-d;return this.legendItems.forEach((w,x)=>{const y=s+n/2+i.measureText(w.text).width;(x===0||u[u.length-1]+y+2*a>o)&&(h+=d,u[u.length-(x>0?0:1)]=0,p+=d,f++),l[x]={left:0,top:p,row:f,width:y,height:r},u[u.length-1]+=y+a}),h}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-e;let h=a,f=0,p=0,w=0,x=0;return this.legendItems.forEach((y,g)=>{const{itemWidth:m,itemHeight:b}=yq(s,n,i,y,r);g>0&&p+b+2*a>d&&(h+=f+a,u.push({width:f,height:p}),w+=f+a,x++,f=p=0),l[g]={left:w,top:p,col:x,width:m,height:b},f=Math.max(f,m),p+=b+a}),h+=f,u.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=Ll(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=xs(s,this.left+r,this.right-this.lineWidths[a]);for(const u of n)a!==u.row&&(a=u.row,l=xs(s,this.left+r,this.right-this.lineWidths[a])),u.top+=this.top+e+r,u.left=o.leftForLtr(o.x(l),u.width),l+=u.width+r}else{let a=0,l=xs(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const u of n)u.col!==a&&(a=u.col,l=xs(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),u.top=l,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),l+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;X0(e,this),this._draw(),J0(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=Zt.color,l=Ll(e.rtl,this.left,this.width),u=is(o.font),{padding:d}=o,h=u.size,f=h/2;let p;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:w,boxHeight:x,itemHeight:y}=DS(o,h),g=function(C,S,j){if(isNaN(w)||w<=0||isNaN(x)||x<0)return;r.save();const E=nt(j.lineWidth,1);if(r.fillStyle=nt(j.fillStyle,a),r.lineCap=nt(j.lineCap,"butt"),r.lineDashOffset=nt(j.lineDashOffset,0),r.lineJoin=nt(j.lineJoin,"miter"),r.lineWidth=E,r.strokeStyle=nt(j.strokeStyle,a),r.setLineDash(nt(j.lineDash,[])),o.usePointStyle){const P={radius:x*Math.SQRT2/2,pointStyle:j.pointStyle,rotation:j.rotation,borderWidth:E},L=l.xPlus(C,w/2),I=S+f;ST(r,P,L,I,o.pointStyleWidth&&w)}else{const P=S+Math.max((h-x)/2,0),L=l.leftForLtr(C,w),I=Dl(j.borderRadius);r.beginPath(),Object.values(I).some(O=>O!==0)?Cp(r,{x:L,y:P,w,h:x,radius:I}):r.rect(L,P,w,x),r.fill(),E!==0&&r.stroke()}r.restore()},m=function(C,S,j){jp(r,j.text,C,S+y/2,u,{strikethrough:j.hidden,textAlign:l.textAlign(j.textAlign)})},b=this.isHorizontal(),k=this._computeTitleHeight();b?p={x:xs(i,this.left+d,this.right-s[0]),y:this.top+d+k,line:0}:p={x:this.left+d,y:xs(i,this.top+k+d,this.bottom-n[0].height),line:0},RT(this.ctx,e.textDirection);const _=y+d;this.legendItems.forEach((C,S)=>{r.strokeStyle=C.fontColor,r.fillStyle=C.fontColor;const j=r.measureText(C.text).width,E=l.textAlign(C.textAlign||(C.textAlign=o.textAlign)),P=w+f+j;let L=p.x,I=p.y;l.setWidth(this.width),b?S>0&&L+P+d>this.right&&(I=p.y+=_,p.line++,L=p.x=xs(i,this.left+d,this.right-s[p.line])):S>0&&I+_>this.bottom&&(L=p.x=L+n[p.line].width+d,p.line++,I=p.y=xs(i,this.top+k+d,this.bottom-n[p.line].height));const O=l.x(L);if(g(O,I,C),L=B8(E,L+w+f,b?L+P:this.right,e.rtl),m(l.x(L),I,C),b)p.x+=P+d;else if(typeof C.text!="string"){const $=u.lineHeight;p.y+=qT(C,$)+d}else p.y+=_}),AT(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=is(n.font),r=xr(n.padding);if(!n.display)return;const i=Ll(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,u=r.top+l;let d,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),d=this.top+u,h=xs(e.align,h,this.right-f);else{const w=this.columnSizes.reduce((x,y)=>Math.max(x,y.height),0);d=u+xs(e.align,this.top,this.bottom-w-e.labels.padding-this._computeTitleHeight())}const p=xs(a,h,h+f);o.textAlign=i.textAlign(wT(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,jp(o,n.text,p,d,s)}_computeTitleHeight(){const e=this.options.title,n=is(e.font),s=xr(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(ta(e,this.left,this.right)&&ta(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],ta(e,r.left,r.left+r.width)&&ta(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!wq(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=xq(r,s);r&&!i&&Et(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&Et(n.onHover,[e,s,this],this)}else s&&Et(n.onClick,[e,s,this],this)}}function yq(t,e,n,s,r){const i=vq(s,t,e,n),o=bq(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function vq(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function bq(t,e,n){let s=t;return typeof e.text!="string"&&(s=qT(e,n)),s}function qT(t,e){const n=t.text?t.text.length:0;return e*n}function wq(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var kq={id:"legend",_element:LS,start(t,e,n){const s=t.legend=new LS({ctx:t.ctx,options:n,chart:t});Xi.configure(t,s,n),Xi.addBox(t,s)},stop(t){Xi.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Xi.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(n?0:void 0),d=xr(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const su={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),d=I8(e,u);d<r&&(r=d,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function Sr(t,e){return e&&(pn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Gr(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function _q(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function $S(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=is(e.bodyFont),u=is(e.titleFont),d=is(e.footerFont),h=i.length,f=r.length,p=s.length,w=xr(e.padding);let x=w.height,y=0,g=s.reduce((k,_)=>k+_.before.length+_.lines.length+_.after.length,0);if(g+=t.beforeBody.length+t.afterBody.length,h&&(x+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),g){const k=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;x+=p*k+(g-p)*l.lineHeight+(g-1)*e.bodySpacing}f&&(x+=e.footerMarginTop+f*d.lineHeight+(f-1)*e.footerSpacing);let m=0;const b=function(k){y=Math.max(y,n.measureText(k).width+m)};return n.save(),n.font=u.string,gt(t.title,b),n.font=l.string,gt(t.beforeBody.concat(t.afterBody),b),m=e.displayColors?o+2+e.boxPadding:0,gt(s,k=>{gt(k.before,b),gt(k.lines,b),gt(k.after,b)}),m=0,n.font=d.string,gt(t.footer,b),n.restore(),y+=w.width,{width:y,height:x}}function Sq(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function jq(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function Cq(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let u="center";return s==="center"?u=r<=(a+l)/2?"left":"right":r<=i/2?u="left":r>=o-i/2&&(u="right"),jq(u,t,e,n)&&(u="center"),u}function FS(t,e,n){const s=n.yAlign||e.yAlign||Sq(t,n);return{xAlign:n.xAlign||e.xAlign||Cq(t,e,n,s),yAlign:s}}function Nq(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function Eq(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function zS(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,u=r+i,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Dl(o);let w=Nq(e,a);const x=Eq(e,l,u);return l==="center"?a==="left"?w+=u:a==="right"&&(w-=u):a==="left"?w-=Math.max(d,f)+r:a==="right"&&(w+=Math.max(h,p)+r),{x:rs(w,0,s.width-e.width),y:rs(x,0,s.height-e.height)}}function Zh(t,e,n){const s=xr(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function BS(t){return Sr([],Gr(t))}function Tq(t,e,n){return kc(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function US(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const KT={beforeTitle:Vr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Vr,beforeBody:Vr,beforeLabel:Vr,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return wt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Vr,afterBody:Vr,beforeFooter:Vr,footer:Vr,afterFooter:Vr};function Qn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?KT[e].call(n,s):r}class Gy extends _c{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new OT(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=Tq(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=Qn(s,"beforeTitle",this,e),i=Qn(s,"title",this,e),o=Qn(s,"afterTitle",this,e);let a=[];return a=Sr(a,Gr(r)),a=Sr(a,Gr(i)),a=Sr(a,Gr(o)),a}getBeforeBody(e,n){return BS(Qn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return gt(e,i=>{const o={before:[],lines:[],after:[]},a=US(s,i);Sr(o.before,Gr(Qn(a,"beforeLabel",this,i))),Sr(o.lines,Qn(a,"label",this,i)),Sr(o.after,Gr(Qn(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return BS(Qn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=Qn(s,"beforeFooter",this,e),i=Qn(s,"footer",this,e),o=Qn(s,"afterFooter",this,e);let a=[];return a=Sr(a,Gr(r)),a=Sr(a,Gr(i)),a=Sr(a,Gr(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,u;for(l=0,u=n.length;l<u;++l)a.push(_q(this.chart,n[l]));return e.filter&&(a=a.filter((d,h,f)=>e.filter(d,h,f,s))),e.itemSort&&(a=a.sort((d,h)=>e.itemSort(d,h,s))),gt(a,d=>{const h=US(e.callbacks,d);r.push(Qn(h,"labelColor",this,d)),i.push(Qn(h,"labelPointStyle",this,d)),o.push(Qn(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=su[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=$S(this,s),u=Object.assign({},a,l),d=FS(this.chart,s,u),h=zS(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:h}=Dl(a),{x:f,y:p}=e,{width:w,height:x}=n;let y,g,m,b,k,_;return i==="center"?(k=p+x/2,r==="left"?(y=f,g=y-o,b=k+o,_=k-o):(y=f+w,g=y+o,b=k-o,_=k+o),m=y):(r==="left"?g=f+Math.max(l,d)+o:r==="right"?g=f+w-Math.max(u,h)-o:g=this.caretX,i==="top"?(b=p,k=b-o,y=g-o,m=g+o):(b=p+x,k=b+o,y=g+o,m=g-o),_=b),{x1:y,x2:g,x3:m,y1:b,y2:k,y3:_}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const u=Ll(s.rtl,this.x,this.width);for(e.x=Zh(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",o=is(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:u}=i,d=is(i.bodyFont),h=Zh(this,"left",i),f=r.x(h),p=l<d.lineHeight?(d.lineHeight-l)/2:0,w=n.y+p;if(i.usePointStyle){const x={radius:Math.min(u,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},y=r.leftForLtr(f,u)+u/2,g=w+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,sS(e,x,y,g),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,sS(e,x,y,g)}else{e.lineWidth=rt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=r.leftForLtr(f,u),y=r.leftForLtr(r.xPlus(f,1),u-2),g=Dl(o.borderRadius);Object.values(g).some(m=>m!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,Cp(e,{x,y:w,w:u,h:l,radius:g}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Cp(e,{x:y,y:w+1,w:u-2,h:l-2,radius:g}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(x,w,u,l),e.strokeRect(x,w,u,l),e.fillStyle=o.backgroundColor,e.fillRect(y,w+1,u-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:u,boxPadding:d}=s,h=is(s.bodyFont);let f=h.lineHeight,p=0;const w=Ll(s.rtl,this.x,this.width),x=function(j){n.fillText(j,w.x(e.x+p),e.y+f/2),e.y+=f+i},y=w.textAlign(o);let g,m,b,k,_,C,S;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,e.x=Zh(this,y,s),n.fillStyle=s.bodyColor,gt(this.beforeBody,x),p=a&&y!=="right"?o==="center"?u/2+d:u+2+d:0,k=0,C=r.length;k<C;++k){for(g=r[k],m=this.labelTextColors[k],n.fillStyle=m,gt(g.before,x),b=g.lines,a&&b.length&&(this._drawColorBox(n,e,k,w,s),f=Math.max(h.lineHeight,l)),_=0,S=b.length;_<S;++_)x(b[_]),f=h.lineHeight;gt(g.after,x)}p=0,f=h.lineHeight,gt(this.afterBody,x),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=Ll(s.rtl,this.x,this.width);for(e.x=Zh(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=is(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:u,height:d}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:w}=Dl(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+h,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+u-f,l),n.quadraticCurveTo(a+u,l,a+u,l+f),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+u,l+d-w),n.quadraticCurveTo(a+u,l+d,a+u-w,l+d),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+p,l+d),n.quadraticCurveTo(a,l+d,a,l+d-p),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+h),n.quadraticCurveTo(a,l,a+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=su[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=$S(this,e),l=Object.assign({},o,this._size),u=FS(n,e,l),d=zS(e,l,u,n);(r._to!==d.x||i._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=xr(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),RT(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),AT(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const u=this.chart.getDatasetMeta(a);if(!u)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:u.data[l],index:l}}),i=!bp(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!bp(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=su[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}$e(Gy,"positioners",su);var Pq={id:"tooltip",_element:Gy,positioners:su,afterInit(t,e,n){n&&(t.tooltip=new Gy({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:KT},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Rq=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function Aq(t,e,n,s){const r=t.indexOf(e);if(r===-1)return Rq(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const Oq=(t,e)=>t===null?null:rs(Math.round(t),0,e);function HS(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Yy extends Sc{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(wt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:Aq(s,e,nt(n,e),this._addedLabels),Oq(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return HS.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}$e(Yy,"id","category"),$e(Yy,"defaults",{ticks:{callback:HS}});function Mq(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:u,maxTicks:d,maxDigits:h,includeBounds:f}=t,p=i||1,w=d-1,{min:x,max:y}=e,g=!wt(o),m=!wt(a),b=!wt(u),k=(y-x)/(h+1);let _=G_((y-x)/w/p)*p,C,S,j,E;if(_<1e-14&&!g&&!m)return[{value:x},{value:y}];E=Math.ceil(y/_)-Math.floor(x/_),E>w&&(_=G_(E*_/w/p)*p),wt(l)||(C=Math.pow(10,l),_=Math.ceil(_*C)/C),r==="ticks"?(S=Math.floor(x/_)*_,j=Math.ceil(y/_)*_):(S=x,j=y),g&&m&&i&&A8((a-o)/i,_/1e3)?(E=Math.round(Math.min((a-o)/_,d)),_=(a-o)/E,S=o,j=a):b?(S=g?o:S,j=m?a:j,E=u-1,_=(j-S)/E):(E=(j-S)/_,Nf(E,Math.round(E),_/1e3)?E=Math.round(E):E=Math.ceil(E));const P=Math.max(Y_(_),Y_(S));C=Math.pow(10,wt(l)?P:l),S=Math.round(S*C)/C,j=Math.round(j*C)/C;let L=0;for(g&&(f&&S!==o?(n.push({value:o}),S<o&&L++,Nf(Math.round((S+L*_)*C)/C,o,WS(o,k,t))&&L++):S<o&&L++);L<E;++L){const I=Math.round((S+L*_)*C)/C;if(m&&I>a)break;n.push({value:I})}return m&&f&&j!==a?n.length&&Nf(n[n.length-1].value,a,WS(a,k,t))?n[n.length-1].value=a:n.push({value:a}):(!m||j===a)&&n.push({value:j}),n}function WS(t,e,{horizontal:n,minRotation:s}){const r=oi(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class Iq extends Sc{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return wt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=uo(r),u=uo(i);l<0&&u<0?a(0):l>0&&u>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=Mq(r,i);return e.bounds==="ticks"&&O8(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return Q0(e,this.chart.options.locale,this.options.ticks.format)}}class Qy extends Iq{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Ks(e)?e:0,this.max=Ks(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=oi(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}$e(Qy,"id","linear"),$e(Qy,"defaults",{ticks:{callback:_T.formatters.numeric}});const pm={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ts=Object.keys(pm);function VS(t,e){return t-e}function qS(t,e){if(wt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Ks(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(_p(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function KS(t,e,n,s){const r=ts.length;for(let i=ts.indexOf(t);i<r-1;++i){const o=pm[ts[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return ts[i]}return ts[r-1]}function Dq(t,e,n,s,r){for(let i=ts.length-1;i>=ts.indexOf(n);i--){const o=ts[i];if(pm[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return ts[n?ts.indexOf(n):0]}function Lq(t){for(let e=ts.indexOf(t)+1,n=ts.length;e<n;++e)if(pm[ts[e]].common)return ts[e]}function GS(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=Y0(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function $q(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function YS(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:$q(t,s,r,n)}class Pp extends Sc{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new XW._date(e.adapters.date);r.init(n),xu(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:qS(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!a&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Ks(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Ks(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=$8(r,i,o);return this._unit=n.unit||(s.autoSkip?KS(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):Dq(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:Lq(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),YS(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=rs(n,0,o),s=rs(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||KS(i.minUnit,n,s,this._getLabelCapacity(n)),a=nt(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,u=_p(l)||l===!0,d={};let h=n,f,p;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const w=r.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,a,o),p++)GS(d,f,w);return(f===s||r.bounds==="ticks"||p===1)&&GS(d,f,w),Object.keys(d).sort(VS).map(x=>+x)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return Et(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,u=this._majorUnit,d=l&&a[l],h=u&&a[u],f=s[n],p=u&&h&&f&&f.major;return this._adapter.format(e,r||(p?h:d))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=oi(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,YS(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(qS(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return yT(e.sort(VS))}}$e(Pp,"id","time"),$e(Pp,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function ef(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Hy(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Hy(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const u=o-i;return u?a+(l-a)*(e-i)/u:a}class QS extends Pp{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=ef(n,this.min),this._tableRange=ef(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,u,d;for(o=0,a=e.length;o<a;++o)u=e[o],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)d=r[o+1],l=r[o-1],u=r[o],Math.round((d+l)/2)!==u&&i.push({time:u,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(ef(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return ef(this._table,s*this._tableRange+this._minPos,!0)}}$e(QS,"id","timeseries"),$e(QS,"defaults",Pp.defaults);Ar.register(nu,Rf,Yy,kl,Vy,Ef,kq,Qy,Pq);const Fn={pending:"rgba(234, 179, 8, 0.7)",rejected:"rgba(239, 68, 68, 0.7)",returned:"rgba(249, 115, 22, 0.7)",submitted:"rgba(59, 130, 246, 0.7)",accepted:"rgba(34, 197, 94, 0.7)"},Fq=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}];function zq(t){const e=t-4,n=t+1,s=[];for(let r=e;r<=n;r+=1)s.push(r);return s}function In({icon:t,label:e,value:n,helper:s,accentClass:r,onClick:i}){const o=!!i;return c.jsxs(zt,{className:`p-4 ${o?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:i,role:o?"button":void 0,tabIndex:o?0:void 0,onKeyDown:o?a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),i==null||i())}:void 0,children:[c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("div",{className:`h-10 w-10 rounded-xl flex items-center justify-center ${r}`,children:c.jsx(t,{size:18})}),c.jsx("div",{className:"text-2xl font-semibold",children:n})]}),c.jsx("div",{className:"mt-2 text-xs text-black/55 dark:text-white/60",children:e}),s?c.jsx("div",{className:"text-xs text-black/45 dark:text-white/55",children:s}):null]})}function sl({title:t,children:e}){return c.jsxs(St,{className:"h-full",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:t})}),c.jsx(Qt,{children:c.jsx("div",{className:"h-[260px]",children:e})})]})}function GT({title:t,subtitle:e,children:n,defaultOpen:s=!1}){const[r,i]=v.useState(s);return c.jsxs(zt,{className:"p-3",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>i(o=>!o),"aria-expanded":r,children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:t}),e?c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:e}):null]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:r?"Hide":"View"}),c.jsx(ss,{size:16,className:`transition-transform ${r?"rotate-180":""}`})]})]}),r?c.jsx("div",{className:"mt-3 space-y-2 text-xs text-black/60 dark:text-white/65",children:n}):null]})}function rl({type:t,data:e,options:n}){const s=ve.useRef(null);return ve.useEffect(()=>{if(!s.current)return;const r=Ar.getChart(s.current);r&&r.destroy();const i=new Ar(s.current,{type:t,data:e,options:n});return()=>i.destroy()},[e,n,t]),c.jsx("canvas",{ref:s})}function Bq(t){const e=Number(t)||0;return e>=80?"bg-emerald-500/80":e>=60?"bg-amber-500/80":"bg-rose-500/80"}function XS(t){if(!t)return"--";const e=qs(t);return e?e.toLocaleDateString():t}function Uq({mode:t,period:e}){if(!e)return"Current period";if(t==="month"){const[n,s]=e.split("-");return new Date(Number(n),Number(s)-1,1).toLocaleString(void 0,{month:"long",year:"numeric"})}if(t==="year")return e;if(t==="range"){const[n,s]=e.split(",");return`${n} to ${s}`}return e}function JS(t){return{labels:["Pending","Rejected","Returned","Submitted","Accepted"],datasets:[{data:[t.pending,t.rejected,t.returned,t.submitted,t.accepted],backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]}}function tf(t){const e={Pending:0,Rejected:0,Returned:0,"Submitted to Sales":0,Accepted:0};return t.forEach(n=>{const s=n.status||"";s.includes("Pending")||s==="Critique"||s==="Raw"?e.Pending+=1:s==="Rejected"||s==="Editing"?e.Rejected+=1:s==="Returned"?e.Returned+=1:s==="Submitted to Sales"?e["Submitted to Sales"]+=1:(s==="Accepted"||s==="Done")&&(e.Accepted+=1)}),e}function Wc(t){return t.length?c.jsx("div",{className:"space-y-3",children:t.map(e=>c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:["#",e.task_number," - ",e.brand]}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[e.status," - ",e.videographer||"Unassigned"]})]}),c.jsxs("div",{className:"text-right text-xs text-black/50 dark:text-white/60",children:[c.jsxs("div",{children:["Film: ",XS(e.filming_deadline)]}),c.jsxs("div",{children:["Due: ",XS(e.submission_date)]})]})]})},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No tasks found."})}function nf(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:(e.versions||[]).map(n=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsx("div",{className:"mt-1 text-black/50 dark:text-white/60",children:(n.lifecycle||[]).map(s=>`${s.stage} (${s.at||""})`).join(" -> ")})]},n.version))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No versions found."})}function Kg(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:e.rejectionEvents.map((n,s)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsxs("div",{className:"text-black/50 dark:text-white/60",children:[n.event.rejection_class||"Unclassified"," - ",n.event.rejection_comments||"No notes"]})]},`${e.task_number}-${s}`))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection events."})}function Hq(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No pending reviews."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,versions:[]}),n[r].versions.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(GT,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.versions.map(s=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Waiting: ",s.waitingHours??"--"," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]})]},`${n.task.task_number}-${s.version.version}`))},n.task.task_number))})}function Wq(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No response data."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,responses:[]}),n[r].responses.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(GT,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.responses.map((s,r)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Decision: ",s.decision]}),c.jsxs("div",{children:["Response: ",s.responseHours," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]}),c.jsxs("div",{children:["Reviewed: ",s.reviewTime?s.reviewTime.toLocaleString():"--"]}),s.rejectionClass?c.jsxs("div",{children:["Class: ",s.rejectionClass]}):null,s.comments?c.jsxs("div",{children:["Notes: ",s.comments]}):null]},`${n.task.task_number}-${r}`))},n.task.task_number))})}function Vq(){const t=new Date,e=t.getFullYear(),[n,s]=v.useState("month"),[r,i]=v.useState(e),[o,a]=v.useState(t.getMonth()+1),[l,u]=v.useState(""),[d,h]=v.useState(""),[f,p]=v.useState(!1),[w,x]=v.useState(null),[y,g]=v.useState(null),m=zq(e),b=v.useMemo(()=>m.map(me=>({value:me,label:String(me)})),[m]),k=v.useMemo(()=>[{value:"month",label:"Month"},{value:"year",label:"Year"},{value:"range",label:"Range"}],[]),_=v.useMemo(()=>n==="month"?`${r}-${String(o).padStart(2,"0")}`:n==="year"?`${r}`:n==="range"&&l&&d?`${l},${d}`:"",[n,l,d,o,r]),C=Kt({queryKey:["video-critique","dashboard",n,_],queryFn:()=>j4({mode:n,period:_})}),S=C.data||{},j=S.tasks||[],E=S.summary||{},P=S.pie||{},L=S.reviewer||{},I=S.summary_videographers&&Object.keys(S.summary_videographers).length?S.summary_videographers:k2(j),O=S.videographers||{},$=v.useMemo(()=>j2(j),[j]),D=v.useMemo(()=>Ii(j),[j]),F=v.useMemo(()=>_2(j),[j]),K=v.useMemo(()=>S2(j),[j]),T=v.useMemo(()=>({labels:["Completed","Not Completed"],datasets:[{data:[P.completed||0,P.not_completed||0],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}),[P.completed,P.not_completed]),R=v.useMemo(()=>{const me=$.tasksStarted||0,H=P.completed||0,ye=Math.max(me-H,0);return{labels:["Completed","Not Completed"],datasets:[{data:[H,ye],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}},[$.tasksStarted,P.completed]),V=v.useMemo(()=>JS(D),[D]),G=v.useMemo(()=>Object.entries(I).sort((me,H)=>H[1].total-me[1].total),[I]),Q=!!w,re=!!y,ee=y?I[y]:null,z=y?O[y]||[]:[],A=v.useMemo(()=>Zu(j,"pending"),[j]),Y=v.useMemo(()=>Zu(j,"submitted"),[j]),U=v.useMemo(()=>kg(j,"hod"),[j]),J=v.useMemo(()=>kg(j,"hos"),[j]),be=v.useMemo(()=>{const me={};let H=0,ye=0;j.forEach(oe=>{(oe.versions||[]).forEach(Se=>{const ie=Se.lifecycle||[];if(!ie.length)return;const W=ie[ie.length-1],ke=((W==null?void 0:W.stage)||"").toLowerCase();(ke==="accepted"||ke==="done")&&(H+=1),(ke==="rejected"||ke==="editing"||ke==="returned")&&(ye+=1),ie.forEach(Re=>{const Oe=(Re.stage||"").toLowerCase();if(Oe==="rejected"||Oe==="editing"||Oe==="returned"){const ae=Re.rejection_class||"Unclassified";me[ae]=(me[ae]||0)+1}})})});const X=H+ye,ue=X?(H/X*100).toFixed(1):"0",de=X?(ye/X*100).toFixed(1):"0",he=Object.entries(me).sort((oe,Se)=>Se[1]-oe[1]);return{acceptedPct:ue,rejectedPct:de,classes:he,totalRejections:ye}},[j]);return C.isLoading?c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Video Critique Dashboard"})}),c.jsx(Qt,{children:c.jsx(Ve,{text:"Loading dashboard",className:"text-sm text-black/60 dark:text-white/65"})})]}):c.jsxs("div",{className:"flex flex-col gap-4 min-h-0 pb-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-1",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Video Critique Dashboard"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:Uq({mode:n,period:_})})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(ot,{value:n,options:k,onChange:s,className:"sm:w-[200px]"}),n==="month"?c.jsxs(c.Fragment,{children:[c.jsx(ot,{value:o,options:Fq,onChange:a,className:"sm:w-[200px]"}),c.jsx(ot,{value:r,options:b,onChange:i,className:"sm:w-[200px]"})]}):null,n==="year"?c.jsx(ot,{value:r,options:b,onChange:i,className:"sm:w-[200px]"}):null,n==="range"?c.jsxs(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!0),children:[c.jsx(VM,{size:16,className:"mr-2"}),"Pick Range"]}):null,c.jsxs(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>C.refetch(),children:[c.jsx(eI,{size:16,className:"mr-2"}),"Refresh"]})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(In,{icon:vf,label:"Total Tasks",value:E.total||0,helper:"Tasks created",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("total_created")}),c.jsx(In,{icon:bh,label:"Assigned",value:E.assigned||0,helper:"Assigned to videographers",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("total_assigned")}),c.jsx(In,{icon:wh,label:"Tasks Started",value:$.tasksStarted||0,helper:"Filming date passed",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("total_started")}),c.jsx(In,{icon:kh,label:"Late Tasks",value:$.lateTasks||0,helper:"Submission overdue",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("total_late")}),c.jsx(In,{icon:vf,label:"Uploads",value:E.uploads||0,helper:"Total versions",accentClass:"bg-purple-500/10 text-purple-700 dark:text-purple-200",onClick:()=>x("upload_ratio")}),c.jsx(In,{icon:bh,label:"Completed",value:P.completed||0,helper:"Accepted or done",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("completed")})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(In,{icon:wh,label:"Pending HOD",value:$.pendingHOD||0,helper:"Versions in critique",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("pending_hod")}),c.jsx(In,{icon:wh,label:"Pending HOS",value:$.pendingHOS||0,helper:"Submitted to sales",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("pending_hos")}),c.jsx(In,{icon:kh,label:"Rejected by HOD",value:$.rejectionsByHOD||0,helper:"Editing / rejected",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("rejected_hod")}),c.jsx(In,{icon:kh,label:"Rejected by HOS",value:$.rejectionsByHOS||0,helper:"Returned",accentClass:"bg-orange-500/10 text-orange-700 dark:text-orange-200",onClick:()=>x("rejected_hos")}),c.jsx(In,{icon:vf,label:"Upload Ratio",value:$.uploadRatio||"0",helper:"Avg versions/task",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("upload_ratio")}),c.jsx(In,{icon:bh,label:"Acceptance Rate",value:`${E.accepted_pct||0}%`,helper:"Accepted vs reviewed",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("acceptance_rate")})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsx(sl,{title:"Completion Overview",children:c.jsx(rl,{type:"doughnut",data:T,options:{maintainAspectRatio:!1}})}),c.jsx(sl,{title:"Started vs Completed",children:c.jsx(rl,{type:"doughnut",data:R,options:{maintainAspectRatio:!1}})}),c.jsx(sl,{title:"Status Distribution",children:c.jsx(rl,{type:"bar",data:V,options:{maintainAspectRatio:!1,indexAxis:"y",scales:{x:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}},y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}}}}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Reviewer Performance"})}),c.jsx(Qt,{children:c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Avg response time"}),c.jsx("span",{className:"font-semibold",children:L.avg_response_display||"0 hrs"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Handled"}),c.jsx("span",{className:"font-semibold",children:L.handled||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Accepted by HOS"}),c.jsx("span",{className:"font-semibold",children:L.accepted||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Success rate"}),c.jsxs("span",{className:"font-semibold",children:[L.handled_percent||0,"%"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Pending reviews"}),c.jsx("span",{className:"font-semibold",children:F.count||0})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(se,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("response_time"),children:"View response times"}),c.jsx(se,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("pending_reviews"),children:"View pending reviews"})]})]})})]}),c.jsxs(St,{className:"lg:col-span-2",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Videographers"})}),c.jsx(Qt,{children:G.length?c.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:G.map(([me,H])=>c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>g(me),children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:me}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[H.total," tasks"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-lg font-semibold",children:[H.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]})]}),c.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-black/60 dark:text-white/60",children:[c.jsxs("div",{children:["Started: ",H.started]}),c.jsxs("div",{children:["Late: ",H.late]}),c.jsxs("div",{children:["Completed: ",H.completed]}),c.jsxs("div",{children:["Uploads: ",H.uploads]})]}),c.jsx("div",{className:"mt-3 h-2 rounded-full bg-black/10 dark:bg-white/10 overflow-hidden",children:c.jsx("div",{className:`h-full ${Bq(H.accepted_pct)}`,style:{width:`${H.accepted_pct}%`}})})]},me))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No videographer data."})})]})]}),c.jsxs(Ns,{open:Q,onClose:()=>x(null),title:"Details",maxWidth:"820px",children:[w==="total_created"?Wc(j):null,w==="total_assigned"?Wc(j.filter(me=>me.status!=="Not assigned yet")):null,w==="total_started"?Wc(j.filter(me=>{const H=qs(me.filming_deadline||"");if(!H)return!1;const ye=new Date;return ye.setHours(0,0,0,0),H<=ye})):null,w==="total_late"?Wc(j.filter(_g)):null,w==="completed"?Wc(j.filter(me=>me.status==="Accepted"||me.status==="Done")):null,w==="pending_hod"?nf(A.map(me=>({...me.task,versions:[me.version]}))):null,w==="pending_hos"?nf(Y.map(me=>({...me.task,versions:[me.version]}))):null,w==="rejected_hod"?Kg(U):null,w==="rejected_hos"?Kg(J):null,w==="upload_ratio"?nf(j.filter(me=>{var H;return(H=me.versions)==null?void 0:H.length})):null,w==="acceptance_rate"?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(zt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-emerald-600",children:[be.acceptedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]}),c.jsxs(zt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-red-600",children:[be.rejectedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Rejection"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/70 dark:text-white/70 mb-2",children:"Rejection classes"}),be.classes.length?c.jsx("div",{className:"space-y-2",children:be.classes.map(([me,H])=>c.jsx("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:me}),c.jsx("span",{children:H})]})},me))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection data."})]})]}):null,w==="response_time"?Wq(K):null,w==="pending_reviews"?Hq(F.reviews||[]):null]}),c.jsx(Ns,{open:re,onClose:()=>g(null),title:y?`${y} Details`:"Videographer",maxWidth:"980px",children:y&&ee?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(zt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold",children:[ee.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance rate"})]}),c.jsxs(zt,{className:"p-4 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:ee.late}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Late tasks"})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[c.jsx(In,{icon:wh,label:"Pending",value:Ii(z).pending,accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200"}),c.jsx(In,{icon:kh,label:"Rejected",value:Ii(z).rejected,accentClass:"bg-red-500/10 text-red-700 dark:text-red-200"}),c.jsx(In,{icon:bh,label:"Accepted",value:Ii(z).accepted,accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200"})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(sl,{title:"Version Distribution",children:c.jsx(rl,{type:"bar",data:JS(Ii(z)),options:{maintainAspectRatio:!1,indexAxis:"y"}})}),c.jsx(sl,{title:"All Tasks Status",children:c.jsx(rl,{type:"pie",data:{labels:Object.keys(tf(z)),datasets:[{data:Object.values(tf(z)),backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(sl,{title:"Overdue Tasks",children:c.jsx(rl,{type:"pie",data:{labels:Object.keys(tf(z.filter(_g))),datasets:[{data:Object.values(tf(z.filter(_g))),backgroundColor:[Fn.pending,Fn.rejected,Fn.returned,Fn.submitted,Fn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})}),c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Failure Analysis"})}),c.jsx(Qt,{children:Kg(kg(z,"hod"))})]})]}),c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Version History"})}),c.jsx(Qt,{children:nf(z)})]})]}):null}),c.jsx(Ns,{open:f,onClose:()=>p(!1),title:"Select date range",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Start date"}),c.jsx("input",{type:"date",value:l,onChange:me=>u(me.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"End date"}),c.jsx("input",{type:"date",value:d,onChange:me=>h(me.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!1),children:"Cancel"}),c.jsx(se,{className:"rounded-2xl",onClick:()=>p(!1),children:"Apply"})]})]})})]})}function qq(){const[t,e]=v.useState("chat");return c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 py-1",children:[c.jsx(se,{variant:t==="chat"?"default":"ghost",className:`rounded-2xl mmg-tab-btn ${t==="chat"?"mmg-tab-btn-active":""}`,onClick:()=>e("chat"),children:"Chat"}),c.jsx(se,{variant:t==="dashboard"?"default":"ghost",className:`rounded-2xl mmg-tab-btn ${t==="dashboard"?"mmg-tab-btn-active":""}`,onClick:()=>e("dashboard"),children:"Dashboard"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="chat"?"h-full":"hidden","aria-hidden":t!=="chat",children:c.jsx(BH,{})}),c.jsx("div",{className:t==="dashboard"?"h-full overflow-y-auto px-2 py-1":"hidden","aria-hidden":t!=="dashboard",children:c.jsx(Vq,{})})]})]})}function Kq(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function ZS(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function e1(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function Gq({locations:t,locationsQuery:e}){var b;const[n,s]=v.useState(null),[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),[d,h]=v.useState(""),f=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.display_type)||"";S&&_.add(S)}),[{value:"",label:"All display types"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),p=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.company_schema)||"";S&&_.add(S)}),[{value:"",label:"All companies"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),w=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.series)||"";S&&_.add(S)}),[{value:"",label:"All series"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),x=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=r.trim().toLowerCase();return k.filter(S=>!(o&&((S==null?void 0:S.display_type)||"")!==o||l&&((S==null?void 0:S.company_schema)||"")!==l||d&&((S==null?void 0:S.series)||"")!==d||_&&!Kq(S).includes(_))).map((S,j)=>({id:(S==null?void 0:S.location_key)||`location-${j}`,raw:S}))},[t,o,l,d,r]),y=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;k.forEach(j=>{Object.keys(j||{}).forEach(E=>_.add(E))});const C=["display_name","location_key","display_type","company_schema","series","city","area","upload_fee","height","width","number_of_faces","spot_duration","loop_duration","sov_percent","eligible_for_proposals","eligible_for_mockups"],S=Array.from(_).filter(j=>!C.includes(j)).sort();return[...C.filter(j=>_.has(j)),...S]},[t]),g=v.useMemo(()=>n?Object.entries(n):[],[n]),m=n||null;return c.jsxs(c.Fragment,{children:[c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Gt,{className:"space-y-1",children:[c.jsx(Yt,{children:"Locations"}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[x.length," location",x.length===1?"":"s"]})]}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-4 md:shrink-0",children:[c.jsx(No,{value:r,onChange:k=>i(k.target.value),className:"w-full",placeholder:"Search locations..."}),c.jsx(ot,{value:o,options:f,onChange:a,className:"w-full"}),c.jsx(ot,{value:l,options:p,onChange:u,className:"w-full"}),c.jsx(ot,{value:d,options:w,onChange:h,className:"w-full"})]}),e.isLoading?c.jsx(Ve,{text:"Loading locations",className:"text-sm text-black/60 dark:text-white/65"}):e.isError?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:((b=e.error)==null?void 0:b.message)||"Failed to load locations."}):x.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsxs("tr",{children:[y.map(k=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:ZS(k)},k)),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:x.map(k=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[y.map(_=>{var S;const C=e1((S=k.raw)==null?void 0:S[_]);return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:C},`${k.id}-${_}`)}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:c.jsx(se,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>s(k.raw),children:"Edit"})})]},k.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No locations found."})]})]}),c.jsx(Ns,{open:!!n,onClose:()=>s(null),title:"Edit location",maxWidth:"560px",children:m?c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ee,{label:"Location Key",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.location_key||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_name||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Display Type",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_type||"",disabled:!0,readOnly:!0})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Ee,{label:"Company",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.company_schema||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Series",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.series||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"City",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.city||"",disabled:!0,readOnly:!0})}),c.jsx(Ee,{label:"Area",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.area||"",disabled:!0,readOnly:!0})})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(se,{variant:"ghost",className:"rounded-2xl",onClick:()=>s(null),children:"Close"}),c.jsx(se,{className:"rounded-2xl",disabled:!0,children:"Save"})]}),c.jsxs("div",{className:"pt-2",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60 mb-2",children:"All fields"}),c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 divide-y divide-black/5 dark:divide-white/10",children:g.map(([k,_])=>c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 px-3 py-2 text-sm",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/45 dark:text-white/55 md:w-56",children:ZS(k)}),c.jsx("div",{className:"text-black/80 dark:text-white/85 break-all",children:e1(_)})]},k))})]})]}):null})]})}function Yq(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function Qq(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function Xq(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function mm({title:t,items:e,itemsQuery:n,itemLabel:s="item",searchPlaceholder:r="Search...",emptyMessage:i="No items found.",preferredColumns:o=[],stringKey:a="value"}){var y;const[l,u]=v.useState(""),d=v.useMemo(()=>(Array.isArray(e)?e:[]).map(m=>m==null?{[a]:""}:typeof m=="string"||typeof m=="number"||typeof m=="boolean"?{[a]:m}:m),[e,a]),h=v.useMemo(()=>{const g=new Set;d.forEach(b=>{Object.keys(b||{}).forEach(k=>g.add(k))});const m=Array.from(g).filter(b=>!o.includes(b)).sort();return[...o.filter(b=>g.has(b)),...m]},[d,o]),f=v.useMemo(()=>{const g=l.trim().toLowerCase();return d.filter(b=>g?Yq(b).includes(g):!0).map((b,k)=>({id:(b==null?void 0:b.id)??(b==null?void 0:b[a])??`row-${k}`,raw:b}))},[d,l,a]),p=n==null?void 0:n.isLoading,w=n==null?void 0:n.isError,x=((y=n==null?void 0:n.error)==null?void 0:y.message)||"Failed to load data.";return c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Gt,{className:"space-y-1",children:[c.jsx(Yt,{children:t}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[f.length," ",s,f.length===1?"":"s"]})]}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsx(No,{value:l,onChange:g=>u(g.target.value),className:"w-full md:shrink-0",placeholder:r}),p?c.jsx(Ve,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):w?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:x}):f.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsx("tr",{children:h.map(g=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:Qq(g)},g))})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:f.map(g=>c.jsx("tr",{className:"text-black/80 dark:text-white/85",children:h.map(m=>{var b;return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:Xq((b=g.raw)==null?void 0:b[m])},`${g.id}-${m}`)})},g.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:i})]})]})}function Jq({networks:t,networksQuery:e}){return c.jsx(mm,{title:"Networks",items:t,itemsQuery:e,itemLabel:"network",searchPlaceholder:"Search networks...",emptyMessage:"No networks found.",preferredColumns:["network_name","name","company","company_schema","is_active","location_count"]})}function Zq({assetTypes:t,assetTypesQuery:e}){return c.jsx(mm,{title:"Asset Types",items:t,itemsQuery:e,itemLabel:"type",searchPlaceholder:"Search asset types...",emptyMessage:"No asset types found.",preferredColumns:["name","type_key","company","network_id","is_active","location_count"]})}function e7({networkAssets:t,networkAssetsQuery:e}){return c.jsx(mm,{title:"Network Assets",items:t,itemsQuery:e,itemLabel:"asset",searchPlaceholder:"Search assets...",emptyMessage:"No network assets found.",preferredColumns:["display_name","asset_key","location_key","network_id","type_id","company","is_active"]})}function t7({packages:t,packagesQuery:e}){return c.jsx(mm,{title:"Packages",items:t,itemsQuery:e,itemLabel:"package",searchPlaceholder:"Search packages...",emptyMessage:"No packages found.",preferredColumns:["name","company","is_active"]})}const n7=[{key:"networks",label:"Networks",disabled:!1},{key:"asset-types",label:"Asset Types",disabled:!1},{key:"network-assets",label:"Network Assets",disabled:!1},{key:"packages",label:"Packages",disabled:!1},{key:"locations",label:"Locations",disabled:!1}];function Vc(t,e=[]){if(Array.isArray(t))return t;for(const n of e)if(Array.isArray(t==null?void 0:t[n]))return t[n];return Array.isArray(t==null?void 0:t.data)?t.data:[]}function s7(){const{user:t}=pi(),[e,n]=v.useState("networks");if(!Rd(t))return c.jsxs(St,{children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Restricted"})}),c.jsx(Qt,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to asset management."})]});const s=Kt({queryKey:["asset-management","networks"],queryFn:()=>I4(),enabled:e==="networks"}),r=Kt({queryKey:["asset-management","asset-types"],queryFn:()=>D4(),enabled:e==="asset-types"}),i=Kt({queryKey:["asset-management","network-assets"],queryFn:()=>L4(),enabled:e==="network-assets"}),o=Kt({queryKey:["asset-management","packages"],queryFn:()=>F4(),enabled:e==="packages"}),a=Kt({queryKey:["asset-management","locations"],queryFn:()=>$4(),enabled:e==="locations"}),l=v.useMemo(()=>Vc(s.data,["networks"]),[s.data]),u=v.useMemo(()=>Vc(r.data,["asset_types","types"]),[r.data]),d=v.useMemo(()=>Vc(i.data,["network_assets","assets"]),[i.data]),h=v.useMemo(()=>Vc(o.data,["packages"]),[o.data]),f=v.useMemo(()=>Vc(a.data,["locations"]),[a.data]);return c.jsxs("div",{className:"flex h-full min-h-0 min-w-0 flex-col gap-4",children:[c.jsx("div",{className:"flex items-center gap-2 overflow-x-auto py-1",children:n7.map(p=>c.jsx(se,{variant:e===p.key?"default":"ghost",onClick:()=>n(p.key),className:`rounded-2xl shrink-0 mmg-tab-btn ${e===p.key?"mmg-tab-btn-active":""}`,disabled:p.disabled,title:p.disabled?"Coming soon":void 0,children:p.label},p.key))}),c.jsxs("div",{className:"flex-1 min-h-0 min-w-0",children:[e==="networks"?c.jsx("div",{className:"h-full",children:c.jsx(Jq,{networks:l,networksQuery:s})}):null,e==="asset-types"?c.jsx("div",{className:"h-full",children:c.jsx(Zq,{assetTypes:u,assetTypesQuery:r})}):null,e==="network-assets"?c.jsx("div",{className:"h-full",children:c.jsx(e7,{networkAssets:d,networkAssetsQuery:i})}):null,e==="packages"?c.jsx("div",{className:"h-full",children:c.jsx(t7,{packages:h,packagesQuery:o})}):null,e==="locations"?c.jsx("div",{className:"h-full",children:c.jsx(Gq,{locations:f,locationsQuery:a})}):null]})]})}function r7({children:t}){const{user:e,authReady:n,session:s,pendingAccess:r,logout:i}=pi(),o=fc();return!n||s&&!e?(console.log("[ProtectedRoute] Waiting for auth",{authReady:n,hasSession:!!s,hasUser:!!e}),null):(console.log("[ProtectedRoute] Auth ready, rendering children",{user:e==null?void 0:e.email}),r?c.jsx(zN,{email:r.email,message:r.message,onSignOut:i}):e?t:c.jsx(xf,{to:"/login",replace:!0,state:{from:o.pathname}}))}function i7(){const t="mmg-brand-theme",[e,n]=v.useState("none");v.useEffect(()=>{if(typeof window>"u")return;const i=window.localStorage.getItem(t)||"none";n(i),i==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",i)},[]);const s=r=>{n(r),typeof window<"u"&&window.localStorage.setItem(t,r),r==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",r)};return c.jsx("div",{className:"h-full min-h-0",children:c.jsxs(St,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Gt,{children:c.jsx(Yt,{children:"Settings"})}),c.jsxs(Qt,{className:"flex-1 min-h-0 overflow-y-auto pt-1 text-sm text-black/60 dark:text-white/65 space-y-4",children:[c.jsxs(zt,{className:"flex items-center justify-between p-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle dark / light mode"})]}),c.jsx(BN,{})]}),c.jsxs(zt,{className:"space-y-3 p-4",children:[c.jsx("div",{className:"flex items-center justify-between gap-4",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Color theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Choose a color palette that layers on top of light / dark mode."})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2",children:[c.jsx("button",{type:"button",onClick:()=>s("none"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="none"?"border-black/60 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:c.jsx("span",{className:"font-medium",children:"System default"})}),c.jsxs("button",{type:"button",onClick:()=>s("blue"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="blue"?"border-blue-500/80 bg-blue-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Blue"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#007AFF]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("green"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="green"?"border-emerald-500/80 bg-emerald-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Green"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#0F806B]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("orange"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="orange"?"border-orange-500/80 bg-orange-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Orange"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#FF7900]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("gold"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="gold"?"border-amber-500/80 bg-amber-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Gold"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#CA9E2C]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("brand"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="brand"?"border-black/70 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Brand Theme"}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#000000]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#007AFF]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#CA9E2C]"})]})]})]})]})]})]})})}function o7(){return c.jsxs(eM,{children:[c.jsx(Dn,{path:"/",element:c.jsx(xf,{to:"/login",replace:!0})}),c.jsx(Dn,{path:"/login",element:c.jsx(R5,{})}),c.jsx(Dn,{path:"/auth/callback",element:c.jsx(A5,{})}),c.jsxs(Dn,{path:"/app",element:c.jsx(r7,{children:c.jsx(q4,{})}),children:[c.jsx(Dn,{index:!0,element:c.jsx(xf,{to:"chat",replace:!0})}),c.jsx(Dn,{path:"chat",element:c.jsx(y6,{})}),c.jsx(Dn,{path:"video-critique",element:c.jsx(qq,{})}),c.jsx(Dn,{path:"mockup",element:c.jsx(Y6,{})}),c.jsx(Dn,{path:"proposals",element:c.jsx(dH,{})}),c.jsx(Dn,{path:"notifications",element:c.jsx(zH,{})}),c.jsx(Dn,{path:"admin",element:c.jsx($H,{})}),c.jsx(Dn,{path:"asset-management",element:c.jsx(s7,{})}),c.jsx(Dn,{path:"settings",element:c.jsx(i7,{})})]}),c.jsx(Dn,{path:"*",element:c.jsx(xf,{to:"/login",replace:!0})})]})}function a7(){if(!(typeof window>"u"))try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=e.createOscillator(),s=e.createGain();n.type="sine",n.frequency.value=740,s.gain.value=.15,n.connect(s),s.connect(e.destination),n.start(),s.gain.exponentialRampToValueAtTime(.001,e.currentTime+.25),n.stop(e.currentTime+.3),n.onended=()=>{e.close()}}catch{}}function l7(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?"":e.toLocaleString()}function c7({children:t}){const[e,n]=v.useState([]),[s,r]=v.useState(!0),[i,o]=v.useState([]),a=v.useRef(new Set),l=v.useRef(!1),u=v.useRef(new Map),d=v.useCallback(async()=>{r(!0);const b=await e4();n(Array.isArray(b)?b:[]),r(!1)},[]),h=v.useCallback(async()=>{await n4(),n([])},[]),f=v.useCallback(async b=>{b&&(await s4(b),n(k=>k.filter(_=>_.id!==b)))},[]),p=v.useCallback(async b=>{b&&(await r4(b),n(k=>k.map(_=>_.id===b?{..._,read:!0}:_)))},[]),w=v.useCallback(async b=>{const k=await t4(b);return n(_=>[k,..._]),k},[]),x=v.useCallback(b=>{o(_=>_.filter(C=>C.id!==b));const k=u.current.get(b);k&&(clearTimeout(k),u.current.delete(b))},[]),y=v.useCallback(b=>{if(!(b!=null&&b.id))return;o(_=>[..._,{id:b.id,notification:b}]);const k=setTimeout(()=>x(b.id),4200);u.current.set(b.id,k)},[x]);v.useEffect(()=>{d()},[d]),v.useEffect(()=>{if(!l.current){e.forEach(k=>a.current.add(k.id)),l.current=!0;return}const b=e.filter(k=>k.id&&!a.current.has(k.id));b.length&&(a7(),b.forEach(k=>{a.current.add(k.id),y(k)}))},[e,y]),v.useEffect(()=>{if(typeof window>"u")return;const b=k=>{k.key===i4&&d()};return window.addEventListener("storage",b),()=>window.removeEventListener("storage",b)},[d]),v.useEffect(()=>{if(!(typeof window>"u"))return window.mmgNotify=b=>w(b),window.mmgNotifications={add:b=>w(b),clear:h,dismiss:f,markRead:p},()=>{delete window.mmgNotify,delete window.mmgNotifications}},[w,h,f,p]);const g=v.useMemo(()=>e.filter(b=>!b.read).length,[e]),m=v.useMemo(()=>({notifications:e,loading:s,unreadCount:g,toasts:i,addNotification:w,clearAll:h,dismissNotification:f,markRead:p,dismissToast:x,formatTime:l7}),[e,s,g,i,w,h,f,p,x]);return c.jsx(p2.Provider,{value:m,children:t})}const u7="mmg-brand-theme";if(typeof window<"u"){const t=window.localStorage.getItem(u7);t&&t!=="none"?document.body.setAttribute("data-brand-theme",t):document.body.removeAttribute("data-brand-theme"),window.addEventListener("wheel",e=>{const n=e.target;n instanceof HTMLInputElement&&n.type==="number"&&n===document.activeElement&&e.preventDefault()},{passive:!1})}const d7=new IM({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});Gg.createRoot(document.getElementById("root")).render(c.jsx(ve.StrictMode,{children:c.jsx(aM,{attribute:"class",defaultTheme:"light",enableSystem:!1,children:c.jsx(DM,{client:d7,children:c.jsx(T5,{children:c.jsx(c7,{children:c.jsx(sM,{children:c.jsx(o7,{})})})})})})}));
