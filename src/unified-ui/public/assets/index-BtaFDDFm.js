var mP=Object.defineProperty;var sb=t=>{throw TypeError(t)};var gP=(t,e,n)=>e in t?mP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $e=(t,e,n)=>gP(t,typeof e!="symbol"?e+"":e,n),gm=(t,e,n)=>e.has(t)||sb("Cannot "+n);var M=(t,e,n)=>(gm(t,e,"read from private field"),n?n.call(t):e.get(t)),ke=(t,e,n)=>e.has(t)?sb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),ue=(t,e,n,s)=>(gm(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n),Fe=(t,e,n)=>(gm(t,e,"access private method"),n);var Kd=(t,e,n,s)=>({set _(r){ue(t,e,r,n)},get _(){return M(t,e,s)}});function xP(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function QS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var XS={exports:{}},wp={},JS={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hd=Symbol.for("react.element"),yP=Symbol.for("react.portal"),vP=Symbol.for("react.fragment"),bP=Symbol.for("react.strict_mode"),wP=Symbol.for("react.profiler"),kP=Symbol.for("react.provider"),_P=Symbol.for("react.context"),SP=Symbol.for("react.forward_ref"),jP=Symbol.for("react.suspense"),CP=Symbol.for("react.memo"),NP=Symbol.for("react.lazy"),rb=Symbol.iterator;function EP(t){return t===null||typeof t!="object"?null:(t=rb&&t[rb]||t["@@iterator"],typeof t=="function"?t:null)}var ZS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e1=Object.assign,t1={};function ec(t,e,n){this.props=t,this.context=e,this.refs=t1,this.updater=n||ZS}ec.prototype.isReactComponent={};ec.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ec.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function n1(){}n1.prototype=ec.prototype;function By(t,e,n){this.props=t,this.context=e,this.refs=t1,this.updater=n||ZS}var Uy=By.prototype=new n1;Uy.constructor=By;e1(Uy,ec.prototype);Uy.isPureReactComponent=!0;var ib=Array.isArray,s1=Object.prototype.hasOwnProperty,Hy={current:null},r1={key:!0,ref:!0,__self:!0,__source:!0};function i1(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)s1.call(e,s)&&!r1.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:hd,type:t,key:i,ref:o,props:r,_owner:Hy.current}}function TP(t,e){return{$$typeof:hd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Wy(t){return typeof t=="object"&&t!==null&&t.$$typeof===hd}function PP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ob=/\/+/g;function xm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?PP(""+t.key):e.toString(36)}function Qh(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case hd:case yP:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+xm(o,0):s,ib(r)?(n="",t!=null&&(n=t.replace(ob,"$&/")+"/"),Qh(r,e,n,"",function(u){return u})):r!=null&&(Wy(r)&&(r=TP(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(ob,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",ib(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+xm(i,a);o+=Qh(i,e,n,l,r)}else if(l=EP(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+xm(i,a++),o+=Qh(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gd(t,e,n){if(t==null)return t;var s=[],r=0;return Qh(t,s,"","",function(i){return e.call(n,i,r++)}),s}function RP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Fn={current:null},Xh={transition:null},AP={ReactCurrentDispatcher:Fn,ReactCurrentBatchConfig:Xh,ReactCurrentOwner:Hy};function o1(){throw Error("act(...) is not supported in production builds of React.")}Je.Children={map:Gd,forEach:function(t,e,n){Gd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Gd(t,function(){e++}),e},toArray:function(t){return Gd(t,function(e){return e})||[]},only:function(t){if(!Wy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Je.Component=ec;Je.Fragment=vP;Je.Profiler=wP;Je.PureComponent=By;Je.StrictMode=bP;Je.Suspense=jP;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AP;Je.act=o1;Je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=e1({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Hy.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)s1.call(e,l)&&!r1.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:hd,type:t.type,key:r,ref:i,props:s,_owner:o}};Je.createContext=function(t){return t={$$typeof:_P,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kP,_context:t},t.Consumer=t};Je.createElement=i1;Je.createFactory=function(t){var e=i1.bind(null,t);return e.type=t,e};Je.createRef=function(){return{current:null}};Je.forwardRef=function(t){return{$$typeof:SP,render:t}};Je.isValidElement=Wy;Je.lazy=function(t){return{$$typeof:NP,_payload:{_status:-1,_result:t},_init:RP}};Je.memo=function(t,e){return{$$typeof:CP,type:t,compare:e===void 0?null:e}};Je.startTransition=function(t){var e=Xh.transition;Xh.transition={};try{t()}finally{Xh.transition=e}};Je.unstable_act=o1;Je.useCallback=function(t,e){return Fn.current.useCallback(t,e)};Je.useContext=function(t){return Fn.current.useContext(t)};Je.useDebugValue=function(){};Je.useDeferredValue=function(t){return Fn.current.useDeferredValue(t)};Je.useEffect=function(t,e){return Fn.current.useEffect(t,e)};Je.useId=function(){return Fn.current.useId()};Je.useImperativeHandle=function(t,e,n){return Fn.current.useImperativeHandle(t,e,n)};Je.useInsertionEffect=function(t,e){return Fn.current.useInsertionEffect(t,e)};Je.useLayoutEffect=function(t,e){return Fn.current.useLayoutEffect(t,e)};Je.useMemo=function(t,e){return Fn.current.useMemo(t,e)};Je.useReducer=function(t,e,n){return Fn.current.useReducer(t,e,n)};Je.useRef=function(t){return Fn.current.useRef(t)};Je.useState=function(t){return Fn.current.useState(t)};Je.useSyncExternalStore=function(t,e,n){return Fn.current.useSyncExternalStore(t,e,n)};Je.useTransition=function(){return Fn.current.useTransition()};Je.version="18.3.1";JS.exports=Je;var v=JS.exports;const ge=QS(v),kp=xP({__proto__:null,default:ge},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OP=v,MP=Symbol.for("react.element"),IP=Symbol.for("react.fragment"),DP=Object.prototype.hasOwnProperty,LP=OP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$P={key:!0,ref:!0,__self:!0,__source:!0};function a1(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)DP.call(e,s)&&!$P.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:MP,type:t,key:i,ref:o,props:r,_owner:LP.current}}wp.Fragment=IP;wp.jsx=a1;wp.jsxs=a1;XS.exports=wp;var c=XS.exports,Fg={},l1={exports:{}},Ss={},c1={exports:{}},u1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,E){var F=N.length;N.push(E);e:for(;0<F;){var V=F-1>>>1,H=N[V];if(0<r(H,E))N[V]=E,N[F]=H,F=V;else break e}}function n(N){return N.length===0?null:N[0]}function s(N){if(N.length===0)return null;var E=N[0],F=N.pop();if(F!==E){N[0]=F;e:for(var V=0,H=N.length,he=H>>>1;V<he;){var ee=2*(V+1)-1,U=N[ee],Q=ee+1,de=N[Q];if(0>r(U,F))Q<H&&0>r(de,U)?(N[V]=de,N[Q]=F,V=Q):(N[V]=U,N[ee]=F,V=ee);else if(Q<H&&0>r(de,F))N[V]=de,N[Q]=F,V=Q;else break e}}return E}function r(N,E){var F=N.sortIndex-E.sortIndex;return F!==0?F:N.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,h=null,f=3,p=!1,w=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(N){for(var E=n(u);E!==null;){if(E.callback===null)s(u);else if(E.startTime<=N)s(u),E.sortIndex=E.expirationTime,e(l,E);else break;E=n(u)}}function k(N){if(x=!1,b(N),!w)if(n(l)!==null)w=!0,A(_);else{var E=n(u);E!==null&&W(k,E.startTime-N)}}function _(N,E){w=!1,x&&(x=!1,g(j),j=-1),p=!0;var F=f;try{for(b(E),h=n(l);h!==null&&(!(h.expirationTime>E)||N&&!L());){var V=h.callback;if(typeof V=="function"){h.callback=null,f=h.priorityLevel;var H=V(h.expirationTime<=E);E=t.unstable_now(),typeof H=="function"?h.callback=H:h===n(l)&&s(l),b(E)}else s(l);h=n(l)}if(h!==null)var he=!0;else{var ee=n(u);ee!==null&&W(k,ee.startTime-E),he=!1}return he}finally{h=null,f=F,p=!1}}var C=!1,S=null,j=-1,T=5,P=-1;function L(){return!(t.unstable_now()-P<T)}function D(){if(S!==null){var N=t.unstable_now();P=N;var E=!0;try{E=S(!0,N)}finally{E?O():(C=!1,S=null)}}else C=!1}var O;if(typeof m=="function")O=function(){m(D)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,I=$.port2;$.port1.onmessage=D,O=function(){I.postMessage(null)}}else O=function(){y(D,0)};function A(N){S=N,C||(C=!0,O())}function W(N,E){j=y(function(){N(t.unstable_now())},E)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){w||p||(w=!0,A(_))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(N){switch(f){case 1:case 2:case 3:var E=3;break;default:E=f}var F=f;f=E;try{return N()}finally{f=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,E){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var F=f;f=N;try{return E()}finally{f=F}},t.unstable_scheduleCallback=function(N,E,F){var V=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?V+F:V):F=V,N){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=F+H,N={id:d++,callback:E,priorityLevel:N,startTime:F,expirationTime:H,sortIndex:-1},F>V?(N.sortIndex=F,e(u,N),n(l)===null&&N===n(u)&&(x?(g(j),j=-1):x=!0,W(k,F-V))):(N.sortIndex=H,e(l,N),w||p||(w=!0,A(_))),N},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(N){var E=f;return function(){var F=f;f=E;try{return N.apply(this,arguments)}finally{f=F}}}})(u1);c1.exports=u1;var FP=c1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zP=v,_s=FP;function re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d1=new Set,pu={};function va(t,e){Vl(t,e),Vl(t+"Capture",e)}function Vl(t,e){for(pu[t]=e,t=0;t<e.length;t++)d1.add(e[t])}var ni=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zg=Object.prototype.hasOwnProperty,BP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ab={},lb={};function UP(t){return zg.call(lb,t)?!0:zg.call(ab,t)?!1:BP.test(t)?lb[t]=!0:(ab[t]=!0,!1)}function HP(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function WP(t,e,n,s){if(e===null||typeof e>"u"||HP(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zn(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){bn[t]=new zn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];bn[e]=new zn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){bn[t]=new zn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){bn[t]=new zn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){bn[t]=new zn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){bn[t]=new zn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){bn[t]=new zn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){bn[t]=new zn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){bn[t]=new zn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vy=/[\-:]([a-z])/g;function qy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vy,qy);bn[e]=new zn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vy,qy);bn[e]=new zn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vy,qy);bn[e]=new zn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){bn[t]=new zn(t,1,!1,t.toLowerCase(),null,!1,!1)});bn.xlinkHref=new zn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){bn[t]=new zn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ky(t,e,n,s){var r=bn.hasOwnProperty(e)?bn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(WP(e,n,r,s)&&(n=null),s||r===null?UP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var ui=zP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yd=Symbol.for("react.element"),Za=Symbol.for("react.portal"),el=Symbol.for("react.fragment"),Gy=Symbol.for("react.strict_mode"),Bg=Symbol.for("react.profiler"),h1=Symbol.for("react.provider"),f1=Symbol.for("react.context"),Yy=Symbol.for("react.forward_ref"),Ug=Symbol.for("react.suspense"),Hg=Symbol.for("react.suspense_list"),Qy=Symbol.for("react.memo"),bi=Symbol.for("react.lazy"),p1=Symbol.for("react.offscreen"),cb=Symbol.iterator;function kc(t){return t===null||typeof t!="object"?null:(t=cb&&t[cb]||t["@@iterator"],typeof t=="function"?t:null)}var Wt=Object.assign,ym;function zc(t){if(ym===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ym=e&&e[1]||""}return`
`+ym+t}var vm=!1;function bm(t,e){if(!t||vm)return"";vm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{vm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?zc(t):""}function VP(t){switch(t.tag){case 5:return zc(t.type);case 16:return zc("Lazy");case 13:return zc("Suspense");case 19:return zc("SuspenseList");case 0:case 2:case 15:return t=bm(t.type,!1),t;case 11:return t=bm(t.type.render,!1),t;case 1:return t=bm(t.type,!0),t;default:return""}}function Wg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case el:return"Fragment";case Za:return"Portal";case Bg:return"Profiler";case Gy:return"StrictMode";case Ug:return"Suspense";case Hg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case f1:return(t.displayName||"Context")+".Consumer";case h1:return(t._context.displayName||"Context")+".Provider";case Yy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Qy:return e=t.displayName||null,e!==null?e:Wg(t.type)||"Memo";case bi:e=t._payload,t=t._init;try{return Wg(t(e))}catch{}}return null}function qP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wg(e);case 8:return e===Gy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function so(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function m1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function KP(t){var e=m1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Qd(t){t._valueTracker||(t._valueTracker=KP(t))}function g1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=m1(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Sf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vg(t,e){var n=e.checked;return Wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ub(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=so(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function x1(t,e){e=e.checked,e!=null&&Ky(t,"checked",e,!1)}function qg(t,e){x1(t,e);var n=so(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Kg(t,e.type,so(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function db(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Kg(t,e,n){(e!=="number"||Sf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Bc=Array.isArray;function pl(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+so(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Gg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(re(91));return Wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function hb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(re(92));if(Bc(n)){if(1<n.length)throw Error(re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:so(n)}}function y1(t,e){var n=so(e.value),s=so(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function fb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function v1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?v1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Xd,b1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Xd=Xd||document.createElement("div"),Xd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function mu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Jc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GP=["Webkit","ms","Moz","O"];Object.keys(Jc).forEach(function(t){GP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Jc[e]=Jc[t]})});function w1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Jc.hasOwnProperty(t)&&Jc[t]?(""+e).trim():e+"px"}function k1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=w1(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var YP=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qg(t,e){if(e){if(YP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(re(62))}}function Xg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jg=null;function Xy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Zg=null,ml=null,gl=null;function pb(t){if(t=md(t)){if(typeof Zg!="function")throw Error(re(280));var e=t.stateNode;e&&(e=Np(e),Zg(t.stateNode,t.type,e))}}function _1(t){ml?gl?gl.push(t):gl=[t]:ml=t}function S1(){if(ml){var t=ml,e=gl;if(gl=ml=null,pb(t),e)for(t=0;t<e.length;t++)pb(e[t])}}function j1(t,e){return t(e)}function C1(){}var wm=!1;function N1(t,e,n){if(wm)return t(e,n);wm=!0;try{return j1(t,e,n)}finally{wm=!1,(ml!==null||gl!==null)&&(C1(),S1())}}function gu(t,e){var n=t.stateNode;if(n===null)return null;var s=Np(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(re(231,e,typeof n));return n}var ex=!1;if(ni)try{var _c={};Object.defineProperty(_c,"passive",{get:function(){ex=!0}}),window.addEventListener("test",_c,_c),window.removeEventListener("test",_c,_c)}catch{ex=!1}function QP(t,e,n,s,r,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Zc=!1,jf=null,Cf=!1,tx=null,XP={onError:function(t){Zc=!0,jf=t}};function JP(t,e,n,s,r,i,o,a,l){Zc=!1,jf=null,QP.apply(XP,arguments)}function ZP(t,e,n,s,r,i,o,a,l){if(JP.apply(this,arguments),Zc){if(Zc){var u=jf;Zc=!1,jf=null}else throw Error(re(198));Cf||(Cf=!0,tx=u)}}function ba(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function E1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function mb(t){if(ba(t)!==t)throw Error(re(188))}function eR(t){var e=t.alternate;if(!e){if(e=ba(t),e===null)throw Error(re(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return mb(r),t;if(i===s)return mb(r),e;i=i.sibling}throw Error(re(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(re(189))}}if(n.alternate!==s)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?t:e}function T1(t){return t=eR(t),t!==null?P1(t):null}function P1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=P1(t);if(e!==null)return e;t=t.sibling}return null}var R1=_s.unstable_scheduleCallback,gb=_s.unstable_cancelCallback,tR=_s.unstable_shouldYield,nR=_s.unstable_requestPaint,Qt=_s.unstable_now,sR=_s.unstable_getCurrentPriorityLevel,Jy=_s.unstable_ImmediatePriority,A1=_s.unstable_UserBlockingPriority,Nf=_s.unstable_NormalPriority,rR=_s.unstable_LowPriority,O1=_s.unstable_IdlePriority,_p=null,Tr=null;function iR(t){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(_p,t,void 0,(t.current.flags&128)===128)}catch{}}var tr=Math.clz32?Math.clz32:lR,oR=Math.log,aR=Math.LN2;function lR(t){return t>>>=0,t===0?32:31-(oR(t)/aR|0)|0}var Jd=64,Zd=4194304;function Uc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ef(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Uc(a):(i&=o,i!==0&&(s=Uc(i)))}else o=n&~r,o!==0?s=Uc(o):i!==0&&(s=Uc(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-tr(e),r=1<<n,s|=t[n],e&=~r;return s}function cR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uR(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-tr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=cR(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function nx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function M1(){var t=Jd;return Jd<<=1,!(Jd&4194240)&&(Jd=64),t}function km(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-tr(e),t[e]=n}function dR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-tr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function Zy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-tr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var mt=0;function I1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var D1,ev,L1,$1,F1,sx=!1,eh=[],Wi=null,Vi=null,qi=null,xu=new Map,yu=new Map,_i=[],hR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xb(t,e){switch(t){case"focusin":case"focusout":Wi=null;break;case"dragenter":case"dragleave":Vi=null;break;case"mouseover":case"mouseout":qi=null;break;case"pointerover":case"pointerout":xu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":yu.delete(e.pointerId)}}function Sc(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=md(e),e!==null&&ev(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function fR(t,e,n,s,r){switch(e){case"focusin":return Wi=Sc(Wi,t,e,n,s,r),!0;case"dragenter":return Vi=Sc(Vi,t,e,n,s,r),!0;case"mouseover":return qi=Sc(qi,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return xu.set(i,Sc(xu.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,yu.set(i,Sc(yu.get(i)||null,t,e,n,s,r)),!0}return!1}function z1(t){var e=Fo(t.target);if(e!==null){var n=ba(e);if(n!==null){if(e=n.tag,e===13){if(e=E1(n),e!==null){t.blockedOn=e,F1(t.priority,function(){L1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Jh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=rx(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Jg=s,n.target.dispatchEvent(s),Jg=null}else return e=md(n),e!==null&&ev(e),t.blockedOn=n,!1;e.shift()}return!0}function yb(t,e,n){Jh(t)&&n.delete(e)}function pR(){sx=!1,Wi!==null&&Jh(Wi)&&(Wi=null),Vi!==null&&Jh(Vi)&&(Vi=null),qi!==null&&Jh(qi)&&(qi=null),xu.forEach(yb),yu.forEach(yb)}function jc(t,e){t.blockedOn===e&&(t.blockedOn=null,sx||(sx=!0,_s.unstable_scheduleCallback(_s.unstable_NormalPriority,pR)))}function vu(t){function e(r){return jc(r,t)}if(0<eh.length){jc(eh[0],t);for(var n=1;n<eh.length;n++){var s=eh[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Wi!==null&&jc(Wi,t),Vi!==null&&jc(Vi,t),qi!==null&&jc(qi,t),xu.forEach(e),yu.forEach(e),n=0;n<_i.length;n++)s=_i[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<_i.length&&(n=_i[0],n.blockedOn===null);)z1(n),n.blockedOn===null&&_i.shift()}var xl=ui.ReactCurrentBatchConfig,Tf=!0;function mR(t,e,n,s){var r=mt,i=xl.transition;xl.transition=null;try{mt=1,tv(t,e,n,s)}finally{mt=r,xl.transition=i}}function gR(t,e,n,s){var r=mt,i=xl.transition;xl.transition=null;try{mt=4,tv(t,e,n,s)}finally{mt=r,xl.transition=i}}function tv(t,e,n,s){if(Tf){var r=rx(t,e,n,s);if(r===null)Am(t,e,s,Pf,n),xb(t,s);else if(fR(r,t,e,n,s))s.stopPropagation();else if(xb(t,s),e&4&&-1<hR.indexOf(t)){for(;r!==null;){var i=md(r);if(i!==null&&D1(i),i=rx(t,e,n,s),i===null&&Am(t,e,s,Pf,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Am(t,e,s,null,n)}}var Pf=null;function rx(t,e,n,s){if(Pf=null,t=Xy(s),t=Fo(t),t!==null)if(e=ba(t),e===null)t=null;else if(n=e.tag,n===13){if(t=E1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Pf=t,null}function B1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sR()){case Jy:return 1;case A1:return 4;case Nf:case rR:return 16;case O1:return 536870912;default:return 16}default:return 16}}var Li=null,nv=null,Zh=null;function U1(){if(Zh)return Zh;var t,e=nv,n=e.length,s,r="value"in Li?Li.value:Li.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return Zh=r.slice(t,1<s?1-s:void 0)}function ef(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function th(){return!0}function vb(){return!1}function js(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?th:vb,this.isPropagationStopped=vb,this}return Wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=th)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=th)},persist:function(){},isPersistent:th}),e}var tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sv=js(tc),pd=Wt({},tc,{view:0,detail:0}),xR=js(pd),_m,Sm,Cc,Sp=Wt({},pd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Cc&&(Cc&&t.type==="mousemove"?(_m=t.screenX-Cc.screenX,Sm=t.screenY-Cc.screenY):Sm=_m=0,Cc=t),_m)},movementY:function(t){return"movementY"in t?t.movementY:Sm}}),bb=js(Sp),yR=Wt({},Sp,{dataTransfer:0}),vR=js(yR),bR=Wt({},pd,{relatedTarget:0}),jm=js(bR),wR=Wt({},tc,{animationName:0,elapsedTime:0,pseudoElement:0}),kR=js(wR),_R=Wt({},tc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),SR=js(_R),jR=Wt({},tc,{data:0}),wb=js(jR),CR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ER={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ER[t])?!!e[t]:!1}function rv(){return TR}var PR=Wt({},pd,{key:function(t){if(t.key){var e=CR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ef(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?NR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rv,charCode:function(t){return t.type==="keypress"?ef(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ef(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),RR=js(PR),AR=Wt({},Sp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kb=js(AR),OR=Wt({},pd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rv}),MR=js(OR),IR=Wt({},tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),DR=js(IR),LR=Wt({},Sp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$R=js(LR),FR=[9,13,27,32],iv=ni&&"CompositionEvent"in window,eu=null;ni&&"documentMode"in document&&(eu=document.documentMode);var zR=ni&&"TextEvent"in window&&!eu,H1=ni&&(!iv||eu&&8<eu&&11>=eu),_b=" ",Sb=!1;function W1(t,e){switch(t){case"keyup":return FR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function V1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var tl=!1;function BR(t,e){switch(t){case"compositionend":return V1(e);case"keypress":return e.which!==32?null:(Sb=!0,_b);case"textInput":return t=e.data,t===_b&&Sb?null:t;default:return null}}function UR(t,e){if(tl)return t==="compositionend"||!iv&&W1(t,e)?(t=U1(),Zh=nv=Li=null,tl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return H1&&e.locale!=="ko"?null:e.data;default:return null}}var HR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!HR[t.type]:e==="textarea"}function q1(t,e,n,s){_1(s),e=Rf(e,"onChange"),0<e.length&&(n=new sv("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var tu=null,bu=null;function WR(t){sj(t,0)}function jp(t){var e=rl(t);if(g1(e))return t}function VR(t,e){if(t==="change")return e}var K1=!1;if(ni){var Cm;if(ni){var Nm="oninput"in document;if(!Nm){var Cb=document.createElement("div");Cb.setAttribute("oninput","return;"),Nm=typeof Cb.oninput=="function"}Cm=Nm}else Cm=!1;K1=Cm&&(!document.documentMode||9<document.documentMode)}function Nb(){tu&&(tu.detachEvent("onpropertychange",G1),bu=tu=null)}function G1(t){if(t.propertyName==="value"&&jp(bu)){var e=[];q1(e,bu,t,Xy(t)),N1(WR,e)}}function qR(t,e,n){t==="focusin"?(Nb(),tu=e,bu=n,tu.attachEvent("onpropertychange",G1)):t==="focusout"&&Nb()}function KR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jp(bu)}function GR(t,e){if(t==="click")return jp(e)}function YR(t,e){if(t==="input"||t==="change")return jp(e)}function QR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rr=typeof Object.is=="function"?Object.is:QR;function wu(t,e){if(rr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!zg.call(e,r)||!rr(t[r],e[r]))return!1}return!0}function Eb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Tb(t,e){var n=Eb(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Eb(n)}}function Y1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Y1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Q1(){for(var t=window,e=Sf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Sf(t.document)}return e}function ov(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function XR(t){var e=Q1(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Y1(n.ownerDocument.documentElement,n)){if(s!==null&&ov(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=Tb(n,i);var o=Tb(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var JR=ni&&"documentMode"in document&&11>=document.documentMode,nl=null,ix=null,nu=null,ox=!1;function Pb(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ox||nl==null||nl!==Sf(s)||(s=nl,"selectionStart"in s&&ov(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),nu&&wu(nu,s)||(nu=s,s=Rf(ix,"onSelect"),0<s.length&&(e=new sv("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=nl)))}function nh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var sl={animationend:nh("Animation","AnimationEnd"),animationiteration:nh("Animation","AnimationIteration"),animationstart:nh("Animation","AnimationStart"),transitionend:nh("Transition","TransitionEnd")},Em={},X1={};ni&&(X1=document.createElement("div").style,"AnimationEvent"in window||(delete sl.animationend.animation,delete sl.animationiteration.animation,delete sl.animationstart.animation),"TransitionEvent"in window||delete sl.transitionend.transition);function Cp(t){if(Em[t])return Em[t];if(!sl[t])return t;var e=sl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in X1)return Em[t]=e[n];return t}var J1=Cp("animationend"),Z1=Cp("animationiteration"),ej=Cp("animationstart"),tj=Cp("transitionend"),nj=new Map,Rb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ho(t,e){nj.set(t,e),va(e,[t])}for(var Tm=0;Tm<Rb.length;Tm++){var Pm=Rb[Tm],ZR=Pm.toLowerCase(),eA=Pm[0].toUpperCase()+Pm.slice(1);ho(ZR,"on"+eA)}ho(J1,"onAnimationEnd");ho(Z1,"onAnimationIteration");ho(ej,"onAnimationStart");ho("dblclick","onDoubleClick");ho("focusin","onFocus");ho("focusout","onBlur");ho(tj,"onTransitionEnd");Vl("onMouseEnter",["mouseout","mouseover"]);Vl("onMouseLeave",["mouseout","mouseover"]);Vl("onPointerEnter",["pointerout","pointerover"]);Vl("onPointerLeave",["pointerout","pointerover"]);va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));va("onBeforeInput",["compositionend","keypress","textInput","paste"]);va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hc));function Ab(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,ZP(s,e,void 0,t),t.currentTarget=null}function sj(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;Ab(r,a,u),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;Ab(r,a,u),i=l}}}if(Cf)throw t=tx,Cf=!1,tx=null,t}function Ct(t,e){var n=e[dx];n===void 0&&(n=e[dx]=new Set);var s=t+"__bubble";n.has(s)||(rj(e,t,2,!1),n.add(s))}function Rm(t,e,n){var s=0;e&&(s|=4),rj(n,t,s,e)}var sh="_reactListening"+Math.random().toString(36).slice(2);function ku(t){if(!t[sh]){t[sh]=!0,d1.forEach(function(n){n!=="selectionchange"&&(tA.has(n)||Rm(n,!1,t),Rm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[sh]||(e[sh]=!0,Rm("selectionchange",!1,e))}}function rj(t,e,n,s){switch(B1(e)){case 1:var r=mR;break;case 4:r=gR;break;default:r=tv}n=r.bind(null,e,n,t),r=void 0,!ex||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Am(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Fo(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}N1(function(){var u=i,d=Xy(n),h=[];e:{var f=nj.get(t);if(f!==void 0){var p=sv,w=t;switch(t){case"keypress":if(ef(n)===0)break e;case"keydown":case"keyup":p=RR;break;case"focusin":w="focus",p=jm;break;case"focusout":w="blur",p=jm;break;case"beforeblur":case"afterblur":p=jm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=bb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=vR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=MR;break;case J1:case Z1:case ej:p=kR;break;case tj:p=DR;break;case"scroll":p=xR;break;case"wheel":p=$R;break;case"copy":case"cut":case"paste":p=SR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=kb}var x=(e&4)!==0,y=!x&&t==="scroll",g=x?f!==null?f+"Capture":null:f;x=[];for(var m=u,b;m!==null;){b=m;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,g!==null&&(k=gu(m,g),k!=null&&x.push(_u(m,k,b)))),y)break;m=m.return}0<x.length&&(f=new p(f,w,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==Jg&&(w=n.relatedTarget||n.fromElement)&&(Fo(w)||w[si]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(w=n.relatedTarget||n.toElement,p=u,w=w?Fo(w):null,w!==null&&(y=ba(w),w!==y||w.tag!==5&&w.tag!==6)&&(w=null)):(p=null,w=u),p!==w)){if(x=bb,k="onMouseLeave",g="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(x=kb,k="onPointerLeave",g="onPointerEnter",m="pointer"),y=p==null?f:rl(p),b=w==null?f:rl(w),f=new x(k,m+"leave",p,n,d),f.target=y,f.relatedTarget=b,k=null,Fo(d)===u&&(x=new x(g,m+"enter",w,n,d),x.target=b,x.relatedTarget=y,k=x),y=k,p&&w)t:{for(x=p,g=w,m=0,b=x;b;b=Da(b))m++;for(b=0,k=g;k;k=Da(k))b++;for(;0<m-b;)x=Da(x),m--;for(;0<b-m;)g=Da(g),b--;for(;m--;){if(x===g||g!==null&&x===g.alternate)break t;x=Da(x),g=Da(g)}x=null}else x=null;p!==null&&Ob(h,f,p,x,!1),w!==null&&y!==null&&Ob(h,y,w,x,!0)}}e:{if(f=u?rl(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var _=VR;else if(jb(f))if(K1)_=YR;else{_=KR;var C=qR}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=GR);if(_&&(_=_(t,u))){q1(h,_,n,d);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Kg(f,"number",f.value)}switch(C=u?rl(u):window,t){case"focusin":(jb(C)||C.contentEditable==="true")&&(nl=C,ix=u,nu=null);break;case"focusout":nu=ix=nl=null;break;case"mousedown":ox=!0;break;case"contextmenu":case"mouseup":case"dragend":ox=!1,Pb(h,n,d);break;case"selectionchange":if(JR)break;case"keydown":case"keyup":Pb(h,n,d)}var S;if(iv)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else tl?W1(t,n)&&(j="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(H1&&n.locale!=="ko"&&(tl||j!=="onCompositionStart"?j==="onCompositionEnd"&&tl&&(S=U1()):(Li=d,nv="value"in Li?Li.value:Li.textContent,tl=!0)),C=Rf(u,j),0<C.length&&(j=new wb(j,t,null,n,d),h.push({event:j,listeners:C}),S?j.data=S:(S=V1(n),S!==null&&(j.data=S)))),(S=zR?BR(t,n):UR(t,n))&&(u=Rf(u,"onBeforeInput"),0<u.length&&(d=new wb("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=S))}sj(h,e)})}function _u(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Rf(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=gu(t,n),i!=null&&s.unshift(_u(t,i,r)),i=gu(t,e),i!=null&&s.push(_u(t,i,r))),t=t.return}return s}function Da(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ob(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&u!==null&&(a=u,r?(l=gu(n,i),l!=null&&o.unshift(_u(n,l,a))):r||(l=gu(n,i),l!=null&&o.push(_u(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var nA=/\r\n?/g,sA=/\u0000|\uFFFD/g;function Mb(t){return(typeof t=="string"?t:""+t).replace(nA,`
`).replace(sA,"")}function rh(t,e,n){if(e=Mb(e),Mb(t)!==e&&n)throw Error(re(425))}function Af(){}var ax=null,lx=null;function cx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ux=typeof setTimeout=="function"?setTimeout:void 0,rA=typeof clearTimeout=="function"?clearTimeout:void 0,Ib=typeof Promise=="function"?Promise:void 0,iA=typeof queueMicrotask=="function"?queueMicrotask:typeof Ib<"u"?function(t){return Ib.resolve(null).then(t).catch(oA)}:ux;function oA(t){setTimeout(function(){throw t})}function Om(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),vu(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);vu(e)}function Ki(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Db(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var nc=Math.random().toString(36).slice(2),jr="__reactFiber$"+nc,Su="__reactProps$"+nc,si="__reactContainer$"+nc,dx="__reactEvents$"+nc,aA="__reactListeners$"+nc,lA="__reactHandles$"+nc;function Fo(t){var e=t[jr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[si]||n[jr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Db(t);t!==null;){if(n=t[jr])return n;t=Db(t)}return e}t=n,n=t.parentNode}return null}function md(t){return t=t[jr]||t[si],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function rl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(re(33))}function Np(t){return t[Su]||null}var hx=[],il=-1;function fo(t){return{current:t}}function Pt(t){0>il||(t.current=hx[il],hx[il]=null,il--)}function _t(t,e){il++,hx[il]=t.current,t.current=e}var ro={},Tn=fo(ro),ns=fo(!1),aa=ro;function ql(t,e){var n=t.type.contextTypes;if(!n)return ro;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function ss(t){return t=t.childContextTypes,t!=null}function Of(){Pt(ns),Pt(Tn)}function Lb(t,e,n){if(Tn.current!==ro)throw Error(re(168));_t(Tn,e),_t(ns,n)}function ij(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(re(108,qP(t)||"Unknown",r));return Wt({},n,s)}function Mf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ro,aa=Tn.current,_t(Tn,t),_t(ns,ns.current),!0}function $b(t,e,n){var s=t.stateNode;if(!s)throw Error(re(169));n?(t=ij(t,e,aa),s.__reactInternalMemoizedMergedChildContext=t,Pt(ns),Pt(Tn),_t(Tn,t)):Pt(ns),_t(ns,n)}var Wr=null,Ep=!1,Mm=!1;function oj(t){Wr===null?Wr=[t]:Wr.push(t)}function cA(t){Ep=!0,oj(t)}function po(){if(!Mm&&Wr!==null){Mm=!0;var t=0,e=mt;try{var n=Wr;for(mt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Wr=null,Ep=!1}catch(r){throw Wr!==null&&(Wr=Wr.slice(t+1)),R1(Jy,po),r}finally{mt=e,Mm=!1}}return null}var ol=[],al=0,If=null,Df=0,As=[],Os=0,la=null,Qr=1,Xr="";function Ao(t,e){ol[al++]=Df,ol[al++]=If,If=t,Df=e}function aj(t,e,n){As[Os++]=Qr,As[Os++]=Xr,As[Os++]=la,la=t;var s=Qr;t=Xr;var r=32-tr(s)-1;s&=~(1<<r),n+=1;var i=32-tr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Qr=1<<32-tr(e)+r|n<<r|s,Xr=i+t}else Qr=1<<i|n<<r|s,Xr=t}function av(t){t.return!==null&&(Ao(t,1),aj(t,1,0))}function lv(t){for(;t===If;)If=ol[--al],ol[al]=null,Df=ol[--al],ol[al]=null;for(;t===la;)la=As[--Os],As[Os]=null,Xr=As[--Os],As[Os]=null,Qr=As[--Os],As[Os]=null}var vs=null,ys=null,It=!1,er=null;function lj(t,e){var n=Ms(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Fb(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vs=t,ys=Ki(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vs=t,ys=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=la!==null?{id:Qr,overflow:Xr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ms(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,vs=t,ys=null,!0):!1;default:return!1}}function fx(t){return(t.mode&1)!==0&&(t.flags&128)===0}function px(t){if(It){var e=ys;if(e){var n=e;if(!Fb(t,e)){if(fx(t))throw Error(re(418));e=Ki(n.nextSibling);var s=vs;e&&Fb(t,e)?lj(s,n):(t.flags=t.flags&-4097|2,It=!1,vs=t)}}else{if(fx(t))throw Error(re(418));t.flags=t.flags&-4097|2,It=!1,vs=t}}}function zb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vs=t}function ih(t){if(t!==vs)return!1;if(!It)return zb(t),It=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!cx(t.type,t.memoizedProps)),e&&(e=ys)){if(fx(t))throw cj(),Error(re(418));for(;e;)lj(t,e),e=Ki(e.nextSibling)}if(zb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ys=Ki(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ys=null}}else ys=vs?Ki(t.stateNode.nextSibling):null;return!0}function cj(){for(var t=ys;t;)t=Ki(t.nextSibling)}function Kl(){ys=vs=null,It=!1}function cv(t){er===null?er=[t]:er.push(t)}var uA=ui.ReactCurrentBatchConfig;function Nc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var s=n.stateNode}if(!s)throw Error(re(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,t))}return t}function oh(t,e){throw t=Object.prototype.toString.call(e),Error(re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Bb(t){var e=t._init;return e(t._payload)}function uj(t){function e(g,m){if(t){var b=g.deletions;b===null?(g.deletions=[m],g.flags|=16):b.push(m)}}function n(g,m){if(!t)return null;for(;m!==null;)e(g,m),m=m.sibling;return null}function s(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function r(g,m){return g=Xi(g,m),g.index=0,g.sibling=null,g}function i(g,m,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<m?(g.flags|=2,m):b):(g.flags|=2,m)):(g.flags|=1048576,m)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,m,b,k){return m===null||m.tag!==6?(m=Bm(b,g.mode,k),m.return=g,m):(m=r(m,b),m.return=g,m)}function l(g,m,b,k){var _=b.type;return _===el?d(g,m,b.props.children,k,b.key):m!==null&&(m.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===bi&&Bb(_)===m.type)?(k=r(m,b.props),k.ref=Nc(g,m,b),k.return=g,k):(k=lf(b.type,b.key,b.props,null,g.mode,k),k.ref=Nc(g,m,b),k.return=g,k)}function u(g,m,b,k){return m===null||m.tag!==4||m.stateNode.containerInfo!==b.containerInfo||m.stateNode.implementation!==b.implementation?(m=Um(b,g.mode,k),m.return=g,m):(m=r(m,b.children||[]),m.return=g,m)}function d(g,m,b,k,_){return m===null||m.tag!==7?(m=na(b,g.mode,k,_),m.return=g,m):(m=r(m,b),m.return=g,m)}function h(g,m,b){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Bm(""+m,g.mode,b),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Yd:return b=lf(m.type,m.key,m.props,null,g.mode,b),b.ref=Nc(g,null,m),b.return=g,b;case Za:return m=Um(m,g.mode,b),m.return=g,m;case bi:var k=m._init;return h(g,k(m._payload),b)}if(Bc(m)||kc(m))return m=na(m,g.mode,b,null),m.return=g,m;oh(g,m)}return null}function f(g,m,b,k){var _=m!==null?m.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:a(g,m,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Yd:return b.key===_?l(g,m,b,k):null;case Za:return b.key===_?u(g,m,b,k):null;case bi:return _=b._init,f(g,m,_(b._payload),k)}if(Bc(b)||kc(b))return _!==null?null:d(g,m,b,k,null);oh(g,b)}return null}function p(g,m,b,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(b)||null,a(m,g,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Yd:return g=g.get(k.key===null?b:k.key)||null,l(m,g,k,_);case Za:return g=g.get(k.key===null?b:k.key)||null,u(m,g,k,_);case bi:var C=k._init;return p(g,m,b,C(k._payload),_)}if(Bc(k)||kc(k))return g=g.get(b)||null,d(m,g,k,_,null);oh(m,k)}return null}function w(g,m,b,k){for(var _=null,C=null,S=m,j=m=0,T=null;S!==null&&j<b.length;j++){S.index>j?(T=S,S=null):T=S.sibling;var P=f(g,S,b[j],k);if(P===null){S===null&&(S=T);break}t&&S&&P.alternate===null&&e(g,S),m=i(P,m,j),C===null?_=P:C.sibling=P,C=P,S=T}if(j===b.length)return n(g,S),It&&Ao(g,j),_;if(S===null){for(;j<b.length;j++)S=h(g,b[j],k),S!==null&&(m=i(S,m,j),C===null?_=S:C.sibling=S,C=S);return It&&Ao(g,j),_}for(S=s(g,S);j<b.length;j++)T=p(S,g,j,b[j],k),T!==null&&(t&&T.alternate!==null&&S.delete(T.key===null?j:T.key),m=i(T,m,j),C===null?_=T:C.sibling=T,C=T);return t&&S.forEach(function(L){return e(g,L)}),It&&Ao(g,j),_}function x(g,m,b,k){var _=kc(b);if(typeof _!="function")throw Error(re(150));if(b=_.call(b),b==null)throw Error(re(151));for(var C=_=null,S=m,j=m=0,T=null,P=b.next();S!==null&&!P.done;j++,P=b.next()){S.index>j?(T=S,S=null):T=S.sibling;var L=f(g,S,P.value,k);if(L===null){S===null&&(S=T);break}t&&S&&L.alternate===null&&e(g,S),m=i(L,m,j),C===null?_=L:C.sibling=L,C=L,S=T}if(P.done)return n(g,S),It&&Ao(g,j),_;if(S===null){for(;!P.done;j++,P=b.next())P=h(g,P.value,k),P!==null&&(m=i(P,m,j),C===null?_=P:C.sibling=P,C=P);return It&&Ao(g,j),_}for(S=s(g,S);!P.done;j++,P=b.next())P=p(S,g,j,P.value,k),P!==null&&(t&&P.alternate!==null&&S.delete(P.key===null?j:P.key),m=i(P,m,j),C===null?_=P:C.sibling=P,C=P);return t&&S.forEach(function(D){return e(g,D)}),It&&Ao(g,j),_}function y(g,m,b,k){if(typeof b=="object"&&b!==null&&b.type===el&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Yd:e:{for(var _=b.key,C=m;C!==null;){if(C.key===_){if(_=b.type,_===el){if(C.tag===7){n(g,C.sibling),m=r(C,b.props.children),m.return=g,g=m;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===bi&&Bb(_)===C.type){n(g,C.sibling),m=r(C,b.props),m.ref=Nc(g,C,b),m.return=g,g=m;break e}n(g,C);break}else e(g,C);C=C.sibling}b.type===el?(m=na(b.props.children,g.mode,k,b.key),m.return=g,g=m):(k=lf(b.type,b.key,b.props,null,g.mode,k),k.ref=Nc(g,m,b),k.return=g,g=k)}return o(g);case Za:e:{for(C=b.key;m!==null;){if(m.key===C)if(m.tag===4&&m.stateNode.containerInfo===b.containerInfo&&m.stateNode.implementation===b.implementation){n(g,m.sibling),m=r(m,b.children||[]),m.return=g,g=m;break e}else{n(g,m);break}else e(g,m);m=m.sibling}m=Um(b,g.mode,k),m.return=g,g=m}return o(g);case bi:return C=b._init,y(g,m,C(b._payload),k)}if(Bc(b))return w(g,m,b,k);if(kc(b))return x(g,m,b,k);oh(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,m!==null&&m.tag===6?(n(g,m.sibling),m=r(m,b),m.return=g,g=m):(n(g,m),m=Bm(b,g.mode,k),m.return=g,g=m),o(g)):n(g,m)}return y}var Gl=uj(!0),dj=uj(!1),Lf=fo(null),$f=null,ll=null,uv=null;function dv(){uv=ll=$f=null}function hv(t){var e=Lf.current;Pt(Lf),t._currentValue=e}function mx(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function yl(t,e){$f=t,uv=ll=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Jn=!0),t.firstContext=null)}function Fs(t){var e=t._currentValue;if(uv!==t)if(t={context:t,memoizedValue:e,next:null},ll===null){if($f===null)throw Error(re(308));ll=t,$f.dependencies={lanes:0,firstContext:t}}else ll=ll.next=t;return e}var zo=null;function fv(t){zo===null?zo=[t]:zo.push(t)}function hj(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,fv(e)):(n.next=r.next,r.next=n),e.interleaved=n,ri(t,s)}function ri(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var wi=!1;function pv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fj(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ei(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gi(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,rt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,ri(t,n)}return r=s.interleaved,r===null?(e.next=e,fv(s)):(e.next=r.next,r.next=e),s.interleaved=e,ri(t,n)}function tf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Zy(t,n)}}function Ub(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ff(t,e,n,s){var r=t.updateQueue;wi=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,d=u=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=t,x=a;switch(f=e,p=n,x.tag){case 1:if(w=x.payload,typeof w=="function"){h=w.call(p,h,f);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=x.payload,f=typeof w=="function"?w.call(p,h,f):w,f==null)break e;h=Wt({},h,f);break e;case 2:wi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,l=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(d===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);ua|=o,t.lanes=o,t.memoizedState=h}}function Hb(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(re(191,r));r.call(s)}}}var gd={},Pr=fo(gd),ju=fo(gd),Cu=fo(gd);function Bo(t){if(t===gd)throw Error(re(174));return t}function mv(t,e){switch(_t(Cu,e),_t(ju,t),_t(Pr,gd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Yg(e,t)}Pt(Pr),_t(Pr,e)}function Yl(){Pt(Pr),Pt(ju),Pt(Cu)}function pj(t){Bo(Cu.current);var e=Bo(Pr.current),n=Yg(e,t.type);e!==n&&(_t(ju,t),_t(Pr,n))}function gv(t){ju.current===t&&(Pt(Pr),Pt(ju))}var zt=fo(0);function zf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Im=[];function xv(){for(var t=0;t<Im.length;t++)Im[t]._workInProgressVersionPrimary=null;Im.length=0}var nf=ui.ReactCurrentDispatcher,Dm=ui.ReactCurrentBatchConfig,ca=0,Ht=null,on=null,dn=null,Bf=!1,su=!1,Nu=0,dA=0;function kn(){throw Error(re(321))}function yv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!rr(t[n],e[n]))return!1;return!0}function vv(t,e,n,s,r,i){if(ca=i,Ht=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,nf.current=t===null||t.memoizedState===null?mA:gA,t=n(s,r),su){i=0;do{if(su=!1,Nu=0,25<=i)throw Error(re(301));i+=1,dn=on=null,e.updateQueue=null,nf.current=xA,t=n(s,r)}while(su)}if(nf.current=Uf,e=on!==null&&on.next!==null,ca=0,dn=on=Ht=null,Bf=!1,e)throw Error(re(300));return t}function bv(){var t=Nu!==0;return Nu=0,t}function xr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?Ht.memoizedState=dn=t:dn=dn.next=t,dn}function zs(){if(on===null){var t=Ht.alternate;t=t!==null?t.memoizedState:null}else t=on.next;var e=dn===null?Ht.memoizedState:dn.next;if(e!==null)dn=e,on=t;else{if(t===null)throw Error(re(310));on=t,t={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},dn===null?Ht.memoizedState=dn=t:dn=dn.next=t}return dn}function Eu(t,e){return typeof e=="function"?e(t):e}function Lm(t){var e=zs(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var s=on,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,u=i;do{var d=u.lane;if((ca&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,Ht.lanes|=d,ua|=d}u=u.next}while(u!==null&&u!==i);l===null?o=s:l.next=a,rr(s,e.memoizedState)||(Jn=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Ht.lanes|=i,ua|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $m(t){var e=zs(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);rr(i,e.memoizedState)||(Jn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function mj(){}function gj(t,e){var n=Ht,s=zs(),r=e(),i=!rr(s.memoizedState,r);if(i&&(s.memoizedState=r,Jn=!0),s=s.queue,wv(vj.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||dn!==null&&dn.memoizedState.tag&1){if(n.flags|=2048,Tu(9,yj.bind(null,n,s,r,e),void 0,null),fn===null)throw Error(re(349));ca&30||xj(n,e,r)}return r}function xj(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ht.updateQueue,e===null?(e={lastEffect:null,stores:null},Ht.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function yj(t,e,n,s){e.value=n,e.getSnapshot=s,bj(e)&&wj(t)}function vj(t,e,n){return n(function(){bj(e)&&wj(t)})}function bj(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!rr(t,n)}catch{return!0}}function wj(t){var e=ri(t,1);e!==null&&nr(e,t,1,-1)}function Wb(t){var e=xr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eu,lastRenderedState:t},e.queue=t,t=t.dispatch=pA.bind(null,Ht,t),[e.memoizedState,t]}function Tu(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Ht.updateQueue,e===null?(e={lastEffect:null,stores:null},Ht.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function kj(){return zs().memoizedState}function sf(t,e,n,s){var r=xr();Ht.flags|=t,r.memoizedState=Tu(1|e,n,void 0,s===void 0?null:s)}function Tp(t,e,n,s){var r=zs();s=s===void 0?null:s;var i=void 0;if(on!==null){var o=on.memoizedState;if(i=o.destroy,s!==null&&yv(s,o.deps)){r.memoizedState=Tu(e,n,i,s);return}}Ht.flags|=t,r.memoizedState=Tu(1|e,n,i,s)}function Vb(t,e){return sf(8390656,8,t,e)}function wv(t,e){return Tp(2048,8,t,e)}function _j(t,e){return Tp(4,2,t,e)}function Sj(t,e){return Tp(4,4,t,e)}function jj(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Cj(t,e,n){return n=n!=null?n.concat([t]):null,Tp(4,4,jj.bind(null,e,t),n)}function kv(){}function Nj(t,e){var n=zs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&yv(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function Ej(t,e){var n=zs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&yv(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function Tj(t,e,n){return ca&21?(rr(n,e)||(n=M1(),Ht.lanes|=n,ua|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Jn=!0),t.memoizedState=n)}function hA(t,e){var n=mt;mt=n!==0&&4>n?n:4,t(!0);var s=Dm.transition;Dm.transition={};try{t(!1),e()}finally{mt=n,Dm.transition=s}}function Pj(){return zs().memoizedState}function fA(t,e,n){var s=Qi(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Rj(t))Aj(e,n);else if(n=hj(t,e,n,s),n!==null){var r=$n();nr(n,t,s,r),Oj(n,e,s)}}function pA(t,e,n){var s=Qi(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Rj(t))Aj(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,rr(a,o)){var l=e.interleaved;l===null?(r.next=r,fv(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=hj(t,e,r,s),n!==null&&(r=$n(),nr(n,t,s,r),Oj(n,e,s))}}function Rj(t){var e=t.alternate;return t===Ht||e!==null&&e===Ht}function Aj(t,e){su=Bf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Oj(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Zy(t,n)}}var Uf={readContext:Fs,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},mA={readContext:Fs,useCallback:function(t,e){return xr().memoizedState=[t,e===void 0?null:e],t},useContext:Fs,useEffect:Vb,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sf(4194308,4,jj.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sf(4194308,4,t,e)},useInsertionEffect:function(t,e){return sf(4,2,t,e)},useMemo:function(t,e){var n=xr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=xr();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=fA.bind(null,Ht,t),[s.memoizedState,t]},useRef:function(t){var e=xr();return t={current:t},e.memoizedState=t},useState:Wb,useDebugValue:kv,useDeferredValue:function(t){return xr().memoizedState=t},useTransition:function(){var t=Wb(!1),e=t[0];return t=hA.bind(null,t[1]),xr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Ht,r=xr();if(It){if(n===void 0)throw Error(re(407));n=n()}else{if(n=e(),fn===null)throw Error(re(349));ca&30||xj(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,Vb(vj.bind(null,s,i,t),[t]),s.flags|=2048,Tu(9,yj.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=xr(),e=fn.identifierPrefix;if(It){var n=Xr,s=Qr;n=(s&~(1<<32-tr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Nu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=dA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gA={readContext:Fs,useCallback:Nj,useContext:Fs,useEffect:wv,useImperativeHandle:Cj,useInsertionEffect:_j,useLayoutEffect:Sj,useMemo:Ej,useReducer:Lm,useRef:kj,useState:function(){return Lm(Eu)},useDebugValue:kv,useDeferredValue:function(t){var e=zs();return Tj(e,on.memoizedState,t)},useTransition:function(){var t=Lm(Eu)[0],e=zs().memoizedState;return[t,e]},useMutableSource:mj,useSyncExternalStore:gj,useId:Pj,unstable_isNewReconciler:!1},xA={readContext:Fs,useCallback:Nj,useContext:Fs,useEffect:wv,useImperativeHandle:Cj,useInsertionEffect:_j,useLayoutEffect:Sj,useMemo:Ej,useReducer:$m,useRef:kj,useState:function(){return $m(Eu)},useDebugValue:kv,useDeferredValue:function(t){var e=zs();return on===null?e.memoizedState=t:Tj(e,on.memoizedState,t)},useTransition:function(){var t=$m(Eu)[0],e=zs().memoizedState;return[t,e]},useMutableSource:mj,useSyncExternalStore:gj,useId:Pj,unstable_isNewReconciler:!1};function Gs(t,e){if(t&&t.defaultProps){e=Wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function gx(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Pp={isMounted:function(t){return(t=t._reactInternals)?ba(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=$n(),r=Qi(t),i=ei(s,r);i.payload=e,n!=null&&(i.callback=n),e=Gi(t,i,r),e!==null&&(nr(e,t,r,s),tf(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=$n(),r=Qi(t),i=ei(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Gi(t,i,r),e!==null&&(nr(e,t,r,s),tf(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$n(),s=Qi(t),r=ei(n,s);r.tag=2,e!=null&&(r.callback=e),e=Gi(t,r,s),e!==null&&(nr(e,t,s,n),tf(e,t,s))}};function qb(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!wu(n,s)||!wu(r,i):!0}function Mj(t,e,n){var s=!1,r=ro,i=e.contextType;return typeof i=="object"&&i!==null?i=Fs(i):(r=ss(e)?aa:Tn.current,s=e.contextTypes,i=(s=s!=null)?ql(t,r):ro),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pp,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function Kb(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Pp.enqueueReplaceState(e,e.state,null)}function xx(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},pv(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Fs(i):(i=ss(e)?aa:Tn.current,r.context=ql(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(gx(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Pp.enqueueReplaceState(r,r.state,null),Ff(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Ql(t,e){try{var n="",s=e;do n+=VP(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function Fm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function yx(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var yA=typeof WeakMap=="function"?WeakMap:Map;function Ij(t,e,n){n=ei(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Wf||(Wf=!0,Ex=s),yx(t,e)},n}function Dj(t,e,n){n=ei(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){yx(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){yx(t,e),typeof s!="function"&&(Yi===null?Yi=new Set([this]):Yi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Gb(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new yA;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=AA.bind(null,t,e,n),e.then(t,t))}function Yb(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qb(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ei(-1,1),e.tag=2,Gi(n,e,1))),n.lanes|=1),t)}var vA=ui.ReactCurrentOwner,Jn=!1;function Ln(t,e,n,s){e.child=t===null?dj(e,null,n,s):Gl(e,t.child,n,s)}function Xb(t,e,n,s,r){n=n.render;var i=e.ref;return yl(e,r),s=vv(t,e,n,s,i,r),n=bv(),t!==null&&!Jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ii(t,e,r)):(It&&n&&av(e),e.flags|=1,Ln(t,e,s,r),e.child)}function Jb(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Pv(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Lj(t,e,i,s,r)):(t=lf(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:wu,n(o,s)&&t.ref===e.ref)return ii(t,e,r)}return e.flags|=1,t=Xi(i,s),t.ref=e.ref,t.return=e,e.child=t}function Lj(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(wu(i,s)&&t.ref===e.ref)if(Jn=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Jn=!0);else return e.lanes=t.lanes,ii(t,e,r)}return vx(t,e,n,s,r)}function $j(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(ul,fs),fs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_t(ul,fs),fs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,_t(ul,fs),fs|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,_t(ul,fs),fs|=s;return Ln(t,e,r,n),e.child}function Fj(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function vx(t,e,n,s,r){var i=ss(n)?aa:Tn.current;return i=ql(e,i),yl(e,r),n=vv(t,e,n,s,i,r),s=bv(),t!==null&&!Jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ii(t,e,r)):(It&&s&&av(e),e.flags|=1,Ln(t,e,n,r),e.child)}function Zb(t,e,n,s,r){if(ss(n)){var i=!0;Mf(e)}else i=!1;if(yl(e,r),e.stateNode===null)rf(t,e),Mj(e,n,s),xx(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Fs(u):(u=ss(n)?aa:Tn.current,u=ql(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==u)&&Kb(e,o,s,u),wi=!1;var f=e.memoizedState;o.state=f,Ff(e,s,o,r),l=e.memoizedState,a!==s||f!==l||ns.current||wi?(typeof d=="function"&&(gx(e,n,d,s),l=e.memoizedState),(a=wi||qb(e,n,a,s,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,fj(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Gs(e.type,a),o.props=u,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Fs(l):(l=ss(n)?aa:Tn.current,l=ql(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&Kb(e,o,s,l),wi=!1,f=e.memoizedState,o.state=f,Ff(e,s,o,r);var w=e.memoizedState;a!==h||f!==w||ns.current||wi?(typeof p=="function"&&(gx(e,n,p,s),w=e.memoizedState),(u=wi||qb(e,n,u,s,f,w,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,w,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,w,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=w),o.props=s,o.state=w,o.context=l,s=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return bx(t,e,n,s,i,r)}function bx(t,e,n,s,r,i){Fj(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&$b(e,n,!1),ii(t,e,i);s=e.stateNode,vA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Gl(e,t.child,null,i),e.child=Gl(e,null,a,i)):Ln(t,e,a,i),e.memoizedState=s.state,r&&$b(e,n,!0),e.child}function zj(t){var e=t.stateNode;e.pendingContext?Lb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Lb(t,e.context,!1),mv(t,e.containerInfo)}function ew(t,e,n,s,r){return Kl(),cv(r),e.flags|=256,Ln(t,e,n,s),e.child}var wx={dehydrated:null,treeContext:null,retryLane:0};function kx(t){return{baseLanes:t,cachePool:null,transitions:null}}function Bj(t,e,n){var s=e.pendingProps,r=zt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),_t(zt,r&1),t===null)return px(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Op(o,s,0,null),t=na(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=kx(n),e.memoizedState=wx,t):_v(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return bA(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Xi(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=Xi(a,i):(i=na(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?kx(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=wx,s}return i=t.child,t=i.sibling,s=Xi(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function _v(t,e){return e=Op({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ah(t,e,n,s){return s!==null&&cv(s),Gl(e,t.child,null,n),t=_v(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bA(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Fm(Error(re(422))),ah(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Op({mode:"visible",children:s.children},r,0,null),i=na(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Gl(e,t.child,null,o),e.child.memoizedState=kx(o),e.memoizedState=wx,i);if(!(e.mode&1))return ah(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(re(419)),s=Fm(i,s,void 0),ah(t,e,o,s)}if(a=(o&t.childLanes)!==0,Jn||a){if(s=fn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,ri(t,r),nr(s,t,r,-1))}return Tv(),s=Fm(Error(re(421))),ah(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=OA.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,ys=Ki(r.nextSibling),vs=e,It=!0,er=null,t!==null&&(As[Os++]=Qr,As[Os++]=Xr,As[Os++]=la,Qr=t.id,Xr=t.overflow,la=e),e=_v(e,s.children),e.flags|=4096,e)}function tw(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),mx(t.return,e,n)}function zm(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function Uj(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(Ln(t,e,s.children,n),s=zt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&tw(t,n,e);else if(t.tag===19)tw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(_t(zt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&zf(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),zm(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&zf(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}zm(e,!0,n,null,i);break;case"together":zm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function rf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ii(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ua|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(re(153));if(e.child!==null){for(t=e.child,n=Xi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Xi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function wA(t,e,n){switch(e.tag){case 3:zj(e),Kl();break;case 5:pj(e);break;case 1:ss(e.type)&&Mf(e);break;case 4:mv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;_t(Lf,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(_t(zt,zt.current&1),e.flags|=128,null):n&e.child.childLanes?Bj(t,e,n):(_t(zt,zt.current&1),t=ii(t,e,n),t!==null?t.sibling:null);_t(zt,zt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return Uj(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),_t(zt,zt.current),s)break;return null;case 22:case 23:return e.lanes=0,$j(t,e,n)}return ii(t,e,n)}var Hj,_x,Wj,Vj;Hj=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_x=function(){};Wj=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Bo(Pr.current);var i=null;switch(n){case"input":r=Vg(t,r),s=Vg(t,s),i=[];break;case"select":r=Wt({},r,{value:void 0}),s=Wt({},s,{value:void 0}),i=[];break;case"textarea":r=Gg(t,r),s=Gg(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Af)}Qg(n,s);var o;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(pu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var l=s[u];if(a=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(pu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ct("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};Vj=function(t,e,n,s){n!==s&&(e.flags|=4)};function Ec(t,e){if(!It)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function _n(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function kA(t,e,n){var s=e.pendingProps;switch(lv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(e),null;case 1:return ss(e.type)&&Of(),_n(e),null;case 3:return s=e.stateNode,Yl(),Pt(ns),Pt(Tn),xv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(ih(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,er!==null&&(Rx(er),er=null))),_x(t,e),_n(e),null;case 5:gv(e);var r=Bo(Cu.current);if(n=e.type,t!==null&&e.stateNode!=null)Wj(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(re(166));return _n(e),null}if(t=Bo(Pr.current),ih(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[jr]=e,s[Su]=i,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",s),Ct("close",s);break;case"iframe":case"object":case"embed":Ct("load",s);break;case"video":case"audio":for(r=0;r<Hc.length;r++)Ct(Hc[r],s);break;case"source":Ct("error",s);break;case"img":case"image":case"link":Ct("error",s),Ct("load",s);break;case"details":Ct("toggle",s);break;case"input":ub(s,i),Ct("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Ct("invalid",s);break;case"textarea":hb(s,i),Ct("invalid",s)}Qg(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&rh(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&rh(s.textContent,a,t),r=["children",""+a]):pu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ct("scroll",s)}switch(n){case"input":Qd(s),db(s,i,!0);break;case"textarea":Qd(s),fb(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Af)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=v1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[jr]=e,t[Su]=s,Hj(t,e,!1,!1),e.stateNode=t;e:{switch(o=Xg(n,s),n){case"dialog":Ct("cancel",t),Ct("close",t),r=s;break;case"iframe":case"object":case"embed":Ct("load",t),r=s;break;case"video":case"audio":for(r=0;r<Hc.length;r++)Ct(Hc[r],t);r=s;break;case"source":Ct("error",t),r=s;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),r=s;break;case"details":Ct("toggle",t),r=s;break;case"input":ub(t,s),r=Vg(t,s),Ct("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Wt({},s,{value:void 0}),Ct("invalid",t);break;case"textarea":hb(t,s),r=Gg(t,s),Ct("invalid",t);break;default:r=s}Qg(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?k1(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&b1(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&mu(t,l):typeof l=="number"&&mu(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(pu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ct("scroll",t):l!=null&&Ky(t,i,l,o))}switch(n){case"input":Qd(t),db(t,s,!1);break;case"textarea":Qd(t),fb(t);break;case"option":s.value!=null&&t.setAttribute("value",""+so(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?pl(t,!!s.multiple,i,!1):s.defaultValue!=null&&pl(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Af)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _n(e),null;case 6:if(t&&e.stateNode!=null)Vj(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(re(166));if(n=Bo(Cu.current),Bo(Pr.current),ih(e)){if(s=e.stateNode,n=e.memoizedProps,s[jr]=e,(i=s.nodeValue!==n)&&(t=vs,t!==null))switch(t.tag){case 3:rh(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&rh(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[jr]=e,e.stateNode=s}return _n(e),null;case 13:if(Pt(zt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(It&&ys!==null&&e.mode&1&&!(e.flags&128))cj(),Kl(),e.flags|=98560,i=!1;else if(i=ih(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(re(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(re(317));i[jr]=e}else Kl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_n(e),i=!1}else er!==null&&(Rx(er),er=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||zt.current&1?ln===0&&(ln=3):Tv())),e.updateQueue!==null&&(e.flags|=4),_n(e),null);case 4:return Yl(),_x(t,e),t===null&&ku(e.stateNode.containerInfo),_n(e),null;case 10:return hv(e.type._context),_n(e),null;case 17:return ss(e.type)&&Of(),_n(e),null;case 19:if(Pt(zt),i=e.memoizedState,i===null)return _n(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)Ec(i,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=zf(t),o!==null){for(e.flags|=128,Ec(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _t(zt,zt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Qt()>Xl&&(e.flags|=128,s=!0,Ec(i,!1),e.lanes=4194304)}else{if(!s)if(t=zf(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ec(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!It)return _n(e),null}else 2*Qt()-i.renderingStartTime>Xl&&n!==1073741824&&(e.flags|=128,s=!0,Ec(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Qt(),e.sibling=null,n=zt.current,_t(zt,s?n&1|2:n&1),e):(_n(e),null);case 22:case 23:return Ev(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?fs&1073741824&&(_n(e),e.subtreeFlags&6&&(e.flags|=8192)):_n(e),null;case 24:return null;case 25:return null}throw Error(re(156,e.tag))}function _A(t,e){switch(lv(e),e.tag){case 1:return ss(e.type)&&Of(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yl(),Pt(ns),Pt(Tn),xv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return gv(e),null;case 13:if(Pt(zt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(re(340));Kl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pt(zt),null;case 4:return Yl(),null;case 10:return hv(e.type._context),null;case 22:case 23:return Ev(),null;case 24:return null;default:return null}}var lh=!1,jn=!1,SA=typeof WeakSet=="function"?WeakSet:Set,_e=null;function cl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Kt(t,e,s)}else n.current=null}function Sx(t,e,n){try{n()}catch(s){Kt(t,e,s)}}var nw=!1;function jA(t,e){if(ax=Tf,t=Q1(),ov(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++u===r&&(a=o),f===i&&++d===s&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(lx={focusedElem:t,selectionRange:n},Tf=!1,_e=e;_e!==null;)if(e=_e,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,_e=t;else for(;_e!==null;){e=_e;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var x=w.memoizedProps,y=w.memoizedState,g=e.stateNode,m=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:Gs(e.type,x),y);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(k){Kt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,_e=t;break}_e=e.return}return w=nw,nw=!1,w}function ru(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&Sx(e,n,i)}r=r.next}while(r!==s)}}function Rp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function jx(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function qj(t){var e=t.alternate;e!==null&&(t.alternate=null,qj(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jr],delete e[Su],delete e[dx],delete e[aA],delete e[lA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Kj(t){return t.tag===5||t.tag===3||t.tag===4}function sw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Kj(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Cx(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Af));else if(s!==4&&(t=t.child,t!==null))for(Cx(t,e,n),t=t.sibling;t!==null;)Cx(t,e,n),t=t.sibling}function Nx(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Nx(t,e,n),t=t.sibling;t!==null;)Nx(t,e,n),t=t.sibling}var xn=null,Js=!1;function mi(t,e,n){for(n=n.child;n!==null;)Gj(t,e,n),n=n.sibling}function Gj(t,e,n){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(_p,n)}catch{}switch(n.tag){case 5:jn||cl(n,e);case 6:var s=xn,r=Js;xn=null,mi(t,e,n),xn=s,Js=r,xn!==null&&(Js?(t=xn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):xn.removeChild(n.stateNode));break;case 18:xn!==null&&(Js?(t=xn,n=n.stateNode,t.nodeType===8?Om(t.parentNode,n):t.nodeType===1&&Om(t,n),vu(t)):Om(xn,n.stateNode));break;case 4:s=xn,r=Js,xn=n.stateNode.containerInfo,Js=!0,mi(t,e,n),xn=s,Js=r;break;case 0:case 11:case 14:case 15:if(!jn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Sx(n,e,o),r=r.next}while(r!==s)}mi(t,e,n);break;case 1:if(!jn&&(cl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Kt(n,e,a)}mi(t,e,n);break;case 21:mi(t,e,n);break;case 22:n.mode&1?(jn=(s=jn)||n.memoizedState!==null,mi(t,e,n),jn=s):mi(t,e,n);break;default:mi(t,e,n)}}function rw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new SA),e.forEach(function(s){var r=MA.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function qs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:xn=a.stateNode,Js=!1;break e;case 3:xn=a.stateNode.containerInfo,Js=!0;break e;case 4:xn=a.stateNode.containerInfo,Js=!0;break e}a=a.return}if(xn===null)throw Error(re(160));Gj(i,o,r),xn=null,Js=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Kt(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Yj(e,t),e=e.sibling}function Yj(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qs(e,t),hr(t),s&4){try{ru(3,t,t.return),Rp(3,t)}catch(x){Kt(t,t.return,x)}try{ru(5,t,t.return)}catch(x){Kt(t,t.return,x)}}break;case 1:qs(e,t),hr(t),s&512&&n!==null&&cl(n,n.return);break;case 5:if(qs(e,t),hr(t),s&512&&n!==null&&cl(n,n.return),t.flags&32){var r=t.stateNode;try{mu(r,"")}catch(x){Kt(t,t.return,x)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&x1(r,i),Xg(a,o);var u=Xg(a,i);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?k1(r,h):d==="dangerouslySetInnerHTML"?b1(r,h):d==="children"?mu(r,h):Ky(r,d,h,u)}switch(a){case"input":qg(r,i);break;case"textarea":y1(r,i);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?pl(r,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?pl(r,!!i.multiple,i.defaultValue,!0):pl(r,!!i.multiple,i.multiple?[]:"",!1))}r[Su]=i}catch(x){Kt(t,t.return,x)}}break;case 6:if(qs(e,t),hr(t),s&4){if(t.stateNode===null)throw Error(re(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(x){Kt(t,t.return,x)}}break;case 3:if(qs(e,t),hr(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{vu(e.containerInfo)}catch(x){Kt(t,t.return,x)}break;case 4:qs(e,t),hr(t);break;case 13:qs(e,t),hr(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Cv=Qt())),s&4&&rw(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(jn=(u=jn)||d,qs(e,t),jn=u):qs(e,t),hr(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(_e=t,d=t.child;d!==null;){for(h=_e=d;_e!==null;){switch(f=_e,p=f.child,f.tag){case 0:case 11:case 14:case 15:ru(4,f,f.return);break;case 1:cl(f,f.return);var w=f.stateNode;if(typeof w.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(x){Kt(s,n,x)}}break;case 5:cl(f,f.return);break;case 22:if(f.memoizedState!==null){ow(h);continue}}p!==null?(p.return=f,_e=p):ow(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=w1("display",o))}catch(x){Kt(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Kt(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:qs(e,t),hr(t),s&4&&rw(t);break;case 21:break;default:qs(e,t),hr(t)}}function hr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Kj(n)){var s=n;break e}n=n.return}throw Error(re(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(mu(r,""),s.flags&=-33);var i=sw(t);Nx(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=sw(t);Cx(t,a,o);break;default:throw Error(re(161))}}catch(l){Kt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function CA(t,e,n){_e=t,Qj(t)}function Qj(t,e,n){for(var s=(t.mode&1)!==0;_e!==null;){var r=_e,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||lh;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||jn;a=lh;var u=jn;if(lh=o,(jn=l)&&!u)for(_e=r;_e!==null;)o=_e,l=o.child,o.tag===22&&o.memoizedState!==null?aw(r):l!==null?(l.return=o,_e=l):aw(r);for(;i!==null;)_e=i,Qj(i),i=i.sibling;_e=r,lh=a,jn=u}iw(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,_e=i):iw(t)}}function iw(t){for(;_e!==null;){var e=_e;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jn||Rp(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!jn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Gs(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Hb(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Hb(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&vu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}jn||e.flags&512&&jx(e)}catch(f){Kt(e,e.return,f)}}if(e===t){_e=null;break}if(n=e.sibling,n!==null){n.return=e.return,_e=n;break}_e=e.return}}function ow(t){for(;_e!==null;){var e=_e;if(e===t){_e=null;break}var n=e.sibling;if(n!==null){n.return=e.return,_e=n;break}_e=e.return}}function aw(t){for(;_e!==null;){var e=_e;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Rp(4,e)}catch(l){Kt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Kt(e,r,l)}}var i=e.return;try{jx(e)}catch(l){Kt(e,i,l)}break;case 5:var o=e.return;try{jx(e)}catch(l){Kt(e,o,l)}}}catch(l){Kt(e,e.return,l)}if(e===t){_e=null;break}var a=e.sibling;if(a!==null){a.return=e.return,_e=a;break}_e=e.return}}var NA=Math.ceil,Hf=ui.ReactCurrentDispatcher,Sv=ui.ReactCurrentOwner,Ls=ui.ReactCurrentBatchConfig,rt=0,fn=null,Zt=null,vn=0,fs=0,ul=fo(0),ln=0,Pu=null,ua=0,Ap=0,jv=0,iu=null,Qn=null,Cv=0,Xl=1/0,Ur=null,Wf=!1,Ex=null,Yi=null,ch=!1,$i=null,Vf=0,ou=0,Tx=null,of=-1,af=0;function $n(){return rt&6?Qt():of!==-1?of:of=Qt()}function Qi(t){return t.mode&1?rt&2&&vn!==0?vn&-vn:uA.transition!==null?(af===0&&(af=M1()),af):(t=mt,t!==0||(t=window.event,t=t===void 0?16:B1(t.type)),t):1}function nr(t,e,n,s){if(50<ou)throw ou=0,Tx=null,Error(re(185));fd(t,n,s),(!(rt&2)||t!==fn)&&(t===fn&&(!(rt&2)&&(Ap|=n),ln===4&&Si(t,vn)),rs(t,s),n===1&&rt===0&&!(e.mode&1)&&(Xl=Qt()+500,Ep&&po()))}function rs(t,e){var n=t.callbackNode;uR(t,e);var s=Ef(t,t===fn?vn:0);if(s===0)n!==null&&gb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&gb(n),e===1)t.tag===0?cA(lw.bind(null,t)):oj(lw.bind(null,t)),iA(function(){!(rt&6)&&po()}),n=null;else{switch(I1(s)){case 1:n=Jy;break;case 4:n=A1;break;case 16:n=Nf;break;case 536870912:n=O1;break;default:n=Nf}n=rC(n,Xj.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Xj(t,e){if(of=-1,af=0,rt&6)throw Error(re(327));var n=t.callbackNode;if(vl()&&t.callbackNode!==n)return null;var s=Ef(t,t===fn?vn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=qf(t,s);else{e=s;var r=rt;rt|=2;var i=Zj();(fn!==t||vn!==e)&&(Ur=null,Xl=Qt()+500,ta(t,e));do try{PA();break}catch(a){Jj(t,a)}while(!0);dv(),Hf.current=i,rt=r,Zt!==null?e=0:(fn=null,vn=0,e=ln)}if(e!==0){if(e===2&&(r=nx(t),r!==0&&(s=r,e=Px(t,r))),e===1)throw n=Pu,ta(t,0),Si(t,s),rs(t,Qt()),n;if(e===6)Si(t,s);else{if(r=t.current.alternate,!(s&30)&&!EA(r)&&(e=qf(t,s),e===2&&(i=nx(t),i!==0&&(s=i,e=Px(t,i))),e===1))throw n=Pu,ta(t,0),Si(t,s),rs(t,Qt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(re(345));case 2:Oo(t,Qn,Ur);break;case 3:if(Si(t,s),(s&130023424)===s&&(e=Cv+500-Qt(),10<e)){if(Ef(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){$n(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ux(Oo.bind(null,t,Qn,Ur),e);break}Oo(t,Qn,Ur);break;case 4:if(Si(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-tr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Qt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*NA(s/1960))-s,10<s){t.timeoutHandle=ux(Oo.bind(null,t,Qn,Ur),s);break}Oo(t,Qn,Ur);break;case 5:Oo(t,Qn,Ur);break;default:throw Error(re(329))}}}return rs(t,Qt()),t.callbackNode===n?Xj.bind(null,t):null}function Px(t,e){var n=iu;return t.current.memoizedState.isDehydrated&&(ta(t,e).flags|=256),t=qf(t,e),t!==2&&(e=Qn,Qn=n,e!==null&&Rx(e)),t}function Rx(t){Qn===null?Qn=t:Qn.push.apply(Qn,t)}function EA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!rr(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Si(t,e){for(e&=~jv,e&=~Ap,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-tr(e),s=1<<n;t[n]=-1,e&=~s}}function lw(t){if(rt&6)throw Error(re(327));vl();var e=Ef(t,0);if(!(e&1))return rs(t,Qt()),null;var n=qf(t,e);if(t.tag!==0&&n===2){var s=nx(t);s!==0&&(e=s,n=Px(t,s))}if(n===1)throw n=Pu,ta(t,0),Si(t,e),rs(t,Qt()),n;if(n===6)throw Error(re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Oo(t,Qn,Ur),rs(t,Qt()),null}function Nv(t,e){var n=rt;rt|=1;try{return t(e)}finally{rt=n,rt===0&&(Xl=Qt()+500,Ep&&po())}}function da(t){$i!==null&&$i.tag===0&&!(rt&6)&&vl();var e=rt;rt|=1;var n=Ls.transition,s=mt;try{if(Ls.transition=null,mt=1,t)return t()}finally{mt=s,Ls.transition=n,rt=e,!(rt&6)&&po()}}function Ev(){fs=ul.current,Pt(ul)}function ta(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,rA(n)),Zt!==null)for(n=Zt.return;n!==null;){var s=n;switch(lv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Of();break;case 3:Yl(),Pt(ns),Pt(Tn),xv();break;case 5:gv(s);break;case 4:Yl();break;case 13:Pt(zt);break;case 19:Pt(zt);break;case 10:hv(s.type._context);break;case 22:case 23:Ev()}n=n.return}if(fn=t,Zt=t=Xi(t.current,null),vn=fs=e,ln=0,Pu=null,jv=Ap=ua=0,Qn=iu=null,zo!==null){for(e=0;e<zo.length;e++)if(n=zo[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}zo=null}return t}function Jj(t,e){do{var n=Zt;try{if(dv(),nf.current=Uf,Bf){for(var s=Ht.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Bf=!1}if(ca=0,dn=on=Ht=null,su=!1,Nu=0,Sv.current=null,n===null||n.return===null){ln=1,Pu=e,Zt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=vn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Yb(o);if(p!==null){p.flags&=-257,Qb(p,o,a,i,e),p.mode&1&&Gb(i,u,e),e=p,l=u;var w=e.updateQueue;if(w===null){var x=new Set;x.add(l),e.updateQueue=x}else w.add(l);break e}else{if(!(e&1)){Gb(i,u,e),Tv();break e}l=Error(re(426))}}else if(It&&a.mode&1){var y=Yb(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Qb(y,o,a,i,e),cv(Ql(l,a));break e}}i=l=Ql(l,a),ln!==4&&(ln=2),iu===null?iu=[i]:iu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=Ij(i,l,e);Ub(i,g);break e;case 1:a=l;var m=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Yi===null||!Yi.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=Dj(i,a,e);Ub(i,k);break e}}i=i.return}while(i!==null)}tC(n)}catch(_){e=_,Zt===n&&n!==null&&(Zt=n=n.return);continue}break}while(!0)}function Zj(){var t=Hf.current;return Hf.current=Uf,t===null?Uf:t}function Tv(){(ln===0||ln===3||ln===2)&&(ln=4),fn===null||!(ua&268435455)&&!(Ap&268435455)||Si(fn,vn)}function qf(t,e){var n=rt;rt|=2;var s=Zj();(fn!==t||vn!==e)&&(Ur=null,ta(t,e));do try{TA();break}catch(r){Jj(t,r)}while(!0);if(dv(),rt=n,Hf.current=s,Zt!==null)throw Error(re(261));return fn=null,vn=0,ln}function TA(){for(;Zt!==null;)eC(Zt)}function PA(){for(;Zt!==null&&!tR();)eC(Zt)}function eC(t){var e=sC(t.alternate,t,fs);t.memoizedProps=t.pendingProps,e===null?tC(t):Zt=e,Sv.current=null}function tC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_A(n,e),n!==null){n.flags&=32767,Zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,Zt=null;return}}else if(n=kA(n,e,fs),n!==null){Zt=n;return}if(e=e.sibling,e!==null){Zt=e;return}Zt=e=t}while(e!==null);ln===0&&(ln=5)}function Oo(t,e,n){var s=mt,r=Ls.transition;try{Ls.transition=null,mt=1,RA(t,e,n,s)}finally{Ls.transition=r,mt=s}return null}function RA(t,e,n,s){do vl();while($i!==null);if(rt&6)throw Error(re(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(re(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(dR(t,i),t===fn&&(Zt=fn=null,vn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ch||(ch=!0,rC(Nf,function(){return vl(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ls.transition,Ls.transition=null;var o=mt;mt=1;var a=rt;rt|=4,Sv.current=null,jA(t,n),Yj(n,t),XR(lx),Tf=!!ax,lx=ax=null,t.current=n,CA(n),nR(),rt=a,mt=o,Ls.transition=i}else t.current=n;if(ch&&(ch=!1,$i=t,Vf=r),i=t.pendingLanes,i===0&&(Yi=null),iR(n.stateNode),rs(t,Qt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Wf)throw Wf=!1,t=Ex,Ex=null,t;return Vf&1&&t.tag!==0&&vl(),i=t.pendingLanes,i&1?t===Tx?ou++:(ou=0,Tx=t):ou=0,po(),null}function vl(){if($i!==null){var t=I1(Vf),e=Ls.transition,n=mt;try{if(Ls.transition=null,mt=16>t?16:t,$i===null)var s=!1;else{if(t=$i,$i=null,Vf=0,rt&6)throw Error(re(331));var r=rt;for(rt|=4,_e=t.current;_e!==null;){var i=_e,o=i.child;if(_e.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(_e=u;_e!==null;){var d=_e;switch(d.tag){case 0:case 11:case 15:ru(8,d,i)}var h=d.child;if(h!==null)h.return=d,_e=h;else for(;_e!==null;){d=_e;var f=d.sibling,p=d.return;if(qj(d),d===u){_e=null;break}if(f!==null){f.return=p,_e=f;break}_e=p}}}var w=i.alternate;if(w!==null){var x=w.child;if(x!==null){w.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}_e=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,_e=o;else e:for(;_e!==null;){if(i=_e,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ru(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,_e=g;break e}_e=i.return}}var m=t.current;for(_e=m;_e!==null;){o=_e;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,_e=b;else e:for(o=m;_e!==null;){if(a=_e,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Rp(9,a)}}catch(_){Kt(a,a.return,_)}if(a===o){_e=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,_e=k;break e}_e=a.return}}if(rt=r,po(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(_p,t)}catch{}s=!0}return s}finally{mt=n,Ls.transition=e}}return!1}function cw(t,e,n){e=Ql(n,e),e=Ij(t,e,1),t=Gi(t,e,1),e=$n(),t!==null&&(fd(t,1,e),rs(t,e))}function Kt(t,e,n){if(t.tag===3)cw(t,t,n);else for(;e!==null;){if(e.tag===3){cw(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Yi===null||!Yi.has(s))){t=Ql(n,t),t=Dj(e,t,1),e=Gi(e,t,1),t=$n(),e!==null&&(fd(e,1,t),rs(e,t));break}}e=e.return}}function AA(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=$n(),t.pingedLanes|=t.suspendedLanes&n,fn===t&&(vn&n)===n&&(ln===4||ln===3&&(vn&130023424)===vn&&500>Qt()-Cv?ta(t,0):jv|=n),rs(t,e)}function nC(t,e){e===0&&(t.mode&1?(e=Zd,Zd<<=1,!(Zd&130023424)&&(Zd=4194304)):e=1);var n=$n();t=ri(t,e),t!==null&&(fd(t,e,n),rs(t,n))}function OA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nC(t,n)}function MA(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(re(314))}s!==null&&s.delete(e),nC(t,n)}var sC;sC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ns.current)Jn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Jn=!1,wA(t,e,n);Jn=!!(t.flags&131072)}else Jn=!1,It&&e.flags&1048576&&aj(e,Df,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;rf(t,e),t=e.pendingProps;var r=ql(e,Tn.current);yl(e,n),r=vv(null,e,s,t,r,n);var i=bv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ss(s)?(i=!0,Mf(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,pv(e),r.updater=Pp,e.stateNode=r,r._reactInternals=e,xx(e,s,t,n),e=bx(null,e,s,!0,i,n)):(e.tag=0,It&&i&&av(e),Ln(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(rf(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=DA(s),t=Gs(s,t),r){case 0:e=vx(null,e,s,t,n);break e;case 1:e=Zb(null,e,s,t,n);break e;case 11:e=Xb(null,e,s,t,n);break e;case 14:e=Jb(null,e,s,Gs(s.type,t),n);break e}throw Error(re(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Gs(s,r),vx(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Gs(s,r),Zb(t,e,s,r,n);case 3:e:{if(zj(e),t===null)throw Error(re(387));s=e.pendingProps,i=e.memoizedState,r=i.element,fj(t,e),Ff(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Ql(Error(re(423)),e),e=ew(t,e,s,n,r);break e}else if(s!==r){r=Ql(Error(re(424)),e),e=ew(t,e,s,n,r);break e}else for(ys=Ki(e.stateNode.containerInfo.firstChild),vs=e,It=!0,er=null,n=dj(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Kl(),s===r){e=ii(t,e,n);break e}Ln(t,e,s,n)}e=e.child}return e;case 5:return pj(e),t===null&&px(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,cx(s,r)?o=null:i!==null&&cx(s,i)&&(e.flags|=32),Fj(t,e),Ln(t,e,o,n),e.child;case 6:return t===null&&px(e),null;case 13:return Bj(t,e,n);case 4:return mv(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Gl(e,null,s,n):Ln(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Gs(s,r),Xb(t,e,s,r,n);case 7:return Ln(t,e,e.pendingProps,n),e.child;case 8:return Ln(t,e,e.pendingProps.children,n),e.child;case 12:return Ln(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,_t(Lf,s._currentValue),s._currentValue=o,i!==null)if(rr(i.value,o)){if(i.children===r.children&&!ns.current){e=ii(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=ei(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),mx(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(re(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),mx(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ln(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,yl(e,n),r=Fs(r),s=s(r),e.flags|=1,Ln(t,e,s,n),e.child;case 14:return s=e.type,r=Gs(s,e.pendingProps),r=Gs(s.type,r),Jb(t,e,s,r,n);case 15:return Lj(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Gs(s,r),rf(t,e),e.tag=1,ss(s)?(t=!0,Mf(e)):t=!1,yl(e,n),Mj(e,s,r),xx(e,s,r,n),bx(null,e,s,!0,t,n);case 19:return Uj(t,e,n);case 22:return $j(t,e,n)}throw Error(re(156,e.tag))};function rC(t,e){return R1(t,e)}function IA(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ms(t,e,n,s){return new IA(t,e,n,s)}function Pv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function DA(t){if(typeof t=="function")return Pv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Yy)return 11;if(t===Qy)return 14}return 2}function Xi(t,e){var n=t.alternate;return n===null?(n=Ms(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function lf(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")Pv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case el:return na(n.children,r,i,e);case Gy:o=8,r|=8;break;case Bg:return t=Ms(12,n,e,r|2),t.elementType=Bg,t.lanes=i,t;case Ug:return t=Ms(13,n,e,r),t.elementType=Ug,t.lanes=i,t;case Hg:return t=Ms(19,n,e,r),t.elementType=Hg,t.lanes=i,t;case p1:return Op(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case h1:o=10;break e;case f1:o=9;break e;case Yy:o=11;break e;case Qy:o=14;break e;case bi:o=16,s=null;break e}throw Error(re(130,t==null?t:typeof t,""))}return e=Ms(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function na(t,e,n,s){return t=Ms(7,t,s,e),t.lanes=n,t}function Op(t,e,n,s){return t=Ms(22,t,s,e),t.elementType=p1,t.lanes=n,t.stateNode={isHidden:!1},t}function Bm(t,e,n){return t=Ms(6,t,null,e),t.lanes=n,t}function Um(t,e,n){return e=Ms(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function LA(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=km(0),this.expirationTimes=km(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=km(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Rv(t,e,n,s,r,i,o,a,l){return t=new LA(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ms(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},pv(i),t}function $A(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Za,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function iC(t){if(!t)return ro;t=t._reactInternals;e:{if(ba(t)!==t||t.tag!==1)throw Error(re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ss(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(re(171))}if(t.tag===1){var n=t.type;if(ss(n))return ij(t,n,e)}return e}function oC(t,e,n,s,r,i,o,a,l){return t=Rv(n,s,!0,t,r,i,o,a,l),t.context=iC(null),n=t.current,s=$n(),r=Qi(n),i=ei(s,r),i.callback=e??null,Gi(n,i,r),t.current.lanes=r,fd(t,r,s),rs(t,s),t}function Mp(t,e,n,s){var r=e.current,i=$n(),o=Qi(r);return n=iC(n),e.context===null?e.context=n:e.pendingContext=n,e=ei(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Gi(r,e,o),t!==null&&(nr(t,r,o,i),tf(t,r,o)),o}function Kf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function uw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Av(t,e){uw(t,e),(t=t.alternate)&&uw(t,e)}function FA(){return null}var aC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ov(t){this._internalRoot=t}Ip.prototype.render=Ov.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(re(409));Mp(t,e,null,null)};Ip.prototype.unmount=Ov.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;da(function(){Mp(null,t,null,null)}),e[si]=null}};function Ip(t){this._internalRoot=t}Ip.prototype.unstable_scheduleHydration=function(t){if(t){var e=$1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<_i.length&&e!==0&&e<_i[n].priority;n++);_i.splice(n,0,t),n===0&&z1(t)}};function Mv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function dw(){}function zA(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=Kf(o);i.call(u)}}var o=oC(e,s,t,0,null,!1,!1,"",dw);return t._reactRootContainer=o,t[si]=o.current,ku(t.nodeType===8?t.parentNode:t),da(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var u=Kf(l);a.call(u)}}var l=Rv(t,0,!1,null,null,!1,!1,"",dw);return t._reactRootContainer=l,t[si]=l.current,ku(t.nodeType===8?t.parentNode:t),da(function(){Mp(e,l,n,s)}),l}function Lp(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=Kf(o);a.call(l)}}Mp(e,o,t,r)}else o=zA(n,e,t,r,s);return Kf(o)}D1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Uc(e.pendingLanes);n!==0&&(Zy(e,n|1),rs(e,Qt()),!(rt&6)&&(Xl=Qt()+500,po()))}break;case 13:da(function(){var s=ri(t,1);if(s!==null){var r=$n();nr(s,t,1,r)}}),Av(t,1)}};ev=function(t){if(t.tag===13){var e=ri(t,134217728);if(e!==null){var n=$n();nr(e,t,134217728,n)}Av(t,134217728)}};L1=function(t){if(t.tag===13){var e=Qi(t),n=ri(t,e);if(n!==null){var s=$n();nr(n,t,e,s)}Av(t,e)}};$1=function(){return mt};F1=function(t,e){var n=mt;try{return mt=t,e()}finally{mt=n}};Zg=function(t,e,n){switch(e){case"input":if(qg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Np(s);if(!r)throw Error(re(90));g1(s),qg(s,r)}}}break;case"textarea":y1(t,n);break;case"select":e=n.value,e!=null&&pl(t,!!n.multiple,e,!1)}};j1=Nv;C1=da;var BA={usingClientEntryPoint:!1,Events:[md,rl,Np,_1,S1,Nv]},Tc={findFiberByHostInstance:Fo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UA={bundleType:Tc.bundleType,version:Tc.version,rendererPackageName:Tc.rendererPackageName,rendererConfig:Tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ui.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=T1(t),t===null?null:t.stateNode},findFiberByHostInstance:Tc.findFiberByHostInstance||FA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uh.isDisabled&&uh.supportsFiber)try{_p=uh.inject(UA),Tr=uh}catch{}}Ss.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BA;Ss.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mv(e))throw Error(re(200));return $A(t,e,null,n)};Ss.createRoot=function(t,e){if(!Mv(t))throw Error(re(299));var n=!1,s="",r=aC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Rv(t,1,!1,null,null,n,!1,s,r),t[si]=e.current,ku(t.nodeType===8?t.parentNode:t),new Ov(e)};Ss.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(re(188)):(t=Object.keys(t).join(","),Error(re(268,t)));return t=T1(e),t=t===null?null:t.stateNode,t};Ss.flushSync=function(t){return da(t)};Ss.hydrate=function(t,e,n){if(!Dp(e))throw Error(re(200));return Lp(null,t,e,!0,n)};Ss.hydrateRoot=function(t,e,n){if(!Mv(t))throw Error(re(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=aC;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=oC(e,null,t,1,n??null,r,!1,i,o),t[si]=e.current,ku(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Ip(e)};Ss.render=function(t,e,n){if(!Dp(e))throw Error(re(200));return Lp(null,t,e,!1,n)};Ss.unmountComponentAtNode=function(t){if(!Dp(t))throw Error(re(40));return t._reactRootContainer?(da(function(){Lp(null,null,t,!1,function(){t._reactRootContainer=null,t[si]=null})}),!0):!1};Ss.unstable_batchedUpdates=Nv;Ss.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Dp(n))throw Error(re(200));if(t==null||t._reactInternals===void 0)throw Error(re(38));return Lp(t,e,n,!1,s)};Ss.version="18.3.1-next-f1338f8080-20240426";function lC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lC)}catch(t){console.error(t)}}lC(),l1.exports=Ss;var xd=l1.exports;const cC=QS(xd);var hw=xd;Fg.createRoot=hw.createRoot,Fg.hydrateRoot=hw.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ru(){return Ru=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ru.apply(this,arguments)}var Fi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Fi||(Fi={}));const fw="popstate";function HA(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return Ax("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:uC(r)}return VA(e,n,null,t)}function sn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Iv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function WA(){return Math.random().toString(36).substr(2,8)}function pw(t,e){return{usr:t.state,key:t.key,idx:e}}function Ax(t,e,n,s){return n===void 0&&(n=null),Ru({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?sc(e):e,{state:n,key:e&&e.key||s||WA()})}function uC(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function sc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function VA(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=Fi.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Ru({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=Fi.Pop;let y=d(),g=y==null?null:y-u;u=y,l&&l({action:a,location:x.location,delta:g})}function f(y,g){a=Fi.Push;let m=Ax(x.location,y,g);u=d()+1;let b=pw(m,u),k=x.createHref(m);try{o.pushState(b,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;r.location.assign(k)}i&&l&&l({action:a,location:x.location,delta:1})}function p(y,g){a=Fi.Replace;let m=Ax(x.location,y,g);u=d();let b=pw(m,u),k=x.createHref(m);o.replaceState(b,"",k),i&&l&&l({action:a,location:x.location,delta:0})}function w(y){let g=r.location.origin!=="null"?r.location.origin:r.location.href,m=typeof y=="string"?y:uC(y);return m=m.replace(/ $/,"%20"),sn(g,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,g)}let x={get action(){return a},get location(){return t(r,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(fw,h),l=y,()=>{r.removeEventListener(fw,h),l=null}},createHref(y){return e(r,y)},createURL:w,encodeLocation(y){let g=w(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:p,go(y){return o.go(y)}};return x}var mw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(mw||(mw={}));function qA(t,e,n){return n===void 0&&(n="/"),KA(t,e,n)}function KA(t,e,n,s){let r=typeof e=="string"?sc(e):e,i=fC(r.pathname||"/",n);if(i==null)return null;let o=dC(t);GA(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=oO(i);a=sO(o[l],u)}return a}function dC(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(sn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=sa([s,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(sn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),dC(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:tO(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of hC(i.path))r(i,o,l)}),e}function hC(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=hC(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function GA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:nO(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const YA=/^:[\w-]+$/,QA=3,XA=2,JA=1,ZA=10,eO=-2,gw=t=>t==="*";function tO(t,e){let n=t.split("/"),s=n.length;return n.some(gw)&&(s+=eO),e&&(s+=XA),n.filter(r=>!gw(r)).reduce((r,i)=>r+(YA.test(i)?QA:i===""?JA:ZA),s)}function nO(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function sO(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],u=a===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=rO({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),f=l.route;if(!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:sa([i,h.pathname]),pathnameBase:dO(sa([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=sa([i,h.pathnameBase]))}return o}function rO(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=iO(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let x=a[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const w=a[h];return p&&!w?u[f]=void 0:u[f]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function iO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Iv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function oO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Iv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function fC(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const aO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lO=t=>aO.test(t);function cO(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?sc(t):t,i;if(n)if(lO(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Iv(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=xw(n.substring(1),"/"):i=xw(n,e)}else i=e;return{pathname:i,search:hO(s),hash:fO(r)}}function xw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Hm(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function pC(t,e){let n=uO(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function mC(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=sc(t):(r=Ru({},t),sn(!r.pathname||!r.pathname.includes("?"),Hm("?","pathname","search",r)),sn(!r.pathname||!r.pathname.includes("#"),Hm("#","pathname","hash",r)),sn(!r.search||!r.search.includes("#"),Hm("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;r.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=cO(r,a),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const sa=t=>t.join("/").replace(/\/\/+/g,"/"),dO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),hO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,fO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function pO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const gC=["post","put","patch","delete"];new Set(gC);const mO=["get",...gC];new Set(mO);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Au(){return Au=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Au.apply(this,arguments)}const Dv=v.createContext(null),gO=v.createContext(null),yd=v.createContext(null),$p=v.createContext(null),mo=v.createContext({outlet:null,matches:[],isDataRoute:!1}),xC=v.createContext(null);function vd(){return v.useContext($p)!=null}function rc(){return vd()||sn(!1),v.useContext($p).location}function yC(t){v.useContext(yd).static||v.useLayoutEffect(t)}function bd(){let{isDataRoute:t}=v.useContext(mo);return t?RO():xO()}function xO(){vd()||sn(!1);let t=v.useContext(Dv),{basename:e,future:n,navigator:s}=v.useContext(yd),{matches:r}=v.useContext(mo),{pathname:i}=rc(),o=JSON.stringify(pC(r,n.v7_relativeSplatPath)),a=v.useRef(!1);return yC(()=>{a.current=!0}),v.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){s.go(u);return}let h=mC(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:sa([e,h.pathname])),(d.replace?s.replace:s.push)(h,d.state,d)},[e,s,o,i,t])}const yO=v.createContext(null);function vO(t){let e=v.useContext(mo).outlet;return e&&v.createElement(yO.Provider,{value:t},e)}function bO(t,e){return wO(t,e)}function wO(t,e,n,s){vd()||sn(!1);let{navigator:r}=v.useContext(yd),{matches:i}=v.useContext(mo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=rc(),d;if(e){var h;let y=typeof e=="string"?sc(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||sn(!1),d=y}else d=u;let f=d.pathname||"/",p=f;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let w=qA(t,{pathname:p}),x=CO(w&&w.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:sa([l,r.encodeLocation?r.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:sa([l,r.encodeLocation?r.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,s);return e&&x?v.createElement($p.Provider,{value:{location:Au({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Fi.Pop}},x):x}function kO(){let t=PO(),e=pO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),n?v.createElement("pre",{style:r},n):null,null)}const _O=v.createElement(kO,null);class SO extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?v.createElement(mo.Provider,{value:this.props.routeContext},v.createElement(xC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jO(t){let{routeContext:e,match:n,children:s}=t,r=v.useContext(Dv);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),v.createElement(mo.Provider,{value:e},s)}function CO(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let d=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);d>=0||sn(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=n,w=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||w){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let p,w=!1,x=null,y=null;n&&(p=a&&h.route.id?a[h.route.id]:void 0,x=h.route.errorElement||_O,l&&(u<0&&f===0?(AO("route-fallback"),w=!0,y=null):u===f&&(w=!0,y=h.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),m=()=>{let b;return p?b=x:w?b=y:h.route.Component?b=v.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,v.createElement(jO,{match:h,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?v.createElement(SO,{location:n.location,revalidation:n.revalidation,component:x,error:p,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var vC=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(vC||{}),bC=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(bC||{});function NO(t){let e=v.useContext(Dv);return e||sn(!1),e}function EO(t){let e=v.useContext(gO);return e||sn(!1),e}function TO(t){let e=v.useContext(mo);return e||sn(!1),e}function wC(t){let e=TO(),n=e.matches[e.matches.length-1];return n.route.id||sn(!1),n.route.id}function PO(){var t;let e=v.useContext(xC),n=EO(),s=wC();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function RO(){let{router:t}=NO(vC.UseNavigateStable),e=wC(bC.UseNavigateStable),n=v.useRef(!1);return yC(()=>{n.current=!0}),v.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Au({fromRouteId:e},i)))},[t,e])}const yw={};function AO(t,e,n){yw[t]||(yw[t]=!0)}function OO(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function cf(t){let{to:e,replace:n,state:s,relative:r}=t;vd()||sn(!1);let{future:i,static:o}=v.useContext(yd),{matches:a}=v.useContext(mo),{pathname:l}=rc(),u=bd(),d=mC(e,pC(a,i.v7_relativeSplatPath),l,r==="path"),h=JSON.stringify(d);return v.useEffect(()=>u(JSON.parse(h),{replace:n,state:s,relative:r}),[u,h,r,n,s]),null}function MO(t){return vO(t.context)}function On(t){sn(!1)}function IO(t){let{basename:e="/",children:n=null,location:s,navigationType:r=Fi.Pop,navigator:i,static:o=!1,future:a}=t;vd()&&sn(!1);let l=e.replace(/^\/*/,"/"),u=v.useMemo(()=>({basename:l,navigator:i,static:o,future:Au({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=sc(s));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:w="default"}=s,x=v.useMemo(()=>{let y=fC(d,l);return y==null?null:{location:{pathname:y,search:h,hash:f,state:p,key:w},navigationType:r}},[l,d,h,f,p,w,r]);return x==null?null:v.createElement(yd.Provider,{value:u},v.createElement($p.Provider,{children:n,value:x}))}function DO(t){let{children:e,location:n}=t;return bO(Ox(e),n)}new Promise(()=>{});function Ox(t,e){e===void 0&&(e=[]);let n=[];return v.Children.forEach(t,(s,r)=>{if(!v.isValidElement(s))return;let i=[...e,r];if(s.type===v.Fragment){n.push.apply(n,Ox(s.props.children,i));return}s.type!==On&&sn(!1),!s.props.index||!s.props.children||sn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Ox(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const LO="6";try{window.__reactRouterVersion=LO}catch{}const $O="startTransition",vw=kp[$O];function FO(t){let{basename:e,children:n,future:s,window:r}=t,i=v.useRef();i.current==null&&(i.current=HA({window:r,v5Compat:!0}));let o=i.current,[a,l]=v.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},d=v.useCallback(h=>{u&&vw?vw(()=>l(h)):l(h)},[l,u]);return v.useLayoutEffect(()=>o.listen(d),[o,d]),v.useEffect(()=>OO(s),[s]),v.createElement(IO,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}var bw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(bw||(bw={}));var ww;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ww||(ww={}));var Gf=["light","dark"],Lv="(prefers-color-scheme: dark)",zO=typeof window>"u",$v=v.createContext(void 0),BO={setTheme:t=>{},themes:[]},UO=()=>{var t;return(t=v.useContext($v))!=null?t:BO},HO=t=>v.useContext($v)?t.children:v.createElement(VO,{...t}),WO=["light","dark"],VO=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:s=!0,storageKey:r="theme",themes:i=WO,defaultTheme:o=n?"system":"light",attribute:a="data-theme",value:l,children:u,nonce:d})=>{let[h,f]=v.useState(()=>kw(r,o)),[p,w]=v.useState(()=>kw(r)),x=l?Object.values(l):i,y=v.useCallback(k=>{let _=k;if(!_)return;k==="system"&&n&&(_=_w());let C=l?l[_]:_,S=e?KO():null,j=document.documentElement;if(a==="class"?(j.classList.remove(...x),C&&j.classList.add(C)):C?j.setAttribute(a,C):j.removeAttribute(a),s){let T=Gf.includes(o)?o:null,P=Gf.includes(_)?_:T;j.style.colorScheme=P}S==null||S()},[]),g=v.useCallback(k=>{let _=typeof k=="function"?k(k):k;f(_);try{localStorage.setItem(r,_)}catch{}},[t]),m=v.useCallback(k=>{let _=_w(k);w(_),h==="system"&&n&&!t&&y("system")},[h,t]);v.useEffect(()=>{let k=window.matchMedia(Lv);return k.addListener(m),m(k),()=>k.removeListener(m)},[m]),v.useEffect(()=>{let k=_=>{if(_.key!==r)return;let C=_.newValue||o;g(C)};return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[g]),v.useEffect(()=>{y(t??h)},[t,h]);let b=v.useMemo(()=>({theme:h,setTheme:g,forcedTheme:t,resolvedTheme:h==="system"?p:h,themes:n?[...i,"system"]:i,systemTheme:n?p:void 0}),[h,g,t,p,n,i]);return v.createElement($v.Provider,{value:b},v.createElement(qO,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:n,enableColorScheme:s,storageKey:r,themes:i,defaultTheme:o,attribute:a,value:l,children:u,attrs:x,nonce:d}),u)},qO=v.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:s,enableColorScheme:r,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let u=i==="system",d=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(w=>`'${w}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=r?Gf.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(w,x=!1,y=!0)=>{let g=o?o[w]:w,m=x?w+"|| ''":`'${g}'`,b="";return r&&y&&!x&&Gf.includes(w)&&(b+=`d.style.colorScheme = '${w}';`),n==="class"?x||g?b+=`c.add(${m})`:b+="null":g&&(b+=`d[s](n,${m})`),b},p=t?`!function(){${d}${f(t)}}()`:s?`!function(){try{${d}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${Lv}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return v.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),kw=(t,e)=>{if(zO)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},KO=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},_w=t=>(t||(t=window.matchMedia(Lv)),t.matches?"dark":"light"),wa=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},GO={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Ni,zy,$S,YO=($S=class{constructor(){ke(this,Ni,GO);ke(this,zy,!1)}setTimeoutProvider(t){ue(this,Ni,t)}setTimeout(t,e){return M(this,Ni).setTimeout(t,e)}clearTimeout(t){M(this,Ni).clearTimeout(t)}setInterval(t,e){return M(this,Ni).setInterval(t,e)}clearInterval(t){M(this,Ni).clearInterval(t)}},Ni=new WeakMap,zy=new WeakMap,$S),Uo=new YO;function QO(t){setTimeout(t,0)}var ha=typeof window>"u"||"Deno"in globalThis;function Sn(){}function XO(t,e){return typeof t=="function"?t(e):t}function Mx(t){return typeof t=="number"&&t>=0&&t!==1/0}function kC(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Ji(t,e){return typeof t=="function"?t(e):t}function Rs(t,e){return typeof t=="function"?t(e):t}function Sw(t,e){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:o,stale:a}=t;if(o){if(s){if(e.queryHash!==Fv(o,e.options))return!1}else if(!Ou(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||r&&r!==e.state.fetchStatus||i&&!i(e))}function jw(t,e){const{exact:n,status:s,predicate:r,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(fa(e.options.mutationKey)!==fa(i))return!1}else if(!Ou(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||r&&!r(e))}function Fv(t,e){return((e==null?void 0:e.queryKeyHashFn)||fa)(t)}function fa(t){return JSON.stringify(t,(e,n)=>Ix(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Ou(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Ou(t[n],e[n])):!1}var JO=Object.prototype.hasOwnProperty;function zv(t,e){if(t===e)return t;const n=Cw(t)&&Cw(e);if(!n&&!(Ix(t)&&Ix(e)))return e;const r=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let l=0;for(let u=0;u<o;u++){const d=n?u:i[u],h=t[d],f=e[d];if(h===f){a[d]=h,(n?u<r:JO.call(t,d))&&l++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){a[d]=f;continue}const p=zv(h,f);a[d]=p,p===h&&l++}return r===o&&l===r?t:a}function Mu(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Cw(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ix(t){if(!Nw(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Nw(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Nw(t){return Object.prototype.toString.call(t)==="[object Object]"}function ZO(t){return new Promise(e=>{Uo.setTimeout(e,t)})}function Dx(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?zv(t,e):e}function eM(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function tM(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var Bv=Symbol();function _C(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Bv?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function SC(t,e){return typeof t=="function"?t(...e):!!t}var qo,Ei,Pl,FS,nM=(FS=class extends wa{constructor(){super();ke(this,qo);ke(this,Ei);ke(this,Pl);ue(this,Pl,e=>{if(!ha&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){M(this,Ei)||this.setEventListener(M(this,Pl))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,Ei))==null||e.call(this),ue(this,Ei,void 0))}setEventListener(e){var n;ue(this,Pl,e),(n=M(this,Ei))==null||n.call(this),ue(this,Ei,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){M(this,qo)!==e&&(ue(this,qo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof M(this,qo)=="boolean"?M(this,qo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},qo=new WeakMap,Ei=new WeakMap,Pl=new WeakMap,FS),Uv=new nM;function Lx(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),t(r)},n.reject=r=>{s({status:"rejected",reason:r}),e(r)},n}var sM=QO;function rM(){let t=[],e=0,n=a=>{a()},s=a=>{a()},r=sM;const i=a=>{e?t.push(a):r(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&r(()=>{s(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{s=a},setScheduler:a=>{r=a}}}var Gt=rM(),Rl,Ti,Al,zS,iM=(zS=class extends wa{constructor(){super();ke(this,Rl,!0);ke(this,Ti);ke(this,Al);ue(this,Al,e=>{if(!ha&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){M(this,Ti)||this.setEventListener(M(this,Al))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,Ti))==null||e.call(this),ue(this,Ti,void 0))}setEventListener(e){var n;ue(this,Al,e),(n=M(this,Ti))==null||n.call(this),ue(this,Ti,e(this.setOnline.bind(this)))}setOnline(e){M(this,Rl)!==e&&(ue(this,Rl,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return M(this,Rl)}},Rl=new WeakMap,Ti=new WeakMap,Al=new WeakMap,zS),Yf=new iM;function oM(t){return Math.min(1e3*2**t,3e4)}function jC(t){return(t??"online")==="online"?Yf.isOnline():!0}var $x=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function CC(t){let e=!1,n=0,s;const r=Lx(),i=()=>r.status!=="pending",o=x=>{var y;if(!i()){const g=new $x(x);f(g),(y=t.onCancel)==null||y.call(t,g)}},a=()=>{e=!0},l=()=>{e=!1},u=()=>Uv.isFocused()&&(t.networkMode==="always"||Yf.isOnline())&&t.canRun(),d=()=>jC(t.networkMode)&&t.canRun(),h=x=>{i()||(s==null||s(),r.resolve(x))},f=x=>{i()||(s==null||s(),r.reject(x))},p=()=>new Promise(x=>{var y;s=g=>{(i()||u())&&x(g)},(y=t.onPause)==null||y.call(t)}).then(()=>{var x;s=void 0,i()||(x=t.onContinue)==null||x.call(t)}),w=()=>{if(i())return;let x;const y=n===0?t.initialPromise:void 0;try{x=y??t.fn()}catch(g){x=Promise.reject(g)}Promise.resolve(x).then(h).catch(g=>{var C;if(i())return;const m=t.retry??(ha?0:3),b=t.retryDelay??oM,k=typeof b=="function"?b(n,g):b,_=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,g);if(e||!_){f(g);return}n++,(C=t.onFail)==null||C.call(t,n,g),ZO(k).then(()=>u()?void 0:p()).then(()=>{e?f(g):w()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(s==null||s(),r),cancelRetry:a,continueRetry:l,canStart:d,start:()=>(d()?w():p().then(w),r)}}var Ko,BS,NC=(BS=class{constructor(){ke(this,Ko)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Mx(this.gcTime)&&ue(this,Ko,Uo.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ha?1/0:5*60*1e3))}clearGcTimeout(){M(this,Ko)&&(Uo.clearTimeout(M(this,Ko)),ue(this,Ko,void 0))}},Ko=new WeakMap,BS),Go,Ol,Ts,Yo,un,rd,Qo,Qs,Fr,US,aM=(US=class extends NC{constructor(e){super();ke(this,Qs);ke(this,Go);ke(this,Ol);ke(this,Ts);ke(this,Yo);ke(this,un);ke(this,rd);ke(this,Qo);ue(this,Qo,!1),ue(this,rd,e.defaultOptions),this.setOptions(e.options),this.observers=[],ue(this,Yo,e.client),ue(this,Ts,M(this,Yo).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,ue(this,Go,Tw(this.options)),this.state=e.state??M(this,Go),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=M(this,un))==null?void 0:e.promise}setOptions(e){if(this.options={...M(this,rd),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Tw(this.options);n.data!==void 0&&(this.setState(Ew(n.data,n.dataUpdatedAt)),ue(this,Go,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&M(this,Ts).remove(this)}setData(e,n){const s=Dx(this.state.data,e,this.options);return Fe(this,Qs,Fr).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){Fe(this,Qs,Fr).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,r;const n=(s=M(this,un))==null?void 0:s.promise;return(r=M(this,un))==null||r.cancel(e),n?n.then(Sn).catch(Sn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(M(this,Go))}isActive(){return this.observers.some(e=>Rs(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Bv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Ji(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!kC(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=M(this,un))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=M(this,un))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),M(this,Ts).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(M(this,un)&&(M(this,Qo)?M(this,un).cancel({revert:!0}):M(this,un).cancelRetry()),this.scheduleGc()),M(this,Ts).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Fe(this,Qs,Fr).call(this,{type:"invalidate"})}async fetch(e,n){var l,u,d,h,f,p,w,x,y,g,m,b;if(this.state.fetchStatus!=="idle"&&((l=M(this,un))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(M(this,un))return M(this,un).continueRetry(),M(this,un).promise}if(e&&this.setOptions(e),!this.options.queryFn){const k=this.observers.find(_=>_.options.queryFn);k&&this.setOptions(k.options)}const s=new AbortController,r=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(ue(this,Qo,!0),s.signal)})},i=()=>{const k=_C(this.options,n),C=(()=>{const S={client:M(this,Yo),queryKey:this.queryKey,meta:this.meta};return r(S),S})();return ue(this,Qo,!1),this.options.persister?this.options.persister(k,C,this):k(C)},a=(()=>{const k={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:M(this,Yo),state:this.state,fetchFn:i};return r(k),k})();(u=this.options.behavior)==null||u.onFetch(a,this),ue(this,Ol,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=a.fetchOptions)==null?void 0:d.meta))&&Fe(this,Qs,Fr).call(this,{type:"fetch",meta:(h=a.fetchOptions)==null?void 0:h.meta}),ue(this,un,CC({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,onCancel:k=>{k instanceof $x&&k.revert&&this.setState({...M(this,Ol),fetchStatus:"idle"}),s.abort()},onFail:(k,_)=>{Fe(this,Qs,Fr).call(this,{type:"failed",failureCount:k,error:_})},onPause:()=>{Fe(this,Qs,Fr).call(this,{type:"pause"})},onContinue:()=>{Fe(this,Qs,Fr).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const k=await M(this,un).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(p=(f=M(this,Ts).config).onSuccess)==null||p.call(f,k,this),(x=(w=M(this,Ts).config).onSettled)==null||x.call(w,k,this.state.error,this),k}catch(k){if(k instanceof $x){if(k.silent)return M(this,un).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw Fe(this,Qs,Fr).call(this,{type:"error",error:k}),(g=(y=M(this,Ts).config).onError)==null||g.call(y,k,this),(b=(m=M(this,Ts).config).onSettled)==null||b.call(m,this.state.data,k,this),k}finally{this.scheduleGc()}}},Go=new WeakMap,Ol=new WeakMap,Ts=new WeakMap,Yo=new WeakMap,un=new WeakMap,rd=new WeakMap,Qo=new WeakMap,Qs=new WeakSet,Fr=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...EC(s.data,this.options),fetchMeta:e.meta??null};case"success":const r={...s,...Ew(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ue(this,Ol,e.manual?r:void 0),r;case"error":const i=e.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),Gt.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),M(this,Ts).notify({query:this,type:"updated",action:e})})},US);function EC(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:jC(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Ew(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Tw(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Gn,Ze,id,Mn,Xo,Ml,qr,Pi,od,Il,Dl,Jo,Zo,Ri,Ll,dt,Wc,Fx,zx,Bx,Ux,Hx,Wx,Vx,TC,HS,Hv=(HS=class extends wa{constructor(e,n){super();ke(this,dt);ke(this,Gn);ke(this,Ze);ke(this,id);ke(this,Mn);ke(this,Xo);ke(this,Ml);ke(this,qr);ke(this,Pi);ke(this,od);ke(this,Il);ke(this,Dl);ke(this,Jo);ke(this,Zo);ke(this,Ri);ke(this,Ll,new Set);this.options=n,ue(this,Gn,e),ue(this,Pi,null),ue(this,qr,Lx()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(M(this,Ze).addObserver(this),Pw(M(this,Ze),this.options)?Fe(this,dt,Wc).call(this):this.updateResult(),Fe(this,dt,Ux).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return qx(M(this,Ze),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return qx(M(this,Ze),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Fe(this,dt,Hx).call(this),Fe(this,dt,Wx).call(this),M(this,Ze).removeObserver(this)}setOptions(e){const n=this.options,s=M(this,Ze);if(this.options=M(this,Gn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Rs(this.options.enabled,M(this,Ze))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Fe(this,dt,Vx).call(this),M(this,Ze).setOptions(this.options),n._defaulted&&!Mu(this.options,n)&&M(this,Gn).getQueryCache().notify({type:"observerOptionsUpdated",query:M(this,Ze),observer:this});const r=this.hasListeners();r&&Rw(M(this,Ze),s,this.options,n)&&Fe(this,dt,Wc).call(this),this.updateResult(),r&&(M(this,Ze)!==s||Rs(this.options.enabled,M(this,Ze))!==Rs(n.enabled,M(this,Ze))||Ji(this.options.staleTime,M(this,Ze))!==Ji(n.staleTime,M(this,Ze)))&&Fe(this,dt,Fx).call(this);const i=Fe(this,dt,zx).call(this);r&&(M(this,Ze)!==s||Rs(this.options.enabled,M(this,Ze))!==Rs(n.enabled,M(this,Ze))||i!==M(this,Ri))&&Fe(this,dt,Bx).call(this,i)}getOptimisticResult(e){const n=M(this,Gn).getQueryCache().build(M(this,Gn),e),s=this.createResult(n,e);return cM(this,s)&&(ue(this,Mn,s),ue(this,Ml,this.options),ue(this,Xo,M(this,Ze).state)),s}getCurrentResult(){return M(this,Mn)}trackResult(e,n){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),n==null||n(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&M(this,qr).status==="pending"&&M(this,qr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){M(this,Ll).add(e)}getCurrentQuery(){return M(this,Ze)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=M(this,Gn).defaultQueryOptions(e),s=M(this,Gn).getQueryCache().build(M(this,Gn),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return Fe(this,dt,Wc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),M(this,Mn)))}createResult(e,n){var T;const s=M(this,Ze),r=this.options,i=M(this,Mn),o=M(this,Xo),a=M(this,Ml),u=e!==s?e.state:M(this,id),{state:d}=e;let h={...d},f=!1,p;if(n._optimisticResults){const P=this.hasListeners(),L=!P&&Pw(e,n),D=P&&Rw(e,s,n,r);(L||D)&&(h={...h,...EC(d.data,e.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:w,errorUpdatedAt:x,status:y}=h;p=h.data;let g=!1;if(n.placeholderData!==void 0&&p===void 0&&y==="pending"){let P;i!=null&&i.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData)?(P=i.data,g=!0):P=typeof n.placeholderData=="function"?n.placeholderData((T=M(this,Dl))==null?void 0:T.state.data,M(this,Dl)):n.placeholderData,P!==void 0&&(y="success",p=Dx(i==null?void 0:i.data,P,n),f=!0)}if(n.select&&p!==void 0&&!g)if(i&&p===(o==null?void 0:o.data)&&n.select===M(this,od))p=M(this,Il);else try{ue(this,od,n.select),p=n.select(p),p=Dx(i==null?void 0:i.data,p,n),ue(this,Il,p),ue(this,Pi,null)}catch(P){ue(this,Pi,P)}M(this,Pi)&&(w=M(this,Pi),p=M(this,Il),x=Date.now(),y="error");const m=h.fetchStatus==="fetching",b=y==="pending",k=y==="error",_=b&&m,C=p!==void 0,j={status:y,fetchStatus:h.fetchStatus,isPending:b,isSuccess:y==="success",isError:k,isInitialLoading:_,isLoading:_,data:p,dataUpdatedAt:h.dataUpdatedAt,error:w,errorUpdatedAt:x,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:m,isRefetching:m&&!b,isLoadingError:k&&!C,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:k&&C,isStale:Wv(e,n),refetch:this.refetch,promise:M(this,qr),isEnabled:Rs(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const P=O=>{j.status==="error"?O.reject(j.error):j.data!==void 0&&O.resolve(j.data)},L=()=>{const O=ue(this,qr,j.promise=Lx());P(O)},D=M(this,qr);switch(D.status){case"pending":e.queryHash===s.queryHash&&P(D);break;case"fulfilled":(j.status==="error"||j.data!==D.value)&&L();break;case"rejected":(j.status!=="error"||j.error!==D.reason)&&L();break}}return j}updateResult(){const e=M(this,Mn),n=this.createResult(M(this,Ze),this.options);if(ue(this,Xo,M(this,Ze).state),ue(this,Ml,this.options),M(this,Xo).data!==void 0&&ue(this,Dl,M(this,Ze)),Mu(n,e))return;ue(this,Mn,n);const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!M(this,Ll).size)return!0;const o=new Set(i??M(this,Ll));return this.options.throwOnError&&o.add("error"),Object.keys(M(this,Mn)).some(a=>{const l=a;return M(this,Mn)[l]!==e[l]&&o.has(l)})};Fe(this,dt,TC).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Fe(this,dt,Ux).call(this)}},Gn=new WeakMap,Ze=new WeakMap,id=new WeakMap,Mn=new WeakMap,Xo=new WeakMap,Ml=new WeakMap,qr=new WeakMap,Pi=new WeakMap,od=new WeakMap,Il=new WeakMap,Dl=new WeakMap,Jo=new WeakMap,Zo=new WeakMap,Ri=new WeakMap,Ll=new WeakMap,dt=new WeakSet,Wc=function(e){Fe(this,dt,Vx).call(this);let n=M(this,Ze).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Sn)),n},Fx=function(){Fe(this,dt,Hx).call(this);const e=Ji(this.options.staleTime,M(this,Ze));if(ha||M(this,Mn).isStale||!Mx(e))return;const s=kC(M(this,Mn).dataUpdatedAt,e)+1;ue(this,Jo,Uo.setTimeout(()=>{M(this,Mn).isStale||this.updateResult()},s))},zx=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(M(this,Ze)):this.options.refetchInterval)??!1},Bx=function(e){Fe(this,dt,Wx).call(this),ue(this,Ri,e),!(ha||Rs(this.options.enabled,M(this,Ze))===!1||!Mx(M(this,Ri))||M(this,Ri)===0)&&ue(this,Zo,Uo.setInterval(()=>{(this.options.refetchIntervalInBackground||Uv.isFocused())&&Fe(this,dt,Wc).call(this)},M(this,Ri)))},Ux=function(){Fe(this,dt,Fx).call(this),Fe(this,dt,Bx).call(this,Fe(this,dt,zx).call(this))},Hx=function(){M(this,Jo)&&(Uo.clearTimeout(M(this,Jo)),ue(this,Jo,void 0))},Wx=function(){M(this,Zo)&&(Uo.clearInterval(M(this,Zo)),ue(this,Zo,void 0))},Vx=function(){const e=M(this,Gn).getQueryCache().build(M(this,Gn),this.options);if(e===M(this,Ze))return;const n=M(this,Ze);ue(this,Ze,e),ue(this,id,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},TC=function(e){Gt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(M(this,Mn))}),M(this,Gn).getQueryCache().notify({query:M(this,Ze),type:"observerResultsUpdated"})})},HS);function lM(t,e){return Rs(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Pw(t,e){return lM(t,e)||t.state.data!==void 0&&qx(t,e,e.refetchOnMount)}function qx(t,e,n){if(Rs(e.enabled,t)!==!1&&Ji(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&Wv(t,e)}return!1}function Rw(t,e,n,s){return(t!==e||Rs(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Wv(t,n)}function Wv(t,e){return Rs(e.enabled,t)!==!1&&t.isStaleByTime(Ji(e.staleTime,t))}function cM(t,e){return!Mu(t.getCurrentResult(),e)}function Aw(t){return{onFetch:(e,n)=>{var d,h,f,p,w;const s=e.options,r=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((w=e.state.data)==null?void 0:w.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const u=async()=>{let x=!1;const y=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?x=!0:e.signal.addEventListener("abort",()=>{x=!0}),e.signal)})},g=_C(e.options,e.fetchOptions),m=async(b,k,_)=>{if(x)return Promise.reject();if(k==null&&b.pages.length)return Promise.resolve(b);const S=(()=>{const L={client:e.client,queryKey:e.queryKey,pageParam:k,direction:_?"backward":"forward",meta:e.options.meta};return y(L),L})(),j=await g(S),{maxPages:T}=e.options,P=_?tM:eM;return{pages:P(b.pages,j,T),pageParams:P(b.pageParams,k,T)}};if(r&&i.length){const b=r==="backward",k=b?uM:Ow,_={pages:i,pageParams:o},C=k(s,_);a=await m(_,C,b)}else{const b=t??i.length;do{const k=l===0?o[0]??s.initialPageParam:Ow(s,a);if(l>0&&k==null)break;a=await m(a,k),l++}while(l<b)}return a};e.options.persister?e.fetchFn=()=>{var x,y;return(y=(x=e.options).persister)==null?void 0:y.call(x,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function Ow(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function uM(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var ad,br,In,ea,wr,yi,WS,dM=(WS=class extends NC{constructor(e){super();ke(this,wr);ke(this,ad);ke(this,br);ke(this,In);ke(this,ea);ue(this,ad,e.client),this.mutationId=e.mutationId,ue(this,In,e.mutationCache),ue(this,br,[]),this.state=e.state||PC(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){M(this,br).includes(e)||(M(this,br).push(e),this.clearGcTimeout(),M(this,In).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){ue(this,br,M(this,br).filter(n=>n!==e)),this.scheduleGc(),M(this,In).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){M(this,br).length||(this.state.status==="pending"?this.scheduleGc():M(this,In).remove(this))}continue(){var e;return((e=M(this,ea))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,a,l,u,d,h,f,p,w,x,y,g,m,b,k,_,C,S,j,T;const n=()=>{Fe(this,wr,yi).call(this,{type:"continue"})},s={client:M(this,ad),meta:this.options.meta,mutationKey:this.options.mutationKey};ue(this,ea,CC({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(P,L)=>{Fe(this,wr,yi).call(this,{type:"failed",failureCount:P,error:L})},onPause:()=>{Fe(this,wr,yi).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>M(this,In).canRun(this)}));const r=this.state.status==="pending",i=!M(this,ea).canStart();try{if(r)n();else{Fe(this,wr,yi).call(this,{type:"pending",variables:e,isPaused:i}),await((a=(o=M(this,In).config).onMutate)==null?void 0:a.call(o,e,this,s));const L=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,e,s));L!==this.state.context&&Fe(this,wr,yi).call(this,{type:"pending",context:L,variables:e,isPaused:i})}const P=await M(this,ea).start();return await((h=(d=M(this,In).config).onSuccess)==null?void 0:h.call(d,P,e,this.state.context,this,s)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,P,e,this.state.context,s)),await((x=(w=M(this,In).config).onSettled)==null?void 0:x.call(w,P,null,this.state.variables,this.state.context,this,s)),await((g=(y=this.options).onSettled)==null?void 0:g.call(y,P,null,e,this.state.context,s)),Fe(this,wr,yi).call(this,{type:"success",data:P}),P}catch(P){try{throw await((b=(m=M(this,In).config).onError)==null?void 0:b.call(m,P,e,this.state.context,this,s)),await((_=(k=this.options).onError)==null?void 0:_.call(k,P,e,this.state.context,s)),await((S=(C=M(this,In).config).onSettled)==null?void 0:S.call(C,void 0,P,this.state.variables,this.state.context,this,s)),await((T=(j=this.options).onSettled)==null?void 0:T.call(j,void 0,P,e,this.state.context,s)),P}finally{Fe(this,wr,yi).call(this,{type:"error",error:P})}}finally{M(this,In).runNext(this)}}},ad=new WeakMap,br=new WeakMap,In=new WeakMap,ea=new WeakMap,wr=new WeakSet,yi=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Gt.batch(()=>{M(this,br).forEach(s=>{s.onMutationUpdate(e)}),M(this,In).notify({mutation:this,type:"updated",action:e})})},WS);function PC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Kr,Xs,ld,VS,hM=(VS=class extends wa{constructor(e={}){super();ke(this,Kr);ke(this,Xs);ke(this,ld);this.config=e,ue(this,Kr,new Set),ue(this,Xs,new Map),ue(this,ld,0)}build(e,n,s){const r=new dM({client:e,mutationCache:this,mutationId:++Kd(this,ld)._,options:e.defaultMutationOptions(n),state:s});return this.add(r),r}add(e){M(this,Kr).add(e);const n=dh(e);if(typeof n=="string"){const s=M(this,Xs).get(n);s?s.push(e):M(this,Xs).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(M(this,Kr).delete(e)){const n=dh(e);if(typeof n=="string"){const s=M(this,Xs).get(n);if(s)if(s.length>1){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}else s[0]===e&&M(this,Xs).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=dh(e);if(typeof n=="string"){const s=M(this,Xs).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===e}else return!0}runNext(e){var s;const n=dh(e);if(typeof n=="string"){const r=(s=M(this,Xs).get(n))==null?void 0:s.find(i=>i!==e&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Gt.batch(()=>{M(this,Kr).forEach(e=>{this.notify({type:"removed",mutation:e})}),M(this,Kr).clear(),M(this,Xs).clear()})}getAll(){return Array.from(M(this,Kr))}find(e){const n={exact:!0,...e};return this.getAll().find(s=>jw(n,s))}findAll(e={}){return this.getAll().filter(n=>jw(e,n))}notify(e){Gt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Gt.batch(()=>Promise.all(e.map(n=>n.continue().catch(Sn))))}},Kr=new WeakMap,Xs=new WeakMap,ld=new WeakMap,VS);function dh(t){var e;return(e=t.options.scope)==null?void 0:e.id}var Gr,Ai,Yn,Yr,ti,uf,Kx,qS,fM=(qS=class extends wa{constructor(n,s){super();ke(this,ti);ke(this,Gr);ke(this,Ai);ke(this,Yn);ke(this,Yr);ue(this,Gr,n),this.setOptions(s),this.bindMethods(),Fe(this,ti,uf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var r;const s=this.options;this.options=M(this,Gr).defaultMutationOptions(n),Mu(this.options,s)||M(this,Gr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:M(this,Yn),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&fa(s.mutationKey)!==fa(this.options.mutationKey)?this.reset():((r=M(this,Yn))==null?void 0:r.state.status)==="pending"&&M(this,Yn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=M(this,Yn))==null||n.removeObserver(this)}onMutationUpdate(n){Fe(this,ti,uf).call(this),Fe(this,ti,Kx).call(this,n)}getCurrentResult(){return M(this,Ai)}reset(){var n;(n=M(this,Yn))==null||n.removeObserver(this),ue(this,Yn,void 0),Fe(this,ti,uf).call(this),Fe(this,ti,Kx).call(this)}mutate(n,s){var r;return ue(this,Yr,s),(r=M(this,Yn))==null||r.removeObserver(this),ue(this,Yn,M(this,Gr).getMutationCache().build(M(this,Gr),this.options)),M(this,Yn).addObserver(this),M(this,Yn).execute(n)}},Gr=new WeakMap,Ai=new WeakMap,Yn=new WeakMap,Yr=new WeakMap,ti=new WeakSet,uf=function(){var s;const n=((s=M(this,Yn))==null?void 0:s.state)??PC();ue(this,Ai,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Kx=function(n){Gt.batch(()=>{var s,r,i,o,a,l,u,d;if(M(this,Yr)&&this.hasListeners()){const h=M(this,Ai).variables,f=M(this,Ai).context,p={client:M(this,Gr),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((r=(s=M(this,Yr)).onSuccess)==null||r.call(s,n.data,h,f,p),(o=(i=M(this,Yr)).onSettled)==null||o.call(i,n.data,null,h,f,p)):(n==null?void 0:n.type)==="error"&&((l=(a=M(this,Yr)).onError)==null||l.call(a,n.error,h,f,p),(d=(u=M(this,Yr)).onSettled)==null||d.call(u,void 0,n.error,h,f,p))}this.listeners.forEach(h=>{h(M(this,Ai))})})},qS);function Mw(t,e){const n=new Set(e);return t.filter(s=>!n.has(s))}function pM(t,e,n){const s=t.slice(0);return s[e]=n,s}var $l,hs,Fl,zl,Ps,Oi,cd,ud,dd,wn,Gx,Yx,Qx,Xx,Jx,KS,mM=(KS=class extends wa{constructor(e,n,s){super();ke(this,wn);ke(this,$l);ke(this,hs);ke(this,Fl);ke(this,zl);ke(this,Ps);ke(this,Oi);ke(this,cd);ke(this,ud);ke(this,dd,[]);ue(this,$l,e),ue(this,zl,s),ue(this,Fl,[]),ue(this,Ps,[]),ue(this,hs,[]),this.setQueries(n)}onSubscribe(){this.listeners.size===1&&M(this,Ps).forEach(e=>{e.subscribe(n=>{Fe(this,wn,Xx).call(this,e,n)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,M(this,Ps).forEach(e=>{e.destroy()})}setQueries(e,n){ue(this,Fl,e),ue(this,zl,n),Gt.batch(()=>{const s=M(this,Ps),r=Fe(this,wn,Qx).call(this,M(this,Fl));ue(this,dd,r),r.forEach(h=>h.observer.setOptions(h.defaultedQueryOptions));const i=r.map(h=>h.observer),o=i.map(h=>h.getCurrentResult()),a=s.length!==i.length,l=i.some((h,f)=>h!==s[f]),u=a||l,d=u?!0:o.some((h,f)=>{const p=M(this,hs)[f];return!p||!Mu(h,p)});!u&&!d||(u&&ue(this,Ps,i),ue(this,hs,o),this.hasListeners()&&(u&&(Mw(s,i).forEach(h=>{h.destroy()}),Mw(i,s).forEach(h=>{h.subscribe(f=>{Fe(this,wn,Xx).call(this,h,f)})})),Fe(this,wn,Jx).call(this)))})}getCurrentResult(){return M(this,hs)}getQueries(){return M(this,Ps).map(e=>e.getCurrentQuery())}getObservers(){return M(this,Ps)}getOptimisticResult(e,n){const s=Fe(this,wn,Qx).call(this,e),r=s.map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[r,i=>Fe(this,wn,Yx).call(this,i??r,n),()=>Fe(this,wn,Gx).call(this,r,s)]}},$l=new WeakMap,hs=new WeakMap,Fl=new WeakMap,zl=new WeakMap,Ps=new WeakMap,Oi=new WeakMap,cd=new WeakMap,ud=new WeakMap,dd=new WeakMap,wn=new WeakSet,Gx=function(e,n){return n.map((s,r)=>{const i=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?i:s.observer.trackResult(i,o=>{n.forEach(a=>{a.observer.trackProp(o)})})})},Yx=function(e,n){return n?((!M(this,Oi)||M(this,hs)!==M(this,ud)||n!==M(this,cd))&&(ue(this,cd,n),ue(this,ud,M(this,hs)),ue(this,Oi,zv(M(this,Oi),n(e)))),M(this,Oi)):e},Qx=function(e){const n=new Map;M(this,Ps).forEach(r=>{const i=r.options.queryHash;if(!i)return;const o=n.get(i);o?o.push(r):n.set(i,[r])});const s=[];return e.forEach(r=>{var l;const i=M(this,$l).defaultQueryOptions(r),a=((l=n.get(i.queryHash))==null?void 0:l.shift())??new Hv(M(this,$l),i);s.push({defaultedQueryOptions:i,observer:a})}),s},Xx=function(e,n){const s=M(this,Ps).indexOf(e);s!==-1&&(ue(this,hs,pM(M(this,hs),s,n)),Fe(this,wn,Jx).call(this))},Jx=function(){var e;if(this.hasListeners()){const n=M(this,Oi),s=Fe(this,wn,Gx).call(this,M(this,hs),M(this,dd)),r=Fe(this,wn,Yx).call(this,s,(e=M(this,zl))==null?void 0:e.combine);n!==r&&Gt.batch(()=>{this.listeners.forEach(i=>{i(M(this,hs))})})}},KS),kr,GS,gM=(GS=class extends wa{constructor(e={}){super();ke(this,kr);this.config=e,ue(this,kr,new Map)}build(e,n,s){const r=n.queryKey,i=n.queryHash??Fv(r,n);let o=this.get(i);return o||(o=new aM({client:e,queryKey:r,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(o)),o}add(e){M(this,kr).has(e.queryHash)||(M(this,kr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=M(this,kr).get(e.queryHash);n&&(e.destroy(),n===e&&M(this,kr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Gt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return M(this,kr).get(e)}getAll(){return[...M(this,kr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>Sw(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>Sw(e,s)):n}notify(e){Gt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Gt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Gt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},kr=new WeakMap,GS),Vt,Mi,Ii,Bl,Ul,Di,Hl,Wl,YS,xM=(YS=class{constructor(t={}){ke(this,Vt);ke(this,Mi);ke(this,Ii);ke(this,Bl);ke(this,Ul);ke(this,Di);ke(this,Hl);ke(this,Wl);ue(this,Vt,t.queryCache||new gM),ue(this,Mi,t.mutationCache||new hM),ue(this,Ii,t.defaultOptions||{}),ue(this,Bl,new Map),ue(this,Ul,new Map),ue(this,Di,0)}mount(){Kd(this,Di)._++,M(this,Di)===1&&(ue(this,Hl,Uv.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Vt).onFocus())})),ue(this,Wl,Yf.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,Vt).onOnline())})))}unmount(){var t,e;Kd(this,Di)._--,M(this,Di)===0&&((t=M(this,Hl))==null||t.call(this),ue(this,Hl,void 0),(e=M(this,Wl))==null||e.call(this),ue(this,Wl,void 0))}isFetching(t){return M(this,Vt).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return M(this,Mi).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,Vt).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=M(this,Vt).build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Ji(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return M(this,Vt).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),r=M(this,Vt).get(s.queryHash),i=r==null?void 0:r.state.data,o=XO(e,i);if(o!==void 0)return M(this,Vt).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Gt.batch(()=>M(this,Vt).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,Vt).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=M(this,Vt);Gt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=M(this,Vt);return Gt.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=Gt.batch(()=>M(this,Vt).findAll(t).map(r=>r.cancel(n)));return Promise.all(s).then(Sn).catch(Sn)}invalidateQueries(t,e={}){return Gt.batch(()=>(M(this,Vt).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=Gt.batch(()=>M(this,Vt).findAll(t).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(Sn)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Sn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=M(this,Vt).build(this,e);return n.isStaleByTime(Ji(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Sn).catch(Sn)}fetchInfiniteQuery(t){return t.behavior=Aw(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Sn).catch(Sn)}ensureInfiniteQueryData(t){return t.behavior=Aw(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Yf.isOnline()?M(this,Mi).resumePausedMutations():Promise.resolve()}getQueryCache(){return M(this,Vt)}getMutationCache(){return M(this,Mi)}getDefaultOptions(){return M(this,Ii)}setDefaultOptions(t){ue(this,Ii,t)}setQueryDefaults(t,e){M(this,Bl).set(fa(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...M(this,Bl).values()],n={};return e.forEach(s=>{Ou(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){M(this,Ul).set(fa(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...M(this,Ul).values()],n={};return e.forEach(s=>{Ou(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...M(this,Ii).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Fv(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Bv&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...M(this,Ii).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){M(this,Vt).clear(),M(this,Mi).clear()}},Vt=new WeakMap,Mi=new WeakMap,Ii=new WeakMap,Bl=new WeakMap,Ul=new WeakMap,Di=new WeakMap,Hl=new WeakMap,Wl=new WeakMap,YS),RC=v.createContext(void 0),Or=t=>{const e=v.useContext(RC);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},yM=({client:t,children:e})=>(v.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),c.jsx(RC.Provider,{value:t,children:e})),AC=v.createContext(!1),OC=()=>v.useContext(AC);AC.Provider;function vM(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var bM=v.createContext(vM()),MC=()=>v.useContext(bM),IC=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},DC=t=>{v.useEffect(()=>{t.clearReset()},[t])},LC=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:r})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(r&&t.data===void 0||SC(n,[t.error,s])),$C=t=>{if(t.suspense){const n=r=>r==="static"?r:Math.max(r??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...r)=>n(s(...r)):n(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},FC=(t,e)=>t.isLoading&&t.isFetching&&!e,Zx=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Qf=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function wM({queries:t,...e},n){const s=Or(),r=OC(),i=MC(),o=v.useMemo(()=>t.map(x=>{const y=s.defaultQueryOptions(x);return y._optimisticResults=r?"isRestoring":"optimistic",y}),[t,s,r]);o.forEach(x=>{$C(x),IC(x,i)}),DC(i);const[a]=v.useState(()=>new mM(s,o,e)),[l,u,d]=a.getOptimisticResult(o,e.combine),h=!r&&e.subscribed!==!1;v.useSyncExternalStore(v.useCallback(x=>h?a.subscribe(Gt.batchCalls(x)):Sn,[a,h]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),v.useEffect(()=>{a.setQueries(o,e)},[o,e,a]);const p=l.some((x,y)=>Zx(o[y],x))?l.flatMap((x,y)=>{const g=o[y];if(g){const m=new Hv(s,g);if(Zx(g,x))return Qf(g,m,i);FC(x,r)&&Qf(g,m,i)}return[]}):[];if(p.length>0)throw Promise.all(p);const w=l.find((x,y)=>{const g=o[y];return g&&LC({result:x,errorResetBoundary:i,throwOnError:g.throwOnError,query:s.getQueryCache().get(g.queryHash),suspense:g.suspense})});if(w!=null&&w.error)throw w.error;return u(d())}function kM(t,e,n){var h,f,p,w,x;const s=OC(),r=MC(),i=Or(),o=i.defaultQueryOptions(t);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,o),o._optimisticResults=s?"isRestoring":"optimistic",$C(o),IC(o,r),DC(r);const a=!i.getQueryCache().get(o.queryHash),[l]=v.useState(()=>new e(i,o)),u=l.getOptimisticResult(o),d=!s&&t.subscribed!==!1;if(v.useSyncExternalStore(v.useCallback(y=>{const g=d?l.subscribe(Gt.batchCalls(y)):Sn;return l.updateResult(),g},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),v.useEffect(()=>{l.setOptions(o)},[o,l]),Zx(o,u))throw Qf(o,l,r);if(LC({result:u,errorResetBoundary:r,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((w=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||w.call(p,o,u),o.experimental_prefetchInRender&&!ha&&FC(u,s)){const y=a?Qf(o,l,r):(x=i.getQueryCache().get(o.queryHash))==null?void 0:x.promise;y==null||y.catch(Sn).finally(()=>{l.updateResult()})}return o.notifyOnChangeProps?u:l.trackResult(u)}function en(t,e){return kM(t,Hv)}function _M(t,e){const n=Or(),[s]=v.useState(()=>new fM(n,t));v.useEffect(()=>{s.setOptions(t)},[s,t]);const r=v.useSyncExternalStore(v.useCallback(o=>s.subscribe(Gt.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((o,a)=>{s.mutate(o,a).catch(Sn)},[s]);if(r.error&&SC(s.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}const SM="modulepreload",jM=function(t){return"/"+t},Iw={},CM=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(l=>{if(l=jM(l),l in Iw)return;Iw[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":SM,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zC=(...t)=>t.filter((e,n,s)=>!!e&&s.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var EM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TM=v.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...a},l)=>v.createElement("svg",{ref:l,...EM,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:zC("lucide",r),...a},[...o.map(([u,d])=>v.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=(t,e)=>{const n=v.forwardRef(({className:s,...r},i)=>v.createElement(TM,{ref:i,iconNode:e,className:zC(`lucide-${NM(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=ot("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=ot("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=ot("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=ot("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=ot("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=ot("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=ot("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=ot("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=ot("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=ot("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=ot("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=ot("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MM=ot("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=ot("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=ot("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DM=ot("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=ot("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=ot("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=ot("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=ot("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=ot("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=ot("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=ot("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=ot("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=ot("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=ot("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=ot("UserRoundX",[["path",{d:"M2 21a8 8 0 0 1 11.873-7",key:"74fkxq"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m17 17 5 5",key:"p7ous7"}],["path",{d:"m22 17-5 5",key:"gqnmv0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=ot("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function qC(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=qC(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function KC(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=qC(t))&&(s&&(s+=" "),s+=e);return s}const Kv="-",WM=t=>{const e=qM(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const a=o.split(Kv);return a[0]===""&&a.length!==1&&a.shift(),GC(a,e)||VM(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&s[o]?[...l,...s[o]]:l}}},GC=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?GC(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const i=t.join(Kv);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},Lw=/^\[(.+)\]$/,VM=t=>{if(Lw.test(t)){const e=Lw.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},qM=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return GM(Object.entries(t.classGroups),n).forEach(([i,o])=>{ey(o,s,i,e)}),s},ey=(t,e,n,s)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?e:$w(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(KM(r)){ey(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([i,o])=>{ey(o,$w(e,i),n,s)})})},$w=(t,e)=>{let n=t;return e.split(Kv).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},KM=t=>t.isThemeGetter,GM=(t,e)=>e?t.map(([n,s])=>{const r=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,r]}):t,YM=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const r=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return r(i,o),o},set(i,o){n.has(i)?n.set(i,o):r(i,o)}}},YC="!",QM=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,r=e[0],i=e.length,o=a=>{const l=[];let u=0,d=0,h;for(let y=0;y<a.length;y++){let g=a[y];if(u===0){if(g===r&&(s||a.slice(y,y+i)===e)){l.push(a.slice(d,y)),d=y+i;continue}if(g==="/"){h=y;continue}}g==="["?u++:g==="]"&&u--}const f=l.length===0?a:a.substring(d),p=f.startsWith(YC),w=p?f.substring(1):f,x=h&&h>d?h-d:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:w,maybePostfixModifierPosition:x}};return n?a=>n({className:a,parseClassName:o}):o},XM=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},JM=t=>({cache:YM(t.cacheSize),parseClassName:QM(t),...WM(t)}),ZM=/\s+/,eI=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,i=[],o=t.trim().split(ZM);let a="";for(let l=o.length-1;l>=0;l-=1){const u=o[l],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=n(u);let w=!!p,x=s(w?f.substring(0,p):f);if(!x){if(!w){a=u+(a.length>0?" "+a:a);continue}if(x=s(f),!x){a=u+(a.length>0?" "+a:a);continue}w=!1}const y=XM(d).join(":"),g=h?y+YC:y,m=g+x;if(i.includes(m))continue;i.push(m);const b=r(x,w);for(let k=0;k<b.length;++k){const _=b[k];i.push(g+_)}a=u+(a.length>0?" "+a:a)}return a};function tI(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=QC(e))&&(s&&(s+=" "),s+=n);return s}const QC=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=QC(t[s]))&&(n&&(n+=" "),n+=e);return n};function nI(t,...e){let n,s,r,i=o;function o(l){const u=e.reduce((d,h)=>h(d),t());return n=JM(u),s=n.cache.get,r=n.cache.set,i=a,a(l)}function a(l){const u=s(l);if(u)return u;const d=eI(l,n);return r(l,d),d}return function(){return i(tI.apply(null,arguments))}}const jt=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},XC=/^\[(?:([a-z-]+):)?(.+)\]$/i,sI=/^\d+\/\d+$/,rI=new Set(["px","full","screen"]),iI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,oI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,aI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,lI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,cI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Lr=t=>bl(t)||rI.has(t)||sI.test(t),gi=t=>ic(t,"length",xI),bl=t=>!!t&&!Number.isNaN(Number(t)),Vm=t=>ic(t,"number",bl),Pc=t=>!!t&&Number.isInteger(Number(t)),uI=t=>t.endsWith("%")&&bl(t.slice(0,-1)),Ke=t=>XC.test(t),xi=t=>iI.test(t),dI=new Set(["length","size","percentage"]),hI=t=>ic(t,dI,JC),fI=t=>ic(t,"position",JC),pI=new Set(["image","url"]),mI=t=>ic(t,pI,vI),gI=t=>ic(t,"",yI),Rc=()=>!0,ic=(t,e,n)=>{const s=XC.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},xI=t=>oI.test(t)&&!aI.test(t),JC=()=>!1,yI=t=>lI.test(t),vI=t=>cI.test(t),bI=()=>{const t=jt("colors"),e=jt("spacing"),n=jt("blur"),s=jt("brightness"),r=jt("borderColor"),i=jt("borderRadius"),o=jt("borderSpacing"),a=jt("borderWidth"),l=jt("contrast"),u=jt("grayscale"),d=jt("hueRotate"),h=jt("invert"),f=jt("gap"),p=jt("gradientColorStops"),w=jt("gradientColorStopPositions"),x=jt("inset"),y=jt("margin"),g=jt("opacity"),m=jt("padding"),b=jt("saturate"),k=jt("scale"),_=jt("sepia"),C=jt("skew"),S=jt("space"),j=jt("translate"),T=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],L=()=>["auto",Ke,e],D=()=>[Ke,e],O=()=>["",Lr,gi],$=()=>["auto",bl,Ke],I=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],A=()=>["solid","dashed","dotted","double","none"],W=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],N=()=>["start","end","center","between","around","evenly","stretch"],E=()=>["","0",Ke],F=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>[bl,Ke];return{cacheSize:500,separator:":",theme:{colors:[Rc],spacing:[Lr,gi],blur:["none","",xi,Ke],brightness:V(),borderColor:[t],borderRadius:["none","","full",xi,Ke],borderSpacing:D(),borderWidth:O(),contrast:V(),grayscale:E(),hueRotate:V(),invert:E(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[uI,gi],inset:L(),margin:L(),opacity:V(),padding:D(),saturate:V(),scale:V(),sepia:E(),skew:V(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",Ke]}],container:["container"],columns:[{columns:[xi]}],"break-after":[{"break-after":F()}],"break-before":[{"break-before":F()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...I(),Ke]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Pc,Ke]}],basis:[{basis:L()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ke]}],grow:[{grow:E()}],shrink:[{shrink:E()}],order:[{order:["first","last","none",Pc,Ke]}],"grid-cols":[{"grid-cols":[Rc]}],"col-start-end":[{col:["auto",{span:["full",Pc,Ke]},Ke]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[Rc]}],"row-start-end":[{row:["auto",{span:[Pc,Ke]},Ke]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ke]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ke]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...N()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...N(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...N(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[m]}],px:[{px:[m]}],py:[{py:[m]}],ps:[{ps:[m]}],pe:[{pe:[m]}],pt:[{pt:[m]}],pr:[{pr:[m]}],pb:[{pb:[m]}],pl:[{pl:[m]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ke,e]}],"min-w":[{"min-w":[Ke,e,"min","max","fit"]}],"max-w":[{"max-w":[Ke,e,"none","full","min","max","fit","prose",{screen:[xi]},xi]}],h:[{h:[Ke,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ke,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ke,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ke,e,"auto","min","max","fit"]}],"font-size":[{text:["base",xi,gi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Vm]}],"font-family":[{font:[Rc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ke]}],"line-clamp":[{"line-clamp":["none",bl,Vm]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Lr,Ke]}],"list-image":[{"list-image":["none",Ke]}],"list-style-type":[{list:["none","disc","decimal",Ke]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...A(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Lr,gi]}],"underline-offset":[{"underline-offset":["auto",Lr,Ke]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...I(),fI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",hI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},mI]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...A(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:A()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...A()]}],"outline-offset":[{"outline-offset":[Lr,Ke]}],"outline-w":[{outline:[Lr,gi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Lr,gi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",xi,gI]}],"shadow-color":[{shadow:[Rc]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...W(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",xi,Ke]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ke]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",Ke]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ke]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Pc,Ke]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ke]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ke]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ke]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Lr,gi,Vm]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},wI=nI(bI);function Te(...t){return wI(KC(t))}function yn(t){return t.split(/\n|,/).map(e=>e.trim()).filter(Boolean)}function ty(t){if(!t)return{module:"",service:"",action:""};const[e,n,s]=t.split(":");return{module:(e==null?void 0:e.trim())||"",service:(n==null?void 0:n.trim())||"",action:(s==null?void 0:s.trim())||""}}function Fw({module:t,service:e,action:n}){return!t||!e||!n?"":`${t}:${e}:${n}`}function wl(t,e,n=`${e}s`){return t?`${t} ${t===1?e:n} selected`:`No ${n} selected`}function hf(t,e={}){return{...e,...t||{}}}function bt({className:t,...e}){return c.jsx("div",{className:Te("mmg-card rounded-2xl bg-white/70 dark:bg-white/5 backdrop-blur-xs shadow-soft","ring-1 ring-black/5 dark:ring-white/10",t),...e})}function Bt({className:t,...e}){return c.jsx("div",{className:Te("p-5 pb-3",t),...e})}function Yt({className:t,...e}){return c.jsx("h3",{className:Te("text-base font-semibold",t),...e})}function Ut({className:t,...e}){return c.jsx("div",{className:Te("p-5 pt-0",t),...e})}function zw(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function ka(...t){return e=>{let n=!1;const s=t.map(r=>{const i=zw(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():zw(t[r],null)}}}}function os(...t){return v.useCallback(ka(...t),t)}var kI=Symbol.for("react.lazy"),Xf=kp[" use ".trim().toString()];function _I(t){return typeof t=="object"&&t!==null&&"then"in t}function ZC(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===kI&&"_payload"in t&&_I(t._payload)}function SI(t){const e=CI(t),n=v.forwardRef((s,r)=>{let{children:i,...o}=s;ZC(i)&&typeof Xf=="function"&&(i=Xf(i._payload));const a=v.Children.toArray(i),l=a.find(EI);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}var jI=SI("Slot");function CI(t){const e=v.forwardRef((n,s)=>{let{children:r,...i}=n;if(ZC(r)&&typeof Xf=="function"&&(r=Xf(r._payload)),v.isValidElement(r)){const o=PI(r),a=TI(i,r.props);return r.type!==v.Fragment&&(a.ref=s?ka(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var NI=Symbol("radix.slottable");function EI(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===NI}function TI(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function PI(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const Bw=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Uw=KC,RI=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return Uw(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=Bw(d)||Bw(h);return r[u][f]}),a=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(w=>{let[x,y]=w;return Array.isArray(y)?y.includes({...i,...a}[x]):{...i,...a}[x]===y})?[...u,h,f]:u},[]);return Uw(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},AI=RI("inline-flex items-center justify-center whitespace-nowrap rounded-xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black/10 dark:focus-visible:ring-white/15 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"mmg-btn-primary bg-black text-white hover:bg-black/90 dark:bg-white dark:text-black dark:hover:bg-white/90 shadow-soft",secondary:"bg-black/5 text-black hover:bg-black/8 dark:bg-white/10 dark:text-white dark:hover:bg-white/15 shadow-soft",ghost:"bg-transparent hover:bg-black/5 text-black dark:text-white dark:hover:bg-white/10 shadow-soft"},size:{default:"h-10 px-4",sm:"h-9 px-3",lg:"h-11 px-5",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),te=ge.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...r},i)=>{const o=s?jI:"button";return c.jsx(o,{className:Te(AI({variant:e,size:n,className:t})),ref:i,...r})});te.displayName="Button";function Ye({text:t="Loading",className:e=""}){return c.jsxs("span",{className:["inline-flex items-center gap-2",e].filter(Boolean).join(" "),children:[c.jsx("span",{children:t}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function eN({size:t=128}){return c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("img",{src:"/logo.svg",width:t,height:t,alt:"",className:"shrink-0 filter invert dark:invert-0"}),c.jsx("span",{className:"mmg-brand-gold font-semibold text-lg leading-none tracking-tight hidden sm:inline-flex",children:"Nova"})]})}var Cr=function(){return Cr=Object.assign||function(e){for(var n,s=1,r=arguments.length;s<r;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Cr.apply(this,arguments)};function oc(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function OI(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(d){try{u(s.next(d))}catch(h){o(h)}}function l(d){try{u(s.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):r(d.value).then(a,l)}u((s=s.apply(t,e||[])).next())})}function MI(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}const II=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Gv extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class DI extends Gv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Hw extends Gv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ww extends Gv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ny;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ny||(ny={}));class LI{constructor(e,{headers:n={},customFetch:s,region:r=ny.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=II(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return OI(this,arguments,void 0,function*(n,s={}){var r;let i,o;try{const{headers:a,method:l,body:u,signal:d,timeout:h}=s;let f={},{region:p}=s;p||(p=this.region);const w=new URL(`${this.url}/${n}`);p&&p!=="any"&&(f["x-region"]=p,w.searchParams.set("forceFunctionRegion",p));let x;u&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",x=u):typeof u=="string"?(f["Content-Type"]="text/plain",x=u):typeof FormData<"u"&&u instanceof FormData?x=u:(f["Content-Type"]="application/json",x=JSON.stringify(u)):x=u;let y=d;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),d?(y=o.signal,d.addEventListener("abort",()=>o.abort())):y=o.signal);const g=yield this.fetch(w.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:x,signal:y}).catch(_=>{throw new DI(_)}),m=g.headers.get("x-relay-error");if(m&&m==="true")throw new Hw(g);if(!g.ok)throw new Ww(g);let b=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return b==="application/json"?k=yield g.json():b==="application/octet-stream"||b==="application/pdf"?k=yield g.blob():b==="text/event-stream"?k=g:b==="multipart/form-data"?k=yield g.formData():k=yield g.text(),{data:k,error:null,response:g}}catch(a){return{data:null,error:a,response:a instanceof Ww||a instanceof Hw?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var $I=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},FI=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,a=null,l=null,u=i.status,d=i.statusText;if(i.ok){var h,f;if(n.method!=="HEAD"){var p;const g=await i.text();g===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((p=n.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?a=g:a=JSON.parse(g))}const x=(h=n.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),y=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");x&&y&&y.length>1&&(l=parseInt(y[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,u=406,d="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var w;const x=await i.text();try{o=JSON.parse(x),Array.isArray(o)&&i.status===404&&(a=[],o=null,u=200,d="OK")}catch{i.status===404&&x===""?(u=204,d="No Content"):o={message:x}}if(o&&n.isMaybeSingle&&(!(o==null||(w=o.details)===null||w===void 0)&&w.includes("0 rows"))&&(o=null,u=200,d="OK"),o&&n.shouldThrowOnError)throw new $I(o)}return{error:o,data:a,count:l,status:u,statusText:d}});return this.shouldThrowOnError||(r=r.catch(i=>{var o;let a="";const l=i==null?void 0:i.cause;if(l){var u,d,h,f;const w=(u=l==null?void 0:l.message)!==null&&u!==void 0?u:"",x=(d=l==null?void 0:l.code)!==null&&d!==void 0?d:"";a=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,a+=`

Caused by: ${(f=l==null?void 0:l.name)!==null&&f!==void 0?f:"Error"}: ${w}`,x&&(a+=` (${x})`),l!=null&&l.stack&&(a+=`
${l.stack}`)}else{var p;a=(p=i==null?void 0:i.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},zI=class extends FI{select(t){let e=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:r=s}={}){const i=r?`${r}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:r=!1,format:i="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Vw=new RegExp("[,()]");var Qa=class extends zI{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&Vw.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&Vw.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${r}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},BI=class{constructor(t,{headers:e={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=s}select(t,e){const{head:n=!1,count:s}=e??{},r=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new Qa({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var s;const r="POST";if(e&&this.headers.append("Prefer",`count=${e}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,a)=>o.concat(Object.keys(a)),[]);if(i.length>0){const o=[...new Set(i)].map(a=>`"${a}"`);this.url.searchParams.set("columns",o.join(","))}}return new Qa({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(a.length>0){const l=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Qa({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var n;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new Qa({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Qa({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},UI=class tN{constructor(e,{headers:n={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new BI(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new tN(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:r=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let u;s||r?(a=s?"HEAD":"GET",Object.entries(n).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{l.searchParams.append(h,f)})):(a="POST",u=n);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new Qa({method:a,url:l,headers:d,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class HI{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const WI="2.88.0",VI=`realtime-js/${WI}`,nN="1.0.0",qI="2.0.0",qw=nN,sy=1e4,KI=1e3,GI=100;var ki;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ki||(ki={}));var rn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(rn||(rn={}));var Zs;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Zs||(Zs={}));var ry;(function(t){t.websocket="websocket"})(ry||(ry={}));var Lo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Lo||(Lo={}));class YI{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,s){var r,i;const o=e.topic,a=(r=e.ref)!==null&&r!==void 0?r:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+u.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let w=new DataView(p),x=0;w.setUint8(x++,this.KINDS.userBroadcastPush),w.setUint8(x++,l.length),w.setUint8(x++,a.length),w.setUint8(x++,o.length),w.setUint8(x++,u.length),w.setUint8(x++,h.length),w.setUint8(x++,n),Array.from(l,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(a,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(o,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(u,g=>w.setUint8(x++,g.charCodeAt(0))),Array.from(h,g=>w.setUint8(x++,g.charCodeAt(0)));var y=new Uint8Array(p.byteLength+s.byteLength);return y.set(new Uint8Array(p),0),y.set(new Uint8Array(s),p.byteLength),y.buffer}decode(e,n){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return n(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,i,o,a,l]=s;return n({join_ref:r,ref:i,topic:o,event:a,payload:l})}return n({})}_binaryDecode(e){const n=new DataView(e),s=n.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,r)}}_decodeUserBroadcast(e,n,s){const r=n.getUint8(1),i=n.getUint8(2),o=n.getUint8(3),a=n.getUint8(4);let l=this.HEADER_LENGTH+4;const u=s.decode(e.slice(l,l+r));l=l+r;const d=s.decode(e.slice(l,l+i));l=l+i;const h=s.decode(e.slice(l,l+o));l=l+o;const f=e.slice(l,e.byteLength),p=a===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,w={type:this.BROADCAST_EVENT,event:d,payload:p};return o>0&&(w.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>n.includes(s)))}}class sN{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var kt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(kt||(kt={}));const Kw=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=QI(o,t,e,r),i),{}):{}},QI=(t,e,n,s)=>{const r=e.find(a=>a.name===t),i=r==null?void 0:r.type,o=n[t];return i&&!s.includes(i)?rN(i,o):iy(o)},rN=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return eD(e,n)}switch(t){case kt.bool:return XI(e);case kt.float4:case kt.float8:case kt.int2:case kt.int4:case kt.int8:case kt.numeric:case kt.oid:return JI(e);case kt.json:case kt.jsonb:return ZI(e);case kt.timestamp:return tD(e);case kt.abstime:case kt.date:case kt.daterange:case kt.int4range:case kt.int8range:case kt.money:case kt.reltime:case kt.text:case kt.time:case kt.timestamptz:case kt.timetz:case kt.tsrange:case kt.tstzrange:return iy(e);default:return iy(e)}},iy=t=>t,XI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},JI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},ZI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},eD=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>rN(e,a))}return t},tD=t=>typeof t=="string"?t.replace(" ","T"):t,iN=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class qm{constructor(e,n,s={},r=sy){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Gw;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Gw||(Gw={}));class au{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=au.syncState(this.state,r,i,o),this.pendingDiffs.forEach(l=>{this.state=au.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=au.syncDiff(this.state,r,i,o),a())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const i=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(i,(u,d)=>{o[u]||(l[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(y=>y.presence_ref),p=h.map(y=>y.presence_ref),w=d.filter(y=>p.indexOf(y.presence_ref)<0),x=h.filter(y=>f.indexOf(y.presence_ref)<0);w.length>0&&(a[u]=w),x.length>0&&(l[u]=x)}else a[u]=d}),this.syncDiff(i,{joins:a,leaves:l},s,r)}static syncDiff(e,n,s,r){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(a,l)=>{var u;const d=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),d.length>0){const h=e[a].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...f)}s(a,d,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[a]=u,r(a,u,l),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Yw;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Yw||(Yw={}));var lu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(lu||(lu={}));var Hr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Hr||(Hr={}));class dl{constructor(e,n={config:{}},s){var r,i;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=rn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new qm(this,Zs.join,this.params,this.timeout),this.rejoinTimer=new sN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=rn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=rn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=rn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=rn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=rn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zs.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new au(this),this.broadcastEndpointURL=iN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==rn.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,u=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&r!==void 0?r:[],d=!!this.bindings[lu.PRESENCE]&&this.bindings[lu.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Hr.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Hr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(Hr.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,y=(w=x==null?void 0:x.length)!==null&&w!==void 0?w:0,g=[];for(let m=0;m<y;m++){const b=x[m],{filter:{event:k,schema:_,table:C,filter:S}}=b,j=p&&p[m];if(j&&j.event===k&&dl.isFilterValueEqual(j.schema,_)&&dl.isFilterValueEqual(j.table,C)&&dl.isFilterValueEqual(j.filter,S))g.push(Object.assign(Object.assign({},b),{id:j.id}));else{this.unsubscribe(),this.state=rn.errored,e==null||e(Hr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(Hr.SUBSCRIBED);return}}).receive("error",p=>{this.state=rn.errored,e==null||e(Hr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Hr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===rn.joined&&e===lu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var r;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const u=await a.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=rn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zs.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new qm(this,Zs.leave,{},e),s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=rn.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(i),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new qm(this,e,n,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>GI){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:d}=Zs;if(s&&[a,l,u,d].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,n,s);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var w,x,y;return((w=p.filter)===null||w===void 0?void 0:w.event)==="*"||((y=(x=p.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var w,x,y,g,m,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const k=p.id,_=(w=p.filter)===null||w===void 0?void 0:w.event;return k&&((x=n.ids)===null||x===void 0?void 0:x.includes(k))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const k=(m=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return k==="*"||k===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const w=f.data,{schema:x,table:y,commit_timestamp:g,type:m,errors:b}=w;f=Object.assign(Object.assign({},{schema:x,table:y,commit_timestamp:g,eventType:m,new:{},old:{},errors:b}),this._getPayloadRecords(w))}p.callback(f,s)})}_isClosed(){return this.state===rn.closed}_isJoined(){return this.state===rn.joined}_isJoining(){return this.state===rn.joining}_isLeaving(){return this.state===rn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),i={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&dl.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Zs.close,{},e)}_onError(e){this._on(Zs.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=rn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Kw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Kw(e.columns,e.old_record)),n}}const Km=()=>{},mh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},nD=[1e3,2e3,5e3,1e4],sD=1e4,rD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class iD{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=sy,this.transport=null,this.heartbeatIntervalMs=mh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Km,this.ref=0,this.reconnectTimer=null,this.vsn=qw,this.logger=Km,this.conn=null,this.sendBuffer=[],this.serializer=new YI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((s=n==null?void 0:n.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${ry.websocket}`,this.httpEndpoint=iN(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=HI.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ki.connecting:return Lo.Connecting;case ki.open:return Lo.Open;case ki.closing:return Lo.Closing;default:return Lo.Closed}}isConnected(){return this.connectionState()===Lo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new dl(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(KI,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},mh.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:i,ref:o}=n,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${r} ${a}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(r,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===ki.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ki.open||this.conn.readyState===ki.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Zs.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([rD],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,s=!1;if(e)n=e,s=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),n=this.accessTokenValue}else n=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:VI};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(Zs.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new sN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},mh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,r,i,o,a,l,u,d,h,f,p;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:sy,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:mh.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Km,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:qw,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:w=>nD[w-1]||sD,this.vsn){case nN:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(w,x)=>x(JSON.stringify(w)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(w,x)=>x(JSON.parse(w));break;case qI:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Iu=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function oD(t,e,n){const s=new URL(e,t);if(n)for(const[r,i]of Object.entries(n))i!==void 0&&s.searchParams.set(r,i);return s.toString()}async function aD(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function lD(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:s,query:r,body:i,headers:o}){const a=oD(t.baseUrl,s,r),l=await aD(t.auth),u=await e(a,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const p=h?f:void 0,w=p==null?void 0:p.error;throw new Iu((w==null?void 0:w.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function gh(t){return t.join("")}var cD=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:gh(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${gh(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gh(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${gh(t.namespace)}`}),!0}catch(e){if(e instanceof Iu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Iu&&n.status===409)return;throw n}}};function La(t){return t.join("")}var uD=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${La(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${La(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${La(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${La(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${La(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${La(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Iu&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Iu&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},dD=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=lD({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new cD(this.client,e),this.tableOps=new uD(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Fp=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function Ft(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var hD=class extends Fp{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},oy=class extends Fp{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Yv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),fD=()=>Response,ay=t=>{if(Array.isArray(t))return t.map(n=>ay(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=ay(s)}),e},pD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},mD=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Du(t){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Du(t)}function gD(t,e){if(Du(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Du(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xD(t){var e=gD(t,"string");return Du(e)=="symbol"?e:e+""}function yD(t,e,n){return(e=xD(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Be(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Qw(Object(n),!0).forEach(function(s){yD(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qw(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const Gm=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},vD=async(t,e,n)=>{t instanceof await fD()&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const r=t.status||500,i=(s==null?void 0:s.statusCode)||r+"";e(new hD(Gm(s),r,i))}).catch(s=>{e(new oy(Gm(s),s))}):e(new oy(Gm(t),t))},bD=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?r:(pD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),Be(Be({},r),n))};async function kd(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,bD(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>vD(l,a,s))})}async function Lu(t,e,n,s){return kd(t,"GET",e,n,s)}async function Ys(t,e,n,s,r){return kd(t,"POST",e,s,r,n)}async function ly(t,e,n,s,r){return kd(t,"PUT",e,s,r,n)}async function wD(t,e,n,s){return kd(t,"HEAD",e,Be(Be({},n),{},{noResolveJson:!0}),s)}async function Qv(t,e,n,s,r){return kd(t,"DELETE",e,s,r,n)}var kD=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Ft(e))return{data:null,error:e};throw e}}};let oN;oN=Symbol.toStringTag;var _D=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[oN]="BlobDownloadBuilder",this.promise=null}asStream(){return new kD(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Ft(e))return{data:null,error:e};throw e}}};const SD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var jD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=Yv(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,s){var r=this;try{let i;const o=Be(Be({},Xw),s);let a=Be(Be({},r.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",r.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",r.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=r.toBase64(r.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(a=Be(Be({},a),s.headers));const u=r._removeEmptyFolders(e),d=r._getFinalPath(u),h=await(t=="PUT"?ly:Ys)(r.fetch,`${r.url}/object/${d}`,i,Be({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(r.shouldThrowOnError)throw i;if(Ft(i))return{data:null,error:i};throw i}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,s){var r=this;const i=r._removeEmptyFolders(t),o=r._getFinalPath(i),a=new URL(r.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l;const u=Be({upsert:Xw.upsert},s),d=Be(Be({},r.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await ly(r.fetch,a.toString(),l,{headers:d})).Key},error:null}}catch(l){if(r.shouldThrowOnError)throw l;if(Ft(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var n=this;try{let s=n._getFinalPath(t);const r=Be({},n.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const i=await Ys(n.fetch,`${n.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(n.url+i.url),a=o.searchParams.get("token");if(!a)throw new Fp("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ft(s))return{data:null,error:s};throw s}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var s=this;try{return{data:await Ys(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers}),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async copy(t,e,n){var s=this;try{return{data:{path:(await Ys(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:s.headers})).Key},error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async createSignedUrl(t,e,n){var s=this;try{let r=s._getFinalPath(t),i=await Ys(s.fetch,`${s.url}/object/sign/${r}`,Be({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:s.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async createSignedUrls(t,e,n){var s=this;try{const r=await Ys(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:r.map(o=>Be(Be({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),r=s?`?${s}`:"",i=this._getFinalPath(t),o=()=>Lu(this.fetch,`${this.url}/${n}/${i}${r}`,{headers:this.headers,noResolveJson:!0});return new _D(o,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:ay(await Lu(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Ft(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await wD(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Ft(s)&&s instanceof oy){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&s.push(o);let a=s.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${a}`)}}}async remove(t){var e=this;try{return{data:await Qv(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async list(t,e,n){var s=this;try{const r=Be(Be(Be({},SD),e),{},{prefix:t||""});return{data:await Ys(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},n),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Ft(r))return{data:null,error:r};throw r}}async listV2(t,e){var n=this;try{const s=Be({},t);return{data:await Ys(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,s,{headers:n.headers},e),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ft(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const aN="2.88.0",lN={"X-Client-Info":`storage-js/${aN}`};var CD=class{constructor(t,e={},n,s){this.shouldThrowOnError=!1;const r=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Be(Be({},lN),e),this.fetch=Yv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await Lu(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await Lu(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await Ys(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ft(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var n=this;try{return{data:await ly(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ft(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await Ys(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Qv(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},ND=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},lN),e),this.fetch=Yv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Ys(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const s=n.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Lu(e.fetch,r,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Qv(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ft(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!mD(t))throw new Fp("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new dD({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(n,{get(r,i){const o=r[i];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(r,a),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const Xv={"X-Client-Info":`storage-js/${aN}`,"Content-Type":"application/json"};var cN=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function ms(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Ym=class extends cN{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ED=class extends cN{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Jv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),TD=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Jw=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),PD=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const s=t.status||500,r=t;if(typeof r.json=="function")r.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new Ym(Jw(i),s,o))}).catch(()=>{const i=s+"";e(new Ym(r.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new Ym(r.statusText||`HTTP ${s} error`,s,i))}}else e(new ED(Jw(t),t))},RD=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(TD(s)?(r.headers=Be({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,Be(Be({},r),n)):r};async function AD(t,e,n,s,r,i){return new Promise((o,a)=>{t(n,RD(e,s,r,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const u=l.headers.get("content-type");return!u||!u.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>PD(l,a,s))})}async function gs(t,e,n,s,r){return AD(t,"POST",e,s,r,n)}var OD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},Xv),e),this.fetch=Jv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await gs(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await gs(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ms(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await gs(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await gs(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ms(s))return{data:null,error:s};throw s}}},MD=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},Xv),e),this.fetch=Jv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await gs(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await gs(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await gs(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await gs(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await gs(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}},ID=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Be(Be({},Xv),e),this.fetch=Jv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await gs(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await gs(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await gs(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await gs(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(ms(n))return{data:null,error:n};throw n}}},DD=class extends ID{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new LD(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},LD=class extends OD{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new $D(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},$D=class extends MD{constructor(t,e,n,s,r){super(t,e,r),this.vectorBucketName=n,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,Be(Be({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},FD=class extends CD{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new jD(this.url,this.headers,t,this.fetch)}get vectors(){return new DD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ND(this.url+"/iceberg",this.headers,this.fetch)}};const uN="2.88.0",Xa=30*1e3,cy=3,Qm=cy*Xa,zD="http://localhost:9999",BD="supabase.auth.token",UD={"X-Client-Info":`gotrue-js/${uN}`},uy="X-Supabase-Api-Version",dN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},HD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,WD=10*60*1e3;class $u extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Re(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class VD extends $u{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function qD(t){return Re(t)&&t.name==="AuthApiError"}class $o extends $u{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class di extends $u{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class us extends di{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function KD(t){return Re(t)&&t.name==="AuthSessionMissingError"}class $a extends di{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xh extends di{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class yh extends di{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function GD(t){return Re(t)&&t.name==="AuthImplicitGrantRedirectError"}class Zw extends di{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class YD extends di{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class dy extends di{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Xm(t){return Re(t)&&t.name==="AuthRetryableFetchError"}class ek extends di{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class hy extends di{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),tk=` 	
\r=`.split(""),QD=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<tk.length;e+=1)t[tk[e].charCodeAt(0)]=-2;for(let e=0;e<Jf.length;e+=1)t[Jf[e].charCodeAt(0)]=e;return t})();function nk(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Jf[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Jf[s]),e.queuedBits-=6}}function hN(t,e,n){const s=QD[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function sk(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=o=>{ZD(o,s,n)};for(let o=0;o<t.length;o+=1)hN(t.charCodeAt(o),r,i);return e.join("")}function XD(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function JD(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}XD(s,e)}}function ZD(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function kl(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)hN(t.charCodeAt(r),n,s);return new Uint8Array(e)}function eL(t){const e=[];return JD(t,n=>e.push(n)),new Uint8Array(e)}function Ho(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>nk(r,n,s)),nk(null,n,s),e.join("")}function tL(t){return Math.round(Date.now()/1e3)+t}function nL(){return Symbol("auth-callback")}const gn=()=>typeof window<"u"&&typeof document<"u",No={tested:!1,writable:!1},fN=()=>{if(!gn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(No.tested)return No.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),No.tested=!0,No.writable=!0}catch{No.tested=!0,No.writable=!1}return No.writable};function sL(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const pN=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),rL=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ja=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Eo=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},mn=async(t,e)=>{await t.removeItem(e)};class zp{constructor(){this.promise=new zp.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}zp.promiseConstructor=Promise;function Jm(t){const e=t.split(".");if(e.length!==3)throw new hy("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!HD.test(e[s]))throw new hy("JWT not in base64url format");return{header:JSON.parse(sk(e[0])),payload:JSON.parse(sk(e[1])),signature:kl(e[2]),raw:{header:e[0],payload:e[1]}}}async function iL(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function oL(t,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function aL(t){return("0"+t.toString(16)).substr(-2)}function lL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let i=0;i<56;i++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,aL).join("")}async function cL(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function uL(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await cL(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fa(t,e,n=!1){const s=lL();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await Ja(t,`${e}-code-verifier`,r);const i=await uL(s);return[i,s===i?"plain":"s256"]}const dL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function hL(t){const e=t.headers.get(uy);if(!e||!e.match(dL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function fL(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function pL(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const mL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function za(t){if(!mL.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Zm(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function gL(t,e){return new Proxy(t,{get:(n,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,r)}})}function rk(t){return JSON.parse(JSON.stringify(t))}const Mo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),xL=[502,503,504];async function ik(t){var e;if(!rL(t))throw new dy(Mo(t),0);if(xL.includes(t.status))throw new dy(Mo(t),t.status);let n;try{n=await t.json()}catch(i){throw new $o(Mo(i),i)}let s;const r=hL(t);if(r&&r.getTime()>=dN["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new ek(Mo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new us}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new ek(Mo(n),t.status,n.weak_password.reasons);throw new VD(Mo(n),t.status||500,s)}const yL=(t,e,n,s)=>{const r={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function ze(t,e,n,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[uy]||(i[uy]=dN["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await vL(t,e,n+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function vL(t,e,n,s,r,i){const o=yL(e,s,r,i);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new dy(Mo(l),0)}if(a.ok||await ik(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await ik(l)}}function Ks(t){var e;let n=null;kL(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=tL(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function ok(t){const e=Ks(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ji(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function bL(t){return{data:t,error:null}}function wL(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i}=t,o=oc(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function ak(t){return t}function kL(t){return t.access_token&&t.refresh_token&&t.expires_in}const eg=["global","local","others"];class _L{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=pN(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=eg[0]){if(eg.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${eg.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Re(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ji})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=oc(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:wL,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Re(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ji})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:ak});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(w=>{const x=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(w.split(";")[1].split("=")[1]);u[`${y}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Re(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){za(e);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ji})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){za(e);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:ji})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){za(e);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:ji})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){za(e.userId);try{const{data:n,error:s}=await ze(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _deleteFactor(e){za(e.userId),za(e.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,r,i,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:ak});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=d.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(w=>{const x=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(w.split(";")[1].split("=")[1]);u[`${y}Page`]=x}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Re(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}}function lk(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Ba={debug:!!(globalThis&&fN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class mN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class SL extends mN{}async function jL(t,e,n){Ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ba.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{Ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw Ba.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new SL(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ba.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function CL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function gN(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function NL(t){return parseInt(t,16)}function EL(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function TL(t){var e;const{chainId:n,domain:s,expirationTime:r,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=gN(t.address),w=d?`${d}://${s}`:s,x=t.statement?`${t.statement}
`:"",y=`${w} wants you to sign in with your Ethereum account:
${p}

${x}`;let g=`URI: ${h}
Version: ${f}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(r&&(g+=`
Expiration Time: ${r.toISOString()}`),a&&(g+=`
Not Before: ${a.toISOString()}`),l&&(g+=`
Request ID: ${l}`),u){let m=`
Resources:`;for(const b of u){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);m+=`
- ${b}`}g+=m}return`${y}
${g}`}class Jt extends Error{constructor({message:e,code:n,cause:s,name:r}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=r??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class Zf extends Jt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function PL({error:t,options:e}){var n,s,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Jt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Jt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Jt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Jt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Jt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Jt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new Jt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Jt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(xN(o)){if(i.rp.id!==o)return new Jt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Jt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Jt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Jt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Jt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function RL({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Jt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Jt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(xN(s)){if(n.rpId!==s)return new Jt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Jt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Jt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Jt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class AL{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const OL=new AL;function ML(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,r=oc(t,["challenge","user","excludeCredentials"]),i=kl(e).buffer,o=Object.assign(Object.assign({},n),{id:kl(n.id).buffer}),a=Object.assign(Object.assign({},r),{challenge:i,user:o});if(s&&s.length>0){a.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const u=s[l];a.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:kl(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function IL(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=oc(t,["challenge","allowCredentials"]),r=kl(e).buffer,i=Object.assign(Object.assign({},s),{challenge:r});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const a=n[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:kl(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function DL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Ho(new Uint8Array(t.response.attestationObject)),clientDataJSON:Ho(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function LL(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Ho(new Uint8Array(r.authenticatorData)),clientDataJSON:Ho(new Uint8Array(r.clientDataJSON)),signature:Ho(new Uint8Array(r.signature)),userHandle:r.userHandle?Ho(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function xN(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function ck(){var t,e;return!!(gn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function $L(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Zf("Browser returned unexpected credential type",e)}:{data:null,error:new Zf("Empty credential response",e)}}catch(e){return{data:null,error:PL({error:e,options:t})}}}async function FL(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Zf("Browser returned unexpected credential type",e)}:{data:null,error:new Zf("Empty credential response",e)}}catch(e){return{data:null,error:RL({error:e,options:t})}}}const zL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},BL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ep(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const i in r){const o=r[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(n(o))s[i]=o;else if(e(o)){const a=s[i];e(a)?s[i]=ep(a,o):s[i]=ep(o)}else s[i]=o}return s}function UL(t,e){return ep(zL,t,e||{})}function HL(t,e){return ep(BL,t,e||{})}class WL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:r},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!o)return{data:null,error:a};const l=r??OL.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=UL(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:h}=await $L({publicKey:u,signal:l});return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=HL(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:h}=await FL(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(o){return Re(o)?{data:null,error:o}:{data:null,error:new $o("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new $u("rpId is required for WebAuthn authentication")};try{if(!ck())return{data:null,error:new $o("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:r},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:s,credential_response:l.credential_response}})}catch(o){return Re(o)?{data:null,error:o}:{data:null,error:new $o("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!n)return{data:null,error:new $u("rpId is required for WebAuthn registration")};try{if(!ck())return{data:null,error:new $o("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:a};const{data:l,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:r},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Re(o)?{data:null,error:o}:{data:null,error:new $o("Unexpected error in register",o)}}}}CL();const VL={url:zD,storageKey:BD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function uk(t,e,n){return await n()}const Ua={};class Fu{get jwks(){var e,n;return(n=(e=Ua[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Ua[this.storageKey]=Object.assign(Object.assign({},Ua[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Ua[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ua[this.storageKey]=Object.assign(Object.assign({},Ua[this.storageKey]),{cachedAt:e})}constructor(e){var n,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},VL),e);if(this.storageKey=i.storageKey,this.instanceID=(n=Fu.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Fu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&gn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new _L({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=pN(i.fetch),this.lock=i.lock||uk,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&gn()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=jL:this.lock=uk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new WL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:fN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lk(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=lk(this.memoryStorage)),gn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${uN}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(gn()&&(n=sL(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),gn()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(n,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),GD(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Re(n)?this._returnResult({error:n}):this._returnResult({error:new $o("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ks}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(Re(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,s,r;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,w=null;this.flowType==="pkce"&&([p,w]=await Fa(this.storage,this.storageKey)),i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:w},xform:Ks})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ks})}else throw new xh("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return await mn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(await mn(this.storage,`${this.storageKey}-code-verifier`),Re(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:ok})}else if("phone"in e){const{phone:i,password:o,options:a}=e;n=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:ok})}else throw new xh("You must provide either an email or phone number and a password");const{data:s,error:r}=n;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const i=new $a;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,r,i,o,a,l,u,d,h,f;let p,w;if("message"in e)p=e.message,w=e.signature;else{const{chain:x,wallet:y,statement:g,options:m}=e;let b;if(gn())if(typeof y=="object")b=y;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")b=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const k=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href),_=await b.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=gN(_[0]);let S=(s=m==null?void 0:m.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!S){const T=await b.request({method:"eth_chainId"});S=NL(T)}const j={domain:k.host,address:C,statement:g,uri:k.href,version:"1",chainId:S,nonce:(r=m==null?void 0:m.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(i=m==null?void 0:m.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=m==null?void 0:m.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=m==null?void 0:m.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=m==null?void 0:m.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=m==null?void 0:m.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=TL(j),w=await b.request({method:"personal_sign",params:[EL(p),C]})}try{const{data:x,error:y}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:w},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Ks});if(y)throw y;if(!x||!x.session||!x.user){const g=new $a;return this._returnResult({data:{user:null,session:null},error:g})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:y})}catch(x){if(Re(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async signInWithSolana(e){var n,s,r,i,o,a,l,u,d,h,f,p;let w,x;if("message"in e)w=e.message,x=e.signature;else{const{chain:y,wallet:g,statement:m,options:b}=e;let k;if(gn())if(typeof g=="object")k=g;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))k=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const _=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in k&&k.signIn){const C=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),m?{statement:m}:null));let S;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")S=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)S=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)w=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),x=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${_.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(r=(s=b==null?void 0:b.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((a=b==null?void 0:b.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((u=b==null?void 0:b.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(d=b==null?void 0:b.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const C=await k.signMessage(new TextEncoder().encode(w),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=C}}try{const{data:y,error:g}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Ho(x)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ks});if(g)throw g;if(!y||!y.session||!y.user){const m=new $a;return this._returnResult({data:{user:null,session:null},error:m})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:g})}catch(y){if(Re(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const n=await Eo(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{if(!s&&this.flowType==="pkce")throw new YD;const{data:i,error:o}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ks});if(await mn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new $a;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}catch(i){if(await mn(this.storage,`${this.storageKey}-code-verifier`),Re(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:i,nonce:o}=e,a=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ks}),{data:l,error:u}=a;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new $a;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,r,i,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Fa(this.storage,this.storageKey));const{error:h}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:d}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new xh("You must provide either an email or phone number.")}catch(a){if(await mn(this.storage,`${this.storageKey}-code-verifier`),Re(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,s;try{let r,i;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Ks});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(r){if(Re(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var n,s,r,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await Fa(this.storage,this.storageKey));const u=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:bL});return!((i=u.data)===null||i===void 0)&&i.url&&gn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(a){if(await mn(this.storage,`${this.storageKey}-code-verifier`),Re(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new us;const{error:r}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(Re(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:a}=await ze(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new xh("You must provide either an email or phone number and a type")}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Eo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Qm:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Eo(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Zm()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=gL(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ji}):await this._useSession(async n=>{var s,r,i;const{data:o,error:a}=n;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new us}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:ji})})}catch(n){if(Re(n))return KD(n)&&(await this._removeSession(),await mn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new us;const o=r.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Fa(this.storage,this.storageKey));const{data:u,error:d}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:ji});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await mn(this.storage,`${this.storageKey}-code-verifier`),Re(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new us;const n=Date.now()/1e3;let s=n,r=!0,i=null;const{payload:o}=Jm(e.access_token);if(o.exp&&(s=o.exp,r=s<=n),r){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(Re(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new us;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Re(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!gn())throw new yh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new yh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Zw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new yh("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Zw("No code detected.");const{data:m,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!i||!a||!o||!u)throw new yh("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(a);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=Xa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const w=f-h;d-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,f,d):d-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,f,d);const{data:x,error:y}=await this._getUser(i);if(y)throw y;const g={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(s){if(Re(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Eo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({error:i});const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(qD(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await mn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=nL(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:i},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Fa(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await mn(this.storage,`${this.storageKey}-code-verifier`),Re(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:r}=await this._useSession(async i=>{var o,a,l,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(r)throw r;return gn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Re(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:r,data:{session:i}}=n;if(r)throw r;const{options:o,provider:a,token:l,access_token:u,nonce:d}=e,h=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:a,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ks}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new $a}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(r){if(await mn(this.storage,`${this.storageKey}-code-verifier`),Re(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)throw o;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await oL(async r=>(r>0&&await iL(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ks})),(r,i)=>{const o=200*Math.pow(2,r);return i&&Xm(i)&&Date.now()+o-s<Xa})}catch(s){if(this._debug(n,"error",s),Re(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),gn()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Eo(this.storage,this.storageKey);if(r&&this.userStorage){let o=await Eo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await Ja(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Zm()}else if(r&&!r.user&&!r.user){const o=await Eo(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(r.user=o.user,await mn(this.storage,this.storageKey+"-user"),await Ja(this.storage,this.storageKey,r)):r.user=Zm()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const i=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Qm;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Qm}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),Xm(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(r.access_token);!a&&(o!=null&&o.user)?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new us;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new zp;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new us;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(r,"error",i),Re(i)){const o={data:null,error:i};return Xm(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await mn(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await Ja(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const i=rk(r);await Ja(this.storage,this.storageKey,i)}else{const r=rk(n);await Ja(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await mn(this.storage,this.storageKey),await mn(this.storage,this.storageKey+"-code-verifier"),await mn(this.storage,this.storageKey+"-user"),this.userStorage&&await mn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&gn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xa);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/Xa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Xa}ms, refresh threshold is ${cy} ticks`),r<=cy&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof mN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!gn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Fa(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(a.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;return i?this._returnResult({data:null,error:i}):await ze(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:i,error:o}=n;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&l.type==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?DL(e.webauthn.credential_response):LL(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=await ze(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:ML(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:IL(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Jm(s.access_token);let o=null;i.aal&&(o=i.aal);let a=o;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(a="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new us})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new us});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&gn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new us});const o=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&gn()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;return s?this._returnResult({data:null,error:s}):n?await ze(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new us})})}catch(e){if(Re(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?(await ze(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new us})})}catch(n){if(Re(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(a=>a.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+WD>r)return s;const{data:i,error:o}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:p,error:w}=await this.getSession();if(w||!p.session)return this._returnResult({data:null,error:w});s=p.session.access_token}const{header:r,payload:i,signature:o,raw:{header:a,payload:l}}=Jm(s);n!=null&&n.allowExpired||fL(i.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:r,signature:o},error:null}}const d=pL(r.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,eL(`${a}.${l}`)))throw new hy("Invalid JWT signature");return{data:{claims:i,header:r,signature:o},error:null}}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}}Fu.nextInstanceID={};const qL=Fu,KL="2.88.0";let Vc="";typeof Deno<"u"?Vc="deno":typeof document<"u"?Vc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Vc="react-native":Vc="node";const GL={"X-Client-Info":`supabase-js-${Vc}/${KL}`},YL={headers:GL},QL={schema:"public"},XL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},JL={};function zu(t){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zu(t)}function ZL(t,e){if(zu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(zu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e5(t){var e=ZL(t,"string");return zu(e)=="symbol"?e:e+""}function t5(t,e,n){return(e=e5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function qt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dk(Object(n),!0).forEach(function(s){t5(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dk(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const n5=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),s5=()=>Headers,r5=(t,e,n)=>{const s=n5(n),r=s5();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:t;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),s(i,qt(qt({},o),{},{headers:u}))}};function i5(t){return t.endsWith("/")?t:t+"/"}function o5(t,e){var n,s;const{db:r,auth:i,realtime:o,global:a}=t,{db:l,auth:u,realtime:d,global:h}=e,f={db:qt(qt({},l),r),auth:qt(qt({},u),i),realtime:qt(qt({},d),o),storage:{},global:qt(qt(qt({},h),a),{},{headers:qt(qt({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(s=a==null?void 0:a.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function a5(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(i5(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var l5=class extends qL{constructor(t){super(t)}},c5=class{constructor(t,e,n){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const i=a5(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a={db:QL,realtime:JL,auth:qt(qt({},XL),{},{storageKey:o}),global:YL},l=o5(n??{},a);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=l.global.headers)!==null&&r!==void 0?r:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=r5(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(qt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new UI(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new FD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new LI(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new l5({url:this.authUrl.href,headers:qt(qt({},f),d),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,flowType:o,lock:a,debug:l,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new iD(this.realtimeUrl.href,qt(qt({},t),{},{params:qt(qt({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const u5=(t,e,n)=>new c5(t,e,n);function d5(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}d5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ac={SUPABASE_URL:window.SUPABASE_URL||void 0||"",SUPABASE_ANON_KEY:window.SUPABASE_ANON_KEY||void 0||"",API_BASE_URL:window.API_BASE_URL||void 0||""};let vh=null;function Zv(){if(vh)return vh;const{SUPABASE_URL:t,SUPABASE_ANON_KEY:e}=ac;return!t||!e?null:(vh=u5(t,e),vh)}const e0="authToken";function Bp(){return localStorage.getItem(e0)}function hl(t){t&&localStorage.setItem(e0,t)}function Zi(){localStorage.removeItem(e0)}let tg=!1,bh=null;async function yN(){var r;const t=Bp();if(t)return t;const e=Zv();if(!e)return null;const{data:n}=await e.auth.getSession(),s=((r=n==null?void 0:n.session)==null?void 0:r.access_token)||null;return s&&hl(s),s}async function vN(){return tg||(tg=!0,bh=(async()=>{var t;try{const e=Zv();if(!e)return null;const{data:n,error:s}=await e.auth.refreshSession();return s||!((t=n.session)!=null&&t.access_token)?null:(hl(n.session.access_token),n.session.access_token)}catch(e){return console.error("Token refresh failed:",e),null}finally{tg=!1,bh=null}})()),bh}async function Me(t,e={}){const{baseUrl:n,...s}=e,r=`${n??ac.API_BASE_URL}${t}`,i=new Headers(s.headers||{});!(s.body instanceof FormData)&&!i.has("Content-Type")&&i.set("Content-Type","application/json");const a=await yN();a&&!i.has("Authorization")&&i.set("Authorization",`Bearer ${a}`);let l=await fetch(r,{...s,headers:i});if(l.status===401){const d=await vN();if(d){if(i.set("Authorization",`Bearer ${d}`),l=await fetch(r,{...s,headers:i}),!(l.ok||l.status!==401))return Zi(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return Zi(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!l.ok){const d=await l.json().catch(()=>({detail:"Request failed"})),h=new Error(d.detail||d.error||`Request failed: ${l.status}`);throw h.status=l.status,h.data=d,h}return l.status===204?null:(l.headers.get("content-type")||"").includes("application/json")?l.json():l}async function bN(t,e={}){const{baseUrl:n,...s}=e,r=`${n??ac.API_BASE_URL}${t}`,i=new Headers(s.headers||{}),o=await yN();o&&!i.has("Authorization")&&i.set("Authorization",`Bearer ${o}`);let a=await fetch(r,{...s,headers:i});if(a.status===401){const l=await vN();if(l){if(i.set("Authorization",`Bearer ${l}`),a=await fetch(r,{...s,headers:i}),!(a.ok||a.status!==401))return Zi(),window.dispatchEvent(new CustomEvent("auth:logout")),null}else return Zi(),window.dispatchEvent(new CustomEvent("auth:logout")),null}if(!a.ok){const l=await a.json().catch(()=>({detail:"Request failed"})),u=new Error(l.detail||l.error||`Request failed: ${a.status}`);throw u.status=a.status,u.data=l,u}return a.blob()}const wN=v.createContext(null),ng={system_admin:["admin","hos","sales_person"],sales_manager:["hos","sales_person"],sales_user:["sales_person"],coordinator:["coordinator"],finance:["finance"],viewer:["viewer"]},h5={"admin@mmg.com":{password:"admin123",id:"dev-admin-1",name:"Sales Admin",email:"admin@mmg.com",roles:["admin","hos","sales_person"]},"hos@mmg.com":{password:"hos123",id:"dev-hos-1",name:"Head of Sales",email:"hos@mmg.com",roles:["hos","sales_person"]},"sales@mmg.com":{password:"sales123",id:"dev-sales-1",name:"Sales Person",email:"sales@mmg.com",roles:["sales_person"]}};function sg(t){return Array.from(new Set((t||[]).filter(Boolean).map(e=>String(e).toLowerCase())))}function hk(t=[]){return t.map(e=>String(e||"").replaceAll(".",":"))}function f5(t){return(t||"sales_user").toLowerCase()}function fk(t,e){var n,s,r,i,o,a,l,u,d;return((n=t==null?void 0:t.user_metadata)==null?void 0:n.full_name)||((s=t==null?void 0:t.user_metadata)==null?void 0:s.name)||((o=(i=(r=t==null?void 0:t.identities)==null?void 0:r[0])==null?void 0:i.identity_data)==null?void 0:o.full_name)||((u=(l=(a=t==null?void 0:t.identities)==null?void 0:a[0])==null?void 0:l.identity_data)==null?void 0:u.name)||((d=t==null?void 0:t.email)==null?void 0:d.split("@")[0])||e||"User"}function ff(t,e){const n=(t==null?void 0:t.permissions)||[];if(!n.length)return!1;const s=u=>String(u||"").trim().replaceAll(".",":"),r=n.map(s),i=s(e);if(r.includes("*:*:*"))return!0;const[o,a,l]=i.split(":");return r.some(u=>{const[d,h,f]=u.split(":");return u===i?!0:(d==="*"||d===o)&&(h==="*"||h===a)&&(f==="*"||f===l||f==="manage")})}function _d(t){var e,n,s;return((e=t==null?void 0:t.roles)==null?void 0:e.includes("admin"))||((s=(n=t==null?void 0:t.profile)==null?void 0:n.toLowerCase)==null?void 0:s.call(n))==="system_admin"||ff(t,"*:*:*")||ff(t,"core:*:*")||ff(t,"core:system:admin")}function p5({children:t}){const e=Zv(),n=!e&&window.location.hostname==="localhost",[s,r]=v.useState(null),[i,o]=v.useState(()=>{const m=localStorage.getItem("mmg_user")||localStorage.getItem("userData");return m?JSON.parse(m):null}),[a,l]=v.useState(!1),[u,d]=v.useState(null);v.useEffect(()=>{const m=window.location.hash;if(!m||!m.includes("error="))return;const b=new URLSearchParams(m.substring(1)),k=b.get("error"),_=b.get("error_code"),C=b.get("error_description");if(k){let S=C?decodeURIComponent(C.replace(/\+/g," ")):"Authentication failed";_==="otp_expired"?S="Email link has expired. Please sign up again to receive a new confirmation email.":_==="access_denied"&&(S="Access denied. The link may have expired or already been used."),setTimeout(()=>alert(S),300),window.history.replaceState(null,"",window.location.pathname+window.location.search)}},[]),v.useEffect(()=>{let m=null;async function b(){console.log("[Auth] init() starting");try{if(!e){console.log("[Auth] No supabase client - dev mode");const C=localStorage.getItem("mmg_user")||localStorage.getItem("userData");C&&o(JSON.parse(C)),l(!0),console.log("[Auth] Dev mode ready");return}console.log("[Auth] Getting supabase session...");const{data:k}=await e.auth.getSession(),_=(k==null?void 0:k.session)||null;console.log("[Auth] Session retrieved",{hasSession:!!_,hasToken:!!(_!=null&&_.access_token)}),r(_||null),l(!0),console.log("[Auth] authReady set to true"),_||(console.log("[Auth] No session - clearing auth"),Zi(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData")),_!=null&&_.access_token&&hl(_.access_token),_!=null&&_.access_token&&(console.log("[Auth] Starting background profile refresh"),h(_.access_token,_.user).catch(console.error)),m=e.auth.onAuthStateChange(async(C,S)=>{if(console.log("[Auth] onAuthStateChange",{event:C,hasSession:!!S}),C==="INITIAL_SESSION"){console.log("[Auth] Skipping INITIAL_SESSION (already handled)");return}r(S||null),S!=null&&S.access_token?(hl(S.access_token),u||(console.log("[Auth] Auth state change - refreshing profile"),h(S.access_token,S.user).catch(console.error))):(console.log("[Auth] Auth state change - no session, clearing"),Zi(),o(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"))}).data.subscription}catch(k){console.log("[Auth] init() error",k),l(!0)}}return b(),()=>{var k;return(k=m==null?void 0:m.unsubscribe)==null?void 0:k.call(m)}},[e,u]),v.useEffect(()=>{const m=()=>{d(null),y()};return window.addEventListener("auth:logout",m),()=>window.removeEventListener("auth:logout",m)},[]);async function h(m,b=null){var k,_,C,S;console.log("[Auth] refreshProfile() starting");try{console.log("[Auth] Fetching /api/base/auth/me...");const j=await Me("/api/base/auth/me",{headers:{Authorization:`Bearer ${m}`}});if(console.log("[Auth] /api/base/auth/me response received",{hasProfile:!!j}),!j)return console.log("[Auth] No profile returned"),null;const T=f5((j==null?void 0:j.profile_name)||(j==null?void 0:j.profile)||(j==null?void 0:j.profileName)),P=ng[T]||["sales_person"],L=(j==null?void 0:j.roles)||(j==null?void 0:j.rbac_roles)||(j==null?void 0:j.user_roles)||[],D={id:(j==null?void 0:j.id)||(b==null?void 0:b.id),email:(j==null?void 0:j.email)||(b==null?void 0:b.email),name:(j==null?void 0:j.name)||fk(b,T),profile:T,profile_name:T,roles:sg([...P,...L]),permissions:hk((j==null?void 0:j.permissions)||[]),raw:j};return console.log("[Auth] Profile loaded, setting user",{email:D.email,roles:D.roles}),o(D),localStorage.setItem("mmg_user",JSON.stringify(D)),localStorage.setItem("userData",JSON.stringify(D)),d(null),D}catch(j){if(console.log("[Auth] refreshProfile error",j),(j==null?void 0:j.status)===403&&((k=j==null?void 0:j.data)!=null&&k.requiresLogout)){const T=(b==null?void 0:b.email)||(i==null?void 0:i.email)||"";return((_=j==null?void 0:j.data)==null?void 0:_.code)==="USER_PENDING_APPROVAL"?(d({pending:!0,email:T,message:((C=j==null?void 0:j.data)==null?void 0:C.error)||"Your account is pending administrator approval."}),null):(await y(),null)}if(b){console.log("[Auth] Using fallback session user data");const T=((S=b.user_metadata)==null?void 0:S.profile)||"sales_user",P=ng[T]||["sales_person"],L={id:b.id,email:b.email,name:fk(b,T),profile:T,profile_name:T,roles:sg(P),permissions:[],raw:b};return console.log("[Auth] Fallback user set",{email:L.email}),o(L),localStorage.setItem("mmg_user",JSON.stringify(L)),localStorage.setItem("userData",JSON.stringify(L)),d(null),L}return console.log("[Auth] No fallback available, returning null"),null}}async function f(){return s!=null&&s.access_token?s.access_token:localStorage.getItem("authToken")}async function p({email:m,password:b}){var C;if(d(null),!e){if(!n)throw new Error("Supabase not configured");const S=h5[m.toLowerCase()];if(!S||S.password!==b)throw new Error("Invalid email or password");const j=S.profile||((C=S.roles)!=null&&C.includes("admin")?"system_admin":"sales_user"),T=sg(S.roles||ng[j]||["sales_person"]),P={id:S.id,email:S.email,name:S.name,profile:j,profile_name:j,roles:T,permissions:hk(S.permissions||[]),raw:S},L=`dev-token-${Date.now()}`;return hl(L),o(P),localStorage.setItem("mmg_user",JSON.stringify(P)),localStorage.setItem("userData",JSON.stringify(P)),P}const{data:k,error:_}=await e.auth.signInWithPassword({email:m,password:b});if(_)throw _;return hl(k.session.access_token),await h(k.session.access_token,k.session.user),k}async function w(){if(!e)throw new Error("Supabase not configured. Please contact your administrator.");const m=m5(),{data:b,error:k}=await e.auth.signInWithOAuth({provider:"azure",options:{scopes:"email profile openid",redirectTo:m}});if(k)throw k;return b}async function x({token:m,email:b,password:k,fullName:_}){var T;if(!e)throw new Error("Supabase not configured");const C=await Me("/api/base/auth/validate-invite",{method:"POST",body:JSON.stringify({token:m,email:b})}),{data:S,error:j}=await e.auth.signUp({email:b,password:k,options:{data:{full_name:_,profile:(C==null?void 0:C.profile_name)||"sales_user"}}});if(j)throw j;return await Me("/api/base/auth/consume-invite",{method:"POST",body:JSON.stringify({token:m,email:b,supabase_user_id:(T=S==null?void 0:S.user)==null?void 0:T.id,profile_name:C==null?void 0:C.profile_name,name:_})}),S}async function y(){try{e&&await e.auth.signOut()}finally{Zi(),r(null),o(null),d(null),localStorage.removeItem("mmg_user"),localStorage.removeItem("userData"),sessionStorage.removeItem("msSsoPending")}}const g=v.useMemo(()=>({authReady:a,user:i,session:s,pendingAccess:u,getAccessToken:f,signInWithPassword:p,signInWithMicrosoft:w,signUpWithInvite:x,refreshProfile:h,logout:y}),[a,i,s,u]);return c.jsx(wN.Provider,{value:g,children:t})}function oi(){const t=v.useContext(wN);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function m5(){const t=`${window.location.protocol}//${window.location.host}`,e=window.SUPABASE_REDIRECT_URL||void 0||"";return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?`${t}/auth/callback`:`${(e||t).replace(/\/$/,"")}/auth/callback`}function g5(){const{signInWithMicrosoft:t}=oi(),e=bd(),n=rc(),s=v.useMemo(()=>{var h;return((h=n.state)==null?void 0:h.from)||"/app/chat"},[n.state]),[r,i]=v.useState(""),[o,a]=v.useState(!1),{user:l,authReady:u}=oi();v.useEffect(()=>{u&&l&&e(s,{replace:!0})},[u,l,s,e]);async function d(){if(!o){i("");try{a(!0),sessionStorage.setItem("postAuthRedirect",s||"/app/chat"),await new Promise(h=>requestAnimationFrame(h)),await t()}catch(h){i((h==null?void 0:h.message)||"SSO failed"),a(!1)}}}return c.jsxs("div",{className:"min-h-screen px-4 py-8 flex items-center justify-center",children:[c.jsx("div",{className:"mmg-particle one"}),c.jsx("div",{className:"mmg-particle two"}),c.jsx("div",{className:"mmg-particle three"}),c.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 lg:grid-cols-[420px_1fr] gap-6 items-stretch",children:[c.jsxs(bt,{className:"self-center",children:[c.jsxs(Bt,{className:"text-center",children:[c.jsx("div",{className:"flex items-center justify-center mb-5",children:c.jsx(eN,{size:96})}),c.jsx("p",{className:"text-sm text-black/60 dark:text-white/65",children:"Sign in to continue to your workspace"})]}),c.jsx(Ut,{children:c.jsxs("div",{className:"space-y-3",children:[r?c.jsx("div",{className:"text-sm text-red-700 rounded-2xl px-4 py-2 bg-black/5 dark:bg-white/10",children:r}):null,c.jsx(te,{variant:"secondary",size:"lg",className:"w-full justify-center gap-2",onClick:d,disabled:o,children:o?c.jsx(Ye,{text:"Signing you in"}):c.jsxs(c.Fragment,{children:[c.jsx(AM,{size:18}),"Sign in with Microsoft"]})})]})})]}),c.jsx("div",{className:"rounded-3xl min-h-[240px] lg:min-h-[520px]","aria-hidden":"true"})]})]})}function kN({email:t,message:e,onSignOut:n}){return c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsxs("div",{className:"w-full max-w-[520px] space-y-4 rounded-2xl bg-white/60 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 p-6 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:"Access Pending"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:e||"Your account is pending administrator approval."}),t?c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:["Signed in as ",c.jsx("strong",{children:t})]}):null,c.jsx("div",{className:"flex justify-center pt-2",children:c.jsx(te,{variant:"secondary",onClick:n,children:"Sign Out"})})]})})}function x5(){const t=bd(),{authReady:e,session:n,user:s,pendingAccess:r,logout:i}=oi();return v.useEffect(()=>{if(e&&!n){t("/login",{replace:!0});return}if(e&&n&&s){const o=sessionStorage.getItem("postAuthRedirect")||"/app/chat";sessionStorage.removeItem("postAuthRedirect"),t(o,{replace:!0})}},[e,n,s,t]),e&&r?c.jsx(kN,{email:r.email,message:r.message,onSignOut:i}):c.jsx("div",{className:"min-h-screen grid place-items-center px-4",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ye,{text:"Loading"})})})}function _N(){const{theme:t,setTheme:e}=UO(),n=t==="dark";return c.jsx(te,{variant:"ghost",size:"icon","aria-label":"Toggle theme",onClick:()=>e(n?"light":"dark"),title:"Toggle theme",className:"rounded-2xl",children:n?c.jsx(BM,{size:18}):c.jsx(DM,{size:18})})}function nt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function Sd(t,e=[]){let n=[];function s(i,o){const a=v.createContext(o),l=n.length;n=[...n,o];const u=h=>{var g;const{scope:f,children:p,...w}=h,x=((g=f==null?void 0:f[t])==null?void 0:g[l])||a,y=v.useMemo(()=>w,Object.values(w));return c.jsx(x.Provider,{value:y,children:p})};u.displayName=i+"Provider";function d(h,f){var x;const p=((x=f==null?void 0:f[t])==null?void 0:x[l])||a,w=v.useContext(p);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const r=()=>{const i=n.map(o=>v.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return v.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[s,y5(r,...e)]}function y5(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(i){const o=s.reduce((a,{useScope:l,scopeName:u})=>{const h=l(i)[`__scope${u}`];return{...a,...h}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var oo=globalThis!=null&&globalThis.document?v.useLayoutEffect:()=>{},v5=kp[" useInsertionEffect ".trim().toString()]||oo;function SN({prop:t,defaultProp:e,onChange:n=()=>{},caller:s}){const[r,i,o]=b5({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:r;{const d=v.useRef(t!==void 0);v.useEffect(()=>{const h=d.current;h!==a&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=a},[a,s])}const u=v.useCallback(d=>{var h;if(a){const f=w5(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[a,t,i,o]);return[l,u]}function b5({defaultProp:t,onChange:e}){const[n,s]=v.useState(t),r=v.useRef(n),i=v.useRef(e);return v5(()=>{i.current=e},[e]),v.useEffect(()=>{var o;r.current!==n&&((o=i.current)==null||o.call(i,n),r.current=n)},[n,r]),[n,s,i]}function w5(t){return typeof t=="function"}function k5(t){const e=_5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(j5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function _5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=N5(r),a=C5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?ka(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var S5=Symbol("radix.slottable");function j5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===S5}function C5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function N5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var E5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Bn=E5.reduce((t,e)=>{const n=k5(`Primitive.${e}`),s=v.forwardRef((r,i)=>{const{asChild:o,...a}=r,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...a,ref:i})});return s.displayName=`Primitive.${e}`,{...t,[e]:s}},{});function jN(t,e){t&&xd.flushSync(()=>t.dispatchEvent(e))}function pk(t){const e=T5(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(R5);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function T5(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=O5(r),a=A5(i,r.props);return r.type!==v.Fragment&&(a.ref=s?ka(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var P5=Symbol("radix.slottable");function R5(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===P5}function A5(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function O5(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function CN(t){const e=t+"CollectionProvider",[n,s]=Sd(e),[r,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:y,children:g}=x,m=ge.useRef(null),b=ge.useRef(new Map).current;return c.jsx(r,{scope:y,itemMap:b,collectionRef:m,children:g})};o.displayName=e;const a=t+"CollectionSlot",l=pk(a),u=ge.forwardRef((x,y)=>{const{scope:g,children:m}=x,b=i(a,g),k=os(y,b.collectionRef);return c.jsx(l,{ref:k,children:m})});u.displayName=a;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=pk(d),p=ge.forwardRef((x,y)=>{const{scope:g,children:m,...b}=x,k=ge.useRef(null),_=os(y,k),C=i(d,g);return ge.useEffect(()=>(C.itemMap.set(k,{ref:k,...b}),()=>void C.itemMap.delete(k))),c.jsx(f,{[h]:"",ref:_,children:m})});p.displayName=d;function w(x){const y=i(t+"CollectionConsumer",x);return ge.useCallback(()=>{const m=y.collectionRef.current;if(!m)return[];const b=Array.from(m.querySelectorAll(`[${h}]`));return Array.from(y.itemMap.values()).sort((C,S)=>b.indexOf(C.ref.current)-b.indexOf(S.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:u,ItemSlot:p},w,s]}var M5=v.createContext(void 0);function NN(t){const e=v.useContext(M5);return t||e||"ltr"}function ai(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function I5(t,e=globalThis==null?void 0:globalThis.document){const n=ai(t);v.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var D5="DismissableLayer",fy="dismissableLayer.update",L5="dismissableLayer.pointerDownOutside",$5="dismissableLayer.focusOutside",mk,EN=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),TN=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,u=v.useContext(EN),[d,h]=v.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=v.useState({}),w=os(e,S=>h(S)),x=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),g=x.indexOf(y),m=d?x.indexOf(d):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,k=m>=g,_=B5(S=>{const j=S.target,T=[...u.branches].some(P=>P.contains(j));!k||T||(r==null||r(S),o==null||o(S),S.defaultPrevented||a==null||a())},f),C=U5(S=>{const j=S.target;[...u.branches].some(P=>P.contains(j))||(i==null||i(S),o==null||o(S),S.defaultPrevented||a==null||a())},f);return I5(S=>{m===u.layers.size-1&&(s==null||s(S),!S.defaultPrevented&&a&&(S.preventDefault(),a()))},f),v.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(mk=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),gk(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=mk)}},[d,f,n,u]),v.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),gk())},[d,u]),v.useEffect(()=>{const S=()=>p({});return document.addEventListener(fy,S),()=>document.removeEventListener(fy,S)},[]),c.jsx(Bn.div,{...l,ref:w,style:{pointerEvents:b?k?"auto":"none":void 0,...t.style},onFocusCapture:nt(t.onFocusCapture,C.onFocusCapture),onBlurCapture:nt(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:nt(t.onPointerDownCapture,_.onPointerDownCapture)})});TN.displayName=D5;var F5="DismissableLayerBranch",z5=v.forwardRef((t,e)=>{const n=v.useContext(EN),s=v.useRef(null),r=os(e,s);return v.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),c.jsx(Bn.div,{...t,ref:r})});z5.displayName=F5;function B5(t,e=globalThis==null?void 0:globalThis.document){const n=ai(t),s=v.useRef(!1),r=v.useRef(()=>{});return v.useEffect(()=>{const i=a=>{if(a.target&&!s.current){let l=function(){PN(L5,n,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=l,e.addEventListener("click",r.current,{once:!0})):l()}else e.removeEventListener("click",r.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function U5(t,e=globalThis==null?void 0:globalThis.document){const n=ai(t),s=v.useRef(!1);return v.useEffect(()=>{const r=i=>{i.target&&!s.current&&PN($5,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function gk(){const t=new CustomEvent(fy);document.dispatchEvent(t)}function PN(t,e,n,{discrete:s}){const r=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?jN(r,i):r.dispatchEvent(i)}var rg=0;function H5(){v.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??xk()),document.body.insertAdjacentElement("beforeend",t[1]??xk()),rg++,()=>{rg===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),rg--}},[])}function xk(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var ig="focusScope.autoFocusOnMount",og="focusScope.autoFocusOnUnmount",yk={bubbles:!1,cancelable:!0},W5="FocusScope",RN=v.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:r,onUnmountAutoFocus:i,...o}=t,[a,l]=v.useState(null),u=ai(r),d=ai(i),h=v.useRef(null),f=os(e,x=>l(x)),p=v.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;v.useEffect(()=>{if(s){let x=function(b){if(p.paused||!a)return;const k=b.target;a.contains(k)?h.current=k:vi(h.current,{select:!0})},y=function(b){if(p.paused||!a)return;const k=b.relatedTarget;k!==null&&(a.contains(k)||vi(h.current,{select:!0}))},g=function(b){if(document.activeElement===document.body)for(const _ of b)_.removedNodes.length>0&&vi(a)};document.addEventListener("focusin",x),document.addEventListener("focusout",y);const m=new MutationObserver(g);return a&&m.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",y),m.disconnect()}}},[s,a,p.paused]),v.useEffect(()=>{if(a){bk.add(p);const x=document.activeElement;if(!a.contains(x)){const g=new CustomEvent(ig,yk);a.addEventListener(ig,u),a.dispatchEvent(g),g.defaultPrevented||(V5(Q5(AN(a)),{select:!0}),document.activeElement===x&&vi(a))}return()=>{a.removeEventListener(ig,u),setTimeout(()=>{const g=new CustomEvent(og,yk);a.addEventListener(og,d),a.dispatchEvent(g),g.defaultPrevented||vi(x??document.body,{select:!0}),a.removeEventListener(og,d),bk.remove(p)},0)}}},[a,u,d,p]);const w=v.useCallback(x=>{if(!n&&!s||p.paused)return;const y=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,g=document.activeElement;if(y&&g){const m=x.currentTarget,[b,k]=q5(m);b&&k?!x.shiftKey&&g===k?(x.preventDefault(),n&&vi(b,{select:!0})):x.shiftKey&&g===b&&(x.preventDefault(),n&&vi(k,{select:!0})):g===m&&x.preventDefault()}},[n,s,p.paused]);return c.jsx(Bn.div,{tabIndex:-1,...o,ref:f,onKeyDown:w})});RN.displayName=W5;function V5(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(vi(s,{select:e}),document.activeElement!==n)return}function q5(t){const e=AN(t),n=vk(e,t),s=vk(e.reverse(),t);return[n,s]}function AN(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function vk(t,e){for(const n of t)if(!K5(n,{upTo:e}))return n}function K5(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function G5(t){return t instanceof HTMLInputElement&&"select"in t}function vi(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&G5(t)&&e&&t.select()}}var bk=Y5();function Y5(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=wk(t,e),t.unshift(e)},remove(e){var n;t=wk(t,e),(n=t[0])==null||n.resume()}}}function wk(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function Q5(t){return t.filter(e=>e.tagName!=="A")}var X5=kp[" useId ".trim().toString()]||(()=>{}),J5=0;function py(t){const[e,n]=v.useState(X5());return oo(()=>{n(s=>s??String(J5++))},[t]),e?`radix-${e}`:""}const Z5=["top","right","bottom","left"],ao=Math.min,ps=Math.max,tp=Math.round,wh=Math.floor,Rr=t=>({x:t,y:t}),e$={left:"right",right:"left",bottom:"top",top:"bottom"},t$={start:"end",end:"start"};function my(t,e,n){return ps(t,ao(e,n))}function li(t,e){return typeof t=="function"?t(e):t}function ci(t){return t.split("-")[0]}function lc(t){return t.split("-")[1]}function t0(t){return t==="x"?"y":"x"}function n0(t){return t==="y"?"height":"width"}const n$=new Set(["top","bottom"]);function Nr(t){return n$.has(ci(t))?"y":"x"}function s0(t){return t0(Nr(t))}function s$(t,e,n){n===void 0&&(n=!1);const s=lc(t),r=s0(t),i=n0(r);let o=r==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=np(o)),[o,np(o)]}function r$(t){const e=np(t);return[gy(t),e,gy(e)]}function gy(t){return t.replace(/start|end/g,e=>t$[e])}const kk=["left","right"],_k=["right","left"],i$=["top","bottom"],o$=["bottom","top"];function a$(t,e,n){switch(t){case"top":case"bottom":return n?e?_k:kk:e?kk:_k;case"left":case"right":return e?i$:o$;default:return[]}}function l$(t,e,n,s){const r=lc(t);let i=a$(ci(t),n==="start",s);return r&&(i=i.map(o=>o+"-"+r),e&&(i=i.concat(i.map(gy)))),i}function np(t){return t.replace(/left|right|bottom|top/g,e=>e$[e])}function c$(t){return{top:0,right:0,bottom:0,left:0,...t}}function ON(t){return typeof t!="number"?c$(t):{top:t,right:t,bottom:t,left:t}}function sp(t){const{x:e,y:n,width:s,height:r}=t;return{width:s,height:r,top:n,left:e,right:e+s,bottom:n+r,x:e,y:n}}function Sk(t,e,n){let{reference:s,floating:r}=t;const i=Nr(e),o=s0(e),a=n0(o),l=ci(e),u=i==="y",d=s.x+s.width/2-r.width/2,h=s.y+s.height/2-r.height/2,f=s[a]/2-r[a]/2;let p;switch(l){case"top":p={x:d,y:s.y-r.height};break;case"bottom":p={x:d,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:h};break;case"left":p={x:s.x-r.width,y:h};break;default:p={x:s.x,y:s.y}}switch(lc(e)){case"start":p[o]-=f*(n&&u?-1:1);break;case"end":p[o]+=f*(n&&u?-1:1);break}return p}const u$=async(t,e,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:d,y:h}=Sk(u,s,l),f=s,p={},w=0;for(let x=0;x<a.length;x++){const{name:y,fn:g}=a[x],{x:m,y:b,data:k,reset:_}=await g({x:d,y:h,initialPlacement:s,placement:f,strategy:r,middlewareData:p,rects:u,platform:o,elements:{reference:t,floating:e}});d=m??d,h=b??h,p={...p,[y]:{...p[y],...k}},_&&w<=50&&(w++,typeof _=="object"&&(_.placement&&(f=_.placement),_.rects&&(u=_.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):_.rects),{x:d,y:h}=Sk(u,f,l)),x=-1)}return{x:d,y:h,placement:f,strategy:r,middlewareData:p}};async function Bu(t,e){var n;e===void 0&&(e={});const{x:s,y:r,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=li(e,t),w=ON(p),y=a[f?h==="floating"?"reference":"floating":h],g=sp(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:u,rootBoundary:d,strategy:l})),m=h==="floating"?{x:s,y:r,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),k=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},_=sp(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:m,offsetParent:b,strategy:l}):m);return{top:(g.top-_.top+w.top)/k.y,bottom:(_.bottom-g.bottom+w.bottom)/k.y,left:(g.left-_.left+w.left)/k.x,right:(_.right-g.right+w.right)/k.x}}const d$=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:r,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:d=0}=li(t,e)||{};if(u==null)return{};const h=ON(d),f={x:n,y:s},p=s0(r),w=n0(p),x=await o.getDimensions(u),y=p==="y",g=y?"top":"left",m=y?"bottom":"right",b=y?"clientHeight":"clientWidth",k=i.reference[w]+i.reference[p]-f[p]-i.floating[w],_=f[p]-i.reference[p],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let S=C?C[b]:0;(!S||!await(o.isElement==null?void 0:o.isElement(C)))&&(S=a.floating[b]||i.floating[w]);const j=k/2-_/2,T=S/2-x[w]/2-1,P=ao(h[g],T),L=ao(h[m],T),D=P,O=S-x[w]-L,$=S/2-x[w]/2+j,I=my(D,$,O),A=!l.arrow&&lc(r)!=null&&$!==I&&i.reference[w]/2-($<D?P:L)-x[w]/2<0,W=A?$<D?$-D:$-O:0;return{[p]:f[p]+W,data:{[p]:I,centerOffset:$-I-W,...A&&{alignmentOffset:W}},reset:A}}}),h$=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:r,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:x=!0,...y}=li(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const g=ci(r),m=Nr(a),b=ci(a)===a,k=await(l.isRTL==null?void 0:l.isRTL(u.floating)),_=f||(b||!x?[np(a)]:r$(a)),C=w!=="none";!f&&C&&_.push(...l$(a,x,w,k));const S=[a,..._],j=await Bu(e,y),T=[];let P=((s=i.flip)==null?void 0:s.overflows)||[];if(d&&T.push(j[g]),h){const $=s$(r,o,k);T.push(j[$[0]],j[$[1]])}if(P=[...P,{placement:r,overflows:T}],!T.every($=>$<=0)){var L,D;const $=(((L=i.flip)==null?void 0:L.index)||0)+1,I=S[$];if(I&&(!(h==="alignment"?m!==Nr(I):!1)||P.every(N=>Nr(N.placement)===m?N.overflows[0]>0:!0)))return{data:{index:$,overflows:P},reset:{placement:I}};let A=(D=P.filter(W=>W.overflows[0]<=0).sort((W,N)=>W.overflows[1]-N.overflows[1])[0])==null?void 0:D.placement;if(!A)switch(p){case"bestFit":{var O;const W=(O=P.filter(N=>{if(C){const E=Nr(N.placement);return E===m||E==="y"}return!0}).map(N=>[N.placement,N.overflows.filter(E=>E>0).reduce((E,F)=>E+F,0)]).sort((N,E)=>N[1]-E[1])[0])==null?void 0:O[0];W&&(A=W);break}case"initialPlacement":A=a;break}if(r!==A)return{reset:{placement:A}}}return{}}}};function jk(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Ck(t){return Z5.some(e=>t[e]>=0)}const f$=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...r}=li(t,e);switch(s){case"referenceHidden":{const i=await Bu(e,{...r,elementContext:"reference"}),o=jk(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Ck(o)}}}case"escaped":{const i=await Bu(e,{...r,altBoundary:!0}),o=jk(i,n.floating);return{data:{escapedOffsets:o,escaped:Ck(o)}}}default:return{}}}}},MN=new Set(["left","top"]);async function p$(t,e){const{placement:n,platform:s,elements:r}=t,i=await(s.isRTL==null?void 0:s.isRTL(r.floating)),o=ci(n),a=lc(n),l=Nr(n)==="y",u=MN.has(o)?-1:1,d=i&&l?-1:1,h=li(e,t);let{mainAxis:f,crossAxis:p,alignmentAxis:w}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof w=="number"&&(p=a==="end"?w*-1:w),l?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const m$=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:r,y:i,placement:o,middlewareData:a}=e,l=await p$(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:r+l.x,y:i+l.y,data:{...l,placement:o}}}}},g$=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:g,y:m}=y;return{x:g,y:m}}},...l}=li(t,e),u={x:n,y:s},d=await Bu(e,l),h=Nr(ci(r)),f=t0(h);let p=u[f],w=u[h];if(i){const y=f==="y"?"top":"left",g=f==="y"?"bottom":"right",m=p+d[y],b=p-d[g];p=my(m,p,b)}if(o){const y=h==="y"?"top":"left",g=h==="y"?"bottom":"right",m=w+d[y],b=w-d[g];w=my(m,w,b)}const x=a.fn({...e,[f]:p,[h]:w});return{...x,data:{x:x.x-n,y:x.y-s,enabled:{[f]:i,[h]:o}}}}}},x$=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:r,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=li(t,e),d={x:n,y:s},h=Nr(r),f=t0(h);let p=d[f],w=d[h];const x=li(a,e),y=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(l){const b=f==="y"?"height":"width",k=i.reference[f]-i.floating[b]+y.mainAxis,_=i.reference[f]+i.reference[b]-y.mainAxis;p<k?p=k:p>_&&(p=_)}if(u){var g,m;const b=f==="y"?"width":"height",k=MN.has(ci(r)),_=i.reference[h]-i.floating[b]+(k&&((g=o.offset)==null?void 0:g[h])||0)+(k?0:y.crossAxis),C=i.reference[h]+i.reference[b]+(k?0:((m=o.offset)==null?void 0:m[h])||0)-(k?y.crossAxis:0);w<_?w=_:w>C&&(w=C)}return{[f]:p,[h]:w}}}},y$=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:r,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...u}=li(t,e),d=await Bu(e,u),h=ci(r),f=lc(r),p=Nr(r)==="y",{width:w,height:x}=i.floating;let y,g;h==="top"||h==="bottom"?(y=h,g=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(g=h,y=f==="end"?"top":"bottom");const m=x-d.top-d.bottom,b=w-d.left-d.right,k=ao(x-d[y],m),_=ao(w-d[g],b),C=!e.middlewareData.shift;let S=k,j=_;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(j=b),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(S=m),C&&!f){const P=ps(d.left,0),L=ps(d.right,0),D=ps(d.top,0),O=ps(d.bottom,0);p?j=w-2*(P!==0||L!==0?P+L:ps(d.left,d.right)):S=x-2*(D!==0||O!==0?D+O:ps(d.top,d.bottom))}await l({...e,availableWidth:j,availableHeight:S});const T=await o.getDimensions(a.floating);return w!==T.width||x!==T.height?{reset:{rects:!0}}:{}}}};function Up(){return typeof window<"u"}function cc(t){return IN(t)?(t.nodeName||"").toLowerCase():"#document"}function bs(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Mr(t){var e;return(e=(IN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function IN(t){return Up()?t instanceof Node||t instanceof bs(t).Node:!1}function ir(t){return Up()?t instanceof Element||t instanceof bs(t).Element:!1}function Ar(t){return Up()?t instanceof HTMLElement||t instanceof bs(t).HTMLElement:!1}function Nk(t){return!Up()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof bs(t).ShadowRoot}const v$=new Set(["inline","contents"]);function jd(t){const{overflow:e,overflowX:n,overflowY:s,display:r}=or(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!v$.has(r)}const b$=new Set(["table","td","th"]);function w$(t){return b$.has(cc(t))}const k$=[":popover-open",":modal"];function Hp(t){return k$.some(e=>{try{return t.matches(e)}catch{return!1}})}const _$=["transform","translate","scale","rotate","perspective"],S$=["transform","translate","scale","rotate","perspective","filter"],j$=["paint","layout","strict","content"];function r0(t){const e=i0(),n=ir(t)?or(t):t;return _$.some(s=>n[s]?n[s]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||S$.some(s=>(n.willChange||"").includes(s))||j$.some(s=>(n.contain||"").includes(s))}function C$(t){let e=lo(t);for(;Ar(e)&&!Jl(e);){if(r0(e))return e;if(Hp(e))return null;e=lo(e)}return null}function i0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const N$=new Set(["html","body","#document"]);function Jl(t){return N$.has(cc(t))}function or(t){return bs(t).getComputedStyle(t)}function Wp(t){return ir(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function lo(t){if(cc(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Nk(t)&&t.host||Mr(t);return Nk(e)?e.host:e}function DN(t){const e=lo(t);return Jl(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ar(e)&&jd(e)?e:DN(e)}function Uu(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=DN(t),i=r===((s=t.ownerDocument)==null?void 0:s.body),o=bs(r);if(i){const a=xy(o);return e.concat(o,o.visualViewport||[],jd(r)?r:[],a&&n?Uu(a):[])}return e.concat(r,Uu(r,[],n))}function xy(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function LN(t){const e=or(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const r=Ar(t),i=r?t.offsetWidth:n,o=r?t.offsetHeight:s,a=tp(n)!==i||tp(s)!==o;return a&&(n=i,s=o),{width:n,height:s,$:a}}function o0(t){return ir(t)?t:t.contextElement}function _l(t){const e=o0(t);if(!Ar(e))return Rr(1);const n=e.getBoundingClientRect(),{width:s,height:r,$:i}=LN(e);let o=(i?tp(n.width):n.width)/s,a=(i?tp(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const E$=Rr(0);function $N(t){const e=bs(t);return!i0()||!e.visualViewport?E$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function T$(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==bs(t)?!1:e}function ma(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=o0(t);let o=Rr(1);e&&(s?ir(s)&&(o=_l(s)):o=_l(t));const a=T$(i,n,s)?$N(i):Rr(0);let l=(r.left+a.x)/o.x,u=(r.top+a.y)/o.y,d=r.width/o.x,h=r.height/o.y;if(i){const f=bs(i),p=s&&ir(s)?bs(s):s;let w=f,x=xy(w);for(;x&&s&&p!==w;){const y=_l(x),g=x.getBoundingClientRect(),m=or(x),b=g.left+(x.clientLeft+parseFloat(m.paddingLeft))*y.x,k=g.top+(x.clientTop+parseFloat(m.paddingTop))*y.y;l*=y.x,u*=y.y,d*=y.x,h*=y.y,l+=b,u+=k,w=bs(x),x=xy(w)}}return sp({width:d,height:h,x:l,y:u})}function Vp(t,e){const n=Wp(t).scrollLeft;return e?e.left+n:ma(Mr(t)).left+n}function FN(t,e){const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-Vp(t,n),r=n.top+e.scrollTop;return{x:s,y:r}}function P$(t){let{elements:e,rect:n,offsetParent:s,strategy:r}=t;const i=r==="fixed",o=Mr(s),a=e?Hp(e.floating):!1;if(s===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},u=Rr(1);const d=Rr(0),h=Ar(s);if((h||!h&&!i)&&((cc(s)!=="body"||jd(o))&&(l=Wp(s)),Ar(s))){const p=ma(s);u=_l(s),d.x=p.x+s.clientLeft,d.y=p.y+s.clientTop}const f=o&&!h&&!i?FN(o,l):Rr(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-l.scrollTop*u.y+d.y+f.y}}function R$(t){return Array.from(t.getClientRects())}function A$(t){const e=Mr(t),n=Wp(t),s=t.ownerDocument.body,r=ps(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=ps(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+Vp(t);const a=-n.scrollTop;return or(s).direction==="rtl"&&(o+=ps(e.clientWidth,s.clientWidth)-r),{width:r,height:i,x:o,y:a}}const Ek=25;function O$(t,e){const n=bs(t),s=Mr(t),r=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(r){i=r.width,o=r.height;const d=i0();(!d||d&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}const u=Vp(s);if(u<=0){const d=s.ownerDocument,h=d.body,f=getComputedStyle(h),p=d.compatMode==="CSS1Compat"&&parseFloat(f.marginLeft)+parseFloat(f.marginRight)||0,w=Math.abs(s.clientWidth-h.clientWidth-p);w<=Ek&&(i-=w)}else u<=Ek&&(i+=u);return{width:i,height:o,x:a,y:l}}const M$=new Set(["absolute","fixed"]);function I$(t,e){const n=ma(t,!0,e==="fixed"),s=n.top+t.clientTop,r=n.left+t.clientLeft,i=Ar(t)?_l(t):Rr(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=r*i.x,u=s*i.y;return{width:o,height:a,x:l,y:u}}function Tk(t,e,n){let s;if(e==="viewport")s=O$(t,n);else if(e==="document")s=A$(Mr(t));else if(ir(e))s=I$(e,n);else{const r=$N(t);s={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return sp(s)}function zN(t,e){const n=lo(t);return n===e||!ir(n)||Jl(n)?!1:or(n).position==="fixed"||zN(n,e)}function D$(t,e){const n=e.get(t);if(n)return n;let s=Uu(t,[],!1).filter(a=>ir(a)&&cc(a)!=="body"),r=null;const i=or(t).position==="fixed";let o=i?lo(t):t;for(;ir(o)&&!Jl(o);){const a=or(o),l=r0(o);!l&&a.position==="fixed"&&(r=null),(i?!l&&!r:!l&&a.position==="static"&&!!r&&M$.has(r.position)||jd(o)&&!l&&zN(t,o))?s=s.filter(d=>d!==o):r=a,o=lo(o)}return e.set(t,s),s}function L$(t){let{element:e,boundary:n,rootBoundary:s,strategy:r}=t;const o=[...n==="clippingAncestors"?Hp(e)?[]:D$(e,this._c):[].concat(n),s],a=o[0],l=o.reduce((u,d)=>{const h=Tk(e,d,r);return u.top=ps(h.top,u.top),u.right=ao(h.right,u.right),u.bottom=ao(h.bottom,u.bottom),u.left=ps(h.left,u.left),u},Tk(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function $$(t){const{width:e,height:n}=LN(t);return{width:e,height:n}}function F$(t,e,n){const s=Ar(e),r=Mr(e),i=n==="fixed",o=ma(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Rr(0);function u(){l.x=Vp(r)}if(s||!s&&!i)if((cc(e)!=="body"||jd(r))&&(a=Wp(e)),s){const p=ma(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else r&&u();i&&!s&&r&&u();const d=r&&!s&&!i?FN(r,a):Rr(0),h=o.left+a.scrollLeft-l.x-d.x,f=o.top+a.scrollTop-l.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function ag(t){return or(t).position==="static"}function Pk(t,e){if(!Ar(t)||or(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Mr(t)===n&&(n=n.ownerDocument.body),n}function BN(t,e){const n=bs(t);if(Hp(t))return n;if(!Ar(t)){let r=lo(t);for(;r&&!Jl(r);){if(ir(r)&&!ag(r))return r;r=lo(r)}return n}let s=Pk(t,e);for(;s&&w$(s)&&ag(s);)s=Pk(s,e);return s&&Jl(s)&&ag(s)&&!r0(s)?n:s||C$(t)||n}const z$=async function(t){const e=this.getOffsetParent||BN,n=this.getDimensions,s=await n(t.floating);return{reference:F$(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function B$(t){return or(t).direction==="rtl"}const U$={convertOffsetParentRelativeRectToViewportRelativeRect:P$,getDocumentElement:Mr,getClippingRect:L$,getOffsetParent:BN,getElementRects:z$,getClientRects:R$,getDimensions:$$,getScale:_l,isElement:ir,isRTL:B$};function UN(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function H$(t,e){let n=null,s;const r=Mr(t);function i(){var a;clearTimeout(s),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:p}=u;if(a||e(),!f||!p)return;const w=wh(h),x=wh(r.clientWidth-(d+f)),y=wh(r.clientHeight-(h+p)),g=wh(d),b={rootMargin:-w+"px "+-x+"px "+-y+"px "+-g+"px",threshold:ps(0,ao(1,l))||1};let k=!0;function _(C){const S=C[0].intersectionRatio;if(S!==l){if(!k)return o();S?o(!1,S):s=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!UN(u,t.getBoundingClientRect())&&o(),k=!1}try{n=new IntersectionObserver(_,{...b,root:r.ownerDocument})}catch{n=new IntersectionObserver(_,b)}n.observe(t)}return o(!0),i}function W$(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,u=o0(t),d=r||i?[...u?Uu(u):[],...Uu(e)]:[];d.forEach(g=>{r&&g.addEventListener("scroll",n,{passive:!0}),i&&g.addEventListener("resize",n)});const h=u&&a?H$(u,n):null;let f=-1,p=null;o&&(p=new ResizeObserver(g=>{let[m]=g;m&&m.target===u&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(e)})),n()}),u&&!l&&p.observe(u),p.observe(e));let w,x=l?ma(t):null;l&&y();function y(){const g=ma(t);x&&!UN(x,g)&&n(),x=g,w=requestAnimationFrame(y)}return n(),()=>{var g;d.forEach(m=>{r&&m.removeEventListener("scroll",n),i&&m.removeEventListener("resize",n)}),h==null||h(),(g=p)==null||g.disconnect(),p=null,l&&cancelAnimationFrame(w)}}const V$=m$,q$=g$,K$=h$,G$=y$,Y$=f$,Rk=d$,Q$=x$,X$=(t,e,n)=>{const s=new Map,r={platform:U$,...n},i={...r.platform,_c:s};return u$(t,e,{...r,platform:i})};var J$=typeof document<"u",Z$=function(){},pf=J$?v.useLayoutEffect:Z$;function rp(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,r;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!rp(t[s],e[s]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){const i=r[s];if(!(i==="_owner"&&t.$$typeof)&&!rp(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function HN(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Ak(t,e){const n=HN(t);return Math.round(e*n)/n}function lg(t){const e=v.useRef(t);return pf(()=>{e.current=t}),e}function eF(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[d,h]=v.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=v.useState(s);rp(f,s)||p(s);const[w,x]=v.useState(null),[y,g]=v.useState(null),m=v.useCallback(N=>{N!==C.current&&(C.current=N,x(N))},[]),b=v.useCallback(N=>{N!==S.current&&(S.current=N,g(N))},[]),k=i||w,_=o||y,C=v.useRef(null),S=v.useRef(null),j=v.useRef(d),T=l!=null,P=lg(l),L=lg(r),D=lg(u),O=v.useCallback(()=>{if(!C.current||!S.current)return;const N={placement:e,strategy:n,middleware:f};L.current&&(N.platform=L.current),X$(C.current,S.current,N).then(E=>{const F={...E,isPositioned:D.current!==!1};$.current&&!rp(j.current,F)&&(j.current=F,xd.flushSync(()=>{h(F)}))})},[f,e,n,L,D]);pf(()=>{u===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,h(N=>({...N,isPositioned:!1})))},[u]);const $=v.useRef(!1);pf(()=>($.current=!0,()=>{$.current=!1}),[]),pf(()=>{if(k&&(C.current=k),_&&(S.current=_),k&&_){if(P.current)return P.current(k,_,O);O()}},[k,_,O,P,T]);const I=v.useMemo(()=>({reference:C,floating:S,setReference:m,setFloating:b}),[m,b]),A=v.useMemo(()=>({reference:k,floating:_}),[k,_]),W=v.useMemo(()=>{const N={position:n,left:0,top:0};if(!A.floating)return N;const E=Ak(A.floating,d.x),F=Ak(A.floating,d.y);return a?{...N,transform:"translate("+E+"px, "+F+"px)",...HN(A.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:E,top:F}},[n,a,A.floating,d.x,d.y]);return v.useMemo(()=>({...d,update:O,refs:I,elements:A,floatingStyles:W}),[d,O,I,A,W])}const tF=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:r}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?Rk({element:s.current,padding:r}).fn(n):{}:s?Rk({element:s,padding:r}).fn(n):{}}}},nF=(t,e)=>({...V$(t),options:[t,e]}),sF=(t,e)=>({...q$(t),options:[t,e]}),rF=(t,e)=>({...Q$(t),options:[t,e]}),iF=(t,e)=>({...K$(t),options:[t,e]}),oF=(t,e)=>({...G$(t),options:[t,e]}),aF=(t,e)=>({...Y$(t),options:[t,e]}),lF=(t,e)=>({...tF(t),options:[t,e]});var cF="Arrow",WN=v.forwardRef((t,e)=>{const{children:n,width:s=10,height:r=5,...i}=t;return c.jsx(Bn.svg,{...i,ref:e,width:s,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});WN.displayName=cF;var uF=WN;function dF(t){const[e,n]=v.useState(void 0);return oo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const i=r[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var a0="Popper",[VN,qN]=Sd(a0),[hF,KN]=VN(a0),GN=t=>{const{__scopePopper:e,children:n}=t,[s,r]=v.useState(null);return c.jsx(hF,{scope:e,anchor:s,onAnchorChange:r,children:n})};GN.displayName=a0;var YN="PopperAnchor",QN=v.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...r}=t,i=KN(YN,n),o=v.useRef(null),a=os(e,o),l=v.useRef(null);return v.useEffect(()=>{const u=l.current;l.current=(s==null?void 0:s.current)||o.current,u!==l.current&&i.onAnchorChange(l.current)}),s?null:c.jsx(Bn.div,{...r,ref:a})});QN.displayName=YN;var l0="PopperContent",[fF,pF]=VN(l0),XN=v.forwardRef((t,e)=>{var de,Z,be,Ae,me,fe;const{__scopePopper:n,side:s="bottom",sideOffset:r=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:w,...x}=t,y=KN(l0,n),[g,m]=v.useState(null),b=os(e,De=>m(De)),[k,_]=v.useState(null),C=dF(k),S=(C==null?void 0:C.width)??0,j=(C==null?void 0:C.height)??0,T=s+(i!=="center"?"-"+i:""),P=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},L=Array.isArray(u)?u:[u],D=L.length>0,O={padding:P,boundary:L.filter(gF),altBoundary:D},{refs:$,floatingStyles:I,placement:A,isPositioned:W,middlewareData:N}=eF({strategy:"fixed",placement:T,whileElementsMounted:(...De)=>W$(...De,{animationFrame:p==="always"}),elements:{reference:y.anchor},middleware:[nF({mainAxis:r+j,alignmentAxis:o}),l&&sF({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?rF():void 0,...O}),l&&iF({...O}),oF({...O,apply:({elements:De,rects:J,availableWidth:pe,availableHeight:ie})=>{const{width:K,height:G}=J.reference,le=De.floating.style;le.setProperty("--radix-popper-available-width",`${pe}px`),le.setProperty("--radix-popper-available-height",`${ie}px`),le.setProperty("--radix-popper-anchor-width",`${K}px`),le.setProperty("--radix-popper-anchor-height",`${G}px`)}}),k&&lF({element:k,padding:a}),xF({arrowWidth:S,arrowHeight:j}),f&&aF({strategy:"referenceHidden",...O})]}),[E,F]=eE(A),V=ai(w);oo(()=>{W&&(V==null||V())},[W,V]);const H=(de=N.arrow)==null?void 0:de.x,he=(Z=N.arrow)==null?void 0:Z.y,ee=((be=N.arrow)==null?void 0:be.centerOffset)!==0,[U,Q]=v.useState();return oo(()=>{g&&Q(window.getComputedStyle(g).zIndex)},[g]),c.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...I,transform:W?I.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:U,"--radix-popper-transform-origin":[(Ae=N.transformOrigin)==null?void 0:Ae.x,(me=N.transformOrigin)==null?void 0:me.y].join(" "),...((fe=N.hide)==null?void 0:fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:c.jsx(fF,{scope:n,placedSide:E,onArrowChange:_,arrowX:H,arrowY:he,shouldHideArrow:ee,children:c.jsx(Bn.div,{"data-side":E,"data-align":F,...x,ref:b,style:{...x.style,animation:W?void 0:"none"}})})})});XN.displayName=l0;var JN="PopperArrow",mF={top:"bottom",right:"left",bottom:"top",left:"right"},ZN=v.forwardRef(function(e,n){const{__scopePopper:s,...r}=e,i=pF(JN,s),o=mF[i.placedSide];return c.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:c.jsx(uF,{...r,ref:n,style:{...r.style,display:"block"}})})});ZN.displayName=JN;function gF(t){return t!==null}var xF=t=>({name:"transformOrigin",options:t,fn(e){var y,g,m;const{placement:n,rects:s,middlewareData:r}=e,o=((y=r.arrow)==null?void 0:y.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[u,d]=eE(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((g=r.arrow)==null?void 0:g.x)??0)+a/2,p=(((m=r.arrow)==null?void 0:m.y)??0)+l/2;let w="",x="";return u==="bottom"?(w=o?h:`${f}px`,x=`${-l}px`):u==="top"?(w=o?h:`${f}px`,x=`${s.floating.height+l}px`):u==="right"?(w=`${-l}px`,x=o?h:`${p}px`):u==="left"&&(w=`${s.floating.width+l}px`,x=o?h:`${p}px`),{data:{x:w,y:x}}}});function eE(t){const[e,n="center"]=t.split("-");return[e,n]}var yF=GN,vF=QN,bF=XN,wF=ZN,kF="Portal",tE=v.forwardRef((t,e)=>{var a;const{container:n,...s}=t,[r,i]=v.useState(!1);oo(()=>i(!0),[]);const o=n||r&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?cC.createPortal(c.jsx(Bn.div,{...s,ref:e}),o):null});tE.displayName=kF;function _F(t,e){return v.useReducer((n,s)=>e[n][s]??n,t)}var Cd=t=>{const{present:e,children:n}=t,s=SF(e),r=typeof n=="function"?n({present:s.isPresent}):v.Children.only(n),i=os(s.ref,jF(r));return typeof n=="function"||s.isPresent?v.cloneElement(r,{ref:i}):null};Cd.displayName="Presence";function SF(t){const[e,n]=v.useState(),s=v.useRef(null),r=v.useRef(t),i=v.useRef("none"),o=t?"mounted":"unmounted",[a,l]=_F(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const u=kh(s.current);i.current=a==="mounted"?u:"none"},[a]),oo(()=>{const u=s.current,d=r.current;if(d!==t){const f=i.current,p=kh(u);t?l("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),oo(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=p=>{const x=kh(s.current).includes(CSS.escape(p.animationName));if(p.target===e&&x&&(l("ANIMATION_END"),!r.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},f=p=>{p.target===e&&(i.current=kh(s.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(u=>{s.current=u?getComputedStyle(u):null,n(u)},[])}}function kh(t){return(t==null?void 0:t.animationName)||"none"}function jF(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var cg="rovingFocusGroup.onEntryFocus",CF={bubbles:!1,cancelable:!0},Nd="RovingFocusGroup",[yy,nE,NF]=CN(Nd),[EF,sE]=Sd(Nd,[NF]),[TF,PF]=EF(Nd),rE=v.forwardRef((t,e)=>c.jsx(yy.Provider,{scope:t.__scopeRovingFocusGroup,children:c.jsx(yy.Slot,{scope:t.__scopeRovingFocusGroup,children:c.jsx(RF,{...t,ref:e})})}));rE.displayName=Nd;var RF=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:r=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=v.useRef(null),p=os(e,f),w=NN(i),[x,y]=SN({prop:o,defaultProp:a??null,onChange:l,caller:Nd}),[g,m]=v.useState(!1),b=ai(u),k=nE(n),_=v.useRef(!1),[C,S]=v.useState(0);return v.useEffect(()=>{const j=f.current;if(j)return j.addEventListener(cg,b),()=>j.removeEventListener(cg,b)},[b]),c.jsx(TF,{scope:n,orientation:s,dir:w,loop:r,currentTabStopId:x,onItemFocus:v.useCallback(j=>y(j),[y]),onItemShiftTab:v.useCallback(()=>m(!0),[]),onFocusableItemAdd:v.useCallback(()=>S(j=>j+1),[]),onFocusableItemRemove:v.useCallback(()=>S(j=>j-1),[]),children:c.jsx(Bn.div,{tabIndex:g||C===0?-1:0,"data-orientation":s,...h,ref:p,style:{outline:"none",...t.style},onMouseDown:nt(t.onMouseDown,()=>{_.current=!0}),onFocus:nt(t.onFocus,j=>{const T=!_.current;if(j.target===j.currentTarget&&T&&!g){const P=new CustomEvent(cg,CF);if(j.currentTarget.dispatchEvent(P),!P.defaultPrevented){const L=k().filter(A=>A.focusable),D=L.find(A=>A.active),O=L.find(A=>A.id===x),I=[D,O,...L].filter(Boolean).map(A=>A.ref.current);aE(I,d)}}_.current=!1}),onBlur:nt(t.onBlur,()=>m(!1))})})}),iE="RovingFocusGroupItem",oE=v.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:r=!1,tabStopId:i,children:o,...a}=t,l=py(),u=i||l,d=PF(iE,n),h=d.currentTabStopId===u,f=nE(n),{onFocusableItemAdd:p,onFocusableItemRemove:w,currentTabStopId:x}=d;return v.useEffect(()=>{if(s)return p(),()=>w()},[s,p,w]),c.jsx(yy.ItemSlot,{scope:n,id:u,focusable:s,active:r,children:c.jsx(Bn.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...a,ref:e,onMouseDown:nt(t.onMouseDown,y=>{s?d.onItemFocus(u):y.preventDefault()}),onFocus:nt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:nt(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){d.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const g=MF(y,d.orientation,d.dir);if(g!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let b=f().filter(k=>k.focusable).map(k=>k.ref.current);if(g==="last")b.reverse();else if(g==="prev"||g==="next"){g==="prev"&&b.reverse();const k=b.indexOf(y.currentTarget);b=d.loop?IF(b,k+1):b.slice(k+1)}setTimeout(()=>aE(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});oE.displayName=iE;var AF={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function OF(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function MF(t,e,n){const s=OF(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return AF[s]}function aE(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function IF(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var DF=rE,LF=oE;function $F(t){const e=FF(t),n=v.forwardRef((s,r)=>{const{children:i,...o}=s,a=v.Children.toArray(i),l=a.find(BF);if(l){const u=l.props.children,d=a.map(h=>h===l?v.Children.count(u)>1?v.Children.only(null):v.isValidElement(u)?u.props.children:null:h);return c.jsx(e,{...o,ref:r,children:v.isValidElement(u)?v.cloneElement(u,void 0,d):null})}return c.jsx(e,{...o,ref:r,children:i})});return n.displayName=`${t}.Slot`,n}function FF(t){const e=v.forwardRef((n,s)=>{const{children:r,...i}=n;if(v.isValidElement(r)){const o=HF(r),a=UF(i,r.props);return r.type!==v.Fragment&&(a.ref=s?ka(s,o):o),v.cloneElement(r,a)}return v.Children.count(r)>1?v.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var zF=Symbol("radix.slottable");function BF(t){return v.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===zF}function UF(t,e){const n={...e};for(const s in e){const r=t[s],i=e[s];/^on[A-Z]/.test(s)?r&&i?n[s]=(...a)=>{const l=i(...a);return r(...a),l}:r&&(n[s]=r):s==="style"?n[s]={...r,...i}:s==="className"&&(n[s]=[r,i].filter(Boolean).join(" "))}return{...t,...n}}function HF(t){var s,r;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var WF=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ha=new WeakMap,_h=new WeakMap,Sh={},ug=0,lE=function(t){return t&&(t.host||lE(t.parentNode))},VF=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=lE(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},qF=function(t,e,n,s){var r=VF(e,Array.isArray(t)?t:[t]);Sh[n]||(Sh[n]=new WeakMap);var i=Sh[n],o=[],a=new Set,l=new Set(r),u=function(h){!h||a.has(h)||(a.add(h),u(h.parentNode))};r.forEach(u);var d=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))d(f);else try{var p=f.getAttribute(s),w=p!==null&&p!=="false",x=(Ha.get(f)||0)+1,y=(i.get(f)||0)+1;Ha.set(f,x),i.set(f,y),o.push(f),x===1&&w&&_h.set(f,!0),y===1&&f.setAttribute(n,"true"),w||f.setAttribute(s,"true")}catch(g){console.error("aria-hidden: cannot operate on ",f,g)}})};return d(e),a.clear(),ug++,function(){o.forEach(function(h){var f=Ha.get(h)-1,p=i.get(h)-1;Ha.set(h,f),i.set(h,p),f||(_h.has(h)||h.removeAttribute(s),_h.delete(h)),p||h.removeAttribute(n)}),ug--,ug||(Ha=new WeakMap,Ha=new WeakMap,_h=new WeakMap,Sh={})}},KF=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),r=WF(t);return r?(s.push.apply(s,Array.from(r.querySelectorAll("[aria-live], script"))),qF(s,r,n,"aria-hidden")):function(){return null}},mf="right-scroll-bar-position",gf="width-before-scroll-bar",GF="with-scroll-bars-hidden",YF="--removed-body-scroll-bar-size";function dg(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function QF(t,e){var n=v.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var r=n.value;r!==s&&(n.value=s,n.callback(s,r))}}}})[0];return n.callback=e,n.facade}var XF=typeof window<"u"?v.useLayoutEffect:v.useEffect,Ok=new WeakMap;function JF(t,e){var n=QF(null,function(s){return t.forEach(function(r){return dg(r,s)})});return XF(function(){var s=Ok.get(n);if(s){var r=new Set(s),i=new Set(t),o=n.current;r.forEach(function(a){i.has(a)||dg(a,null)}),i.forEach(function(a){r.has(a)||dg(a,o)})}Ok.set(n,t)},[t]),n}function ZF(t){return t}function ez(t,e){e===void 0&&(e=ZF);var n=[],s=!1,r={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,s);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(s=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){s=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return r}function tz(t){t===void 0&&(t={});var e=ez(null);return e.options=Cr({async:!0,ssr:!1},t),e}var cE=function(t){var e=t.sideCar,n=oc(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return v.createElement(s,Cr({},n))};cE.isSideCarExport=!0;function nz(t,e){return t.useMedium(e),cE}var uE=tz(),hg=function(){},qp=v.forwardRef(function(t,e){var n=v.useRef(null),s=v.useState({onScrollCapture:hg,onWheelCapture:hg,onTouchMoveCapture:hg}),r=s[0],i=s[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,p=t.noRelative,w=t.noIsolation,x=t.inert,y=t.allowPinchZoom,g=t.as,m=g===void 0?"div":g,b=t.gapMode,k=oc(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=f,C=JF([n,e]),S=Cr(Cr({},k),r);return v.createElement(v.Fragment,null,d&&v.createElement(_,{sideCar:uE,removeScrollBar:u,shards:h,noRelative:p,noIsolation:w,inert:x,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:b}),o?v.cloneElement(v.Children.only(a),Cr(Cr({},S),{ref:C})):v.createElement(m,Cr({},S,{className:l,ref:C}),a))});qp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};qp.classNames={fullWidth:gf,zeroRight:mf};var sz=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function rz(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=sz();return e&&t.setAttribute("nonce",e),t}function iz(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function oz(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var az=function(){var t=0,e=null;return{add:function(n){t==0&&(e=rz())&&(iz(e,n),oz(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},lz=function(){var t=az();return function(e,n){v.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},dE=function(){var t=lz(),e=function(n){var s=n.styles,r=n.dynamic;return t(s,r),null};return e},cz={left:0,top:0,right:0,gap:0},fg=function(t){return parseInt(t||"",10)||0},uz=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],r=e[t==="padding"?"paddingRight":"marginRight"];return[fg(n),fg(s),fg(r)]},dz=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return cz;var e=uz(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},hz=dE(),Sl="data-scroll-locked",fz=function(t,e,n,s){var r=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(GF,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(a,"px ").concat(s,`;
  }
  body[`).concat(Sl,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(mf,` {
    right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(gf,` {
    margin-right: `).concat(a,"px ").concat(s,`;
  }
  
  .`).concat(mf," .").concat(mf,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(gf," .").concat(gf,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Sl,`] {
    `).concat(YF,": ").concat(a,`px;
  }
`)},Mk=function(){var t=parseInt(document.body.getAttribute(Sl)||"0",10);return isFinite(t)?t:0},pz=function(){v.useEffect(function(){return document.body.setAttribute(Sl,(Mk()+1).toString()),function(){var t=Mk()-1;t<=0?document.body.removeAttribute(Sl):document.body.setAttribute(Sl,t.toString())}},[])},mz=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,r=s===void 0?"margin":s;pz();var i=v.useMemo(function(){return dz(r)},[r]);return v.createElement(hz,{styles:fz(i,!e,r,n?"":"!important")})},vy=!1;if(typeof window<"u")try{var jh=Object.defineProperty({},"passive",{get:function(){return vy=!0,!0}});window.addEventListener("test",jh,jh),window.removeEventListener("test",jh,jh)}catch{vy=!1}var Wa=vy?{passive:!1}:!1,gz=function(t){return t.tagName==="TEXTAREA"},hE=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!gz(t)&&n[e]==="visible")},xz=function(t){return hE(t,"overflowY")},yz=function(t){return hE(t,"overflowX")},Ik=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var r=fE(t,s);if(r){var i=pE(t,s),o=i[1],a=i[2];if(o>a)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},vz=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},bz=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},fE=function(t,e){return t==="v"?xz(e):yz(e)},pE=function(t,e){return t==="v"?vz(e):bz(e)},wz=function(t,e){return t==="h"&&e==="rtl"?-1:1},kz=function(t,e,n,s,r){var i=wz(t,window.getComputedStyle(e).direction),o=i*s,a=n.target,l=e.contains(a),u=!1,d=o>0,h=0,f=0;do{if(!a)break;var p=pE(t,a),w=p[0],x=p[1],y=p[2],g=x-y-i*w;(w||g)&&fE(t,a)&&(h+=g,f+=w);var m=a.parentNode;a=m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE?m.host:m}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(d&&Math.abs(h)<1||!d&&Math.abs(f)<1)&&(u=!0),u},Ch=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Dk=function(t){return[t.deltaX,t.deltaY]},Lk=function(t){return t&&"current"in t?t.current:t},_z=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Sz=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},jz=0,Va=[];function Cz(t){var e=v.useRef([]),n=v.useRef([0,0]),s=v.useRef(),r=v.useState(jz++)[0],i=v.useState(dE)[0],o=v.useRef(t);v.useEffect(function(){o.current=t},[t]),v.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(r));var x=MI([t.lockRef.current],(t.shards||[]).map(Lk),!0).filter(Boolean);return x.forEach(function(y){return y.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),x.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(r))})}}},[t.inert,t.lockRef.current,t.shards]);var a=v.useCallback(function(x,y){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var g=Ch(x),m=n.current,b="deltaX"in x?x.deltaX:m[0]-g[0],k="deltaY"in x?x.deltaY:m[1]-g[1],_,C=x.target,S=Math.abs(b)>Math.abs(k)?"h":"v";if("touches"in x&&S==="h"&&C.type==="range")return!1;var j=window.getSelection(),T=j&&j.anchorNode,P=T?T===C||T.contains(C):!1;if(P)return!1;var L=Ik(S,C);if(!L)return!0;if(L?_=S:(_=S==="v"?"h":"v",L=Ik(S,C)),!L)return!1;if(!s.current&&"changedTouches"in x&&(b||k)&&(s.current=_),!_)return!0;var D=s.current||_;return kz(D,y,x,D==="h"?b:k)},[]),l=v.useCallback(function(x){var y=x;if(!(!Va.length||Va[Va.length-1]!==i)){var g="deltaY"in y?Dk(y):Ch(y),m=e.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&_z(_.delta,g)})[0];if(m&&m.should){y.cancelable&&y.preventDefault();return}if(!m){var b=(o.current.shards||[]).map(Lk).filter(Boolean).filter(function(_){return _.contains(y.target)}),k=b.length>0?a(y,b[0]):!o.current.noIsolation;k&&y.cancelable&&y.preventDefault()}}},[]),u=v.useCallback(function(x,y,g,m){var b={name:x,delta:y,target:g,should:m,shadowParent:Nz(g)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(k){return k!==b})},1)},[]),d=v.useCallback(function(x){n.current=Ch(x),s.current=void 0},[]),h=v.useCallback(function(x){u(x.type,Dk(x),x.target,a(x,t.lockRef.current))},[]),f=v.useCallback(function(x){u(x.type,Ch(x),x.target,a(x,t.lockRef.current))},[]);v.useEffect(function(){return Va.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Wa),document.addEventListener("touchmove",l,Wa),document.addEventListener("touchstart",d,Wa),function(){Va=Va.filter(function(x){return x!==i}),document.removeEventListener("wheel",l,Wa),document.removeEventListener("touchmove",l,Wa),document.removeEventListener("touchstart",d,Wa)}},[]);var p=t.removeScrollBar,w=t.inert;return v.createElement(v.Fragment,null,w?v.createElement(i,{styles:Sz(r)}):null,p?v.createElement(mz,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Nz(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Ez=nz(uE,Cz);var mE=v.forwardRef(function(t,e){return v.createElement(qp,Cr({},t,{ref:e,sideCar:Ez}))});mE.classNames=qp.classNames;var by=["Enter"," "],Tz=["ArrowDown","PageUp","Home"],gE=["ArrowUp","PageDown","End"],Pz=[...Tz,...gE],Rz={ltr:[...by,"ArrowRight"],rtl:[...by,"ArrowLeft"]},Az={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ed="Menu",[Hu,Oz,Mz]=CN(Ed),[_a,xE]=Sd(Ed,[Mz,qN,sE]),Kp=qN(),yE=sE(),[Iz,Sa]=_a(Ed),[Dz,Td]=_a(Ed),vE=t=>{const{__scopeMenu:e,open:n=!1,children:s,dir:r,onOpenChange:i,modal:o=!0}=t,a=Kp(e),[l,u]=v.useState(null),d=v.useRef(!1),h=ai(i),f=NN(r);return v.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",w,{capture:!0,once:!0}),document.addEventListener("pointermove",w,{capture:!0,once:!0})},w=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",w,{capture:!0}),document.removeEventListener("pointermove",w,{capture:!0})}},[]),c.jsx(yF,{...a,children:c.jsx(Iz,{scope:e,open:n,onOpenChange:h,content:l,onContentChange:u,children:c.jsx(Dz,{scope:e,onClose:v.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:s})})})};vE.displayName=Ed;var Lz="MenuAnchor",c0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=Kp(n);return c.jsx(vF,{...r,...s,ref:e})});c0.displayName=Lz;var u0="MenuPortal",[$z,bE]=_a(u0,{forceMount:void 0}),wE=t=>{const{__scopeMenu:e,forceMount:n,children:s,container:r}=t,i=Sa(u0,e);return c.jsx($z,{scope:e,forceMount:n,children:c.jsx(Cd,{present:n||i.open,children:c.jsx(tE,{asChild:!0,container:r,children:s})})})};wE.displayName=u0;var $s="MenuContent",[Fz,d0]=_a($s),kE=v.forwardRef((t,e)=>{const n=bE($s,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Sa($s,t.__scopeMenu),o=Td($s,t.__scopeMenu);return c.jsx(Hu.Provider,{scope:t.__scopeMenu,children:c.jsx(Cd,{present:s||i.open,children:c.jsx(Hu.Slot,{scope:t.__scopeMenu,children:o.modal?c.jsx(zz,{...r,ref:e}):c.jsx(Bz,{...r,ref:e})})})})}),zz=v.forwardRef((t,e)=>{const n=Sa($s,t.__scopeMenu),s=v.useRef(null),r=os(e,s);return v.useEffect(()=>{const i=s.current;if(i)return KF(i)},[]),c.jsx(h0,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:nt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Bz=v.forwardRef((t,e)=>{const n=Sa($s,t.__scopeMenu);return c.jsx(h0,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Uz=$F("MenuContent.ScrollLock"),h0=v.forwardRef((t,e)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,disableOutsideScroll:w,...x}=t,y=Sa($s,n),g=Td($s,n),m=Kp(n),b=yE(n),k=Oz(n),[_,C]=v.useState(null),S=v.useRef(null),j=os(e,S,y.onContentChange),T=v.useRef(0),P=v.useRef(""),L=v.useRef(0),D=v.useRef(null),O=v.useRef("right"),$=v.useRef(0),I=w?mE:v.Fragment,A=w?{as:Uz,allowPinchZoom:!0}:void 0,W=E=>{var de,Z;const F=P.current+E,V=k().filter(be=>!be.disabled),H=document.activeElement,he=(de=V.find(be=>be.ref.current===H))==null?void 0:de.textValue,ee=V.map(be=>be.textValue),U=e3(ee,F,he),Q=(Z=V.find(be=>be.textValue===U))==null?void 0:Z.ref.current;(function be(Ae){P.current=Ae,window.clearTimeout(T.current),Ae!==""&&(T.current=window.setTimeout(()=>be(""),1e3))})(F),Q&&setTimeout(()=>Q.focus())};v.useEffect(()=>()=>window.clearTimeout(T.current),[]),H5();const N=v.useCallback(E=>{var V,H;return O.current===((V=D.current)==null?void 0:V.side)&&n3(E,(H=D.current)==null?void 0:H.area)},[]);return c.jsx(Fz,{scope:n,searchRef:P,onItemEnter:v.useCallback(E=>{N(E)&&E.preventDefault()},[N]),onItemLeave:v.useCallback(E=>{var F;N(E)||((F=S.current)==null||F.focus(),C(null))},[N]),onTriggerLeave:v.useCallback(E=>{N(E)&&E.preventDefault()},[N]),pointerGraceTimerRef:L,onPointerGraceIntentChange:v.useCallback(E=>{D.current=E},[]),children:c.jsx(I,{...A,children:c.jsx(RN,{asChild:!0,trapped:r,onMountAutoFocus:nt(i,E=>{var F;E.preventDefault(),(F=S.current)==null||F.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:c.jsx(TN,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:p,children:c.jsx(DF,{asChild:!0,...b,dir:g.dir,orientation:"vertical",loop:s,currentTabStopId:_,onCurrentTabStopIdChange:C,onEntryFocus:nt(l,E=>{g.isUsingKeyboardRef.current||E.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(bF,{role:"menu","aria-orientation":"vertical","data-state":$E(y.open),"data-radix-menu-content":"",dir:g.dir,...m,...x,ref:j,style:{outline:"none",...x.style},onKeyDown:nt(x.onKeyDown,E=>{const V=E.target.closest("[data-radix-menu-content]")===E.currentTarget,H=E.ctrlKey||E.altKey||E.metaKey,he=E.key.length===1;V&&(E.key==="Tab"&&E.preventDefault(),!H&&he&&W(E.key));const ee=S.current;if(E.target!==ee||!Pz.includes(E.key))return;E.preventDefault();const Q=k().filter(de=>!de.disabled).map(de=>de.ref.current);gE.includes(E.key)&&Q.reverse(),Jz(Q)}),onBlur:nt(t.onBlur,E=>{E.currentTarget.contains(E.target)||(window.clearTimeout(T.current),P.current="")}),onPointerMove:nt(t.onPointerMove,Wu(E=>{const F=E.target,V=$.current!==E.clientX;if(E.currentTarget.contains(F)&&V){const H=E.clientX>$.current?"right":"left";O.current=H,$.current=E.clientX}}))})})})})})})});kE.displayName=$s;var Hz="MenuGroup",f0=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Bn.div,{role:"group",...s,ref:e})});f0.displayName=Hz;var Wz="MenuLabel",_E=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Bn.div,{...s,ref:e})});_E.displayName=Wz;var ip="MenuItem",$k="menu.itemSelect",Gp=v.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:s,...r}=t,i=v.useRef(null),o=Td(ip,t.__scopeMenu),a=d0(ip,t.__scopeMenu),l=os(e,i),u=v.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent($k,{bubbles:!0,cancelable:!0});h.addEventListener($k,p=>s==null?void 0:s(p),{once:!0}),jN(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return c.jsx(SE,{...r,ref:l,disabled:n,onClick:nt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:nt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:nt(t.onKeyDown,h=>{const f=a.searchRef.current!=="";n||f&&h.key===" "||by.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Gp.displayName=ip;var SE=v.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:s=!1,textValue:r,...i}=t,o=d0(ip,n),a=yE(n),l=v.useRef(null),u=os(e,l),[d,h]=v.useState(!1),[f,p]=v.useState("");return v.useEffect(()=>{const w=l.current;w&&p((w.textContent??"").trim())},[i.children]),c.jsx(Hu.ItemSlot,{scope:n,disabled:s,textValue:r??f,children:c.jsx(LF,{asChild:!0,...a,focusable:!s,children:c.jsx(Bn.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:u,onPointerMove:nt(t.onPointerMove,Wu(w=>{s?o.onItemLeave(w):(o.onItemEnter(w),w.defaultPrevented||w.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:nt(t.onPointerLeave,Wu(w=>o.onItemLeave(w))),onFocus:nt(t.onFocus,()=>h(!0)),onBlur:nt(t.onBlur,()=>h(!1))})})})}),Vz="MenuCheckboxItem",jE=v.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:s,...r}=t;return c.jsx(PE,{scope:t.__scopeMenu,checked:n,children:c.jsx(Gp,{role:"menuitemcheckbox","aria-checked":op(n)?"mixed":n,...r,ref:e,"data-state":m0(n),onSelect:nt(r.onSelect,()=>s==null?void 0:s(op(n)?!0:!n),{checkForDefaultPrevented:!1})})})});jE.displayName=Vz;var CE="MenuRadioGroup",[qz,Kz]=_a(CE,{value:void 0,onValueChange:()=>{}}),NE=v.forwardRef((t,e)=>{const{value:n,onValueChange:s,...r}=t,i=ai(s);return c.jsx(qz,{scope:t.__scopeMenu,value:n,onValueChange:i,children:c.jsx(f0,{...r,ref:e})})});NE.displayName=CE;var EE="MenuRadioItem",TE=v.forwardRef((t,e)=>{const{value:n,...s}=t,r=Kz(EE,t.__scopeMenu),i=n===r.value;return c.jsx(PE,{scope:t.__scopeMenu,checked:i,children:c.jsx(Gp,{role:"menuitemradio","aria-checked":i,...s,ref:e,"data-state":m0(i),onSelect:nt(s.onSelect,()=>{var o;return(o=r.onValueChange)==null?void 0:o.call(r,n)},{checkForDefaultPrevented:!1})})})});TE.displayName=EE;var p0="MenuItemIndicator",[PE,Gz]=_a(p0,{checked:!1}),RE=v.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:s,...r}=t,i=Gz(p0,n);return c.jsx(Cd,{present:s||op(i.checked)||i.checked===!0,children:c.jsx(Bn.span,{...r,ref:e,"data-state":m0(i.checked)})})});RE.displayName=p0;var Yz="MenuSeparator",AE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return c.jsx(Bn.div,{role:"separator","aria-orientation":"horizontal",...s,ref:e})});AE.displayName=Yz;var Qz="MenuArrow",OE=v.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,r=Kp(n);return c.jsx(wF,{...r,...s,ref:e})});OE.displayName=Qz;var Xz="MenuSub",[X7,ME]=_a(Xz),qc="MenuSubTrigger",IE=v.forwardRef((t,e)=>{const n=Sa(qc,t.__scopeMenu),s=Td(qc,t.__scopeMenu),r=ME(qc,t.__scopeMenu),i=d0(qc,t.__scopeMenu),o=v.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,u={__scopeMenu:t.__scopeMenu},d=v.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return v.useEffect(()=>d,[d]),v.useEffect(()=>{const h=a.current;return()=>{window.clearTimeout(h),l(null)}},[a,l]),c.jsx(c0,{asChild:!0,...u,children:c.jsx(SE,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":$E(n.open),...t,ref:ka(e,r.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:nt(t.onPointerMove,Wu(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:nt(t.onPointerLeave,Wu(h=>{var p,w;d();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const x=(w=n.content)==null?void 0:w.dataset.side,y=x==="right",g=y?-5:5,m=f[y?"left":"right"],b=f[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+g,y:h.clientY},{x:m,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:m,y:f.bottom}],side:x}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:nt(t.onKeyDown,h=>{var p;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||Rz[s.dir].includes(h.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),h.preventDefault())})})})});IE.displayName=qc;var DE="MenuSubContent",LE=v.forwardRef((t,e)=>{const n=bE($s,t.__scopeMenu),{forceMount:s=n.forceMount,...r}=t,i=Sa($s,t.__scopeMenu),o=Td($s,t.__scopeMenu),a=ME(DE,t.__scopeMenu),l=v.useRef(null),u=os(e,l);return c.jsx(Hu.Provider,{scope:t.__scopeMenu,children:c.jsx(Cd,{present:s||i.open,children:c.jsx(Hu.Slot,{scope:t.__scopeMenu,children:c.jsx(h0,{id:a.contentId,"aria-labelledby":a.triggerId,...r,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:nt(t.onFocusOutside,d=>{d.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:nt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:nt(t.onKeyDown,d=>{var p;const h=d.currentTarget.contains(d.target),f=Az[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(p=a.trigger)==null||p.focus(),d.preventDefault())})})})})})});LE.displayName=DE;function $E(t){return t?"open":"closed"}function op(t){return t==="indeterminate"}function m0(t){return op(t)?"indeterminate":t?"checked":"unchecked"}function Jz(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function Zz(t,e){return t.map((n,s)=>t[(e+s)%t.length])}function e3(t,e,n){const r=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=Zz(t,Math.max(i,0));r.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.toLowerCase().startsWith(r.toLowerCase()));return l!==n?l:void 0}function t3(t,e){const{x:n,y:s}=t;let r=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],u=a.x,d=a.y,h=l.x,f=l.y;d>s!=f>s&&n<(h-u)*(s-d)/(f-d)+u&&(r=!r)}return r}function n3(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return t3(n,e)}function Wu(t){return e=>e.pointerType==="mouse"?t(e):void 0}var s3=vE,r3=c0,i3=wE,o3=kE,a3=f0,l3=_E,c3=Gp,u3=jE,d3=NE,h3=TE,f3=RE,p3=AE,m3=OE,g3=IE,x3=LE,Yp="DropdownMenu",[y3]=Sd(Yp,[xE]),Un=xE(),[v3,FE]=y3(Yp),zE=t=>{const{__scopeDropdownMenu:e,children:n,dir:s,open:r,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=Un(e),u=v.useRef(null),[d,h]=SN({prop:r,defaultProp:i??!1,onChange:o,caller:Yp});return c.jsx(v3,{scope:e,triggerId:py(),triggerRef:u,contentId:py(),open:d,onOpenChange:h,onOpenToggle:v.useCallback(()=>h(f=>!f),[h]),modal:a,children:c.jsx(s3,{...l,open:d,onOpenChange:h,dir:s,modal:a,children:n})})};zE.displayName=Yp;var BE="DropdownMenuTrigger",UE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...r}=t,i=FE(BE,n),o=Un(n);return c.jsx(r3,{asChild:!0,...o,children:c.jsx(Bn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...r,ref:ka(e,i.triggerRef),onPointerDown:nt(t.onPointerDown,a=>{!s&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:nt(t.onKeyDown,a=>{s||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});UE.displayName=BE;var b3="DropdownMenuPortal",HE=t=>{const{__scopeDropdownMenu:e,...n}=t,s=Un(e);return c.jsx(i3,{...s,...n})};HE.displayName=b3;var WE="DropdownMenuContent",VE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=FE(WE,n),i=Un(n),o=v.useRef(!1);return c.jsx(o3,{id:r.contentId,"aria-labelledby":r.triggerId,...i,...s,ref:e,onCloseAutoFocus:nt(t.onCloseAutoFocus,a=>{var l;o.current||(l=r.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:nt(t.onInteractOutside,a=>{const l=a.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;(!r.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});VE.displayName=WE;var w3="DropdownMenuGroup",k3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(a3,{...r,...s,ref:e})});k3.displayName=w3;var _3="DropdownMenuLabel",qE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(l3,{...r,...s,ref:e})});qE.displayName=_3;var S3="DropdownMenuItem",KE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(c3,{...r,...s,ref:e})});KE.displayName=S3;var j3="DropdownMenuCheckboxItem",C3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(u3,{...r,...s,ref:e})});C3.displayName=j3;var N3="DropdownMenuRadioGroup",E3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(d3,{...r,...s,ref:e})});E3.displayName=N3;var T3="DropdownMenuRadioItem",P3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(h3,{...r,...s,ref:e})});P3.displayName=T3;var R3="DropdownMenuItemIndicator",A3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(f3,{...r,...s,ref:e})});A3.displayName=R3;var O3="DropdownMenuSeparator",GE=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(p3,{...r,...s,ref:e})});GE.displayName=O3;var M3="DropdownMenuArrow",I3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(m3,{...r,...s,ref:e})});I3.displayName=M3;var D3="DropdownMenuSubTrigger",L3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(g3,{...r,...s,ref:e})});L3.displayName=D3;var $3="DropdownMenuSubContent",F3=v.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,r=Un(n);return c.jsx(x3,{...r,...s,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});F3.displayName=$3;var z3=zE,B3=UE,U3=HE,H3=VE,W3=qE,V3=KE,q3=GE;const Qp=z3,Xp=B3,Pd=ge.forwardRef(({className:t,sideOffset:e=8,...n},s)=>c.jsx(U3,{children:c.jsx(H3,{ref:s,sideOffset:e,className:Te("z-[90] min-w-[220px] overflow-hidden rounded-2xl p-1","bg-white/75 dark:bg-black/40 backdrop-blur-md shadow-soft2","ring-1 ring-black/5 dark:ring-white/10",t),...n})}));Pd.displayName="DropdownMenuContent";const YE=ge.forwardRef(({className:t,...e},n)=>c.jsx(W3,{ref:n,className:Te("px-3 py-2 text-xs text-black/60 dark:text-white/60",t),...e}));YE.displayName="DropdownMenuLabel";const ap=ge.forwardRef(({className:t,...e},n)=>c.jsx(q3,{ref:n,className:Te("my-1 h-px bg-black/5 dark:bg-white/10",t),...e}));ap.displayName="DropdownMenuSeparator";const Vu=ge.forwardRef(({className:t,inset:e,...n},s)=>c.jsx(V3,{ref:s,className:Te("relative flex cursor-default select-none items-center gap-2 rounded-xl px-3 py-2 text-sm outline-none","text-black/90 dark:text-white/90","focus:bg-black/5 dark:focus:bg-white/10",e&&"pl-8",t),...n}));Vu.displayName="DropdownMenuItem";function En({className:t,variant:e="secondary",...n}){return c.jsx(te,{variant:e,size:"icon",className:Te("rounded-xl h-8 w-8",t),...n})}function ws({open:t,onClose:e,title:n,children:s,maxWidth:r="520px"}){if(!t)return null;const i=c.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm px-4 py-6 overflow-y-auto",children:c.jsx("div",{className:"w-full",style:{maxWidth:r},children:c.jsxs("div",{className:"rounded-2xl bg-white/90 dark:bg-neutral-900/95 shadow-2xl ring-1 ring-black/10 dark:ring-white/10 max-h-[85vh] flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-black/5 dark:border-white/10",children:[c.jsx("div",{className:"text-sm font-semibold",children:n}),c.jsx("button",{className:"text-black/60 dark:text-white/60 hover:opacity-100 opacity-70",onClick:e,children:""})]}),c.jsx("div",{className:"p-4 overflow-y-auto",children:s})]})})});return typeof document>"u"?i:xd.createPortal(i,document.body)}function uc({open:t,onClose:e,onConfirm:n,message:s}){return t?c.jsx(ws,{open:t,onClose:e,title:"Confirm",maxWidth:"420px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm text-black/70 dark:text-white/70",children:s||"Are you sure?"}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:n,children:"Confirm"})]})]})}):null}const QE=v.createContext(null);function g0(){const t=v.useContext(QE);if(!t)throw new Error("useNotifications must be used inside NotificationsProvider");return t}function K3({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function G3(){const t=bd(),{notifications:e,unreadCount:n,clearAll:s,dismissNotification:r,markRead:i,formatTime:o}=g0(),[a,l]=v.useState(null),u=v.useMemo(()=>e.slice(0,6),[e]);return c.jsxs(c.Fragment,{children:[c.jsxs(Qp,{children:[c.jsx(Xp,{asChild:!0,children:c.jsxs("button",{className:"relative flex h-9 w-9 items-center justify-center rounded-2xl bg-black/5 dark:bg-white/10 text-black/80 dark:text-white/80 shadow-soft","aria-label":"Notifications",children:[c.jsx(PM,{size:18}),n?c.jsx("span",{className:"absolute -right-1 -top-1 min-w-[18px] rounded-full bg-rose-500 px-1 text-[11px] font-semibold leading-4 text-white",children:n>99?"99+":n}):null]})}),c.jsxs(Pd,{align:"end",className:"w-[320px] p-0 bg-white/90 dark:bg-neutral-900/85",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold",children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:e.length?`${e.length} total`:"No alerts"})]}),c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:s,disabled:!e.length,children:"Clear all"})]}),c.jsx(ap,{}),c.jsx("div",{className:"max-h-[320px] overflow-y-auto p-2 space-y-2",children:u.length?u.map(d=>c.jsx("div",{className:Te("rounded-xl px-3 py-2 ring-1 transition-colors",d.read?"bg-white/50 dark:bg-white/5 ring-black/5 dark:ring-white/10":"bg-black/5 dark:bg-white/10 ring-black/10 dark:ring-white/20"),children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:d.title||"Notification"}),d.message?c.jsx("div",{className:"mt-0.5 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:d.message}):null,d.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:o(d.created_at)}):null]}),c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx(En,{variant:"ghost",className:"h-7 w-7",onClick:()=>r(d.id),"aria-label":"Dismiss notification",children:c.jsx(qv,{size:14})}),c.jsx(En,{variant:"ghost",className:"h-7 w-7",onClick:()=>{i(d.id),l(d)},"aria-label":"View notification",children:c.jsx(UC,{size:14})})]})]})},d.id)):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 p-4 text-xs text-black/50 dark:text-white/60 text-center",children:"You're all caught up."})}),c.jsx(ap,{}),c.jsx("div",{className:"px-3 py-2",children:c.jsx(te,{variant:"secondary",className:"w-full rounded-2xl",onClick:()=>t("/app/notifications"),children:"View all notifications"})})]})]}),c.jsx(ws,{open:!!a,onClose:()=>l(null),title:(a==null?void 0:a.title)||"Notification",maxWidth:"520px",children:c.jsx(K3,{notification:a})})]})}function Dt({className:t,...e}){return c.jsx("div",{className:Te("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 shadow-soft",t),...e})}function Y3(){const{toasts:t,dismissToast:e,formatTime:n}=g0();return t.length?c.jsx("div",{className:"fixed right-6 top-24 z-50 flex w-[320px] flex-col gap-2",children:t.map(s=>{const r=s.notification;return c.jsx(Dt,{className:"p-3 bg-white dark:bg-neutral-900 shadow-soft ring-1 ring-black/10 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/85 dark:text-white/85 truncate",children:r.title||"Notification"}),r.message?c.jsx("div",{className:"mt-1 text-xs text-black/60 dark:text-white/65 leading-4 mmg-line-clamp-2",children:r.message}):null,r.created_at?c.jsx("div",{className:"mt-1 text-[11px] text-black/45 dark:text-white/45",children:n(r.created_at)}):null]}),c.jsx("button",{type:"button",className:"rounded-full p-1 text-black/50 hover:text-black/80 dark:text-white/50 dark:hover:text-white/80",onClick:()=>e(s.id),"aria-label":"Dismiss notification",children:c.jsx(qv,{size:14})})]})},s.id)})}):null}async function Q3(){return Me("/api/modules/accessible",{method:"GET"})}async function X3({limit:t,offset:e=0,newestFirst:n=!1,signal:s}={}){const r=new URLSearchParams;t!=null&&r.set("limit",t),e>0&&r.set("offset",e),n&&r.set("newest_first","true");const i=r.toString();return Me(`/api/sales/chat/history${i?`?${i}`:""}`,{signal:s})}async function J3(t,e=[]){return Me("/api/sales/chat/attachments/refresh",{method:"POST",body:JSON.stringify({file_ids:t,prefetch_ids:e})})}async function Z3({conversationId:t,message:e,fileIds:n,onEvent:s,onChunk:r,onDone:i,onError:o,signal:a}){try{const l=Bp(),u=ac.API_BASE_URL||"",d=await fetch(`${u}/api/sales/chat/stream`,{method:"POST",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}},body:JSON.stringify({message:e,conversation_id:t,...n!=null&&n.length?{file_ids:n}:{}}),signal:a});if(d.status===401){Zi(),window.dispatchEvent(new CustomEvent("auth:logout")),o==null||o(new Error("Unauthorized"));return}if(!d.ok){const x=await d.json().catch(()=>({}));throw new Error(x.detail||`API error: ${d.status}`)}const h=d.body.getReader(),f=new TextDecoder;let p="",w=!1;for(;;){const{done:x,value:y}=await h.read();if(x)break;p+=f.decode(y,{stream:!0});const g=p.split(`
`);p=g.pop()||"";for(const m of g){const b=m.trim();if(!b.startsWith("data:"))continue;const k=b.replace(/^data:\s?/,"");if(!k||k==="[DONE]"){w=!0,i==null||i();continue}try{const _=JSON.parse(k);s==null||s(_),!s&&r&&(_.type==="chunk"||_.type==="content")&&r(_)}catch{const _={content:k};s==null||s(_),s||r==null||r(_)}}}w||i==null||i()}catch(l){throw o==null||o(l),l}}async function eB(t){const e=new FormData;return e.append("file",t),Me("/api/sales/files/upload",{method:"POST",body:e})}async function tB(){return Me("/api/assets/asset-types")}async function Fk(t,{timeOfDay:e,side:n,venueType:s}={}){const r=new URLSearchParams;e&&r.set("time_of_day",e),n&&r.set("side",n),s&&r.set("venue_type",s);const i=Array.isArray(t)?t[0]:t;return i?Me(`/api/sales/mockup/templates/${encodeURIComponent(i)}?${r.toString()}`):[]}async function nB(t){return Me("/api/sales/mockup/save-frame",{method:"POST",body:t})}async function sB(t){return Me("/api/sales/mockup/update-frame",{method:"PUT",body:t})}async function rB(t,e,{timeOfDay:n,side:s}={}){const r=new URLSearchParams;return r.set("photo_filename",e),n&&r.set("time_of_day",n),s&&r.set("side",s),Me(`/api/sales/mockup/photo/${t}?${r.toString()}`,{method:"DELETE"})}async function iB({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),i&&o.set("photo_filename",i);const a=encodeURIComponent(e);return Me(`/api/assets/mockup-frames/${t}/${a}/frame?${o.toString()}`)}async function oB({company:t,locationKey:e,environment:n="outdoor",timeOfDay:s="day",side:r="gold",photoFilename:i}={}){if(!t||!e||!i)return null;const o=new URLSearchParams;n&&o.set("environment",n),s&&o.set("time_of_day",s),r&&o.set("side",r),o.set("photo_filename",i);const a=encodeURIComponent(e);return Me(`/api/assets/mockup-frames/${t}/${a}?${o.toString()}`,{method:"DELETE"})}async function aB(t){return bN("/api/sales/mockup/test-preview",{method:"POST",body:t})}async function lB(t){return Me("/api/sales/mockup/generate",{method:"POST",body:t})}async function cB(){return Me("/api/sales/mockup/history")}async function XE(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){if(!t||!e)return null;const o=new URLSearchParams;o.set("photo_filename",e),n&&o.set("time_of_day",n),s&&o.set("side",s),r&&o.set("company",r),i&&o.set("venue_type",i);const a=`/api/sales/mockup/photo/${t}?${o.toString()}`;return bN(a)}async function uB(t,e,{timeOfDay:n,side:s,company:r,venueType:i}={}){const o=await XE(t,e,{timeOfDay:n,side:s,company:r,venueType:i});return o?URL.createObjectURL(o):""}async function dB(){return Me("/api/sales/mockup/eligibility/setup")}async function hB(){return Me("/api/sales/mockup/eligibility/generate")}async function fB({service:t,displayType:e}={}){const n=new URLSearchParams;t&&n.set("service",t),e&&n.set("display_type",e);const s=n.toString();return Me(`/api/sales/locations${s?`?${s}`:""}`)}async function pB(t){return t?Me(`/api/sales/locations/${encodeURIComponent(t)}`):null}async function mB(t){return Me("/api/sales/proposals",{method:"POST",body:JSON.stringify(t)})}async function gB(){return Me("/api/sales/proposals/history")}async function xB({limit:t=100,offset:e=0}={}){return Me("/api/rbac/users")}async function yB(t){return Me(`/api/rbac/user/${t}`)}async function vB(t){return Me(`/api/rbac/users/${t}/permissions`)}async function bB(t){return Me("/api/rbac/users",{method:"POST",body:JSON.stringify(t)})}async function wB(t,e){return Me(`/api/rbac/users/${t}`,{method:"PUT",body:JSON.stringify(e)})}async function kB(t){return Me(`/api/rbac/users/${encodeURIComponent(t)}/deactivate`,{method:"POST"})}async function _B(t){return Me(`/api/rbac/users/${encodeURIComponent(t)}/reactivate`,{method:"POST"})}async function SB(){return Me("/api/rbac/profiles")}async function jB(t){return Me("/api/rbac/profiles",{method:"POST",body:JSON.stringify(t)})}async function CB(t,e){return Me(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function NB(t){return Me(`/api/rbac/profiles/${encodeURIComponent(t)}`,{method:"DELETE"})}async function zk(t,e){return Me(`/api/rbac/users/${t}/permissions`,{method:"PUT",body:JSON.stringify({permissions:e})})}async function EB(){return await Me("/api/rbac/permissions")}async function pg(t,e){return Me("/api/rbac/permissions",{method:"POST",body:JSON.stringify({name:t,description:e})})}async function Bk(t){return Me(`/api/rbac/permissions/${encodeURIComponent(t)}`,{method:"DELETE"})}async function TB(){const t=await Me("/api/rbac/companies");return t.companies||t}async function PB(t){return Me("/api/assets/companies",{method:"POST",body:JSON.stringify(t)})}async function RB(t,e){return Me(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function AB(t){return Me(`/api/assets/companies/${encodeURIComponent(t)}`,{method:"DELETE"})}async function OB(){return Me("/api/rbac/permission-sets")}async function MB(t){return Me("/api/rbac/permission-sets",{method:"POST",body:JSON.stringify(t)})}async function IB(t,e){return Me(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify(e)})}async function DB(t){return Me(`/api/rbac/permission-sets/${encodeURIComponent(t)}`,{method:"DELETE"})}const x0="mmg-notifications",Rd="/api/notifications";function LB(t,e){if(!t)return e;try{return JSON.parse(t)}catch{return e}}function eo(){if(typeof window>"u")return[];const t=window.localStorage.getItem(x0),e=LB(t,[]);return Array.isArray(e)?e:[]}function Jp(t){typeof window>"u"||window.localStorage.setItem(x0,JSON.stringify(t))}function Uk(t){const e=new Date().toISOString();return{id:(t==null?void 0:t.id)||(typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`ntf_${Date.now()}_${Math.random().toString(16).slice(2,8)}`),title:(t==null?void 0:t.title)||"Notification",message:(t==null?void 0:t.message)||"",created_at:(t==null?void 0:t.created_at)||e,read:!!(t!=null&&t.read),level:(t==null?void 0:t.level)||"info",meta:(t==null?void 0:t.meta)||{}}}function $B(t){return Array.isArray(t)?t:Array.isArray(t==null?void 0:t.notifications)?t.notifications:Array.isArray(t==null?void 0:t.data)?t.data:[]}function FB(){return Me(Rd).then(t=>$B(t)).catch(()=>eo())}function zB(t){return Me(Rd,{method:"POST",body:JSON.stringify(t||{})}).then(e=>(e==null?void 0:e.notification)||(e==null?void 0:e.data)||e||Uk(t)).catch(()=>{const e=eo(),n=Uk(t),s=[n,...e];return Jp(s),n})}function BB(){return Me(Rd,{method:"DELETE"}).then(()=>[]).catch(()=>(Jp([]),[]))}function UB(t){return t?Me(`${Rd}/${encodeURIComponent(t)}`,{method:"DELETE"}).then(()=>eo()).catch(()=>{const e=eo().filter(n=>n.id!==t);return Jp(e),e}):Promise.resolve(eo())}function HB(t){return t?Me(`${Rd}/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify({read:!0})}).then(()=>eo()).catch(()=>{const e=eo().map(n=>n.id===t?{...n,read:!0}:n);return Jp(e),e}):Promise.resolve(eo())}const WB=x0;function Bs(t){if(!t||t==="NA")return null;if(t.includes("T")){const i=new Date(t);if(!Number.isNaN(i.getTime()))return i}const e=t.split(" "),n=e[0],s=e[1],r=n.split("-");if(r.length===3){const i=Number(r[0]),o=Number(r[1])-1,a=Number(r[2]);if(Number.isNaN(i)||Number.isNaN(o)||Number.isNaN(a))return null;if(s){const u=s.split(":"),d=Number(u[0]||0),h=Number(u[1]||0),f=Number(u[2]||0),p=new Date(a,o,i,d,h,f);return Number.isNaN(p.getTime())?null:p}const l=new Date(a,o,i);return l.setHours(0,0,0,0),Number.isNaN(l.getTime())?null:l}return null}function JE(t){var n;if(!((n=t==null?void 0:t.lifecycle)!=null&&n.length))return"";const e=t.lifecycle[t.lifecycle.length-1];return((e==null?void 0:e.stage)||"").toLowerCase()}function ZE(t){const e={};return t.forEach(n=>{const s=n.videographer||n.Videographer||"Unassigned";e[s]||(e[s]=[]),e[s].push(n)}),e}function Ci(t){const e={pending:0,rejected:0,returned:0,submitted:0,accepted:0};return t.forEach(n=>{(n.versions||[]).forEach(s=>{const r=JE(s);r==="pending"||r==="critique"?e.pending+=1:r==="rejected"||r==="editing"?e.rejected+=1:r==="returned"?e.returned+=1:r==="submitted"||r==="submitted to sales"?e.submitted+=1:(r==="accepted"||r==="done")&&(e.accepted+=1)})}),e}function eT(t){const e=t.length,n=t.filter(a=>{const l=a.videographer||a.Videographer||"Unassigned";return l&&l!=="Unassigned"&&a.status!=="Not assigned yet"}).length;let s=0;t.forEach(a=>{s+=(a.versions||[]).length});const r=Ci(t),i=r.accepted+r.submitted+r.rejected+r.returned,o=i>0?Math.round((r.accepted+r.submitted)/i*100):0;return{total:e,assigned:n,uploads:s,pending:r.pending,rejected:r.rejected,returned:r.returned,submitted_to_sales:r.submitted,accepted_videos:r.accepted,accepted_pct:o}}function tT(t){const e=t.filter(n=>n.status==="Accepted"||n.status==="Done").length;return{completed:e,not_completed:t.length-e}}function VB(t){let e=0,n=0,s=0,r=0,i=0;t.forEach(d=>{(d.versions||[]).forEach(h=>{const f=h.lifecycle||[];if(f.length<2)return;let p=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="pending"||m==="critique"){p=Bs(g.at);break}}let w=null,x=null;for(const g of f){const m=(g.stage||"").toLowerCase();if(m==="rejected"||m==="editing"||m==="accepted"||m==="submitted"||m==="submitted to sales"){w=Bs(g.at),x=m;break}}if(!p||!w||!x)return;s+=1;const y=Math.round((w-p)/(1e3*60*60));if(e+=y,n+=1,x==="accepted"||x==="submitted"||x==="submitted to sales"){let g=!1,m=!1;f.forEach(b=>{const k=(b.stage||"").toLowerCase();(k==="accepted"||k==="done")&&(g=!0),k==="returned"&&(m=!0)}),g&&(r+=1),m&&(i+=1)}})});const o=n>0?Math.round(e/n):0,a=o>0?`${o} hrs`:"0 hrs",l=r+i,u=l>0?Math.round(r/l*100):0;return{avg_response_display:a,handled:s,accepted:r,handled_percent:u}}function nT(t){const e=ZE(t),n={},s=new Date;return s.setHours(0,0,0,0),Object.entries(e).forEach(([r,i])=>{let o=0,a=0,l=0,u=0;i.forEach(p=>{(p.status==="Accepted"||p.status==="Done")&&(o+=1),a+=(p.versions||[]).length;const w=Bs(p.filming_deadline||p.filming_date||"");w&&w<=s&&(u+=1);const x=Bs(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(l+=1)});const d=Ci(i),h=d.accepted+d.submitted+d.rejected+d.returned,f=h>0?Math.round((d.accepted+d.submitted)/h*100):0;n[r]={total:i.length,started:u,late:l,completed:o,uploads:a,accepted_pct:f}}),n}function qu(t,e){const n=[];return t.forEach(s=>{(s.versions||[]).forEach(r=>{const i=JE(r);(i==="submitted to sales"?"submitted":i)===e&&n.push({task:s,version:r,stage:i})})}),n}function mg(t,e){const n=[];return t.forEach(s=>{const r=[];(s.versions||[]).forEach(i=>{(i.lifecycle||[]).forEach(o=>{const a=(o.stage||"").toLowerCase();(e==="hod"&&(a==="rejected"||a==="editing")||e==="hos"&&a==="returned")&&r.push({version:i.version,event:o,stage:a})})}),r.length&&n.push({...s,rejectionEvents:r,rejectionCount:r.length})}),n}function sT(t){const e=qu(t,"pending"),n=[];return e.forEach(({task:s,version:r})=>{let i=null;(r.lifecycle||[]).forEach(a=>{const l=(a.stage||"").toLowerCase();(l==="pending"||l==="critique")&&(i=Bs(a.at))});const o=i?Math.round((Date.now()-i.getTime())/(1e3*60*60)):null;n.push({task:s,version:r,uploadTime:i,waitingHours:o})}),{count:n.length,reviews:n}}function rT(t){const e=[];return t.forEach(n=>{(n.versions||[]).forEach(s=>{let r=null,i=null,o=null,a=null,l=null;if((s.lifecycle||[]).forEach(u=>{const d=(u.stage||"").toLowerCase();!r&&(d==="pending"||d==="critique")&&(r=Bs(u.at)),!i&&(d==="rejected"||d==="editing"||d==="accepted"||d==="submitted"||d==="submitted to sales")&&(i=Bs(u.at),o=d,a=u.rejection_class||null,l=u.rejection_comments||null)}),r&&i&&o){const u=Math.round((i-r)/36e5);e.push({task:n,version:s,responseHours:u,uploadTime:r,reviewTime:i,decision:o,rejectionClass:a,comments:l})}})}),e}function iT(t){const e=eT(t),n=tT(t),s=new Date;s.setHours(0,0,0,0);let r=0,i=0,o=0,a=0,l=0,u=0;t.forEach(p=>{const w=Bs(p.filming_deadline||p.filming_date||"");w&&w<=s&&(r+=1);const x=Bs(p.submission_date||"");x&&x<=s&&p.status!=="Accepted"&&p.status!=="Done"&&(i+=1),(p.status==="Accepted"||p.status==="Done")&&(a+=1,o+=(p.versions||[]).length),(p.versions||[]).forEach(y=>{(y.lifecycle||[]).forEach(g=>{const m=(g.stage||"").toLowerCase();(m==="rejected"||m==="editing")&&(l+=1),m==="returned"&&(u+=1)})})});const d=a>0?(o/a).toFixed(2):"0",h=qu(t,"pending"),f=qu(t,"submitted");return{summary:e,pie:n,tasksStarted:r,lateTasks:i,pendingHOD:h.length,pendingHOS:f.length,rejectionsByHOD:l,rejectionsByHOS:u,uploadRatio:d}}function gg(t){const e=Bs(t.submission_date||"");if(!e)return!1;const n=new Date;return n.setHours(0,0,0,0),e<n&&t.status!=="Accepted"&&t.status!=="Done"}const fr=[{task_number:2217,brand:"City Brand Launch",filming_deadline:"17-02-2025",submission_date:"20-02-2025",status:"Critique",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"18-02-2025 10:00:00"}]}]},{task_number:2216,brand:"Mall LED Loop",filming_deadline:"16-02-2025",submission_date:"19-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"17-02-2025 09:00:00"},{stage:"submitted to sales",at:"18-02-2025 11:30:00"}]}]},{task_number:2215,brand:"Festival Teaser",filming_deadline:"15-02-2025",submission_date:"18-02-2025",status:"Returned",videographer:"Alyssa Reed",location:"Abu Dhabi",versions:[{version:1,lifecycle:[{stage:"pending",at:"15-02-2025 10:00:00"},{stage:"submitted",at:"16-02-2025 12:00:00"},{stage:"returned",at:"17-02-2025 15:30:00",rejection_class:"Lighting",rejection_comments:"Exposure too dark",rejected_by:"Head of Sales"}]}]},{task_number:2214,brand:"Luxury Auto Montage",filming_deadline:"14-02-2025",submission_date:"17-02-2025",status:"Editing",videographer:"Noah Chen",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"14-02-2025 09:30:00"},{stage:"rejected",at:"15-02-2025 12:10:00",rejection_class:"Artwork Color",rejection_comments:"Incorrect color profile",rejected_by:"Reviewer"}]}]},{task_number:2213,brand:"Airport Arrival Hero",filming_deadline:"12-02-2025",submission_date:"15-02-2025",status:"Accepted",videographer:"Noah Chen",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"12-02-2025 10:00:00"},{stage:"submitted to sales",at:"13-02-2025 15:00:00"},{stage:"accepted",at:"14-02-2025 12:00:00"}]}]},{task_number:2212,brand:"Retail Weekend Promo",filming_deadline:"10-02-2025",submission_date:"13-02-2025",status:"Done",videographer:"Ravi Sharma",location:"Ajman",versions:[{version:1,lifecycle:[{stage:"pending",at:"10-02-2025 10:00:00"},{stage:"submitted",at:"11-02-2025 14:00:00"},{stage:"done",at:"12-02-2025 10:00:00"}]}]},{task_number:2211,brand:"Harbor Night Loop",filming_deadline:"18-02-2025",submission_date:"21-02-2025",status:"Editing",videographer:"Alyssa Reed",location:"Dubai",versions:[{version:1,lifecycle:[{stage:"pending",at:"16-02-2025 11:00:00"},{stage:"editing",at:"17-02-2025 13:00:00",rejection_class:"Environment Too Dark",rejection_comments:"Please brighten the surrounding scene",rejected_by:"Reviewer"}]}]},{task_number:2210,brand:"City Center Countdown",filming_deadline:"22-02-2025",submission_date:"25-02-2025",status:"Assigned to Alyssa",videographer:"Alyssa Reed",location:"Dubai",versions:[]},{task_number:2209,brand:"Expo Walkthrough",filming_deadline:"24-02-2025",submission_date:"27-02-2025",status:"Not assigned yet",videographer:"Unassigned",location:"Abu Dhabi",versions:[]},{task_number:2208,brand:"Weekend Highlights",filming_deadline:"13-02-2025",submission_date:"16-02-2025",status:"Submitted to Sales",videographer:"Ravi Sharma",location:"Sharjah",versions:[{version:1,lifecycle:[{stage:"pending",at:"13-02-2025 09:00:00"},{stage:"rejected",at:"14-02-2025 10:30:00",rejection_class:"Lighting",rejection_comments:"Flicker in the panel",rejected_by:"Reviewer"}]},{version:2,lifecycle:[{stage:"pending",at:"15-02-2025 12:15:00"},{stage:"submitted",at:"16-02-2025 14:40:00"}]}]}],qB={session_id:"vc-session-01",messages:[{id:"vc-msg-1",role:"assistant",content:"Good morning. Upload a cut or describe the request, and I will log the critique, checklist, and next steps.",timestamp:"2025-02-18T08:40:12+04:00"}],message_count:1,last_updated:"2025-02-18T08:40:12+04:00"},KB=[{workflow_id:"workflow-2217",task_number:2217,folder_name:"City Brand Launch",status:"pending_reviewer",created_at:"2025-02-18T09:10:00+04:00",reviewer_approved:!1,hos_approved:!1}];function ar(t){return new Promise(e=>setTimeout(e,t))}function GB(t,e){const n=[];let s=0;for(;s<t.length;)n.push(t.slice(s,s+e)),s+=e;return n}function y0(t,e){const n=(t||"").trim();return[`${n?`Thanks for the details on "${n}".`:"Thanks for the upload."} ${e?"I reviewed the file and captured the critique highlights below:":"Here is a quick critique outline to confirm before I log the request:"}`,"","- Narrative clarity: tighten the opening 3 seconds.","- Visual hierarchy: spotlight the primary CTA earlier.","- Audio mix: reduce music by about 3dB under VO.","- Export: keep 1080x1920, 29.97fps.","","Reply with any edits or confirm if I should submit to the reviewer."].join(`
`)}function YB(t){return[{action_id:"approve_reviewer",label:"Approve",workflow_id:t,variant:"secondary"},{action_id:"reject_reviewer",label:"Reject",workflow_id:t,variant:"ghost"}]}function QB(t){let e=!1;return t&&(t.aborted?e=!0:t.addEventListener("abort",()=>{e=!0},{once:!0})),()=>e}function XB(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function JB(){const t=eT(fr),e=tT(fr),n=VB(fr),s=nT(fr),r=ZE(fr),i=iT(fr),o=Ci(fr),a=sT(fr),l=rT(fr);return{mode:"month",period:"2025-02",tasks:fr,summary:t,pie:e,reviewer:n,summary_videographers:s,videographers:r,quick_stats:i,status_counts:o,pending_reviews:a,response_times:l}}async function ZB({mode:t,period:e}={}){return await ar(240),{...JB(),mode:t||"month",period:e||"2025-02"}}async function e4(){return await ar(200),qB}async function t4({file:t,message:e,sessionId:n}){await ar(200);const s=n||`vc-session-${Date.now()}`,r=`vc-file-${Date.now()}`;return XB(t)?{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",type:"video",message:"Video received. Which task number is this for?",session_id:s}:{success:!0,file_id:r,filename:(t==null?void 0:t.name)||"upload",file_url:URL.createObjectURL(t),type:"image",response:y0(e,!0),session_id:s,timestamp:new Date().toISOString()}}async function n4({file:t}){return await ar(200),{file_id:`vc-asset-${Date.now()}`,filename:(t==null?void 0:t.name)||"attachment",file_url:URL.createObjectURL(t)}}async function s4({file:t,taskNumber:e}){return await ar(260),{success:!0,file_id:`vc-video-${Date.now()}`,workflow_id:`workflow-${Date.now()}`,version:1,message:`Video uploaded successfully (v1) for task #${e}`}}async function r4({command:t,args:e,sessionId:n}){await ar(200);const s=n||`vc-session-${Date.now()}`,r=(t||"").toLowerCase(),i=(e||"").trim();return r?r==="help"?{success:!0,command:r,response:`**Video Critique Commands**

- /log or /design - Start a new design request
- /recent - Export recent task data
- /edit <task_number> - Edit an existing task
- /delete <task_number> - Delete a task

You can also paste briefs or upload images/videos.`,session_id:s}:r==="log"||r==="design"?{success:!0,command:r,response:y0(i||"I want to log a design request",!1),session_id:s}:r==="edit"?{success:!0,command:r,response:i?"Editing task "+i+". Which fields should I update?":"Please provide a task number: /edit <task_number>",session_id:s}:r==="delete"?{success:!0,command:r,response:i?"Delete request queued for task "+i+". Confirm to proceed.":"Please provide a task number: /delete <task_number>",session_id:s}:r==="recent"?{success:!0,command:r,response:"Preparing the latest export. I will send the download link shortly.",session_id:s}:{success:!1,command:r,error:"Unknown command: /"+r+". Use /help for available commands.",session_id:s}:{success:!1,command:"",error:"Unknown command: /. Use /help for available commands.",session_id:s}}async function i4({actionId:t,workflowId:e}){return await ar(200),t==="reject_reviewer"||t==="return_hos"?{success:!0,message:"Please provide rejection details.",requires_form:!0,form_type:t==="return_hos"?"return":"rejection",workflow_id:e}:{success:!0,message:`Action ${t} applied for ${e}.`}}async function o4({formType:t,workflowId:e}){return await ar(200),{success:!0,message:`${t} submitted for ${e}.`}}async function a4(t){return await ar(120),t==="return"?{title:"Return for Revision",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be revised..."}]}:{title:"Reject Video",submit_text:"Submit",fields:[{id:"category",label:"Category",type:"select",required:!0,options:[{value:"technical",label:"Technical Issue"},{value:"content",label:"Content Issue"},{value:"quality",label:"Quality Issue"},{value:"missing",label:"Missing Elements"},{value:"other",label:"Other"}]},{id:"reason",label:"Details",type:"textarea",required:!0,placeholder:"Please describe what needs to be fixed..."}]}}function l4(t){return t!=null&&t.preview_url?t.preview_url:t!=null&&t.file_url?t.file_url:t!=null&&t.url?t.url:null}async function c4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){const a=QB(o);try{const l=t||`vc-session-${Date.now()}`;if(a()||(await ar(180),a()))return;const u=y0(e,!1),d=GB(u,48);for(const h of d){if(a())return;s==null||s({type:"delta",content:h}),await ar(90)}if(a())return;s==null||s({type:"text_done",content:u}),n!=null&&n.length&&(s==null||s({type:"files",files:n.map((h,f)=>({file_id:h,filename:f===0?"Brief.pdf":`Attachment-${f+1}.pdf`,file_url:`https://example.com/mock-${h}.pdf`}))})),(e||"").toLowerCase().includes("approval")&&(s==null||s({type:"actions",actions:YB(KB[0].workflow_id)})),s==null||s({type:"done",session_id:l}),r==null||r()}catch(l){throw s==null||s({type:"error",message:(l==null?void 0:l.message)||"Stream failed"}),i==null||i(l),l}}async function u4(t){return ZB(t)}async function d4(){return e4()}async function h4({file:t,message:e,sessionId:n}){return t4({file:t,message:e,sessionId:n})}async function f4({file:t}){return n4({file:t})}async function Hk({file:t,taskNumber:e}){return s4({file:t,taskNumber:e})}async function p4({command:t,args:e,sessionId:n}){return r4({command:t,args:e,sessionId:n})}async function m4({actionId:t,workflowId:e}){return i4({actionId:t,workflowId:e})}async function g4({formType:t,workflowId:e,category:n,reason:s}){return o4({formType:t,workflowId:e})}async function x4(t){return a4(t)}function y4(t){return l4(t)}async function v4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o}){return c4({sessionId:t,message:e,fileIds:n,onEvent:s,onDone:r,onError:i,signal:o})}function Ad(t,e,n){Array.isArray(n)&&n.filter(Boolean).forEach(s=>t.append(e,s))}async function b4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;Ad(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return Me(`/api/assets/networks${s?`?${s}`:""}`)}async function w4({companies:t,networkId:e,activeOnly:n=!0}={}){const s=new URLSearchParams;Ad(s,"companies",t),e!=null&&s.set("network_id",String(e)),n!==void 0&&s.set("active_only",String(n));const r=s.toString();return Me(`/api/assets/asset-types${r?`?${r}`:""}`)}async function k4({companies:t,networkId:e,typeId:n,activeOnly:s=!0}={}){const r=new URLSearchParams;Ad(r,"companies",t),e!=null&&r.set("network_id",String(e)),n!=null&&r.set("type_id",String(n)),s!==void 0&&r.set("active_only",String(s));const i=r.toString();return Me(`/api/assets/network-assets${i?`?${i}`:""}`)}async function _4({companies:t,networkId:e,typeId:n,activeOnly:s=!0,includeEligibility:r=!1}={}){const i=new URLSearchParams;Ad(i,"companies",t),e!=null&&i.set("network_id",String(e)),n!=null&&i.set("type_id",String(n)),s!==void 0&&i.set("active_only",String(s)),r!==void 0&&i.set("include_eligibility",String(r));const o=i.toString();return Me(`/api/assets/locations${o?`?${o}`:""}`)}async function S4({companies:t,activeOnly:e=!0}={}){const n=new URLSearchParams;Ad(n,"companies",t),e!==void 0&&n.set("active_only",String(e));const s=n.toString();return Me(`/api/assets/packages${s?`?${s}`:""}`)}const j4={chat:{to:"/app/chat",label:"AI Chat Assistant",icon:IM},video_critique:{to:"/app/video-critique",label:"Video Critique",icon:df},mockup:{to:"/app/mockup",label:"Mockup Assistant",icon:OM},proposals:{to:"/app/proposals",label:"Proposal Assistant",icon:$M},admin:{to:"/app/admin",label:"Admin",icon:zM},asset_management:{to:"/app/asset-management",label:"Asset Management",icon:LM},settings:{to:"/app/settings",label:"Settings",icon:VC}},C4=["chat","mockup","proposals","video_critique","admin","asset_management","settings"];function N4(t){return t.includes("/app/video-critique")?"Video Critique":t.includes("/app/chat")?"AI Chat Assistant":t.includes("/app/mockup")?"Mockup Assistant":t.includes("/app/proposals")?"Proposal Assistant":t.includes("/app/notifications")?"Notifications":t.includes("/app/admin")?"Admin Panel":t.includes("/app/asset-management")?"Asset Management":t.includes("/app/settings")?"Settings":"Workspace"}function E4(t){const e=[{name:"sales",tools:["chat","video_critique","mockup","proposals"],sort_order:1}];return _d(t)&&e.push({name:"core",tools:["admin"],sort_order:100}),e}function T4(t,e){var a;const s=[...((a=t==null?void 0:t.modules)!=null&&a.length?t.modules:E4(e))||[]].sort((l,u)=>(l.sort_order||0)-(u.sort_order||0)),r=new Set;s.forEach(l=>{(l.tools||[]).forEach(u=>{r.add(u==="ai_costs"?"costs":u)})}),r.has("chat")&&r.add("video_critique"),_d(e)&&(r.add("admin"),r.add("asset_management")),r.add("settings");const i=[],o=new Set;return C4.forEach(l=>{if(!r.has(l))return;const u=j4[l];u&&!o.has(u.to)&&(o.add(u.to),i.push(u))}),i}function P4(){const{user:t,logout:e}=oi(),n=rc(),s=bd(),[r,i]=v.useState(!1),[o,a]=v.useState(!1),l=en({queryKey:["modules","accessible"],queryFn:Q3}),u=v.useMemo(()=>((t==null?void 0:t.name)||"User").split(" ").slice(0,2).map(f=>f[0]).join("").toUpperCase(),[t]),d=v.useMemo(()=>T4(l.data,t),[l.data,t]);return c.jsxs("div",{className:"h-screen flex flex-col overflow-hidden",children:[c.jsx("header",{className:"sticky top-0 z-40",children:c.jsx("div",{className:"w-full px-6 lg:px-10",children:c.jsx("div",{className:"mmg-header-card mt-4 rounded-2xl bg-white/65 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10",children:c.jsxs("div",{className:"flex items-center justify-between px-4 py-2 gap-3",children:[c.jsxs("div",{className:"flex items-end gap-3",children:[c.jsx(eN,{size:64}),c.jsx("div",{className:"hidden sm:block text-sm leading-none text-black/50 dark:text-white/60 relative -top-px",children:"|"}),c.jsx("div",{className:"hidden sm:block text-sm font-medium leading-none text-black/70 dark:text-white/70",children:N4(n.pathname)})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl lg:hidden",onClick:()=>a(!0),title:"Open sidebar","aria-label":"Open sidebar",children:c.jsx(Wm,{size:18})}),c.jsx(G3,{}),c.jsx(_N,{}),c.jsxs(Qp,{children:[c.jsx(Xp,{asChild:!0,children:c.jsxs("button",{className:"flex items-center gap-2 rounded-2xl px-2.5 py-1.5 hover:bg-black/5 dark:hover:bg-white/10 transition-colors","aria-label":"User menu",children:[c.jsx("div",{className:"h-9 w-9 rounded-2xl bg-black/5 dark:bg-white/10 flex items-center justify-center shadow-soft",children:c.jsx("span",{className:"text-xs font-semibold",children:u})}),c.jsxs("div",{className:"hidden sm:flex flex-col items-start leading-tight",children:[c.jsx("span",{className:"mmg-brand-gold text-sm font-medium",children:t==null?void 0:t.name}),c.jsx("span",{className:"text-xs text-black/50 dark:text-white/60",children:t==null?void 0:t.email})]})]})}),c.jsxs(Pd,{align:"end",children:[c.jsx(YE,{children:c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("span",{className:"truncate",children:t==null?void 0:t.email}),c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:((t==null?void 0:t.roles)||[]).join(" | ")})]})}),c.jsx(ap,{}),c.jsxs(Vu,{onSelect:()=>s("/app/settings"),children:[c.jsx(VC,{size:16}),"Settings"]}),c.jsxs(Vu,{onSelect:()=>{e(),s("/")},children:[c.jsx(MM,{size:16}),"Logout"]})]})]})]})]})})})}),c.jsx(Y3,{}),c.jsx("div",{className:"w-full px-6 lg:px-10 pb-4 flex-1 flex overflow-hidden min-w-0",children:c.jsxs("div",{className:Te("mt-4 grid grid-cols-1 gap-4 lg:grid-cols-[280px_1fr] flex-1 min-h-0 min-w-0","transition-[grid-template-columns] duration-500",r&&"lg:grid-cols-[64px_1fr] 2xl:grid-cols-[72px_1fr]"),children:[c.jsxs("aside",{className:Te("hidden lg:block rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10","overflow-hidden"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:Te("text-s ms-3 font-semibold tracking-wide text-black/50 dark:text-white/60",r&&"hidden lg:block lg:sr-only"),children:"Tools"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>i(h=>!h),title:"Toggle sidebar","aria-label":"Toggle sidebar",children:c.jsx(Wm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-2",children:d.map(h=>{const f=n.pathname===h.to||n.pathname.startsWith(`${h.to}/`),p=h.icon;return c.jsxs("button",{onClick:()=>s(h.to),className:Te("mmg-nav-btn w-full flex items-center gap-3 rounded-2xl p-2 text-sm transition-colors mb-1.5 shadow-soft",f?"mmg-nav-btn-active":"","text-base",r&&"lg:justify-center lg:gap-0"),children:[c.jsx("span",{className:"mmg-nav-icon h-8 w-8 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(p,{size:22})}),c.jsx("span",{className:Te("min-w-0 truncate",r&&"hidden"),children:h.label})]},h.to)})}),c.jsx("div",{className:"px-3 pb-3 pt-1",children:c.jsx("div",{className:Te("h-px bg-black/5 dark:bg-white/10",r&&"lg:mx-auto lg:w-10")})})]}),c.jsx("main",{className:"min-h-0 min-w-0 h-full",children:c.jsx(MO,{})})]})}),c.jsxs("div",{className:Te("fixed inset-0 z-50 lg:hidden",o?"pointer-events-auto":"pointer-events-none"),children:[c.jsx("div",{className:Te("absolute inset-0 bg-black/40 transition-opacity",o?"opacity-100":"opacity-0"),onClick:()=>a(!1)}),c.jsxs("aside",{className:Te("absolute inset-y-0 left-0 w-72 max-w-full rounded-r-2xl bg-white/90 dark:bg-neutral-900/95","backdrop-blur-xl shadow-2xl ring-1 ring-black/10 dark:ring-white/10","transition-transform duration-200",o?"translate-x-0":"-translate-x-full"),children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[c.jsx("div",{className:"text-sm font-semibold tracking-wide text-black/60 dark:text-white/70",children:"Tools"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",onClick:()=>a(!1),title:"Close sidebar","aria-label":"Close sidebar",children:c.jsx(Wm,{size:18})})]}),c.jsx("nav",{className:"px-2 pb-3",children:d.map(h=>{const f=n.pathname===h.to||n.pathname.startsWith(`${h.to}/`),p=h.icon;return c.jsxs("button",{onClick:()=>{s(h.to),a(!1)},className:Te("mmg-nav-btn w-full flex items-center gap-2.5 rounded-2xl p-2.5 text-sm transition-colors mb-1.5 shadow-soft",f?"mmg-nav-btn-active":"","text-sm"),children:[c.jsx("span",{className:"mmg-nav-icon h-9 w-9 shrink-0 rounded-2xl bg-black/4 dark:bg-white/8 flex items-center justify-center shadow-soft",children:c.jsx(p,{size:20})}),c.jsx("span",{className:"min-w-0 truncate",children:h.label})]},h.to)})})]})]})]})}const Zp=0,go=1,dc=2,oT=4;function Wk(t){return()=>t}function R4(t){t()}function aT(t,e){return n=>t(e(n))}function Vk(t,e){return()=>t(e)}function A4(t,e){return n=>t(e,n)}function v0(t){return t!==void 0}function O4(...t){return()=>{t.map(R4)}}function hc(){}function em(t,e){return e(t),t}function M4(t,e){return e(t)}function Rt(...t){return t}function ut(t,e){return t(go,e)}function Ge(t,e){t(Zp,e)}function b0(t){t(dc)}function Mt(t){return t(oT)}function Pe(t,e){return ut(t,A4(e,Zp))}function sr(t,e){const n=t(go,s=>{n(),e(s)});return n}function qk(t){let e,n;return s=>r=>{e=r,n&&clearTimeout(n),n=setTimeout(()=>{s(e)},t)}}function lT(t,e){return t===e}function Tt(t=lT){let e;return n=>s=>{t(e,s)||(e=s,n(s))}}function He(t){return e=>n=>{t(n)&&e(n)}}function ve(t){return e=>aT(e,t)}function _r(t){return e=>()=>{e(t)}}function ne(t,...e){const n=I4(...e);return(s,r)=>{switch(s){case dc:b0(t);return;case go:return ut(t,n(r))}}}function Er(t,e){return n=>s=>{n(e=t(e,s))}}function ga(t){return e=>n=>{t>0?t--:e(n)}}function Jr(t){let e=null,n;return s=>r=>{e=r,!n&&(n=setTimeout(()=>{n=void 0,s(e)},t))}}function Qe(...t){const e=new Array(t.length);let n=0,s=null;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);ut(i,l=>{const u=n;n=n|a,e[o]=l,u!==r&&n===r&&s&&(s(),s=null)})}),i=>o=>{const a=()=>{i([o].concat(e))};n===r?a():s=a}}function I4(...t){return e=>t.reduceRight(M4,e)}function D4(t){let e,n;const s=()=>e==null?void 0:e();return function(r,i){switch(r){case go:return i?n===i?void 0:(s(),n=i,e=ut(t,i),e):(s(),hc);case dc:s(),n=null;return}}}function ce(t){let e=t;const n=et();return(s,r)=>{switch(s){case Zp:e=r;break;case go:{r(e);break}case oT:return e}return n(s,r)}}function Nn(t,e){return em(ce(e),n=>Pe(t,n))}function et(){const t=[];return(e,n)=>{switch(e){case Zp:t.slice().forEach(s=>{s(n)});return;case dc:t.splice(0,t.length);return;case go:return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}}}function ks(t){return em(et(),e=>Pe(t,e))}function lt(t,e=[],{singleton:n}={singleton:!0}){return{constructor:t,dependencies:e,id:L4(),singleton:n}}const L4=()=>Symbol();function $4(t){const e=new Map,n=({constructor:s,dependencies:r,id:i,singleton:o})=>{if(o&&e.has(i))return e.get(i);const a=s(r.map(l=>n(l)));return o&&e.set(i,a),a};return n(t)}function tn(...t){const e=et(),n=new Array(t.length);let s=0;const r=Math.pow(2,t.length)-1;return t.forEach((i,o)=>{const a=Math.pow(2,o);ut(i,l=>{n[o]=l,s=s|a,s===r&&Ge(e,n)})}),function(i,o){switch(i){case dc:{b0(e);return}case go:return s===r&&o(n),ut(e,o)}}}function Ue(t,e=lT){return ne(t,Tt(e))}function wy(...t){return function(e,n){switch(e){case dc:return;case go:return O4(...t.map(s=>ut(s,n)))}}}var is=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARN=2]="WARN",t[t.ERROR=3]="ERROR",t))(is||{});const F4={0:"debug",3:"error",1:"log",2:"warn"},z4=()=>typeof globalThis>"u"?window:globalThis,xo=lt(()=>{const t=ce(3);return{log:ce((e,n,s=1)=>{var r;const i=(r=z4().VIRTUOSO_LOG_LEVEL)!=null?r:Mt(t);s>=i&&console[F4[s]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",e,n)}),logLevel:t}},[],{singleton:!0});function ja(t,e,n){return w0(t,e,n).callbackRef}function w0(t,e,n){const s=ge.useRef(null);let r=o=>{};const i=ge.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(o=>{const a=()=>{const l=o[0].target;l.offsetParent!==null&&t(l)};n?a():requestAnimationFrame(a)}):null,[t,n]);return r=o=>{o&&e?(i==null||i.observe(o),s.current=o):(s.current&&(i==null||i.unobserve(s.current)),s.current=null)},{callbackRef:r,ref:s}}function B4(t,e,n,s,r,i,o,a,l){const u=ge.useCallback(d=>{const h=U4(d.children,e,a?"offsetWidth":"offsetHeight",r);let f=d.parentElement;for(;!f.dataset.virtuosoScroller;)f=f.parentElement;const p=f.lastElementChild.dataset.viewportType==="window";let w;p&&(w=f.ownerDocument.defaultView);const x=o?a?o.scrollLeft:o.scrollTop:p?a?w.scrollX||w.document.documentElement.scrollLeft:w.scrollY||w.document.documentElement.scrollTop:a?f.scrollLeft:f.scrollTop,y=o?a?o.scrollWidth:o.scrollHeight:p?a?w.document.documentElement.scrollWidth:w.document.documentElement.scrollHeight:a?f.scrollWidth:f.scrollHeight,g=o?a?o.offsetWidth:o.offsetHeight:p?a?w.innerWidth:w.innerHeight:a?f.offsetWidth:f.offsetHeight;s({scrollHeight:y,scrollTop:Math.max(x,0),viewportHeight:g}),i==null||i(a?Kk("column-gap",getComputedStyle(d).columnGap,r):Kk("row-gap",getComputedStyle(d).rowGap,r)),h!==null&&t(h)},[t,e,r,i,o,s,a]);return w0(u,n,l)}function U4(t,e,n,s){const r=t.length;if(r===0)return null;const i=[];for(let o=0;o<r;o++){const a=t.item(o);if(a.dataset.index===void 0)continue;const l=parseInt(a.dataset.index),u=parseFloat(a.dataset.knownSize),d=e(a,n);if(d===0&&s("Zero-sized element, this should not happen",{child:a},is.ERROR),d===u)continue;const h=i[i.length-1];i.length===0||h.size!==d||h.endIndex!==l-1?i.push({endIndex:l,size:d,startIndex:l}):i[i.length-1].endIndex++}return i}function Kk(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,is.WARN),e==="normal"?0:parseInt(e??"0",10)}function cT(t,e,n){const s=ge.useRef(null),r=ge.useCallback(l=>{if(!(l!=null&&l.offsetParent))return;const u=l.getBoundingClientRect(),d=u.width;let h,f;if(e){const p=e.getBoundingClientRect(),w=u.top-p.top;f=p.height-Math.max(0,w),h=w+e.scrollTop}else{const p=o.current.ownerDocument.defaultView;f=p.innerHeight-Math.max(0,u.top),h=u.top+p.scrollY}s.current={offsetTop:h,visibleHeight:f,visibleWidth:d},t(s.current)},[t,e]),{callbackRef:i,ref:o}=w0(r,!0,n),a=ge.useCallback(()=>{r(o.current)},[r,o]);return ge.useEffect(()=>{var l;if(e){e.addEventListener("scroll",a);const u=new ResizeObserver(()=>{requestAnimationFrame(a)});return u.observe(e),()=>{e.removeEventListener("scroll",a),u.unobserve(e)}}else{const u=(l=o.current)==null?void 0:l.ownerDocument.defaultView;return u==null||u.addEventListener("scroll",a),u==null||u.addEventListener("resize",a),()=>{u==null||u.removeEventListener("scroll",a),u==null||u.removeEventListener("resize",a)}}},[a,e,o]),i}const Hn=lt(()=>{const t=et(),e=et(),n=ce(0),s=et(),r=ce(0),i=et(),o=et(),a=ce(0),l=ce(0),u=ce(0),d=ce(0),h=et(),f=et(),p=ce(!1),w=ce(!1),x=ce(!1);return Pe(ne(t,ve(({scrollTop:y})=>y)),e),Pe(ne(t,ve(({scrollHeight:y})=>y)),o),Pe(e,r),{deviation:n,fixedFooterHeight:u,fixedHeaderHeight:l,footerHeight:d,headerHeight:a,horizontalDirection:w,scrollBy:f,scrollContainerState:t,scrollHeight:o,scrollingInProgress:p,scrollTo:h,scrollTop:e,skipAnimationFrameInResizeObserver:x,smoothScrollTargetReached:s,statefulScrollTop:r,viewportHeight:i}},[],{singleton:!0}),Ku={lvl:0};function uT(t,e){const n=t.length;if(n===0)return[];let{index:s,value:r}=e(t[0]);const i=[];for(let o=1;o<n;o++){const{index:a,value:l}=e(t[o]);i.push({end:a-1,start:s,value:r}),s=a,r=l}return i.push({end:1/0,start:s,value:r}),i}function vt(t){return t===Ku}function Gu(t,e){if(!vt(t))return e===t.k?t.v:e<t.k?Gu(t.l,e):Gu(t.r,e)}function lr(t,e,n="k"){if(vt(t))return[-1/0,void 0];if(Number(t[n])===e)return[t.k,t.v];if(Number(t[n])<e){const s=lr(t.r,e,n);return s[0]===-1/0?[t.k,t.v]:s}return lr(t.l,e,n)}function xs(t,e,n){return vt(t)?fT(e,n,1):e===t.k?an(t,{k:e,v:n}):e<t.k?Gk(an(t,{l:xs(t.l,e,n)})):Gk(an(t,{r:xs(t.r,e,n)}))}function jl(){return Ku}function Cl(t,e,n){if(vt(t))return[];const s=lr(t,e)[0];return H4(_y(t,s,n))}function ky(t,e){if(vt(t))return Ku;const{k:n,l:s,r}=t;if(e===n){if(vt(s))return r;if(vt(r))return s;{const[i,o]=hT(s);return xf(an(t,{k:i,l:dT(s),v:o}))}}else return e<n?xf(an(t,{l:ky(s,e)})):xf(an(t,{r:ky(r,e)}))}function Wo(t){return vt(t)?[]:[...Wo(t.l),{k:t.k,v:t.v},...Wo(t.r)]}function _y(t,e,n){if(vt(t))return[];const{k:s,l:r,r:i,v:o}=t;let a=[];return s>e&&(a=a.concat(_y(r,e,n))),s>=e&&s<=n&&a.push({k:s,v:o}),s<=n&&(a=a.concat(_y(i,e,n))),a}function xf(t){const{l:e,lvl:n,r:s}=t;if(s.lvl>=n-1&&e.lvl>=n-1)return t;if(n>s.lvl+1){if(xg(e))return pT(an(t,{lvl:n-1}));if(!vt(e)&&!vt(e.r))return an(e.r,{l:an(e,{r:e.r.l}),lvl:n,r:an(t,{l:e.r.r,lvl:n-1})});throw new Error("Unexpected empty nodes")}else{if(xg(t))return Sy(an(t,{lvl:n-1}));if(!vt(s)&&!vt(s.l)){const r=s.l,i=xg(r)?s.lvl-1:s.lvl;return an(r,{l:an(t,{lvl:n-1,r:r.l}),lvl:r.lvl+1,r:Sy(an(s,{l:r.r,lvl:i}))})}else throw new Error("Unexpected empty nodes")}}function an(t,e){return fT(e.k!==void 0?e.k:t.k,e.v!==void 0?e.v:t.v,e.lvl!==void 0?e.lvl:t.lvl,e.l!==void 0?e.l:t.l,e.r!==void 0?e.r:t.r)}function dT(t){return vt(t.r)?t.l:xf(an(t,{r:dT(t.r)}))}function xg(t){return vt(t)||t.lvl>t.r.lvl}function hT(t){return vt(t.r)?[t.k,t.v]:hT(t.r)}function fT(t,e,n,s=Ku,r=Ku){return{k:t,l:s,lvl:n,r,v:e}}function Gk(t){return Sy(pT(t))}function pT(t){const{l:e}=t;return!vt(e)&&e.lvl===t.lvl?an(e,{r:an(t,{l:e.r})}):t}function Sy(t){const{lvl:e,r:n}=t;return!vt(n)&&!vt(n.r)&&n.lvl===e&&n.r.lvl===e?an(n,{l:an(t,{r:n.l}),lvl:e+1}):t}function H4(t){return uT(t,({k:e,v:n})=>({index:e,value:n}))}function mT(t,e){return!!(t&&t.startIndex===e.startIndex&&t.endIndex===e.endIndex)}function Yu(t,e){return!!(t&&t[0]===e[0]&&t[1]===e[1])}const k0=lt(()=>({recalcInProgress:ce(!1)}),[],{singleton:!0});function gT(t,e,n){return t[lp(t,e,n)]}function lp(t,e,n,s=0){let r=t.length-1;for(;s<=r;){const i=Math.floor((s+r)/2),o=t[i],a=n(o,e);if(a===0)return i;if(a===-1){if(r-s<2)return i-1;r=i-1}else{if(r===s)return i;s=i+1}}throw new Error(`Failed binary finding record in array - ${t.join(",")}, searched for ${e}`)}function W4(t,e,n,s){const r=lp(t,e,s),i=lp(t,n,s,r);return t.slice(r,i+1)}function co(t,e){return Math.round(t.getBoundingClientRect()[e])}function tm(t){return!vt(t.groupOffsetTree)}function _0({index:t},e){return e===t?0:e<t?-1:1}function V4(){return{groupIndices:[],groupOffsetTree:jl(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:jl()}}function q4(t,e){let n=vt(t)?0:1/0;for(const s of e){const{endIndex:r,size:i,startIndex:o}=s;if(n=Math.min(n,o),vt(t)){t=xs(t,0,i);continue}const a=Cl(t,o-1,r+1);if(a.some(Z4(s)))continue;let l=!1,u=!1;for(const{end:d,start:h,value:f}of a)l?(r>=h||i===f)&&(t=ky(t,h)):(u=f!==i,l=!0),d>r&&r>=h&&f!==i&&(t=xs(t,r+1,f));u&&(t=xs(t,o,i))}return[t,n]}function K4(t){return typeof t.groupIndex<"u"}function G4({offset:t},e){return e===t?0:e<t?-1:1}function Qu(t,e,n){if(e.length===0)return 0;const{index:s,offset:r,size:i}=gT(e,t,_0),o=t-s,a=i*o+(o-1)*n+r;return a>0?a+n:a}function xT(t,e){if(!tm(e))return t;let n=0;for(;e.groupIndices[n]<=t+n;)n++;return t+n}function yT(t,e,n){if(K4(t))return e.groupIndices[t.groupIndex]+1;{const s=t.index==="LAST"?n:t.index;let r=xT(s,e);return r=Math.max(0,r,Math.min(n,r)),r}}function Y4(t,e,n,s=0){return s>0&&(e=Math.max(e,gT(t,s,_0).offset)),uT(W4(t,e,n,G4),J4)}function Q4(t,[e,n,s,r]){e.length>0&&s("received item sizes",e,is.DEBUG);const i=t.sizeTree;let o=i,a=0;if(n.length>0&&vt(i)&&e.length===2){const f=e[0].size,p=e[1].size;o=n.reduce((w,x)=>xs(xs(w,x,f),x+1,p),o)}else[o,a]=q4(o,e);if(o===i)return t;const{lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h}=jy(t.offsetTree,a,o,r);return{groupIndices:n,groupOffsetTree:n.reduce((f,p)=>xs(f,p,Qu(p,h,r)),jl()),lastIndex:l,lastOffset:u,lastSize:d,offsetTree:h,sizeTree:o}}function X4(t){return Wo(t).map(({k:e,v:n},s,r)=>{const i=r[s+1];return{endIndex:i?i.k-1:1/0,size:n,startIndex:e}})}function Yk(t,e){let n=0,s=0;for(;n<t;)n+=e[s+1]-e[s]-1,s++;return s-(n===t?0:1)}function jy(t,e,n,s){let r=t,i=0,o=0,a=0,l=0;if(e!==0){l=lp(r,e-1,_0),a=r[l].offset;const u=lr(n,e-1);i=u[0],o=u[1],r.length&&r[l].size===lr(n,e)[1]&&(l-=1),r=r.slice(0,l+1)}else r=[];for(const{start:u,value:d}of Cl(n,e,1/0)){const h=u-i,f=h*o+a+h*s;r.push({index:u,offset:f,size:d}),i=u,a=f,o=d}return{lastIndex:i,lastOffset:a,lastSize:o,offsetTree:r}}function J4(t){return{index:t.index,value:t}}function Z4(t){const{endIndex:e,size:n,startIndex:s}=t;return r=>r.start===s&&(r.end===e||r.end===1/0)&&r.value===n}const e6={offsetHeight:"height",offsetWidth:"width"},Ir=lt(([{log:t},{recalcInProgress:e}])=>{const n=et(),s=et(),r=Nn(s,0),i=et(),o=et(),a=ce(0),l=ce([]),u=ce(void 0),d=ce(void 0),h=ce(void 0),f=ce(void 0),p=ce((S,j)=>co(S,e6[j])),w=ce(void 0),x=ce(0),y=V4(),g=Nn(ne(n,Qe(l,t,x),Er(Q4,y),Tt()),y),m=Nn(ne(l,Tt(),Er((S,j)=>({current:j,prev:S.current}),{current:[],prev:[]}),ve(({prev:S})=>S)),[]);Pe(ne(l,He(S=>S.length>0),Qe(g,x),ve(([S,j,T])=>{const P=S.reduce((L,D,O)=>xs(L,D,Qu(D,j.offsetTree,T)||O),jl());return{...j,groupIndices:S,groupOffsetTree:P}})),g),Pe(ne(s,Qe(g),He(([S,{lastIndex:j}])=>S<j),ve(([S,{lastIndex:j,lastSize:T}])=>[{endIndex:j,size:T,startIndex:S}])),n),Pe(u,d);const b=Nn(ne(u,ve(S=>S===void 0)),!0);Pe(ne(d,He(S=>S!==void 0&&vt(Mt(g).sizeTree)),ve(S=>{const j=Mt(h),T=Mt(l).length>0;return j?T?[{endIndex:0,size:j,startIndex:0},{endIndex:1,size:S,startIndex:1}]:[]:[{endIndex:0,size:S,startIndex:0}]})),n),Pe(ne(f,He(S=>S!==void 0&&S.length>0&&vt(Mt(g).sizeTree)),ve(S=>{const j=[];let T=S[0],P=0;for(let L=1;L<S.length;L++){const D=S[L];D!==T&&(j.push({endIndex:L-1,size:T,startIndex:P}),T=D,P=L)}return j.push({endIndex:S.length-1,size:T,startIndex:P}),j})),n),Pe(ne(l,Qe(h,d),He(([,S,j])=>S!==void 0&&j!==void 0),ve(([S,j,T])=>{const P=[];for(let L=0;L<S.length;L++){const D=S[L],O=S[L+1];P.push({startIndex:D,endIndex:D,size:j}),O!==void 0&&P.push({startIndex:D+1,endIndex:O-1,size:T})}return P})),n);const k=ks(ne(n,Qe(g),Er(({sizes:S},[j,T])=>({changed:T!==S,sizes:T}),{changed:!1,sizes:y}),ve(S=>S.changed)));ut(ne(a,Er((S,j)=>({diff:S.prev-j,prev:j}),{diff:0,prev:0}),ve(S=>S.diff)),S=>{const{groupIndices:j}=Mt(g);if(S>0)Ge(e,!0),Ge(i,S+Yk(S,j));else if(S<0){const T=Mt(m);T.length>0&&(S-=Yk(-S,T)),Ge(o,S)}}),ut(ne(a,Qe(t)),([S,j])=>{S<0&&j("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},is.ERROR)});const _=ks(i);Pe(ne(i,Qe(g),ve(([S,j])=>{const T=j.groupIndices.length>0,P=[],L=j.lastSize;if(T){const D=Gu(j.sizeTree,0);let O=0,$=0;for(;O<S;){const A=j.groupIndices[$],W=j.groupIndices.length===$+1?1/0:j.groupIndices[$+1]-A-1;P.push({endIndex:A,size:D,startIndex:A}),P.push({endIndex:A+1+W-1,size:L,startIndex:A+1}),$++,O+=W+1}const I=Wo(j.sizeTree);return O!==S&&I.shift(),I.reduce((A,{k:W,v:N})=>{let E=A.ranges;return A.prevSize!==0&&(E=[...A.ranges,{endIndex:W+S-1,size:A.prevSize,startIndex:A.prevIndex}]),{prevIndex:W+S,prevSize:N,ranges:E}},{prevIndex:S,prevSize:0,ranges:P}).ranges}return Wo(j.sizeTree).reduce((D,{k:O,v:$})=>({prevIndex:O+S,prevSize:$,ranges:[...D.ranges,{endIndex:O+S-1,size:D.prevSize,startIndex:D.prevIndex}]}),{prevIndex:0,prevSize:L,ranges:[]}).ranges})),n);const C=ks(ne(o,Qe(g,x),ve(([S,{offsetTree:j},T])=>{const P=-S;return Qu(P,j,T)})));return Pe(ne(o,Qe(g,x),ve(([S,j,T])=>{if(j.groupIndices.length>0){if(vt(j.sizeTree))return j;let P=jl();const L=Mt(m);let D=0,O=0,$=0;for(;D<-S;){$=L[O];const I=L[O+1]-$-1;O++,D+=I+1}if(P=Wo(j.sizeTree).reduce((I,{k:A,v:W})=>xs(I,Math.max(0,A+S),W),P),D!==-S){const I=Gu(j.sizeTree,$);P=xs(P,0,I);const A=lr(j.sizeTree,-S+1)[1];P=xs(P,1,A)}return{...j,sizeTree:P,...jy(j.offsetTree,0,P,T)}}else{const P=Wo(j.sizeTree).reduce((L,{k:D,v:O})=>xs(L,Math.max(0,D+S),O),jl());return{...j,sizeTree:P,...jy(j.offsetTree,0,P,T)}}})),g),{beforeUnshiftWith:_,data:w,defaultItemSize:d,firstItemIndex:a,fixedItemSize:u,fixedGroupSize:h,gap:x,groupIndices:l,heightEstimates:f,itemSize:p,listRefresh:k,shiftWith:o,shiftWithOffset:C,sizeRanges:n,sizes:g,statefulTotalCount:r,totalCount:s,trackItemSizes:b,unshiftWith:i}},Rt(xo,k0),{singleton:!0});function t6(t){return t.reduce((e,n)=>(e.groupIndices.push(e.totalCount),e.totalCount+=n+1,e),{groupIndices:[],totalCount:0})}const vT=lt(([{groupIndices:t,sizes:e,totalCount:n},{headerHeight:s,scrollTop:r}])=>{const i=et(),o=et(),a=ks(ne(i,ve(t6)));return Pe(ne(a,ve(l=>l.totalCount)),n),Pe(ne(a,ve(l=>l.groupIndices)),t),Pe(ne(tn(r,e,s),He(([l,u])=>tm(u)),ve(([l,u,d])=>lr(u.groupOffsetTree,Math.max(l-d,0),"v")[0]),Tt(),ve(l=>[l])),o),{groupCounts:i,topItemsIndexes:o}},Rt(Ir,Hn)),yo=lt(([{log:t}])=>{const e=ce(!1),n=ks(ne(e,He(s=>s),Tt()));return ut(e,s=>{s&&Mt(t)("props updated",{},is.DEBUG)}),{didMount:n,propsReady:e}},Rt(xo),{singleton:!0}),n6=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function bT(t){const e=typeof t=="number"?{index:t}:t;return e.align||(e.align="start"),(!e.behavior||!n6)&&(e.behavior="auto"),e.offset||(e.offset=0),e}const Od=lt(([{gap:t,listRefresh:e,sizes:n,totalCount:s},{fixedFooterHeight:r,fixedHeaderHeight:i,footerHeight:o,headerHeight:a,scrollingInProgress:l,scrollTo:u,smoothScrollTargetReached:d,viewportHeight:h},{log:f}])=>{const p=et(),w=et(),x=ce(0);let y=null,g=null,m=null;function b(){y&&(y(),y=null),m&&(m(),m=null),g&&(clearTimeout(g),g=null),Ge(l,!1)}return Pe(ne(p,Qe(n,h,s,x,a,o,f),Qe(t,i,r),ve(([[k,_,C,S,j,T,P,L],D,O,$])=>{const I=bT(k),{align:A,behavior:W,offset:N}=I,E=S-1,F=yT(I,_,E);let V=Qu(F,_.offsetTree,D)+T;A==="end"?(V+=O+lr(_.sizeTree,F)[1]-C+$,F===E&&(V+=P)):A==="center"?V+=(O+lr(_.sizeTree,F)[1]-C+$)/2:V-=j,N&&(V+=N);const H=he=>{b(),he?(L("retrying to scroll to",{location:k},is.DEBUG),Ge(p,k)):(Ge(w,!0),L("list did not change, scroll successful",{},is.DEBUG))};if(b(),W==="smooth"){let he=!1;m=ut(e,ee=>{he=he||ee}),y=sr(d,()=>{H(he)})}else y=sr(ne(e,s6(150)),H);return g=setTimeout(()=>{b()},1200),Ge(l,!0),L("scrolling from index to",{behavior:W,index:F,top:V},is.DEBUG),{behavior:W,top:V}})),u),{scrollTargetReached:w,scrollToIndex:p,topListHeight:x}},Rt(Ir,Hn,xo),{singleton:!0});function s6(t){return e=>{const n=setTimeout(()=>{e(!1)},t);return s=>{s&&(e(!0),clearTimeout(n))}}}function S0(t,e){t==0?e():requestAnimationFrame(()=>{S0(t-1,e)})}function j0(t,e){const n=e-1;return typeof t=="number"?t:t.index==="LAST"?n:t.index}const Md=lt(([{defaultItemSize:t,listRefresh:e,sizes:n},{scrollTop:s},{scrollTargetReached:r,scrollToIndex:i},{didMount:o}])=>{const a=ce(!0),l=ce(0),u=ce(!0);return Pe(ne(o,Qe(l),He(([d,h])=>!!h),_r(!1)),a),Pe(ne(o,Qe(l),He(([d,h])=>!!h),_r(!1)),u),ut(ne(tn(e,o),Qe(a,n,t,u),He(([[,d],h,{sizeTree:f},p,w])=>d&&(!vt(f)||v0(p))&&!h&&!w),Qe(l)),([,d])=>{sr(r,()=>{Ge(u,!0)}),S0(4,()=>{sr(s,()=>{Ge(a,!0)}),Ge(i,d)})}),{initialItemFinalLocationReached:u,initialTopMostItemIndex:l,scrolledToInitialItem:a}},Rt(Ir,Hn,Od,yo),{singleton:!0});function wT(t,e){return Math.abs(t-e)<1.01}const Xu="up",cu="down",r6="none",i6={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},o6=0,Id=lt(([{footerHeight:t,headerHeight:e,scrollBy:n,scrollContainerState:s,scrollTop:r,viewportHeight:i}])=>{const o=ce(!1),a=ce(!0),l=et(),u=et(),d=ce(4),h=ce(o6),f=Nn(ne(wy(ne(Ue(r),ga(1),_r(!0)),ne(Ue(r),ga(1),_r(!1),qk(100))),Tt()),!1),p=Nn(ne(wy(ne(n,_r(!0)),ne(n,_r(!1),qk(200))),Tt()),!1);Pe(ne(tn(Ue(r),Ue(h)),ve(([m,b])=>m<=b),Tt()),a),Pe(ne(a,Jr(50)),u);const w=ks(ne(tn(s,Ue(i),Ue(e),Ue(t),Ue(d)),Er((m,[{scrollHeight:b,scrollTop:k},_,C,S,j])=>{const T=k+_-b>-j,P={scrollHeight:b,scrollTop:k,viewportHeight:_};if(T){let D,O;return k>m.state.scrollTop?(D="SCROLLED_DOWN",O=m.state.scrollTop-k):(D="SIZE_DECREASED",O=m.state.scrollTop-k||m.scrollTopDelta),{atBottom:!0,atBottomBecause:D,scrollTopDelta:O,state:P}}let L;return P.scrollHeight>m.state.scrollHeight?L="SIZE_INCREASED":_<m.state.viewportHeight?L="VIEWPORT_HEIGHT_DECREASING":k<m.state.scrollTop?L="SCROLLING_UPWARDS":L="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:L,state:P}},i6),Tt((m,b)=>m&&m.atBottom===b.atBottom))),x=Nn(ne(s,Er((m,{scrollHeight:b,scrollTop:k,viewportHeight:_})=>{if(wT(m.scrollHeight,b))return{changed:!1,jump:0,scrollHeight:b,scrollTop:k};{const C=b-(k+_)<1;return m.scrollTop!==k&&C?{changed:!0,jump:m.scrollTop-k,scrollHeight:b,scrollTop:k}:{changed:!0,jump:0,scrollHeight:b,scrollTop:k}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),He(m=>m.changed),ve(m=>m.jump)),0);Pe(ne(w,ve(m=>m.atBottom)),o),Pe(ne(o,Jr(50)),l);const y=ce(cu);Pe(ne(s,ve(({scrollTop:m})=>m),Tt(),Er((m,b)=>Mt(p)?{direction:m.direction,prevScrollTop:b}:{direction:b<m.prevScrollTop?Xu:cu,prevScrollTop:b},{direction:cu,prevScrollTop:0}),ve(m=>m.direction)),y),Pe(ne(s,Jr(50),_r(r6)),y);const g=ce(0);return Pe(ne(f,He(m=>!m),_r(0)),g),Pe(ne(r,Jr(100),Qe(f),He(([m,b])=>b),Er(([m,b],[k])=>[b,k],[0,0]),ve(([m,b])=>b-m)),g),{atBottomState:w,atBottomStateChange:l,atBottomThreshold:d,atTopStateChange:u,atTopThreshold:h,isAtBottom:o,isAtTop:a,isScrolling:f,lastJumpDueToItemResize:x,scrollDirection:y,scrollVelocity:g}},Rt(Hn)),Ju="top",Zu="bottom",Qk="none";function Xk(t,e,n){return typeof t=="number"?n===Xu&&e===Ju||n===cu&&e===Zu?t:0:n===Xu?e===Ju?t.main:t.reverse:e===Zu?t.main:t.reverse}function Jk(t,e){var n;return typeof t=="number"?t:(n=t[e])!=null?n:0}const C0=lt(([{deviation:t,fixedHeaderHeight:e,headerHeight:n,scrollTop:s,viewportHeight:r}])=>{const i=et(),o=ce(0),a=ce(0),l=ce(0),u=Nn(ne(tn(Ue(s),Ue(r),Ue(n),Ue(i,Yu),Ue(l),Ue(o),Ue(e),Ue(t),Ue(a)),ve(([d,h,f,[p,w],x,y,g,m,b])=>{const k=d-m,_=y+g,C=Math.max(f-k,0);let S=Qk;const j=Jk(b,Ju),T=Jk(b,Zu);return p-=m,p+=f+g,w+=f+g,w-=m,p>d+_-j&&(S=Xu),w<d-C+h+T&&(S=cu),S!==Qk?[Math.max(k-f-Xk(x,Ju,S)-j,0),k-C-g+h+Xk(x,Zu,S)+T]:null}),He(d=>d!=null),Tt(Yu)),[0,0]);return{increaseViewportBy:a,listBoundary:i,overscan:l,topListHeight:o,visibleRange:u}},Rt(Hn),{singleton:!0});function a6(t,e,n){if(tm(e)){const s=xT(t,e);return[{index:lr(e.groupOffsetTree,s)[0],offset:0,size:0},{data:n==null?void 0:n[0],index:s,offset:0,size:0}]}return[{data:n==null?void 0:n[0],index:t,offset:0,size:0}]}const yg={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function yf(t,e,n,s,r,i){const{lastIndex:o,lastOffset:a,lastSize:l}=r;let u=0,d=0;if(t.length>0){u=t[0].offset;const x=t[t.length-1];d=x.offset+x.size}const h=n-o,f=a+h*l+(h-1)*s,p=u,w=f-d;return{bottom:d,firstItemIndex:i,items:Zk(t,r,i),offsetBottom:w,offsetTop:u,top:p,topItems:Zk(e,r,i),topListHeight:e.reduce((x,y)=>y.size+x,0),totalCount:n}}function kT(t,e,n,s,r,i){let o=0;if(n.groupIndices.length>0)for(const d of n.groupIndices){if(d-o>=t)break;o++}const a=t+o,l=j0(e,a),u=Array.from({length:a}).map((d,h)=>({data:i[h+l],index:h+l,offset:0,size:0}));return yf(u,[],a,r,n,s)}function Zk(t,e,n){if(t.length===0)return[];if(!tm(e))return t.map(u=>({...u,index:u.index+n,originalIndex:u.index}));const s=t[0].index,r=t[t.length-1].index,i=[],o=Cl(e.groupOffsetTree,s,r);let a,l=0;for(const u of t){(!a||a.end<u.index)&&(a=o.shift(),l=e.groupIndices.indexOf(a.start));let d;u.index===a.start?d={index:l,type:"group"}:d={groupIndex:l,index:u.index-(l+1)+n},i.push({...d,data:u.data,offset:u.offset,originalIndex:u.index,size:u.size})}return i}function e_(t,e){var n;return t===void 0?0:typeof t=="number"?t:(n=t[e])!=null?n:0}const Ca=lt(([{data:t,firstItemIndex:e,gap:n,sizes:s,totalCount:r},i,{listBoundary:o,topListHeight:a,visibleRange:l},{initialTopMostItemIndex:u,scrolledToInitialItem:d},{topListHeight:h},f,{didMount:p},{recalcInProgress:w}])=>{const x=ce([]),y=ce(0),g=et(),m=ce(0);Pe(i.topItemsIndexes,x);const b=Nn(ne(tn(p,w,Ue(l,Yu),Ue(r),Ue(s),Ue(u),d,Ue(x),Ue(e),Ue(n),Ue(m),t),He(([S,j,,T,,,,,,,,P])=>{const L=P&&P.length!==T;return S&&!j&&!L}),ve(([,,[S,j],T,P,L,D,O,$,I,A,W])=>{var N,E,F,V;const H=P,{offsetTree:he,sizeTree:ee}=H,U=Mt(y);if(T===0)return{...yg,totalCount:T};if(S===0&&j===0)return U===0?{...yg,totalCount:T}:kT(U,L,P,$,I,W||[]);if(vt(ee))return U>0?null:yf(a6(j0(L,T),H,W),[],T,I,H,$);const Q=[];if(O.length>0){const De=O[0],J=O[O.length-1];let pe=0;for(const ie of Cl(ee,De,J)){const K=ie.value,G=Math.max(ie.start,De),le=Math.min(ie.end,J);for(let Y=G;Y<=le;Y++)Q.push({data:W==null?void 0:W[Y],index:Y,offset:pe,size:K}),pe+=K}}if(!D)return yf([],Q,T,I,H,$);const de=O.length>0?O[O.length-1]+1:0,Z=Y4(he,S,j,de);if(Z.length===0)return null;const be=T-1,Ae=em([],De=>{for(const J of Z){const pe=J.value;let ie=pe.offset,K=J.start;const G=pe.size;if(pe.offset<S){K+=Math.floor((S-pe.offset+I)/(G+I));const Y=K-J.start;ie+=Y*G+Y*I}K<de&&(ie+=(de-K)*G,K=de);const le=Math.min(J.end,be);for(let Y=K;Y<=le&&!(ie>=j);Y++)De.push({data:W==null?void 0:W[Y],index:Y,offset:ie,size:G}),ie+=G+I}}),me=e_(A,Ju),fe=e_(A,Zu);if(Ae.length>0&&(me>0||fe>0)){const De=Ae[0],J=Ae[Ae.length-1];if(me>0&&De.index>de){const pe=Math.min(me,De.index-de),ie=[];let K=De.offset;for(let G=De.index-1;G>=De.index-pe;G--){const le=(E=(N=Cl(ee,G,G)[0])==null?void 0:N.value)!=null?E:De.size;K-=le+I,ie.unshift({data:W==null?void 0:W[G],index:G,offset:K,size:le})}Ae.unshift(...ie)}if(fe>0&&J.index<be){const pe=Math.min(fe,be-J.index);let ie=J.offset+J.size+I;for(let K=J.index+1;K<=J.index+pe;K++){const G=(V=(F=Cl(ee,K,K)[0])==null?void 0:F.value)!=null?V:J.size;Ae.push({data:W==null?void 0:W[K],index:K,offset:ie,size:G}),ie+=G+I}}}return yf(Ae,Q,T,I,H,$)}),He(S=>S!==null),Tt()),yg);Pe(ne(t,He(v0),ve(S=>S==null?void 0:S.length)),r),Pe(ne(b,ve(S=>S.topListHeight)),h),Pe(h,a),Pe(ne(b,ve(S=>[S.top,S.bottom])),o),Pe(ne(b,ve(S=>S.items)),g);const k=ks(ne(b,He(({items:S})=>S.length>0),Qe(r,t),He(([{items:S},j])=>S[S.length-1].originalIndex===j-1),ve(([,S,j])=>[S-1,j]),Tt(Yu),ve(([S])=>S))),_=ks(ne(b,Jr(200),He(({items:S,topItems:j})=>S.length>0&&S[0].originalIndex===j.length),ve(({items:S})=>S[0].index),Tt())),C=ks(ne(b,He(({items:S})=>S.length>0),ve(({items:S})=>{let j=0,T=S.length-1;for(;S[j].type==="group"&&j<T;)j++;for(;S[T].type==="group"&&T>j;)T--;return{endIndex:S[T].index,startIndex:S[j].index}}),Tt(mT)));return{endReached:k,initialItemCount:y,itemsRendered:g,listState:b,minOverscanItemCount:m,rangeChanged:C,startReached:_,topItemsIndexes:x,...f}},Rt(Ir,vT,C0,Md,Od,Id,yo,k0),{singleton:!0}),_T=lt(([{fixedFooterHeight:t,fixedHeaderHeight:e,footerHeight:n,headerHeight:s},{listState:r}])=>{const i=et(),o=Nn(ne(tn(n,t,s,e,r),ve(([a,l,u,d,h])=>a+l+u+d+h.offsetBottom+h.bottom)),0);return Pe(Ue(o),i),{totalListHeight:o,totalListHeightChanged:i}},Rt(Hn,Ca),{singleton:!0}),l6=lt(([{viewportHeight:t},{totalListHeight:e}])=>{const n=ce(!1),s=Nn(ne(tn(n,t,e),He(([r])=>r),ve(([,r,i])=>Math.max(0,r-i)),Jr(0),Tt()),0);return{alignToBottom:n,paddingTopAddition:s}},Rt(Hn,_T),{singleton:!0}),ST=lt(()=>({context:ce(null)})),c6=({itemBottom:t,itemTop:e,locationParams:{align:n,behavior:s,...r},viewportBottom:i,viewportTop:o})=>e<o?{...r,align:n??"start",behavior:s}:t>i?{...r,align:n??"end",behavior:s}:null,jT=lt(([{gap:t,sizes:e,totalCount:n},{fixedFooterHeight:s,fixedHeaderHeight:r,headerHeight:i,scrollingInProgress:o,scrollTop:a,viewportHeight:l},{scrollToIndex:u}])=>{const d=et();return Pe(ne(d,Qe(e,l,n,i,r,s,a),Qe(t),ve(([[h,f,p,w,x,y,g,m],b])=>{const{align:k,behavior:_,calculateViewLocation:C=c6,done:S,...j}=h,T=yT(h,f,w-1),P=Qu(T,f.offsetTree,b)+x+y,L=P+lr(f.sizeTree,T)[1],D=m+y,O=m+p-g,$=C({itemBottom:L,itemTop:P,locationParams:{align:k,behavior:_,...j},viewportBottom:O,viewportTop:D});return $?S&&sr(ne(o,He(I=>!I),ga(Mt(o)?1:2)),S):S==null||S(),$}),He(h=>h!==null)),u),{scrollIntoView:d}},Rt(Ir,Hn,Od,Ca,xo),{singleton:!0});function t_(t){return t?t==="smooth"?"smooth":"auto":!1}const u6=(t,e)=>typeof t=="function"?t_(t(e)):e&&t_(t),d6=lt(([{listRefresh:t,totalCount:e,fixedItemSize:n,data:s},{atBottomState:r,isAtBottom:i},{scrollToIndex:o},{scrolledToInitialItem:a},{didMount:l,propsReady:u},{log:d},{scrollingInProgress:h},{context:f},{scrollIntoView:p}])=>{const w=ce(!1),x=et();let y=null;function g(_){Ge(o,{align:"end",behavior:_,index:"LAST"})}ut(ne(tn(ne(Ue(e),ga(1)),l),Qe(Ue(w),i,a,h),ve(([[_,C],S,j,T,P])=>{let L=C&&T,D="auto";return L&&(D=u6(S,j||P),L=L&&!!D),{followOutputBehavior:D,shouldFollow:L,totalCount:_}}),He(({shouldFollow:_})=>_)),({followOutputBehavior:_,totalCount:C})=>{y&&(y(),y=null),Mt(n)?requestAnimationFrame(()=>{Mt(d)("following output to ",{totalCount:C},is.DEBUG),g(_)}):y=sr(t,()=>{Mt(d)("following output to ",{totalCount:C},is.DEBUG),g(_),y=null})});function m(_){const C=sr(r,S=>{_&&!S.atBottom&&S.notAtBottomBecause==="SIZE_INCREASED"&&!y&&(Mt(d)("scrolling to bottom due to increased size",{},is.DEBUG),g("auto"))});setTimeout(C,100)}ut(ne(tn(Ue(w),e,u),He(([_,,C])=>_&&C),Er(({value:_},[,C])=>({refreshed:_===C,value:C}),{refreshed:!1,value:0}),He(({refreshed:_})=>_),Qe(w,e)),([,_])=>{Mt(a)&&m(_!==!1)}),ut(x,()=>{m(Mt(w)!==!1)}),ut(tn(Ue(w),r),([_,C])=>{_&&!C.atBottom&&C.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&g("auto")});const b=ce(null),k=et();return Pe(wy(ne(Ue(s),ve(_=>{var C;return(C=_==null?void 0:_.length)!=null?C:0})),ne(Ue(e))),k),ut(ne(tn(ne(k,ga(1)),l),Qe(Ue(b),a,h,f),ve(([[_,C],S,j,T,P])=>C&&j&&(S==null?void 0:S({context:P,totalCount:_,scrollingInProgress:T}))),He(_=>!!_),Jr(0)),_=>{y&&(y(),y=null),Mt(n)?requestAnimationFrame(()=>{Mt(d)("scrolling into view",{}),Ge(p,_)}):y=sr(t,()=>{Mt(d)("scrolling into view",{}),Ge(p,_),y=null})}),{autoscrollToBottom:x,followOutput:w,scrollIntoViewOnChange:b}},Rt(Ir,Id,Od,Md,yo,xo,Hn,ST,jT)),h6=lt(([{data:t,firstItemIndex:e,gap:n,sizes:s},{initialTopMostItemIndex:r},{initialItemCount:i,listState:o},{didMount:a}])=>(Pe(ne(a,Qe(i),He(([,l])=>l!==0),Qe(r,s,e,n,t),ve(([[,l],u,d,h,f,p=[]])=>kT(l,u,d,h,f,p))),o),{}),Rt(Ir,Md,Ca,yo),{singleton:!0}),f6=lt(([{didMount:t},{scrollTo:e},{listState:n}])=>{const s=ce(0);return ut(ne(t,Qe(s),He(([,r])=>r!==0),ve(([,r])=>({top:r}))),r=>{sr(ne(n,ga(1),He(i=>i.items.length>1)),()=>{requestAnimationFrame(()=>{Ge(e,r)})})}),{initialScrollTop:s}},Rt(yo,Hn,Ca),{singleton:!0}),CT=lt(([{scrollVelocity:t}])=>{const e=ce(!1),n=et(),s=ce(!1);return Pe(ne(t,Qe(s,e,n),He(([r,i])=>!!i),ve(([r,i,o,a])=>{const{enter:l,exit:u}=i;if(o){if(u(r,a))return!1}else if(l(r,a))return!0;return o}),Tt()),e),ut(ne(tn(e,t,n),Qe(s)),([[r,i,o],a])=>{r&&a&&a.change&&a.change(i,o)}),{isSeeking:e,scrollSeekConfiguration:s,scrollSeekRangeChanged:n,scrollVelocity:t}},Rt(Id),{singleton:!0}),N0=lt(([{scrollContainerState:t,scrollTo:e}])=>{const n=et(),s=et(),r=et(),i=ce(!1),o=ce(void 0);return Pe(ne(tn(n,s),ve(([{scrollHeight:a,scrollTop:l,viewportHeight:u},{offsetTop:d}])=>({scrollHeight:a,scrollTop:Math.max(0,l-d),viewportHeight:u}))),t),Pe(ne(e,Qe(s),ve(([a,{offsetTop:l}])=>({...a,top:a.top+l}))),r),{customScrollParent:o,useWindowScroll:i,windowScrollContainerState:n,windowScrollTo:r,windowViewportRect:s}},Rt(Hn)),p6=lt(([{sizeRanges:t,sizes:e},{headerHeight:n,scrollTop:s},{initialTopMostItemIndex:r},{didMount:i},{useWindowScroll:o,windowScrollContainerState:a,windowViewportRect:l}])=>{const u=et(),d=ce(void 0),h=ce(null),f=ce(null);return Pe(a,h),Pe(l,f),ut(ne(u,Qe(e,s,o,h,f,n)),([p,w,x,y,g,m,b])=>{const k=X4(w.sizeTree);y&&g!==null&&m!==null&&(x=g.scrollTop-m.offsetTop),x-=b,p({ranges:k,scrollTop:x})}),Pe(ne(d,He(v0),ve(m6)),r),Pe(ne(i,Qe(d),He(([,p])=>p!==void 0),Tt(),ve(([,p])=>p.ranges)),t),{getState:u,restoreStateFrom:d}},Rt(Ir,Hn,Md,yo,N0));function m6(t){return{align:"start",index:0,offset:t.scrollTop}}const g6=lt(([{topItemsIndexes:t}])=>{const e=ce(0);return Pe(ne(e,He(n=>n>=0),ve(n=>Array.from({length:n}).map((s,r)=>r))),t),{topItemCount:e}},Rt(Ca));function NT(t){let e=!1,n;return()=>(e||(e=!0,n=t()),n)}const x6=NT(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),y6=lt(([{deviation:t,scrollBy:e,scrollingInProgress:n,scrollTop:s},{isAtBottom:r,isScrolling:i,lastJumpDueToItemResize:o,scrollDirection:a},{listState:l},{beforeUnshiftWith:u,gap:d,shiftWithOffset:h,sizes:f},{log:p},{recalcInProgress:w}])=>{const x=ks(ne(l,Qe(o),Er(([,g,m,b],[{bottom:k,items:_,offsetBottom:C,totalCount:S},j])=>{const T=k+C;let P=0;return m===S&&g.length>0&&_.length>0&&(_[0].originalIndex===0&&g[0].originalIndex===0||(P=T-b,P!==0&&(P+=j))),[P,_,S,T]},[0,[],0,0]),He(([g])=>g!==0),Qe(s,a,n,r,p,w),He(([,g,m,b,,,k])=>!k&&!b&&g!==0&&m===Xu),ve(([[g],,,,,m])=>(m("Upward scrolling compensation",{amount:g},is.DEBUG),g))));function y(g){g>0?(Ge(e,{behavior:"auto",top:-g}),Ge(t,0)):(Ge(t,0),Ge(e,{behavior:"auto",top:-g}))}return ut(ne(x,Qe(t,i)),([g,m,b])=>{b&&x6()?Ge(t,m-g):y(-g)}),ut(ne(tn(Nn(i,!1),t,w),He(([g,m,b])=>!g&&!b&&m!==0),ve(([g,m])=>m),Jr(1)),y),Pe(ne(h,ve(g=>({top:-g}))),e),ut(ne(u,Qe(f,d),ve(([g,{groupIndices:m,lastSize:b,sizeTree:k},_])=>{function C(S){return S*(b+_)}if(m.length===0)return C(g);{let S=0;const j=Gu(k,0);let T=0,P=0;for(;T<g;){T++,S+=j;let L=m.length===P+1?1/0:m[P+1]-m[P]-1;T+L>g&&(S-=j,L=g-T+1),T+=L,S+=C(L),P++}return S}})),g=>{Ge(t,g),requestAnimationFrame(()=>{Ge(e,{top:g}),requestAnimationFrame(()=>{Ge(t,0),Ge(w,!1)})})}),{deviation:t}},Rt(Hn,Id,Ca,Ir,xo,k0)),v6=lt(([t,e,n,s,r,i,o,a,l,u,d])=>({...t,...e,...n,...s,...r,...i,...o,...a,...l,...u,...d}),Rt(C0,h6,yo,CT,_T,f6,l6,N0,jT,xo,ST)),ET=lt(([{data:t,defaultItemSize:e,firstItemIndex:n,fixedItemSize:s,fixedGroupSize:r,gap:i,groupIndices:o,heightEstimates:a,itemSize:l,sizeRanges:u,sizes:d,statefulTotalCount:h,totalCount:f,trackItemSizes:p},{initialItemFinalLocationReached:w,initialTopMostItemIndex:x,scrolledToInitialItem:y},g,m,b,k,{scrollToIndex:_},C,{topItemCount:S},{groupCounts:j},T])=>{const{listState:P,minOverscanItemCount:L,topItemsIndexes:D,rangeChanged:O,...$}=k;return Pe(O,T.scrollSeekRangeChanged),Pe(ne(T.windowViewportRect,ve(I=>I.visibleHeight)),g.viewportHeight),{data:t,defaultItemHeight:e,firstItemIndex:n,fixedItemHeight:s,fixedGroupHeight:r,gap:i,groupCounts:j,heightEstimates:a,initialItemFinalLocationReached:w,initialTopMostItemIndex:x,scrolledToInitialItem:y,sizeRanges:u,topItemCount:S,topItemsIndexes:D,totalCount:f,...b,groupIndices:o,itemSize:l,listState:P,minOverscanItemCount:L,scrollToIndex:_,statefulTotalCount:h,trackItemSizes:p,rangeChanged:O,...$,...T,...g,sizes:d,...m}},Rt(Ir,Md,Hn,p6,d6,Ca,Od,y6,g6,vT,v6));function b6(t,e){const n={},s={};let r=0;const i=t.length;for(;r<i;)s[t[r]]=1,r+=1;for(const o in e)Object.hasOwn(s,o)||(n[o]=e[o]);return n}const Nh=typeof document<"u"?ge.useLayoutEffect:ge.useEffect;function TT(t,e,n){const s=Object.keys(e.required||{}),r=Object.keys(e.optional||{}),i=Object.keys(e.methods||{}),o=Object.keys(e.events||{}),a=ge.createContext({});function l(y,g){y.propsReady&&Ge(y.propsReady,!1);for(const m of s){const b=y[e.required[m]];Ge(b,g[m])}for(const m of r)if(m in g){const b=y[e.optional[m]];Ge(b,g[m])}y.propsReady&&Ge(y.propsReady,!0)}function u(y){return i.reduce((g,m)=>(g[m]=b=>{const k=y[e.methods[m]];Ge(k,b)},g),{})}function d(y){return o.reduce((g,m)=>(g[m]=D4(y[e.events[m]]),g),{})}const h=ge.forwardRef((y,g)=>{const{children:m,...b}=y,[k]=ge.useState(()=>em($4(t),S=>{l(S,b)})),[_]=ge.useState(Vk(d,k));Nh(()=>{for(const S of o)S in b&&ut(_[S],b[S]);return()=>{Object.values(_).map(b0)}},[b,_,k]),Nh(()=>{l(k,b)}),ge.useImperativeHandle(g,Wk(u(k)));const C=n;return c.jsx(a.Provider,{value:k,children:n?c.jsx(C,{...b6([...s,...r,...o],b),children:m}):m})}),f=y=>{const g=ge.useContext(a);return ge.useCallback(m=>{Ge(g[y],m)},[g,y])},p=y=>{const g=ge.useContext(a)[y],m=ge.useCallback(b=>ut(g,b),[g]);return ge.useSyncExternalStore(m,()=>Mt(g),()=>Mt(g))},w=y=>{const g=ge.useContext(a)[y],[m,b]=ge.useState(Vk(Mt,g));return Nh(()=>ut(g,k=>{k!==m&&b(Wk(k))}),[g,m]),m},x=ge.version.startsWith("18")?p:w;return{Component:h,useEmitter:(y,g)=>{const m=ge.useContext(a)[y];Nh(()=>ut(m,g),[g,m])},useEmitterValue:x,usePublisher:f}}const PT=ge.createContext(void 0),RT=ge.createContext(void 0),AT=typeof document<"u"?ge.useLayoutEffect:ge.useEffect;function vg(t){return"self"in t}function w6(t){return"body"in t}function OT(t,e,n,s=hc,r,i){const o=ge.useRef(null),a=ge.useRef(null),l=ge.useRef(null),u=ge.useCallback(f=>{let p,w,x;const y=f.target;if(w6(y)||vg(y)){const m=vg(y)?y:y.defaultView;x=i?m.scrollX:m.scrollY,p=i?m.document.documentElement.scrollWidth:m.document.documentElement.scrollHeight,w=i?m.innerWidth:m.innerHeight}else x=i?y.scrollLeft:y.scrollTop,p=i?y.scrollWidth:y.scrollHeight,w=i?y.offsetWidth:y.offsetHeight;const g=()=>{t({scrollHeight:p,scrollTop:Math.max(x,0),viewportHeight:w})};f.suppressFlushSync?g():cC.flushSync(g),a.current!==null&&(x===a.current||x<=0||x===p-w)&&(a.current=null,e(!0),l.current&&(clearTimeout(l.current),l.current=null))},[t,e,i]);ge.useEffect(()=>{const f=r||o.current;return s(r||o.current),u({suppressFlushSync:!0,target:f}),f.addEventListener("scroll",u,{passive:!0}),()=>{s(null),f.removeEventListener("scroll",u)}},[o,u,n,s,r]);function d(f){const p=o.current;if(!p||(i?"offsetWidth"in p&&p.offsetWidth===0:"offsetHeight"in p&&p.offsetHeight===0))return;const w=f.behavior==="smooth";let x,y,g;vg(p)?(y=Math.max(co(p.document.documentElement,i?"width":"height"),i?p.document.documentElement.scrollWidth:p.document.documentElement.scrollHeight),x=i?p.innerWidth:p.innerHeight,g=i?window.scrollX:window.scrollY):(y=p[i?"scrollWidth":"scrollHeight"],x=co(p,i?"width":"height"),g=p[i?"scrollLeft":"scrollTop"]);const m=y-x;if(f.top=Math.ceil(Math.max(Math.min(m,f.top),0)),wT(x,y)||f.top===g){t({scrollHeight:y,scrollTop:g,viewportHeight:x}),w&&e(!0);return}w?(a.current=f.top,l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{l.current=null,a.current=null,e(!0)},1e3)):a.current=null,i&&(f={behavior:f.behavior,left:f.top}),p.scrollTo(f)}function h(f){i&&(f={behavior:f.behavior,left:f.top}),o.current.scrollBy(f)}return{scrollByCallback:h,scrollerRef:o,scrollToCallback:d}}const bg="-webkit-sticky",n_="sticky",E0=NT(()=>{if(typeof document>"u")return n_;const t=document.createElement("div");return t.style.position=bg,t.style.position===bg?bg:n_});function T0(t){return t}const k6=lt(()=>{const t=ce(a=>`Item ${a}`),e=ce(a=>`Group ${a}`),n=ce({}),s=ce(T0),r=ce("div"),i=ce(hc),o=(a,l=null)=>Nn(ne(n,ve(u=>u[a]),Tt()),l);return{components:n,computeItemKey:s,EmptyPlaceholder:o("EmptyPlaceholder"),FooterComponent:o("Footer"),GroupComponent:o("Group","div"),groupContent:e,HeaderComponent:o("Header"),HeaderFooterTag:r,ItemComponent:o("Item","div"),itemContent:t,ListComponent:o("List","div"),ScrollerComponent:o("Scroller","div"),scrollerRef:i,ScrollSeekPlaceholder:o("ScrollSeekPlaceholder"),TopItemListComponent:o("TopItemList")}}),_6=lt(([t,e])=>({...t,...e}),Rt(ET,k6)),S6=({height:t})=>c.jsx("div",{style:{height:t}}),j6={overflowAnchor:"none",position:E0(),zIndex:1},MT={overflowAnchor:"none"},C6={...MT,display:"inline-block",height:"100%"},s_=ge.memo(function({showTopList:t=!1}){const e=We("listState"),n=Is("sizeRanges"),s=We("useWindowScroll"),r=We("customScrollParent"),i=Is("windowScrollContainerState"),o=Is("scrollContainerState"),a=r||s?i:o,l=We("itemContent"),u=We("context"),d=We("groupContent"),h=We("trackItemSizes"),f=We("itemSize"),p=We("log"),w=Is("gap"),x=We("horizontalDirection"),{callbackRef:y}=B4(n,f,h,t?hc:a,p,w,r,x,We("skipAnimationFrameInResizeObserver")),[g,m]=ge.useState(0);P0("deviation",$=>{g!==$&&m($)});const b=We("EmptyPlaceholder"),k=We("ScrollSeekPlaceholder")||S6,_=We("ListComponent"),C=We("ItemComponent"),S=We("GroupComponent"),j=We("computeItemKey"),T=We("isSeeking"),P=We("groupIndices").length>0,L=We("alignToBottom"),D=We("initialItemFinalLocationReached"),O=t?{}:{boxSizing:"border-box",...x?{display:"inline-block",height:"100%",marginLeft:g!==0?g:L?"auto":0,paddingLeft:e.offsetTop,paddingRight:e.offsetBottom,whiteSpace:"nowrap"}:{marginTop:g!==0?g:L?"auto":0,paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},...D?{}:{visibility:"hidden"}};return!t&&e.totalCount===0&&b?c.jsx(b,{...Cn(b,u)}):c.jsx(_,{...Cn(_,u),"data-testid":t?"virtuoso-top-item-list":"virtuoso-item-list",ref:y,style:O,children:(t?e.topItems:e.items).map($=>{const I=$.originalIndex,A=j(I+e.firstItemIndex,$.data,u);return T?v.createElement(k,{...Cn(k,u),height:$.size,index:$.index,key:A,type:$.type||"item",...$.type==="group"?{}:{groupIndex:$.groupIndex}}):$.type==="group"?v.createElement(S,{...Cn(S,u),"data-index":I,"data-item-index":$.index,"data-known-size":$.size,key:A,style:j6},d($.index,u)):v.createElement(C,{...Cn(C,u),...P6(C,$.data),"data-index":I,"data-item-group-index":$.groupIndex,"data-item-index":$.index,"data-known-size":$.size,key:A,style:x?C6:MT},P?l($.index,$.groupIndex,$.data,u):l($.index,$.data,u))})})}),N6={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},E6={outline:"none",overflowX:"auto",position:"relative"},nm=t=>({height:"100%",position:"absolute",top:0,width:"100%",...t?{display:"flex",flexDirection:"column"}:{}}),T6={position:E0(),top:0,width:"100%",zIndex:1};function Cn(t,e){if(typeof t!="string")return{context:e}}function P6(t,e){return{item:typeof t=="string"?void 0:e}}const R6=ge.memo(function(){const t=We("HeaderComponent"),e=Is("headerHeight"),n=We("HeaderFooterTag"),s=ja(ge.useMemo(()=>i=>{e(co(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Cn(t,r)})}):null}),A6=ge.memo(function(){const t=We("FooterComponent"),e=Is("footerHeight"),n=We("HeaderFooterTag"),s=ja(ge.useMemo(()=>i=>{e(co(i,"height"))},[e]),!0,We("skipAnimationFrameInResizeObserver")),r=We("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Cn(t,r)})}):null});function IT({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ge.memo(function({children:s,style:r,context:i,...o}){const a=n("scrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("scrollerRef"),h=e("horizontalDirection")||!1,{scrollByCallback:f,scrollerRef:p,scrollToCallback:w}=OT(a,u,l,d,void 0,h);return t("scrollTo",w),t("scrollBy",f),c.jsx(l,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:p,style:{...h?E6:N6,...r},tabIndex:0,...o,...Cn(l,i),children:s})})}function DT({useEmitter:t,useEmitterValue:e,usePublisher:n}){return ge.memo(function({children:s,style:r,context:i,...o}){const a=n("windowScrollContainerState"),l=e("ScrollerComponent"),u=n("smoothScrollTargetReached"),d=e("totalListHeight"),h=e("deviation"),f=e("customScrollParent"),p=ge.useRef(null),w=e("scrollerRef"),{scrollByCallback:x,scrollerRef:y,scrollToCallback:g}=OT(a,u,l,w,f);return AT(()=>{var m;return y.current=f||((m=p.current)==null?void 0:m.ownerDocument.defaultView),()=>{y.current=null}},[y,f]),t("windowScrollTo",g),t("scrollBy",x),c.jsx(l,{ref:p,"data-virtuoso-scroller":!0,style:{position:"relative",...r,...d!==0?{height:d+h}:{}},...o,...Cn(l,i),children:s})})}const O6=({children:t})=>{const e=ge.useContext(PT),n=Is("viewportHeight"),s=Is("fixedItemHeight"),r=We("alignToBottom"),i=We("horizontalDirection"),o=ge.useMemo(()=>aT(n,l=>co(l,i?"width":"height")),[n,i]),a=ja(o,!0,We("skipAnimationFrameInResizeObserver"));return ge.useEffect(()=>{e&&(n(e.viewportHeight),s(e.itemHeight))},[e,n,s]),c.jsx("div",{"data-viewport-type":"element",ref:a,style:nm(r),children:t})},M6=({children:t})=>{const e=ge.useContext(PT),n=Is("windowViewportRect"),s=Is("fixedItemHeight"),r=We("customScrollParent"),i=cT(n,r,We("skipAnimationFrameInResizeObserver")),o=We("alignToBottom");return ge.useEffect(()=>{e&&(s(e.itemHeight),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:100}))},[e,n,s]),c.jsx("div",{"data-viewport-type":"window",ref:i,style:nm(o),children:t})},I6=({children:t})=>{const e=We("TopItemListComponent")||"div",n=We("headerHeight"),s={...T6,marginTop:`${n}px`},r=We("context");return c.jsx(e,{style:s,...Cn(e,r),children:t})},D6=ge.memo(function(t){const e=We("useWindowScroll"),n=We("topItemsIndexes").length>0,s=We("customScrollParent"),r=We("context");return c.jsxs(s||e?F6:$6,{...t,context:r,children:[n&&c.jsx(I6,{children:c.jsx(s_,{showTopList:!0})}),c.jsxs(s||e?M6:O6,{children:[c.jsx(R6,{}),c.jsx(s_,{}),c.jsx(A6,{})]})]})}),{Component:L6,useEmitter:P0,useEmitterValue:We,usePublisher:Is}=TT(_6,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},D6),$6=IT({useEmitter:P0,useEmitterValue:We,usePublisher:Is}),F6=DT({useEmitter:P0,useEmitterValue:We,usePublisher:Is}),z6=L6,B6=lt(()=>{const t=ce(u=>c.jsxs("td",{children:["Item $",u]})),e=ce(null),n=ce(u=>c.jsxs("td",{colSpan:1e3,children:["Group ",u]})),s=ce(null),r=ce(null),i=ce({}),o=ce(T0),a=ce(hc),l=(u,d=null)=>Nn(ne(i,ve(h=>h[u]),Tt()),d);return{components:i,computeItemKey:o,context:e,EmptyPlaceholder:l("EmptyPlaceholder"),FillerRow:l("FillerRow"),fixedFooterContent:r,fixedHeaderContent:s,itemContent:t,groupContent:n,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),TableBodyComponent:l("TableBody","tbody"),TableComponent:l("Table","table"),TableFooterComponent:l("TableFoot","tfoot"),TableHeadComponent:l("TableHead","thead"),TableRowComponent:l("TableRow","tr"),GroupComponent:l("Group","tr")}});Rt(ET,B6);E0();const r_={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},U6={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:i_,floor:cp,max:uu,min:wg,round:o_}=Math;function a_(t,e,n){return Array.from({length:e-t+1}).map((s,r)=>({data:n===null?null:n[r+t],index:r+t}))}function H6(t){return{...U6,items:t}}function Eh(t,e){return t&&t.width===e.width&&t.height===e.height}function W6(t,e){return t&&t.column===e.column&&t.row===e.row}const V6=lt(([{increaseViewportBy:t,listBoundary:e,overscan:n,visibleRange:s},{footerHeight:r,headerHeight:i,scrollBy:o,scrollContainerState:a,scrollTo:l,scrollTop:u,smoothScrollTargetReached:d,viewportHeight:h},f,p,{didMount:w,propsReady:x},{customScrollParent:y,useWindowScroll:g,windowScrollContainerState:m,windowScrollTo:b,windowViewportRect:k},_])=>{const C=ce(0),S=ce(0),j=ce(r_),T=ce({height:0,width:0}),P=ce({height:0,width:0}),L=et(),D=et(),O=ce(0),$=ce(null),I=ce({column:0,row:0}),A=et(),W=et(),N=ce(!1),E=ce(0),F=ce(!0),V=ce(!1),H=ce(!1);ut(ne(w,Qe(E),He(([Z,be])=>!!be)),()=>{Ge(F,!1)}),ut(ne(tn(w,F,P,T,E,V),He(([Z,be,Ae,me,,fe])=>Z&&!be&&Ae.height!==0&&me.height!==0&&!fe)),([,,,,Z])=>{Ge(V,!0),S0(1,()=>{Ge(L,Z)}),sr(ne(u),()=>{Ge(e,[0,0]),Ge(F,!0)})}),Pe(ne(W,He(Z=>Z!=null&&Z.scrollTop>0),_r(0)),S),ut(ne(w,Qe(W),He(([,Z])=>Z!=null)),([,Z])=>{Z&&(Ge(T,Z.viewport),Ge(P,Z.item),Ge(I,Z.gap),Z.scrollTop>0&&(Ge(N,!0),sr(ne(u,ga(1)),be=>{Ge(N,!1)}),Ge(l,{top:Z.scrollTop})))}),Pe(ne(T,ve(({height:Z})=>Z)),h),Pe(ne(tn(Ue(T,Eh),Ue(P,Eh),Ue(I,(Z,be)=>Z&&Z.column===be.column&&Z.row===be.row),Ue(u)),ve(([Z,be,Ae,me])=>({gap:Ae,item:be,scrollTop:me,viewport:Z}))),A),Pe(ne(tn(Ue(C),s,Ue(I,W6),Ue(P,Eh),Ue(T,Eh),Ue($),Ue(S),Ue(N),Ue(F),Ue(E)),He(([,,,,,,,Z])=>!Z),ve(([Z,[be,Ae],me,fe,De,J,pe,,ie,K])=>{const{column:G,row:le}=me,{height:Y,width:B}=fe,{width:xe}=De;if(pe===0&&(Z===0||xe===0))return r_;if(B===0){const Lt=j0(K,Z),ur=Lt+Math.max(pe-1,0);return H6(a_(Lt,ur,J))}const je=LT(xe,B,G);let Ce,Le;ie?be===0&&Ae===0&&pe>0?(Ce=0,Le=pe-1):(Ce=je*cp((be+le)/(Y+le)),Le=je*i_((Ae+le)/(Y+le))-1,Le=wg(Z-1,uu(Le,je-1)),Ce=wg(Le,uu(0,Ce))):(Ce=0,Le=-1);const we=a_(Ce,Le,J),{bottom:oe,top:Ee}=l_(De,me,fe,we),tt=i_(Z/je),ht=tt*Y+(tt-1)*le-oe;return{bottom:oe,itemHeight:Y,items:we,itemWidth:B,offsetBottom:ht,offsetTop:Ee,top:Ee}})),j),Pe(ne($,He(Z=>Z!==null),ve(Z=>Z.length)),C),Pe(ne(tn(T,P,j,I),He(([Z,be,{items:Ae}])=>Ae.length>0&&be.height!==0&&Z.height!==0),ve(([Z,be,{items:Ae},me])=>{const{bottom:fe,top:De}=l_(Z,me,be,Ae);return[De,fe]}),Tt(Yu)),e);const he=ce(!1);Pe(ne(u,Qe(he),ve(([Z,be])=>be||Z!==0)),he);const ee=ks(ne(tn(j,C),He(([{items:Z}])=>Z.length>0),Qe(he),He(([[Z,be],Ae])=>{const me=Z.items[Z.items.length-1].index===be-1;return(Ae||Z.bottom>0&&Z.itemHeight>0&&Z.offsetBottom===0&&Z.items.length===be)&&me}),ve(([[,Z]])=>Z-1),Tt())),U=ks(ne(Ue(j),He(({items:Z})=>Z.length>0&&Z[0].index===0),_r(0),Tt())),Q=ks(ne(Ue(j),Qe(N),He(([{items:Z},be])=>Z.length>0&&!be),ve(([{items:Z}])=>({endIndex:Z[Z.length-1].index,startIndex:Z[0].index})),Tt(mT),Jr(0)));Pe(Q,p.scrollSeekRangeChanged),Pe(ne(L,Qe(T,P,C,I),ve(([Z,be,Ae,me,fe])=>{const De=bT(Z),{align:J,behavior:pe,offset:ie}=De;let K=De.index;K==="LAST"&&(K=me-1),K=uu(0,K,wg(me-1,K));let G=Cy(be,fe,Ae,K);return J==="end"?G=o_(G-be.height+Ae.height):J==="center"&&(G=o_(G-be.height/2+Ae.height/2)),ie&&(G+=ie),{behavior:pe,top:G}})),l);const de=Nn(ne(j,ve(Z=>Z.offsetBottom+Z.bottom)),0);return Pe(ne(k,ve(Z=>({height:Z.visibleHeight,width:Z.visibleWidth}))),T),{customScrollParent:y,data:$,deviation:O,footerHeight:r,gap:I,headerHeight:i,increaseViewportBy:t,initialItemCount:S,itemDimensions:P,overscan:n,restoreStateFrom:W,scrollBy:o,scrollContainerState:a,scrollHeight:D,scrollTo:l,scrollToIndex:L,scrollTop:u,smoothScrollTargetReached:d,totalCount:C,useWindowScroll:g,viewportDimensions:T,windowScrollContainerState:m,windowScrollTo:b,windowViewportRect:k,...p,gridState:j,horizontalDirection:H,initialTopMostItemIndex:E,totalListHeight:de,...f,endReached:ee,propsReady:x,rangeChanged:Q,startReached:U,stateChanged:A,stateRestoreInProgress:N,..._}},Rt(C0,Hn,Id,CT,yo,N0,xo));function LT(t,e,n){return uu(1,cp((t+n)/(cp(e)+n)))}function l_(t,e,n,s){const{height:r}=n;if(r===void 0||s.length===0)return{bottom:0,top:0};const i=Cy(t,e,n,s[0].index);return{bottom:Cy(t,e,n,s[s.length-1].index)+r,top:i}}function Cy(t,e,n,s){const r=LT(t.width,n.width,e.column),i=cp(s/r),o=i*n.height+uu(0,i-1)*e.row;return o>0?o+e.row:o}const q6=lt(()=>{const t=ce(h=>`Item ${h}`),e=ce({}),n=ce(null),s=ce("virtuoso-grid-item"),r=ce("virtuoso-grid-list"),i=ce(T0),o=ce("div"),a=ce(hc),l=(h,f=null)=>Nn(ne(e,ve(p=>p[h]),Tt()),f),u=ce(!1),d=ce(!1);return Pe(Ue(d),u),{components:e,computeItemKey:i,context:n,FooterComponent:l("Footer"),HeaderComponent:l("Header"),headerFooterTag:o,itemClassName:s,ItemComponent:l("Item","div"),itemContent:t,listClassName:r,ListComponent:l("List","div"),readyStateChanged:u,reportReadyState:d,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}}),K6=lt(([t,e])=>({...t,...e}),Rt(V6,q6)),G6=ge.memo(function(){const t=Ot("gridState"),e=Ot("listClassName"),n=Ot("itemClassName"),s=Ot("itemContent"),r=Ot("computeItemKey"),i=Ot("isSeeking"),o=Ds("scrollHeight"),a=Ot("ItemComponent"),l=Ot("ListComponent"),u=Ot("ScrollSeekPlaceholder"),d=Ot("context"),h=Ds("itemDimensions"),f=Ds("gap"),p=Ot("log"),w=Ot("stateRestoreInProgress"),x=Ds("reportReadyState"),y=ja(ge.useMemo(()=>g=>{const m=g.parentElement.parentElement.scrollHeight;o(m);const b=g.firstChild;if(b){const{height:k,width:_}=b.getBoundingClientRect();h({height:k,width:_})}f({column:c_("column-gap",getComputedStyle(g).columnGap,p),row:c_("row-gap",getComputedStyle(g).rowGap,p)})},[o,h,f,p]),!0,!1);return AT(()=>{t.itemHeight>0&&t.itemWidth>0&&x(!0)},[t]),w?null:c.jsx(l,{className:e,ref:y,...Cn(l,d),"data-testid":"virtuoso-item-list",style:{paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},children:t.items.map(g=>{const m=r(g.index,g.data,d);return i?c.jsx(u,{...Cn(u,d),height:t.itemHeight,index:g.index,width:t.itemWidth},m):v.createElement(a,{...Cn(a,d),className:n,"data-index":g.index,key:m},s(g.index,g.data,d))})})}),Y6=ge.memo(function(){const t=Ot("HeaderComponent"),e=Ds("headerHeight"),n=Ot("headerFooterTag"),s=ja(ge.useMemo(()=>i=>{e(co(i,"height"))},[e]),!0,!1),r=Ot("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Cn(t,r)})}):null}),Q6=ge.memo(function(){const t=Ot("FooterComponent"),e=Ds("footerHeight"),n=Ot("headerFooterTag"),s=ja(ge.useMemo(()=>i=>{e(co(i,"height"))},[e]),!0,!1),r=Ot("context");return t?c.jsx(n,{ref:s,children:c.jsx(t,{...Cn(t,r)})}):null}),X6=({children:t})=>{const e=ge.useContext(RT),n=Ds("itemDimensions"),s=Ds("viewportDimensions"),r=ja(ge.useMemo(()=>i=>{s(i.getBoundingClientRect())},[s]),!0,!1);return ge.useEffect(()=>{e&&(s({height:e.viewportHeight,width:e.viewportWidth}),n({height:e.itemHeight,width:e.itemWidth}))},[e,s,n]),c.jsx("div",{ref:r,style:nm(!1),children:t})},J6=({children:t})=>{const e=ge.useContext(RT),n=Ds("windowViewportRect"),s=Ds("itemDimensions"),r=Ot("customScrollParent"),i=cT(n,r,!1);return ge.useEffect(()=>{e&&(s({height:e.itemHeight,width:e.itemWidth}),n({offsetTop:0,visibleHeight:e.viewportHeight,visibleWidth:e.viewportWidth}))},[e,n,s]),c.jsx("div",{ref:i,style:nm(!1),children:t})},Z6=ge.memo(function({...t}){const e=Ot("useWindowScroll"),n=Ot("customScrollParent"),s=n||e?tU:eU,r=n||e?J6:X6,i=Ot("context");return c.jsx(s,{...t,...Cn(s,i),children:c.jsxs(r,{children:[c.jsx(Y6,{}),c.jsx(G6,{}),c.jsx(Q6,{})]})})}),{useEmitter:$T,useEmitterValue:Ot,usePublisher:Ds}=TT(K6,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},Z6),eU=IT({useEmitter:$T,useEmitterValue:Ot,usePublisher:Ds}),tU=DT({useEmitter:$T,useEmitterValue:Ot,usePublisher:Ds});function c_(t,e,n){return e!=="normal"&&!(e!=null&&e.endsWith("px"))&&n(`${t} was not resolved to pixel value correctly`,e,is.WARN),e==="normal"?0:parseInt(e??"0",10)}const kg=new Set;function nU(){const[t,e]=v.useState([]),[n,s]=v.useState(""),[r,i]=v.useState(null),[o,a]=v.useState(!0),[l,u]=v.useState(!1),[d,h]=v.useState(null),f=v.useRef(null),p=v.useRef(null),w=v.useRef(null);v.useEffect(()=>{console.log("[ChatPage] Mount - starting loadHistory, showing loading spinner");async function k(){var _,C;try{console.log("[ChatPage] Fetching history from API...");const S=await X3({limit:500,newestFirst:!0});if(console.log("[ChatPage] History received:",{messageCount:((_=S==null?void 0:S.messages)==null?void 0:_.length)||0}),(C=S==null?void 0:S.messages)!=null&&C.length){const j=S.messages.map(hU);e(j),h(S.session_id||null),a(!1),console.log("[ChatPage] Loading complete - hiding spinner, showing messages"),setTimeout(()=>{var P;(P=w.current)==null||P.scrollToIndex({index:"LAST",behavior:"auto"})},50);const T=j.flatMap(P=>P.files||[]).filter(P=>P==null?void 0:P.file_id).map(P=>P.file_id);T.length>0&&(console.log("[ChatPage] Loading URLs for",T.length,"attachments in background..."),J3(T).then(P=>{console.log("[ChatPage] Attachment URLs loaded:",Object.keys((P==null?void 0:P.urls)||{}).length),P!=null&&P.urls&&e(L=>L.map(D=>({...D,files:(D.files||[]).map(O=>{const $=P.urls[O.file_id];if($){const I=typeof $=="string"?$:$.full||$.url;return{...O,url:I,width:$.width||O.width,height:$.height||O.height}}return O})})))}).catch(P=>{console.warn("[ChatPage] Failed to load attachment URLs:",P)}))}else console.log("[ChatPage] No history - showing greeting"),e([u_()]),a(!1),setTimeout(()=>{var j;(j=w.current)==null||j.scrollToIndex({index:"LAST",behavior:"auto"})},50)}catch(S){console.error("[ChatPage] Failed to load history:",S),e([u_()]),a(!1),setTimeout(()=>{var j;(j=w.current)==null||j.scrollToIndex({index:"LAST",behavior:"auto"})},50)}}k()},[]);const x=v.useMemo(()=>(n.trim().length>0||!!r)&&!l,[n,r,l]),y=v.useMemo(()=>t.filter(k=>!k.is_tool_response),[t]),g=v.useCallback((k=!1)=>{var _,C;k?(_=w.current)==null||_.scrollToIndex({index:"LAST",behavior:"auto"}):(C=w.current)==null||C.scrollToIndex({index:"LAST",behavior:"smooth",align:"end"})},[]),m=v.useCallback((k,_)=>c.jsx("div",{className:"px-2 py-1.5",style:{contain:"layout"},children:c.jsx(sU,{msg:_})}),[]);async function b(){var L,D;if(!x)return;const k=n.trim(),_=k||(r?`Please process this file: ${r.name}`:""),C=crypto.randomUUID(),S={id:C,role:"user",content:k,files:r?[{filename:r.name,preview_url:URL.createObjectURL(r)}]:[],status:null},j=crypto.randomUUID(),T={id:j,role:"assistant",content:"",files:[],status:"Thinking"};e(O=>[...O,S,T]),s("");const P=r;i(null),requestAnimationFrame(()=>g(!0));try{u(!0),(D=(L=p.current)==null?void 0:L.abort)==null||D.call(L);const O=new AbortController;p.current=O;let $=[],I="";if(P){const A=await eB(P);if(!(A!=null&&A.file_id))throw new Error("Upload failed");$=[A.file_id],e(W=>W.map(N=>{var E,F;return N.id===C?{...N,files:[{file_id:A.file_id,filename:P.name,url:A.url,width:A.image_width,height:A.image_height,preview_url:(F=(E=N.files)==null?void 0:E[0])==null?void 0:F.preview_url}]}:N}))}await Z3({conversationId:d,message:_,fileIds:$,signal:O.signal,onEvent:A=>{var W;if(!O.signal.aborted){if(A!=null&&A.conversation_id&&h(N=>N||A.conversation_id),A!=null&&A.error){e(N=>N.map(E=>E.id===j?{...E,status:null,content:`Error: ${A.error}`}:E));return}if((A==null?void 0:A.type)==="status"){e(N=>N.map(E=>E.id===j?{...E,status:A.content||"Processing"}:E));return}if((A==null?void 0:A.type)==="delete"){e(N=>N.map(E=>E.id===j?{...E,status:null}:E));return}if((A==null?void 0:A.type)==="tool_call"){const N=((W=A.tool)==null?void 0:W.name)||"processing";e(E=>E.map(F=>F.id===j?{...F,status:`Processing ${N}`}:F));return}if(((A==null?void 0:A.type)==="chunk"||(A==null?void 0:A.type)==="content")&&A.content){I=A.type==="content"?A.content:I+A.content,e(N=>N.map(E=>E.id===j?{...E,status:null,content:I}:E));return}if(A!=null&&A.content&&!A.type){I+=A.content,e(N=>N.map(E=>E.id===j?{...E,status:null,content:I}:E));return}if(((A==null?void 0:A.type)==="files"||(A==null?void 0:A.type)==="file")&&(A.files||A.file||A.file_id)){const N=A.file||{},E=A.files||(A.file?[{file_id:N.file_id,url:N.url,filename:N.filename,title:N.title}]:[{file_id:A.file_id,url:A.url,filename:A.filename,title:A.title}]),F=N.comment||A.comment||"";F&&(I=F),e(V=>V.map(H=>H.id===j?{...H,content:F||H.content,files:[...H.files||[],...E]}:H));return}}},onDone:()=>{e(A=>A.map(W=>{var N;return W.id===j&&!W.content&&!((N=W.files)!=null&&N.length)?{...W,status:null,content:"I'm ready to help. What would you like to do?"}:W.id===j?{...W,status:null}:W}))}})}catch(O){e($=>$.map(I=>I.id===j?{...I,status:null,content:(O==null?void 0:O.message)||"Failed to get response"}:I))}finally{u(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(bt,{className:"p-4 overflow-hidden flex-1 min-h-0",children:o?c.jsx("div",{className:"h-full flex items-center justify-center",children:c.jsx("div",{className:"rounded-2xl bg-white/55 dark:bg-white/5 backdrop-blur-md shadow-soft ring-1 ring-black/5 dark:ring-white/10 px-5 py-4 text-sm",children:c.jsx(Ye,{text:"Loading conversation"})})}):c.jsx(z6,{ref:w,className:"h-full scrollbar-thin",data:y,initialTopMostItemIndex:y.length-1,followOutput:"smooth",overscan:200,increaseViewportBy:{top:200,bottom:200},computeItemKey:(k,_)=>_.id,itemContent:m,skipAnimationFrameInResizeObserver:!0})}),c.jsxs(bt,{className:"p-3",children:[r&&c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:r.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>i(null),children:""})]}),c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:f,type:"file",className:"hidden",onChange:k=>{var _;return i(((_=k.target.files)==null?void 0:_[0])||null)},accept:"image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var k;return(k=f.current)==null?void 0:k.click()},children:c.jsx(HC,{size:18})}),c.jsx(uU,{value:n,onChange:s,placeholder:"Type your message...",onEnter:b}),c.jsx(te,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!x,onClick:b,children:c.jsx(WC,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"AI can make mistakes. Verify important information."})]})]})}const sU=ge.memo(function({msg:e}){var i;const n=e.role==="user",s=v.useMemo(()=>pU(e.content||""),[e.content]),r=!!e.status;return c.jsx("div",{className:n?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",n?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[r?c.jsx(dU,{text:e.status}):c.jsx("div",{dangerouslySetInnerHTML:{__html:s}}),((i=e.files)==null?void 0:i.length)>0&&c.jsx("div",{className:"mt-2 space-y-1",children:e.files.map((o,a)=>c.jsx(rU,{file:o,isUser:n},o.file_id||`file-${a}`))})]})})}),rU=ge.memo(function({file:e,isUser:n}){const s=fU(e.filename||e.url||""),r=["jpg","jpeg","png","gif","webp","bmp"].includes(s),i=e.filename||"Attachment",o=d=>d&&!d.startsWith("/api/"),a=e.preview_url||(o(e.url)?e.url:null),l=a;if(r)return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:[c.jsx(cU,{src:a,fullUrl:l,alt:i,width:e.width,height:e.height,isUser:n}),!n&&l&&o(l)&&c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(io,{size:14,className:"mr-1"})," Open"]})}),c.jsxs(te,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>d_(l,i),children:[c.jsx(pa,{size:14,className:"mr-1"})," Download"]})]})]});const u=s==="pdf";return c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:u?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Vv,{size:12})," PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:s?s.toUpperCase():"FILE"})}),!n&&c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:i})]}),!n&&l&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(io,{size:14,className:"mr-1"})," Open"]})}),c.jsxs(te,{size:"sm",variant:"secondary",className:"rounded-xl",onClick:()=>d_(l,i),children:[c.jsx(pa,{size:14,className:"mr-1"})," Download"]})]})]})})}),iU=400,oU=400,aU=300,lU=200,cU=ge.memo(function({src:e,fullUrl:n,alt:s,width:r,height:i,isUser:o}){const a=e&&kg.has(e),[l,u]=v.useState(a),[d,h]=v.useState(!1);v.useEffect(()=>{e&&kg.has(e)?u(!0):e&&(u(!1),h(!1))},[e]);const f=v.useCallback(()=>{e&&kg.add(e),u(!0)},[e]),p=v.useCallback(()=>{h(!0)},[]),w=v.useMemo(()=>{let y,g;if(r&&i&&r>0&&i>0){const m=r/i;m>=1?(y=Math.min(r,iU),g=Math.round(y/m)):(g=Math.min(i,oU),y=Math.round(g*m))}else y=aU,g=lU;return{width:y,height:g,minWidth:y,minHeight:g,maxWidth:y,maxHeight:g}},[r,i]);if(!e)return c.jsx("div",{className:"flex items-center justify-center bg-black/5 dark:bg-white/5 rounded-lg animate-pulse",style:w,children:c.jsx(Dw,{className:"text-black/20 dark:text-white/20",size:24})});if(d)return c.jsx("div",{className:"flex items-center justify-center bg-black/5 dark:bg-white/5 rounded-lg",style:w,children:c.jsx(Dw,{className:"text-red-400",size:24})});const x=c.jsx("div",{className:"overflow-hidden rounded-lg bg-black/5 dark:bg-white/5",style:{...w,contain:"layout"},children:c.jsx("img",{src:e,alt:s,className:`w-full h-full object-contain transition-opacity duration-150 ${l?"opacity-100":"opacity-0"}`,onLoad:f,onError:p})});return!o&&n?c.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"block",children:x}):x});function uU({value:t,onChange:e,placeholder:n,onEnter:s}){const r=v.useRef(null);return v.useEffect(()=>{const i=r.current;i&&(i.style.height="0px",i.style.height=Math.min(i.scrollHeight,132)+"px")},[t]),c.jsx("textarea",{ref:r,rows:1,value:t,onChange:i=>e(i.target.value),onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),s==null||s())},placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function dU({text:t}){const e=(t||"Thinking").replace(/\s*\.{3,}$/,"");return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:e}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function hU(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||"assistant",content:t.content||"",files:t.files||t.attachments||[],status:null,is_tool_response:!!t.is_tool_response}}function u_(){const t=new Date().getHours(),e=t>=5&&t<12?"morning":t<17?"afternoon":t<21?"evening":"night";return{id:crypto.randomUUID(),role:"assistant",content:`Good ${e}, how can I help?`,files:[],status:null}}function fU(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length>1?n.pop().toLowerCase():""}async function d_(t,e){try{const n=Bp(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{window.open(t,"_blank")}}function Ny(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function pU(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(u,d,h)=>(e.push({lang:d,code:h.trim()}),`__CODE_BLOCK_${e.length-1}__`));const s=[];n=n.replace(/`([^`]+)`/g,(u,d)=>(s.push(d),`__INLINE_CODE_${s.length-1}__`));const r=n.split(`
`),i=[];let o=!1,a=null;for(const u of r){const d=u.match(/^__CODE_BLOCK_(\d+)__$/);if(d){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const w=e[parseInt(d[1])];i.push(`<pre class="chat-code-block"><code>${Ny(w.code)}</code></pre>`);continue}const h=u.match(/^(#{1,6})\s+(.*)$/);if(h){o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1);const w=h[1].length;i.push(`<h${w} class="chat-header">${Th(h[2])}</h${w}>`);continue}const f=u.match(/^[-*]\s+(.*)$/);if(f){(!o||a!=="ul")&&(o&&i.push("</ol>"),i.push('<ul class="chat-list">'),o=!0,a="ul"),i.push(`<li>${Th(f[1])}</li>`);continue}const p=u.match(/^\d+\.\s+(.*)$/);if(p){(!o||a!=="ol")&&(o&&i.push("</ul>"),i.push('<ol class="chat-numbered-list">'),o=!0,a="ol"),i.push(`<li>${Th(p[1])}</li>`);continue}o&&(i.push(a==="ul"?"</ul>":"</ol>"),o=!1),u.trim()===""?i.push("<br>"):i.push(Th(u)+"<br>")}o&&i.push(a==="ul"?"</ul>":"</ol>");let l=i.join("");return s.forEach((u,d)=>{l=l.replace(`__INLINE_CODE_${d}__`,`<code class="chat-inline-code">${Ny(u)}</code>`)}),l}function Th(t){return t?Ny(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>"):""}function Se({label:t,children:e,className:n,labelClassName:s,withGap:r=!0}){return c.jsxs("label",{className:Te("block",r&&"space-y-1",n),children:[c.jsx("div",{className:Te("text-xs font-semibold text-black/60 dark:text-white/65",s),children:t}),e]})}function at({value:t="",options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,className:i,contentClassName:o,useNativeSelect:a=!1}){const l=v.useMemo(()=>e.find(u=>u.value===t),[e,t]);return a?c.jsxs("select",{className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","disabled:opacity-60 disabled:cursor-not-allowed",i),value:t,onChange:u=>n==null?void 0:n(u.target.value),disabled:r,children:[s?c.jsx("option",{value:"",disabled:!0,children:s}):null,e.map(u=>c.jsx("option",{value:u.value,disabled:u.disabled,children:u.label},u.value))]}):r?c.jsxs("button",{type:"button",disabled:!0,className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Te("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(Zn,{size:16,className:"text-black/50 dark:text-white/60"})]}):c.jsxs(Qp,{children:[c.jsx(Xp,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",i),children:[c.jsx("span",{className:Te("truncate",!l&&"text-black/50 dark:text-white/55"),children:l?l.label:s}),c.jsx(Zn,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx(Pd,{align:"start",className:Te("min-w-[220px]",o),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(u=>{const d=u.value===t;return c.jsx(Vu,{disabled:u.disabled,onSelect:()=>{u.disabled||n==null||n(u.value)},className:Te("cursor-pointer gap-0 py-1",d&&"bg-black/5 dark:bg-white/10 font-semibold"),children:c.jsx("span",{className:"min-w-0 truncate",children:u.label})},u.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]})}function mU({locations:t,timeOfDay:e,side:n,templateOptions:s,getTemplateKey:r,defaultFrameConfig:i,templateKey:o,setTemplateKey:a,venueType:l,timeOfDayDisabled:u,locationOptions:d}){const[h,f]=v.useState(""),p=o??h,w=a??f,[x,y]=v.useState(null),[g,m]=v.useState(i),[b,k]=v.useState(""),[_,C]=v.useState(null),[S,j]=v.useState([]),[T,P]=v.useState(!1),[L,D]=v.useState(""),O=ge.useRef([]),$=v.useMemo(()=>{const E=new Map;return s.forEach(F=>{E.set(r(F),F)}),E},[r,s]),I=v.useMemo(()=>{const E=new Map;return(d||[]).forEach(F=>{const V=(F==null?void 0:F.location_key)??(F==null?void 0:F.key)??(F==null?void 0:F.id)??(F==null?void 0:F.value)??F;if(!V)return;const H=(F==null?void 0:F.display_name)??(F==null?void 0:F.name)??(F==null?void 0:F.label)??V;E.set(String(V),H)}),E},[d]),A=v.useMemo(()=>t.length?t.map(E=>I.get(String(E))||E).filter(Boolean).join(", "):"",[I,t]),W=t.length&&(_||b.trim())&&!T;v.useEffect(()=>{if(!p){y(null),m(i);return}const E=$.get(p);if(!E){y(null),m(i);return}y(E),m(hf(E.config,i))},[i,p,$]),v.useEffect(()=>{p&&w("")},[n,e,t,l,u]),v.useEffect(()=>{O.current=S},[S]),v.useEffect(()=>()=>{p_(O.current)},[]);async function N(){if(W){D("");try{P(!0);const E=new FormData,F=u?"all":e;E.append("location_key",t[0]||""),E.append("location_keys",JSON.stringify(t)),E.append("venue_type",l),x?(E.append("time_of_day",x.time_of_day||F||"all"),E.append("side",x.side||n||"all"),E.append("specific_photo",x.photo),E.append("frame_config",JSON.stringify(g))):(E.append("time_of_day",F||"all"),E.append("side",n||"all")),b.trim()?E.append("ai_prompt",b.trim()):_&&E.append("creative",_);const V=await lB(E),H=await yU(V,A),he={id:crypto.randomUUID(),location:A,images:H};j(ee=>{const U=[he,...ee];if(U.length>3){const Q=U.pop();p_([Q])}return U})}catch(E){D((E==null?void 0:E.message)||"Unable to generate mockup.")}finally{P(!1)}}}return{templateKey:p,setTemplateKey:w,aiPrompt:b,setAiPrompt:k,creativeFile:_,setCreativeFile:C,lastResults:S,generating:T,generateError:L,setGenerateError:D,onGenerate:N,canGenerate:W}}function gU(t){const e=mU(t);return c.jsx(xU,{...t,...e})}function xU({locations:t,setLocations:e,venueType:n,setVenueType:s,setTemplateKey:r,locationOptions:i,locationsQuery:o,timeOfDay:a,setTimeOfDay:l,timeOfDayDisabled:u,sideDisabled:d,side:h,setSide:f,timeOfDayOptions:p,sideOptions:w,venueTypeOptions:x,templateKey:y,templateOptions:g,templatesQuery:m,templateThumbs:b,getTemplateKey:k,creativeFile:_,setCreativeFile:C,creativeDragActive:S,handleCreativeDragOver:j,handleCreativeDragLeave:T,handleCreativeDrop:P,aiPrompt:L,setAiPrompt:D,generateError:O,setGenerateError:$,generating:I,onGenerate:A,canGenerate:W,lastResults:N,useNativeSelects:E}){const F=v.useMemo(()=>i.map(H=>{const he=(H==null?void 0:H.key)??(H==null?void 0:H.id)??(H==null?void 0:H.value)??H,ee=(H==null?void 0:H.name)??(H==null?void 0:H.label)??he;return{value:he,label:ee}}),[i]);function V(){e([]),s("all"),l("all"),f("all"),r(""),C(null),D(""),$("")}return c.jsxs(bt,{className:"h-full flex flex-col",children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Mockup Generator"})}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[c.jsxs(Se,{label:"Location",children:[c.jsx(at,{value:t[0]||"",options:F,placeholder:"Select a location",onChange:H=>{e(H?[H]:[]),r("")},useNativeSelect:E}),o.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading locations"})}):null]}),c.jsx(Se,{label:"Venue Type",children:c.jsx(at,{value:n,options:x,onChange:H=>s(H),useNativeSelect:E})}),!u&&c.jsx(Se,{label:"Time of Day",children:c.jsx(at,{value:a,options:p,onChange:H=>l(H),useNativeSelect:E})}),!d&&c.jsx(Se,{label:"Billboard Side",children:c.jsx(at,{value:h,options:w,onChange:H=>f(H),useNativeSelect:E})})]}),t.length?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Templates (optional)"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Select a template or keep random."})]}),y?c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>r(""),children:"Use random"}):null]}),m.isLoading?c.jsx(Ye,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!m.isLoading&&!g.length?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:g.map(H=>{const he=k(H),ee=he===y,U=b[he],Q=H.environment||n||"all",de=H.time_of_day||(u?"all":a)||"all",Z=H.side||(d?"all":h)||"all";return c.jsxs("div",{className:Te("rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-left text-sm transition flex flex-col",ee?"border-2":"hover:bg-black/5 dark:hover:bg-white/10"),style:ee?{borderColor:"rgb(var(--brand-accent) / 0.6)",boxShadow:"0 0 0 1px rgb(var(--brand-accent) / 0.25)"}:void 0,children:[c.jsxs("button",{type:"button",onClick:()=>r(he),className:"text-left flex flex-col flex-1",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:U?c.jsx("img",{src:U,alt:H.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-1",children:[c.jsx("div",{className:"font-semibold truncate",children:H.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[Q,"/",de,"/",Z," - ",H.frame_count," frame",H.frame_count>1?"s":""]})]})]}),c.jsx("div",{className:"pt-2",children:U?c.jsx(te,{variant:"secondary",size:"sm",className:"w-full rounded-xl",asChild:!0,children:c.jsxs("a",{href:U,target:"_blank",rel:"noreferrer",children:[c.jsx(io,{size:16,className:"mr-2"}),"Open"]})}):c.jsx(te,{variant:"secondary",size:"sm",className:"w-full rounded-xl",disabled:!0,children:"Open"})})]},he)})})]}):null,c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Upload Creative/Ad Image",children:_?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:j,onDragLeave:T,onDrop:P,children:[c.jsx("div",{className:"truncate",children:_.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>C(null),children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${S?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:j,onDragLeave:T,onDrop:P,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:H=>{var he;return C(((he=H.target.files)==null?void 0:he[0])||null)}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP, GIF up to 10MB"})]})}),c.jsx(Se,{label:"Or use AI prompt",children:c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px]",value:L,onChange:H=>D(H.target.value),placeholder:"Describe what you want to generate..."})})]}),O?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:O}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(te,{className:"rounded-2xl",onClick:A,disabled:!W,children:I?c.jsx(Ye,{text:"Generating Mockup"}):"Generate Mockup"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:V,disabled:I,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4",children:[!N.length&&!I?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,I?c.jsx(Ye,{text:"Processing mockup",className:"text-sm text-black/60 dark:text-white/65"}):null,N.length?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Mockups"}),N.map(H=>{var he;return c.jsxs("div",{className:"space-y-3",children:[H.location?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:H.location}):null,(he=H.images)!=null&&he.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:H.images.map((ee,U)=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("a",{href:ee.url,target:"_blank",rel:"noopener noreferrer",className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:ee.url,alt:ee.label||"Generated mockup",className:"w-full h-40 object-cover",loading:"lazy"})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:ee.url,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(io,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:Q=>{Q.preventDefault(),m_(ee.url,ee.filename)},onKeyDown:Q=>{(Q.key==="Enter"||Q.key===" ")&&(Q.preventDefault(),m_(ee.url,ee.filename))},className:"inline-flex items-center",children:[c.jsx(pa,{size:14,className:"mr-1"}),"Download"]})})]})]},`${H.id}-img-${U}`))}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No images returned yet."})]},H.id)})]}):null]})]})]})}function h_(t){return typeof Blob<"u"&&t instanceof Blob}async function yU(t,e){if(!t)return[];if(t instanceof Response){const i=await t.blob();return i?[_g(i,e,1)]:[]}if(h_(t))return[_g(t,e,1)];const n=t,s=(n==null?void 0:n.images)||(n==null?void 0:n.image_urls)||(n==null?void 0:n.urls)||(n==null?void 0:n.results)||(n==null?void 0:n.files)||(n==null?void 0:n.data)||null,r=Array.isArray(s)?s:n!=null&&n.url?[n.url]:[];return r.length?r.map((i,o)=>{if(typeof i=="string")return f_(i,e,o+1);if(h_(i))return _g(i,e,o+1);const a=(i==null?void 0:i.url)||(i==null?void 0:i.image_url)||(i==null?void 0:i.file_url)||"";return f_(a,e,o+1)}):[]}function _g(t,e,n){const s=URL.createObjectURL(t),r=Ey(s,e,n);return{url:s,filename:r}}function f_(t,e,n){return t?{url:t,filename:Ey(t,e,n)}:{url:"",filename:Ey("",e,n)}}function Ey(t,e,n){const s=vU(t);if(s)return s;const r=(e||"result").toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),i=n?`_${n}`:"";return`mockup_${r||"result"}${i}.jpg`}function vU(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function p_(t){(Array.isArray(t)?t:[]).forEach(n=>{((n==null?void 0:n.images)||[]).forEach(s=>{var r;(r=s==null?void 0:s.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(s.url)})})}async function m_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e||"download",document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function bU(t,e,n){return t.length?t.length<=n?t.join(", "):`${t.slice(0,n).join(", ")} +${t.length-n}`:e}function wU({value:t=[],options:e=[],onChange:n,placeholder:s="Select...",disabled:r=!1,maxLabelCount:i=2,className:o,contentClassName:a}){const l=v.useMemo(()=>new Set(t),[t]),u=v.useMemo(()=>e.filter(f=>l.has(f.value)).map(f=>f.label),[e,l]);function d(f){r||n&&(l.has(f)?n(t.filter(p=>p!==f)):n([...t,f]))}const h=bU(u,s,i);return c.jsxs("div",{className:"space-y-2",children:[c.jsxs(Qp,{children:[c.jsx(Xp,{asChild:!0,children:c.jsxs("button",{type:"button",disabled:r,className:Te("w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none","flex items-center justify-between gap-2 text-left","disabled:opacity-60 disabled:cursor-not-allowed",o),children:[c.jsx("span",{className:Te("truncate",!u.length&&"text-black/50 dark:text-white/55"),children:h}),c.jsx(Zn,{size:16,className:"text-black/50 dark:text-white/60"})]})}),c.jsx(Pd,{align:"start",className:Te("min-w-[220px]",a),children:c.jsx("div",{className:"max-h-[240px] overflow-y-auto space-y-1",children:e.length?e.map(f=>{const p=l.has(f.value);return c.jsxs(Vu,{onSelect:w=>{w.preventDefault(),d(f.value)},className:"cursor-pointer py-1",children:[c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",p?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ra,{size:10,className:p?"opacity-100":"opacity-0"})}),c.jsx("span",{className:"min-w-0 truncate",children:f.label})]},f.value)}):c.jsx("div",{className:"px-3 py-2 text-sm text-black/60 dark:text-white/65",children:"No options available."})})})]}),u.length?c.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(f=>c.jsx("span",{className:"text-[11px] rounded-md bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/70 px-2",children:f},f))}):null]})}function kU({locations:t,setLocations:e,venueType:n,setVenueType:s,assetType:r,setAssetType:i,setTemplateKey:o,locationOptions:a,locationsQuery:l,assetTypeOptions:u,assetTypesQuery:d,timeOfDay:h,setTimeOfDay:f,timeOfDayDisabled:p,sideDisabled:w,side:x,setSide:y,timeOfDayOptions:g,sideOptions:m,venueTypeOptions:b,editingTemplate:k,editingTemplateLoading:_,stopEditTemplate:C,templatesOpen:S,setTemplatesOpen:j,templateOptions:T,templatesQuery:P,templateThumbs:L,getTemplateKey:D,startEditTemplate:O,deleteTemplate:$,setupPhoto:I,setSetupPhoto:A,handleSetupPhoto:W,handleSetupDragOver:N,handleSetupDragLeave:E,handleSetupDrop:F,setupDragActive:V,handleSetupPhotoClear:H,framesJson:he,setFramesJson:ee,setFramesJsonDirty:U,applyFramesJsonToCanvas:Q,buildFramesPayload:de,setupImageReady:Z,greenscreenOpen:be,setGreenscreenOpen:Ae,greenscreenColor:me,setGreenscreenColor:fe,greenscreenDetecting:De,colorTolerance:J,setColorTolerance:pe,RangeField:ie,handleGreenscreenDetect:K,canDetectGreenscreen:G,hasActiveFrame:le,frameSettingsOpen:Y,setFrameSettingsOpen:B,setupFrameConfig:xe,handleSetupFrameConfigChange:je,FrameConfigControls:Ce,previewOpen:Le,setPreviewOpen:we,testPreviewMode:oe,setTestPreviewMode:Ee,testPreviewImgRef:tt,testPreviewUrlRef:ht,previewImgRef:Lt,drawPreview:ur,activeTestCreativeFile:Na,updateTestCreativeForActive:am,generateTestPreview:lm,testPreviewing:Dr,activeFrameIndex:Ld,canvasRef:cm,canvasWidth:bo,canvasHeight:Ea,handleCanvasPointerDown:Ta,handleCanvasPointerMove:Pa,handleCanvasPointerUp:gc,handleCanvasWheel:$d,setupHint:At,handleZoomOut:ft,handleZoomIn:Hs,handleFitToScreen:Ws,zoomPercent:as,pixelUpscale:Fd,setPixelUpscale:Ra,setupError:Aa,setupMessage:Wn,addFrame:ct,resetCurrentFrame:gt,saveSetup:Oa,setupSaving:pn,clearAllFrames:Pn,currentPoints:xc,frameCount:wo,useNativeSelects:hi}){var vc,_o,bc;const[Cs,ko]=v.useState({open:!1,template:null}),[fi,pi]=v.useState(!1),yc=((vc=Cs.template)==null?void 0:vc.time_of_day)||"all",um=((_o=Cs.template)==null?void 0:_o.side)||"all",zd=((bc=Cs.template)==null?void 0:bc.storage_key)||"",Bd=zd?` for ${zd}`:"",Ud=Cs.template?`Delete "${Cs.template.photo}" (${yc}/${um})${Bd}? This removes the photo and its frames.`:"Delete this template? This removes the photo and its frames.";async function dm(){if(!(!Cs.template||fi)){pi(!0);try{await $(Cs.template)}finally{pi(!1),ko({open:!1,template:null})}}}function Hd(){fi||ko({open:!1,template:null})}return c.jsxs(c.Fragment,{children:[c.jsxs(bt,{className:"h-full flex flex-col",children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Mockup Setup"})}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[c.jsxs(Se,{label:"Location",children:[c.jsx(wU,{value:t,onChange:ae=>{e(ae),o("")},options:a.map(ae=>{const Rn=(ae==null?void 0:ae.key)??(ae==null?void 0:ae.id)??(ae==null?void 0:ae.value)??ae,Ma=(ae==null?void 0:ae.name)??(ae==null?void 0:ae.label)??Rn;return{value:Rn,label:Ma}}),placeholder:"Select locations"}),l.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading locations"})}):null]}),c.jsxs(Se,{label:"Asset Type",children:[c.jsx(at,{value:r,options:[{value:"",label:"All asset types"},...u.map(ae=>typeof ae=="string"?{value:ae,label:ae}:{value:(ae==null?void 0:ae.type_key)??(ae==null?void 0:ae.key)??(ae==null?void 0:ae.id)??(ae==null?void 0:ae.value)??"",label:(ae==null?void 0:ae.name)??(ae==null?void 0:ae.label)??(ae==null?void 0:ae.type_key)??"Unknown"})],placeholder:"Select asset type",onChange:ae=>i(ae),useNativeSelect:hi}),d!=null&&d.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading asset types"})}):null]}),c.jsx(Se,{label:"Venue Type",children:c.jsx(at,{value:n,options:b,placeholder:"Select venue type",onChange:ae=>s(ae),useNativeSelect:hi})}),!p&&c.jsx(Se,{label:"Time of Day",children:c.jsx(at,{value:h,options:g,placeholder:"Select time of day",onChange:ae=>f(ae),useNativeSelect:hi})}),!w&&c.jsx(Se,{label:"Billboard Side",children:c.jsx(at,{value:x,options:m,placeholder:"Select side",onChange:ae=>y(ae),useNativeSelect:hi})})]}),k?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/50 dark:bg-white/5 px-4 py-3 flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-semibold",children:"Editing template:"})," ",k.photo," (",k.time_of_day,"/",k.side,")"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[_?c.jsx(Ye,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"}):null,c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,children:"Stop editing"})]})]}):null,k?null:c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>j(ae=>!ae),"aria-expanded":S,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Existing templates"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:t.length?`${T.length} template${T.length===1?"":"s"}`:"Select at least one location to load templates."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:S?"Hide":"Show"}),c.jsx(Zn,{size:16,className:Te("transition-transform",S&&"rotate-180")})]})]}),S?c.jsxs("div",{className:"mt-3 space-y-2",children:[P.isLoading?c.jsx(Ye,{text:"Loading templates",className:"text-sm text-black/60 dark:text-white/65"}):null,!P.isLoading&&(!T.length||!t.length)?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No templates for this selection."}):null,c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-2",children:T.map(ae=>{const Rn=D(ae);return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 text-sm transition flex flex-col",children:[c.jsx("div",{className:"overflow-hidden rounded-lg border border-black/5 dark:border-white/10 bg-black/5",children:L[Rn]?c.jsx("img",{src:L[Rn],alt:ae.photo,className:"w-full h-40 object-cover",loading:"lazy"}):c.jsx("div",{className:"h-40 grid place-items-center text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading",className:"text-xs text-black/50 dark:text-white/60"})})}),c.jsxs("div",{className:"mt-auto pt-2 space-y-2",children:[c.jsx("div",{className:"font-semibold truncate",children:ae.photo}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[ae.time_of_day,"/",ae.side," - ",ae.frame_count," frame",ae.frame_count>1?"s":""]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>O(ae),disabled:_||fi,children:"Edit"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>ko({open:!0,template:ae}),disabled:fi,children:"Delete"})]})]})]},Rn)})})]}):null]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Upload Billboard Photo",children:I?c.jsxs("div",{className:`flex items-center justify-between rounded-xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm min-h-[120px] ${V?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:N,onDragLeave:E,onDrop:F,children:[c.jsx("div",{className:"truncate",children:I.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:H,children:"x"})]}):c.jsxs("label",{className:`block cursor-pointer rounded-xl border border-dashed border-black/10 dark:border-white/15 px-4 py-5 text-center text-sm bg-white/50 dark:bg-white/5 min-h-[120px] ${V?"ring-2 ring-black/20 dark:ring-white/30":""}`,onDragOver:N,onDragLeave:E,onDrop:F,children:[c.jsx("input",{type:"file",className:"hidden",accept:"image/jpeg,image/png,image/webp",onChange:ae=>{var Ma;const Rn=(Ma=ae.target.files)==null?void 0:Ma[0];Rn&&(A(Rn),W(Rn))}}),c.jsx("div",{className:"font-semibold mb-1",children:"Click to upload/ Drag and Drop an Image"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"JPG, PNG, WEBP up to 20MB"})]})}),c.jsxs(Se,{label:"Frames Data",children:[c.jsx("textarea",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 min-h-[120px] font-mono",value:he,onChange:ae=>{ee(ae.target.value),U(!0)},placeholder:'[{"points":[0,0,0,0],"config":{"brightness":100}}]'}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-black/50 dark:text-white/60",children:[c.jsx("span",{children:"Auto-filled from canvas. Edit to override."}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{type:"button",className:"text-xs underline",onClick:Q,children:"Apply to canvas"}),c.jsx("button",{type:"button",className:"text-xs underline",onClick:()=>{U(!1);const ae=de();ee(ae.length?JSON.stringify(ae,null,2):"[]")},children:"Sync from canvas"})]})]})]})]}),Z?c.jsxs(c.Fragment,{children:[c.jsxs(Dt,{className:"bg-white/50 dark:bg-white/5 p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>Ae(ae=>!ae),"aria-expanded":be,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Green Screen Detection"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Detect billboard frame using chroma key."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:be?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",be&&"rotate-180")})]})]}),be?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("input",{type:"color",value:me,onChange:ae=>fe(ae.target.value.toUpperCase()),className:"h-10 w-16 rounded-lg border border-black/10 dark:border-white/20"}),c.jsx("input",{type:"text",value:me,onChange:ae=>fe(ae.target.value.toUpperCase()),className:"flex-1 rounded-xl bg-white/70 dark:bg-white/10 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none font-mono"})]}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"Tip: Shift+click to pick a color. Shift+drag or middle mouse pans."}),c.jsx(ie,{label:"Color Tolerance",value:J,min:10,max:100,onChange:ae=>pe(ae),helper:"Lower is stricter, higher is more forgiving."}),c.jsx(te,{className:"rounded-2xl w-full",onClick:K,disabled:!G||De,children:De?c.jsx(Ye,{text:"Detecting"}):"Detect Green Screen Now"})]}):null]}),le?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>B(ae=>!ae),"aria-expanded":Y,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Current Frame Settings"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Adjust the current frame appearance."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:Y?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",Y&&"rotate-180")})]})]}),Y?c.jsxs("div",{className:"mt-3 space-y-3",children:[c.jsx(Ce,{config:xe,onChange:je}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Settings apply to the current frame only."})]}):null]}):null,le?c.jsxs("div",{className:"rounded-2xl bg-blue-50/70 dark:bg-blue-500/10 ring-1 ring-blue-500/20 p-4 shadow-soft",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>we(ae=>!ae),"aria-expanded":Le,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Test Preview Mode"}),c.jsx("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:"Preview creative on the current frame before saving."})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("span",{children:Le?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",Le&&"rotate-180")})]})]}),Le?c.jsxs("div",{className:"mt-3 space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3 text-sm",children:[c.jsx("input",{type:"checkbox",checked:oe,onChange:ae=>{Ee(ae.target.checked),ae.target.checked||(tt.current=null,ht.current="",ur())}}),c.jsx("span",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Enable preview"})]}),oe?c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-semibold text-blue-900 dark:text-blue-100",children:"Upload Test Creative"}),c.jsx("input",{type:"file",accept:"image/*",onChange:ae=>{var Rn;return am(((Rn=ae.target.files)==null?void 0:Rn[0])||null)},className:"w-full text-sm"}),Na?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Selected: ",Na.name]}):null,c.jsx(te,{className:"rounded-2xl w-full",onClick:lm,disabled:!Na||!I||!le||Dr,children:Dr?c.jsx(Ye,{text:"Generating"}):"Generate Test Preview"}),Ld>=0?c.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["Preview applies to frame ",Ld+1,"."]}):null]}):null]}):null]}):null]}):null]}),Z?c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-2",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:ft,disabled:!Lt.current,children:"-"}),c.jsx(te,{variant:"secondary",size:"sm",className:"h-8 px-3",onClick:Hs,disabled:!Lt.current,children:"+"}),c.jsx(te,{variant:"ghost",size:"sm",onClick:Ws,disabled:!Lt.current,children:"Fit"}),c.jsxs("span",{className:"text-xs text-black/60 dark:text-white/60",children:[as,"%"]})]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs text-black/70 dark:text-white/70",children:[c.jsx("input",{type:"checkbox",checked:Fd,onChange:ae=>Ra(ae.target.checked)}),"Pixel Upscale"]})]}),c.jsx("canvas",{ref:cm,width:bo,height:Ea,className:"w-full h-auto rounded-xl border border-black/10 dark:border-white/10 bg-white",onPointerDown:Ta,onPointerMove:Pa,onPointerUp:gc,onPointerLeave:gc,onWheel:$d,style:{touchAction:"none"}}),c.jsx("div",{className:"text-xs text-black/60 dark:text-white/60",children:At})]}):c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-black/5 dark:bg-white/10 px-4 py-3 text-sm text-black/60 dark:text-white/65",children:"Upload a billboard photo or pick an existing template to enable the canvas tools."})]}),Aa?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:Aa}):null,Wn?c.jsx("div",{className:"rounded-xl bg-green-50/70 text-green-700 px-4 py-2 text-sm dark:bg-green-500/10 dark:text-green-200",children:Wn}):null,c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(te,{className:"rounded-2xl",onClick:ct,disabled:xc.length!==4,children:"Add Frame"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:gt,children:"Reset Current Frame"}),c.jsx(te,{className:"rounded-2xl",onClick:Oa,disabled:pn||!t.length||!I,children:pn?c.jsx(Ye,{text:"Saving"}):k?"Save Changes":"Save All Frames"}),c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>Pn(!1),children:"Clear All Frames"})]}),wo?c.jsxs("div",{className:"rounded-xl bg-blue-50/70 text-blue-900 px-3 py-2 text-sm dark:bg-blue-500/10 dark:text-blue-100",children:["Frames configured: ",wo]}):null]})]}),c.jsx(uc,{open:Cs.open,message:Ud,onClose:Hd,onConfirm:dm})]})}function _U({enabled:t}){const e=en({queryKey:["mockup","history"],queryFn:cB,enabled:t}),n=v.useMemo(()=>{var s,r,i;return Array.isArray(e.data)?e.data:(s=e.data)!=null&&s.history?e.data.history:(r=e.data)!=null&&r.mockups?e.data.mockups:(i=e.data)!=null&&i.items?e.data.items:e.data||[]},[e.data]);return{historyQuery:e,historyItems:n}}function SU(t){const e=_U(t);return c.jsx(jU,{...e})}function jU({historyQuery:t,historyItems:e}){return c.jsxs(bt,{className:"h-full flex flex-col",children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"History"})}),c.jsx(Ut,{className:"flex-1 min-h-0 overflow-y-auto",children:t.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):t.isError?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Unable to load history right now."}):c.jsxs("div",{className:"space-y-2",children:[(e||[]).map((n,s)=>{const r=n.image_url||n.mockup_url||n.result_url||n.file_url||n.url||n.image||"",i=n.location_name||n.location||n.location_key||n.location_id||"Mockup",o=n.time_of_day||n.timeOfDay||"",a=n.side||n.billboard_side||"",l=n.created_at||n.generated_at||n.date_generated||"",u=["mockup",i,o||"all",a||"all"].filter(Boolean).join("_");return c.jsxs(Dt,{className:"p-3 space-y-2",children:[r?c.jsx("div",{className:"overflow-hidden rounded-xl border border-black/5 dark:border-white/10 bg-black/5",children:c.jsx("img",{src:r,alt:i,className:"w-full h-40 object-cover",loading:"lazy"})}):c.jsx("div",{className:"rounded-xl border border-dashed border-black/10 dark:border-white/15 px-3 py-6 text-sm text-black/60 dark:text-white/65 text-center",children:"Preview not available"}),c.jsx("div",{className:"text-base font-semibold",children:i}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[l?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Generated"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:new Date(l).toLocaleString()})]}):null,o?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Time of Day"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:o})]}):null,a?c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-xs text-black/45 dark:text-white/50",children:"Side"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:a})]}):null]}),r?c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:"Open"})}),c.jsx(te,{asChild:!0,size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsx("a",{href:r,download:u,children:"Download"})})]}):null]},n.id||n.file_id||r||s)}),e!=null&&e.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No mockups yet."})]})})]})}const FT=[{value:"all",label:"All (Default)"},{value:"day",label:"Day"},{value:"night",label:"Night"}],CU=FT.filter(t=>t.value!=="all"),zT=[{value:"all",label:"All (Default)"},{value:"gold",label:"Gold"},{value:"silver",label:"Silver"},{value:"single_side",label:"Single Side"}],NU=zT.filter(t=>t.value!=="all"),BT=[{value:"all",label:"All (Default)"},{value:"outdoor",label:"Outdoor"},{value:"indoor",label:"Indoor"}],EU=BT.filter(t=>t.value!=="all"),g_=!1,Ph=1200,Rh=800,TU=.5,PU=4,x_=.1,RU=4,Io={brightness:100,contrast:100,saturation:100,depthMultiplier:15,lightDirection:"top",imageBlur:0,edgeBlur:1,overlayOpacity:0,shadowIntensity:0,lightingAdjustment:0,colorTemperature:0,vignette:0,edgeSmoother:3,sharpening:0},UT=[{value:"top-left",label:"Top Left",glyph:""},{value:"top",label:"Top",glyph:""},{value:"top-right",label:"Top Right",glyph:""},{value:"left",label:"Left",glyph:""},{value:"center",label:"Center",glyph:""},{value:"right",label:"Right",glyph:""},{value:"bottom-left",label:"Bottom Left",glyph:""},{value:"bottom",label:"Bottom",glyph:""},{value:"bottom-right",label:"Bottom Right",glyph:""}],AU=UT.reduce((t,e)=>(t[e.value]=e.label,t),{});function OU(t,e,n){const s=(t-e)/(n-e)*100;return`linear-gradient(to right, rgb(var(--brand-accent, 102 126 234)) ${s}%, rgba(0, 0, 0, 0.1) ${s}%)`}function MU(){const t=Or(),{user:e}=oi(),n=ff(e,"sales:mockups:setup"),[s,r]=v.useState("generate"),[i,o]=v.useState([]),[a,l]=v.useState("all"),[u,d]=v.useState(""),[h,f]=v.useState("all"),[p,w]=v.useState("all"),[x,y]=v.useState(""),g=i[0]||"",m=a==="indoor",b=m,k=m,_=b?"all":h;v.useEffect(()=>{a==="indoor"&&(h&&f(""),p&&w(""))},[a]);const C=v.useRef(s),[S,j]=v.useState(null),[T,P]=v.useState(!1),[L,D]=v.useState(""),[O,$]=v.useState(""),[I,A]=v.useState("[]"),[W,N]=v.useState(!1),[E,F]=v.useState({}),[V,H]=v.useState(null),[he,ee]=v.useState(!1),[U,Q]=v.useState(!1),[de,Z]=v.useState(!1),[be,Ae]=v.useState("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),[me,fe]=v.useState(Io),[De,J]=v.useState("#1CFF1C"),[pe,ie]=v.useState(40),[K,G]=v.useState(!1),[le,Y]=v.useState([]),[B,xe]=v.useState(0),[je,Ce]=v.useState(1),[Le,we]=v.useState(!1),[oe,Ee]=v.useState(-1),[tt,ht]=v.useState(!1),[Lt,ur]=v.useState(!0),[Na,am]=v.useState(!0),[lm,Dr]=v.useState(!0),[Ld,cm]=v.useState(!0),[bo,Ea]=v.useState(!1),[Ta,Pa]=v.useState({}),[gc,$d]=v.useState(!1),At=v.useRef(null),ft=v.useRef(null),Hs=v.useRef(null),Ws=v.useRef(""),as=v.useRef(new Map),Fd=v.useRef({}),Ra=v.useRef({}),Aa=v.useRef([]),Wn=v.useRef(!1),ct=v.useRef([]),gt=v.useRef([]),Oa=v.useRef(-1),pn=v.useRef({zoom:1,panX:0,panY:0}),Pn=v.useRef({isDrawing:!1,isDraggingCorner:!1,isDraggingFrame:!1,dragFrameIndex:-1,dragPointIndex:-1,startX:0,startY:0,isPanning:!1,shiftPanPending:!1,hasPanned:!1,panStartX:0,panStartY:0,panOriginX:0,panOriginY:0}),xc=v.useRef({pointers:new Map,isPinching:!1,startDistance:0,startZoom:1,startPanX:0,startPanY:0,startCenterX:0,startCenterY:0}),wo=v.useRef({drawX:0,drawY:0,drawW:0,drawH:0,scale:1,imgNaturalW:0,imgNaturalH:0}),hi=en({queryKey:["mockup","eligibility","setup"],queryFn:dB,enabled:s==="setup"}),Cs=en({queryKey:["mockup","eligibility","generate"],queryFn:hB,enabled:s==="generate"}),ko=en({queryKey:["mockup","asset-types"],queryFn:tB,enabled:s==="setup"}),fi=en({queryKey:["mockup","templates",g,_,p,a],queryFn:()=>Fk(g,{timeOfDay:_,side:p,venueType:a}),enabled:s==="generate"&&!!g}),pi=wM({queries:s==="setup"?i.map(R=>({queryKey:["mockup","templates",R,_,p,a],queryFn:()=>Fk(R,{timeOfDay:_,side:p,venueType:a}),enabled:!!R,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:!1,staleTime:1/0})):[]}),yc=v.useMemo(()=>{var q;return{data:pi.flatMap((z,se)=>{const X=z.data,ye=Array.isArray(X)?X:(X==null?void 0:X.templates)||[],Ne=i[se];return ye.map(Ie=>({...Ie,storage_key:Ie.storage_key||Ne}))}),isLoading:pi.some(z=>z.isLoading),isFetching:pi.some(z=>z.isFetching),error:((q=pi.find(z=>z.error))==null?void 0:q.error)||null}},[i,pi]);v.useEffect(()=>()=>{as.current.forEach(R=>{R!=null&&R.url&&URL.revokeObjectURL(R.url)}),as.current.clear(),Ws.current&&URL.revokeObjectURL(Ws.current)},[]),v.useEffect(()=>{Fd.current=Ta},[Ta]),v.useEffect(()=>{Ra.current=E},[E]);const um=v.useMemo(()=>{const R=hi.data;return Array.isArray(R)?R:(R==null?void 0:R.locations)||[]},[hi.data]),zd=v.useMemo(()=>{const R=Cs.data;return Array.isArray(R)?R:(R==null?void 0:R.locations)||[]},[Cs.data]),Bd=s==="setup"?um:zd,Ud=s==="setup"?hi:Cs,dm=v.useMemo(()=>{const R=ko.data;return Array.isArray(R)?R:(R==null?void 0:R.asset_types)||(R==null?void 0:R.types)||[]},[ko.data]),Hd=v.useMemo(()=>{const R=fi.data;return Array.isArray(R)?R:(R==null?void 0:R.templates)||[]},[fi.data]),vc=v.useMemo(()=>{const R=yc.data;return Array.isArray(R)?R:(R==null?void 0:R.templates)||[]},[yc.data]),_o=s==="setup"?vc:Hd,bc=v.useMemo(()=>_o.map(R=>pr(R)).join("|"),[_o,pr]);v.useEffect(()=>{Aa.current=_o},[_o]);const ae=s==="history";v.useEffect(()=>{C.current!==s&&(C.current==="setup"&&V&&G0(),o([]),s==="setup"?(l(""),d(""),f(""),w("")):(l("all"),d(""),f("all"),w("all")),y("")),C.current=s},[V,s]),v.useEffect(()=>{a==="indoor"&&h&&f("")},[h,a]),v.useEffect(()=>{F(R=>{const q=new Set(Aa.current.map(X=>pr(X))),z={};let se=!1;return Object.entries(R).forEach(([X,ye])=>{q.has(X)?z[X]=ye:ye&&(se=!0,URL.revokeObjectURL(ye))}),se?z:R})},[bc,pr]),v.useEffect(()=>{let R=!0;const q=Aa.current;if(!g||!q.length)return()=>{};const z=q.filter(se=>!Ra.current[pr(se)]);return z.length?((async()=>{const se=await Promise.all(z.map(async ye=>{const Ne=pr(ye);let Ie="";try{Ie=await uB(ye.storage_key||g,ye.photo,{timeOfDay:ye.time_of_day||_,side:ye.side||p,company:ye.company,venueType:ye.venue_type||ye.environment||a})}catch{Ie=""}return{key:Ne,url:Ie}}));if(!R){se.forEach(({url:ye})=>{ye&&URL.revokeObjectURL(ye)});return}const X={};se.forEach(({key:ye,url:Ne})=>{Ne&&!Ra.current[ye]?X[ye]=Ne:Ne&&URL.revokeObjectURL(Ne)}),Object.keys(X).length>0&&F(ye=>({...ye,...X}))})(),()=>{R=!1}):()=>{}},[g,bc,_,p,a,pr]),v.useEffect(()=>()=>{Object.values(Ra.current).forEach(R=>{R&&URL.revokeObjectURL(R)})},[]);const Rn=!!ft.current,Ma=le.length===4||oe>=0,Vs=oe>=0?`frame-${oe}`:le.length===4?"current":null,q0=Vs?Ta[Vs]:null,P2=Math.round(je*100);v.useEffect(()=>{if(!Vs){Hs.current=null,Ws.current="";return}const R=as.current.get(Vs);Hs.current=(R==null?void 0:R.img)||null,Ws.current=(R==null?void 0:R.url)||"",bo&&xt()},[Vs,Ta,bo]),v.useEffect(()=>{ft.current&&wc(),xt()},[bo]),v.useEffect(()=>{xt()},[Le]),v.useEffect(()=>{tt&&ft.current&&xt()},[tt]),v.useEffect(()=>{if(W)return;const R=Ia();A(R.length?JSON.stringify(R,null,2):"[]")},[le,B,me,W]);async function R2(){D(""),$("");const R=V?pr(V):null;if(!i.length){$("Select at least one location first");return}if(!S){$("Upload a billboard photo first");return}let q=Ia();if(I.trim())try{q=JSON.parse(I)}catch(z){$((z==null?void 0:z.message)||"Frames JSON is invalid");return}if(!Array.isArray(q)||!q.length){$("Add at least one frame before saving");return}try{P(!0);const z=new FormData;V?(z.append("location_key",V.storage_key||g),z.append("photo_filename",V.photo),z.append("venue_type",a),u&&z.append("asset_type_key",u),z.append("time_of_day",_||"all"),z.append("side",p||"all"),z.append("frames_data",JSON.stringify(q)),S&&S.name!==V.photo&&z.append("photo",S),await sB(z),D("Updated frames successfully")):(z.append("location_keys",JSON.stringify(i)),z.append("venue_type",a),u&&z.append("asset_type_key",u),z.append("time_of_day",_||"all"),z.append("side",p||"all"),z.append("frames_data",JSON.stringify(q)),z.append("photo",S),await nB(z),D("Saved frames successfully")),nb(!0),H(null),ee(!1),j(null),ft.current=null,ht(!1),R&&F(se=>{if(!se[R])return se;const X={...se},ye=X[R];return ye&&URL.revokeObjectURL(ye),delete X[R],X}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"}),xt()}catch(z){$((z==null?void 0:z.message)||"Failed to save template")}finally{P(!1)}}async function A2(R){const q=(R==null?void 0:R.storage_key)||g;if(!q||!(R!=null&&R.photo))return;const z=(R==null?void 0:R.environment)||(R==null?void 0:R.venue_type)||"outdoor",se=R!=null&&R.time_of_day&&R.time_of_day!=="all"?R.time_of_day:"day",X=R!=null&&R.side&&R.side!=="all"?R.side:"gold";try{R!=null&&R.company?await oB({company:R.company,locationKey:q,environment:z,timeOfDay:se,side:X,photoFilename:R.photo}):await rB(q,R.photo,{timeOfDay:R.time_of_day,side:R.side}),t.invalidateQueries({queryKey:["mockup","templates"]}),t.refetchQueries({queryKey:["mockup","templates"],type:"active"})}catch(ye){$((ye==null?void 0:ye.message)||"Failed to delete template")}}function K0(R,{resetFrames:q=!0}={}){ft.current=R,ht(!0);const z=U2(R.naturalWidth,R.naturalHeight);wo.current={drawX:z.x,drawY:z.y,drawW:z.w,drawH:z.h,scale:z.scale,imgNaturalW:R.naturalWidth,imgNaturalH:R.naturalHeight},pm(!1),q&&(ct.current=[],gt.current=[],Ns(),Wn.current=!1,X2(),Wd(),ls(),jo(),A("[]"),N(!1)),wc(),xt()}function O2(R,q){return new Promise((z,se)=>{const X=new Image;X.onload=()=>{K0(X,q),z()},X.onerror=()=>se(new Error("Failed to load image")),X.src=R})}function M2(R,q){return new Promise((z,se)=>{const X=new FileReader;X.onload=ye=>{const Ne=new Image;Ne.onload=()=>{K0(Ne,q),z()},Ne.onerror=()=>se(new Error("Failed to load image")),Ne.src=ye.target.result},X.onerror=()=>se(new Error("Failed to read image")),X.readAsDataURL(R)})}function hm(R){return R?Array.isArray(R)&&R.length===4&&Array.isArray(R[0])?R:Array.isArray(R)&&R.length>=8&&typeof R[0]=="number"?[[R[0],R[1]],[R[2],R[3]],[R[4],R[5]],[R[6],R[7]]]:null:null}function I2(R){if(!R)return[];let q=R.frames||R.frames_data||R.framesData||R.frame_data||R.frame_points;if(typeof q=="string")try{q=JSON.parse(q)}catch{q=[]}return Array.isArray(q)?q.map(z=>{const se=hm((z==null?void 0:z.points)||(z==null?void 0:z.frame_points)||z)||hm(z==null?void 0:z.points);if(!se)return null;let X=(z==null?void 0:z.config)||(R==null?void 0:R.config);if(typeof X=="string")try{X=JSON.parse(X)}catch{X=null}const ye=hf(X,Io);return{points:se,config:ye,source:"existing"}}).filter(Boolean):[]}async function D2(R){if(!(!g||!(R!=null&&R.photo))){H(R),ee(!0),$(""),D(""),j(null);try{const q=R.venue_type||R.environment||"outdoor",z=R.time_of_day&&R.time_of_day!=="all"?R.time_of_day:"day",se=R.side&&R.side!=="all"?R.side:"gold";l(q),q==="indoor"?(f(""),w("")):(R.time_of_day&&R.time_of_day!=="all"?f(R.time_of_day):f(""),R.side&&R.side!=="all"?w(R.side):w(""));const X=await XE(R.storage_key||g,R.photo,{timeOfDay:R.time_of_day||_,side:R.side||p,company:R.company,venueType:R.venue_type||R.environment||a});if(!X)throw new Error("Failed to load template image");const ye=URL.createObjectURL(X);try{await O2(ye,{resetFrames:!1})}finally{URL.revokeObjectURL(ye)}let Ne=R;if(R.company){const Xe=await iB({company:R.company,locationKey:R.storage_key||g,environment:q,timeOfDay:z,side:se,photoFilename:R.photo});Xe!=null&&Xe.frames_data&&(Ne={...R,frames_data:Xe.frames_data,config:Xe.config??R.config,time_of_day:Xe.time_of_day||R.time_of_day,side:Xe.side||R.side,environment:Xe.environment||R.environment})}const Ie=I2(Ne);gt.current=Ie,ct.current=[],Ns(),Wn.current=!1,ls(),jo(),A(Ie.length?JSON.stringify(Ia(),null,2):"[]"),N(!1),xt();const yt=new File([X],R.photo,{type:X.type||"image/jpeg"});j(yt)}catch(q){$((q==null?void 0:q.message)||"Failed to load template for editing")}finally{ee(!1)}}}function G0(){H(null),ee(!1),D(""),$(""),f(""),w(""),j(null),ft.current=null,ht(!1),ct.current=[],gt.current=[],Ns(),Wn.current=!1,ls(),jo(),A("[]"),N(!1),wc(),xt()}function fm(R){const q=At.current;if(!q)return null;const z=q.getBoundingClientRect(),se=q.width/z.width,X=q.height/z.height;return{x:(R.clientX-z.left)*se,y:(R.clientY-z.top)*X}}function Y0(R){return Math.min(PU,Math.max(TU,R))}function So(){const{drawX:R,drawY:q,drawW:z,drawH:se,scale:X}=wo.current,{zoom:ye,panX:Ne,panY:Ie}=pn.current;return{drawX:R+Ne,drawY:q+Ie,drawW:z*ye,drawH:se*ye,scale:X*ye}}function pm(R=!0){pn.current={zoom:1,panX:0,panY:0},Ce(1),R&&xt()}function Q0(){const R=At.current;return R?{x:R.width/2,y:R.height/2}:{x:Ph/2,y:Rh/2}}function X0(R,q,z){const{drawX:se,drawY:X,scale:ye}=wo.current,{zoom:Ne,panX:Ie,panY:yt}=pn.current,Xe=Y0(R),Oe=ye*Ne,Ve=ye*Xe;if(!Oe||!Ve)return;const qe=(q-(se+Ie))/Oe,$t=(z-(X+yt))/Oe,St=q-se-qe*Ve,Vn=z-X-$t*Ve;pn.current={zoom:Xe,panX:St,panY:Vn},Ce(Xe),xt()}function L2(R,q){if(!ft.current)return;const{drawX:z,drawY:se,drawW:X,drawH:ye,scale:Ne}=So();if(R<z||q<se||R>z+X||q>se+ye)return;const Ie=Math.floor((R-z)/Ne),yt=Math.floor((q-se)/Ne),Xe=document.createElement("canvas");Xe.width=ft.current.naturalWidth,Xe.height=ft.current.naturalHeight;const Oe=Xe.getContext("2d");Oe.drawImage(ft.current,0,0);const Ve=Oe.getImageData(Ie,yt,1,1),[qe,$t,St]=Ve.data,Vn=`#${[qe,$t,St].map(dr=>dr.toString(16).padStart(2,"0")).join("").toUpperCase()}`;J(Vn)}function $2(R){}function F2(){if(!ft.current)return;const R=Q0();X0(pn.current.zoom+x_,R.x,R.y)}function z2(){if(!ft.current)return;const R=Q0();X0(pn.current.zoom-x_,R.x,R.y)}function B2(){ft.current&&pm()}function U2(R,q){const z=Math.min(Ph/R,Rh/q),se=Math.round(R*z),X=Math.round(q*z),ye=Math.round((Ph-se)/2),Ne=Math.round((Rh-X)/2);return{x:ye,y:Ne,w:se,h:X,scale:z}}function H2(){const R=At.current;if(!R)return;const q=R.getContext("2d");q.clearRect(0,0,R.width,R.height),q.fillStyle="#f8f9fa",q.fillRect(0,0,R.width,R.height)}function xt(){const R=At.current;if(!R)return;const q=R.getContext("2d");H2();const z=ft.current;if(!z)return;const{drawX:se,drawY:X,drawW:ye,drawH:Ne,scale:Ie}=So();if(q.imageSmoothingEnabled=!Le,Le||(q.imageSmoothingQuality="high"),bo&&Hs.current){q.drawImage(Hs.current,se,X,ye,Ne);return}q.drawImage(z,se,X,ye,Ne),gt.current.forEach((Oe,Ve)=>{const qe=Oe.points,$t=Oa.current===Ve,St=1;q.fillStyle="rgba(128, 128, 128, 0.3)",q.strokeStyle=$t?"#667eea":"#333",q.lineWidth=St,q.setLineDash([8,4]),q.lineCap="butt",q.lineJoin="miter",q.beginPath(),qe.forEach((Vn,dr)=>{const Co=se+Vn[0]*Ie,cs=X+Vn[1]*Ie;dr===0?q.moveTo(Co,cs):q.lineTo(Co,cs)}),q.closePath(),q.fill(),q.stroke(),q.setLineDash([]),qe.forEach(Vn=>{const dr=se+Vn[0]*Ie,Co=X+Vn[1]*Ie,cs=4;q.fillStyle=$t?"#667eea":"#333",q.fillRect(dr-cs/2,Co-cs/2,cs,cs)})});const Xe=ct.current;Xe.length>0&&(q.fillStyle="rgba(128, 128, 128, 0.3)",q.strokeStyle="#667eea",q.lineWidth=1,q.setLineDash([8,4]),q.lineCap="butt",q.lineJoin="miter",q.beginPath(),Xe.forEach((Ve,qe)=>{const $t=se+Ve[0]*Ie,St=X+Ve[1]*Ie;qe===0?q.moveTo($t,St):q.lineTo($t,St)}),Xe.length===4&&(q.closePath(),q.fill()),q.stroke(),q.setLineDash([]),Xe.forEach(Ve=>{const qe=se+Ve[0]*Ie,$t=X+Ve[1]*Ie;q.fillStyle="#667eea",q.fillRect(qe-4/2,$t-4/2,4,4)}))}function ls(){Y([...ct.current])}function jo(){xe(gt.current.length)}function Ns(){Oa.current=-1,Ee(-1)}function W2(){if(oe>=0){const R=gt.current[oe];return R?{key:`frame-${oe}`,points:R.points,config:R.config}:null}return ct.current.length===4?{key:"current",points:ct.current,config:me}:null}function V2(){as.current.forEach(R=>{R!=null&&R.url&&URL.revokeObjectURL(R.url)}),as.current.clear(),Ws.current&&URL.revokeObjectURL(Ws.current),Ws.current="",Hs.current=null}function Wd(){V2(),Ea(!1),Pa({})}function q2(R){Vs&&Pa(q=>{const z={...q};return R?z[Vs]=R:delete z[Vs],z})}function Vd(R){ct.current=[],ls(),Oa.current=R,Ee(R);const q=gt.current[R];q!=null&&q.config&&fe(hf(q.config,Io)),Dr(!0),N(!1);const z=Ia();A(z.length?JSON.stringify(z,null,2):"[]")}function K2(R,q){fe(z=>{const se={...z,[R]:q},X=Oa.current;return X>=0&&gt.current[X]&&(gt.current[X].config=se),se})}function J0(R,q,z){const{drawX:se,drawY:X,scale:ye}=So(),Ne=(R-se)/ye,Ie=(q-X)/ye;let yt=!1;for(let Xe=0,Oe=z.length-1;Xe<z.length;Oe=Xe++){const Ve=z[Xe][0],qe=z[Xe][1],$t=z[Oe][0],St=z[Oe][1];qe>Ie!=St>Ie&&Ne<($t-Ve)*(Ie-qe)/(St-qe)+Ve&&(yt=!yt)}return yt}function Z0(R,q){if(ct.current.length===4&&J0(R,q,ct.current))return-1;for(let z=gt.current.length-1;z>=0;z-=1)if(J0(R,q,gt.current[z].points))return z;return null}function eb(R,q){const{drawX:se,drawY:X,scale:ye}=So();if(ct.current.length>0)for(let Ne=0;Ne<ct.current.length;Ne+=1){const Ie=se+ct.current[Ne][0]*ye,yt=X+ct.current[Ne][1]*ye;if(Math.hypot(R-Ie,q-yt)<15)return{frame:-1,point:Ne}}for(let Ne=0;Ne<gt.current.length;Ne+=1){const Ie=gt.current[Ne].points;for(let yt=0;yt<Ie.length;yt+=1){const Xe=se+Ie[yt][0]*ye,Oe=X+Ie[yt][1]*ye;if(Math.hypot(R-Xe,q-Oe)<15)return{frame:Ne,point:yt}}}return null}function wc(){if(!ft.current){Ae("Select one or more locations, upload a billboard photo, then click four corners to define the frame.");return}Ae("Click and drag to draw a box. Use +/Fit to zoom; Shift+drag or middle mouse pans; pinch to zoom.")}function tb(R){R&&M2(R,{resetFrames:!0}).catch(q=>{$((q==null?void 0:q.message)||"Failed to load image")})}function G2(R){if(s!=="setup"||!ft.current)return;const q=fm(R);if(!q)return;const{x:z,y:se}=q,X=Pn.current;if(R.pointerType==="touch"){const qe=xc.current;if(qe.pointers.set(R.pointerId,{x:z,y:se}),qe.pointers.size===2){const[$t,St]=Array.from(qe.pointers.values()),Vn=($t.x+St.x)/2,dr=($t.y+St.y)/2;qe.isPinching=!0,qe.startDistance=Math.hypot($t.x-St.x,$t.y-St.y),qe.startZoom=pn.current.zoom,qe.startPanX=pn.current.panX,qe.startPanY=pn.current.panY,qe.startCenterX=Vn,qe.startCenterY=dr,X.isDrawing=!1,X.isDraggingCorner=!1,X.isDraggingFrame=!1,X.isPanning=!1,At.current&&(At.current.style.cursor="grabbing");return}}if(R.button===1||R.shiftKey){R.preventDefault(),X.isPanning=!0,X.shiftPanPending=R.shiftKey&&R.button===0,X.hasPanned=!1,X.panStartX=z,X.panStartY=se,X.panOriginX=pn.current.panX,X.panOriginY=pn.current.panY,At.current&&(At.current.style.cursor="grabbing");return}X.shiftPanPending=!1,X.hasPanned=!1;const{drawX:Ne,drawY:Ie,drawW:yt,drawH:Xe}=So(),Oe=eb(z,se);if(Oe){Pn.current.isDraggingCorner=!0,Pn.current.dragFrameIndex=Oe.frame,Pn.current.dragPointIndex=Oe.point,Oe.frame>=0?Vd(Oe.frame):(Ns(),Dr(!0)),xt();return}const Ve=Z0(z,se);if(Ve!==null){Pn.current.isDraggingFrame=!0,Pn.current.dragFrameIndex=Ve,Pn.current.startX=z,Pn.current.startY=se,Ve>=0?Vd(Ve):(Ns(),Dr(!0)),At.current&&(At.current.style.cursor="move"),xt();return}z<Ne||se<Ie||z>Ne+yt||se>Ie+Xe||(Wn.current=!1,Pn.current.isDrawing=!0,Pn.current.startX=z,Pn.current.startY=se,Ns())}function Y2(R){if(s!=="setup"||!ft.current)return;const q=fm(R);if(!q)return;const{x:z,y:se}=q,X=Pn.current;if(R.pointerType==="touch"){const Oe=xc.current;if(Oe.pointers.has(R.pointerId)&&Oe.pointers.set(R.pointerId,{x:z,y:se}),Oe.isPinching&&Oe.pointers.size>=2){const[Ve,qe]=Array.from(Oe.pointers.values()),$t=(Ve.x+qe.x)/2,St=(Ve.y+qe.y)/2,Vn=Math.hypot(Ve.x-qe.x,Ve.y-qe.y),{drawX:dr,drawY:Co,scale:cs}=wo.current,mm=Oe.startZoom;if(Oe.startDistance>0&&cs){const qd=Y0(mm*(Vn/Oe.startDistance)),dP=(Oe.startCenterX-(dr+Oe.startPanX))/(cs*mm),hP=(Oe.startCenterY-(Co+Oe.startPanY))/(cs*mm),fP=$t-dr-dP*cs*qd,pP=St-Co-hP*cs*qd;pn.current={zoom:qd,panX:fP,panY:pP},Ce(qd),xt()}return}}if(X.isPanning){R.preventDefault();const Oe=z-X.panStartX,Ve=se-X.panStartY;if(X.shiftPanPending&&!X.hasPanned){if(Math.hypot(Oe,Ve)<RU)return;X.hasPanned=!0}pn.current.panX=X.panOriginX+Oe,pn.current.panY=X.panOriginY+Ve,xt();return}const{drawX:ye,drawY:Ne,scale:Ie}=So();if(X.isDraggingCorner){const Oe=(z-ye)/Ie,Ve=(se-Ne)/Ie;X.dragFrameIndex===-1?ct.current[X.dragPointIndex]=[Math.round(Oe),Math.round(Ve)]:gt.current[X.dragFrameIndex].points[X.dragPointIndex]=[Math.round(Oe),Math.round(Ve)],xt();return}if(X.isDraggingFrame){const Oe=(z-X.startX)/Ie,Ve=(se-X.startY)/Ie;X.dragFrameIndex===-1?ct.current=ct.current.map(qe=>[Math.round(qe[0]+Oe),Math.round(qe[1]+Ve)]):gt.current[X.dragFrameIndex].points=gt.current[X.dragFrameIndex].points.map(qe=>[Math.round(qe[0]+Oe),Math.round(qe[1]+Ve)]),X.startX=z,X.startY=se,xt();return}if(X.isDrawing){xt();const Oe=At.current.getContext("2d");Oe.fillStyle="rgba(128, 128, 128, 0.3)";const Ve=z-X.startX,qe=se-X.startY;Oe.fillRect(X.startX,X.startY,Ve,qe),Oe.strokeStyle="#667eea",Oe.lineWidth=1,Oe.setLineDash([8,4]),Oe.lineCap="butt",Oe.lineJoin="miter",Oe.strokeRect(X.startX,X.startY,Ve,qe),Oe.setLineDash([]);return}const yt=eb(z,se),Xe=Z0(z,se);At.current&&(yt?At.current.style.cursor="pointer":Xe!==null?At.current.style.cursor="move":At.current.style.cursor="crosshair")}function Q2(R){if(s!=="setup"||!ft.current)return;const q=fm(R),z=Pn.current;if(R.pointerType==="touch"){const St=xc.current;if(St.pointers.has(R.pointerId)&&St.pointers.delete(R.pointerId),St.isPinching&&St.pointers.size<2&&(St.isPinching=!1),St.isPinching)return}if(z.isPanning){z.isPanning=!1,At.current&&(At.current.style.cursor="crosshair"),z.shiftPanPending&&!z.hasPanned&&Na&&q&&L2(q.x,q.y),z.shiftPanPending=!1,z.hasPanned=!1;return}if(z.isDraggingCorner){z.isDraggingCorner=!1,z.dragFrameIndex=-1,z.dragPointIndex=-1,At.current&&(At.current.style.cursor="crosshair"),ls(),xt();return}if(z.isDraggingFrame){z.isDraggingFrame=!1,z.dragFrameIndex=-1,At.current&&(At.current.style.cursor="crosshair"),ls(),xt();return}if(!z.isDrawing||!q)return;const{x:se,y:X}=q,{drawX:ye,drawY:Ne,scale:Ie}=So(),yt=z.startX,Xe=z.startY,Oe=(Math.min(yt,se)-ye)/Ie,Ve=(Math.min(Xe,X)-Ne)/Ie,qe=(Math.max(yt,se)-ye)/Ie,$t=(Math.max(Xe,X)-Ne)/Ie;ct.current=[[Math.round(Oe),Math.round(Ve)],[Math.round(qe),Math.round(Ve)],[Math.round(qe),Math.round($t)],[Math.round(Oe),Math.round($t)]],z.isDrawing=!1,ls(),Ns(),Dr(!0),Ae("Frame drawn. Drag corners to adjust, or drag inside to move. Click Add Frame to save."),xt()}function X2(){fe(Io)}function J2(){if(ct.current.length!==4){$("Select 4 corner points first");return}const R={...me},q=Wn.current?"greenscreen":"manual";gt.current.push({points:[...ct.current],config:R,source:q});const z="current";ct.current=[];const se=gt.current.length-1;Vd(se),Wn.current=!1,ls(),jo(),Ae(`Frame ${gt.current.length} added. Draw another box or save when done.`);const X=as.current.get(z);X&&(as.current.set(`frame-${se}`,X),as.current.delete(z));const ye=Fd.current[z];ye&&Pa(Ne=>{const Ie={...Ne};return Ie[`frame-${se}`]=ye,delete Ie[z],Ie}),Ea(!1),Hs.current=null,xt()}function Z2(){ct.current=[],Ns(),Wn.current=!1,ls(),as.current.delete("current"),Pa(R=>{if(!R.current)return R;const q={...R};return delete q.current,q}),Ea(!1),Hs.current=null,gt.current.length?Ae(`Frames saved: ${gt.current.length}. Draw another box or save all frames.`):wc(),xt()}function nb(R=!1){!R&&!window.confirm("Clear all frames? This will reset your work.")||(gt.current=[],ct.current=[],Ns(),Wn.current=!1,Wd(),ls(),jo(),A("[]"),N(!1),wc(),xt())}function Ia(){const R=[...gt.current];return ct.current.length===4&&R.push({points:[...ct.current],config:{...me}}),R.map(q=>({points:q.points.map(z=>[z[0],z[1]]),config:q.config}))}function eP(R){if(!R.trim())return[];let q=[];try{q=JSON.parse(R)}catch(z){throw new Error((z==null?void 0:z.message)||"Frames JSON is invalid")}if(!Array.isArray(q))throw new Error("Frames JSON must be an array of frames.");return q.map((z,se)=>{const X=hm((z==null?void 0:z.points)||(z==null?void 0:z.frame_points)||z);if(!X||X.length!==4)throw new Error(`Frame ${se+1} must include 4 points.`);const ye=X.map(Ie=>{const yt=Number(Ie[0]),Xe=Number(Ie[1]);if(!Number.isFinite(yt)||!Number.isFinite(Xe))throw new Error(`Frame ${se+1} has invalid point values.`);return[yt,Xe]});let Ne=z==null?void 0:z.config;if(typeof Ne=="string")try{Ne=JSON.parse(Ne)}catch{Ne=null}return{points:ye,config:hf(Ne,Io),source:"json"}})}function tP(){$("");try{const R=eP(I);gt.current=R,ct.current=[],Wn.current=!1,Wd(),R.length?Vd(0):Ns(),ls(),jo(),N(!1),A(R.length?JSON.stringify(Ia(),null,2):"[]"),xt()}catch(R){$((R==null?void 0:R.message)||"Frames JSON is invalid")}}function nP(){!ft.current||K||(G(!0),setTimeout(()=>{if(!ft.current){G(!1);return}try{const R=document.createElement("canvas");R.width=ft.current.width,R.height=ft.current.height;const q=R.getContext("2d");q.drawImage(ft.current,0,0);const z=q.getImageData(0,0,ft.current.width,ft.current.height),se=LU(z,{color:De,tolerance:pe,depthMultiplier:me.depthMultiplier,existingFrames:gt.current});se?(ct.current=se,Ns(),Wn.current=!0,ls(),Dr(!0),Ae("Green screen detected. Adjust points or click Add Frame to save."),xt()):Ae("No green screen detected. Adjust tolerance or draw frame manually.")}finally{G(!1)}},0))}async function sP(){const R=W2();if(!S||!R||!Vs){$("Upload a photo and select or draw a frame first.");return}const q=q0;if(!q){$("Upload a test creative for the active frame first.");return}if(!gc){$(""),$d(!0);try{const z=new FormData;z.append("billboard_photo",S),z.append("creative",q),z.append("frame_points",JSON.stringify(R.points)),z.append("config",JSON.stringify(R.config)),z.append("time_of_day",h||"day");const se=await aB(z),X=as.current.get(Vs);X!=null&&X.url&&URL.revokeObjectURL(X.url);const ye=URL.createObjectURL(se),Ne=new Image;Ne.onload=()=>{as.current.set(Vs,{url:ye,img:Ne}),Ws.current=ye,Hs.current=Ne,xt()},Ne.src=ye}catch(z){$((z==null?void 0:z.message)||"Failed to generate preview")}finally{$d(!1)}}}function rP(){j(null),ft.current=null,ct.current=[],gt.current=[],Ns(),Wn.current=!1,ht(!1),Wd(),pm(!1),ls(),jo(),A("[]"),N(!1),Ae("Select one or more locations, upload a billboard photo, then click four corners to define the frame."),xt()}function iP(R){R.preventDefault(),Q(!0)}function oP(R){R.preventDefault(),Q(!1)}function aP(R){var z,se;R.preventDefault(),Q(!1);const q=(se=(z=R.dataTransfer)==null?void 0:z.files)==null?void 0:se[0];q&&(j(q),tb(q))}function lP(R){R.preventDefault(),Z(!0)}function cP(R){R.preventDefault(),Z(!1)}function uP(R){var z,se;R.preventDefault(),Z(!1);const q=(se=(z=R.dataTransfer)==null?void 0:z.files)==null?void 0:se[0];q&&setCreativeFile(q)}return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(te,{variant:s==="generate"?"default":"ghost",onClick:()=>r("generate"),className:"rounded-2xl",children:"Generate"}),n?c.jsx(te,{variant:s==="setup"?"default":"ghost",onClick:()=>r("setup"),className:"rounded-2xl",children:"Setup"}):null,c.jsx(te,{variant:s==="history"?"default":"ghost",onClick:()=>r("history"),className:"rounded-2xl",children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:s==="generate"?"h-full":"hidden","aria-hidden":s!=="generate",children:c.jsx(gU,{locations:i,setLocations:o,venueType:a,setVenueType:l,templateKey:x,setTemplateKey:y,locationOptions:Bd,locationsQuery:Ud,timeOfDay:h,setTimeOfDay:f,timeOfDayDisabled:b,sideDisabled:k,side:p,setSide:w,timeOfDayOptions:FT,sideOptions:zT,venueTypeOptions:BT,templateOptions:Hd,templatesQuery:fi,templateThumbs:E,getTemplateKey:pr,defaultFrameConfig:Io,creativeDragActive:de,handleCreativeDragOver:lP,handleCreativeDragLeave:cP,handleCreativeDrop:uP,useNativeSelects:g_})}),s==="setup"?c.jsx("div",{className:"h-full",children:c.jsx(kU,{locations:i,setLocations:o,venueType:a,setVenueType:l,assetType:u,setAssetType:d,setTemplateKey:y,locationOptions:Bd,locationsQuery:Ud,assetTypeOptions:dm,assetTypesQuery:ko,timeOfDay:h,setTimeOfDay:f,timeOfDayDisabled:b,sideDisabled:k,side:p,setSide:w,timeOfDayOptions:CU,sideOptions:NU,venueTypeOptions:EU,editingTemplate:V,editingTemplateLoading:he,stopEditTemplate:G0,templatesOpen:Lt,setTemplatesOpen:ur,templateOptions:vc,templatesQuery:yc,templateThumbs:E,getTemplateKey:pr,startEditTemplate:D2,deleteTemplate:A2,setupPhoto:S,setSetupPhoto:j,handleSetupPhoto:tb,handleSetupDragOver:iP,handleSetupDragLeave:oP,handleSetupDrop:aP,setupDragActive:U,handleSetupPhotoClear:rP,framesJson:I,setFramesJson:A,setFramesJsonDirty:N,applyFramesJsonToCanvas:tP,buildFramesPayload:Ia,setupImageReady:tt,greenscreenOpen:Na,setGreenscreenOpen:am,greenscreenColor:De,setGreenscreenColor:J,greenscreenDetecting:K,colorTolerance:pe,setColorTolerance:ie,RangeField:Kn,handleGreenscreenDetect:nP,canDetectGreenscreen:Rn,hasActiveFrame:Ma,frameSettingsOpen:lm,setFrameSettingsOpen:Dr,setupFrameConfig:me,handleSetupFrameConfigChange:K2,FrameConfigControls:IU,previewOpen:Ld,setPreviewOpen:cm,testPreviewMode:bo,setTestPreviewMode:Ea,testPreviewImgRef:Hs,testPreviewUrlRef:Ws,previewImgRef:ft,drawPreview:xt,activeTestCreativeFile:q0,updateTestCreativeForActive:q2,generateTestPreview:sP,testPreviewing:gc,activeFrameIndex:oe,canvasRef:At,canvasWidth:Ph,canvasHeight:Rh,handleCanvasPointerDown:G2,handleCanvasPointerMove:Y2,handleCanvasPointerUp:Q2,handleCanvasWheel:$2,setupHint:be,handleZoomOut:z2,handleZoomIn:F2,handleFitToScreen:B2,zoomPercent:P2,pixelUpscale:Le,setPixelUpscale:we,setupError:O,setupMessage:L,addFrame:J2,resetCurrentFrame:Z2,saveSetup:R2,setupSaving:T,clearAllFrames:nb,currentPoints:le,frameCount:B,useNativeSelects:g_})}):null,c.jsx("div",{className:s==="history"?"h-full":"hidden","aria-hidden":s!=="history",children:c.jsx(SU,{enabled:ae})})]})]})})}function IU({config:t,onChange:e}){return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Kn,{label:"Brightness",value:t.brightness,min:50,max:200,suffix:"%",onChange:n=>e("brightness",n)}),c.jsx(Kn,{label:"Contrast",value:t.contrast,min:50,max:200,suffix:"%",onChange:n=>e("contrast",n)}),c.jsx(Kn,{label:"Saturation",value:t.saturation,min:0,max:200,suffix:"%",onChange:n=>e("saturation",n)}),c.jsx(Kn,{label:"Image Blur",value:t.imageBlur,min:0,max:20,onChange:n=>e("imageBlur",n),helper:"Blur entire creative (0 = off)."}),c.jsx(Kn,{label:"Edge Blur",value:t.edgeBlur,min:1,max:20,suffix:"px",onChange:n=>e("edgeBlur",n),helper:"Edge blur amount (1 = off)."}),c.jsx(Kn,{label:"Overlay Opacity",value:t.overlayOpacity,min:0,max:50,suffix:"%",onChange:n=>e("overlayOpacity",n),helper:"Billboard overlay strength."}),c.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsx(DU,{value:t.lightDirection,onChange:n=>e("lightDirection",n)}),c.jsx(Kn,{label:"Depth Perception",value:t.depthMultiplier,min:5,max:30,suffix:"x",onChange:n=>e("depthMultiplier",n),helper:"Perspective compensation."})]}),c.jsx(Kn,{label:"Shadow Intensity",value:t.shadowIntensity,min:0,max:100,suffix:"%",onChange:n=>e("shadowIntensity",n),helper:"Edge darkening."}),c.jsx(Kn,{label:"Lighting Match",value:t.lightingAdjustment,min:-50,max:50,suffix:"%",onChange:n=>e("lightingAdjustment",n),helper:"Brightness matching."}),c.jsx(Kn,{label:"Color Temperature",value:t.colorTemperature,min:-50,max:50,onChange:n=>e("colorTemperature",n),helper:"Warm/cool shift."}),c.jsx(Kn,{label:"Vignette",value:t.vignette,min:0,max:100,suffix:"%",onChange:n=>e("vignette",n),helper:"Corner darkening."}),c.jsx(Kn,{label:"Edge Smoother",value:t.edgeSmoother,min:1,max:20,suffix:"x",onChange:n=>e("edgeSmoother",n),helper:"Higher = softer edges."}),c.jsx(Kn,{label:"Sharpening",value:t.sharpening,min:0,max:100,suffix:"%",onChange:n=>e("sharpening",n),helper:"Unsharp mask strength (0 = off)."})]})}function DU({value:t,onChange:e}){return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:["Light Direction: ",AU[t]||"Top"]}),c.jsx("div",{className:"grid grid-cols-3 gap-2 w-[150px]",children:UT.map(n=>c.jsx("button",{type:"button",onClick:()=>e(n.value),className:`rounded-lg border px-2 py-2 text-sm font-semibold ${t===n.value?"border-black/40 dark:border-white/50 bg-black/5 dark:bg-white/15 text-black dark:text-white":"border-black/10 dark:border-white/20 bg-white/80 dark:bg-black/40 text-black/70 dark:text-white/80"}`,title:n.label,children:n.glyph},n.value))})]})}function Kn({label:t,value:e,min:n,max:s,step:r=1,suffix:i="",helper:o,onChange:a}){return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-xs font-semibold text-black/70 dark:text-white/70",children:[t,": ",e,i]}),c.jsx("input",{type:"range",min:n,max:s,step:r,value:e,onChange:l=>a(Number(l.target.value)),style:{background:OU(e,n,s)},className:"w-full accent-black"}),o?c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:o}):null]})}function pr(t){return`${t.storage_key||""}::${t.photo}::${t.time_of_day||"all"}::${t.side||"all"}`}function LU(t,{color:e,tolerance:n,depthMultiplier:s,existingFrames:r}){const i=t.data,o=t.width,a=t.height,l=parseInt(e.slice(1,3),16),u=parseInt(e.slice(3,5),16),d=parseInt(e.slice(5,7),16),h=n,f=new Uint8Array(o*a);r.forEach(O=>{const $=O.points;for(let I=0;I<a;I+=1)for(let A=0;A<o;A+=1)$U(A,I,$)&&(f[I*o+A]=1)});const p=new Uint8Array(o*a);let w=0;for(let O=0;O<a;O+=1)for(let $=0;$<o;$+=1){const I=O*o+$;if(f[I]===1)continue;const A=I*4,W=i[A],N=i[A+1],E=i[A+2];Math.sqrt((W-l)**2+(N-u)**2+(E-d)**2)<=h&&(p[I]=255,w+=1)}if(w<1e3)return null;const x=new Uint8Array(o*a),y=3;for(let O=0;O<a;O+=1)for(let $=0;$<o;$+=1){const I=O*o+$;let A=!1;for(let W=-y;W<=y;W+=1){for(let N=-y;N<=y;N+=1){const E=O+W,F=$+N;if(E>=0&&E<a&&F>=0&&F<o&&p[E*o+F]===255){A=!0;break}}if(A)break}x[I]=A?255:0}const g=[];for(let O=1;O<a-1;O+=1)for(let $=1;$<o-1;$+=1){const I=O*o+$;x[I]===0&&(x[I-1]===255||x[I+1]===255||x[I-o]===255||x[I+o]===255||x[I-o-1]===255||x[I-o+1]===255||x[I+o-1]===255||x[I+o+1]===255)&&g.push([$,O])}if(g.length<4)return null;let m=g[0],b=g[0],k=g[0],_=g[0];g.forEach(O=>{const[$,I]=O;$+I<m[0]+m[1]&&(m=O),$-I>b[0]-b[1]&&(b=O),$+I>k[0]+k[1]&&(k=O),$-I<_[0]-_[1]&&(_=O)});const C=Math.abs(b[0]-m[0]),S=Math.abs(k[0]-_[0]),j=Math.abs(_[1]-m[1]),T=Math.abs(k[1]-b[1]),P=C/S,L=j/T,D=s||Io.depthMultiplier;if(P>1.1){const O=Math.floor((P-1)*D);_=[_[0],Math.min(a-1,_[1]+O)],k=[k[0],Math.min(a-1,k[1]+O)]}else if(P<.9){const O=Math.floor((1/P-1)*D);m=[m[0],Math.max(0,m[1]-O)],b=[b[0],Math.max(0,b[1]-O)]}if(L>1.1){const O=Math.floor((L-1)*D);b=[Math.min(o-1,b[0]+O),b[1]],k=[Math.min(o-1,k[0]+O),k[1]]}else if(L<.9){const O=Math.floor((1/L-1)*D);m=[Math.max(0,m[0]-O),m[1]],_=[Math.max(0,_[0]-O),_[1]]}return[m,b,k,_]}function $U(t,e,n){let s=!1;for(let r=0,i=n.length-1;r<n.length;i=r++){const o=n[r][0],a=n[r][1],l=n[i][0],u=n[i][1];a>e!=u>e&&t<(l-o)*(e-a)/(u-a)+o&&(s=!s)}return s}function FU(t){if(!t)return"";const e=String(t).trim();if(!e)return"";if(e.includes("/"))return e;const n=e.split("-");if(n.length===3){const[s,r,i]=n;if(s&&r&&i)return`${i}/${r}/${s}`}return e}function y_(t){const e=Number.parseInt(t,10),n=Number.isFinite(e)&&e>0?e:1;return`${n} ${n===1?"Week":"Weeks"}`}function Ah(t,e){const n=e;if(t==null||t==="")return`${n} 0`;const s=typeof t=="string"?t.trim():t;if(typeof s=="string"&&s.toUpperCase().startsWith(n))return s;const r=typeof s=="number"?s:Number.parseFloat(String(s).replace(/,/g,""));return Number.isFinite(r)?`${n} ${r.toLocaleString()}`:`${n} 0`}function v_(t){if(t==null)return 0;const e=Number.parseFloat(String(t).replace(/[^\d.-]/g,""));return Number.isFinite(e)?e:0}function zU(){const t=Or(),[e,n]=v.useState(""),s=()=>({id:crypto.randomUUID(),startDate:"",duration:"",netRate:""}),r=()=>({id:crypto.randomUUID(),location:"",spots:"1",productionFee:"",periods:[s()]}),[i,o]=v.useState(()=>[r()]),[a,l]=v.useState("separate"),[u,d]=v.useState(""),[h,f]=v.useState("AED"),[p,w]=v.useState("100% upfront"),[x,y]=v.useState([]),[g,m]=v.useState({}),b=en({queryKey:["locations","proposals"],queryFn:()=>fB({service:"proposals"})}),k=v.useMemo(()=>{const I=b.data;return Array.isArray(I)?I:(I==null?void 0:I.locations)||(I==null?void 0:I.data)||[]},[b.data]),_=v.useMemo(()=>Array.from(new Set(i.map(I=>I.location).filter(Boolean))),[i]);v.useEffect(()=>{if(!_.length)return;const I=_.filter(W=>!g[W]);if(!I.length)return;let A=!0;return(async()=>{const W=await Promise.all(I.map(async N=>{try{const E=await pB(N);return[N,E]}catch{return[N,null]}}));A&&m(N=>{const E={...N};return W.forEach(([F,V])=>{V&&(E[F]=V)}),E})})(),()=>{A=!1}},[_,g]);const C=_M({mutationFn:I=>mB(I),onSuccess:()=>{t.invalidateQueries({queryKey:["proposals","history"]})}});function S(I,A,W){o(N=>N.map(E=>E.id===I?{...E,[A]:W}:E))}function j(I,A,W,N){o(E=>E.map(F=>F.id!==I?F:{...F,periods:F.periods.map(V=>V.id===A?{...V,[W]:N}:V)}))}function T(){o(I=>[...I,r()])}function P(I){o(A=>A.length>1?A.filter(W=>W.id!==I):A)}function L(I){o(A=>A.map(W=>W.id===I?{...W,periods:[...W.periods,s()]}:W))}function D(I,A){o(W=>W.map(N=>N.id!==I||N.periods.length<=1?N:{...N,periods:N.periods.filter(E=>E.id!==A)}))}function O(){const I=h||"AED",A=Ah(u,I),W=i.filter(H=>H.location),N=W.map(H=>{const he=H.periods.filter(K=>K.startDate||K.duration||K.netRate),ee=a==="combined"?[he[0]||H.periods[0]]:he,U=ee.map(K=>FU((K==null?void 0:K.startDate)||"")),Q=ee.map(K=>y_(K==null?void 0:K.duration)),de=ee.map(K=>Ah(K==null?void 0:K.netRate,I)),Z=Number.parseInt(H.spots,10),be=Number.isFinite(Z)&&Z>0?Z:1,Ae=g[H.location]||{},me=Ae.location||Ae,fe=(me.display_type||me.displayType||"").toLowerCase()==="static",De=me.upload_fee??me.uploadFee??0,J=me.production_fee??me.productionFee??0,pe=H.productionFee,ie={location:H.location||"",upload_fee:Ah(De,I),spots:be};return fe&&(ie.production_fee=Ah(pe!==""&&pe!==null&&pe!==void 0?pe:J,I)),a==="combined"?(ie.start_date=U[0]||"",ie.duration=Q[0]||y_(1)):(ie.start_dates=U,ie.durations=Q,ie.net_rates=de),ie}),E=W.map(H=>{const he=k.find(ee=>(ee.location_key||ee.key||ee.id)===H.location);return(he==null?void 0:he.display_name)||(he==null?void 0:he.name)||(he==null?void 0:he.label)||H.location}).filter(Boolean).join(", "),F={proposals:N,client_name:e,proposal_type:a,payment_terms:p||"100% upfront",currency:I};a==="combined"&&(F.combined_net_rate=A);const V={client:e,packageType:a,items:N.map(H=>({location:H.location,netRatesValue:Array.isArray(H.net_rates)?H.net_rates.map(v_):[]})),combinedNetRateValue:a==="combined"?v_(A):0,locationsLabel:E,currency:I,paymentTerms:p||"100% upfront"};C.mutate(F,{onSuccess:H=>{y(he=>[{data:H,meta:V},...he].slice(0,3))}})}function $(){n(""),o([r()]),l("separate"),d(""),f("AED"),w("100% upfront")}return{client:e,setClient:n,items:i,updateItem:S,addItem:T,removeItem:P,addPeriod:L,removePeriod:D,updatePeriod:j,packageType:a,setPackageType:l,combinedNetRate:u,setCombinedNetRate:d,currency:h,setCurrency:f,paymentTerms:p,setPaymentTerms:w,lastResults:x,locationsQuery:b,locationOptions:k,generateMutation:C,handleGenerate:O,resetForm:$}}function BU(){const t=zU();return c.jsx(UU,{...t})}function UU({client:t,setClient:e,items:n,updateItem:s,addItem:r,removeItem:i,addPeriod:o,removePeriod:a,updatePeriod:l,packageType:u,setPackageType:d,combinedNetRate:h,setCombinedNetRate:f,currency:p,setCurrency:w,paymentTerms:x,setPaymentTerms:y,lastResults:g,locationsQuery:m,locationOptions:b,generateMutation:k,handleGenerate:_,resetForm:C}){var D;const S=Array.isArray(g)?g:[],j=k.isPending,T=v.useMemo(()=>{const O=b.map($=>{const I=$.location_key||$.key||$.id||"",A=$.display_name||$.name||$.label||I||"";return{value:I,label:A}}).filter($=>$.value);return[{value:"",label:"Select a location"},...O]},[b]),P=v.useMemo(()=>[{value:"separate",label:"Separate"},{value:"combined",label:"Combined"}],[]),L=v.useMemo(()=>[{value:"AED",label:"AED"},{value:"EUR",label:"EUR"},{value:"USD",label:"USD"},{value:"GBP",label:"GBP"}],[]);return c.jsxs(bt,{className:"h-full flex flex-col",children:[c.jsx(Bt,{className:"flex flex-row items-center justify-between",children:c.jsx(Yt,{children:"Generate Proposal"})}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Client",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:t,onChange:O=>e(O.target.value),placeholder:"Client name"})}),c.jsx(Se,{label:"Package Type",children:c.jsx(at,{value:u,options:P,onChange:d})})]}),u==="combined"?c.jsx(Se,{label:"Combined Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:h,onChange:O=>f(O.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Locations"}),m.isLoading?c.jsx("div",{className:"mt-1 text-xs text-black/50 dark:text-white/60",children:c.jsx(Ye,{text:"Loading locations"})}):null]}),c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:r,children:"Add Location"})]}),c.jsx("div",{className:"space-y-3",children:n.map(O=>{var A,W;const $=b.find(N=>(N.location_key||N.key||N.id)===O.location),I=(($==null?void 0:$.display_type)||"").toLowerCase()==="static";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[u==="combined"?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1.4fr_0.6fr_0.9fr_0.7fr_auto] gap-2 items-end",children:[c.jsx(Se,{label:"Location",children:c.jsx(at,{value:O.location,options:T,onChange:N=>s(O.id,"location",N)})}),c.jsx(Se,{label:"Spots",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.spots,onChange:N=>s(O.id,"spots",N.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Se,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((A=O.periods[0])==null?void 0:A.startDate)||"",onChange:N=>{var E;return l(O.id,(E=O.periods[0])==null?void 0:E.id,"startDate",N.target.value)},type:"date"})}),c.jsx(Se,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:((W=O.periods[0])==null?void 0:W.duration)||"",onChange:N=>{var E;return l(O.id,(E=O.periods[0])==null?void 0:E.id,"duration",N.target.value)},type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(O.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ia,{size:16})})]}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 items-end",children:[c.jsx(Se,{label:"Location",children:c.jsx(at,{value:O.location,options:T,onChange:N=>s(O.id,"location",N)})}),c.jsxs("div",{className:"flex items-end justify-between gap-2",children:[c.jsx(Se,{label:"Spots",className:"flex-1",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.spots,onChange:N=>s(O.id,"spots",N.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>i(O.id),disabled:n.length===1,title:"Remove location",children:c.jsx(ia,{size:16})})]})]}),I?c.jsx(Se,{label:"Production Fee",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:O.productionFee,onChange:N=>s(O.id,"productionFee",N.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}):null,u!=="combined"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/60",children:"Line Items"}),c.jsx(te,{variant:"secondary",size:"sm",className:"rounded-xl",onClick:()=>o(O.id),children:"Add Line Item"})]}),c.jsx("div",{className:"space-y-2",children:O.periods.map(N=>c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_1fr_1fr_auto] gap-2 items-end",children:[c.jsx(Se,{label:"Start Date",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:N.startDate,onChange:E=>l(O.id,N.id,"startDate",E.target.value),type:"date"})}),c.jsx(Se,{label:"Duration (weeks)",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:N.duration,onChange:E=>l(O.id,N.id,"duration",E.target.value),type:"number",min:"1",step:"1",placeholder:"1"})}),c.jsx(Se,{label:"Net Rate",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:N.netRate,onChange:E=>l(O.id,N.id,"netRate",E.target.value),type:"number",min:"0",step:"0.01",placeholder:"0"})}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-xl h-10 w-10",onClick:()=>a(O.id,N.id),disabled:O.periods.length===1,title:"Remove dates",children:c.jsx(ia,{size:16})})]},N.id))})]}):null]},O.id)})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Currency",children:c.jsx(at,{value:p,options:L,onChange:w})}),c.jsx(Se,{label:"Payment Terms",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:x,onChange:O=>y(O.target.value),placeholder:"Payment terms"})})]}),k.isError?c.jsx("div",{className:"rounded-xl bg-red-50/70 text-red-700 px-4 py-2 text-sm dark:bg-red-500/10 dark:text-red-300",children:((D=k.error)==null?void 0:D.message)||"Generation failed"}):null,c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(te,{className:"rounded-2xl",onClick:_,disabled:j,children:j?c.jsx(Ye,{text:"Generating Proposal"}):"Generate Proposal"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:C,disabled:j,children:"Reset"})]}),c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 p-4 space-y-3",children:[!S.length&&!j?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Result will appear here"}):null,j?c.jsx(Ye,{text:"Processing proposal",className:"text-sm text-black/60 dark:text-white/65"}):null,S.length?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Last 3 Generated Proposals"}),c.jsx("div",{className:"space-y-4",children:S.map((O,$)=>{const I=(O==null?void 0:O.data)||null,A=(O==null?void 0:O.meta)||null,W=[];I!=null&&I.pptx_url&&W.push({url:I.pptx_url,type:"pptx"}),I!=null&&I.pdf_url&&W.push({url:I.pdf_url,type:"pdf"});const N=(I==null?void 0:I.locations)||(A==null?void 0:A.locationsLabel)||"",E=(A==null?void 0:A.packageType)==="combined"?A==null?void 0:A.combinedNetRateValue:((A==null?void 0:A.items)||[]).reduce((V,H)=>{const he=Array.isArray(H.netRatesValue)?H.netRatesValue:[];return V+he.reduce((ee,U)=>ee+(U||0),0)},0),F=Number.isFinite(E)?`${(A==null?void 0:A.currency)||"AED"} ${Number(E).toLocaleString()}`:"";return c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-black/65 dark:text-white/65",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Client"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(A==null?void 0:A.client)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Package"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:(A==null?void 0:A.packageType)||""})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 sm:col-span-2",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Locations"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:N})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"uppercase tracking-wide text-black/45 dark:text-white/50",children:"Total Amount"}),c.jsx("span",{className:"font-semibold text-black/80 dark:text-white/85",children:F})]})]}),W.length?c.jsx("div",{className:"space-y-2",children:W.map(V=>{const H=HU(V.url),he=WU(H),ee=V.type==="pdf"?"proposal.pdf":"proposal.pptx",U=he||ee,Q=V.type==="pdf";return c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:Q?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Vv,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:"PPTX"})}),c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:U})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:H,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(io,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:de=>{de.preventDefault(),b_(H,U)},onKeyDown:de=>{(de.key==="Enter"||de.key===" ")&&(de.preventDefault(),b_(H,U))},className:"inline-flex items-center",children:[c.jsx(pa,{size:14,className:"mr-1"}),"Download"]})})]})]})},`${V.type}-${V.url}`)})}):c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:"No files returned yet."})]},`proposal-output-${$}`)})})]}):null]})]})]})}function HU(t){return t?t.startsWith("http")?t:`${ac.API_BASE_URL}${t}`:""}function WU(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function b_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function vo({className:t,placeholder:e="Search...",...n}){return c.jsx("input",{type:"text",placeholder:e,className:Te("rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",t),...n})}function VU(){const{user:t}=oi(),[e,n]=v.useState({}),[s,r]=v.useState(!1),i=en({queryKey:["proposals","history"],queryFn:gB}),o=v.useMemo(()=>{var h;return Array.isArray(i.data)?i.data:(h=i.data)!=null&&h.proposals?i.data.proposals:i.data||[]},[i.data]),a=v.useMemo(()=>_d(t),[t]),l=v.useMemo(()=>{const h=o||[];if(a)return h;const f=(t==null?void 0:t.id)||(t==null?void 0:t.user_id)||(t==null?void 0:t.email)||"";return f?h.filter(p=>(p.submitted_by||p.user_id||"")===f):h},[o,a,t==null?void 0:t.id,t==null?void 0:t.user_id,t==null?void 0:t.email]),u=v.useMemo(()=>{const h=new Set;return(l||[]).forEach(f=>{const p=f.submitted_by||f.user_id;p&&h.add(p)}),Array.from(h)},[l]),d=v.useMemo(()=>u.filter(h=>!e[h]),[u,e]);return v.useEffect(()=>{if(!d.length)return;r(!0);let h=!0;return(async()=>{const f=await Promise.all(d.map(async p=>{var w,x;try{const y=await yB(p),g=(y==null?void 0:y.name)||((w=y==null?void 0:y.user)==null?void 0:w.name)||((x=y==null?void 0:y.profile)==null?void 0:x.name)||p;return[p,g]}catch{return[p,p]}}));h&&(n(p=>{const w={...p};return f.forEach(([x,y])=>{w[x]||(w[x]=y)}),w}),r(!1))})(),()=>{h=!1}},[d]),v.useEffect(()=>{d.length||r(!1)},[d.length]),{historyQuery:i,userNamesLoading:s,visibleProposals:l,userNameById:e}}function qU(){const t=VU();return c.jsx(KU,{...t})}function KU({historyQuery:t,userNamesLoading:e,visibleProposals:n,userNameById:s}){const[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),d=v.useMemo(()=>(n||[]).map((y,g)=>{var P;const m=y.client_name||y.client||"Proposal",b=y.submitted_by||y.user_id||"",k=b?s[b]||b:"",_=y.date_generated||y.created_at,C=y.package_type||"",S=y.locations||((P=y.proposal_data)==null?void 0:P.locations_text)||y.location||"",j=y.total_amount||(y.total_amount_value!=null?`${y.currency||""} ${Number(y.total_amount_value).toLocaleString()}`:""),T=[];return y.pptx_url&&T.push({url:y.pptx_url,type:"pptx"}),y.pdf_url&&T.push({url:y.pdf_url,type:"pdf"}),!T.length&&y.file_url&&T.push({url:y.file_url,type:"pdf"}),{id:y.id||y.file_url||g,clientName:m,userName:k,generatedAt:_,packageType:C,locationText:S,totalAmount:j,fileEntries:T}}),[n,s]),h=v.useMemo(()=>{const y=new Set;return d.forEach(g=>{g.packageType&&g.packageType!==""&&y.add(g.packageType)}),Array.from(y)},[d]),f=v.useMemo(()=>{const y=new Set;return d.forEach(g=>{!g.locationText||g.locationText===""||g.locationText.split(",").forEach(m=>{const b=m.trim();b&&y.add(b)})}),Array.from(y)},[d]),p=v.useMemo(()=>[{value:"",label:"All packages"},...h.map(y=>({value:y,label:y}))],[h]),w=v.useMemo(()=>[{value:"",label:"All locations"},...f.map(y=>({value:y,label:y}))],[f]),x=v.useMemo(()=>{const y=l.trim().toLowerCase();return d.filter(g=>!(r&&g.packageType!==r||o&&!(g.locationText||"").split(",").map(b=>b.trim()).filter(Boolean).includes(o)||y&&!`${g.clientName} ${g.locationText}`.toLowerCase().includes(y)))},[d,r,o,l]);return c.jsxs(bt,{className:"h-full flex flex-col",children:[c.jsx(Bt,{className:"space-y-2",children:c.jsx(Yt,{children:"History"})}),c.jsx(Ut,{className:"flex-1 min-h-0 flex flex-col",children:t.isLoading||e?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):n!=null&&n.length?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(vo,{value:l,onChange:y=>u(y.target.value),className:"w-full sm:w-[260px]",placeholder:"Search..."}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(at,{value:r,options:p,onChange:i,className:"sm:w-[200px]"}),c.jsx(at,{value:o,options:w,onChange:a,className:"sm:w-[220px]"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full min-w-0 overflow-hidden",children:c.jsx("div",{className:"h-full w-full min-w-0 overflow-auto",children:c.jsxs("table",{className:"min-w-[760px] w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50 sticky top-0 z-10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Client"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Locations"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Amount"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"User"}),c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Generated"}),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:(x||[]).map(y=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[c.jsx("td",{className:"px-4 py-3 font-semibold",children:y.clientName}),c.jsx("td",{className:"px-4 py-3",children:y.locationText}),c.jsx("td",{className:"px-4 py-3",children:y.totalAmount}),c.jsx("td",{className:"px-4 py-3",children:y.userName}),c.jsx("td",{className:"px-4 py-3",children:y.generatedAt?new Date(y.generatedAt).toLocaleString():""}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:y.fileEntries.length?c.jsx("div",{className:"flex flex-col gap-2",children:y.fileEntries.map(g=>{const m=GU(g.url),b=YU(m),k=g.type==="pdf"?"proposal.pdf":"proposal.pptx",_=b||k;return c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wide text-black/50 dark:text-white/60",children:g.type}),c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(io,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:C=>{C.preventDefault(),w_(m,_)},onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),w_(m,_))},className:"inline-flex items-center",children:[c.jsx(pa,{size:14,className:"mr-1"}),"Download"]})})]},`${g.type}-${g.url}`)})}):c.jsx("span",{className:"text-xs text-black/50 dark:text-white/55",children:""})})]},y.id))})]})})}),x.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No matching proposals."})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No proposals yet."})})]})}function GU(t){return t?t.startsWith("http")?t:`${ac.API_BASE_URL}${t}`:""}function YU(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}async function w_(t,e){const s=await(await fetch(t)).blob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=e,document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(r.href),1e3)}function QU(){const[t,e]=v.useState("generate");return c.jsx("div",{className:"h-full min-h-0 flex flex-col",children:c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(te,{variant:t==="generate"?"default":"ghost",onClick:()=>e("generate"),className:"rounded-2xl",children:"Generate"}),c.jsx(te,{variant:t==="history"?"default":"ghost",onClick:()=>e("history"),className:"rounded-2xl",children:"History"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="generate"?"h-full":"hidden","aria-hidden":t!=="generate",children:c.jsx(BU,{})}),c.jsx("div",{className:t==="history"?"h-full":"hidden","aria-hidden":t!=="history",children:c.jsx(qU,{})})]})]})})}function HT(t){return t?typeof t=="string"?t:t.name||t.id||t.value||"":""}function WT(t){return t?typeof t=="string"?t:t.name||t.value||t.permission||"":""}function Sg(t,e){if(!t||!e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function XU(t){const e=new Map;return(t||[]).forEach(n=>{const s=HT(n);if(!s)return;const r=(n.permissions||n.permission_list||n.permissionList||[]).map(WT).filter(Boolean);e.set(s,new Set(r))}),e}function JU(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permission_sets||n.permissionSets||n.permission_set_names||[]).map(HT).filter(Boolean);e.set(s,new Set(r))}),e}function ZU(t){const e=new Map;return(t||[]).forEach(n=>{const s=n.name||n.id;if(!s)return;const r=(n.permissions||[]).map(WT).filter(Boolean);e.set(s,new Set(r))}),e}function eH({q:t,setQ:e,openNewUserModal:n,usersQuery:s,users:r,user:i,selectUser:o,setConfirmDelete:a,companyLookup:l,userCompanyFilter:u,setUserCompanyFilter:d,userProfileFilter:h,setUserProfileFilter:f,companyFilterOptions:p,profileFilterOptions:w}){const x=v.useMemo(()=>[{value:"",label:"All companies"},...p.map(m=>({...m}))],[p]),y=v.useMemo(()=>[{value:"",label:"All profiles"},...w.map(m=>({...m}))],[w]),g=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Users"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(vo,{value:t,onChange:m=>e(m.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:n,children:"Add user"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(at,{value:u,options:x,onChange:d}),c.jsx(at,{value:h,options:y,onChange:f})]})]});return c.jsxs(bt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Bt,{className:"hidden md:block space-y-2",children:g}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:g}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map(m=>{var P,L,D,O;const b=Array.isArray(m.profiles)?m.profiles.map($=>($==null?void 0:$.display_name)||($==null?void 0:$.name)||$).filter(Boolean):[((P=m.profiles)==null?void 0:P.display_name)||((L=m.profiles)==null?void 0:L.name)||m.profile||m.profile_name].filter(Boolean),k=b.length?b.length>2?`${b[0]}, +${b.length-1}`:b.join(", "):"",_=!!(m.id&&(i!=null&&i.id)&&m.id===i.id||m.user_id&&(i!=null&&i.user_id)&&m.user_id===i.user_id||m.email&&(i!=null&&i.email)&&m.email===i.email),C=m.is_active??m.isActive??m.active,S=typeof C=="boolean",j=S?C:!0,T=j?"Deactivate":"Reactivate";return c.jsxs(Dt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("div",{className:"text-base font-semibold",children:m.name||""}),S&&!j?c.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-semibold text-red-700 dark:bg-red-500/20 dark:text-red-200",children:"Inactive"}):null]}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:m.email})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(En,{onClick:()=>o(m),title:"Edit user","aria-label":"Edit user",children:c.jsx(wd,{size:16})}),c.jsx(En,{variant:"ghost",onClick:()=>a({open:!0,type:"user",payload:{id:m.id||m.user_id,isActive:j},label:`${T} user "${m.email}"?`}),disabled:_,title:_?"You cannot deactivate yourself":`${T} user`,"aria-label":`${T} user`,className:j?void 0:"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300",children:j?c.jsx(HM,{size:16}):c.jsx(UM,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Profiles: ",c.jsx("span",{className:"font-semibold",children:k})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:["Company:"," ",c.jsx("span",{className:"font-semibold",children:((D=m.company)==null?void 0:D.name)||l.get(((O=m.company)==null?void 0:O.code)||m.company_code||m.company_id)||""})]})]},m.id||m.user_id||m.email)})})})]})]})}function tH({q:t,setQ:e,usersQuery:n,users:s,user:r,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h,companyList:f,profileOptions:p,profileValues:w,permissionSetList:x,permissionSetValues:y,permissionList:g,permissionsQuery:m,page:b}){const{selectedUser:k,setSelectedUser:_,userForm:C,setUserForm:S,userModalOpen:j,setUserModalOpen:T,userModalLoading:P,setUserModalLoading:L,userModalMode:D,setUserModalMode:O,userProfilesOpen:$,setUserProfilesOpen:I,userPermissionSetsOpen:A,setUserPermissionSetsOpen:W,userPermissionsOpen:N,setUserPermissionsOpen:E,savingUser:F,setPermissionsMessage:V,selectUser:H,openNewUserModal:he,saveUser:ee,deleteUser:U,selectedUserProfiles:Q,selectedUserPermissionSets:de,selectedUserPermissions:Z,selectedUserPermissionSet:be,customUserPermissions:Ae,toggleUserPermission:me,selectAllUserPermissions:fe,clearUserPermissions:De,toggleUserProfile:J,selectAllUserProfiles:pe,clearUserProfiles:ie,toggleUserPermissionSet:K,selectAllUserPermissionSets:G,clearUserPermissionSets:le}=nH({permissionList:g,profileValues:w,permissionSetValues:y,profileOptions:p,permissionSetList:x}),[Y,B]=v.useState({open:!1,type:"",payload:null,label:""}),xe=!!(k&&(k.id&&(r!=null&&r.id)&&k.id===(r==null?void 0:r.id)||k.user_id&&(r!=null&&r.user_id)&&k.user_id===(r==null?void 0:r.user_id)||k.email&&(r!=null&&r.email)&&k.email===(r==null?void 0:r.email)));v.useEffect(()=>{_(null)},[b,_]);async function je(){if(!(!Y.open||!Y.payload))try{const Ce=Y.payload,Le=(Ce==null?void 0:Ce.id)??Ce;if(!Le||r!=null&&r.id&&Le===r.id||r!=null&&r.user_id&&Le===r.user_id)return;await U(Ce)}finally{B({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(eH,{q:t,setQ:e,openNewUserModal:he,usersQuery:n,users:s,user:r,selectUser:H,setConfirmDelete:B,companyLookup:i,userCompanyFilter:o,setUserCompanyFilter:a,userProfileFilter:l,setUserProfileFilter:u,companyFilterOptions:d,profileFilterOptions:h}),c.jsx(sH,{open:j,onClose:()=>{T(!1),_(null),V(""),L(!1),O("edit"),I(!1),W(!1),E(!1)},userModalLoading:P,userModalMode:D,selectedUser:k,userForm:C,setUserForm:S,companyList:f,profileOptions:p,profileValues:w,userProfilesOpen:$,setUserProfilesOpen:I,selectAllUserProfiles:pe,clearUserProfiles:ie,selectedUserProfiles:Q,toggleUserProfile:J,permissionSetList:x,permissionSetValues:y,userPermissionSetsOpen:A,setUserPermissionSetsOpen:W,selectAllUserPermissionSets:G,clearUserPermissionSets:le,selectedUserPermissionSets:de,toggleUserPermissionSet:K,userPermissionsOpen:N,setUserPermissionsOpen:E,selectedUserPermissions:Z,permissionList:g,permissionsQuery:m,selectedUserPermissionSet:be,toggleUserPermission:me,selectAllUserPermissions:fe,clearUserPermissions:De,customUserPermissions:Ae,isSelfUser:xe,setConfirmDelete:B,saveUser:ee,savingUser:F}),c.jsx(uc,{open:Y.open,message:Y.label,onClose:()=>B({open:!1,type:"",payload:null,label:""}),onConfirm:je})]})}function nH({permissionList:t,profileValues:e,permissionSetValues:n,profileOptions:s,permissionSetList:r}){const i=Or(),[o,a]=v.useState(null),[l,u]=v.useState({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,x]=v.useState("edit"),[y,g]=v.useState(!1),[m,b]=v.useState(!1),[k,_]=v.useState(!1),[C,S]=v.useState(!1),[j,T]=v.useState(""),P=v.useMemo(()=>new Set(l.profiles||[]),[l.profiles]),L=v.useMemo(()=>new Set(l.permissionSets||[]),[l.permissionSets]),D=v.useMemo(()=>yn(l.permissionsText),[l.permissionsText]),O=v.useMemo(()=>new Set(D),[D]),$=v.useMemo(()=>{if(!t.length)return D;const J=new Set(t);return D.filter(pe=>!J.has(pe))},[t,D]),I=v.useMemo(()=>XU(r),[r]),A=v.useMemo(()=>JU(s),[s]),W=v.useMemo(()=>ZU(s),[s]);function N(J,pe,ie){return(J||[]).filter(K=>{const G=pe.get(K);return G?Sg(G,ie):!0})}function E(J,pe,ie){const K=new Set(ie||[]);return(J||[]).filter(G=>{const le=W.get(G),Y=A.get(G);if(!le&&!Y)return!0;if(Y&&!Sg(Y,K))return!1;const B=new Set;return le&&le.forEach(xe=>B.add(xe)),Y&&Y.forEach(xe=>{const je=I.get(xe);je&&je.forEach(Ce=>B.add(Ce))}),Sg(B,pe)})}function F(J,pe){const ie=new Set(J.profiles||[]),K=new Set(J.permissionSets||[]),G=new Set(yn(J.permissionsText));return ie.forEach(le=>{const Y=A.get(le);Y&&Y.forEach(xe=>K.add(xe));const B=W.get(le);B&&B.forEach(xe=>G.add(xe)),Y&&Y.forEach(xe=>{const je=I.get(xe);je&&je.forEach(Ce=>G.add(Ce))})}),{...J,permissionSets:Array.from(K),permissionsText:Array.from(G).join(`
`)}}async function V(J){var G,le;a(J),T(""),x("edit"),h(!0),p(!0),g(!1),b(!1),_(!1);const pe=Array.isArray(J.profiles)?J.profiles.map(Y=>(Y==null?void 0:Y.name)||(Y==null?void 0:Y.id)||Y).filter(Boolean):[((G=J.profiles)==null?void 0:G.name)||J.profile||J.profile_name].filter(Boolean),ie=(J.permission_sets||J.permissionSets||J.permission_set_names||[]).map(Y=>typeof Y=="string"?Y:(Y==null?void 0:Y.name)||(Y==null?void 0:Y.id)).filter(Boolean);u({name:J.name||"",email:J.email||"",profiles:pe,permissionSets:ie,company:((le=J.company)==null?void 0:le.code)||J.company_code||J.company_id||"",is_active:J.is_active!==!1,permissionsText:""});const K=J.id||J.user_id;if(K)try{const Y=await vB(K),B=(Y==null?void 0:Y.permissions)??Y,xe=Array.isArray(B)?B.map(je=>typeof je=="string"?je:je==null?void 0:je.name).filter(Boolean):[];u(je=>F({...je,permissionsText:xe.join(`
`)}))}catch{}p(!1)}function H(){a(null),T(""),x("add"),p(!1),g(!1),b(!1),_(!1),u({name:"",email:"",profiles:[],permissionSets:[],company:"",is_active:!0,permissionsText:""}),h(!0)}async function he(){var G,le;if(w==="edit"&&!o)return;S(!0),T("");const J=(o==null?void 0:o.id)||(o==null?void 0:o.user_id);if(w==="edit"&&!J){S(!1),T("Missing user id");return}const pe=yn(l.permissionsText),ie=l.profiles||[],K={name:l.name,is_active:!!l.is_active,profile_names:ie,profile_name:ie[0]||null,permission_sets:l.permissionSets||[],company_code:l.company||null,...w==="add"?{email:l.email}:{}};try{if(w==="add"){const Y=await bB(K),B=(Y==null?void 0:Y.id)||(Y==null?void 0:Y.user_id)||((G=Y==null?void 0:Y.user)==null?void 0:G.id)||((le=Y==null?void 0:Y.user)==null?void 0:le.user_id);B!=null&&await zk(B,pe),T("User created")}else await wB(J,K),await zk(J,pe),T("User updated");i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch(Y){T((Y==null?void 0:Y.message)||"Failed to save user")}finally{S(!1)}}async function ee(J){const pe=(J==null?void 0:J.id)??J;if(pe)try{const ie=(J==null?void 0:J.isActive)??(J==null?void 0:J.is_active);(typeof ie=="boolean"?ie:!0)?await kB(pe):await _B(pe),i.invalidateQueries({queryKey:["admin","users"]}),h(!1),a(null)}catch{}}function U(J){u(pe=>{const ie=new Set(yn(pe.permissionsText)),K=ie.has(J);K?ie.delete(J):ie.add(J);let G=pe.permissionSets||[],le=pe.profiles||[];return K&&(G=N(G,I,ie),le=E(le,ie,G)),{...pe,permissionsText:Array.from(ie).join(`
`),permissionSets:G,profiles:le}})}function Q(){const J=new Set([...D,...t]);u(pe=>({...pe,permissionsText:Array.from(J).join(`
`)}))}function de(){u(J=>({...J,permissionsText:"",permissionSets:[],profiles:[]}))}function Z(J){u(pe=>{const ie=new Set(pe.profiles||[]),K=new Set(pe.permissionSets||[]),G=new Set(yn(pe.permissionsText));if(ie.has(J)){ie.delete(J);const xe=N(Array.from(K),I,G),je=E(Array.from(ie),G,xe);return{...pe,profiles:je,permissionSets:xe,permissionsText:Array.from(G).join(`
`)}}ie.add(J);const Y=A.get(J);Y&&Y.forEach(xe=>K.add(xe));const B=W.get(J);return B&&B.forEach(xe=>G.add(xe)),Y&&Y.forEach(xe=>{const je=I.get(xe);je&&je.forEach(Ce=>G.add(Ce))}),{...pe,profiles:Array.from(ie),permissionSets:Array.from(K),permissionsText:Array.from(G).join(`
`)}})}function be(){u(J=>{const pe=new Set([...J.profiles||[],...e]),ie=new Set(J.permissionSets||[]),K=new Set(yn(J.permissionsText));return pe.forEach(G=>{const le=A.get(G);le&&le.forEach(B=>ie.add(B));const Y=W.get(G);Y&&Y.forEach(B=>K.add(B)),le&&le.forEach(B=>{const xe=I.get(B);xe&&xe.forEach(je=>K.add(je))})}),{...J,profiles:Array.from(pe),permissionSets:Array.from(ie),permissionsText:Array.from(K).join(`
`)}})}function Ae(){u(J=>({...J,profiles:[]}))}function me(J){u(pe=>{const ie=new Set(pe.permissionSets||[]),K=new Set(yn(pe.permissionsText));if(ie.has(J)){ie.delete(J);const Y=E(pe.profiles||[],K,Array.from(ie));return{...pe,permissionSets:Array.from(ie),profiles:Y,permissionsText:Array.from(K).join(`
`)}}ie.add(J);const le=I.get(J);return le&&le.forEach(Y=>K.add(Y)),{...pe,permissionSets:Array.from(ie),permissionsText:Array.from(K).join(`
`)}})}function fe(){u(J=>{const pe=new Set([...J.permissionSets||[],...n]),ie=new Set(yn(J.permissionsText));return pe.forEach(K=>{const G=I.get(K);G&&G.forEach(le=>ie.add(le))}),{...J,permissionSets:Array.from(pe),permissionsText:Array.from(ie).join(`
`)}})}function De(){u(J=>{const pe=new Set(yn(J.permissionsText)),ie=E(J.profiles||[],pe,[]);return{...J,permissionSets:[],profiles:ie,permissionsText:Array.from(pe).join(`
`)}})}return{selectedUser:o,setSelectedUser:a,userForm:l,setUserForm:u,userModalOpen:d,setUserModalOpen:h,userModalLoading:f,setUserModalLoading:p,userModalMode:w,setUserModalMode:x,userProfilesOpen:y,setUserProfilesOpen:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:b,userPermissionsOpen:k,setUserPermissionsOpen:_,savingUser:C,permissionsMessage:j,setPermissionsMessage:T,selectUser:V,openNewUserModal:H,saveUser:he,selectedUserProfiles:P,selectedUserPermissionSets:L,selectedUserPermissions:D,selectedUserPermissionSet:O,customUserPermissions:$,toggleUserPermission:U,selectAllUserPermissions:Q,clearUserPermissions:de,toggleUserProfile:Z,selectAllUserProfiles:be,clearUserProfiles:Ae,toggleUserPermissionSet:me,selectAllUserPermissionSets:fe,clearUserPermissionSets:De,deleteUser:ee}}function sH({open:t,onClose:e,userModalLoading:n,userModalMode:s,selectedUser:r,userForm:i,setUserForm:o,companyList:a,profileOptions:l,profileValues:u,userProfilesOpen:d,setUserProfilesOpen:h,selectAllUserProfiles:f,clearUserProfiles:p,selectedUserProfiles:w,toggleUserProfile:x,permissionSetList:y,permissionSetValues:g,userPermissionSetsOpen:m,setUserPermissionSetsOpen:b,selectAllUserPermissionSets:k,clearUserPermissionSets:_,selectedUserPermissionSets:C,toggleUserPermissionSet:S,userPermissionsOpen:j,setUserPermissionsOpen:T,selectedUserPermissions:P,permissionList:L,permissionsQuery:D,selectedUserPermissionSet:O,toggleUserPermission:$,selectAllUserPermissions:I,clearUserPermissions:A,customUserPermissions:W,isSelfUser:N,setConfirmDelete:E,saveUser:F,savingUser:V}){const H=v.useMemo(()=>{const ee=a.map(U=>{const Q=U.code||U.id||"";return{value:Q,label:U.name||U.code||Q||""}}).filter(U=>U.value);return[{value:"",label:"Select company"},...ee]},[a]),he=v.useMemo(()=>[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],[]);return c.jsx(ws,{open:t,onClose:e,title:s==="add"?"Add user":"Edit user",maxWidth:"560px",children:n?c.jsx(Ye,{text:"Loading user",className:"text-sm text-black/60 dark:text-white/65"}):s==="add"||r?c.jsxs("div",{className:"space-y-3",children:[s==="edit"?c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/55",children:["Editing ",r==null?void 0:r.email]}):null,c.jsx(Se,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.name,onChange:ee=>o(U=>({...U,name:ee.target.value}))})}),c.jsx(Se,{label:"Email",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:i.email,onChange:ee=>o(U=>({...U,email:ee.target.value})),type:"email",disabled:s==="edit"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Company",children:c.jsx(at,{value:i.company||"",options:H,onChange:ee=>o(U=>({...U,company:ee}))})}),c.jsx(Se,{label:"Status",children:c.jsx(at,{value:i.is_active?"active":"inactive",options:he,onChange:ee=>o(U=>({...U,is_active:ee==="active"}))})})]}),c.jsx(Se,{label:"Profiles",children:c.jsxs(Dt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>h(ee=>!ee),"aria-expanded":d,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Profiles"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:wl(i.profiles.length,"profile")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:d?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",d&&"rotate-180")})]})]}),d?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!u.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!i.profiles.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[l.map(ee=>{const U=ee.name||ee.id;if(!U)return null;const Q=w.has(U);return c.jsxs("button",{type:"button",onClick:()=>x(U),className:Te("mmg-profile-option flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",Q?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee.display_name||ee.name||U}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",Q?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ra,{size:14,className:Q?"opacity-100":"opacity-0"})})]},U)}),l.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No profiles available."})]})]}):null]})}),c.jsx(Se,{label:"Permission Sets",children:c.jsxs(Dt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>b(ee=>!ee),"aria-expanded":m,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:wl(i.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:m?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",m&&"rotate-180")})]})]}),m?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:k,disabled:!g.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:_,disabled:!i.permissionSets.length,children:"Clear"})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:[y.map(ee=>{const U=ee.name||ee.id;if(!U)return null;const Q=C.has(U);return c.jsxs("button",{type:"button",onClick:()=>S(U),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",Q?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee.display_name||ee.name||U}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",Q?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ra,{size:14,className:Q?"opacity-100":"opacity-0"})})]},U)}),y.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]})]}):null]})}),c.jsx(Se,{label:"Permissions",children:c.jsxs(Dt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>T(ee=>!ee),"aria-expanded":j,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:wl(P.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:j?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",j&&"rotate-180")})]})]}),j?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:I,disabled:!L.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:A,disabled:!P.length,children:"Clear"})]})}),D.isLoading?c.jsx(Ye,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):L.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:L.map(ee=>{const U=O.has(ee);return c.jsxs("button",{type:"button",onClick:()=>$(ee),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",U?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:ee}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",U?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ra,{size:14,className:U?"opacity-100":"opacity-0"})})]},ee)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),W.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:W.map(ee=>c.jsxs("button",{type:"button",onClick:()=>$(ee),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:ee}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},ee))})]}):null]}):null]})}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[s==="edit"?c.jsx(te,{variant:"ghost",className:Te("rounded-2xl",typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"&&!((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))?"text-emerald-600 hover:text-emerald-700 dark:text-emerald-300":"text-red-600 hover:text-red-700 dark:text-red-300"),onClick:()=>E({open:!0,type:"user",payload:{id:(r==null?void 0:r.id)||(r==null?void 0:r.user_id),isActive:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active):!0},label:`${typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"} user "${r==null?void 0:r.email}"?`}),disabled:N,children:typeof((r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active))=="boolean"?(r==null?void 0:r.is_active)??(r==null?void 0:r.isActive)??(r==null?void 0:r.active)?"Deactivate":"Reactivate":"Deactivate"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:F,disabled:V,children:V?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Select a user to edit."})})}function rH({companySearch:t,setCompanySearch:e,openCompanyModal:n,companiesQuery:s,filteredCompanyList:r,companyLookup:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Companies"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(vo,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add company"})]})]});return c.jsxs(bt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Bt,{className:"hidden md:block space-y-2",children:a}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(Dt,{className:"p-4 space-y-2",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.name||l.code}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.code||""})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(En,{onClick:()=>n(l),title:"Edit company","aria-label":"Edit company",children:c.jsx(wd,{size:16})}),c.jsx(En,{variant:"ghost",onClick:()=>o({open:!0,type:"company",payload:l.code||l.id,label:`Delete company "${l.name||l.code}"?`}),title:"Delete company","aria-label":"Delete company",children:c.jsx(ia,{size:16})})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[l.country?c.jsx("span",{children:l.country}):null,l.currency?c.jsxs("span",{children:[" ",l.currency]}):null,l.timezone?c.jsxs("span",{children:[" ",l.timezone]}):null]}),c.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-black/55 dark:text-white/60",children:[c.jsxs("span",{children:["Parent: ",i.get(l.parent_id)||""]}),c.jsxs("span",{children:[" ",l.isgroup?"Group":"Company"]}),c.jsxs("span",{children:[" ",l.is_active===!1?"Inactive":"Active"]})]})]},l.code||l.id)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching companies.":"No companies available."})]})})]})]})}function iH({companySearch:t,setCompanySearch:e,companiesQuery:n,filteredCompanyList:s,companyLookup:r,companyList:i}){const{companyForm:o,setCompanyForm:a,editingCompany:l,setEditingCompany:u,companyModalOpen:d,setCompanyModalOpen:h,savingCompany:f,openCompanyModal:p,saveCompany:w,deleteCompany:x}=oH(),[y,g]=v.useState({open:!1,type:"",payload:null,label:""});async function m(){if(!(!y.open||!y.payload))try{await x(y.payload)}finally{g({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(rH,{companySearch:t,setCompanySearch:e,openCompanyModal:p,companiesQuery:n,filteredCompanyList:s,companyLookup:r,setConfirmDelete:g}),c.jsx(aH,{open:d,onClose:()=>{h(!1),u(null),a({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})},editingCompany:l,companyForm:o,setCompanyForm:a,companyList:i,setConfirmDelete:g,saveCompany:w,savingCompany:f}),c.jsx(uc,{open:y.open,message:y.label,onClose:()=>g({open:!1,type:"",payload:null,label:""}),onConfirm:m})]})}function oH(){const t=Or(),[e,n]=v.useState({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0}),[s,r]=v.useState(null),[i,o]=v.useState(!1),[a,l]=v.useState(!1);function u(f){f?(r(f.code||f.id),n({code:f.code||"",name:f.name||"",parent_id:f.parent_id??"",country:f.country??"",currency:f.currency??"",timezone:f.timezone??"",isgroup:!!f.isgroup,is_active:f.is_active!==!1})):(r(null),n({code:"",name:"",parent_id:"",country:"",currency:"",timezone:"",isgroup:!1,is_active:!0})),o(!0)}async function d(){if(!e.code.trim()||!e.name.trim())return;l(!0);const f={code:e.code.trim(),name:e.name.trim(),parent_id:e.parent_id||null,country:e.country||null,currency:e.currency||null,timezone:e.timezone||null,isgroup:!!e.isgroup,is_active:!!e.is_active};try{s?await RB(s,f):await PB(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}finally{l(!1)}}async function h(f){if(f)try{await AB(f),t.invalidateQueries({queryKey:["admin","companies"]}),o(!1),r(null)}catch{}}return{companyForm:e,setCompanyForm:n,editingCompany:s,setEditingCompany:r,companyModalOpen:i,setCompanyModalOpen:o,savingCompany:a,openCompanyModal:u,saveCompany:d,deleteCompany:h}}function aH({open:t,onClose:e,editingCompany:n,companyForm:s,setCompanyForm:r,companyList:i,setConfirmDelete:o,saveCompany:a,savingCompany:l}){const u=[{value:"",label:"None"},...i.filter(f=>(f.code||f.id)!==s.code).map(f=>{const p=f.code||f.id||"";return{value:p,label:f.name||f.code||p||""}}).filter(f=>f.value)],d=[{value:"company",label:"Company"},{value:"group",label:"Group"}],h=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return c.jsx(ws,{open:t,onClose:e,title:n?`Edit company: ${s.name||s.code}`:"Add company",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Code",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.code,onChange:f=>r(p=>({...p,code:f.target.value})),placeholder:"MMG-001",disabled:!!n})}),c.jsx(Se,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:f=>r(p=>({...p,name:f.target.value})),placeholder:"MMG Global"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Parent company",children:c.jsx(at,{value:s.parent_id||"",options:u,onChange:f=>r(p=>({...p,parent_id:f}))})}),c.jsx(Se,{label:"Country",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.country,onChange:f=>r(p=>({...p,country:f.target.value})),placeholder:"US"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Currency",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.currency,onChange:f=>r(p=>({...p,currency:f.target.value})),placeholder:"USD"})}),c.jsx(Se,{label:"Timezone",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.timezone,onChange:f=>r(p=>({...p,timezone:f.target.value})),placeholder:"America/New_York"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Type",children:c.jsx(at,{value:s.isgroup?"group":"company",options:d,onChange:f=>r(p=>({...p,isgroup:f==="group"}))})}),c.jsx(Se,{label:"Status",children:c.jsx(at,{value:s.is_active?"active":"inactive",options:h,onChange:f=>r(p=>({...p,is_active:f==="active"}))})})]}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(te,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>o({open:!0,type:"company",payload:n,label:`Delete company "${s.name||s.code}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:a,disabled:l,children:l?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]})})}function lH({profileSearch:t,setProfileSearch:e,openProfileModal:n,filteredProfileOptions:s,duplicateProfile:r,setConfirmDelete:i}){const o=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Profiles"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(vo,{value:t,onChange:a=>e(a.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add profile"})]})]});return c.jsxs(bt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Bt,{className:"hidden md:block space-y-2",children:o}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:o}),c.jsxs("div",{className:"space-y-4 p-5 pt-1",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.map(a=>c.jsxs(Dt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:a.display_name||a.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:a.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(En,{onClick:()=>r(a),title:"Duplicate profile","aria-label":"Duplicate profile",children:c.jsx(BC,{size:16})}),a.is_system?c.jsx("span",{className:"text-xs rounded-full px-2 py-0.5 bg-black/5 dark:bg-white/10",children:"System"}):c.jsxs(c.Fragment,{children:[c.jsx(En,{onClick:()=>n(a),title:"Edit profile","aria-label":"Edit profile",children:c.jsx(wd,{size:16})}),c.jsx(En,{variant:"ghost",onClick:()=>i({open:!0,type:"profile",payload:a.id||a.name,label:`Delete profile "${a.display_name||a.name}"?`}),title:"Delete profile","aria-label":"Delete profile",children:c.jsx(ia,{size:16})})]})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(a.permissions||[]).length," permission",(a.permissions||[]).length===1?"":"s"]}),a.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:a.description}):null]},a.id||a.name))}),s.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching profiles.":"No profiles available."})]})]})]})}function cH({profileSearch:t,setProfileSearch:e,filteredProfileOptions:n,permissionList:s,permissionSetValues:r,permissionSetList:i,permissionSetsQuery:o,permissionsQuery:a}){const{profileForm:l,setProfileForm:u,editingProfile:d,setEditingProfile:h,profileModalOpen:f,setProfileModalOpen:p,profileIsSystem:w,setProfileIsSystem:x,profilePermissionSetsOpen:y,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:b,savingProfile:k,openProfileModal:_,duplicateProfile:C,saveProfile:S,deleteProfile:j,selectedProfilePermissions:T,selectedProfilePermissionSet:P,selectedProfilePermissionSets:L,customProfilePermissions:D,toggleProfilePermission:O,selectAllProfilePermissions:$,clearProfilePermissions:I,toggleProfilePermissionSet:A,selectAllProfilePermissionSets:W,clearProfilePermissionSets:N}=uH({permissionList:s,permissionSetValues:r,permissionSetList:i}),[E,F]=v.useState({open:!1,type:"",payload:null,label:""});async function V(){if(!(!E.open||!E.payload))try{await j(E.payload)}finally{F({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(lH,{profileSearch:t,setProfileSearch:e,openProfileModal:_,filteredProfileOptions:n,duplicateProfile:C,setConfirmDelete:F}),c.jsx(dH,{open:f,onClose:()=>{p(!1),h(null),u({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),x(!1),g(!1),b(!1)},editingProfile:d,profileForm:l,setProfileForm:u,profileIsSystem:w,profilePermissionSetsOpen:y,setProfilePermissionSetsOpen:g,profilePermissionsOpen:m,setProfilePermissionsOpen:b,permissionSetValues:r,permissionSetsQuery:o,permissionSetList:i,selectedProfilePermissionSets:L,toggleProfilePermissionSet:A,selectAllProfilePermissionSets:W,clearProfilePermissionSets:N,selectedProfilePermissions:T,permissionList:s,permissionsQuery:a,selectedProfilePermissionSet:P,toggleProfilePermission:O,selectAllProfilePermissions:$,clearProfilePermissions:I,customProfilePermissions:D,setConfirmDelete:F,saveProfile:S,savingProfile:k}),c.jsx(uc,{open:E.open,message:E.label,onClose:()=>F({open:!1,type:"",payload:null,label:""}),onConfirm:V})]})}function uH({permissionList:t,permissionSetValues:e,permissionSetList:n}){const s=Or(),[r,i]=v.useState({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),[o,a]=v.useState(null),[l,u]=v.useState(!1),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,x]=v.useState(!1),[y,g]=v.useState(!1),m=v.useMemo(()=>yn(r.permissionsText),[r.permissionsText]),b=v.useMemo(()=>new Set(m),[m]),k=v.useMemo(()=>new Set(r.permissionSets||[]),[r.permissionSets]),_=v.useMemo(()=>{if(!t.length)return m;const N=new Set(t);return m.filter(E=>!N.has(E))},[t,m]),C=v.useMemo(()=>{const N=new Map;return(n||[]).forEach(E=>{const F=E.name||E.id;if(!F)return;const V=(E.permissions||E.permission_list||E.permissionList||[]).map(H=>typeof H=="string"?H:(H==null?void 0:H.name)||(H==null?void 0:H.value)||(H==null?void 0:H.permission)).filter(Boolean);N.set(F,new Set(V))}),N},[n]);function S(N,E){return(N||[]).filter(F=>{const V=C.get(F);if(!V)return!0;for(const H of V)if(!E.has(H))return!1;return!0})}function j(N){h(!!(N!=null&&N.is_system)),!(N!=null&&N.is_system)&&(p(!1),x(!1),N?(a(N.id||N.name),i({name:N.name,display_name:N.display_name||N.name,description:N.description||"",permissionsText:(N.permissions||[]).map(E=>typeof E=="string"?E:E==null?void 0:E.name).filter(Boolean).join(`
`),permissionSets:(N.permission_sets||N.permissionSets||N.permission_set_names||[]).map(E=>typeof E=="string"?E:(E==null?void 0:E.name)||(E==null?void 0:E.id)).filter(Boolean)})):(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!0))}function T(N){if(!N)return;const E=N.name||N.display_name||"profile",F=N.display_name||N.name||E;h(!1),a(null),p(!1),x(!1),i({name:`${E}_new`,display_name:`${F}_new`,description:N.description||"",permissionsText:(N.permissions||[]).map(V=>typeof V=="string"?V:V==null?void 0:V.name).filter(Boolean).join(`
`),permissionSets:(N.permission_sets||N.permissionSets||N.permission_set_names||[]).map(V=>typeof V=="string"?V:(V==null?void 0:V.name)||(V==null?void 0:V.id)).filter(Boolean)}),u(!0)}async function P(){if(r.name.trim()){g(!0);try{const N={name:r.name.trim(),display_name:r.display_name||r.name,description:r.description,permissions:yn(r.permissionsText),permission_sets:r.permissionSets||[]};o?await CB(o,N):await jB(N),s.invalidateQueries({queryKey:["admin","profiles"]}),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]}),a(null),u(!1)}catch{}finally{g(!1)}}}async function L(N){try{await NB(N),s.invalidateQueries({queryKey:["admin","profiles"]}),o===N&&(a(null),i({name:"",display_name:"",description:"",permissionsText:"",permissionSets:[]})),u(!1)}catch{}}function D(N){i(E=>{const F=new Set(yn(E.permissionsText)),V=F.has(N);V?F.delete(N):F.add(N);let H=E.permissionSets||[];return V&&(H=S(H,F)),{...E,permissionsText:Array.from(F).join(`
`),permissionSets:H}})}function O(){const N=new Set([...m,...t]);i(E=>({...E,permissionsText:Array.from(N).join(`
`)}))}function $(){i(N=>({...N,permissionsText:""}))}function I(N){i(E=>{const F=new Set(E.permissionSets||[]),V=new Set(yn(E.permissionsText));if(F.has(N))return F.delete(N),{...E,permissionSets:Array.from(F),permissionsText:Array.from(V).join(`
`)};F.add(N);const he=C.get(N);return he&&he.forEach(ee=>V.add(ee)),{...E,permissionSets:Array.from(F),permissionsText:Array.from(V).join(`
`)}})}function A(){i(N=>{const E=new Set([...N.permissionSets||[],...e]),F=new Set(yn(N.permissionsText));return E.forEach(V=>{const H=C.get(V);H&&H.forEach(he=>F.add(he))}),{...N,permissionSets:Array.from(E),permissionsText:Array.from(F).join(`
`)}})}function W(){i(N=>({...N,permissionSets:[]}))}return{profileForm:r,setProfileForm:i,editingProfile:o,setEditingProfile:a,profileModalOpen:l,setProfileModalOpen:u,profileIsSystem:d,setProfileIsSystem:h,profilePermissionSetsOpen:f,setProfilePermissionSetsOpen:p,profilePermissionsOpen:w,setProfilePermissionsOpen:x,savingProfile:y,openProfileModal:j,duplicateProfile:T,saveProfile:P,deleteProfile:L,selectedProfilePermissions:m,selectedProfilePermissionSet:b,selectedProfilePermissionSets:k,customProfilePermissions:_,toggleProfilePermission:D,selectAllProfilePermissions:O,clearProfilePermissions:$,toggleProfilePermissionSet:I,selectAllProfilePermissionSets:A,clearProfilePermissionSets:W}}function dH({open:t,onClose:e,editingProfile:n,profileForm:s,setProfileForm:r,profileIsSystem:i,profilePermissionSetsOpen:o,setProfilePermissionSetsOpen:a,profilePermissionsOpen:l,setProfilePermissionsOpen:u,permissionSetValues:d,permissionSetsQuery:h,permissionSetList:f,selectedProfilePermissionSets:p,toggleProfilePermissionSet:w,selectAllProfilePermissionSets:x,clearProfilePermissionSets:y,selectedProfilePermissions:g,permissionList:m,permissionsQuery:b,selectedProfilePermissionSet:k,toggleProfilePermission:_,selectAllProfilePermissions:C,clearProfilePermissions:S,customProfilePermissions:j,setConfirmDelete:T,saveProfile:P,savingProfile:L}){return c.jsx(ws,{open:t,onClose:e,title:n?`Edit profile: ${n}`:"Add profile",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:D=>r(O=>({...O,name:D.target.value})),placeholder:"system_admin",disabled:!!n})}),c.jsx(Se,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:D=>r(O=>({...O,display_name:D.target.value})),placeholder:"System Admin"})})]}),c.jsx(Se,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:D=>r(O=>({...O,description:D.target.value})),placeholder:"What this profile can do"})}),c.jsx(Se,{label:"Permission Sets",children:c.jsxs(Dt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>a(D=>!D),"aria-expanded":o,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permission sets"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:wl(s.permissionSets.length,"permission set","permission sets")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:o?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",o&&"rotate-180")})]})]}),o?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:x,disabled:!d.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:y,disabled:!s.permissionSets.length,children:"Clear"})]})}),h.isLoading?c.jsx(Ye,{text:"Loading permission sets",className:"text-sm text-black/60 dark:text-white/65"}):f.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:f.map(D=>{const O=D.name||D.id;if(!O)return null;const $=p.has(O);return c.jsxs("button",{type:"button",onClick:()=>w(O),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",$?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate text-xs font-medium",children:D.display_name||D.name||O}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",$?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ra,{size:14,className:$?"opacity-100":"opacity-0"})})]},O)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permission sets available."})]}):null]})}),c.jsx(Se,{label:"Permissions",children:c.jsxs(Dt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>u(D=>!D),"aria-expanded":l,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:wl(g.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:l?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",l&&"rotate-180")})]})]}),l?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:C,disabled:!m.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:S,disabled:!g.length,children:"Clear"})]})}),b.isLoading?c.jsx(Ye,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):m.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[110px] overflow-y-auto p-1",children:m.map(D=>{const O=k.has(D);return c.jsxs("button",{type:"button",onClick:()=>_(D),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",O?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:D}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",O?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ra,{size:14,className:O?"opacity-100":"opacity-0"})})]},D)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),j.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:j.map(D=>c.jsxs("button",{type:"button",onClick:()=>_(D),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:D}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},D))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(te,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>T({open:!0,type:"profile",payload:n,label:`Delete profile "${s.display_name||s.name}"?`}),disabled:i,children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:P,disabled:L||i,children:L?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]})})}function hH({permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:n,permissionSetsQuery:s,filteredPermissionSetList:r,duplicatePermissionSet:i,setConfirmDelete:o}){const a=c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Permission Sets"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(vo,{value:t,onChange:l=>e(l.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl self-start sm:self-auto",onClick:()=>n(null),children:"Add permission set"})]})]});return c.jsxs(bt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Bt,{className:"hidden md:block space-y-2",children:a}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:a}),c.jsx("div",{className:"space-y-4 p-5 pt-1",children:s.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.map(l=>c.jsxs(Dt,{className:"p-4 space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-base font-semibold",children:l.display_name||l.name}),c.jsx("div",{className:"text-sm text-black/55 dark:text-white/60",children:l.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(En,{onClick:()=>i(l),title:"Duplicate permission set","aria-label":"Duplicate permission set",children:c.jsx(BC,{size:16})}),c.jsx(En,{onClick:()=>n(l),title:"Edit permission set","aria-label":"Edit permission set",children:c.jsx(wd,{size:16})}),c.jsx(En,{variant:"ghost",onClick:()=>o({open:!0,type:"permission-set",payload:l.name,label:`Delete permission set "${l.display_name||l.name}"?`}),title:"Delete permission set","aria-label":"Delete permission set",children:c.jsx(ia,{size:16})})]})]}),c.jsxs("div",{className:"text-sm text-black/55 dark:text-white/60",children:[(l.permissions||[]).length," permission",(l.permissions||[]).length===1?"":"s"]}),l.description?c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65 truncate",children:l.description}):null]},l.name)),r.length?null:c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permission sets.":"No permission sets available."})]})})]})]})}function fH({permissionSetSearch:t,setPermissionSetSearch:e,permissionSetsQuery:n,filteredPermissionSetList:s,permissionList:r,permissionsQuery:i}){const{permissionSetForm:o,setPermissionSetForm:a,editingPermissionSet:l,setEditingPermissionSet:u,permissionSetModalOpen:d,setPermissionSetModalOpen:h,savingPermissionSet:f,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:w,openPermissionSetModal:x,duplicatePermissionSet:y,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:b,selectedPermissionSetPermissionSet:k,customPermissionSetPermissions:_,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j}=pH({permissionList:r}),[T,P]=v.useState({open:!1,type:"",payload:null,label:""});async function L(){if(!(!T.open||!T.payload))try{await m(T.payload)}finally{P({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(hH,{permissionSetSearch:t,setPermissionSetSearch:e,openPermissionSetModal:x,permissionSetsQuery:n,filteredPermissionSetList:s,duplicatePermissionSet:y,setConfirmDelete:P}),c.jsx(mH,{open:d,onClose:()=>{h(!1),u(null),a({name:"",display_name:"",description:"",permissionsText:""}),w(!1)},editingPermissionSet:l,permissionSetForm:o,setPermissionSetForm:a,permissionSetPermissionsOpen:p,setPermissionSetPermissionsOpen:w,selectedPermissionSetPermissions:b,permissionList:r,permissionsQuery:i,selectedPermissionSetPermissionSet:k,togglePermissionSetPermission:C,selectAllPermissionSetPermissions:S,clearPermissionSetPermissions:j,customPermissionSetPermissions:_,setConfirmDelete:P,savePermissionSet:g,savingPermissionSet:f}),c.jsx(uc,{open:T.open,message:T.label,onClose:()=>P({open:!1,type:"",payload:null,label:""}),onConfirm:L})]})}function pH({permissionList:t}){const e=Or(),[n,s]=v.useState({name:"",display_name:"",description:"",permissionsText:""}),[r,i]=v.useState(null),[o,a]=v.useState(!1),[l,u]=v.useState(!1),[d,h]=v.useState(!1),f=v.useMemo(()=>yn(n.permissionsText),[n.permissionsText]),p=v.useMemo(()=>new Set(f),[f]),w=v.useMemo(()=>{if(!t.length)return f;const C=new Set(t);return f.filter(S=>!C.has(S))},[t,f]);function x(C){h(!1),C?(i(C.name),s({name:C.name||"",display_name:C.display_name||C.name||"",description:C.description||"",permissionsText:(C.permissions||[]).map(S=>typeof S=="string"?S:S==null?void 0:S.name).filter(Boolean).join(`
`)})):(i(null),s({name:"",display_name:"",description:"",permissionsText:""})),a(!0)}function y(C){if(!C)return;const S=C.name||C.display_name||"permission_set",j=C.display_name||C.name||S;i(null),h(!1),s({name:`${S}_new`,display_name:`${j}_new`,description:C.description||"",permissionsText:(C.permissions||[]).map(T=>typeof T=="string"?T:T==null?void 0:T.name).filter(Boolean).join(`
`)}),a(!0)}async function g(){if(!n.name.trim())return;u(!0);const C={name:n.name.trim(),display_name:n.display_name||n.name.trim(),description:n.description,permissions:yn(n.permissionsText)};try{r?await IB(r,C):await MB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}finally{u(!1)}}async function m(C){if(C)try{await DB(C),e.invalidateQueries({queryKey:["admin","permission-sets"]}),a(!1),i(null)}catch{}}function b(C){s(S=>{const j=new Set(yn(S.permissionsText));return j.has(C)?j.delete(C):j.add(C),{...S,permissionsText:Array.from(j).join(`
`)}})}function k(){const C=new Set([...f,...t]);s(S=>({...S,permissionsText:Array.from(C).join(`
`)}))}function _(){s(C=>({...C,permissionsText:""}))}return{permissionSetForm:n,setPermissionSetForm:s,editingPermissionSet:r,setEditingPermissionSet:i,permissionSetModalOpen:o,setPermissionSetModalOpen:a,savingPermissionSet:l,permissionSetPermissionsOpen:d,setPermissionSetPermissionsOpen:h,openPermissionSetModal:x,duplicatePermissionSet:y,savePermissionSet:g,deletePermissionSet:m,selectedPermissionSetPermissions:f,selectedPermissionSetPermissionSet:p,customPermissionSetPermissions:w,togglePermissionSetPermission:b,selectAllPermissionSetPermissions:k,clearPermissionSetPermissions:_}}function mH({open:t,onClose:e,editingPermissionSet:n,permissionSetForm:s,setPermissionSetForm:r,permissionSetPermissionsOpen:i,setPermissionSetPermissionsOpen:o,selectedPermissionSetPermissions:a,permissionList:l,permissionsQuery:u,selectedPermissionSetPermissionSet:d,togglePermissionSetPermission:h,selectAllPermissionSetPermissions:f,clearPermissionSetPermissions:p,customPermissionSetPermissions:w,setConfirmDelete:x,savePermissionSet:y,savingPermissionSet:g}){return c.jsx(ws,{open:t,onClose:e,title:n?`Edit permission set: ${n}`:"Add permission set",maxWidth:"640px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.name,onChange:m=>r(b=>({...b,name:m.target.value})),placeholder:"sales_ops",disabled:!!n})}),c.jsx(Se,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.display_name,onChange:m=>r(b=>({...b,display_name:m.target.value})),placeholder:"Sales Ops"})})]}),c.jsx(Se,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:s.description,onChange:m=>r(b=>({...b,description:m.target.value})),placeholder:"What this permission set grants"})}),c.jsx(Se,{label:"Permissions",children:c.jsxs(Dt,{className:"p-4",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>o(m=>!m),"aria-expanded":i,children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Permissions"}),c.jsx("div",{className:"text-xs text-black/55 dark:text-white/60",children:wl(a.length,"permission")})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:i?"Hide":"Edit"}),c.jsx(Zn,{size:16,className:Te("transition-transform",i&&"rotate-180")})]})]}),i?c.jsxs("div",{className:"mt-0 space-y-0",children:[c.jsx("div",{className:"flex flex-wrap items-center justify-end gap-2",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:f,disabled:!l.length,children:"Select all"}),c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:p,disabled:!a.length,children:"Clear"})]})}),u.isLoading?c.jsx(Ye,{text:"Loading permissions",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-[168px] overflow-y-auto p-1",children:l.map(m=>{const b=d.has(m);return c.jsxs("button",{type:"button",onClick:()=>h(m),className:Te("flex items-center justify-between gap-3 rounded-xl px-3 py-1.5 text-xs ring-1 transition-colors",b?"bg-black/5 dark:bg-white/10 ring-black/20 dark:ring-white/20 text-black dark:text-white":"bg-white/60 dark:bg-white/5 ring-black/5 dark:ring-white/10 text-black/70 dark:text-white/70 hover:bg-black/5 dark:hover:bg-white/10"),children:[c.jsx("span",{className:"min-w-0 truncate",children:m}),c.jsx("span",{className:Te("h-4 w-4 rounded-full flex items-center justify-center transition-colors",b?"bg-black text-white dark:bg-white dark:text-black shadow-soft":"bg-black/5 dark:bg-white/10 text-black/40 dark:text-white/40"),children:c.jsx(ra,{size:14,className:b?"opacity-100":"opacity-0"})})]},m)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No permissions available."}),w.length?c.jsxs("div",{className:"rounded-2xl bg-white/50 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 p-3",children:[c.jsx("div",{className:"text-xs font-semibold text-black/60 dark:text-white/65",children:"Custom permissions"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:w.map(m=>c.jsxs("button",{type:"button",onClick:()=>h(m),className:"flex items-center gap-2 rounded-full bg-black/5 dark:bg-white/10 px-3 py-1 text-xs text-black/70 dark:text-white/70 hover:bg-black/8 dark:hover:bg-white/15",title:"Remove permission",children:[c.jsx("span",{className:"max-w-[220px] truncate",children:m}),c.jsx("span",{className:"text-black/40 dark:text-white/40",children:"x"})]},m))})]}):null]}):null]})}),c.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1",children:[n?c.jsx(te,{variant:"ghost",className:"rounded-2xl text-red-600 hover:text-red-700 dark:text-red-300",onClick:()=>x({open:!0,type:"permission-set",payload:n,label:`Delete permission set "${s.display_name||s.name}"?`}),children:"Delete"}):c.jsx("span",{}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:e,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:y,disabled:g,children:g?c.jsx(Ye,{text:"Saving"}):"Save"})]})]})]})})}function gH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:x,setConfirmDelete:y}){const g=[{value:"",label:"All modules"},...u.map(_=>({value:_,label:_}))],m=[{value:"",label:"All services"},...d.map(_=>({value:_,label:_}))],b=[{value:"",label:"All permissions"},...h.map(_=>({value:_,label:_}))],k=c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx(Yt,{children:"Permissions"}),c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[c.jsx(vo,{value:t,onChange:_=>e(_.target.value),className:"w-full sm:w-[220px]"}),c.jsx(te,{className:"rounded-2xl self-start sm:self-auto",variant:"secondary",onClick:()=>n("add",""),children:"Add permission"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[c.jsx(at,{value:s,options:g,onChange:r}),c.jsx(at,{value:i,options:m,onChange:o}),c.jsx(at,{value:a,options:b,onChange:l,className:"col-span-2 sm:col-span-1"})]})]});return c.jsxs(bt,{className:"h-full min-h-0 flex flex-col",children:[c.jsx(Bt,{className:"hidden md:block space-y-2",children:k}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto p-0",children:[c.jsx("div",{className:"space-y-2 p-5 pb-3 md:hidden",children:k}),c.jsx("div",{className:"space-y-3 p-5 pt-1",children:f.isLoading?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):p.length?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:p.map(_=>{const C=w(_),S=x[_];return c.jsxs(Dt,{className:"p-3",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-1 text-sm",children:[c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Module"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.module})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Service"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.service})]}),c.jsxs("div",{className:"flex flex-wrap items-baseline gap-1",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Permission"}),c.jsx("span",{className:"font-semibold text-black/85 dark:text-white/85",children:C.action})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(En,{onClick:()=>n("edit",_),title:"Edit permission","aria-label":"Edit permission",children:c.jsx(wd,{size:16})}),c.jsx(En,{variant:"ghost",onClick:()=>y({open:!0,type:"permission",payload:_,label:`Delete permission "${_}"?`}),title:"Delete permission","aria-label":"Delete permission",children:c.jsx(ia,{size:16})})]})]}),S?c.jsxs("div",{className:"mt-2 flex items-baseline gap-1 text-sm min-w-0",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:"Description"}),c.jsx("span",{className:"text-black/60 dark:text-white/65 truncate",children:S})]}):null]},_)})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:t.trim()?"No matching permissions.":"No permissions available."})})]})]})}function xH({permissionSearch:t,setPermissionSearch:e,openPermissionModal:n,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:x,permissionTree:y,updateLocalPermissionDescription:g}){const{permissionModal:m,setPermissionModal:b,permissionModalError:k,savingPermission:_,openPermissionModal:C,updatePermissionModalField:S,savePermissionModal:j,deletePermissionFromModal:T,setPermissionModalError:P}=yH({mergedPermissionDescriptions:x,updateLocalPermissionDescription:g}),[L,D]=v.useState({open:!1,type:"",payload:null,label:""}),O=m.module?y.servicesByModule[m.module]||[]:y.allServices,$=m.module&&m.service?y.actionsByService[`${m.module}:${m.service}`]||[]:y.allActions;async function I(){if(!(!L.open||!L.payload))try{await T(L.payload)}finally{D({open:!1,type:"",payload:null,label:""})}}return c.jsxs(c.Fragment,{children:[c.jsx(gH,{permissionSearch:t,setPermissionSearch:e,openPermissionModal:n||C,permissionModuleFilter:s,setPermissionModuleFilter:r,permissionServiceFilter:i,setPermissionServiceFilter:o,permissionActionFilter:a,setPermissionActionFilter:l,permissionModuleOptions:u,permissionFilterServiceOptions:d,permissionFilterActionOptions:h,permissionsQuery:f,filteredPermissionList:p,parsePermissionParts:w,mergedPermissionDescriptions:x,setConfirmDelete:D}),c.jsx(vH,{open:m.open,onClose:()=>{b({open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""}),P("")},permissionModal:m,permissionModuleOptions:u,permissionServiceOptions:O,permissionActionOptions:$,updatePermissionModalField:S,permissionModalError:k,savePermissionModal:j,savingPermission:_}),c.jsx(uc,{open:L.open,message:L.label,onClose:()=>D({open:!1,type:"",payload:null,label:""}),onConfirm:I})]})}const Oh={open:!1,mode:"add",value:"",original:"",module:"",service:"",action:"",description:"",originalDescription:""};function yH({mergedPermissionDescriptions:t,updateLocalPermissionDescription:e}){const n=Or(),[s,r]=v.useState(Oh),[i,o]=v.useState(""),[a,l]=v.useState(!1);function u(p="add",w=""){const x=ty(w),y=w&&t[w]||"";o(""),r({open:!0,mode:p,value:w,original:w,module:x.module,service:x.service,action:x.action,description:y,originalDescription:y})}function d(p,w){r(x=>{const y={...x,[p]:w};return{...y,value:Fw(y)}}),o("")}async function h(){var w;const p=Fw(s);if(!p){o("Select module, service, and permission.");return}l(!0);try{const x=((w=s.description)==null?void 0:w.trim())||"";if(s.mode==="add")await pg(p,x),e(p,x);else if(p!==s.original)await pg(p,x),await Bk(s.original),e(s.original,""),e(p,x);else if(x!==s.originalDescription)await pg(p,x),e(p,x);else{r({...Oh});return}n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Oh})}catch{}finally{l(!1)}}async function f(p){const w=p||s.original||s.value;if(w){l(!0);try{await Bk(w),e(w,""),n.invalidateQueries({queryKey:["admin","permissions"]}),r({...Oh})}catch{}finally{l(!1)}}}return{permissionModal:s,setPermissionModal:r,permissionModalError:i,savingPermission:a,openPermissionModal:u,updatePermissionModalField:d,savePermissionModal:h,deletePermissionFromModal:f,setPermissionModalError:o}}function vH({open:t,onClose:e,permissionModal:n,permissionModuleOptions:s,permissionServiceOptions:r,permissionActionOptions:i,updatePermissionModalField:o,permissionModalError:a,savePermissionModal:l,savingPermission:u}){return c.jsx(ws,{open:t,onClose:e,title:n.mode==="edit"?"Edit permission":"Add permission",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-3",children:[c.jsx(Se,{label:"Permission",children:c.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr_auto_1fr] items-center gap-2",children:[c.jsxs("div",{children:[c.jsx("input",{list:"permission-module-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.module,onChange:d=>o("module",d.target.value),placeholder:"module"}),c.jsx("datalist",{id:"permission-module-options",children:s.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-service-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.service,onChange:d=>o("service",d.target.value),placeholder:"service"}),c.jsx("datalist",{id:"permission-service-options",children:r.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]}),c.jsx("span",{className:"text-sm text-black/40 dark:text-white/40",children:":"}),c.jsxs("div",{children:[c.jsx("input",{list:"permission-action-options",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.action,onChange:d=>o("action",d.target.value),placeholder:"permission"}),c.jsx("datalist",{id:"permission-action-options",children:i.map((d,h)=>c.jsx("option",{value:d},`${d}-${h}`))})]})]})}),c.jsx(Se,{label:"Description",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:n.description,onChange:d=>o("description",d.target.value),placeholder:"Short description"})}),a?c.jsx("div",{className:"text-xs text-red-600 dark:text-red-300",children:a}):null,c.jsx("div",{className:"flex justify-end",children:c.jsx(te,{className:"rounded-2xl",onClick:l,disabled:u,children:u?c.jsx(Ye,{text:"Saving"}):n.mode==="edit"?"Update Permission":"Add Permission"})})]})})}const jg=20;function bH(){const{user:t}=oi(),[e,n]=v.useState("users"),[s,r]=v.useState(""),[i,o]=v.useState(0),[a,l]=v.useState(""),[u,d]=v.useState(""),[h,f]=v.useState(""),[p,w]=v.useState(""),[x,y]=v.useState(""),[g,m]=v.useState(""),[b,k]=v.useState(""),[_,C]=v.useState(""),[S,j]=v.useState("");if(!_d(t))return c.jsxs(bt,{children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Restricted"})}),c.jsx(Ut,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to the admin panel."})]});const T=en({queryKey:["admin","users",i],queryFn:()=>xB({limit:jg,offset:i*jg})}),P=en({queryKey:["admin","profiles"],queryFn:SB}),L=en({queryKey:["admin","permissions"],queryFn:EB}),D=en({queryKey:["admin","companies"],queryFn:TB}),O=en({queryKey:["admin","permission-sets"],queryFn:OB}),$=v.useMemo(()=>{var le;const K=((le=T.data)==null?void 0:le.users)||T.data||[],G=s.trim().toLowerCase();return K.filter(Y=>{var Ce,Le,we,oe,Ee;const B=Array.isArray(Y.profiles)?Y.profiles.map(tt=>(tt==null?void 0:tt.display_name)||(tt==null?void 0:tt.name)||tt).filter(Boolean).join(" "):((Ce=Y.profiles)==null?void 0:Ce.display_name)||((Le=Y.profiles)==null?void 0:Le.name)||Y.profile||Y.profile_name||"",xe=`${Y.email||""} ${Y.name||""} ${B}`.toLowerCase();if(G&&!xe.includes(G))return!1;const je=((we=Y.company)==null?void 0:we.code)||Y.company_code||Y.company_id||"";return!(x&&je!==x||g&&!(Array.isArray(Y.profiles)?Y.profiles.map(ht=>(ht==null?void 0:ht.name)||(ht==null?void 0:ht.display_name)||ht).filter(Boolean):[((oe=Y.profiles)==null?void 0:oe.name)||((Ee=Y.profiles)==null?void 0:Ee.display_name)||Y.profile||Y.profile_name].filter(Boolean)).includes(g))})},[T.data,s,x,g]);v.useMemo(()=>{var G;return(((G=T.data)==null?void 0:G.users)||T.data||[]).length===jg},[T.data]),v.useEffect(()=>{C(""),j("")},[b]),v.useEffect(()=>{j("")},[_]);const I=v.useMemo(()=>{var G;const K=((G=P.data)==null?void 0:G.profiles)??P.data;return Array.isArray(K)?K:[]},[P.data]),A=v.useMemo(()=>{var oe;const K=((oe=L.data)==null?void 0:oe.permissions)??L.data,G=new Map,le={},Y=(Ee,tt,ht)=>{if(!Ee||!tt||!ht)return;G.has(Ee)||G.set(Ee,new Map);const Lt=G.get(Ee);Lt.has(tt)||Lt.set(tt,new Set),Lt.get(tt).add(ht)};Array.isArray(K)?K.forEach(Ee=>{const tt=typeof Ee=="string"?Ee:Ee==null?void 0:Ee.name,ht=typeof Ee=="string"?"":(Ee==null?void 0:Ee.description)||"";if(tt&&ht&&(le[tt]=ht),!tt)return;const Lt=tt.split(":");Lt.length>=3&&Y(Lt[0],Lt[1],Lt[2])}):K&&typeof K=="object"&&Object.entries(K).forEach(([Ee,tt])=>{!tt||typeof tt!="object"||Object.entries(tt).forEach(([ht,Lt])=>{Array.isArray(Lt)&&Lt.forEach(ur=>Y(Ee,ht,ur))})});const B=Array.from(G.keys()).sort(),xe={},je={},Ce=[],Le=new Set,we=new Set;return B.forEach(Ee=>{const tt=Array.from(G.get(Ee).keys()).sort();xe[Ee]=tt,tt.forEach(ht=>{Le.add(ht);const Lt=Array.from(G.get(Ee).get(ht)).sort();je[`${Ee}:${ht}`]=Lt,Lt.forEach(ur=>{we.add(ur),Ce.push(`${Ee}:${ht}:${ur}`)})})}),{modules:B,servicesByModule:xe,actionsByService:je,flat:Ce,allServices:Array.from(Le).sort(),allActions:Array.from(we).sort(),descriptions:le}},[L.data]),W=v.useMemo(()=>A.flat,[A]),N=A.descriptions||{},[E,F]=v.useState({}),V=v.useMemo(()=>({...N||{},...E}),[N,E]),H=v.useCallback((K,G)=>{if(!K)return;const le=(G==null?void 0:G.trim())||"";F(Y=>{const B={...Y};return le?B[K]=le:delete B[K],B})},[]),he=A.modules,ee=b?A.servicesByModule[b]||[]:A.allServices,U=b&&_?A.actionsByService[`${b}:${_}`]||[]:A.allActions,Q=v.useMemo(()=>{var G;const K=((G=D.data)==null?void 0:G.companies)??D.data;return Array.isArray(K)?K:[]},[D.data]),de=v.useMemo(()=>{var G,le;const K=((G=O.data)==null?void 0:G.permission_sets)??((le=O.data)==null?void 0:le.permissionSets)??O.data;return Array.isArray(K)?K.map(Y=>typeof Y=="string"?{name:Y}:Y):[]},[O.data]),Z=v.useMemo(()=>{const K=u.trim().toLowerCase();return K?Q.filter(G=>`${G.name||""} ${G.code||""} ${G.country||""} ${G.currency||""} ${G.timezone||""}`.toLowerCase().includes(K)):Q},[Q,u]),be=v.useMemo(()=>{const K=a.trim().toLowerCase();return K?I.filter(G=>`${G.display_name||""} ${G.name||""} ${G.description||""}`.toLowerCase().includes(K)):I},[I,a]),Ae=v.useMemo(()=>{const K=h.trim().toLowerCase();return K?de.filter(G=>`${G.display_name||""} ${G.name||""} ${G.description||""}`.toLowerCase().includes(K)):de},[de,h]),me=v.useMemo(()=>{const K=p.trim().toLowerCase();let G=W;return(b||_||S)&&(G=G.filter(le=>{const Y=ty(le);return!(b&&Y.module!==b||_&&Y.service!==_||S&&Y.action!==S)})),K?G.filter(le=>{const Y=V[le]||"";return`${le} ${Y}`.toLowerCase().includes(K)}):G},[W,p,V,b,_,S]),fe=v.useMemo(()=>Q.map(K=>({value:K.code||K.id||"",label:K.name||K.code||K.id||""})).filter(K=>K.value),[Q]),De=v.useMemo(()=>I.map(K=>({value:K.name||K.display_name||"",label:K.display_name||K.name||""})).filter(K=>K.value),[I]),J=v.useMemo(()=>de.map(K=>K.name||K.id).filter(Boolean),[de]),pe=v.useMemo(()=>I.map(K=>K.name||K.id).filter(Boolean),[I]),ie=v.useMemo(()=>{const K=new Map;return Q.forEach(G=>{const le=G.code||G.id;le&&K.set(le,G.name||G.code||le)}),K},[Q]);return c.jsxs("div",{className:"flex h-full min-h-0 flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto",children:[c.jsx(te,{variant:e==="users"?"default":"ghost",onClick:()=>n("users"),className:"rounded-2xl shrink-0",children:"Users"}),c.jsx(te,{variant:e==="companies"?"default":"ghost",onClick:()=>n("companies"),className:"rounded-2xl shrink-0",children:"Companies"}),c.jsx(te,{variant:e==="profiles"?"default":"ghost",onClick:()=>n("profiles"),className:"rounded-2xl shrink-0",children:"Profiles"}),c.jsx(te,{variant:e==="permission-sets"?"default":"ghost",onClick:()=>n("permission-sets"),className:"rounded-2xl shrink-0",children:"Permission Sets"}),c.jsx(te,{variant:e==="permissions"?"default":"ghost",onClick:()=>n("permissions"),className:"rounded-2xl shrink-0",children:"Permissions"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:e==="users"?"h-full":"hidden","aria-hidden":e!=="users",children:c.jsx(tH,{q:s,setQ:r,usersQuery:T,users:$,user:t,companyLookup:ie,userCompanyFilter:x,setUserCompanyFilter:y,userProfileFilter:g,setUserProfileFilter:m,companyFilterOptions:fe,profileFilterOptions:De,companyList:Q,profileOptions:I,profileValues:pe,permissionSetList:de,permissionSetValues:J,permissionList:W,permissionsQuery:L,page:i})}),c.jsx("div",{className:e==="companies"?"h-full":"hidden","aria-hidden":e!=="companies",children:c.jsx(iH,{companySearch:u,setCompanySearch:d,companiesQuery:D,filteredCompanyList:Z,companyLookup:ie,companyList:Q})}),c.jsx("div",{className:e==="profiles"?"h-full":"hidden","aria-hidden":e!=="profiles",children:c.jsx(cH,{profileSearch:a,setProfileSearch:l,filteredProfileOptions:be,permissionList:W,permissionSetValues:J,permissionSetList:de,permissionSetsQuery:O,permissionsQuery:L})}),c.jsx("div",{className:e==="permission-sets"?"h-full":"hidden","aria-hidden":e!=="permission-sets",children:c.jsx(fH,{permissionSetSearch:h,setPermissionSetSearch:f,permissionSetsQuery:O,filteredPermissionSetList:Ae,permissionList:W,permissionsQuery:L})}),c.jsx("div",{className:e==="permissions"?"h-full":"hidden","aria-hidden":e!=="permissions",children:c.jsx(xH,{permissionSearch:p,setPermissionSearch:w,permissionModuleFilter:b,setPermissionModuleFilter:k,permissionServiceFilter:_,setPermissionServiceFilter:C,permissionActionFilter:S,setPermissionActionFilter:j,permissionModuleOptions:he,permissionFilterServiceOptions:ee,permissionFilterActionOptions:U,permissionsQuery:L,filteredPermissionList:me,parsePermissionParts:ty,mergedPermissionDescriptions:V,permissionTree:A,updateLocalPermissionDescription:H})})]})]})}function wH({notification:t}){var e;return t?c.jsxs("div",{className:"space-y-3 text-sm text-black/70 dark:text-white/70",children:[t.message?c.jsx("div",{children:t.message}):c.jsx("div",{children:"No additional details."}),(e=t.meta)!=null&&e.details?c.jsx("div",{className:"rounded-xl bg-black/5 dark:bg-white/10 p-3 text-xs whitespace-pre-wrap",children:t.meta.details}):null]}):null}function kH(){const{notifications:t,loading:e,clearAll:n,dismissNotification:s,markRead:r,formatTime:i}=g0(),[o,a]=v.useState(null),l=v.useMemo(()=>t,[t]);return c.jsxs("div",{className:"h-full min-h-0",children:[c.jsxs(bt,{className:"h-full flex flex-col",children:[c.jsxs(Bt,{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx(Yt,{children:"Notifications"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/55",children:l.length?`${l.length} total`:"No alerts yet"})]}),c.jsx(te,{variant:"secondary",className:"rounded-2xl",onClick:n,disabled:!l.length,children:"Clear all"})]}),c.jsx(Ut,{className:"flex-1 min-h-0 overflow-y-auto pt-2",children:e?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):l.length?c.jsx("div",{className:"space-y-2",children:l.map(u=>c.jsx(Dt,{className:"p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-base font-semibold text-black/85 dark:text-white/85 truncate",children:u.title||"Notification"}),u.message?c.jsx("div",{className:"mt-1 text-sm text-black/60 dark:text-white/65 leading-5 mmg-line-clamp-2",children:u.message}):null,u.created_at?c.jsx("div",{className:"mt-1 text-xs text-black/45 dark:text-white/45",children:i(u.created_at)}):null]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(En,{variant:"ghost",className:"h-8 w-8",onClick:()=>{r(u.id),a(u)},"aria-label":"View notification",children:c.jsx(UC,{size:14})}),c.jsx(En,{variant:"ghost",className:"h-8 w-8",onClick:()=>s(u.id),"aria-label":"Close notification",children:c.jsx(qv,{size:14})})]})]})},u.id))}):c.jsx(Dt,{className:"p-6 text-center text-sm text-black/60 dark:text-white/65",children:"You're all caught up."})})]}),c.jsx(ws,{open:!!o,onClose:()=>a(null),title:(o==null?void 0:o.title)||"Notification",maxWidth:"520px",children:c.jsx(wH,{notification:o})})]})}function _H(){const[t,e]=v.useState(null),[n,s]=v.useState([]),[r,i]=v.useState(""),[o,a]=v.useState(null),[l,u]=v.useState(null),[d,h]=v.useState(!1),[f,p]=v.useState(!1),[w,x]=v.useState(!1),[y,g]=v.useState(null),[m,b]=v.useState({}),[k,_]=v.useState(null),[C,S]=v.useState(!1),[j,T]=v.useState(!1),P=v.useRef(null),L=v.useRef(null),D=v.useRef(null),O=v.useRef(null),$=v.useRef(!0),I=en({queryKey:["video-critique","history"],queryFn:d4,enabled:!0}),A=v.useMemo(()=>(r.trim().length>0||!!o)&&!d,[r,o,d]);v.useEffect(()=>{var Q;if(f||I.isLoading)return;const U=I.data;if(U&&((Q=U.messages)!=null&&Q.length||U.session_id||U.conversation_id)){e(U.session_id||U.conversation_id||null);const de=(U.messages||[]).map(TH);s(de.length?de:[__()])}else s([__()]);p(!0)},[I.data,I.isLoading,f]),v.useEffect(()=>{const U=L.current;if(!U)return;const Q=()=>{const Z=U.scrollHeight-U.scrollTop-U.clientHeight<=120;$.current=Z};return Q(),U.addEventListener("scroll",Q,{passive:!0}),()=>U.removeEventListener("scroll",Q)},[]);const W=ge.useCallback((U="smooth",Q=!1)=>{var de;!Q&&!$.current||(de=D.current)==null||de.scrollIntoView({behavior:U,block:"end"})},[]);v.useEffect(()=>{const U=d?"auto":"smooth";requestAnimationFrame(()=>W(U))},[n,d,W]),v.useEffect(()=>{f&&requestAnimationFrame(()=>W("auto",!0))},[f,W]),v.useEffect(()=>()=>{var U,Q;return(Q=(U=O.current)==null?void 0:U.abort)==null?void 0:Q.call(U)},[]);const N=v.useMemo(()=>{var U;return(U=y==null?void 0:y.fields)!=null&&U.length?y.fields.every(Q=>{if(!Q.required)return!0;const de=m==null?void 0:m[Q.id];return de!=null&&String(de).trim()!==""}):!1},[y,m]);function E(){x(!1),g(null),b({}),_(null),S(!1),T(!1)}async function F({formType:U,workflowId:Q}){x(!0),S(!0),_({formType:U,workflowId:Q}),g(null),b({});try{const de=await x4(U);g(de);const Z={};((de==null?void 0:de.fields)||[]).forEach(be=>{Z[be.id]=be.default_value||""}),b(Z)}catch(de){g({title:"Action",submit_text:"Submit",fields:[],error:(de==null?void 0:de.message)||"Failed to load form."})}finally{S(!1)}}function V(U,Q={}){s(de=>[...de,{id:crypto.randomUUID(),role:"assistant",content:U,files:[],status:null,...Q}])}async function H(U){if(!U||U.url)return;const Q=U.action_id||U.id,de=U.workflow_id||U.workflowId;if(!Q||!de){V("Missing action details. Please try again.");return}try{T(!0);const Z=await m4({actionId:Q,workflowId:de});if(Z!=null&&Z.requires_form){T(!1),await F({formType:Z.form_type||U.form_type,workflowId:Z.workflow_id||de});return}V((Z==null?void 0:Z.message)||"Action completed.")}catch(Z){V((Z==null?void 0:Z.message)||"Unable to complete that action.")}finally{T(!1)}}async function he(){if(!(!(k!=null&&k.formType)||!(k!=null&&k.workflowId))&&N){T(!0);try{const U=await g4({formType:k.formType,workflowId:k.workflowId,category:m.category,reason:m.reason});E(),V((U==null?void 0:U.message)||"Form submitted.")}catch(U){V((U==null?void 0:U.message)||"Unable to submit the form."),T(!1)}}}async function ee(){var J,pe;if(!A)return;const U=r.trim(),Q=o,de=!!l&&!Q,Z=U||(Q?`Please review this file: ${Q.name}`:"");Q&&l&&u(null);const be=crypto.randomUUID(),Ae=Q?[{file_id:`local-${Date.now()}`,filename:Q.name,preview_url:URL.createObjectURL(Q)}]:[],me={id:be,role:"user",content:U,files:Ae,status:null},fe=crypto.randomUUID(),De={id:fe,role:"assistant",content:"",files:[],status:de?null:"Reviewing..."};s(ie=>[...ie,me,De]),i(""),a(null),$.current=!0,requestAnimationFrame(()=>W("auto",!0));try{let ie=[];if(de){const B=k_(U);if(!B){s(je=>je.map(Ce=>Ce.id===fe?{...Ce,status:null,content:"Please provide a task number to upload this video."}:Ce));return}h(!0);const xe=await Hk({file:l,taskNumber:B});s(je=>je.map(Ce=>Ce.id===fe?{...Ce,status:null,content:(xe==null?void 0:xe.message)||"Video uploaded."}:Ce)),u(null);return}if(Q&&NH(Q)){const B=k_(U);if(B){h(!0);const xe=await Hk({file:Q,taskNumber:B});s(je=>je.map(Ce=>Ce.id===fe?{...Ce,status:null,content:(xe==null?void 0:xe.message)||"Video uploaded."}:Ce));return}u(Q),s(xe=>xe.map(je=>je.id===fe?{...je,status:null,content:"Video received. Which task number is this for?"}:je));return}if(Q&&EH(Q)){h(!0);const B=await h4({file:Q,message:U||void 0,sessionId:t});if(B!=null&&B.session_id&&e(xe=>xe||B.session_id),B!=null&&B.file_id){const xe={file_id:B.file_id,filename:Q.name,file_url:B.file_url||B.url||""};s(je=>je.map(Ce=>{var Le,we,oe,Ee;return Ce.id===be?{...Ce,files:[{...xe,preview_url:((we=(Le=Ce.files)==null?void 0:Le[0])==null?void 0:we.preview_url)||((Ee=(oe=Ce.files)==null?void 0:oe[0])==null?void 0:Ee.url)||""}]}:Ce}))}s(xe=>xe.map(je=>je.id===fe?{...je,status:null,content:(B==null?void 0:B.response)||(B==null?void 0:B.message)||"File received."}:je));return}if(Q){h(!0);const B=await f4({file:Q});if(!(B!=null&&B.file_id))throw new Error("Upload failed");ie=[B.file_id];const xe={file_id:B.file_id,filename:Q.name,file_url:B.file_url||B.url||""};s(je=>je.map(Ce=>{var Le,we,oe,Ee;return Ce.id===be?{...Ce,files:[{...xe,preview_url:((we=(Le=Ce.files)==null?void 0:Le[0])==null?void 0:we.preview_url)||((Ee=(oe=Ce.files)==null?void 0:oe[0])==null?void 0:Ee.url)||""}]}:Ce}))}if(!Q&&U.startsWith("/")){h(!0);const xe=U.replace(/^\/+/,"").split(/\\s+/),je=xe.shift()||"",Ce=xe.join(" "),Le=await p4({command:je,args:Ce,sessionId:t});Le!=null&&Le.session_id&&e(we=>we||Le.session_id),s(we=>we.map(oe=>oe.id===fe?{...oe,status:null,content:(Le==null?void 0:Le.response)||(Le==null?void 0:Le.error)||"Command failed."}:oe));return}h(!0),(pe=(J=O.current)==null?void 0:J.abort)==null||pe.call(J);const K=new AbortController;O.current=K;let G="",le=null,Y=!1;await v4({sessionId:t,message:Z,fileIds:ie,signal:K.signal,onEvent:B=>{var Ce,Le;if((B!=null&&B.session_id||B!=null&&B.conversation_id)&&e(we=>we||B.session_id||B.conversation_id),(B==null?void 0:B.type)==="error"||B!=null&&B.error){const we=(B==null?void 0:B.message)||(B==null?void 0:B.error)||"Stream error";s(oe=>oe.map(Ee=>Ee.id===fe?{...Ee,status:null,content:`Error: ${we}`}:Ee));return}if((B==null?void 0:B.type)==="status"){s(we=>we.map(oe=>oe.id===fe?{...oe,status:B.content||"Processing..."}:oe)),B.message_id&&(le=B.message_id);return}if((B==null?void 0:B.type)==="delete"){B.message_id&&B.message_id===le&&(G="",le=null,s(we=>we.map(oe=>oe.id===fe?{...oe,status:"Reviewing...",content:""}:oe)));return}if((B==null?void 0:B.type)==="tool_call"){const we=B.name||((Ce=B.tool)==null?void 0:Ce.name)||"processing";s(oe=>oe.map(Ee=>Ee.id===fe?{...Ee,status:`Processing ${we}...`}:Ee));return}const xe=((Le=B==null?void 0:B.result)==null?void 0:Le.pdf_filename)||(B==null?void 0:B.pdf_filename),je=we=>!we||!xe||we.pdf_filename?we:{...we,pdf_filename:xe};if(xe&&s(we=>we.map(oe=>oe.id===fe&&!oe.pdf_filename?{...oe,pdf_filename:xe}:oe)),(B==null?void 0:B.type)==="delta"&&B.content){G+=B.content,s(we=>we.map(oe=>oe.id===fe?{...oe,status:null,content:G}:oe));return}if((B==null?void 0:B.type)==="text_done"){G=B.content||G,s(we=>we.map(oe=>oe.id===fe?{...oe,status:null,content:G}:oe));return}if(((B==null?void 0:B.type)==="chunk"||(B==null?void 0:B.type)==="content")&&B.content){B.message_id&&B.message_id!==le&&(le=B.message_id),G=B.type==="content"?B.content:G+B.content,s(we=>we.map(oe=>oe.id===fe?{...oe,status:null,content:G}:oe));return}if(B!=null&&B.content&&!B.type){G+=B.content,s(we=>we.map(oe=>oe.id===fe?{...oe,status:null,content:G}:oe));return}if((B==null?void 0:B.type)==="actions"&&B.actions){s(we=>we.map(oe=>oe.id===fe?{...oe,actions:B.actions}:oe));return}if(B!=null&&B.actions){s(we=>we.map(oe=>oe.id===fe?{...oe,actions:B.actions}:oe));return}if((B==null?void 0:B.type)==="files"&&B.files){if(Y=!0,s(we=>we.map(oe=>oe.id===fe?{...oe,files:[...oe.files||[],...B.files.map(je)]}:oe)),!G){const we=B.files.find(oe=>oe.comment);we!=null&&we.comment&&(G=we.comment,s(oe=>oe.map(Ee=>Ee.id===fe?{...Ee,status:null,content:G}:Ee)))}return}if((B==null?void 0:B.type)==="file"&&(B.file||B.url)){const we=je(B.file||B);Y=!0,s(oe=>oe.map(Ee=>Ee.id===fe?{...Ee,files:[...Ee.files||[],we]}:Ee)),!G&&we.comment&&(G=we.comment,s(oe=>oe.map(Ee=>Ee.id===fe?{...Ee,status:null,content:G}:Ee)));return}if(B!=null&&B.files){Y=!0,s(we=>we.map(oe=>oe.id===fe?{...oe,files:[...oe.files||[],...B.files.map(je)]}:oe));return}typeof B=="string"&&B.trim()&&(G+=B,s(we=>we.map(oe=>oe.id===fe?{...oe,status:null,content:G}:oe)))},onDone:()=>{!G&&!Y&&s(B=>B.map(xe=>xe.id===fe?{...xe,status:null,content:"Ready for the next request when you are."}:xe))}})}catch(ie){s(K=>K.map(G=>G.id===fe?{...G,status:null,content:(ie==null?void 0:ie.message)||"Failed to get response"}:G))}finally{h(!1)}}return c.jsxs("div",{className:"h-full flex flex-col gap-4 min-h-0",children:[c.jsx(bt,{className:"p-4 overflow-hidden flex-1 min-h-0",children:c.jsx("div",{ref:L,className:"h-full overflow-y-auto px-2",children:c.jsxs("div",{className:"space-y-3",children:[!f&&I.isLoading?c.jsx(Ye,{text:"Loading conversation",className:"text-sm text-black/60 dark:text-white/65"}):null,n.map(U=>c.jsx(SH,{msg:U,onMediaLoad:()=>W("auto"),onAction:H,actionsDisabled:j},U.id)),c.jsx("div",{ref:D})]})})}),c.jsxs(bt,{className:"p-3",children:[l&&!o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsxs("div",{className:"truncate",children:["Awaiting task number for ",l.name]}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>u(null),children:"x"})]}):null,o?c.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-2xl bg-black/5 dark:bg-white/10 px-3 py-2 text-sm",children:[c.jsx("div",{className:"truncate",children:o.name}),c.jsx("button",{className:"opacity-70 hover:opacity-100",onClick:()=>a(null),children:"x"})]}):null,c.jsxs("div",{className:"flex items-end gap-2",children:[c.jsx("input",{ref:P,type:"file",className:"hidden",onChange:U=>{var Q;return a(((Q=U.target.files)==null?void 0:Q[0])||null)},accept:"video/*,image/*,.pdf,.xlsx,.xls,.csv,.docx,.doc"}),c.jsx(te,{variant:"ghost",size:"icon",className:"rounded-2xl",title:"Attach file",onClick:()=>{var U;return(U=P.current)==null?void 0:U.click()},children:c.jsx(HC,{size:18})}),c.jsx(jH,{value:r,onChange:i,placeholder:"Describe the video request...",onEnter:ee}),c.jsx(te,{size:"icon",className:"w-12 rounded-2xl",title:"Send",disabled:!A,onClick:ee,children:c.jsx(WC,{size:18})})]}),c.jsx("div",{className:"mt-2 text-xs text-black/45 dark:text-white/55",children:"Share a brief, a link, or upload a cut for review."})]}),c.jsx(ws,{open:w,onClose:E,title:(y==null?void 0:y.title)||"Action",maxWidth:"520px",children:C?c.jsx(Ye,{text:"Loading form",className:"text-sm text-black/60 dark:text-white/65"}):y!=null&&y.error?c.jsx("div",{className:"text-sm text-red-600 dark:text-red-300",children:y.error}):c.jsxs("div",{className:"space-y-3",children:[((y==null?void 0:y.fields)||[]).map(U=>{if(U.type==="select"){const Q=[{value:"",label:U.placeholder||"Select..."},...U.options||[]];return c.jsx(Se,{label:U.label,children:c.jsx(at,{value:m[U.id]||"",options:Q,onChange:de=>b(Z=>({...Z,[U.id]:de}))})},U.id)}return U.type==="textarea"?c.jsx(Se,{label:U.label,children:c.jsx("textarea",{rows:3,placeholder:U.placeholder||"",className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[U.id]||"",onChange:Q=>b(de=>({...de,[U.id]:Q.target.value}))})},U.id):c.jsx(Se,{label:U.label,children:c.jsx("input",{type:"text",placeholder:U.placeholder||"",className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m[U.id]||"",onChange:Q=>b(de=>({...de,[U.id]:Q.target.value}))})},U.id)}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:E,children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:he,disabled:!N||j||C,children:(y==null?void 0:y.submit_text)||"Submit"})]})]})})]})}function SH({msg:t,onMediaLoad:e,onAction:n,actionsDisabled:s}){var h;const r=t.role==="user",i=v.useMemo(()=>IH(t.content||""),[t.content]),o=v.useMemo(()=>Ty(t.status||""),[t.status]),a=v.useMemo(()=>!t.status&&PH(t.content||""),[t.status,t.content]),l=v.useMemo(()=>Ty(t.content||""),[t.content]),u=v.useRef(new Map),d=t.actions||t.buttons||[];return c.jsx("div",{className:r?"flex justify-end":"flex justify-start",children:c.jsxs("div",{className:["max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-soft break-words","ring-1 ring-black/5 dark:ring-white/10 backdrop-blur-xs",r?"bg-black text-white dark:bg-white dark:text-black":"bg-white/70 dark:bg-white/10"].join(" "),children:[t.status||a?c.jsx(CH,{text:o||l}):c.jsx("div",{dangerouslySetInnerHTML:{__html:i}}),(h=t.files)!=null&&h.length?c.jsx("div",{className:"mt-2 space-y-1",children:t.files.map((f,p)=>{const w=y4(f);if(!w)return null;const x=f.pdf_filename||t.pdf_filename,y=OH(x?{...f,pdf_filename:x}:f,w,u.current),g=Kc(y),m=["jpg","jpeg","png","gif","webp","bmp"].includes(g),b=!r,k=g==="pdf";return m?c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-2",children:b?c.jsxs(c.Fragment,{children:[c.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"block overflow-hidden rounded-lg",children:c.jsx("img",{src:w,alt:y,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(io,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),Mh(w,y)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),Mh(w,y))},className:"inline-flex items-center",children:[c.jsx(pa,{size:14,className:"mr-1"}),"Download"]})})]})]}):c.jsx("div",{className:"overflow-hidden rounded-lg",children:c.jsx("img",{src:w,alt:y,className:"max-h-64 w-full object-cover",loading:"lazy",onLoad:e})})},f.file_id||w||p):c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-black/50 dark:text-white/60",children:k?c.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-red-500/10 text-red-700 dark:text-red-300 px-2 py-0.5",children:[c.jsx(Vv,{size:12}),"PDF"]}):c.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-black/5 dark:bg-white/10 px-2 py-0.5",children:g?g.toUpperCase():"FILE"})}),b?c.jsx("div",{className:"mt-1 text-xs font-semibold text-black/80 dark:text-white/85 truncate",children:y}):null]}),b?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{asChild:!0,size:"sm",variant:"ghost",className:"rounded-xl",children:c.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:[c.jsx(io,{size:14,className:"mr-1"}),"Open"]})}),c.jsx(te,{size:"sm",variant:"secondary",className:"rounded-xl",children:c.jsxs("span",{role:"link",tabIndex:0,onClick:_=>{_.preventDefault(),Mh(w,y)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),Mh(w,y))},className:"inline-flex items-center",children:[c.jsx(pa,{size:14,className:"mr-1"}),"Download"]})})]}):null]})},f.file_id||w||p)})}):null,d.length?c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.map((f,p)=>{const w=f.action_id||f.id||`${f.label}-${p}`,x=f.variant||"secondary";return f.url?c.jsx(te,{asChild:!0,size:"sm",variant:x,className:"rounded-xl",disabled:s,children:c.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",children:f.label||"Open"})},w):c.jsx(te,{size:"sm",variant:x,className:"rounded-xl",onClick:()=>n==null?void 0:n(f),disabled:s,children:f.label||"Action"},w)})}):null]})})}function jH({value:t,onChange:e,placeholder:n,onEnter:s,disabled:r}){const i=v.useRef(null);v.useEffect(()=>{const a=i.current;if(!a)return;a.style.height="0px";const u=22*5+16;a.style.height=Math.min(a.scrollHeight,u)+"px"},[t]);function o(a){a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),s==null||s())}return c.jsx("textarea",{ref:i,rows:1,value:t,disabled:r,onChange:a=>e(a.target.value),onKeyDown:o,placeholder:n,className:"w-full resize-none rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10 dark:focus:ring-white/15 overflow-auto",style:{maxHeight:"132px"}})}function CH({text:t}){return c.jsxs("span",{className:"inline-flex items-center gap-2 opacity-80",children:[c.jsx("span",{children:t||"Reviewing"}),c.jsxs("span",{className:"mmg-ellipsis","aria-hidden":"true",children:[c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"0ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"120ms"}}),c.jsx("span",{className:"mmg-ellipsis-dot",style:{animationDelay:"240ms"}})]})]})}function k_(t){if(!t)return null;const e=String(t).match(/\b(\d{1,6})\b/);return e?Number(e[1]):null}function NH(t){if(!t)return!1;if(t.type&&t.type.startsWith("video/"))return!0;const e=t.name||"";return/\.(mp4|mov|avi|mkv|webm)$/i.test(e)}function EH(t){if(!t)return!1;if(t.type&&t.type.startsWith("image/"))return!0;const e=t.name||"";return/\.(png|jpe?g|gif|webp|bmp)$/i.test(e)}function TH(t){return{id:t.id||t.message_id||crypto.randomUUID(),role:t.role||t.sender||"assistant",content:t.content||t.message||"",files:t.files||t.attachments||[],actions:t.actions||t.buttons||[],pdf_filename:t.pdf_filename||t.pdfFilename,status:null}}function Ty(t){return t?String(t).replace(/[_*`]/g,"").replace(/\.+$/,"").replace(/\s+/g," ").trim():""}function PH(t){const e=Ty(t);return e?!!(e==="Reviewing"||e.startsWith("Processing")||e.startsWith("Analyzing")):!1}function Kc(t){if(!t)return"";const n=String(t).split("?")[0].split("#")[0].split(".");return n.length<=1?"":n.pop().toLowerCase()}function RH(t){if(!t)return"";try{const n=new URL(t,window.location.href).pathname.split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}catch{const n=t.split("?")[0].split("#")[0].split("/").filter(Boolean);return n.length?decodeURIComponent(n[n.length-1]):""}}function AH(t){if(!t)return!0;const e=t.trim().toLowerCase();if(!e||e==="file"||e==="download")return!0;const n=e.replace(/\.[^.]+$/,"");return!!(n==="tmp"||n==="temp"||/^[a-f0-9-]{16,}$/.test(n)||/^file[-_]?\d+$/.test(n)||/^(tmp|temp)/.test(n)||/^upload[-_]?.+$/.test(n))}function OH(t,e,n){const s=(t==null?void 0:t.pdf_filename)||"",r=s||(t==null?void 0:t.filename)||(t==null?void 0:t.title)||"",i=RH(e),o=(t==null?void 0:t.file_id)||(t==null?void 0:t.id)||e||r;let a=r||i||"";const l=Kc(a)||Kc(i)||Kc(e);if(s){const u=Kc(a)||"pdf";return a.toLowerCase().endsWith(`.${u}`)||(a=`${a}.${u}`),o&&n&&n.set(o,a),a}return AH(a)?l==="pdf"?a="Review.pdf":l?a=`Attachment.${l}`:a="Attachment":l&&!a.toLowerCase().endsWith(`.${l}`)&&(a=`${a}.${l}`),o&&n&&n.set(o,a),a||(l?`Attachment.${l}`:"Attachment")}async function Mh(t,e){try{const n=Bp(),s=await fetch(t,{headers:n?{Authorization:`Bearer ${n}`}:void 0});if(!s.ok)throw new Error("Download failed");const r=await s.blob(),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),o.remove(),setTimeout(()=>URL.revokeObjectURL(i),1e3)}catch{const n=document.createElement("a");n.href=t,n.download=e,n.target="_blank",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),n.remove()}}function __(){return{id:crypto.randomUUID(),role:"assistant",content:`Good ${MH()}, ready for a video critique?`,files:[],status:null}}function MH(){const t=new Date().getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function Py(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Ac(t){return t?Py(t).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="chat-link">[Image: $1]</a>').replace(/\*\*\*(.+?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/___(.+?)___/g,"<strong><em>$1</em></strong>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/__(?!INLINE_CODE_|CODE_BLOCK_)(.+?)__/g,"<strong>$1</strong>").replace(new RegExp("(?<!\\*)\\*(?!\\*)(.+?)(?<!\\*)\\*(?!\\*)","g"),"<em>$1</em>").replace(new RegExp("(?<!\\w)_(?!_)(.+?)(?<!_)_(?!\\w)","g"),"<em>$1</em>").replace(/~~(.+?)~~/g,"<del>$1</del>").replace(/==(.+?)==/g,'<mark class="chat-highlight">$1</mark>'):""}function IH(t){if(!t)return"";const e=[];let n=t.replace(/```(\w*)\n?([\s\S]*?)```/g,(d,h,f)=>{const p=e.length;return e.push({lang:h||"",code:f.trim()}),`__CODE_BLOCK_${p}__`});const s=[];n=n.replace(/`([^`]+)`/g,(d,h)=>{const f=s.length;return s.push(h),`__INLINE_CODE_${f}__`});const r=n.split(`
`);let i=[],o=!1,a=!1,l=!1;for(let d=0;d<r.length;d++){let h=r[d];const f=h.match(/^__CODE_BLOCK_(\d+)__$/);if(f){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=e[parseInt(f[1],10)],m=g.lang?` class="language-${g.lang}"`:"";i.push(`<pre class="chat-code-block"><code${m}>${Py(g.code)}</code></pre>`);continue}const p=h.match(/^(#{1,6})\s+(.*)$/);if(p){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1);const g=p[1].length,m=Ac(p[2]);i.push(`<h${g} class="chat-header chat-h${g}">${m}</h${g}>`);continue}if(/^[-*_]{3,}\s*$/.test(h)){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l&&(i.push("</blockquote>"),l=!1),i.push('<hr class="chat-hr">');continue}const w=h.match(/^>\s*(.*)$/);if(w){o&&(i.push("</ul>"),o=!1),a&&(i.push("</ol>"),a=!1),l||(i.push('<blockquote class="chat-blockquote">'),l=!0),i.push(Ac(w[1])+"<br>");continue}else l&&(i.push("</blockquote>"),l=!1);const x=h.match(/^(\s*)([-*])\s+(.*)$/);if(x){a&&(i.push("</ol>"),a=!1),o||(i.push('<ul class="chat-list">'),o=!0);const g=Ac(x[3]);i.push(`<li>${g}</li>`);continue}else o&&(i.push("</ul>"),o=!1);const y=h.match(/^(\s*)(\d+)\.\s+(.*)$/);if(y){o&&(i.push("</ul>"),o=!1),a||(i.push('<ol class="chat-numbered-list">'),a=!0);const g=Ac(y[3]);i.push(`<li>${g}</li>`);continue}else a&&(i.push("</ol>"),a=!1);if(h.trim()===""){i.push("<br>");continue}i.push(Ac(h)),d<r.length-1&&i.push("<br>")}o&&i.push("</ul>"),a&&i.push("</ol>"),l&&i.push("</blockquote>");let u=i.join("");return s.forEach((d,h)=>{u=u.replace(`__INLINE_CODE_${h}__`,`<code class="chat-inline-code">${Py(d)}</code>`)}),u}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Dd(t){return t+.5|0}const zi=(t,e,n)=>Math.max(Math.min(t,n),e);function Gc(t){return zi(Dd(t*2.55),0,255)}function to(t){return zi(Dd(t*255),0,255)}function Vr(t){return zi(Dd(t/2.55)/100,0,1)}function S_(t){return zi(Dd(t*100),0,100)}const Es={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Ry=[..."0123456789ABCDEF"],DH=t=>Ry[t&15],LH=t=>Ry[(t&240)>>4]+Ry[t&15],Ih=t=>(t&240)>>4===(t&15),$H=t=>Ih(t.r)&&Ih(t.g)&&Ih(t.b)&&Ih(t.a);function FH(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Es[t[1]]*17,g:255&Es[t[2]]*17,b:255&Es[t[3]]*17,a:e===5?Es[t[4]]*17:255}:(e===7||e===9)&&(n={r:Es[t[1]]<<4|Es[t[2]],g:Es[t[3]]<<4|Es[t[4]],b:Es[t[5]]<<4|Es[t[6]],a:e===9?Es[t[7]]<<4|Es[t[8]]:255})),n}const zH=(t,e)=>t<255?e(t):"";function BH(t){var e=$H(t)?DH:LH;return t?"#"+e(t.r)+e(t.g)+e(t.b)+zH(t.a,e):void 0}const UH=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function VT(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function HH(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function WH(t,e,n){const s=VT(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function VH(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function R0(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,u,d;return i!==o&&(d=i-o,u=a>.5?d/(2-i-o):d/(i+o),l=VH(n,s,r,d,i),l=l*60+.5),[l|0,u||0,a]}function A0(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(to)}function O0(t,e,n){return A0(VT,t,e,n)}function qH(t,e,n){return A0(WH,t,e,n)}function KH(t,e,n){return A0(HH,t,e,n)}function qT(t){return(t%360+360)%360}function GH(t){const e=UH.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Gc(+e[5]):to(+e[5]));const r=qT(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=qH(r,i,o):e[1]==="hsv"?s=KH(r,i,o):s=O0(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function YH(t,e){var n=R0(t);n[0]=qT(n[0]+e),n=O0(n),t.r=n[0],t.g=n[1],t.b=n[2]}function QH(t){if(!t)return;const e=R0(t),n=e[0],s=S_(e[1]),r=S_(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Vr(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const j_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},C_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function XH(){const t={},e=Object.keys(C_),n=Object.keys(j_);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,j_[i]);i=parseInt(C_[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Dh;function JH(t){Dh||(Dh=XH(),Dh.transparent=[0,0,0,0]);const e=Dh[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const ZH=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function e8(t){const e=ZH.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?Gc(o):zi(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?Gc(s):zi(s,0,255)),r=255&(e[4]?Gc(r):zi(r,0,255)),i=255&(e[6]?Gc(i):zi(i,0,255)),{r:s,g:r,b:i,a:n}}}function t8(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Vr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Cg=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,qa=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function n8(t,e,n){const s=qa(Vr(t.r)),r=qa(Vr(t.g)),i=qa(Vr(t.b));return{r:to(Cg(s+n*(qa(Vr(e.r))-s))),g:to(Cg(r+n*(qa(Vr(e.g))-r))),b:to(Cg(i+n*(qa(Vr(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Lh(t,e,n){if(t){let s=R0(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=O0(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function KT(t,e){return t&&Object.assign(e||{},t)}function N_(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=to(t[3]))):(e=KT(t,{r:0,g:0,b:0,a:1}),e.a=to(e.a)),e}function s8(t){return t.charAt(0)==="r"?e8(t):GH(t)}class ed{constructor(e){if(e instanceof ed)return e;const n=typeof e;let s;n==="object"?s=N_(e):n==="string"&&(s=FH(e)||JH(e)||s8(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=KT(this._rgb);return e&&(e.a=Vr(e.a)),e}set rgb(e){this._rgb=N_(e)}rgbString(){return this._valid?t8(this._rgb):void 0}hexString(){return this._valid?BH(this._rgb):void 0}hslString(){return this._valid?QH(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,u=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-u,s.r=255&u*s.r+i*r.r+.5,s.g=255&u*s.g+i*r.g+.5,s.b=255&u*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=n8(this._rgb,e._rgb,n)),this}clone(){return new ed(this.rgb)}alpha(e){return this._rgb.a=to(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Dd(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Lh(this._rgb,2,e),this}darken(e){return Lh(this._rgb,2,-e),this}saturate(e){return Lh(this._rgb,1,e),this}desaturate(e){return Lh(this._rgb,1,-e),this}rotate(e){return YH(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function $r(){}const r8=(()=>{let t=0;return()=>t++})();function wt(t){return t==null}function hn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function it(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Us(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function mr(t,e){return Us(t)?t:e}function st(t,e){return typeof t>"u"?e:t}const i8=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,GT=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Nt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function pt(t,e,n,s){let r,i,o;if(hn(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(it(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function up(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function dp(t){if(hn(t))return t.map(dp);if(it(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=dp(t[n[r]]);return e}return t}function YT(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function o8(t,e,n,s){if(!YT(t))return;const r=e[t],i=n[t];it(r)&&it(i)?td(r,i,s):e[t]=dp(i)}function td(t,e,n){const s=hn(e)?e:[e],r=s.length;if(!it(t))return t;n=n||{};const i=n.merger||o8;let o;for(let a=0;a<r;++a){if(o=s[a],!it(o))continue;const l=Object.keys(o);for(let u=0,d=l.length;u<d;++u)i(l[u],t,o,n)}return t}function du(t,e){return td(t,e,{merger:a8})}function a8(t,e,n){if(!YT(t))return;const s=e[t],r=n[t];it(s)&&it(r)?du(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=dp(r))}const E_={"":t=>t,x:t=>t.x,y:t=>t.y};function l8(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function c8(t){const e=l8(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function xa(t,e){return(E_[e]||(E_[e]=c8(e)))(t)}function M0(t){return t.charAt(0).toUpperCase()+t.slice(1)}const nd=t=>typeof t<"u",uo=t=>typeof t=="function",T_=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function u8(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Et=Math.PI,nn=2*Et,hp=Number.POSITIVE_INFINITY,d8=Et/180,cn=Et/2,To=Et/4,P_=Et*2/3,QT=Math.log10,no=Math.sign;function vf(t,e,n){return Math.abs(t-e)<n}function R_(t){const e=Math.round(t);t=vf(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(QT(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function h8(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function f8(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function fp(t){return!f8(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function p8(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function m8(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function Zr(t){return t*(Et/180)}function g8(t){return t*(180/Et)}function A_(t){if(!Us(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function XT(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*Et&&(i+=nn),{angle:i,distance:r}}function x8(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function vr(t){return(t%nn+nn)%nn}function pp(t,e,n,s){const r=vr(t),i=vr(e),o=vr(n),a=vr(i-r),l=vr(o-r),u=vr(r-i),d=vr(r-o);return r===i||r===o||s&&i===o||a>l&&u<d}function es(t,e,n){return Math.max(e,Math.min(n,t))}function y8(t){return es(t,-32768,32767)}function Vo(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function I0(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Ay=(t,e,n,s)=>I0(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),v8=(t,e,n)=>I0(t,n,s=>t[s][e]>=n);function b8(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const JT=["push","pop","shift","splice","unshift"];function w8(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),JT.forEach(n=>{const s="_onData"+M0(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function O_(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(JT.forEach(i=>{delete t[i]}),delete t._chartjs)}function ZT(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const e2=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function t2(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,e2.call(window,()=>{s=!1,t.apply(e,n)}))}}function k8(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const n2=t=>t==="start"?"left":t==="end"?"right":"center",ds=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,_8=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e,$h=t=>t===0||t===1,M_=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*nn/n)),I_=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*nn/n)+1,hu={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*cn)+1,easeOutSine:t=>Math.sin(t*cn),easeInOutSine:t=>-.5*(Math.cos(Et*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>$h(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>$h(t)?t:M_(t,.075,.3),easeOutElastic:t=>$h(t)?t:I_(t,.075,.3),easeInOutElastic(t){return $h(t)?t:t<.5?.5*M_(t*2,.1125,.45):.5+.5*I_(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-hu.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?hu.easeInBounce(t*2)*.5:hu.easeOutBounce(t*2-1)*.5+.5};function s2(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function D_(t){return s2(t)?t:new ed(t)}function Ng(t){return s2(t)?t:new ed(t).saturate(.5).darken(.1).hexString()}const S8=["x","y","borderWidth","radius","tension"],j8=["color","borderColor","backgroundColor"];function C8(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:j8},numbers:{type:"number",properties:S8}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function N8(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const L_=new Map;function E8(t,e){e=e||{};const n=t+JSON.stringify(e);let s=L_.get(n);return s||(s=new Intl.NumberFormat(t,e),L_.set(n,s)),s}function D0(t,e,n){return E8(e,n).format(t)}const T8={values(t){return hn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),i=P8(t,n)}const o=QT(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),D0(t,s,l)}};function P8(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var r2={formatters:T8};function R8(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:r2.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const ya=Object.create(null),Oy=Object.create(null);function fu(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function Eg(t,e,n){return typeof e=="string"?td(fu(t,e),n):td(fu(t,""),e)}class A8{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Ng(r.backgroundColor),this.hoverBorderColor=(s,r)=>Ng(r.borderColor),this.hoverColor=(s,r)=>Ng(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Eg(this,e,n)}get(e){return fu(this,e)}describe(e,n){return Eg(Oy,e,n)}override(e,n){return Eg(ya,e,n)}route(e,n,s,r){const i=fu(this,e),o=fu(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],u=o[r];return it(l)?Object.assign({},u,l):st(l,u)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Xt=new A8({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[C8,N8,R8]);function O8(t){return!t||wt(t.size)||wt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function $_(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function Po(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function F_(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function z_(t,e,n,s){i2(t,e,n,s,null)}function i2(t,e,n,s,r){let i,o,a,l,u,d,h,f;const p=e.pointStyle,w=e.rotation,x=e.radius;let y=(w||0)*d8;if(p&&typeof p=="object"&&(i=p.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(y),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(x)||x<=0)){switch(t.beginPath(),p){default:r?t.ellipse(n,s,r/2,x,0,0,nn):t.arc(n,s,x,0,nn),t.closePath();break;case"triangle":d=r?r/2:x,t.moveTo(n+Math.sin(y)*d,s-Math.cos(y)*x),y+=P_,t.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*x),y+=P_,t.lineTo(n+Math.sin(y)*d,s-Math.cos(y)*x),t.closePath();break;case"rectRounded":u=x*.516,l=x-u,o=Math.cos(y+To)*l,h=Math.cos(y+To)*(r?r/2-u:l),a=Math.sin(y+To)*l,f=Math.sin(y+To)*(r?r/2-u:l),t.arc(n-h,s-a,u,y-Et,y-cn),t.arc(n+f,s-o,u,y-cn,y),t.arc(n+h,s+a,u,y,y+cn),t.arc(n-f,s+o,u,y+cn,y+Et),t.closePath();break;case"rect":if(!w){l=Math.SQRT1_2*x,d=r?r/2:l,t.rect(n-d,s-l,2*d,2*l);break}y+=To;case"rectRot":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+f,s-o),t.lineTo(n+h,s+a),t.lineTo(n-f,s+o),t.closePath();break;case"crossRot":y+=To;case"cross":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"star":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o),y+=To,h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,a=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),t.moveTo(n-h,s-a),t.lineTo(n+h,s+a),t.moveTo(n+f,s-o),t.lineTo(n-f,s+o);break;case"line":o=r?r/2:Math.cos(y)*x,a=Math.sin(y)*x,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(y)*(r?r/2:x),s+Math.sin(y)*x);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function o2(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function L0(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function $0(t){t.restore()}function M8(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function I8(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,u=n+i.actualBoundingBoxDescent,d=r.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,d),t.lineTo(a,d),t.stroke()}}function D8(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function mp(t,e,n,s,r,i={}){const o=hn(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,u;for(t.save(),t.font=r.string,M8(t,i),l=0;l<o.length;++l)u=o[l],i.backdrop&&D8(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),wt(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(u,n,s,i.maxWidth)),t.fillText(u,n,s,i.maxWidth),I8(t,n,s,u,i),s+=Number(r.lineHeight);t.restore()}function gp(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*Et,Et,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,Et,cn,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,cn,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-cn,!0),t.lineTo(n+o.topLeft,s)}const L8=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,$8=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function F8(t,e){const n=(""+t).match(L8);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const z8=t=>+t||0;function F0(t,e){const n={},s=it(e),r=s?Object.keys(e):e,i=it(t)?s?o=>st(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=z8(i(o));return n}function a2(t){return F0(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Nl(t){return F0(t,["topLeft","topRight","bottomLeft","bottomRight"])}function cr(t){const e=a2(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ts(t,e){t=t||{},e=e||Xt.font;let n=st(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=st(t.style,e.style);s&&!(""+s).match($8)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:st(t.family,e.family),lineHeight:F8(st(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:st(t.weight,e.weight),string:""};return r.string=O8(r),r}function Fh(t,e,n,s){let r,i,o;for(r=0,i=t.length;r<i;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function B8(t,e,n){const{min:s,max:r}=t,i=GT(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function fc(t,e){return Object.assign(Object.create(t),e)}function z0(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=d2("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>z0([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return c2(a,l,()=>Y8(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return U_(a).includes(l)},ownKeys(a){return U_(a)},set(a,l,u){const d=a._storage||(a._storage=r());return a[l]=d[l]=u,delete a._keys,!0}})}function Zl(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:l2(t,s),setContext:i=>Zl(t,i,n,s),override:i=>Zl(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return c2(i,o,()=>H8(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function l2(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:uo(n)?n:()=>n,isIndexable:uo(s)?s:()=>s}}const U8=(t,e)=>t?t+M0(e):e,B0=(t,e)=>it(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function c2(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function H8(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return uo(a)&&o.isScriptable(e)&&(a=W8(e,a,t,n)),hn(a)&&a.length&&(a=V8(e,a,t,o.isIndexable)),B0(e,a)&&(a=Zl(a,r,i&&i[e],o)),a}function W8(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),B0(t,l)&&(l=U0(r._scopes,r,t,l)),l}function V8(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(it(e[0])){const l=e,u=r._scopes.filter(d=>d!==l);e=[];for(const d of l){const h=U0(u,r,t,d);e.push(Zl(h,i,o&&o[t],a))}}return e}function u2(t,e,n){return uo(t)?t(e,n):t}const q8=(t,e)=>t===!0?e:typeof t=="string"?xa(e,t):void 0;function K8(t,e,n,s,r){for(const i of e){const o=q8(n,i);if(o){t.add(o);const a=u2(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function U0(t,e,n,s){const r=e._rootScopes,i=u2(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=B_(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=B_(a,o,i,l,s),l===null)?!1:z0(Array.from(a),[""],r,i,()=>G8(e,n,s))}function B_(t,e,n,s,r){for(;n;)n=K8(t,e,n,s,r);return n}function G8(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return hn(r)&&it(n)?n:r||{}}function Y8(t,e,n,s){let r;for(const i of e)if(r=d2(U8(i,t),n),typeof r<"u")return B0(t,r)?U0(n,s,t,r):r}function d2(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function U_(t){let e=t._keys;return e||(e=t._keys=Q8(t._scopes)),e}function Q8(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function H0(){return typeof window<"u"&&typeof document<"u"}function W0(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function xp(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const sm=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function X8(t,e){return sm(t).getPropertyValue(e)}const J8=["top","right","bottom","left"];function oa(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=J8[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Z8=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function eW(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(Z8(r,i,t.target))a=r,l=i;else{const u=e.getBoundingClientRect();a=s.clientX-u.left,l=s.clientY-u.top,o=!0}return{x:a,y:l,box:o}}function Do(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=sm(n),i=r.boxSizing==="border-box",o=oa(r,"padding"),a=oa(r,"border","width"),{x:l,y:u,box:d}=eW(t,n),h=o.left+(d&&a.left),f=o.top+(d&&a.top);let{width:p,height:w}=e;return i&&(p-=o.width+a.width,w-=o.height+a.height),{x:Math.round((l-h)/p*n.width/s),y:Math.round((u-f)/w*n.height/s)}}function tW(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&W0(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=sm(i),l=oa(a,"border","width"),u=oa(a,"padding");e=o.width-u.width-l.width,n=o.height-u.height-l.height,s=xp(a.maxWidth,i,"clientWidth"),r=xp(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||hp,maxHeight:r||hp}}const Bi=t=>Math.round(t*10)/10;function nW(t,e,n,s){const r=sm(t),i=oa(r,"margin"),o=xp(r.maxWidth,t,"clientWidth")||hp,a=xp(r.maxHeight,t,"clientHeight")||hp,l=tW(t,e,n);let{width:u,height:d}=l;if(r.boxSizing==="content-box"){const f=oa(r,"border","width"),p=oa(r,"padding");u-=p.width+f.width,d-=p.height+f.height}return u=Math.max(0,u-i.width),d=Math.max(0,s?u/s:d-i.height),u=Bi(Math.min(u,o,l.maxWidth)),d=Bi(Math.min(d,a,l.maxHeight)),u&&!d&&(d=Bi(u/2)),(e!==void 0||n!==void 0)&&s&&l.height&&d>l.height&&(d=l.height,u=Bi(Math.floor(d*s))),{width:u,height:d}}function H_(t,e,n){const s=e||1,r=Bi(t.height*s),i=Bi(t.width*s);t.height=Bi(t.height),t.width=Bi(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const sW=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};H0()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function W_(t,e){const n=X8(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const rW=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},iW=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function El(t,e,n){return t?rW(e,n):iW()}function h2(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function f2(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function zh(t,e,n){return t.options.clip?t[n]:e[n]}function oW(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:zh(n,e,"left"),right:zh(n,e,"right"),top:zh(s,e,"top"),bottom:zh(s,e,"bottom")}:e}function aW(t,e){const n=e._clip;if(n.disabled)return!1;const s=oW(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class lW{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=e2.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var zr=new lW;const V_="transparent",cW={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=D_(t||V_),r=s.valid&&D_(e||V_);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class uW{constructor(e,n,s,r){const i=n[s];r=Fh([e.to,r,i,e.from]);const o=Fh([e.from,i,r]);this._active=!0,this._fn=e.fn||cW[e.type||typeof o],this._easing=hu[e.easing]||hu.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Fh([e.to,n,r,e.from]),this._from=Fh([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class p2{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!it(e))return;const n=Object.keys(Xt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!it(i))return;const o={};for(const a of n)o[a]=i[a];(hn(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=hW(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&dW(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const u=o[l];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,n));continue}const d=n[u];let h=i[u];const f=s.get(u);if(h)if(f&&h.active()){h.update(f,d,a);continue}else h.cancel();if(!f||!f.duration){e[u]=d;continue}i[u]=h=new uW(f,e,u,d),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return zr.add(this._chart,s),!0}}function dW(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function hW(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function q_(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function fW(t,e,n){if(n===!1)return!1;const s=q_(t,n),r=q_(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function pW(t){let e,n,s,r;return it(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function m2(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function K_(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,u;if(e===null)return;let d=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(d=!0,s.all)continue;break}u=t.values[l],Us(u)&&(i||e===0||no(e)===no(u))&&(e+=u)}return!d&&!s.all?0:e}function mW(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,u,d;for(l=0,u=o.length;l<u;++l)d=o[l],a[l]={[r]:d,[i]:t[d]};return a}function Tg(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function gW(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function xW(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function yW(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function G_(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function Y_(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,u=o.axis,d=gW(i,o,s),h=e.length;let f;for(let p=0;p<h;++p){const w=e[p],{[l]:x,[u]:y}=w,g=w._stacks||(w._stacks={});f=g[u]=yW(r,d,x),f[a]=y,f._top=G_(f,o,!0,s.type),f._bottom=G_(f,o,!1,s.type);const m=f._visualValues||(f._visualValues={});m[a]=y}}function Pg(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function vW(t,e){return fc(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function bW(t,e,n){return fc(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Oc(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const Rg=t=>t==="reset"||t==="none",Q_=(t,e)=>e?t:Object.assign({},t),wW=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:m2(n,!0),values:null};class Tl{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Tg(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Oc(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(h,f,p,w)=>h==="x"?f:h==="r"?w:p,i=n.xAxisID=st(s.xAxisID,Pg(e,"x")),o=n.yAxisID=st(s.yAxisID,Pg(e,"y")),a=n.rAxisID=st(s.rAxisID,Pg(e,"r")),l=n.indexAxis,u=n.iAxisID=r(l,i,o,a),d=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&O_(this._data,this),e._stacked&&Oc(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(it(n)){const r=this._cachedMeta;this._data=mW(n,r)}else if(s!==n){if(s){O_(s,this);const r=this._cachedMeta;Oc(r),r._parsed=[]}n&&Object.isExtensible(n)&&w8(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=Tg(n.vScale,n),n.stack!==s.stack&&(r=!0,Oc(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(Y_(this,n._parsed),n._stacked=Tg(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,u=e>0&&s._parsed[e-1],d,h,f;if(this._parsing===!1)s._parsed=r,s._sorted=!0,f=r;else{hn(r[e])?f=this.parseArrayData(s,r,e,n):it(r[e])?f=this.parseObjectData(s,r,e,n):f=this.parsePrimitiveData(s,r,e,n);const p=()=>h[a]===null||u&&h[a]<u[a];for(d=0;d<n;++d)s._parsed[d+e]=h=f[d],l&&(p()&&(l=!1),u=h);s._sorted=l}o&&Y_(this,f)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,u=i.getLabels(),d=i===o,h=new Array(r);let f,p,w;for(f=0,p=r;f<p;++f)w=f+s,h[f]={[a]:d||i.parse(u[w],w),[l]:o.parse(n[w],w)};return h}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,u,d,h;for(l=0,u=r;l<u;++l)d=l+s,h=n[d],a[l]={x:i.parse(h[0],d),y:o.parse(h[1],d)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=new Array(r);let d,h,f,p;for(d=0,h=r;d<h;++d)f=d+s,p=n[f],u[d]={x:i.parse(xa(p,a),f),y:o.parse(xa(p,l),f)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:m2(r,!0),values:n._stacks[e.axis]._visualValues};return K_(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=K_(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=wW(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=xW(a);let f,p;function w(){p=r[f];const x=p[a.axis];return!Us(p[e.axis])||d>x||h<x}for(f=0;f<o&&!(!w()&&(this.updateRangeFromParsed(u,e,p,l),i));++f);if(i){for(f=o-1;f>=0;--f)if(!w()){this.updateRangeFromParsed(u,e,p,l);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],Us(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=pW(st(this.options.clip,fW(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(e,i,a,l),d=a;d<a+l;++d){const h=r[d];h.hidden||(h.active&&u?o.push(h):h.draw(e,i))}for(d=0;d<o.length;++d)o[d].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=bW(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=vW(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&nd(s);if(a)return Q_(a,l);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],f=u.getOptionScopes(this.getDataset(),d),p=Object.keys(Xt.elements[e]),w=()=>this.getContext(s,r,n),x=u.resolveNamedOptions(f,p,w,h);return x.$shared&&(x.$shared=l,i[o]=Object.freeze(Q_(x,l))),x}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,n),f=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(f,this.getContext(e,s,n))}const u=new p2(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Rg(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){Rg(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!Rg(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,u]of this._syncList)this[a](l,u);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=u=>{for(u.length+=n,a=u.length-1;a>=o;a--)u[a]=u[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Oc(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}$e(Tl,"defaults",{}),$e(Tl,"datasetElementType",null),$e(Tl,"dataElementType",null);function kW(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=n.length;r<i;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=ZT(s.sort((r,i)=>r-i))}return t._cache.$bar}function _W(t){const e=t.iScale,n=kW(e,t.type);let s=e._length,r,i,o,a;const l=()=>{o===32767||o===-32768||(nd(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(r=0,i=n.length;r<i;++r)o=e.getPixelForValue(n[r]),l();for(a=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),l();return s}function SW(t,e,n,s){const r=n.barThickness;let i,o;return wt(r)?(i=e.min*n.categoryPercentage,o=n.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:e.pixels[t]-i/2}}function jW(t,e,n,s){const r=e.pixels,i=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const u=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:n.barPercentage,start:u}}function CW(t,e,n,s){const r=n.parse(t[0],s),i=n.parse(t[1],s),o=Math.min(r,i),a=Math.max(r,i);let l=o,u=a;Math.abs(o)>Math.abs(a)&&(l=a,u=o),e[n.axis]=u,e._custom={barStart:l,barEnd:u,start:r,end:i,min:o,max:a}}function g2(t,e,n,s){return hn(t)?CW(t,e,n,s):e[n.axis]=n.parse(t,s),e}function X_(t,e,n,s){const r=t.iScale,i=t.vScale,o=r.getLabels(),a=r===i,l=[];let u,d,h,f;for(u=n,d=n+s;u<d;++u)f=e[u],h={},h[r.axis]=a||r.parse(o[u],u),l.push(g2(f,h,i,u));return l}function Ag(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function NW(t,e,n){return t!==0?no(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function EW(t){let e,n,s,r,i;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:n,end:s,reverse:e,top:r,bottom:i}}function TW(t,e,n,s){let r=e.borderSkipped;const i={};if(!r){t.borderSkipped=i;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:u,bottom:d}=EW(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(i[J_(d,o,a,l)]=!0,r=u)),i[J_(r,o,a,l)]=!0,t.borderSkipped=i}function J_(t,e,n,s){return s?(t=PW(t,e,n),t=Z_(t,n,e)):t=Z_(t,e,n),t}function PW(t,e,n){return t===e?n:t===n?e:t}function Z_(t,e,n){return t==="start"?e:t==="end"?n:t}function RW(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class bf extends Tl{parsePrimitiveData(e,n,s,r){return X_(e,n,s,r)}parseArrayData(e,n,s,r){return X_(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,u=i.axis==="x"?a:l,d=o.axis==="x"?a:l,h=[];let f,p,w,x;for(f=s,p=s+r;f<p;++f)x=n[f],w={},w[i.axis]=i.parse(xa(x,u),f),h.push(g2(xa(x,d),w,o,f));return h}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const i=s._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,i=this.getParsed(e),o=i._custom,a=Ag(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),u=a.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(n,r);for(let p=n;p<n+s;p++){const w=this.getParsed(p),x=i||wt(w[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),y=this._calculateBarIndexPixels(p,d),g=(w._stacks||{})[a.axis],m={horizontal:u,base:x.base,enableBorderRadius:!g||Ag(w._custom)||o===g._top||o===g._bottom,x:u?x.head:y.center,y:u?y.center:x.head,height:u?y.size:Math.abs(x.size),width:u?Math.abs(x.size):y.size};f&&(m.options=h||this.resolveDataElementOptions(p,e[p].active?"active":r));const b=m.options||e[p].options;TW(m,b,g,o),RW(m,b,d.ratio),this.updateElement(e[p],p,m,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[s.axis],u=d=>{const h=d._parsed.find(p=>p[s.axis]===l),f=h&&h[d.vScale.axis];if(wt(f)||isNaN(f))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((i===!1||o.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[st(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),i=n!==void 0?r.indexOf(n):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let i,o;for(i=0,o=n.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const a=e.barThickness;return{min:a||_W(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),u=l._custom,d=Ag(u);let h=l[n.axis],f=0,p=s?this.applyStack(n,l,s):h,w,x;p!==h&&(f=p-h,p=h),d&&(h=u.barStart,p=u.barEnd-u.barStart,h!==0&&no(h)!==no(u.barEnd)&&(f=0),f+=h);const y=!wt(i)&&!d?i:f;let g=n.getPixelForValue(y);if(this.chart.getDataVisibility(e)?w=n.getPixelForValue(f+p):w=g,x=w-g,Math.abs(x)<o){x=NW(x,n,a)*o,h===a&&(g-=x/2);const m=n.getPixelForDecimal(0),b=n.getPixelForDecimal(1),k=Math.min(m,b),_=Math.max(m,b);g=Math.max(Math.min(g,_),k),w=g+x,s&&!d&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(w)-n.getValueForPixel(g))}if(g===n.getPixelForValue(a)){const m=no(x)*n.getLineWidthForValue(a)/2;g+=m,x-=m}return{size:x,base:g,head:w,center:w+x/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,i=r.skipNull,o=st(r.maxBarThickness,1/0);let a,l;const u=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(e):n.stackCount,h=r.barThickness==="flex"?jW(e,n,r,d*u):SW(e,n,r,d*u),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(st(f,this.getFirstScaleIdForIndexAxis())),w=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+p;a=h.start+h.chunk*w+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[n.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}$e(bf,"id","bar"),$e(bf,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),$e(bf,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function AW(t,e,n){let s=1,r=1,i=0,o=0;if(e<nn){const a=t,l=a+e,u=Math.cos(a),d=Math.sin(a),h=Math.cos(l),f=Math.sin(l),p=(b,k,_)=>pp(b,a,l,!0)?1:Math.max(k,k*n,_,_*n),w=(b,k,_)=>pp(b,a,l,!0)?-1:Math.min(k,k*n,_,_*n),x=p(0,u,h),y=p(cn,d,f),g=w(Et,u,h),m=w(Et+cn,d,f);s=(x-g)/2,r=(y-m)/2,i=-(x+g)/2,o=-(y+m)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class fl extends Tl{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=l=>+s[l];if(it(s[e])){const{key:l="value"}=this._parsing;i=u=>+xa(s[u],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=i(o)}}_getRotation(){return Zr(this.options.rotation-90)}_getCircumference(){return Zr(this.options.circumference)}_getRotationExtents(){let e=nn,n=-nn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),n=Math.max(n,i+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(s.width,s.height)-o)/2,0),l=Math.min(i8(this.options.cutout,a),1),u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:w,offsetY:x}=AW(h,d,l),y=(s.width-o)/f,g=(s.height-o)/p,m=Math.max(Math.min(y,g)/2,0),b=GT(this.options.radius,m),k=Math.max(b*l,0),_=(b-k)/this._getVisibleDatasetWeightTotal();this.offsetX=w*b,this.offsetY=x*b,r.total=this.calculateTotal(),this.outerRadius=b-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*u,0),this.updateElements(i,0,i.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/nn)}updateElements(e,n,s,r){const i=r==="reset",o=this.chart,a=o.chartArea,u=o.options.animation,d=(a.left+a.right)/2,h=(a.top+a.bottom)/2,f=i&&u.animateScale,p=f?0:this.innerRadius,w=f?0:this.outerRadius,{sharedOptions:x,includeOptions:y}=this._getSharedOptions(n,r);let g=this._getRotation(),m;for(m=0;m<n;++m)g+=this._circumference(m,i);for(m=n;m<n+s;++m){const b=this._circumference(m,i),k=e[m],_={x:d+this.offsetX,y:h+this.offsetY,startAngle:g,endAngle:g+b,circumference:b,outerRadius:w,innerRadius:p};y&&(_.options=x||this.resolveDataElementOptions(m,k.active?"active":r)),g+=b,this.updateElement(k,m,_,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?nn*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=D0(n._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,i,o,a,l;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);n=Math.max(n,i.offset||0,i.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(st(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}$e(fl,"id","doughnut"),$e(fl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),$e(fl,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),$e(fl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((l,u)=>{const h=e.getDatasetMeta(0).controller.getStyle(u);return{text:l,fillStyle:h.backgroundColor,fontColor:i,hidden:!e.getDataVisibility(u),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(a||h.borderRadius),index:u}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});class My extends fl{}$e(My,"id","pie"),$e(My,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Ro(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class V0{constructor(e){$e(this,"options");this.options=e||{}}static override(e){Object.assign(V0.prototype,e)}init(){}formats(){return Ro()}parse(){return Ro()}format(){return Ro()}add(){return Ro()}diff(){return Ro()}startOf(){return Ro()}endOf(){return Ro()}}var OW={_date:V0};function MW(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const u=a._reversePixels?v8:Ay;if(s){if(r._sharedOptions){const d=i[0],h=typeof d.getRange=="function"&&d.getRange(e);if(h){const f=u(i,e,n-h),p=u(i,e,n+h);return{lo:f.lo,hi:p.hi}}}}else{const d=u(i,e,n);if(l){const{vScale:h}=r._cachedMeta,{_parsed:f}=t,p=f.slice(0,d.lo+1).reverse().findIndex(x=>!wt(x[h.axis]));d.lo-=Math.max(0,p);const w=f.slice(d.hi).findIndex(x=>!wt(x[h.axis]));d.hi+=Math.max(0,w)}return d}}return{lo:0,hi:i.length-1}}function rm(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:u,data:d}=i[a],{lo:h,hi:f}=MW(i[a],e,o,r);for(let p=h;p<=f;++p){const w=d[p];w.skip||s(w,u,p)}}}function IW(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Og(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||rm(t,n,e,function(a,l,u){!r&&!o2(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:u})},!0),i}function DW(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],s),{angle:h}=XT(o,{x:e.x,y:e.y});pp(h,u,d)&&r.push({element:o,datasetIndex:a,index:l})}return rm(t,n,e,i),r}function LW(t,e,n,s,r,i){let o=[];const a=IW(n);let l=Number.POSITIVE_INFINITY;function u(d,h,f){const p=d.inRange(e.x,e.y,r);if(s&&!p)return;const w=d.getCenterPoint(r);if(!(!!i||t.isPointInArea(w))&&!p)return;const y=a(e,w);y<l?(o=[{element:d,datasetIndex:h,index:f}],l=y):y===l&&o.push({element:d,datasetIndex:h,index:f})}return rm(t,n,e,u),o}function Mg(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?DW(t,e,n,r):LW(t,e,n,s,r,i)}function eS(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return rm(t,n,e,(l,u,d)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:u,index:d}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var $W={modes:{index(t,e,n,s){const r=Do(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?Og(t,r,i,s,o):Mg(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const d=a[0].index,h=u.data[d];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:d})}),l):[]},dataset(t,e,n,s){const r=Do(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?Og(t,r,i,s,o):Mg(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,u=t.getDatasetMeta(l).data;a=[];for(let d=0;d<u.length;++d)a.push({element:u[d],datasetIndex:l,index:d})}return a},point(t,e,n,s){const r=Do(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Og(t,r,i,s,o)},nearest(t,e,n,s){const r=Do(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Mg(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=Do(e,t);return eS(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Do(e,t);return eS(t,r,"y",n.intersect,s)}}};const x2=["left","top","right","bottom"];function Mc(t,e){return t.filter(n=>n.pos===e)}function tS(t,e){return t.filter(n=>x2.indexOf(n.pos)===-1&&n.box.axis===e)}function Ic(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function FW(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function zW(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!x2.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function BW(t,e){const n=zW(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,u=n[a.stack],d=u&&a.stackWeight/u.weight;a.horizontal?(a.width=d?d*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=d?d*r:l&&e.availableHeight)}return n}function UW(t){const e=FW(t),n=Ic(e.filter(u=>u.box.fullSize),!0),s=Ic(Mc(e,"left"),!0),r=Ic(Mc(e,"right")),i=Ic(Mc(e,"top"),!0),o=Ic(Mc(e,"bottom")),a=tS(e,"x"),l=tS(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:Mc(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function nS(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function y2(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function HW(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!it(r)){n.size&&(t[r]-=n.size);const h=s[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?i.height:i.width),n.size=h.size/h.count,t[r]+=n.size}i.getPadding&&y2(o,i.getPadding());const a=Math.max(0,e.outerWidth-nS(o,t,"left","right")),l=Math.max(0,e.outerHeight-nS(o,t,"top","bottom")),u=a!==t.w,d=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:u,other:d}:{same:d,other:u}}function WW(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function VW(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function Yc(t,e,n,s){const r=[];let i,o,a,l,u,d;for(i=0,o=t.length,u=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,VW(a.horizontal,e));const{same:h,other:f}=HW(e,n,a,s);u|=h&&r.length,d=d||f,l.fullSize||r.push(a)}return u&&Yc(r,e,n,s)||d}function Bh(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function sS(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,u=s[a.stack]||{placed:0,weight:1},d=a.stackWeight/u.weight||1;if(a.horizontal){const h=e.w*d,f=u.size||l.height;nd(u.start)&&(o=u.start),l.fullSize?Bh(l,r.left,o,n.outerWidth-r.right-r.left,f):Bh(l,e.left+u.placed,o,h,f),u.start=o,u.placed+=h,o=l.bottom}else{const h=e.h*d,f=u.size||l.width;nd(u.start)&&(i=u.start),l.fullSize?Bh(l,i,r.top,f,n.outerHeight-r.bottom-r.top):Bh(l,i,e.top+u.placed,f,h),u.start=i,u.placed+=h,i=l.right}}e.x=i,e.y=o}var Ui={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=cr(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=UW(t.boxes),l=a.vertical,u=a.horizontal;pt(t.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const d=l.reduce((x,y)=>y.box.options&&y.box.options.display===!1?x:x+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/d,hBoxMaxHeight:o/2}),f=Object.assign({},r);y2(f,cr(s));const p=Object.assign({maxPadding:f,w:i,h:o,x:r.left,y:r.top},r),w=BW(l.concat(u),h);Yc(a.fullSize,p,h,w),Yc(l,p,h,w),Yc(u,p,h,w)&&Yc(l,p,h,w),WW(p),sS(a.leftAndTop,p,h,w),p.x+=p.w,p.y+=p.h,sS(a.rightAndBottom,p,h,w),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},pt(a.chartArea,x=>{const y=x.box;Object.assign(y,t.chartArea),y.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class v2{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class qW extends v2{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const wf="$chartjs",KW={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},rS=t=>t===null||t==="";function GW(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[wf]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",rS(r)){const i=W_(t,"width");i!==void 0&&(t.width=i)}if(rS(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=W_(t,"height");i!==void 0&&(t.height=i)}return t}const b2=sW?{passive:!0}:!1;function YW(t,e,n){t&&t.addEventListener(e,n,b2)}function QW(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,b2)}function XW(t,e){const n=KW[t.type]||t.type,{x:s,y:r}=Do(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function yp(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function JW(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||yp(a.addedNodes,s),o=o&&!yp(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function ZW(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||yp(a.removedNodes,s),o=o&&!yp(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const sd=new Map;let iS=0;function w2(){const t=window.devicePixelRatio;t!==iS&&(iS=t,sd.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function eV(t,e){sd.size||window.addEventListener("resize",w2),sd.set(t,e)}function tV(t){sd.delete(t),sd.size||window.removeEventListener("resize",w2)}function nV(t,e,n){const s=t.canvas,r=s&&W0(s);if(!r)return;const i=t2((a,l)=>{const u=r.clientWidth;n(a,l),u<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],u=l.contentRect.width,d=l.contentRect.height;u===0&&d===0||i(u,d)});return o.observe(r),eV(t,i),o}function Ig(t,e,n){n&&n.disconnect(),e==="resize"&&tV(t)}function sV(t,e,n){const s=t.canvas,r=t2(i=>{t.ctx!==null&&n(XW(i,t))},t);return YW(s,e,r),r}class rV extends v2{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(GW(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[wf])return!1;const s=n[wf].initial;["height","width"].forEach(i=>{const o=s[i];wt(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[wf],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:JW,detach:ZW,resize:nV}[n]||sV;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Ig,detach:Ig,resize:Ig}[n]||QW)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return nW(e,n,s,r)}isAttached(e){const n=e&&W0(e);return!!(n&&n.isConnected)}}function iV(t){return!H0()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?qW:rV}var Yh;let pc=(Yh=class{constructor(){$e(this,"x");$e(this,"y");$e(this,"active",!1);$e(this,"options");$e(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return fp(this.x)&&fp(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},$e(Yh,"defaults",{}),$e(Yh,"defaultRoutes"),Yh);function oV(t,e){const n=t.options.ticks,s=aV(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?cV(e):[],o=i.length,a=i[0],l=i[o-1],u=[];if(o>r)return uV(e,u,i,o/r),u;const d=lV(i,e,r);if(o>0){let h,f;const p=o>1?Math.round((l-a)/(o-1)):null;for(Uh(e,u,d,wt(p)?0:a-p,a),h=0,f=o-1;h<f;h++)Uh(e,u,d,i[h],i[h+1]);return Uh(e,u,d,l,wt(p)?e.length:l+p),u}return Uh(e,u,d),u}function aV(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function lV(t,e,n){const s=dV(t),r=e.length/n;if(!s)return Math.max(r,1);const i=h8(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function cV(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function uV(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function Uh(t,e,n,s,r){const i=st(s,0),o=Math.min(st(r,t.length),t.length);let a=0,l,u,d;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),d=i;d<0;)a++,d=Math.round(i+a*n);for(u=Math.max(i,0);u<o;u++)u===d&&(e.push(t[u]),a++,d=Math.round(i+a*n))}function dV(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const hV=t=>t==="left"?"right":t==="right"?"left":t,oS=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,aS=(t,e)=>Math.min(e||t,t);function lS(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function fV(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(l-i,o-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(r-1))/2,l+=r<e?u:-u,l<i-a||l>o+a)))return l}function pV(t,e){pt(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function Dc(t){return t.drawTicks?t.tickLength:0}function cS(t,e){if(!t.display)return 0;const n=ts(t.font,e),s=cr(t.padding);return(hn(t.text)?t.text.length:1)*n.lineHeight+s.height}function mV(t,e){return fc(t,{scale:e,type:"scale"})}function gV(t,e,n){return fc(t,{tick:n,index:e,type:"tick"})}function xV(t,e,n){let s=n2(t);return(n&&e!=="right"||!n&&e==="right")&&(s=hV(s)),s}function yV(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:u,scales:d}=l;let h=0,f,p,w;const x=o-r,y=a-i;if(t.isHorizontal()){if(p=ds(s,i,a),it(n)){const g=Object.keys(n)[0],m=n[g];w=d[g].getPixelForValue(m)+x-e}else n==="center"?w=(u.bottom+u.top)/2+x-e:w=oS(t,n,e);f=a-i}else{if(it(n)){const g=Object.keys(n)[0],m=n[g];p=d[g].getPixelForValue(m)-y+e}else n==="center"?p=(u.left+u.right)/2-y+e:p=oS(t,n,e);w=ds(s,o,r),h=n==="left"?-cn:cn}return{titleX:p,titleY:w,maxWidth:f,rotation:h}}class mc extends pc{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=mr(e,Number.POSITIVE_INFINITY),n=mr(n,Number.NEGATIVE_INFINITY),s=mr(s,Number.POSITIVE_INFINITY),r=mr(r,Number.NEGATIVE_INFINITY),{min:mr(e,s),max:mr(n,r),minDefined:Us(e),maxDefined:Us(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,u=a.length;l<u;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:mr(n,mr(s,n)),max:mr(s,mr(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Nt(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=B8(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?lS(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=oV(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Nt(this.options.afterUpdate,[this])}beforeSetDimensions(){Nt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Nt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Nt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Nt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=Nt(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){Nt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Nt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=aS(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,u;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,f=d.highest.height,p=es(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/s:p/(s-1),h+6>a&&(a=p/(s-(e.offset?.5:1)),l=this.maxHeight-Dc(e.grid)-n.padding-cS(e.title,this.chart.options.font),u=Math.sqrt(h*h+f*f),o=g8(Math.min(Math.asin(es((d.highest.height+6)/a,-1,1)),Math.asin(es(l/u,-1,1))-Math.asin(es(f/u,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Nt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Nt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=cS(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=Dc(i)+l):(e.height=this.maxHeight,e.width=Dc(i)+l),s.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:f}=this._getLabelSizes(),p=s.padding*2,w=Zr(this.labelRotation),x=Math.cos(w),y=Math.sin(w);if(a){const g=s.mirror?0:y*h.width+x*f.height;e.height=Math.min(this.maxHeight,e.height+g+p)}else{const g=s.mirror?0:x*h.width+y*f.height;e.width=Math.min(this.maxWidth,e.width+g+p)}this._calculatePadding(u,d,y,x)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,u=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;l?u?(f=r*e.width,p=s*n.height):(f=s*e.height,p=r*n.width):i==="start"?p=n.width:i==="end"?f=e.width:i!=="inner"&&(f=e.width/2,p=n.width/2),this.paddingLeft=Math.max((f-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((p-h+o)*this.width/(this.width-h),0)}else{let d=n.height/2,h=e.height/2;i==="start"?(d=0,h=e.height):i==="end"&&(d=n.height,h=0),this.paddingTop=d+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Nt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)wt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=lS(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/aS(n,s));let u=0,d=0,h,f,p,w,x,y,g,m,b,k,_;for(h=0;h<n;h+=l){if(w=e[h].label,x=this._resolveTickFontOptions(h),r.font=y=x.string,g=i[y]=i[y]||{data:{},gc:[]},m=x.lineHeight,b=k=0,!wt(w)&&!hn(w))b=$_(r,g.data,g.gc,b,w),k=m;else if(hn(w))for(f=0,p=w.length;f<p;++f)_=w[f],!wt(_)&&!hn(_)&&(b=$_(r,g.data,g.gc,b,_),k+=m);o.push(b),a.push(k),u=Math.max(b,u),d=Math.max(k,d)}pV(i,n);const C=o.indexOf(u),S=a.indexOf(d),j=T=>({width:o[T]||0,height:a[T]||0});return{first:j(0),last:j(n-1),widest:j(C),highest:j(S),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return y8(this._alignToPixels?Po(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=gV(this.getContext(),e,s))}return this.$context||(this.$context=mV(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Zr(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=Dc(i),p=[],w=a.setContext(this.getContext()),x=w.display?w.width:0,y=x/2,g=function(A){return Po(s,A,x)};let m,b,k,_,C,S,j,T,P,L,D,O;if(o==="top")m=g(this.bottom),S=this.bottom-f,T=m-y,L=g(e.top)+y,O=e.bottom;else if(o==="bottom")m=g(this.top),L=e.top,O=g(e.bottom)-y,S=m+y,T=this.top+f;else if(o==="left")m=g(this.right),C=this.right-f,j=m-y,P=g(e.left)+y,D=e.right;else if(o==="right")m=g(this.left),P=e.left,D=g(e.right)-y,C=m+y,j=this.left+f;else if(n==="x"){if(o==="center")m=g((e.top+e.bottom)/2+.5);else if(it(o)){const A=Object.keys(o)[0],W=o[A];m=g(this.chart.scales[A].getPixelForValue(W))}L=e.top,O=e.bottom,S=m+y,T=S+f}else if(n==="y"){if(o==="center")m=g((e.left+e.right)/2);else if(it(o)){const A=Object.keys(o)[0],W=o[A];m=g(this.chart.scales[A].getPixelForValue(W))}C=m-y,j=C-f,P=e.left,D=e.right}const $=st(r.ticks.maxTicksLimit,h),I=Math.max(1,Math.ceil(h/$));for(b=0;b<h;b+=I){const A=this.getContext(b),W=i.setContext(A),N=a.setContext(A),E=W.lineWidth,F=W.color,V=N.dash||[],H=N.dashOffset,he=W.tickWidth,ee=W.tickColor,U=W.tickBorderDash||[],Q=W.tickBorderDashOffset;k=fV(this,b,l),k!==void 0&&(_=Po(s,k,E),u?C=j=P=D=_:S=T=L=O=_,p.push({tx1:C,ty1:S,tx2:j,ty2:T,x1:P,y1:L,x2:D,y2:O,width:E,color:F,borderDash:V,borderDashOffset:H,tickWidth:he,tickColor:ee,tickBorderDash:U,tickBorderDashOffset:Q}))}return this._ticksLength=h,this._borderValue=m,p}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:u,padding:d,mirror:h}=i,f=Dc(s.grid),p=f+d,w=h?-d:p,x=-Zr(this.labelRotation),y=[];let g,m,b,k,_,C,S,j,T,P,L,D,O="middle";if(r==="top")C=this.bottom-w,S=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+w,S=this._getXAxisLabelAlignment();else if(r==="left"){const I=this._getYAxisLabelAlignment(f);S=I.textAlign,_=I.x}else if(r==="right"){const I=this._getYAxisLabelAlignment(f);S=I.textAlign,_=I.x}else if(n==="x"){if(r==="center")C=(e.top+e.bottom)/2+p;else if(it(r)){const I=Object.keys(r)[0],A=r[I];C=this.chart.scales[I].getPixelForValue(A)+p}S=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")_=(e.left+e.right)/2-p;else if(it(r)){const I=Object.keys(r)[0],A=r[I];_=this.chart.scales[I].getPixelForValue(A)}S=this._getYAxisLabelAlignment(f).textAlign}n==="y"&&(l==="start"?O="top":l==="end"&&(O="bottom"));const $=this._getLabelSizes();for(g=0,m=a.length;g<m;++g){b=a[g],k=b.label;const I=i.setContext(this.getContext(g));j=this.getPixelForTick(g)+i.labelOffset,T=this._resolveTickFontOptions(g),P=T.lineHeight,L=hn(k)?k.length:1;const A=L/2,W=I.color,N=I.textStrokeColor,E=I.textStrokeWidth;let F=S;o?(_=j,S==="inner"&&(g===m-1?F=this.options.reverse?"left":"right":g===0?F=this.options.reverse?"right":"left":F="center"),r==="top"?u==="near"||x!==0?D=-L*P+P/2:u==="center"?D=-$.highest.height/2-A*P+P:D=-$.highest.height+P/2:u==="near"||x!==0?D=P/2:u==="center"?D=$.highest.height/2-A*P:D=$.highest.height-L*P,h&&(D*=-1),x!==0&&!I.showLabelBackdrop&&(_+=P/2*Math.sin(x))):(C=j,D=(1-L)*P/2);let V;if(I.showLabelBackdrop){const H=cr(I.backdropPadding),he=$.heights[g],ee=$.widths[g];let U=D-H.top,Q=0-H.left;switch(O){case"middle":U-=he/2;break;case"bottom":U-=he;break}switch(S){case"center":Q-=ee/2;break;case"right":Q-=ee;break;case"inner":g===m-1?Q-=ee:g>0&&(Q-=ee/2);break}V={left:Q,top:U,width:ee+H.width,height:he+H.height,color:I.backdropColor}}y.push({label:k,font:T,textOffset:D,options:{rotation:x,color:W,strokeColor:N,strokeWidth:E,textAlign:F,textBaseline:O,translation:[_,C],backdrop:V}})}return y}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Zr(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let u,d;return n==="left"?r?(d=this.right+i,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d+=l)):(d=this.right-a,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+i,s==="near"?u="right":s==="center"?(u="center",d-=l/2):(u="left",d-=l)):(d=this.left+a,s==="near"?u="left":s==="center"?(u="center",d+=l/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,d,h,f;this.isHorizontal()?(u=Po(e,this.left,o)-o/2,d=Po(e,this.right,a)+a/2,h=f=l):(h=Po(e,this.top,o)-o/2,f=Po(e,this.bottom,a)+a/2,u=d=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(u,h),n.lineTo(d,f),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&L0(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,u=o.label,d=o.textOffset;mp(s,u,0,d,l,a)}r&&$0(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=ts(s.font),o=cr(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||it(n)?(l+=o.bottom,hn(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:u,titleY:d,maxWidth:h,rotation:f}=yV(this,l,n,a);mp(e,s.text,0,0,i,{color:s.color,maxWidth:h,rotation:f,textAlign:xV(a,n,r),textBaseline:"middle",translation:[u,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=st(e.grid&&e.grid.z,-1),r=st(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==mc.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return ts(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Hh{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;wV(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,vV(e,o,s),this.override&&Xt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in Xt[r]&&(delete Xt[r][s],this.override&&delete ya[s])}}function vV(t,e,n){const s=td(Object.create(null),[n?Xt.get(n):{},Xt.get(e),t.defaults]);Xt.set(e,s),t.defaultRoutes&&bV(e,t.defaultRoutes),t.descriptors&&Xt.describe(e,t.descriptors)}function bV(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Xt.route(i,r,l,a)})}function wV(t){return"id"in t&&"defaults"in t}class kV{constructor(){this.controllers=new Hh(Tl,"datasets",!0),this.elements=new Hh(pc,"elements"),this.plugins=new Hh(Object,"plugins"),this.scales=new Hh(mc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):pt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=M0(e);Nt(s["before"+r],[],s),n[e](s),Nt(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var yr=new kV;class _V{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(Nt(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){wt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=st(s.options&&s.options.plugins,{}),i=SV(s);return r===!1&&!n?[]:CV(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function SV(t){const e={},n=[],s=Object.keys(yr.plugins.items);for(let i=0;i<s.length;i++)n.push(yr.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function jV(t,e){return!e&&t===!1?null:t===!0?{}:t}function CV(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,u=jV(s[l],r);u!==null&&i.push({plugin:a,options:NV(t.config,{plugin:a,local:n[l]},u,o)})}return i}function NV(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Iy(t,e){const n=Xt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function EV(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function TV(t,e){return t===e?"_index_":"_value_"}function uS(t){if(t==="x"||t==="y"||t==="r")return t}function PV(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Dy(t,...e){if(uS(t))return t;for(const n of e){const s=n.axis||PV(n.position)||t.length>1&&uS(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function dS(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function RV(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return dS(t,"x",n[0])||dS(t,"y",n[0])}return{}}function AV(t,e){const n=ya[t.type]||{scales:{}},s=e.scales||{},r=Iy(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!it(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=Dy(o,a,RV(o,t),Xt.scales[a.type]),u=TV(l,r),d=n.scales||{};i[o]=du(Object.create(null),[{axis:l},a,d[l],d[u]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||Iy(a,e),d=(ya[a]||{}).scales||{};Object.keys(d).forEach(h=>{const f=EV(h,l),p=o[f+"AxisID"]||f;i[p]=i[p]||Object.create(null),du(i[p],[{axis:f},s[p],d[h]])})}),Object.keys(i).forEach(o=>{const a=i[o];du(a,[Xt.scales[a.type],Xt.scale])}),i}function k2(t){const e=t.options||(t.options={});e.plugins=st(e.plugins,{}),e.scales=AV(t,e)}function _2(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function OV(t){return t=t||{},t.data=_2(t.data),k2(t),t}const hS=new Map,S2=new Set;function Wh(t,e){let n=hS.get(t);return n||(n=e(),hS.set(t,n),S2.add(n)),n}const Lc=(t,e,n)=>{const s=xa(e,n);s!==void 0&&t.add(s)};class MV{constructor(e){this._config=OV(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=_2(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),k2(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Wh(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Wh(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Wh(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Wh(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(d=>{e&&(l.add(e),d.forEach(h=>Lc(l,e,h))),d.forEach(h=>Lc(l,r,h)),d.forEach(h=>Lc(l,ya[i]||{},h)),d.forEach(h=>Lc(l,Xt,h)),d.forEach(h=>Lc(l,Oy,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),S2.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,ya[n]||{},Xt.datasets[n]||{},{type:n},Xt,Oy]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=fS(this._resolverCache,e,r);let l=o;if(DV(o,n)){i.$shared=!1,s=uo(s)?s():s;const u=this.createResolver(e,s,a);l=Zl(o,s,u)}for(const u of n)i[u]=l[u];return i}createResolver(e,n,s=[""],r){const{resolver:i}=fS(this._resolverCache,e,s);return it(n)?Zl(i,n,void 0,r):i}}function fS(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:z0(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const IV=t=>it(t)&&Object.getOwnPropertyNames(t).some(e=>uo(t[e]));function DV(t,e){const{isScriptable:n,isIndexable:s}=l2(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(uo(a)||IV(a))||o&&hn(a))return!0}return!1}var LV="4.5.1";const $V=["top","bottom","left","right","chartArea"];function pS(t,e){return t==="top"||t==="bottom"||$V.indexOf(t)===-1&&e==="x"}function mS(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function gS(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Nt(n&&n.onComplete,[t],e)}function FV(t){const e=t.chart,n=e.options.animation;Nt(n&&n.onProgress,[t],e)}function j2(t){return H0()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const kf={},xS=t=>{const e=j2(t);return Object.values(kf).filter(n=>n.canvas===e).pop()};function zV(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function BV(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}class Sr{static register(...e){yr.add(...e),yS()}static unregister(...e){yr.remove(...e),yS()}constructor(e,n){const s=this.config=new MV(n),r=j2(e),i=xS(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||iV(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,u=l&&l.height,d=l&&l.width;if(this.id=r8(),this.ctx=a,this.canvas=l,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new _V,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=k8(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],kf[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}zr.listen(this,"complete",gS),zr.listen(this,"progress",FV),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return wt(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return yr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():H_(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return F_(this.canvas,this.ctx),this}stop(){return zr.stop(this),this}resize(e,n){zr.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,H_(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Nt(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};pt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=Dy(o,a),u=l==="r",d=l==="x";return{options:a,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),pt(i,o=>{const a=o.options,l=a.id,u=Dy(l,a),d=st(a.type,o.dtype);(a.position===void 0||pS(a.position,u)!==pS(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in s&&s[l].type===d)h=s[l];else{const f=yr.getScale(d);h=new f({id:l,type:d,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(a,e)}),pt(r,(o,a)=>{o||delete s[a]}),pt(s,o=>{Ui.configure(this,o,o.options),Ui.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(mS("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||Iy(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=yr.getController(a),{datasetElementType:u,dataElementType:d}=Xt.datasets[a];Object.assign(l,{dataElementType:yr.getElement(d),datasetElementType:u&&yr.getElement(u)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){pt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),f=!r&&i.indexOf(h)===-1;h.buildOrUpdateElements(f),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||pt(i,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(mS("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){pt(this.scales,e=>{Ui.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!T_(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;zV(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!T_(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ui.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],pt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,uo(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(zr.has(this)?this.attached&&!zr.running(this)&&zr.start(this):(this.draw(),gS({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=aW(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&L0(n,r),e.controller.draw(),r&&$0(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return o2(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=$W.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=fc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);nd(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),zr.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),F_(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete kf[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};pt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,u)=>{n.addEventListener(this,l,u),e[l]=u},r=(l,u)=>{e[l]&&(n.removeEventListener(this,l,u),delete e[l])},i=(l,u)=>{this.canvas&&this.resize(l,u)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){pt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},pt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!up(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,u)=>l.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=u8(e),u=BV(e,this._lastEvent,s,l);s&&(this._lastEvent=null,Nt(i.onHover,[e,a,this],this),l&&Nt(i.onClick,[e,a,this],this));const d=!up(a,r);return(d||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=u,d}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}$e(Sr,"defaults",Xt),$e(Sr,"instances",kf),$e(Sr,"overrides",ya),$e(Sr,"registry",yr),$e(Sr,"version",LV),$e(Sr,"getChart",xS);function yS(){return pt(Sr.instances,t=>t._plugins.invalidate())}function UV(t,e,n){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:u,borderJoinStyle:d}=l,h=Math.min(u/o,vr(s-n));if(t.beginPath(),t.arc(r,i,o-u/2,s+h/2,n-h/2),a>0){const f=Math.min(u/a,vr(s-n));t.arc(r,i,a+u/2,n-f/2,s+f/2,!0)}else{const f=Math.min(u/2,o*vr(s-n));if(d==="round")t.arc(r,i,f,n-Et/2,s+Et/2,!0);else if(d==="bevel"){const p=2*f*f,w=-p*Math.cos(n+Et/2)+r,x=-p*Math.sin(n+Et/2)+i,y=p*Math.cos(s+Et/2)+r,g=p*Math.sin(s+Et/2)+i;t.lineTo(w,x),t.lineTo(y,g)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function HV(t,e,n){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:a,innerRadius:l}=e;let u=r/a;t.beginPath(),t.arc(i,o,a,s-u,n+u),l>r?(u=r/l,t.arc(i,o,l,n+u,s-u,!0)):t.arc(i,o,r,n+cn,s-cn),t.closePath(),t.clip()}function WV(t){return F0(t,["outerStart","outerEnd","innerStart","innerEnd"])}function VV(t,e,n,s){const r=WV(t.options.borderRadius),i=(n-e)/2,o=Math.min(i,s*e/2),a=l=>{const u=(n-Math.min(i,l))*s/2;return es(l,0,Math.min(i,u))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:es(r.innerStart,0,o),innerEnd:es(r.innerEnd,0,o)}}function Ka(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function vp(t,e,n,s,r,i){const{x:o,y:a,startAngle:l,pixelMargin:u,innerRadius:d}=e,h=Math.max(e.outerRadius+s+n-u,0),f=d>0?d+s+n+u:0;let p=0;const w=r-l;if(s){const I=d>0?d-s:0,A=h>0?h-s:0,W=(I+A)/2,N=W!==0?w*W/(W+s):w;p=(w-N)/2}const x=Math.max(.001,w*h-n/Et)/h,y=(w-x)/2,g=l+y+p,m=r-y-p,{outerStart:b,outerEnd:k,innerStart:_,innerEnd:C}=VV(e,f,h,m-g),S=h-b,j=h-k,T=g+b/S,P=m-k/j,L=f+_,D=f+C,O=g+_/L,$=m-C/D;if(t.beginPath(),i){const I=(T+P)/2;if(t.arc(o,a,h,T,I),t.arc(o,a,h,I,P),k>0){const E=Ka(j,P,o,a);t.arc(E.x,E.y,k,P,m+cn)}const A=Ka(D,m,o,a);if(t.lineTo(A.x,A.y),C>0){const E=Ka(D,$,o,a);t.arc(E.x,E.y,C,m+cn,$+Math.PI)}const W=(m-C/f+(g+_/f))/2;if(t.arc(o,a,f,m-C/f,W,!0),t.arc(o,a,f,W,g+_/f,!0),_>0){const E=Ka(L,O,o,a);t.arc(E.x,E.y,_,O+Math.PI,g-cn)}const N=Ka(S,g,o,a);if(t.lineTo(N.x,N.y),b>0){const E=Ka(S,T,o,a);t.arc(E.x,E.y,b,g-cn,T)}}else{t.moveTo(o,a);const I=Math.cos(T)*h+o,A=Math.sin(T)*h+a;t.lineTo(I,A);const W=Math.cos(P)*h+o,N=Math.sin(P)*h+a;t.lineTo(W,N)}t.closePath()}function qV(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){vp(t,e,n,s,l,r);for(let u=0;u<i;++u)t.fill();isNaN(a)||(l=o+(a%nn||nn))}return vp(t,e,n,s,l,r),t.fill(),l}function KV(t,e,n,s,r){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:f,borderRadius:p}=l,w=l.borderAlign==="inner";if(!u)return;t.setLineDash(h||[]),t.lineDashOffset=f,w?(t.lineWidth=u*2,t.lineJoin=d||"round"):(t.lineWidth=u,t.lineJoin=d||"bevel");let x=e.endAngle;if(i){vp(t,e,n,s,x,r);for(let y=0;y<i;++y)t.stroke();isNaN(a)||(x=o+(a%nn||nn))}w&&HV(t,e,x),l.selfJoin&&x-o>=Et&&p===0&&d!=="miter"&&UV(t,e,x),i||(vp(t,e,n,s,x,r),t.stroke())}class Qc extends pc{constructor(n){super();$e(this,"circumference");$e(this,"endAngle");$e(this,"fullCircles");$e(this,"innerRadius");$e(this,"outerRadius");$e(this,"pixelMargin");$e(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:a}=XT(i,{x:n,y:s}),{startAngle:l,endAngle:u,innerRadius:d,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),p=(this.options.spacing+this.options.borderWidth)/2,w=st(f,u-l),x=pp(o,l,u)&&l!==u,y=w>=nn||x,g=Vo(a,d+p,h+p);return y&&g}getCenterPoint(n){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:u,spacing:d}=this.options,h=(i+o)/2,f=(a+l+d+u)/2;return{x:s+Math.cos(h)*f,y:r+Math.sin(h)*f}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,a=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>nn?Math.floor(r/nn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const u=1-Math.sin(Math.min(Et,r||0)),d=i*u;n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,qV(n,this,d,o,a),KV(n,this,d,o,a),n.restore()}}$e(Qc,"id","arc"),$e(Qc,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),$e(Qc,"defaultRoutes",{backgroundColor:"backgroundColor"}),$e(Qc,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function C2(t,e){const{x:n,y:s,base:r,width:i,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,u,d,h;return t.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),u=s-h,d=s+h):(h=i/2,a=n-h,l=n+h,u=Math.min(s,r),d=Math.max(s,r)),{left:a,top:u,right:l,bottom:d}}function Hi(t,e,n,s){return t?0:es(e,n,s)}function GV(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,i=a2(s);return{t:Hi(r.top,i.top,0,n),r:Hi(r.right,i.right,0,e),b:Hi(r.bottom,i.bottom,0,n),l:Hi(r.left,i.left,0,e)}}function YV(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,i=Nl(r),o=Math.min(e,n),a=t.borderSkipped,l=s||it(r);return{topLeft:Hi(!l||a.top||a.left,i.topLeft,0,o),topRight:Hi(!l||a.top||a.right,i.topRight,0,o),bottomLeft:Hi(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:Hi(!l||a.bottom||a.right,i.bottomRight,0,o)}}function QV(t){const e=C2(t),n=e.right-e.left,s=e.bottom-e.top,r=GV(t,n/2,s/2),i=YV(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function Dg(t,e,n,s){const r=e===null,i=n===null,a=t&&!(r&&i)&&C2(t,s);return a&&(r||Vo(e,a.left,a.right))&&(i||Vo(n,a.top,a.bottom))}function XV(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function JV(t,e){t.rect(e.x,e.y,e.w,e.h)}function Lg(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-s,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+i,h:t.h+o,radius:t.radius}}class _f extends pc{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=QV(this),a=XV(o.radius)?gp:JV;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,Lg(o,n,i)),e.clip(),a(e,Lg(i,-n,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),a(e,Lg(i,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Dg(this,e,n,s)}inXRange(e,n){return Dg(this,e,null,n)}inYRange(e,n){return Dg(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+r)/2:n,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}$e(_f,"id","bar"),$e(_f,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),$e(_f,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const vS=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},ZV=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class bS extends pc{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Nt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=ts(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=vS(s,i);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,i,a,l)+10):(d=this.maxHeight,u=this._fitCols(o,r,a,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+a;let h=e;i.textAlign="left",i.textBaseline="middle";let f=-1,p=-d;return this.legendItems.forEach((w,x)=>{const y=s+n/2+i.measureText(w.text).width;(x===0||u[u.length-1]+y+2*a>o)&&(h+=d,u[u.length-(x>0?0:1)]=0,p+=d,f++),l[x]={left:0,top:p,row:f,width:y,height:r},u[u.length-1]+=y+a}),h}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-e;let h=a,f=0,p=0,w=0,x=0;return this.legendItems.forEach((y,g)=>{const{itemWidth:m,itemHeight:b}=e7(s,n,i,y,r);g>0&&p+b+2*a>d&&(h+=f+a,u.push({width:f,height:p}),w+=f+a,x++,f=p=0),l[g]={left:w,top:p,col:x,width:m,height:b},f=Math.max(f,m),p+=b+a}),h+=f,u.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=El(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=ds(s,this.left+r,this.right-this.lineWidths[a]);for(const u of n)a!==u.row&&(a=u.row,l=ds(s,this.left+r,this.right-this.lineWidths[a])),u.top+=this.top+e+r,u.left=o.leftForLtr(o.x(l),u.width),l+=u.width+r}else{let a=0,l=ds(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const u of n)u.col!==a&&(a=u.col,l=ds(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),u.top=l,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),l+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;L0(e,this),this._draw(),$0(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=Xt.color,l=El(e.rtl,this.left,this.width),u=ts(o.font),{padding:d}=o,h=u.size,f=h/2;let p;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:w,boxHeight:x,itemHeight:y}=vS(o,h),g=function(C,S,j){if(isNaN(w)||w<=0||isNaN(x)||x<0)return;r.save();const T=st(j.lineWidth,1);if(r.fillStyle=st(j.fillStyle,a),r.lineCap=st(j.lineCap,"butt"),r.lineDashOffset=st(j.lineDashOffset,0),r.lineJoin=st(j.lineJoin,"miter"),r.lineWidth=T,r.strokeStyle=st(j.strokeStyle,a),r.setLineDash(st(j.lineDash,[])),o.usePointStyle){const P={radius:x*Math.SQRT2/2,pointStyle:j.pointStyle,rotation:j.rotation,borderWidth:T},L=l.xPlus(C,w/2),D=S+f;i2(r,P,L,D,o.pointStyleWidth&&w)}else{const P=S+Math.max((h-x)/2,0),L=l.leftForLtr(C,w),D=Nl(j.borderRadius);r.beginPath(),Object.values(D).some(O=>O!==0)?gp(r,{x:L,y:P,w,h:x,radius:D}):r.rect(L,P,w,x),r.fill(),T!==0&&r.stroke()}r.restore()},m=function(C,S,j){mp(r,j.text,C,S+y/2,u,{strikethrough:j.hidden,textAlign:l.textAlign(j.textAlign)})},b=this.isHorizontal(),k=this._computeTitleHeight();b?p={x:ds(i,this.left+d,this.right-s[0]),y:this.top+d+k,line:0}:p={x:this.left+d,y:ds(i,this.top+k+d,this.bottom-n[0].height),line:0},h2(this.ctx,e.textDirection);const _=y+d;this.legendItems.forEach((C,S)=>{r.strokeStyle=C.fontColor,r.fillStyle=C.fontColor;const j=r.measureText(C.text).width,T=l.textAlign(C.textAlign||(C.textAlign=o.textAlign)),P=w+f+j;let L=p.x,D=p.y;l.setWidth(this.width),b?S>0&&L+P+d>this.right&&(D=p.y+=_,p.line++,L=p.x=ds(i,this.left+d,this.right-s[p.line])):S>0&&D+_>this.bottom&&(L=p.x=L+n[p.line].width+d,p.line++,D=p.y=ds(i,this.top+k+d,this.bottom-n[p.line].height));const O=l.x(L);if(g(O,D,C),L=_8(T,L+w+f,b?L+P:this.right,e.rtl),m(l.x(L),D,C),b)p.x+=P+d;else if(typeof C.text!="string"){const $=u.lineHeight;p.y+=N2(C,$)+d}else p.y+=_}),f2(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=ts(n.font),r=cr(n.padding);if(!n.display)return;const i=El(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,u=r.top+l;let d,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),d=this.top+u,h=ds(e.align,h,this.right-f);else{const w=this.columnSizes.reduce((x,y)=>Math.max(x,y.height),0);d=u+ds(e.align,this.top,this.bottom-w-e.labels.padding-this._computeTitleHeight())}const p=ds(a,h,h+f);o.textAlign=i.textAlign(n2(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,mp(o,n.text,p,d,s)}_computeTitleHeight(){const e=this.options.title,n=ts(e.font),s=cr(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(Vo(e,this.left,this.right)&&Vo(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],Vo(e,r.left,r.left+r.width)&&Vo(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!s7(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=ZV(r,s);r&&!i&&Nt(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&Nt(n.onHover,[e,s,this],this)}else s&&Nt(n.onClick,[e,s,this],this)}}function e7(t,e,n,s,r){const i=t7(s,t,e,n),o=n7(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function t7(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function n7(t,e,n){let s=t;return typeof e.text!="string"&&(s=N2(e,n)),s}function N2(t,e){const n=t.text?t.text.length:0;return e*n}function s7(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var r7={id:"legend",_element:bS,start(t,e,n){const s=t.legend=new bS({ctx:t.ctx,options:n,chart:t});Ui.configure(t,s,n),Ui.addBox(t,s)},stop(t){Ui.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Ui.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(n?0:void 0),d=cr(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(a||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const Xc={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),d=x8(e,u);d<r&&(r=d,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function gr(t,e){return e&&(hn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Br(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function i7(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function wS(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=ts(e.bodyFont),u=ts(e.titleFont),d=ts(e.footerFont),h=i.length,f=r.length,p=s.length,w=cr(e.padding);let x=w.height,y=0,g=s.reduce((k,_)=>k+_.before.length+_.lines.length+_.after.length,0);if(g+=t.beforeBody.length+t.afterBody.length,h&&(x+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),g){const k=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;x+=p*k+(g-p)*l.lineHeight+(g-1)*e.bodySpacing}f&&(x+=e.footerMarginTop+f*d.lineHeight+(f-1)*e.footerSpacing);let m=0;const b=function(k){y=Math.max(y,n.measureText(k).width+m)};return n.save(),n.font=u.string,pt(t.title,b),n.font=l.string,pt(t.beforeBody.concat(t.afterBody),b),m=e.displayColors?o+2+e.boxPadding:0,pt(s,k=>{pt(k.before,b),pt(k.lines,b),pt(k.after,b)}),m=0,n.font=d.string,pt(t.footer,b),n.restore(),y+=w.width,{width:y,height:x}}function o7(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function a7(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function l7(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let u="center";return s==="center"?u=r<=(a+l)/2?"left":"right":r<=i/2?u="left":r>=o-i/2&&(u="right"),a7(u,t,e,n)&&(u="center"),u}function kS(t,e,n){const s=n.yAlign||e.yAlign||o7(t,n);return{xAlign:n.xAlign||e.xAlign||l7(t,e,n,s),yAlign:s}}function c7(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function u7(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function _S(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,u=r+i,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Nl(o);let w=c7(e,a);const x=u7(e,l,u);return l==="center"?a==="left"?w+=u:a==="right"&&(w-=u):a==="left"?w-=Math.max(d,f)+r:a==="right"&&(w+=Math.max(h,p)+r),{x:es(w,0,s.width-e.width),y:es(x,0,s.height-e.height)}}function Vh(t,e,n){const s=cr(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function SS(t){return gr([],Br(t))}function d7(t,e,n){return fc(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function jS(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const E2={beforeTitle:$r,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:$r,beforeBody:$r,beforeLabel:$r,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return wt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:$r,afterBody:$r,beforeFooter:$r,footer:$r,afterFooter:$r};function qn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?E2[e].call(n,s):r}class Ly extends pc{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new p2(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=d7(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=qn(s,"beforeTitle",this,e),i=qn(s,"title",this,e),o=qn(s,"afterTitle",this,e);let a=[];return a=gr(a,Br(r)),a=gr(a,Br(i)),a=gr(a,Br(o)),a}getBeforeBody(e,n){return SS(qn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return pt(e,i=>{const o={before:[],lines:[],after:[]},a=jS(s,i);gr(o.before,Br(qn(a,"beforeLabel",this,i))),gr(o.lines,qn(a,"label",this,i)),gr(o.after,Br(qn(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return SS(qn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=qn(s,"beforeFooter",this,e),i=qn(s,"footer",this,e),o=qn(s,"afterFooter",this,e);let a=[];return a=gr(a,Br(r)),a=gr(a,Br(i)),a=gr(a,Br(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,u;for(l=0,u=n.length;l<u;++l)a.push(i7(this.chart,n[l]));return e.filter&&(a=a.filter((d,h,f)=>e.filter(d,h,f,s))),e.itemSort&&(a=a.sort((d,h)=>e.itemSort(d,h,s))),pt(a,d=>{const h=jS(e.callbacks,d);r.push(qn(h,"labelColor",this,d)),i.push(qn(h,"labelPointStyle",this,d)),o.push(qn(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=Xc[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=wS(this,s),u=Object.assign({},a,l),d=kS(this.chart,s,u),h=_S(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:h}=Nl(a),{x:f,y:p}=e,{width:w,height:x}=n;let y,g,m,b,k,_;return i==="center"?(k=p+x/2,r==="left"?(y=f,g=y-o,b=k+o,_=k-o):(y=f+w,g=y+o,b=k-o,_=k+o),m=y):(r==="left"?g=f+Math.max(l,d)+o:r==="right"?g=f+w-Math.max(u,h)-o:g=this.caretX,i==="top"?(b=p,k=b-o,y=g-o,m=g+o):(b=p+x,k=b+o,y=g+o,m=g-o),_=b),{x1:y,x2:g,x3:m,y1:b,y2:k,y3:_}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const u=El(s.rtl,this.x,this.width);for(e.x=Vh(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",o=ts(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:u}=i,d=ts(i.bodyFont),h=Vh(this,"left",i),f=r.x(h),p=l<d.lineHeight?(d.lineHeight-l)/2:0,w=n.y+p;if(i.usePointStyle){const x={radius:Math.min(u,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},y=r.leftForLtr(f,u)+u/2,g=w+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,z_(e,x,y,g),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,z_(e,x,y,g)}else{e.lineWidth=it(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=r.leftForLtr(f,u),y=r.leftForLtr(r.xPlus(f,1),u-2),g=Nl(o.borderRadius);Object.values(g).some(m=>m!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,gp(e,{x,y:w,w:u,h:l,radius:g}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),gp(e,{x:y,y:w+1,w:u-2,h:l-2,radius:g}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(x,w,u,l),e.strokeRect(x,w,u,l),e.fillStyle=o.backgroundColor,e.fillRect(y,w+1,u-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:u,boxPadding:d}=s,h=ts(s.bodyFont);let f=h.lineHeight,p=0;const w=El(s.rtl,this.x,this.width),x=function(j){n.fillText(j,w.x(e.x+p),e.y+f/2),e.y+=f+i},y=w.textAlign(o);let g,m,b,k,_,C,S;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,e.x=Vh(this,y,s),n.fillStyle=s.bodyColor,pt(this.beforeBody,x),p=a&&y!=="right"?o==="center"?u/2+d:u+2+d:0,k=0,C=r.length;k<C;++k){for(g=r[k],m=this.labelTextColors[k],n.fillStyle=m,pt(g.before,x),b=g.lines,a&&b.length&&(this._drawColorBox(n,e,k,w,s),f=Math.max(h.lineHeight,l)),_=0,S=b.length;_<S;++_)x(b[_]),f=h.lineHeight;pt(g.after,x)}p=0,f=h.lineHeight,pt(this.afterBody,x),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=El(s.rtl,this.x,this.width);for(e.x=Vh(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=ts(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:u,height:d}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:w}=Nl(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+h,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+u-f,l),n.quadraticCurveTo(a+u,l,a+u,l+f),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+u,l+d-w),n.quadraticCurveTo(a+u,l+d,a+u-w,l+d),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+p,l+d),n.quadraticCurveTo(a,l+d,a,l+d-p),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+h),n.quadraticCurveTo(a,l,a+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=Xc[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=wS(this,e),l=Object.assign({},o,this._size),u=kS(n,e,l),d=_S(e,l,u,n);(r._to!==d.x||i._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=cr(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),h2(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),f2(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const u=this.chart.getDatasetMeta(a);if(!u)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:u.data[l],index:l}}),i=!up(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!up(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=Xc[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}$e(Ly,"positioners",Xc);var h7={id:"tooltip",_element:Ly,positioners:Xc,afterInit(t,e,n){n&&(t.tooltip=new Ly({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:E2},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const f7=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function p7(t,e,n,s){const r=t.indexOf(e);if(r===-1)return f7(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const m7=(t,e)=>t===null?null:es(Math.round(t),0,e);function CS(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class $y extends mc{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(wt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:p7(s,e,st(n,e),this._addedLabels),m7(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return CS.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}$e($y,"id","category"),$e($y,"defaults",{ticks:{callback:CS}});function g7(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:u,maxTicks:d,maxDigits:h,includeBounds:f}=t,p=i||1,w=d-1,{min:x,max:y}=e,g=!wt(o),m=!wt(a),b=!wt(u),k=(y-x)/(h+1);let _=R_((y-x)/w/p)*p,C,S,j,T;if(_<1e-14&&!g&&!m)return[{value:x},{value:y}];T=Math.ceil(y/_)-Math.floor(x/_),T>w&&(_=R_(T*_/w/p)*p),wt(l)||(C=Math.pow(10,l),_=Math.ceil(_*C)/C),r==="ticks"?(S=Math.floor(x/_)*_,j=Math.ceil(y/_)*_):(S=x,j=y),g&&m&&i&&p8((a-o)/i,_/1e3)?(T=Math.round(Math.min((a-o)/_,d)),_=(a-o)/T,S=o,j=a):b?(S=g?o:S,j=m?a:j,T=u-1,_=(j-S)/T):(T=(j-S)/_,vf(T,Math.round(T),_/1e3)?T=Math.round(T):T=Math.ceil(T));const P=Math.max(A_(_),A_(S));C=Math.pow(10,wt(l)?P:l),S=Math.round(S*C)/C,j=Math.round(j*C)/C;let L=0;for(g&&(f&&S!==o?(n.push({value:o}),S<o&&L++,vf(Math.round((S+L*_)*C)/C,o,NS(o,k,t))&&L++):S<o&&L++);L<T;++L){const D=Math.round((S+L*_)*C)/C;if(m&&D>a)break;n.push({value:D})}return m&&f&&j!==a?n.length&&vf(n[n.length-1].value,a,NS(a,k,t))?n[n.length-1].value=a:n.push({value:a}):(!m||j===a)&&n.push({value:j}),n}function NS(t,e,{horizontal:n,minRotation:s}){const r=Zr(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class x7 extends mc{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return wt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=no(r),u=no(i);l<0&&u<0?a(0):l>0&&u>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=g7(r,i);return e.bounds==="ticks"&&m8(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return D0(e,this.chart.options.locale,this.options.ticks.format)}}class Fy extends x7{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Us(e)?e:0,this.max=Us(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Zr(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}$e(Fy,"id","linear"),$e(Fy,"defaults",{ticks:{callback:r2.formatters.numeric}});const im={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Xn=Object.keys(im);function ES(t,e){return t-e}function TS(t,e){if(wt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Us(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(fp(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function PS(t,e,n,s){const r=Xn.length;for(let i=Xn.indexOf(t);i<r-1;++i){const o=im[Xn[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return Xn[i]}return Xn[r-1]}function y7(t,e,n,s,r){for(let i=Xn.length-1;i>=Xn.indexOf(n);i--){const o=Xn[i];if(im[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return Xn[n?Xn.indexOf(n):0]}function v7(t){for(let e=Xn.indexOf(t)+1,n=Xn.length;e<n;++e)if(im[Xn[e]].common)return Xn[e]}function RS(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=I0(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function b7(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function AS(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:b7(t,s,r,n)}class bp extends mc{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new OW._date(e.adapters.date);r.init(n),du(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:TS(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!a&&!isNaN(u.max)&&(i=Math.max(i,u.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Us(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Us(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=b8(r,i,o);return this._unit=n.unit||(s.autoSkip?PS(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):y7(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:v7(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),AS(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=es(n,0,o),s=es(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||PS(i.minUnit,n,s,this._getLabelCapacity(n)),a=st(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,u=fp(l)||l===!0,d={};let h=n,f,p;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const w=r.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,a,o),p++)RS(d,f,w);return(f===s||r.bounds==="ticks"||p===1)&&RS(d,f,w),Object.keys(d).sort(ES).map(x=>+x)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return Nt(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,u=this._majorUnit,d=l&&a[l],h=u&&a[u],f=s[n],p=u&&h&&f&&f.major;return this._adapter.format(e,r||(p?h:d))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=Zr(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,AS(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(TS(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return ZT(e.sort(ES))}}$e(bp,"id","time"),$e(bp,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function qh(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Ay(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Ay(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const u=o-i;return u?a+(l-a)*(e-i)/u:a}class OS extends bp{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=qh(n,this.min),this._tableRange=qh(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,u,d;for(o=0,a=e.length;o<a;++o)u=e[o],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)d=r[o+1],l=r[o-1],u=r[o],Math.round((d+l)/2)!==u&&i.push({time:u,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(qh(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return qh(this._table,s*this._tableRange+this._minPos,!0)}}$e(OS,"id","timeseries"),$e(OS,"defaults",bp.defaults);Sr.register(Qc,_f,$y,fl,My,bf,r7,Fy,h7);const Dn={pending:"rgba(234, 179, 8, 0.7)",rejected:"rgba(239, 68, 68, 0.7)",returned:"rgba(249, 115, 22, 0.7)",submitted:"rgba(59, 130, 246, 0.7)",accepted:"rgba(34, 197, 94, 0.7)"},w7=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}];function k7(t){const e=t-4,n=t+1,s=[];for(let r=e;r<=n;r+=1)s.push(r);return s}function An({icon:t,label:e,value:n,helper:s,accentClass:r,onClick:i}){const o=!!i;return c.jsxs(Dt,{className:`p-4 ${o?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:i,role:o?"button":void 0,tabIndex:o?0:void 0,onKeyDown:o?a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),i==null||i())}:void 0,children:[c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsx("div",{className:`h-10 w-10 rounded-xl flex items-center justify-center ${r}`,children:c.jsx(t,{size:18})}),c.jsx("div",{className:"text-2xl font-semibold",children:n})]}),c.jsx("div",{className:"mt-2 text-xs text-black/55 dark:text-white/60",children:e}),s?c.jsx("div",{className:"text-xs text-black/45 dark:text-white/55",children:s}):null]})}function Ga({title:t,children:e}){return c.jsxs(bt,{className:"h-full",children:[c.jsx(Bt,{children:c.jsx(Yt,{children:t})}),c.jsx(Ut,{children:c.jsx("div",{className:"h-[260px]",children:e})})]})}function T2({title:t,subtitle:e,children:n,defaultOpen:s=!1}){const[r,i]=v.useState(s);return c.jsxs(Dt,{className:"p-3",children:[c.jsxs("button",{type:"button",className:"flex w-full items-center justify-between gap-3 text-left",onClick:()=>i(o=>!o),"aria-expanded":r,children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:t}),e?c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:e}):null]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-black/50 dark:text-white/55",children:[c.jsx("span",{children:r?"Hide":"View"}),c.jsx(Zn,{size:16,className:`transition-transform ${r?"rotate-180":""}`})]})]}),r?c.jsx("div",{className:"mt-3 space-y-2 text-xs text-black/60 dark:text-white/65",children:n}):null]})}function Ya({type:t,data:e,options:n}){const s=ge.useRef(null);return ge.useEffect(()=>{if(!s.current)return;const r=Sr.getChart(s.current);r&&r.destroy();const i=new Sr(s.current,{type:t,data:e,options:n});return()=>i.destroy()},[e,n,t]),c.jsx("canvas",{ref:s})}function _7(t){const e=Number(t)||0;return e>=80?"bg-emerald-500/80":e>=60?"bg-amber-500/80":"bg-rose-500/80"}function MS(t){if(!t)return"--";const e=Bs(t);return e?e.toLocaleDateString():t}function S7({mode:t,period:e}){if(!e)return"Current period";if(t==="month"){const[n,s]=e.split("-");return new Date(Number(n),Number(s)-1,1).toLocaleString(void 0,{month:"long",year:"numeric"})}if(t==="year")return e;if(t==="range"){const[n,s]=e.split(",");return`${n} to ${s}`}return e}function IS(t){return{labels:["Pending","Rejected","Returned","Submitted","Accepted"],datasets:[{data:[t.pending,t.rejected,t.returned,t.submitted,t.accepted],backgroundColor:[Dn.pending,Dn.rejected,Dn.returned,Dn.submitted,Dn.accepted],borderWidth:0}]}}function Kh(t){const e={Pending:0,Rejected:0,Returned:0,"Submitted to Sales":0,Accepted:0};return t.forEach(n=>{const s=n.status||"";s.includes("Pending")||s==="Critique"||s==="Raw"?e.Pending+=1:s==="Rejected"||s==="Editing"?e.Rejected+=1:s==="Returned"?e.Returned+=1:s==="Submitted to Sales"?e["Submitted to Sales"]+=1:(s==="Accepted"||s==="Done")&&(e.Accepted+=1)}),e}function $c(t){return t.length?c.jsx("div",{className:"space-y-3",children:t.map(e=>c.jsx("div",{className:"rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85 truncate",children:["#",e.task_number," - ",e.brand]}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[e.status," - ",e.videographer||"Unassigned"]})]}),c.jsxs("div",{className:"text-right text-xs text-black/50 dark:text-white/60",children:[c.jsxs("div",{children:["Film: ",MS(e.filming_deadline)]}),c.jsxs("div",{children:["Due: ",MS(e.submission_date)]})]})]})},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No tasks found."})}function Gh(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:(e.versions||[]).map(n=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsx("div",{className:"mt-1 text-black/50 dark:text-white/60",children:(n.lifecycle||[]).map(s=>`${s.stage} (${s.at||""})`).join(" -> ")})]},n.version))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No versions found."})}function $g(t){return t.length?c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"rounded-xl border border-black/5 dark:border-white/10 p-3",children:[c.jsxs("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:["#",e.task_number," - ",e.brand]}),c.jsx("div",{className:"mt-2 space-y-2",children:e.rejectionEvents.map((n,s)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",n.version]}),c.jsxs("div",{className:"text-black/50 dark:text-white/60",children:[n.event.rejection_class||"Unclassified"," - ",n.event.rejection_comments||"No notes"]})]},`${e.task_number}-${s}`))})]},e.task_number))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection events."})}function j7(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No pending reviews."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,versions:[]}),n[r].versions.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(T2,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.versions.map(s=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Waiting: ",s.waitingHours??"--"," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]})]},`${n.task.task_number}-${s.version.version}`))},n.task.task_number))})}function C7(t){if(!t.length)return c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No response data."});const e=t.reduce((n,s)=>{const r=s.task.task_number;return n[r]||(n[r]={task:s.task,responses:[]}),n[r].responses.push(s),n},{});return c.jsx("div",{className:"space-y-3",children:Object.values(e).map(n=>c.jsx(T2,{title:`#${n.task.task_number} - ${n.task.brand}`,subtitle:n.task.videographer?`Videographer: ${n.task.videographer}`:"Videographer: --",children:n.responses.map((s,r)=>c.jsxs("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2",children:[c.jsxs("div",{className:"font-semibold",children:["Version ",s.version.version]}),c.jsxs("div",{children:["Decision: ",s.decision]}),c.jsxs("div",{children:["Response: ",s.responseHours," hrs"]}),c.jsxs("div",{children:["Uploaded: ",s.uploadTime?s.uploadTime.toLocaleString():"--"]}),c.jsxs("div",{children:["Reviewed: ",s.reviewTime?s.reviewTime.toLocaleString():"--"]}),s.rejectionClass?c.jsxs("div",{children:["Class: ",s.rejectionClass]}):null,s.comments?c.jsxs("div",{children:["Notes: ",s.comments]}):null]},`${n.task.task_number}-${r}`))},n.task.task_number))})}function N7(){const t=new Date,e=t.getFullYear(),[n,s]=v.useState("month"),[r,i]=v.useState(e),[o,a]=v.useState(t.getMonth()+1),[l,u]=v.useState(""),[d,h]=v.useState(""),[f,p]=v.useState(!1),[w,x]=v.useState(null),[y,g]=v.useState(null),m=k7(e),b=v.useMemo(()=>m.map(me=>({value:me,label:String(me)})),[m]),k=v.useMemo(()=>[{value:"month",label:"Month"},{value:"year",label:"Year"},{value:"range",label:"Range"}],[]),_=v.useMemo(()=>n==="month"?`${r}-${String(o).padStart(2,"0")}`:n==="year"?`${r}`:n==="range"&&l&&d?`${l},${d}`:"",[n,l,d,o,r]),C=en({queryKey:["video-critique","dashboard",n,_],queryFn:()=>u4({mode:n,period:_})}),S=C.data||{},j=S.tasks||[],T=S.summary||{},P=S.pie||{},L=S.reviewer||{},D=S.summary_videographers&&Object.keys(S.summary_videographers).length?S.summary_videographers:nT(j),O=S.videographers||{},$=v.useMemo(()=>iT(j),[j]),I=v.useMemo(()=>Ci(j),[j]),A=v.useMemo(()=>sT(j),[j]),W=v.useMemo(()=>rT(j),[j]),N=v.useMemo(()=>({labels:["Completed","Not Completed"],datasets:[{data:[P.completed||0,P.not_completed||0],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}),[P.completed,P.not_completed]),E=v.useMemo(()=>{const me=$.tasksStarted||0,fe=P.completed||0,De=Math.max(me-fe,0);return{labels:["Completed","Not Completed"],datasets:[{data:[fe,De],backgroundColor:["rgba(34, 197, 94, 0.7)","rgba(239, 68, 68, 0.7)"],borderWidth:0}]}},[$.tasksStarted,P.completed]),F=v.useMemo(()=>IS(I),[I]),V=v.useMemo(()=>Object.entries(D).sort((me,fe)=>fe[1].total-me[1].total),[D]),H=!!w,he=!!y,ee=y?D[y]:null,U=y?O[y]||[]:[],Q=v.useMemo(()=>qu(j,"pending"),[j]),de=v.useMemo(()=>qu(j,"submitted"),[j]),Z=v.useMemo(()=>mg(j,"hod"),[j]),be=v.useMemo(()=>mg(j,"hos"),[j]),Ae=v.useMemo(()=>{const me={};let fe=0,De=0;j.forEach(G=>{(G.versions||[]).forEach(le=>{const Y=le.lifecycle||[];if(!Y.length)return;const B=Y[Y.length-1],xe=((B==null?void 0:B.stage)||"").toLowerCase();(xe==="accepted"||xe==="done")&&(fe+=1),(xe==="rejected"||xe==="editing"||xe==="returned")&&(De+=1),Y.forEach(je=>{const Ce=(je.stage||"").toLowerCase();if(Ce==="rejected"||Ce==="editing"||Ce==="returned"){const Le=je.rejection_class||"Unclassified";me[Le]=(me[Le]||0)+1}})})});const J=fe+De,pe=J?(fe/J*100).toFixed(1):"0",ie=J?(De/J*100).toFixed(1):"0",K=Object.entries(me).sort((G,le)=>le[1]-G[1]);return{acceptedPct:pe,rejectedPct:ie,classes:K,totalRejections:De}},[j]);return C.isLoading?c.jsxs(bt,{children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Video Critique Dashboard"})}),c.jsx(Ut,{children:c.jsx(Ye,{text:"Loading dashboard",className:"text-sm text-black/60 dark:text-white/65"})})]}):c.jsxs("div",{className:"flex flex-col gap-4 min-h-0 pb-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-1",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:"Video Critique Dashboard"}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:S7({mode:n,period:_})})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(at,{value:n,options:k,onChange:s,className:"sm:w-[200px]"}),n==="month"?c.jsxs(c.Fragment,{children:[c.jsx(at,{value:o,options:w7,onChange:a,className:"sm:w-[200px]"}),c.jsx(at,{value:r,options:b,onChange:i,className:"sm:w-[200px]"})]}):null,n==="year"?c.jsx(at,{value:r,options:b,onChange:i,className:"sm:w-[200px]"}):null,n==="range"?c.jsxs(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!0),children:[c.jsx(RM,{size:16,className:"mr-2"}),"Pick Range"]}):null,c.jsxs(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>C.refetch(),children:[c.jsx(FM,{size:16,className:"mr-2"}),"Refresh"]})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(An,{icon:df,label:"Total Tasks",value:T.total||0,helper:"Tasks created",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("total_created")}),c.jsx(An,{icon:hh,label:"Assigned",value:T.assigned||0,helper:"Assigned to videographers",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("total_assigned")}),c.jsx(An,{icon:fh,label:"Tasks Started",value:$.tasksStarted||0,helper:"Filming date passed",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("total_started")}),c.jsx(An,{icon:ph,label:"Late Tasks",value:$.lateTasks||0,helper:"Submission overdue",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("total_late")}),c.jsx(An,{icon:df,label:"Uploads",value:T.uploads||0,helper:"Total versions",accentClass:"bg-purple-500/10 text-purple-700 dark:text-purple-200",onClick:()=>x("upload_ratio")}),c.jsx(An,{icon:hh,label:"Completed",value:P.completed||0,helper:"Accepted or done",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("completed")})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-6",children:[c.jsx(An,{icon:fh,label:"Pending HOD",value:$.pendingHOD||0,helper:"Versions in critique",accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200",onClick:()=>x("pending_hod")}),c.jsx(An,{icon:fh,label:"Pending HOS",value:$.pendingHOS||0,helper:"Submitted to sales",accentClass:"bg-blue-500/10 text-blue-700 dark:text-blue-200",onClick:()=>x("pending_hos")}),c.jsx(An,{icon:ph,label:"Rejected by HOD",value:$.rejectionsByHOD||0,helper:"Editing / rejected",accentClass:"bg-red-500/10 text-red-700 dark:text-red-200",onClick:()=>x("rejected_hod")}),c.jsx(An,{icon:ph,label:"Rejected by HOS",value:$.rejectionsByHOS||0,helper:"Returned",accentClass:"bg-orange-500/10 text-orange-700 dark:text-orange-200",onClick:()=>x("rejected_hos")}),c.jsx(An,{icon:df,label:"Upload Ratio",value:$.uploadRatio||"0",helper:"Avg versions/task",accentClass:"bg-black/5 dark:bg-white/10 text-black/70 dark:text-white/80",onClick:()=>x("upload_ratio")}),c.jsx(An,{icon:hh,label:"Acceptance Rate",value:`${T.accepted_pct||0}%`,helper:"Accepted vs reviewed",accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200",onClick:()=>x("acceptance_rate")})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsx(Ga,{title:"Completion Overview",children:c.jsx(Ya,{type:"doughnut",data:N,options:{maintainAspectRatio:!1}})}),c.jsx(Ga,{title:"Started vs Completed",children:c.jsx(Ya,{type:"doughnut",data:E,options:{maintainAspectRatio:!1}})}),c.jsx(Ga,{title:"Status Distribution",children:c.jsx(Ya,{type:"bar",data:F,options:{maintainAspectRatio:!1,indexAxis:"y",scales:{x:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}},y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(148,163,184,0.2)"}}}}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[c.jsxs(bt,{children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Reviewer Performance"})}),c.jsx(Ut,{children:c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Avg response time"}),c.jsx("span",{className:"font-semibold",children:L.avg_response_display||"0 hrs"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Handled"}),c.jsx("span",{className:"font-semibold",children:L.handled||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Accepted by HOS"}),c.jsx("span",{className:"font-semibold",children:L.accepted||0})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Success rate"}),c.jsxs("span",{className:"font-semibold",children:[L.handled_percent||0,"%"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-black/60 dark:text-white/60",children:"Pending reviews"}),c.jsx("span",{className:"font-semibold",children:A.count||0})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx(te,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("response_time"),children:"View response times"}),c.jsx(te,{variant:"secondary",className:"rounded-2xl w-full justify-center h-auto py-2 whitespace-normal text-center leading-snug",onClick:()=>x("pending_reviews"),children:"View pending reviews"})]})]})})]}),c.jsxs(bt,{className:"lg:col-span-2",children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Videographers"})}),c.jsx(Ut,{children:V.length?c.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:V.map(([me,fe])=>c.jsxs("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-white/5 p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>g(me),children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/80 dark:text-white/85",children:me}),c.jsxs("div",{className:"text-xs text-black/50 dark:text-white/60",children:[fe.total," tasks"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-lg font-semibold",children:[fe.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]})]}),c.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-black/60 dark:text-white/60",children:[c.jsxs("div",{children:["Started: ",fe.started]}),c.jsxs("div",{children:["Late: ",fe.late]}),c.jsxs("div",{children:["Completed: ",fe.completed]}),c.jsxs("div",{children:["Uploads: ",fe.uploads]})]}),c.jsx("div",{className:"mt-3 h-2 rounded-full bg-black/10 dark:bg-white/10 overflow-hidden",children:c.jsx("div",{className:`h-full ${_7(fe.accepted_pct)}`,style:{width:`${fe.accepted_pct}%`}})})]},me))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No videographer data."})})]})]}),c.jsxs(ws,{open:H,onClose:()=>x(null),title:"Details",maxWidth:"820px",children:[w==="total_created"?$c(j):null,w==="total_assigned"?$c(j.filter(me=>me.status!=="Not assigned yet")):null,w==="total_started"?$c(j.filter(me=>{const fe=Bs(me.filming_deadline||"");if(!fe)return!1;const De=new Date;return De.setHours(0,0,0,0),fe<=De})):null,w==="total_late"?$c(j.filter(gg)):null,w==="completed"?$c(j.filter(me=>me.status==="Accepted"||me.status==="Done")):null,w==="pending_hod"?Gh(Q.map(me=>({...me.task,versions:[me.version]}))):null,w==="pending_hos"?Gh(de.map(me=>({...me.task,versions:[me.version]}))):null,w==="rejected_hod"?$g(Z):null,w==="rejected_hos"?$g(be):null,w==="upload_ratio"?Gh(j.filter(me=>{var fe;return(fe=me.versions)==null?void 0:fe.length})):null,w==="acceptance_rate"?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Dt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-emerald-600",children:[Ae.acceptedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance"})]}),c.jsxs(Dt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold text-red-600",children:[Ae.rejectedPct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Rejection"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-black/70 dark:text-white/70 mb-2",children:"Rejection classes"}),Ae.classes.length?c.jsx("div",{className:"space-y-2",children:Ae.classes.map(([me,fe])=>c.jsx("div",{className:"rounded-lg bg-black/5 dark:bg-white/5 p-2 text-xs",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:me}),c.jsx("span",{children:fe})]})},me))}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No rejection data."})]})]}):null,w==="response_time"?C7(W):null,w==="pending_reviews"?j7(A.reviews||[]):null]}),c.jsx(ws,{open:he,onClose:()=>g(null),title:y?`${y} Details`:"Videographer",maxWidth:"980px",children:y&&ee?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Dt,{className:"p-4 text-center",children:[c.jsxs("div",{className:"text-2xl font-semibold",children:[ee.accepted_pct,"%"]}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Acceptance rate"})]}),c.jsxs(Dt,{className:"p-4 text-center",children:[c.jsx("div",{className:"text-2xl font-semibold",children:ee.late}),c.jsx("div",{className:"text-xs text-black/50 dark:text-white/60",children:"Late tasks"})]})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[c.jsx(An,{icon:fh,label:"Pending",value:Ci(U).pending,accentClass:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-200"}),c.jsx(An,{icon:ph,label:"Rejected",value:Ci(U).rejected,accentClass:"bg-red-500/10 text-red-700 dark:text-red-200"}),c.jsx(An,{icon:hh,label:"Accepted",value:Ci(U).accepted,accentClass:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-200"})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(Ga,{title:"Version Distribution",children:c.jsx(Ya,{type:"bar",data:IS(Ci(U)),options:{maintainAspectRatio:!1,indexAxis:"y"}})}),c.jsx(Ga,{title:"All Tasks Status",children:c.jsx(Ya,{type:"pie",data:{labels:Object.keys(Kh(U)),datasets:[{data:Object.values(Kh(U)),backgroundColor:[Dn.pending,Dn.rejected,Dn.returned,Dn.submitted,Dn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})})]}),c.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[c.jsx(Ga,{title:"Overdue Tasks",children:c.jsx(Ya,{type:"pie",data:{labels:Object.keys(Kh(U.filter(gg))),datasets:[{data:Object.values(Kh(U.filter(gg))),backgroundColor:[Dn.pending,Dn.rejected,Dn.returned,Dn.submitted,Dn.accepted],borderWidth:0}]},options:{maintainAspectRatio:!1}})}),c.jsxs(bt,{children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Failure Analysis"})}),c.jsx(Ut,{children:$g(mg(U,"hod"))})]})]}),c.jsxs(bt,{children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Version History"})}),c.jsx(Ut,{children:Gh(U)})]})]}):null}),c.jsx(ws,{open:f,onClose:()=>p(!1),title:"Select date range",maxWidth:"520px",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Start date"}),c.jsx("input",{type:"date",value:l,onChange:me=>u(me.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"grid gap-3",children:[c.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"End date"}),c.jsx("input",{type:"date",value:d,onChange:me=>h(me.target.value),className:"rounded-2xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-xs"})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>p(!1),children:"Cancel"}),c.jsx(te,{className:"rounded-2xl",onClick:()=>p(!1),children:"Apply"})]})]})})]})}function E7(){const[t,e]=v.useState("chat");return c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(te,{variant:t==="chat"?"default":"ghost",className:"rounded-2xl",onClick:()=>e("chat"),children:"Chat"}),c.jsx(te,{variant:t==="dashboard"?"default":"ghost",className:"rounded-2xl",onClick:()=>e("dashboard"),children:"Dashboard"})]}),c.jsxs("div",{className:"flex-1 min-h-0",children:[c.jsx("div",{className:t==="chat"?"h-full":"hidden","aria-hidden":t!=="chat",children:c.jsx(_H,{})}),c.jsx("div",{className:t==="dashboard"?"h-full overflow-y-auto px-2 py-1":"hidden","aria-hidden":t!=="dashboard",children:c.jsx(N7,{})})]})]})}function T7(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function DS(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function LS(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function P7({locations:t,locationsQuery:e}){var b;const[n,s]=v.useState(null),[r,i]=v.useState(""),[o,a]=v.useState(""),[l,u]=v.useState(""),[d,h]=v.useState(""),f=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.display_type)||"";S&&_.add(S)}),[{value:"",label:"All display types"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),p=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.company_schema)||"";S&&_.add(S)}),[{value:"",label:"All companies"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),w=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;return k.forEach(C=>{const S=(C==null?void 0:C.series)||"";S&&_.add(S)}),[{value:"",label:"All series"},...Array.from(_).sort().map(C=>({value:C,label:C}))]},[t]),x=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=r.trim().toLowerCase();return k.filter(S=>!(o&&((S==null?void 0:S.display_type)||"")!==o||l&&((S==null?void 0:S.company_schema)||"")!==l||d&&((S==null?void 0:S.series)||"")!==d||_&&!T7(S).includes(_))).map((S,j)=>({id:(S==null?void 0:S.location_key)||`location-${j}`,raw:S}))},[t,o,l,d,r]),y=v.useMemo(()=>{const k=Array.isArray(t)?t:[],_=new Set;k.forEach(j=>{Object.keys(j||{}).forEach(T=>_.add(T))});const C=["display_name","location_key","display_type","company_schema","series","city","area","upload_fee","height","width","number_of_faces","spot_duration","loop_duration","sov_percent","eligible_for_proposals","eligible_for_mockups"],S=Array.from(_).filter(j=>!C.includes(j)).sort();return[...C.filter(j=>_.has(j)),...S]},[t]),g=v.useMemo(()=>n?Object.entries(n):[],[n]),m=n||null;return c.jsxs(c.Fragment,{children:[c.jsxs(bt,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Bt,{className:"space-y-1",children:[c.jsx(Yt,{children:"Locations"}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[x.length," location",x.length===1?"":"s"]})]}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-4 md:shrink-0",children:[c.jsx(vo,{value:r,onChange:k=>i(k.target.value),className:"w-full",placeholder:"Search locations..."}),c.jsx(at,{value:o,options:f,onChange:a,className:"w-full"}),c.jsx(at,{value:l,options:p,onChange:u,className:"w-full"}),c.jsx(at,{value:d,options:w,onChange:h,className:"w-full"})]}),e.isLoading?c.jsx(Ye,{text:"Loading locations",className:"text-sm text-black/60 dark:text-white/65"}):e.isError?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:((b=e.error)==null?void 0:b.message)||"Failed to load locations."}):x.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsxs("tr",{children:[y.map(k=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:DS(k)},k)),c.jsx("th",{className:"sticky top-0 right-0 z-20 px-4 py-3 text-left font-semibold bg-white dark:bg-neutral-900",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:x.map(k=>c.jsxs("tr",{className:"text-black/80 dark:text-white/85",children:[y.map(_=>{var S;const C=LS((S=k.raw)==null?void 0:S[_]);return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:C},`${k.id}-${_}`)}),c.jsx("td",{className:"sticky right-0 z-10 px-4 py-3 bg-white/90 dark:bg-neutral-900/95",children:c.jsx(te,{variant:"ghost",size:"sm",className:"rounded-xl",onClick:()=>s(k.raw),children:"Edit"})})]},k.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"No locations found."})]})]}),c.jsx(ws,{open:!!n,onClose:()=>s(null),title:"Edit location",maxWidth:"560px",children:m?c.jsxs("div",{className:"space-y-3",children:[c.jsx(Se,{label:"Location Key",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.location_key||"",disabled:!0,readOnly:!0})}),c.jsx(Se,{label:"Display Name",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_name||"",disabled:!0,readOnly:!0})}),c.jsx(Se,{label:"Display Type",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.display_type||"",disabled:!0,readOnly:!0})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsx(Se,{label:"Company",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.company_schema||"",disabled:!0,readOnly:!0})}),c.jsx(Se,{label:"Series",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.series||"",disabled:!0,readOnly:!0})}),c.jsx(Se,{label:"City",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.city||"",disabled:!0,readOnly:!0})}),c.jsx(Se,{label:"Area",children:c.jsx("input",{className:"w-full rounded-xl bg-white/60 dark:bg-white/5 ring-1 ring-black/5 dark:ring-white/10 px-3 py-2 text-sm outline-none",value:m.area||"",disabled:!0,readOnly:!0})})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(te,{variant:"ghost",className:"rounded-2xl",onClick:()=>s(null),children:"Close"}),c.jsx(te,{className:"rounded-2xl",disabled:!0,children:"Save"})]}),c.jsxs("div",{className:"pt-2",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/50 dark:text-white/60 mb-2",children:"All fields"}),c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 divide-y divide-black/5 dark:divide-white/10",children:g.map(([k,_])=>c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 px-3 py-2 text-sm",children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-black/45 dark:text-white/55 md:w-56",children:DS(k)}),c.jsx("div",{className:"text-black/80 dark:text-white/85 break-all",children:LS(_)})]},k))})]})]}):null})]})}function R7(t){return t?Object.values(t).map(e=>e==null?"":typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):"").join(" ").toLowerCase():""}function A7(t){return t?t==="display_name"?"NAME":String(t).replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):""}function O7(t){if(t==null||t==="")return"";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return Number.isFinite(t)?String(t):"";if(Array.isArray(t))return t.length?JSON.stringify(t):"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return""}return String(t)}function om({title:t,items:e,itemsQuery:n,itemLabel:s="item",searchPlaceholder:r="Search...",emptyMessage:i="No items found.",preferredColumns:o=[],stringKey:a="value"}){var y;const[l,u]=v.useState(""),d=v.useMemo(()=>(Array.isArray(e)?e:[]).map(m=>m==null?{[a]:""}:typeof m=="string"||typeof m=="number"||typeof m=="boolean"?{[a]:m}:m),[e,a]),h=v.useMemo(()=>{const g=new Set;d.forEach(b=>{Object.keys(b||{}).forEach(k=>g.add(k))});const m=Array.from(g).filter(b=>!o.includes(b)).sort();return[...o.filter(b=>g.has(b)),...m]},[d,o]),f=v.useMemo(()=>{const g=l.trim().toLowerCase();return d.filter(b=>g?R7(b).includes(g):!0).map((b,k)=>({id:(b==null?void 0:b.id)??(b==null?void 0:b[a])??`row-${k}`,raw:b}))},[d,l,a]),p=n==null?void 0:n.isLoading,w=n==null?void 0:n.isError,x=((y=n==null?void 0:n.error)==null?void 0:y.message)||"Failed to load data.";return c.jsxs(bt,{className:"h-full min-h-0 flex flex-col",children:[c.jsxs(Bt,{className:"space-y-1",children:[c.jsx(Yt,{children:t}),c.jsxs("div",{className:"text-xs text-black/55 dark:text-white/60",children:[f.length," ",s,f.length===1?"":"s"]})]}),c.jsxs(Ut,{className:"flex-1 min-h-0 overflow-y-auto space-y-3 pt-1 md:flex md:flex-col md:overflow-hidden",children:[c.jsx(vo,{value:l,onChange:g=>u(g.target.value),className:"w-full md:shrink-0",placeholder:r}),p?c.jsx(Ye,{text:"Loading",className:"text-sm text-black/60 dark:text-white/65"}):w?c.jsx("div",{className:"text-sm text-red-700 dark:text-red-300",children:x}):f.length?c.jsx("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-white/5 w-full max-w-full overflow-hidden md:flex-1 md:min-h-0",children:c.jsx("div",{className:"w-full max-w-full min-w-0 overflow-x-auto md:h-full md:overflow-auto",children:c.jsx("div",{className:"min-w-max",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white dark:bg-neutral-900 text-xs uppercase tracking-wide text-black/45 dark:text-white/50",children:c.jsx("tr",{children:h.map(g=>c.jsx("th",{className:"sticky top-0 z-10 px-4 py-3 text-left font-semibold whitespace-nowrap bg-white dark:bg-neutral-900",children:A7(g)},g))})}),c.jsx("tbody",{className:"divide-y divide-black/5 dark:divide-white/10",children:f.map(g=>c.jsx("tr",{className:"text-black/80 dark:text-white/85",children:h.map(m=>{var b;return c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:O7((b=g.raw)==null?void 0:b[m])},`${g.id}-${m}`)})},g.id))})]})})})}):c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:i})]})]})}function M7({networks:t,networksQuery:e}){return c.jsx(om,{title:"Networks",items:t,itemsQuery:e,itemLabel:"network",searchPlaceholder:"Search networks...",emptyMessage:"No networks found.",preferredColumns:["network_name","name","company","company_schema","is_active","location_count"]})}function I7({assetTypes:t,assetTypesQuery:e}){return c.jsx(om,{title:"Asset Types",items:t,itemsQuery:e,itemLabel:"type",searchPlaceholder:"Search asset types...",emptyMessage:"No asset types found.",preferredColumns:["name","type_key","company","network_id","is_active","location_count"]})}function D7({networkAssets:t,networkAssetsQuery:e}){return c.jsx(om,{title:"Network Assets",items:t,itemsQuery:e,itemLabel:"asset",searchPlaceholder:"Search assets...",emptyMessage:"No network assets found.",preferredColumns:["display_name","asset_key","location_key","network_id","type_id","company","is_active"]})}function L7({packages:t,packagesQuery:e}){return c.jsx(om,{title:"Packages",items:t,itemsQuery:e,itemLabel:"package",searchPlaceholder:"Search packages...",emptyMessage:"No packages found.",preferredColumns:["name","company","is_active"]})}const $7=[{key:"networks",label:"Networks",disabled:!1},{key:"asset-types",label:"Asset Types",disabled:!1},{key:"network-assets",label:"Network Assets",disabled:!1},{key:"packages",label:"Packages",disabled:!1},{key:"locations",label:"Locations",disabled:!1}];function Fc(t,e=[]){if(Array.isArray(t))return t;for(const n of e)if(Array.isArray(t==null?void 0:t[n]))return t[n];return Array.isArray(t==null?void 0:t.data)?t.data:[]}function F7(){const{user:t}=oi(),[e,n]=v.useState("networks");if(!_d(t))return c.jsxs(bt,{children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Restricted"})}),c.jsx(Ut,{className:"text-sm text-black/60 dark:text-white/65",children:"You don't have access to asset management."})]});const s=en({queryKey:["asset-management","networks"],queryFn:()=>b4(),enabled:e==="networks"}),r=en({queryKey:["asset-management","asset-types"],queryFn:()=>w4(),enabled:e==="asset-types"}),i=en({queryKey:["asset-management","network-assets"],queryFn:()=>k4(),enabled:e==="network-assets"}),o=en({queryKey:["asset-management","packages"],queryFn:()=>S4(),enabled:e==="packages"}),a=en({queryKey:["asset-management","locations"],queryFn:()=>_4(),enabled:e==="locations"}),l=v.useMemo(()=>Fc(s.data,["networks"]),[s.data]),u=v.useMemo(()=>Fc(r.data,["asset_types","types"]),[r.data]),d=v.useMemo(()=>Fc(i.data,["network_assets","assets"]),[i.data]),h=v.useMemo(()=>Fc(o.data,["packages"]),[o.data]),f=v.useMemo(()=>Fc(a.data,["locations"]),[a.data]);return c.jsxs("div",{className:"flex h-full min-h-0 min-w-0 flex-col gap-4",children:[c.jsx("div",{className:"flex items-center gap-2 overflow-x-auto",children:$7.map(p=>c.jsx(te,{variant:e===p.key?"default":"ghost",onClick:()=>n(p.key),className:"rounded-2xl shrink-0",disabled:p.disabled,title:p.disabled?"Coming soon":void 0,children:p.label},p.key))}),c.jsxs("div",{className:"flex-1 min-h-0 min-w-0",children:[e==="networks"?c.jsx("div",{className:"h-full",children:c.jsx(M7,{networks:l,networksQuery:s})}):null,e==="asset-types"?c.jsx("div",{className:"h-full",children:c.jsx(I7,{assetTypes:u,assetTypesQuery:r})}):null,e==="network-assets"?c.jsx("div",{className:"h-full",children:c.jsx(D7,{networkAssets:d,networkAssetsQuery:i})}):null,e==="packages"?c.jsx("div",{className:"h-full",children:c.jsx(L7,{packages:h,packagesQuery:o})}):null,e==="locations"?c.jsx("div",{className:"h-full",children:c.jsx(P7,{locations:f,locationsQuery:a})}):null]})]})}function z7({children:t}){const{user:e,authReady:n,session:s,pendingAccess:r,logout:i}=oi(),o=rc();return!n||s&&!e?(console.log("[ProtectedRoute] Waiting for auth",{authReady:n,hasSession:!!s,hasUser:!!e}),null):(console.log("[ProtectedRoute] Auth ready, rendering children",{user:e==null?void 0:e.email}),r?c.jsx(kN,{email:r.email,message:r.message,onSignOut:i}):e?t:c.jsx(cf,{to:"/login",replace:!0,state:{from:o.pathname}}))}function B7(){const t="mmg-brand-theme",[e,n]=v.useState("none");v.useEffect(()=>{if(typeof window>"u")return;const i=window.localStorage.getItem(t)||"none";n(i),i==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",i)},[]);const s=r=>{n(r),typeof window<"u"&&window.localStorage.setItem(t,r),r==="none"?document.body.removeAttribute("data-brand-theme"):document.body.setAttribute("data-brand-theme",r)};return c.jsx("div",{className:"h-full min-h-0",children:c.jsxs(bt,{className:"h-full",children:[c.jsx(Bt,{children:c.jsx(Yt,{children:"Settings"})}),c.jsxs(Ut,{className:"text-sm text-black/60 dark:text-white/65 space-y-4",children:[c.jsxs(Dt,{className:"flex items-center justify-between p-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Toggle dark / light mode"})]}),c.jsx(_N,{})]}),c.jsxs(Dt,{className:"space-y-3 p-4",children:[c.jsx("div",{className:"flex items-center justify-between gap-4",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-black/80 dark:text-white/85",children:"Color theme"}),c.jsx("div",{className:"text-sm text-black/60 dark:text-white/65",children:"Choose a color palette that layers on top of light / dark mode."})]})}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mt-2",children:[c.jsx("button",{type:"button",onClick:()=>s("none"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="none"?"border-black/60 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:c.jsx("span",{className:"font-medium",children:"System default"})}),c.jsxs("button",{type:"button",onClick:()=>s("blue"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="blue"?"border-blue-500/80 bg-blue-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Blue"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#007AFF]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("green"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="green"?"border-emerald-500/80 bg-emerald-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Green"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#0F806B]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("orange"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="orange"?"border-orange-500/80 bg-orange-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Orange"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#FF7900]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("gold"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="gold"?"border-amber-500/80 bg-amber-500/5":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Gold"}),c.jsx("span",{className:"flex h-5 w-5 rounded-full bg-[#CA9E2C]"})]}),c.jsxs("button",{type:"button",onClick:()=>s("brand"),className:`flex items-center justify-between rounded-2xl border px-3 py-2 text-left text-sm transition-colors ${e==="brand"?"border-black/70 dark:border-white/80 bg-black/5 dark:bg-white/10":"border-black/10 dark:border-white/15 hover:bg-black/3 dark:hover:bg-white/5"}`,children:[c.jsx("span",{className:"font-medium",children:"Brand Theme"}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#000000]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#007AFF]"}),c.jsx("span",{className:"h-4 w-4 rounded-full bg-[#CA9E2C]"})]})]})]})]})]})]})})}function U7(){return c.jsxs(DO,{children:[c.jsx(On,{path:"/",element:c.jsx(cf,{to:"/login",replace:!0})}),c.jsx(On,{path:"/login",element:c.jsx(g5,{})}),c.jsx(On,{path:"/auth/callback",element:c.jsx(x5,{})}),c.jsxs(On,{path:"/app",element:c.jsx(z7,{children:c.jsx(P4,{})}),children:[c.jsx(On,{index:!0,element:c.jsx(cf,{to:"chat",replace:!0})}),c.jsx(On,{path:"chat",element:c.jsx(nU,{})}),c.jsx(On,{path:"video-critique",element:c.jsx(E7,{})}),c.jsx(On,{path:"mockup",element:c.jsx(MU,{})}),c.jsx(On,{path:"proposals",element:c.jsx(QU,{})}),c.jsx(On,{path:"notifications",element:c.jsx(kH,{})}),c.jsx(On,{path:"admin",element:c.jsx(bH,{})}),c.jsx(On,{path:"asset-management",element:c.jsx(F7,{})}),c.jsx(On,{path:"settings",element:c.jsx(B7,{})})]}),c.jsx(On,{path:"*",element:c.jsx(cf,{to:"/login",replace:!0})})]})}function H7(){if(!(typeof window>"u"))try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return;const e=new t,n=e.createOscillator(),s=e.createGain();n.type="sine",n.frequency.value=740,s.gain.value=.15,n.connect(s),s.connect(e.destination),n.start(),s.gain.exponentialRampToValueAtTime(.001,e.currentTime+.25),n.stop(e.currentTime+.3),n.onended=()=>{e.close()}}catch{}}function W7(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?"":e.toLocaleString()}function V7({children:t}){const[e,n]=v.useState([]),[s,r]=v.useState(!0),[i,o]=v.useState([]),a=v.useRef(new Set),l=v.useRef(!1),u=v.useRef(new Map),d=v.useCallback(async()=>{r(!0);const b=await FB();n(Array.isArray(b)?b:[]),r(!1)},[]),h=v.useCallback(async()=>{await BB(),n([])},[]),f=v.useCallback(async b=>{b&&(await UB(b),n(k=>k.filter(_=>_.id!==b)))},[]),p=v.useCallback(async b=>{b&&(await HB(b),n(k=>k.map(_=>_.id===b?{..._,read:!0}:_)))},[]),w=v.useCallback(async b=>{const k=await zB(b);return n(_=>[k,..._]),k},[]),x=v.useCallback(b=>{o(_=>_.filter(C=>C.id!==b));const k=u.current.get(b);k&&(clearTimeout(k),u.current.delete(b))},[]),y=v.useCallback(b=>{if(!(b!=null&&b.id))return;o(_=>[..._,{id:b.id,notification:b}]);const k=setTimeout(()=>x(b.id),4200);u.current.set(b.id,k)},[x]);v.useEffect(()=>{d()},[d]),v.useEffect(()=>{if(!l.current){e.forEach(k=>a.current.add(k.id)),l.current=!0;return}const b=e.filter(k=>k.id&&!a.current.has(k.id));b.length&&(H7(),b.forEach(k=>{a.current.add(k.id),y(k)}))},[e,y]),v.useEffect(()=>{if(typeof window>"u")return;const b=k=>{k.key===WB&&d()};return window.addEventListener("storage",b),()=>window.removeEventListener("storage",b)},[d]),v.useEffect(()=>{if(!(typeof window>"u"))return window.mmgNotify=b=>w(b),window.mmgNotifications={add:b=>w(b),clear:h,dismiss:f,markRead:p},()=>{delete window.mmgNotify,delete window.mmgNotifications}},[w,h,f,p]);const g=v.useMemo(()=>e.filter(b=>!b.read).length,[e]),m=v.useMemo(()=>({notifications:e,loading:s,unreadCount:g,toasts:i,addNotification:w,clearAll:h,dismissNotification:f,markRead:p,dismissToast:x,formatTime:W7}),[e,s,g,i,w,h,f,p,x]);return c.jsx(QE.Provider,{value:m,children:t})}function q7(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=t;let a,l;const u=async(h=!0)=>{await l};async function d(){if("serviceWorker"in navigator){if(a=await CM(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!a)return;a.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),a.addEventListener("installed",h=>{h.isUpdate||s==null||s()}),a.register({immediate:e}).then(h=>{i?i("/sw.js",h):r==null||r(h)}).catch(h=>{o==null||o(h)})}}return l=d(),u}q7({immediate:!0});const K7="mmg-brand-theme";if(typeof window<"u"){const t=window.localStorage.getItem(K7);t&&t!=="none"?document.body.setAttribute("data-brand-theme",t):document.body.removeAttribute("data-brand-theme"),window.addEventListener("wheel",e=>{const n=e.target;n instanceof HTMLInputElement&&n.type==="number"&&n===document.activeElement&&e.preventDefault()},{passive:!1})}const G7=new xM({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});Fg.createRoot(document.getElementById("root")).render(c.jsx(ge.StrictMode,{children:c.jsx(HO,{attribute:"class",defaultTheme:"light",enableSystem:!1,children:c.jsx(yM,{client:G7,children:c.jsx(p5,{children:c.jsx(V7,{children:c.jsx(FO,{children:c.jsx(U7,{})})})})})})}));
