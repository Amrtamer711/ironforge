build_unifiedui:
  extends: .build_push_ecr_template
  variables:
    SERVICE_NAME: "unifiedui"
    SERVICE_DIR: "src/unified-ui"
    ECR_REPO: "unifiedui"
  rules:
  # Only run on main AND only if this service changed
  - if: '$CI_COMMIT_BRANCH == "demo"'
    changes:
      - src/unified-ui/**/*
    when: on_success

  # Run on SemVer git tags (e.g. v1.2.3 or 1.2.3)
  - if: '$CI_COMMIT_TAG =~ /^v?\\d+\\.\\d+\\.\\d+$/'
    when: on_success

  # Optional: allow manual run on main
  - if: '$CI_COMMIT_BRANCH == "demo"'
    when: manual
    allow_failure: true
