# =============================================================================
# Render Blueprint - CRM (Ironforge) - DEVELOPMENT
# =============================================================================
# Development environment services running on dev branch.
# Uses *_DEV_SUPABASE_* keys for development Supabase projects.
#
# To deploy:
# 1. Go to https://dashboard.render.com
# 2. Click "New" â†’ "Blueprint"
# 3. Select the ironforge repo
# 4. Select the "dev" branch
# 5. Name the environment "CRM-Dev" or similar
# 6. Render will read this file and create all services
# =============================================================================

services:
  # ===========================================================================
  # Unified UI (Dev) - Main Frontend + API Gateway
  # ===========================================================================
  - type: web
    name: crm-unified-ui-dev
    runtime: docker
    region: singapore
    plan: starter
    branch: dev
    rootDir: ""
    dockerfilePath: ./src/unified-ui/Dockerfile
    dockerContext: .
    healthCheckPath: /health
    autoDeploy: true
    disk:
      name: unified-ui-data-dev
      mountPath: /app/data
      sizeGB: 1
    envVars:
      - key: ENVIRONMENT
        value: development
      - key: PORT
        value: "3005"
      - key: SALES_BOT_URL
        sync: false
      # Development Supabase (UI project)
      - key: UI_DEV_SUPABASE_URL
        sync: false
      - key: UI_DEV_SUPABASE_ANON_KEY
        sync: false
      - key: UI_DEV_SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: SECURITY_SERVICE_URL
        sync: false
      - key: INTER_SERVICE_SECRET
        sync: false
      - key: REDIS_URL
        sync: false

  # ===========================================================================
  # Security Service (Dev) - Auth, API Keys, RBAC
  # ===========================================================================
  - type: web
    name: crm-security-service-dev
    runtime: docker
    region: singapore
    plan: starter
    branch: dev
    rootDir: src/security-service
    dockerfilePath: ./Dockerfile
    dockerContext: .
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: ENVIRONMENT
        value: development
      - key: PORT
        value: "8002"
      # Development Supabase (Security project)
      - key: SECURITY_DEV_SUPABASE_URL
        sync: false
      - key: SECURITY_DEV_SUPABASE_ANON_KEY
        sync: false
      - key: SECURITY_DEV_SUPABASE_SERVICE_KEY
        sync: false
      # Development Supabase (UI project - for user lookups)
      - key: UI_DEV_SUPABASE_URL
        sync: false
      - key: UI_DEV_SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: INTER_SERVICE_SECRET
        sync: false
      - key: REDIS_URL
        sync: false

  # ===========================================================================
  # Asset Management (Dev) - Location & Media Assets
  # ===========================================================================
  - type: web
    name: crm-asset-management-dev
    runtime: docker
    region: singapore
    plan: starter
    branch: dev
    rootDir: src/asset-management
    dockerfilePath: ./Dockerfile
    dockerContext: .
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: ENVIRONMENT
        value: development
      - key: PORT
        value: "8001"
      # Development Supabase (Asset Management project)
      - key: ASSETMGMT_DEV_SUPABASE_URL
        sync: false
      - key: ASSETMGMT_DEV_SUPABASE_ANON_KEY
        sync: false
      - key: ASSETMGMT_DEV_SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: DB_BACKEND
        value: supabase
      - key: INTER_SERVICE_SECRET
        sync: false
      - key: REDIS_URL
        sync: false

  # ===========================================================================
  # Sales Module (Dev) - Proposals & Contracts
  # ===========================================================================
  - type: web
    name: crm-sales-module-dev
    runtime: docker
    region: singapore
    plan: starter
    branch: dev
    rootDir: src/sales-module
    dockerfilePath: ./Dockerfile
    dockerContext: .
    healthCheckPath: /health
    autoDeploy: true
    disk:
      name: sales-module-data-dev
      mountPath: /data
      sizeGB: 1
    envVars:
      - key: ENVIRONMENT
        value: development
      - key: PORT
        value: "8000"
      # Development Supabase (Salesbot project)
      - key: SALESBOT_DEV_SUPABASE_URL
        sync: false
      - key: SALESBOT_DEV_SUPABASE_ANON_KEY
        sync: false
      - key: SALESBOT_DEV_SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: DB_BACKEND
        value: supabase
      - key: AUTH_PROVIDER
        value: supabase
      - key: INTER_SERVICE_SECRET
        sync: false
      - key: REDIS_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: ANTHROPIC_API_KEY
        sync: false

  # ===========================================================================
  # Video Critique (Dev) - Video Review Workflow
  # ===========================================================================
  - type: web
    name: crm-video-critique-dev
    runtime: docker
    region: singapore
    plan: starter
    branch: dev
    rootDir: src/video-critique
    dockerfilePath: ./Dockerfile
    dockerContext: .
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: ENVIRONMENT
        value: development
      - key: PORT
        value: "8003"
      - key: IS_PRODUCTION
        value: "false"
      - key: DROPBOX_ACCESS_TOKEN
        sync: false
      - key: TRELLO_API_KEY
        sync: false
      - key: TRELLO_TOKEN
        sync: false
      - key: INTER_SERVICE_SECRET
        sync: false
